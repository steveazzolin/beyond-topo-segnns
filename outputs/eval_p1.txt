Time to train models with hard masking!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:52:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:52:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.8365
Train Loss: 0.5048
ID Validation ACCURACY: 0.8387
ID Validation Loss: 0.5132
ID Test ACCURACY: 0.8473
ID Test Loss: 0.5012
OOD Validation ACCURACY: 0.8727
OOD Validation Loss: 0.5047
OOD Test ACCURACY: 0.8613
OOD Test Loss: 0.5353

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.7881
Train Loss: 0.6104
ID Validation ACCURACY: 0.7843
ID Validation Loss: 0.6268
ID Test ACCURACY: 0.7953
ID Test Loss: 0.6104
OOD Validation ACCURACY: 0.8827
OOD Validation Loss: 0.4499
OOD Test ACCURACY: 0.8260
OOD Test Loss: 0.5367

[0m[1;37mINFO[0m: [1mChartInfo 0.8473 0.8613 0.7953 0.8260 0.7843 0.8827[0mTrain ACCURACY: 0.8365Train Loss: 0.5048
Id_val ACCURACY: 0.8387Id_val Loss: 0.5132
Id_test ACCURACY: 0.8473Id_test Loss: 0.5012
Val ACCURACY: 0.8727Val Loss: 0.5047
Test ACCURACY: 0.8613Test Loss: 0.5353


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:53:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 0.9018
Train Loss: 0.4233
ID Validation ACCURACY: 0.8970
ID Validation Loss: 0.4483
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4353
OOD Validation ACCURACY: 0.9253
OOD Validation Loss: 0.3360
OOD Test ACCURACY: 0.7760
OOD Test Loss: 0.6729

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4111
ID Validation ACCURACY: 0.8890
ID Validation Loss: 0.4330
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4232
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3346
OOD Test ACCURACY: 0.7547
OOD Test Loss: 0.6789

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.7760 0.8940 0.7547 0.8890 0.9317[0mTrain ACCURACY: 0.9018Train Loss: 0.4233
Id_val ACCURACY: 0.8970Id_val Loss: 0.4483
Id_test ACCURACY: 0.8977Id_test Loss: 0.4353
Val ACCURACY: 0.9253Val Loss: 0.3360
Test ACCURACY: 0.7760Test Loss: 0.6729


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:53:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8760
Train Loss: 0.4616
ID Validation ACCURACY: 0.8857
ID Validation Loss: 0.4701
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4700
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3446
OOD Test ACCURACY: 0.5550
OOD Test Loss: 1.5732

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8760
Train Loss: 0.4616
ID Validation ACCURACY: 0.8857
ID Validation Loss: 0.4701
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4700
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3446
OOD Test ACCURACY: 0.5550
OOD Test Loss: 1.5732

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.5550 0.8753 0.5550 0.8857 0.9313[0mTrain ACCURACY: 0.8760Train Loss: 0.4616
Id_val ACCURACY: 0.8857Id_val Loss: 0.4701
Id_test ACCURACY: 0.8753Id_test Loss: 0.4700
Val ACCURACY: 0.9313Val Loss: 0.3446
Test ACCURACY: 0.5550Test Loss: 1.5732


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:53:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:53:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8632
Train Loss: 0.4874
ID Validation ACCURACY: 0.8627
ID Validation Loss: 0.5017
ID Test ACCURACY: 0.8617
ID Test Loss: 0.4771
OOD Validation ACCURACY: 0.9223
OOD Validation Loss: 0.3662
OOD Test ACCURACY: 0.6843
OOD Test Loss: 0.9765

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.8372
Train Loss: 0.5664
ID Validation ACCURACY: 0.8407
ID Validation Loss: 0.5832
ID Test ACCURACY: 0.8400
ID Test Loss: 0.5602
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3337
OOD Test ACCURACY: 0.6390
OOD Test Loss: 0.8867

[0m[1;37mINFO[0m: [1mChartInfo 0.8617 0.6843 0.8400 0.6390 0.8407 0.9317[0mTrain ACCURACY: 0.8632Train Loss: 0.4874
Id_val ACCURACY: 0.8627Id_val Loss: 0.5017
Id_test ACCURACY: 0.8617Id_test Loss: 0.4771
Val ACCURACY: 0.9223Val Loss: 0.3662
Test ACCURACY: 0.6843Test Loss: 0.9765


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:54:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ACCURACY: 0.8609
Train Loss: 0.4701
ID Validation ACCURACY: 0.8647
ID Validation Loss: 0.4763
ID Test ACCURACY: 0.8613
ID Test Loss: 0.4696
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3557
OOD Test ACCURACY: 0.6877
OOD Test Loss: 0.8634

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.8226
Train Loss: 0.5752
ID Validation ACCURACY: 0.8187
ID Validation Loss: 0.5929
ID Test ACCURACY: 0.8270
ID Test Loss: 0.5741
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3784
OOD Test ACCURACY: 0.6873
OOD Test Loss: 0.8184

[0m[1;37mINFO[0m: [1mChartInfo 0.8613 0.6877 0.8270 0.6873 0.8187 0.9313[0mTrain ACCURACY: 0.8609Train Loss: 0.4701
Id_val ACCURACY: 0.8647Id_val Loss: 0.4763
Id_test ACCURACY: 0.8613Id_test Loss: 0.4696
Val ACCURACY: 0.9293Val Loss: 0.3557
Test ACCURACY: 0.6877Test Loss: 0.8634


Final accuracies: 
TRAIN      = 0.868 +- 0.021
ID_VAL     = 0.870 +- 0.020
ID_TEST    = 0.869 +- 0.017
VAL        = 0.916 +- 0.022
TEST       = 0.713 +- 0.102

Final losses: 
TRAIN      = 0.4694 +- 0.0274
ID_VAL     = 0.4819 +- 0.0231
ID_TEST    = 0.4706 +- 0.0211
VAL        = 0.3814 +- 0.0625
TEST       = 0.9243 +- 0.3583
Diff id_val-test  = 0.4423 
DONE TRAIN LECI GOODMotif/basis hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:54:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:54:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.8957
Train Loss: 0.4254
ID Validation ACCURACY: 0.9010
ID Validation Loss: 0.4344
ID Test ACCURACY: 0.8963
ID Test Loss: 0.4276
OOD Validation ACCURACY: 0.8990
OOD Validation Loss: 0.3962
OOD Test ACCURACY: 0.8563
OOD Test Loss: 0.4910

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 106...
[0m[1;37mINFO[0m: [1mCheckpoint 106: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4466
ID Validation ACCURACY: 0.8887
ID Validation Loss: 0.4594
ID Test ACCURACY: 0.8910
ID Test Loss: 0.4409
OOD Validation ACCURACY: 0.9113
OOD Validation Loss: 0.3833
OOD Test ACCURACY: 0.8360
OOD Test Loss: 0.5033

[0m[1;37mINFO[0m: [1mChartInfo 0.8963 0.8563 0.8910 0.8360 0.8887 0.9113[0mTrain ACCURACY: 0.8957Train Loss: 0.4254
Id_val ACCURACY: 0.9010Id_val Loss: 0.4344
Id_test ACCURACY: 0.8963Id_test Loss: 0.4276
Val ACCURACY: 0.8990Val Loss: 0.3962
Test ACCURACY: 0.8563Test Loss: 0.4910


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:55:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9083
Train Loss: 0.4103
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4320
ID Test ACCURACY: 0.9007
ID Test Loss: 0.4283
OOD Validation ACCURACY: 0.9240
OOD Validation Loss: 0.3518
OOD Test ACCURACY: 0.6320
OOD Test Loss: 0.8938

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.8859
Train Loss: 0.4323
ID Validation ACCURACY: 0.8810
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.8767
ID Test Loss: 0.4555
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3934
OOD Test ACCURACY: 0.7107
OOD Test Loss: 0.7650

[0m[1;37mINFO[0m: [1mChartInfo 0.9007 0.6320 0.8767 0.7107 0.8810 0.9303[0mTrain ACCURACY: 0.9083Train Loss: 0.4103
Id_val ACCURACY: 0.9060Id_val Loss: 0.4320
Id_test ACCURACY: 0.9007Id_test Loss: 0.4283
Val ACCURACY: 0.9240Val Loss: 0.3518
Test ACCURACY: 0.6320Test Loss: 0.8938


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:55:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9186
Train Loss: 0.3698
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3807
ID Test ACCURACY: 0.9177
ID Test Loss: 0.3790
OOD Validation ACCURACY: 0.8370
OOD Validation Loss: 0.5056
OOD Test ACCURACY: 0.8183
OOD Test Loss: 0.5524

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9143
Train Loss: 0.4007
ID Validation ACCURACY: 0.9140
ID Validation Loss: 0.4218
ID Test ACCURACY: 0.9137
ID Test Loss: 0.4092
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.3548
OOD Test ACCURACY: 0.8710
OOD Test Loss: 0.4604

[0m[1;37mINFO[0m: [1mChartInfo 0.9177 0.8183 0.9137 0.8710 0.9140 0.9300[0mTrain ACCURACY: 0.9186Train Loss: 0.3698
Id_val ACCURACY: 0.9210Id_val Loss: 0.3807
Id_test ACCURACY: 0.9177Id_test Loss: 0.3790
Val ACCURACY: 0.8370Val Loss: 0.5056
Test ACCURACY: 0.8183Test Loss: 0.5524


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:55:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:55:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9051
Train Loss: 0.4198
ID Validation ACCURACY: 0.9067
ID Validation Loss: 0.4427
ID Test ACCURACY: 0.9010
ID Test Loss: 0.4254
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4876
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.8108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9004
Train Loss: 0.4155
ID Validation ACCURACY: 0.9010
ID Validation Loss: 0.4316
ID Test ACCURACY: 0.9057
ID Test Loss: 0.4111
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4019
OOD Test ACCURACY: 0.8080
OOD Test Loss: 0.5560

[0m[1;37mINFO[0m: [1mChartInfo 0.9010 0.6950 0.9057 0.8080 0.9010 0.9017[0mTrain ACCURACY: 0.9051Train Loss: 0.4198
Id_val ACCURACY: 0.9067Id_val Loss: 0.4427
Id_test ACCURACY: 0.9010Id_test Loss: 0.4254
Val ACCURACY: 0.8670Val Loss: 0.4876
Test ACCURACY: 0.6950Test Loss: 0.8108


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:56:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 0.9209
Train Loss: 0.3902
ID Validation ACCURACY: 0.9183
ID Validation Loss: 0.4069
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4009
OOD Validation ACCURACY: 0.9020
OOD Validation Loss: 0.3790
OOD Test ACCURACY: 0.7547
OOD Test Loss: 0.7213

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9146
Train Loss: 0.3940
ID Validation ACCURACY: 0.9120
ID Validation Loss: 0.4108
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4032
OOD Validation ACCURACY: 0.9193
OOD Validation Loss: 0.3568
OOD Test ACCURACY: 0.5650
OOD Test Loss: 1.2477

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.7547 0.9153 0.5650 0.9120 0.9193[0mTrain ACCURACY: 0.9209Train Loss: 0.3902
Id_val ACCURACY: 0.9183Id_val Loss: 0.4069
Id_test ACCURACY: 0.9183Id_test Loss: 0.4009
Val ACCURACY: 0.9020Val Loss: 0.3790
Test ACCURACY: 0.7547Test Loss: 0.7213


Final accuracies: 
TRAIN      = 0.910 +- 0.009
ID_VAL     = 0.911 +- 0.008
ID_TEST    = 0.907 +- 0.009
VAL        = 0.886 +- 0.030
TEST       = 0.751 +- 0.081

Final losses: 
TRAIN      = 0.4031 +- 0.0205
ID_VAL     = 0.4193 +- 0.0227
ID_TEST    = 0.4122 +- 0.0195
VAL        = 0.4240 +- 0.0612
TEST       = 0.6939 +- 0.1520
Diff id_val-test  = 0.2746 
DONE TRAIN LECI GOODMotif/basis anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:56:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:56:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.8919
Train Loss: 0.4402
ID Validation ACCURACY: 0.8920
ID Validation Loss: 0.4334
ID Test ACCURACY: 0.8870
ID Test Loss: 0.4639
OOD Validation ACCURACY: 0.7780
OOD Validation Loss: 0.6049
OOD Test ACCURACY: 0.7937
OOD Test Loss: 0.6760

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.8381
Train Loss: 0.5254
ID Validation ACCURACY: 0.8367
ID Validation Loss: 0.5281
ID Test ACCURACY: 0.8403
ID Test Loss: 0.5399
OOD Validation ACCURACY: 0.9063
OOD Validation Loss: 0.5418
OOD Test ACCURACY: 0.8933
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.8870 0.7937 0.8403 0.8933 0.8367 0.9063[0mTrain ACCURACY: 0.8919Train Loss: 0.4402
Id_val ACCURACY: 0.8920Id_val Loss: 0.4334
Id_test ACCURACY: 0.8870Id_test Loss: 0.4639
Val ACCURACY: 0.7780Val Loss: 0.6049
Test ACCURACY: 0.7937Test Loss: 0.6760


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:57:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.8941
Train Loss: 0.4387
ID Validation ACCURACY: 0.8933
ID Validation Loss: 0.4199
ID Test ACCURACY: 0.8857
ID Test Loss: 0.4740
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4243
OOD Test ACCURACY: 0.9167
OOD Test Loss: 0.3882

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ACCURACY: 0.8941
Train Loss: 0.4387
ID Validation ACCURACY: 0.8933
ID Validation Loss: 0.4199
ID Test ACCURACY: 0.8857
ID Test Loss: 0.4740
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4243
OOD Test ACCURACY: 0.9167
OOD Test Loss: 0.3882

[0m[1;37mINFO[0m: [1mChartInfo 0.8857 0.9167 0.8857 0.9167 0.8933 0.9263[0mTrain ACCURACY: 0.8941Train Loss: 0.4387
Id_val ACCURACY: 0.8933Id_val Loss: 0.4199
Id_test ACCURACY: 0.8857Id_test Loss: 0.4740
Val ACCURACY: 0.9263Val Loss: 0.4243
Test ACCURACY: 0.9167Test Loss: 0.3882


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:57:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8840
Train Loss: 0.4621
ID Validation ACCURACY: 0.8847
ID Validation Loss: 0.4565
ID Test ACCURACY: 0.8710
ID Test Loss: 0.4904
OOD Validation ACCURACY: 0.8557
OOD Validation Loss: 0.5559
OOD Test ACCURACY: 0.8713
OOD Test Loss: 0.4670

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.8378
Train Loss: 0.5626
ID Validation ACCURACY: 0.8373
ID Validation Loss: 0.5631
ID Test ACCURACY: 0.8380
ID Test Loss: 0.5713
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.5173
OOD Test ACCURACY: 0.8860
OOD Test Loss: 0.4481

[0m[1;37mINFO[0m: [1mChartInfo 0.8710 0.8713 0.8380 0.8860 0.8373 0.9187[0mTrain ACCURACY: 0.8840Train Loss: 0.4621
Id_val ACCURACY: 0.8847Id_val Loss: 0.4565
Id_test ACCURACY: 0.8710Id_test Loss: 0.4904
Val ACCURACY: 0.8557Val Loss: 0.5559
Test ACCURACY: 0.8713Test Loss: 0.4670


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:57:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:57:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 131...
[0m[1;37mINFO[0m: [1mCheckpoint 131: 
-----------------------------------
Train ACCURACY: 0.8867
Train Loss: 0.4438
ID Validation ACCURACY: 0.8937
ID Validation Loss: 0.4262
ID Test ACCURACY: 0.8900
ID Test Loss: 0.4573
OOD Validation ACCURACY: 0.8703
OOD Validation Loss: 0.5403
OOD Test ACCURACY: 0.8920
OOD Test Loss: 0.4081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 151...
[0m[1;37mINFO[0m: [1mCheckpoint 151: 
-----------------------------------
Train ACCURACY: 0.8267
Train Loss: 0.5441
ID Validation ACCURACY: 0.8370
ID Validation Loss: 0.5474
ID Test ACCURACY: 0.8303
ID Test Loss: 0.5671
OOD Validation ACCURACY: 0.8900
OOD Validation Loss: 0.5611
OOD Test ACCURACY: 0.7843
OOD Test Loss: 0.6018

[0m[1;37mINFO[0m: [1mChartInfo 0.8900 0.8920 0.8303 0.7843 0.8370 0.8900[0mTrain ACCURACY: 0.8867Train Loss: 0.4438
Id_val ACCURACY: 0.8937Id_val Loss: 0.4262
Id_test ACCURACY: 0.8900Id_test Loss: 0.4573
Val ACCURACY: 0.8703Val Loss: 0.5403
Test ACCURACY: 0.8920Test Loss: 0.4081


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:58:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.8653
Train Loss: 0.4841
ID Validation ACCURACY: 0.8673
ID Validation Loss: 0.4704
ID Test ACCURACY: 0.8673
ID Test Loss: 0.4934
OOD Validation ACCURACY: 0.8580
OOD Validation Loss: 0.5922
OOD Test ACCURACY: 0.8357
OOD Test Loss: 0.5047

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ACCURACY: 0.8568
Train Loss: 0.4933
ID Validation ACCURACY: 0.8580
ID Validation Loss: 0.4774
ID Test ACCURACY: 0.8570
ID Test Loss: 0.5011
OOD Validation ACCURACY: 0.8980
OOD Validation Loss: 0.5087
OOD Test ACCURACY: 0.8823
OOD Test Loss: 0.4434

[0m[1;37mINFO[0m: [1mChartInfo 0.8673 0.8357 0.8570 0.8823 0.8580 0.8980[0mTrain ACCURACY: 0.8653Train Loss: 0.4841
Id_val ACCURACY: 0.8673Id_val Loss: 0.4704
Id_test ACCURACY: 0.8673Id_test Loss: 0.4934
Val ACCURACY: 0.8580Val Loss: 0.5922
Test ACCURACY: 0.8357Test Loss: 0.5047


Final accuracies: 
TRAIN      = 0.884 +- 0.010
ID_VAL     = 0.886 +- 0.010
ID_TEST    = 0.880 +- 0.009
VAL        = 0.858 +- 0.047
TEST       = 0.862 +- 0.043

Final losses: 
TRAIN      = 0.4538 +- 0.0173
ID_VAL     = 0.4413 +- 0.0191
ID_TEST    = 0.4758 +- 0.0142
VAL        = 0.5436 +- 0.0641
TEST       = 0.4888 +- 0.1024
Diff id_val-test  = 0.0475 
DONE TRAIN LECI GOODMotif2/basis hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:58:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:58:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.9133
Train Loss: 0.4290
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.4031
ID Test ACCURACY: 0.9080
ID Test Loss: 0.4515
OOD Validation ACCURACY: 0.9227
OOD Validation Loss: 0.3936
OOD Test ACCURACY: 0.8737
OOD Test Loss: 0.4903

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 104...
[0m[1;37mINFO[0m: [1mCheckpoint 104: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.4715
ID Validation ACCURACY: 0.8663
ID Validation Loss: 0.4430
ID Test ACCURACY: 0.8633
ID Test Loss: 0.4820
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3746
OOD Test ACCURACY: 0.7837
OOD Test Loss: 0.6415

[0m[1;37mINFO[0m: [1mChartInfo 0.9080 0.8737 0.8633 0.7837 0.8663 0.9313[0mTrain ACCURACY: 0.9133Train Loss: 0.4290
Id_val ACCURACY: 0.9237Id_val Loss: 0.4031
Id_test ACCURACY: 0.9080Id_test Loss: 0.4515
Val ACCURACY: 0.9227Val Loss: 0.3936
Test ACCURACY: 0.8737Test Loss: 0.4903


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:59:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9118
Train Loss: 0.4030
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3794
ID Test ACCURACY: 0.9047
ID Test Loss: 0.4384
OOD Validation ACCURACY: 0.9233
OOD Validation Loss: 0.3768
OOD Test ACCURACY: 0.8853
OOD Test Loss: 0.4748

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 113...
[0m[1;37mINFO[0m: [1mCheckpoint 113: 
-----------------------------------
Train ACCURACY: 0.8885
Train Loss: 0.4487
ID Validation ACCURACY: 0.8923
ID Validation Loss: 0.4387
ID Test ACCURACY: 0.8827
ID Test Loss: 0.4705
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.4388
OOD Test ACCURACY: 0.7740
OOD Test Loss: 0.7590

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.8853 0.8827 0.7740 0.8923 0.9290[0mTrain ACCURACY: 0.9118Train Loss: 0.4030
Id_val ACCURACY: 0.9210Id_val Loss: 0.3794
Id_test ACCURACY: 0.9047Id_test Loss: 0.4384
Val ACCURACY: 0.9233Val Loss: 0.3768
Test ACCURACY: 0.8853Test Loss: 0.4748


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 10:59:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 10:59:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.8932
Train Loss: 0.4562
ID Validation ACCURACY: 0.9020
ID Validation Loss: 0.4325
ID Test ACCURACY: 0.8937
ID Test Loss: 0.4701
OOD Validation ACCURACY: 0.9143
OOD Validation Loss: 0.4605
OOD Test ACCURACY: 0.8143
OOD Test Loss: 0.5237

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.8433
Train Loss: 0.5132
ID Validation ACCURACY: 0.8480
ID Validation Loss: 0.5068
ID Test ACCURACY: 0.8413
ID Test Loss: 0.5417
OOD Validation ACCURACY: 0.9147
OOD Validation Loss: 0.5475
OOD Test ACCURACY: 0.8277
OOD Test Loss: 0.5372

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.8143 0.8413 0.8277 0.8480 0.9147[0mTrain ACCURACY: 0.8932Train Loss: 0.4562
Id_val ACCURACY: 0.9020Id_val Loss: 0.4325
Id_test ACCURACY: 0.8937Id_test Loss: 0.4701
Val ACCURACY: 0.9143Val Loss: 0.4605
Test ACCURACY: 0.8143Test Loss: 0.5237


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:00:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9057
Train Loss: 0.4303
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4156
ID Test ACCURACY: 0.8993
ID Test Loss: 0.4653
OOD Validation ACCURACY: 0.9207
OOD Validation Loss: 0.4392
OOD Test ACCURACY: 0.8143
OOD Test Loss: 0.4806

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.8659
Train Loss: 0.5021
ID Validation ACCURACY: 0.8630
ID Validation Loss: 0.5023
ID Test ACCURACY: 0.8600
ID Test Loss: 0.5351
OOD Validation ACCURACY: 0.9283
OOD Validation Loss: 0.4432
OOD Test ACCURACY: 0.7227
OOD Test Loss: 0.7492

[0m[1;37mINFO[0m: [1mChartInfo 0.8993 0.8143 0.8600 0.7227 0.8630 0.9283[0mTrain ACCURACY: 0.9057Train Loss: 0.4303
Id_val ACCURACY: 0.9100Id_val Loss: 0.4156
Id_test ACCURACY: 0.8993Id_test Loss: 0.4653
Val ACCURACY: 0.9207Val Loss: 0.4392
Test ACCURACY: 0.8143Test Loss: 0.4806


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:00:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:00:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.9087
Train Loss: 0.4218
ID Validation ACCURACY: 0.9160
ID Validation Loss: 0.3999
ID Test ACCURACY: 0.9063
ID Test Loss: 0.4570
OOD Validation ACCURACY: 0.9247
OOD Validation Loss: 0.4378
OOD Test ACCURACY: 0.7653
OOD Test Loss: 0.7567

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ACCURACY: 0.8616
Train Loss: 0.5039
ID Validation ACCURACY: 0.8560
ID Validation Loss: 0.5048
ID Test ACCURACY: 0.8567
ID Test Loss: 0.5356
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4136
OOD Test ACCURACY: 0.7727
OOD Test Loss: 0.6722

[0m[1;37mINFO[0m: [1mChartInfo 0.9063 0.7653 0.8567 0.7727 0.8560 0.9293[0mTrain ACCURACY: 0.9087Train Loss: 0.4218
Id_val ACCURACY: 0.9160Id_val Loss: 0.3999
Id_test ACCURACY: 0.9063Id_test Loss: 0.4570
Val ACCURACY: 0.9247Val Loss: 0.4378
Test ACCURACY: 0.7653Test Loss: 0.7567


Final accuracies: 
TRAIN      = 0.907 +- 0.007
ID_VAL     = 0.915 +- 0.008
ID_TEST    = 0.902 +- 0.005
VAL        = 0.921 +- 0.004
TEST       = 0.831 +- 0.044

Final losses: 
TRAIN      = 0.4281 +- 0.0171
ID_VAL     = 0.4061 +- 0.0176
ID_TEST    = 0.4565 +- 0.0111
VAL        = 0.4216 +- 0.0312
TEST       = 0.5452 +- 0.1071
Diff id_val-test  = 0.1391 
DONE TRAIN LECI GOODMotif2/basis anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:01:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:01:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 161...
[0m[1;37mINFO[0m: [1mCheckpoint 161: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9232
ID Validation Loss: 0.4071
ID Test ACCURACY: 0.9138
ID Test Loss: 0.4704
OOD Validation ACCURACY: 0.8802
OOD Validation Loss: 0.6430
OOD Test ACCURACY: 0.8284
OOD Test Loss: 1.3885

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9219
ID Validation Loss: 0.4384
ID Test ACCURACY: 0.9176
ID Test Loss: 0.5121
OOD Validation ACCURACY: 0.8828
OOD Validation Loss: 0.6819
OOD Test ACCURACY: 0.8285
OOD Test Loss: 1.4679

[0m[1;37mINFO[0m: [1mChartInfo 0.9138 0.8284 0.9176 0.8285 0.9219 0.8828[0mTrain ACCURACY: 1.0000Train Loss: 0.0003
Id_val ACCURACY: 0.9232Id_val Loss: 0.4071
Id_test ACCURACY: 0.9138Id_test Loss: 0.4704
Val ACCURACY: 0.8802Val Loss: 0.6430
Test ACCURACY: 0.8284Test Loss: 1.3885


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:02:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:16 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:16 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:16 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:16 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:02:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9215
ID Validation Loss: 0.4292
ID Test ACCURACY: 0.9138
ID Test Loss: 0.4908
OOD Validation ACCURACY: 0.8802
OOD Validation Loss: 0.6680
OOD Test ACCURACY: 0.8261
OOD Test Loss: 1.4346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9990
Train Loss: 0.0057
ID Validation ACCURACY: 0.9157
ID Validation Loss: 0.2928
ID Test ACCURACY: 0.9127
ID Test Loss: 0.3309
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.4550
OOD Test ACCURACY: 0.8361
OOD Test Loss: 0.9548

[0m[1;37mINFO[0m: [1mChartInfo 0.9138 0.8261 0.9127 0.8361 0.9157 0.8829[0mTrain ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9215Id_val Loss: 0.4292
Id_test ACCURACY: 0.9138Id_test Loss: 0.4908
Val ACCURACY: 0.8802Val Loss: 0.6680
Test ACCURACY: 0.8261Test Loss: 1.4346


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:03:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:07 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 80...
[0m[1;37mINFO[0m: [1mCheckpoint 80: 
-----------------------------------
Train ACCURACY: 0.9991
Train Loss: 0.0067
ID Validation ACCURACY: 0.9191
ID Validation Loss: 0.3068
ID Test ACCURACY: 0.9104
ID Test Loss: 0.3679
OOD Validation ACCURACY: 0.8770
OOD Validation Loss: 0.5744
OOD Test ACCURACY: 0.8208
OOD Test Loss: 1.4759

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9187
ID Validation Loss: 0.4818
ID Test ACCURACY: 0.9189
ID Test Loss: 0.5496
OOD Validation ACCURACY: 0.8843
OOD Validation Loss: 0.6971
OOD Test ACCURACY: 0.8280
OOD Test Loss: 1.3584

[0m[1;37mINFO[0m: [1mChartInfo 0.9104 0.8208 0.9189 0.8280 0.9187 0.8843[0mTrain ACCURACY: 0.9991Train Loss: 0.0067
Id_val ACCURACY: 0.9191Id_val Loss: 0.3068
Id_test ACCURACY: 0.9104Id_test Loss: 0.3679
Val ACCURACY: 0.8770Val Loss: 0.5744
Test ACCURACY: 0.8208Test Loss: 1.4759


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:03:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:54 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:03:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9194
ID Validation Loss: 0.4390
ID Test ACCURACY: 0.9162
ID Test Loss: 0.5246
OOD Validation ACCURACY: 0.8849
OOD Validation Loss: 0.6551
OOD Test ACCURACY: 0.8289
OOD Test Loss: 1.3384

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.9178
ID Validation Loss: 0.4486
ID Test ACCURACY: 0.9172
ID Test Loss: 0.5292
OOD Validation ACCURACY: 0.8852
OOD Validation Loss: 0.6477
OOD Test ACCURACY: 0.8321
OOD Test Loss: 1.2473

[0m[1;37mINFO[0m: [1mChartInfo 0.9162 0.8289 0.9172 0.8321 0.9178 0.8852[0mTrain ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9194Id_val Loss: 0.4390
Id_test ACCURACY: 0.9162Id_test Loss: 0.5246
Val ACCURACY: 0.8849Val Loss: 0.6551
Test ACCURACY: 0.8289Test Loss: 1.3384


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:04:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:30 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:30 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:30 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:04:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0005
ID Validation ACCURACY: 0.9202
ID Validation Loss: 0.3844
ID Test ACCURACY: 0.9149
ID Test Loss: 0.4498
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.5759
OOD Test ACCURACY: 0.8366
OOD Test Loss: 0.9989

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9170
ID Validation Loss: 0.4333
ID Test ACCURACY: 0.9164
ID Test Loss: 0.5038
OOD Validation ACCURACY: 0.8868
OOD Validation Loss: 0.6171
OOD Test ACCURACY: 0.8387
OOD Test Loss: 1.0809

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.8366 0.9164 0.8387 0.9170 0.8868[0mTrain ACCURACY: 0.9999Train Loss: 0.0005
Id_val ACCURACY: 0.9202Id_val Loss: 0.3844
Id_test ACCURACY: 0.9149Id_test Loss: 0.4498
Val ACCURACY: 0.8829Val Loss: 0.5759
Test ACCURACY: 0.8366Test Loss: 0.9989


Final accuracies: 
TRAIN      = 1.000 +- 0.000
ID_VAL     = 0.921 +- 0.002
ID_TEST    = 0.914 +- 0.002
VAL        = 0.881 +- 0.003
TEST       = 0.828 +- 0.005

Final losses: 
TRAIN      = 0.0016 +- 0.0025
ID_VAL     = 0.3933 +- 0.0472
ID_TEST    = 0.4607 +- 0.0526
VAL        = 0.6233 +- 0.0401
TEST       = 1.3273 +- 0.1705
Diff id_val-test  = 0.9340 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE TRAIN LECI GOODSST2/length hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:05:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:05:35 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:05:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 168...
[0m[1;37mINFO[0m: [1mCheckpoint 168: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.3884
ID Test ACCURACY: 0.9149
ID Test Loss: 0.4476
OOD Validation ACCURACY: 0.8772
OOD Validation Loss: 0.5532
OOD Test ACCURACY: 0.8226
OOD Test Loss: 0.9289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 148...
[0m[1;37mINFO[0m: [1mCheckpoint 148: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0021
ID Validation ACCURACY: 0.9159
ID Validation Loss: 0.3511
ID Test ACCURACY: 0.9110
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.8826
OOD Validation Loss: 0.4988
OOD Test ACCURACY: 0.8356
OOD Test Loss: 0.8592

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.8226 0.9110 0.8356 0.9159 0.8826[0mTrain ACCURACY: 1.0000Train Loss: 0.0003
Id_val ACCURACY: 0.9208Id_val Loss: 0.3884
Id_test ACCURACY: 0.9149Id_test Loss: 0.4476
Val ACCURACY: 0.8772Val Loss: 0.5532
Test ACCURACY: 0.8226Test Loss: 0.9289


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:06:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.3737
ID Test ACCURACY: 0.9161
ID Test Loss: 0.4207
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.5304
OOD Test ACCURACY: 0.8254
OOD Test Loss: 1.0888

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9194
ID Validation Loss: 0.4219
ID Test ACCURACY: 0.9157
ID Test Loss: 0.4817
OOD Validation ACCURACY: 0.8832
OOD Validation Loss: 0.6079
OOD Test ACCURACY: 0.8258
OOD Test Loss: 1.2557

[0m[1;37mINFO[0m: [1mChartInfo 0.9161 0.8254 0.9157 0.8258 0.9194 0.8832[0mTrain ACCURACY: 1.0000Train Loss: 0.0005
Id_val ACCURACY: 0.9210Id_val Loss: 0.3737
Id_test ACCURACY: 0.9161Id_test Loss: 0.4207
Val ACCURACY: 0.8817Val Loss: 0.5304
Test ACCURACY: 0.8254Test Loss: 1.0888


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:06:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:06:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.4058
ID Test ACCURACY: 0.9147
ID Test Loss: 0.4863
OOD Validation ACCURACY: 0.8811
OOD Validation Loss: 0.5978
OOD Test ACCURACY: 0.8111
OOD Test Loss: 1.3825

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9211
ID Validation Loss: 0.4242
ID Test ACCURACY: 0.9145
ID Test Loss: 0.5078
OOD Validation ACCURACY: 0.8839
OOD Validation Loss: 0.6388
OOD Test ACCURACY: 0.8267
OOD Test Loss: 1.3856

[0m[1;37mINFO[0m: [1mChartInfo 0.9147 0.8111 0.9145 0.8267 0.9211 0.8839[0mTrain ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9247Id_val Loss: 0.4058
Id_test ACCURACY: 0.9147Id_test Loss: 0.4863
Val ACCURACY: 0.8811Val Loss: 0.5978
Test ACCURACY: 0.8111Test Loss: 1.3825


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:07:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:07:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9223
ID Validation Loss: 0.3683
ID Test ACCURACY: 0.9161
ID Test Loss: 0.4352
OOD Validation ACCURACY: 0.8814
OOD Validation Loss: 0.5797
OOD Test ACCURACY: 0.8193
OOD Test Loss: 1.6663

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9995
Train Loss: 0.0050
ID Validation ACCURACY: 0.9183
ID Validation Loss: 0.3159
ID Test ACCURACY: 0.9144
ID Test Loss: 0.3601
OOD Validation ACCURACY: 0.8839
OOD Validation Loss: 0.5335
OOD Test ACCURACY: 0.8287
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mChartInfo 0.9161 0.8193 0.9144 0.8287 0.9183 0.8839[0mTrain ACCURACY: 0.9999Train Loss: 0.0004
Id_val ACCURACY: 0.9223Id_val Loss: 0.3683
Id_test ACCURACY: 0.9161Id_test Loss: 0.4352
Val ACCURACY: 0.8814Val Loss: 0.5797
Test ACCURACY: 0.8193Test Loss: 1.6663


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:07:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:08:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.9994
Train Loss: 0.0042
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.3042
ID Test ACCURACY: 0.9100
ID Test Loss: 0.3409
OOD Validation ACCURACY: 0.8736
OOD Validation Loss: 0.4929
OOD Test ACCURACY: 0.8157
OOD Test Loss: 0.9444

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.9155
ID Validation Loss: 0.4081
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4411
OOD Validation ACCURACY: 0.8864
OOD Validation Loss: 0.5536
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.0612

[0m[1;37mINFO[0m: [1mChartInfo 0.9100 0.8157 0.9153 0.8255 0.9155 0.8864[0mTrain ACCURACY: 0.9994Train Loss: 0.0042
Id_val ACCURACY: 0.9200Id_val Loss: 0.3042
Id_test ACCURACY: 0.9100Id_test Loss: 0.3409
Val ACCURACY: 0.8736Val Loss: 0.4929
Test ACCURACY: 0.8157Test Loss: 0.9444


Final accuracies: 
TRAIN      = 1.000 +- 0.000
ID_VAL     = 0.922 +- 0.002
ID_TEST    = 0.914 +- 0.002
VAL        = 0.879 +- 0.003
TEST       = 0.819 +- 0.005

Final losses: 
TRAIN      = 0.0011 +- 0.0015
ID_VAL     = 0.3681 +- 0.0345
ID_TEST    = 0.4261 +- 0.0479
VAL        = 0.5508 +- 0.0369
TEST       = 1.2022 +- 0.2835
Diff id_val-test  = 0.8341 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE TRAIN LECI GOODSST2/length anneal

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:09:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:03 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:03 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:04 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.8247
Train Loss: 0.4478
ID Validation ACCURACY: 0.7004
ID Validation Loss: 0.9793
ID Test ACCURACY: 0.6913
ID Test Loss: 0.9987
OOD Validation ACCURACY: 0.6347
OOD Validation Loss: 1.2582
OOD Test ACCURACY: 0.5896
OOD Test Loss: 1.8350

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8525
Train Loss: 0.3804
ID Validation ACCURACY: 0.6787
ID Validation Loss: 1.0172
ID Test ACCURACY: 0.6787
ID Test Loss: 1.0574
OOD Validation ACCURACY: 0.6381
OOD Validation Loss: 1.2694
OOD Test ACCURACY: 0.6074
OOD Test Loss: 1.7435

[0m[1;37mINFO[0m: [1mChartInfo 0.6913 0.5896 0.6787 0.6074 0.6787 0.6381[0mTrain ACCURACY: 0.8247Train Loss: 0.4478
Id_val ACCURACY: 0.7004Id_val Loss: 0.9793
Id_test ACCURACY: 0.6913Id_test Loss: 0.9987
Val ACCURACY: 0.6347Val Loss: 1.2582
Test ACCURACY: 0.5896Test Loss: 1.8350


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:09:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9425
Train Loss: 0.1667
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.2093
ID Test ACCURACY: 0.6787
ID Test Loss: 1.3015
OOD Validation ACCURACY: 0.6179
OOD Validation Loss: 1.6746
OOD Test ACCURACY: 0.5738
OOD Test Loss: 2.2987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 8...
[0m[1;37mINFO[0m: [1mCheckpoint 8: 
-----------------------------------
Train ACCURACY: 0.7544
Train Loss: 0.6546
ID Validation ACCURACY: 0.6787
ID Validation Loss: 1.0050
ID Test ACCURACY: 0.6751
ID Test Loss: 0.9474
OOD Validation ACCURACY: 0.6331
OOD Validation Loss: 1.1678
OOD Test ACCURACY: 0.5848
OOD Test Loss: 1.4431

[0m[1;37mINFO[0m: [1mChartInfo 0.6787 0.5738 0.6751 0.5848 0.6787 0.6331[0mTrain ACCURACY: 0.9425Train Loss: 0.1667
Id_val ACCURACY: 0.7040Id_val Loss: 1.2093
Id_test ACCURACY: 0.6787Id_test Loss: 1.3015
Val ACCURACY: 0.6179Val Loss: 1.6746
Test ACCURACY: 0.5738Test Loss: 2.2987


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:09:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8552
Train Loss: 0.3957
ID Validation ACCURACY: 0.7184
ID Validation Loss: 0.9655
ID Test ACCURACY: 0.6805
ID Test Loss: 1.0729
OOD Validation ACCURACY: 0.6342
OOD Validation Loss: 1.4058
OOD Test ACCURACY: 0.5875
OOD Test Loss: 1.9096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8552
Train Loss: 0.3957
ID Validation ACCURACY: 0.7184
ID Validation Loss: 0.9655
ID Test ACCURACY: 0.6805
ID Test Loss: 1.0729
OOD Validation ACCURACY: 0.6342
OOD Validation Loss: 1.4058
OOD Test ACCURACY: 0.5875
OOD Test Loss: 1.9096

[0m[1;37mINFO[0m: [1mChartInfo 0.6805 0.5875 0.6805 0.5875 0.7184 0.6342[0mTrain ACCURACY: 0.8552Train Loss: 0.3957
Id_val ACCURACY: 0.7184Id_val Loss: 0.9655
Id_test ACCURACY: 0.6805Id_test Loss: 1.0729
Val ACCURACY: 0.6342Val Loss: 1.4058
Test ACCURACY: 0.5875Test Loss: 1.9096


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:09:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 45...
[0m[1;37mINFO[0m: [1mCheckpoint 45: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0078
ID Validation ACCURACY: 0.7022
ID Validation Loss: 1.7503
ID Test ACCURACY: 0.6733
ID Test Loss: 1.9391
OOD Validation ACCURACY: 0.6056
OOD Validation Loss: 2.3958
OOD Test ACCURACY: 0.5594
OOD Test Loss: 3.4823

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.9151
Train Loss: 0.2350
ID Validation ACCURACY: 0.6895
ID Validation Loss: 1.2064
ID Test ACCURACY: 0.6805
ID Test Loss: 1.2517
OOD Validation ACCURACY: 0.6342
OOD Validation Loss: 1.6038
OOD Test ACCURACY: 0.5937
OOD Test Loss: 2.1227

[0m[1;37mINFO[0m: [1mChartInfo 0.6733 0.5594 0.6805 0.5937 0.6895 0.6342[0mTrain ACCURACY: 0.9977Train Loss: 0.0078
Id_val ACCURACY: 0.7022Id_val Loss: 1.7503
Id_test ACCURACY: 0.6733Id_test Loss: 1.9391
Val ACCURACY: 0.6056Val Loss: 2.3958
Test ACCURACY: 0.5594Test Loss: 3.4823


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'hard',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:09:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.8317
Train Loss: 0.4556
ID Validation ACCURACY: 0.6877
ID Validation Loss: 1.0401
ID Test ACCURACY: 0.6823
ID Test Loss: 1.1431
OOD Validation ACCURACY: 0.6280
OOD Validation Loss: 1.4168
OOD Test ACCURACY: 0.5882
OOD Test Loss: 2.0213

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 12...
[0m[1;37mINFO[0m: [1mCheckpoint 12: 
-----------------------------------
Train ACCURACY: 0.8131
Train Loss: 0.4676
ID Validation ACCURACY: 0.6552
ID Validation Loss: 0.9394
ID Test ACCURACY: 0.6877
ID Test Loss: 0.9807
OOD Validation ACCURACY: 0.6353
OOD Validation Loss: 1.2476
OOD Test ACCURACY: 0.5765
OOD Test Loss: 1.7766

[0m[1;37mINFO[0m: [1mChartInfo 0.6823 0.5882 0.6877 0.5765 0.6552 0.6353[0mTrain ACCURACY: 0.8317Train Loss: 0.4556
Id_val ACCURACY: 0.6877Id_val Loss: 1.0401
Id_test ACCURACY: 0.6823Id_test Loss: 1.1431
Val ACCURACY: 0.6280Val Loss: 1.4168
Test ACCURACY: 0.5882Test Loss: 2.0213


Final accuracies: 
TRAIN      = 0.890 +- 0.068
ID_VAL     = 0.703 +- 0.010
ID_TEST    = 0.681 +- 0.006
VAL        = 0.624 +- 0.011
TEST       = 0.580 +- 0.012

Final losses: 
TRAIN      = 0.2947 +- 0.1779
ID_VAL     = 1.1889 +- 0.2938
ID_TEST    = 1.2911 +- 0.3391
VAL        = 1.6302 +- 0.4055
TEST       = 2.3094 +- 0.6072
Diff id_val-test  = 1.1205 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE TRAIN LECI GOODTwitter/length hard

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:09:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.6949
ID Validation Loss: 3.1220
ID Test ACCURACY: 0.6715
ID Test Loss: 3.1210
OOD Validation ACCURACY: 0.5972
OOD Validation Loss: 3.9517
OOD Test ACCURACY: 0.5436
OOD Test Loss: 5.5896

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 12...
[0m[1;37mINFO[0m: [1mCheckpoint 12: 
-----------------------------------
Train ACCURACY: 0.8382
Train Loss: 0.4283
ID Validation ACCURACY: 0.6751
ID Validation Loss: 0.8734
ID Test ACCURACY: 0.6913
ID Test Loss: 0.8739
OOD Validation ACCURACY: 0.6291
OOD Validation Loss: 1.1390
OOD Test ACCURACY: 0.5978
OOD Test Loss: 1.5533

[0m[1;37mINFO[0m: [1mChartInfo 0.6715 0.5436 0.6913 0.5978 0.6751 0.6291[0mTrain ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.6949Id_val Loss: 3.1220
Id_test ACCURACY: 0.6715Id_test Loss: 3.1210
Val ACCURACY: 0.5972Val Loss: 3.9517
Test ACCURACY: 0.5436Test Loss: 5.5896


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:09:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:47 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8892
Train Loss: 0.3033
ID Validation ACCURACY: 0.7022
ID Validation Loss: 0.9031
ID Test ACCURACY: 0.6931
ID Test Loss: 0.9372
OOD Validation ACCURACY: 0.6347
OOD Validation Loss: 1.2072
OOD Test ACCURACY: 0.5813
OOD Test Loss: 1.6533

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.8606
Train Loss: 0.3678
ID Validation ACCURACY: 0.6968
ID Validation Loss: 0.8431
ID Test ACCURACY: 0.6805
ID Test Loss: 0.8699
OOD Validation ACCURACY: 0.6443
OOD Validation Loss: 1.0506
OOD Test ACCURACY: 0.5964
OOD Test Loss: 1.3458

[0m[1;37mINFO[0m: [1mChartInfo 0.6931 0.5813 0.6805 0.5964 0.6968 0.6443[0mTrain ACCURACY: 0.8892Train Loss: 0.3033
Id_val ACCURACY: 0.7022Id_val Loss: 0.9031
Id_test ACCURACY: 0.6931Id_test Loss: 0.9372
Val ACCURACY: 0.6347Val Loss: 1.2072
Test ACCURACY: 0.5813Test Loss: 1.6533


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:09:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ACCURACY: 0.8734
Train Loss: 0.3344
ID Validation ACCURACY: 0.7202
ID Validation Loss: 0.8706
ID Test ACCURACY: 0.6751
ID Test Loss: 0.9643
OOD Validation ACCURACY: 0.6291
OOD Validation Loss: 1.2646
OOD Test ACCURACY: 0.5882
OOD Test Loss: 1.8504

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9448
Train Loss: 0.1544
ID Validation ACCURACY: 0.6841
ID Validation Loss: 1.0118
ID Test ACCURACY: 0.6625
ID Test Loss: 1.1612
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 1.4160
OOD Test ACCURACY: 0.5779
OOD Test Loss: 2.1088

[0m[1;37mINFO[0m: [1mChartInfo 0.6751 0.5882 0.6625 0.5779 0.6841 0.6437[0mTrain ACCURACY: 0.8734Train Loss: 0.3344
Id_val ACCURACY: 0.7202Id_val Loss: 0.8706
Id_test ACCURACY: 0.6751Id_test Loss: 0.9643
Val ACCURACY: 0.6291Val Loss: 1.2646
Test ACCURACY: 0.5882Test Loss: 1.8504


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:09:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:09:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 100...
[0m[1;37mINFO[0m: [1mCheckpoint 100: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0005
ID Validation ACCURACY: 0.6986
ID Validation Loss: 3.3225
ID Test ACCURACY: 0.6823
ID Test Loss: 3.4204
OOD Validation ACCURACY: 0.6090
OOD Validation Loss: 4.1729
OOD Test ACCURACY: 0.5573
OOD Test Loss: 6.0573

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8158
Train Loss: 0.4571
ID Validation ACCURACY: 0.6841
ID Validation Loss: 0.8000
ID Test ACCURACY: 0.7040
ID Test Loss: 0.7929
OOD Validation ACCURACY: 0.6415
OOD Validation Loss: 1.0189
OOD Test ACCURACY: 0.5889
OOD Test Loss: 1.3595

[0m[1;37mINFO[0m: [1mChartInfo 0.6823 0.5573 0.7040 0.5889 0.6841 0.6415[0mTrain ACCURACY: 1.0000Train Loss: 0.0005
Id_val ACCURACY: 0.6986Id_val Loss: 3.3225
Id_test ACCURACY: 0.6823Id_test Loss: 3.4204
Val ACCURACY: 0.6090Val Loss: 4.1729
Test ACCURACY: 0.5573Test Loss: 6.0573


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'anneal',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 11:10:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 05/03/2024 11:10:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9351
Train Loss: 0.1964
ID Validation ACCURACY: 0.7004
ID Validation Loss: 0.9889
ID Test ACCURACY: 0.6715
ID Test Loss: 1.0936
OOD Validation ACCURACY: 0.6213
OOD Validation Loss: 1.3820
OOD Test ACCURACY: 0.5806
OOD Test Loss: 1.9963

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8988
Train Loss: 0.2761
ID Validation ACCURACY: 0.6841
ID Validation Loss: 0.9618
ID Test ACCURACY: 0.6859
ID Test Loss: 0.9980
OOD Validation ACCURACY: 0.6392
OOD Validation Loss: 1.2491
OOD Test ACCURACY: 0.5957
OOD Test Loss: 1.7247

[0m[1;37mINFO[0m: [1mChartInfo 0.6715 0.5806 0.6859 0.5957 0.6841 0.6392[0mTrain ACCURACY: 0.9351Train Loss: 0.1964
Id_val ACCURACY: 0.7004Id_val Loss: 0.9889
Id_test ACCURACY: 0.6715Id_test Loss: 1.0936
Val ACCURACY: 0.6213Val Loss: 1.3820
Test ACCURACY: 0.5806Test Loss: 1.9963


Final accuracies: 
TRAIN      = 0.940 +- 0.053
ID_VAL     = 0.703 +- 0.009
ID_TEST    = 0.679 +- 0.008
VAL        = 0.618 +- 0.014
TEST       = 0.570 +- 0.017

Final losses: 
TRAIN      = 0.1670 +- 0.1436
ID_VAL     = 1.8414 +- 1.1299
ID_TEST    = 1.9073 +- 1.1185
VAL        = 2.3957 +- 1.3638
TEST       = 3.4294 +- 1.9634
Diff id_val-test  = 1.5880 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE TRAIN LECI GOODTwitter/length anneal
DONE all :)
