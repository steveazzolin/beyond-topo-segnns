Time to compute metrics!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:43:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:43:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9222
Train Loss: 0.3693
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3559
ID Test ACCURACY: 0.9203
ID Test Loss: 0.3852
OOD Validation ACCURACY: 0.8900
OOD Validation Loss: 0.4914
OOD Test ACCURACY: 0.5517
OOD Test Loss: 1.5316

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9157
Train Loss: 0.3791
ID Validation ACCURACY: 0.9230
ID Validation Loss: 0.3661
ID Test ACCURACY: 0.9137
ID Test Loss: 0.3922
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.4447
OOD Test ACCURACY: 0.6490
OOD Test Loss: 1.4331

[0m[1;37mINFO[0m: [1mChartInfo 0.9203 0.5517 0.9137 0.6490 0.9230 0.9270[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.625
WIoU for r=0.3 = 0.493
F1 for r=0.6 = 0.550
WIoU for r=0.6 = 0.423
F1 for r=0.9 = 0.443
WIoU for r=0.9 = 0.314
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.313


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.47
Model XAI F1 of binarized graphs for r=0.3 =  0.6254275
Model XAI WIoU of binarized graphs for r=0.3 =  0.4932075
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.317
NEC for r=0.3 class 0 = 0.671 +- 0.312 (in-sample avg dev_std = 0.486)
NEC for r=0.3 class 1 = 0.555 +- 0.312 (in-sample avg dev_std = 0.486)
NEC for r=0.3 class 2 = 0.58 +- 0.312 (in-sample avg dev_std = 0.486)
NEC for r=0.3 all KL = 0.616 +- 0.312 (in-sample avg dev_std = 0.486)
NEC for r=0.3 all L1 = 0.602 +- 0.167 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.665
Model XAI F1 of binarized graphs for r=0.6 =  0.5496837499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.42250499999999996
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.379
NEC for r=0.6 class 0 = 0.597 +- 0.255 (in-sample avg dev_std = 0.562)
NEC for r=0.6 class 1 = 0.645 +- 0.255 (in-sample avg dev_std = 0.562)
NEC for r=0.6 class 2 = 0.598 +- 0.255 (in-sample avg dev_std = 0.562)
NEC for r=0.6 all KL = 0.714 +- 0.255 (in-sample avg dev_std = 0.562)
NEC for r=0.6 all L1 = 0.613 +- 0.149 (in-sample avg dev_std = 0.562)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.819
Model XAI F1 of binarized graphs for r=0.9 =  0.44285875
Model XAI WIoU of binarized graphs for r=0.9 =  0.31431625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.461
NEC for r=0.9 class 0 = 0.54 +- 0.254 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 1 = 0.571 +- 0.254 (in-sample avg dev_std = 0.570)
NEC for r=0.9 class 2 = 0.512 +- 0.254 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all KL = 0.583 +- 0.254 (in-sample avg dev_std = 0.570)
NEC for r=0.9 all L1 = 0.54 +- 0.160 (in-sample avg dev_std = 0.570)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.313205
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.54
NEC for r=1.0 class 0 = 0.519 +- 0.268 (in-sample avg dev_std = 0.597)
NEC for r=1.0 class 1 = 0.511 +- 0.268 (in-sample avg dev_std = 0.597)
NEC for r=1.0 class 2 = 0.522 +- 0.268 (in-sample avg dev_std = 0.597)
NEC for r=1.0 all KL = 0.549 +- 0.268 (in-sample avg dev_std = 0.597)
NEC for r=1.0 all L1 = 0.517 +- 0.166 (in-sample avg dev_std = 0.597)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.47
Model XAI F1 of binarized graphs for r=0.3 =  0.6254275
Model XAI WIoU of binarized graphs for r=0.3 =  0.4932075
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.417
SUFF++ for r=0.3 class 0 = 0.394 +- 0.303 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 class 1 = 0.549 +- 0.303 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 class 2 = 0.564 +- 0.303 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 all KL = 0.485 +- 0.303 (in-sample avg dev_std = 0.537)
SUFF++ for r=0.3 all L1 = 0.503 +- 0.184 (in-sample avg dev_std = 0.537)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.661
Model XAI F1 of binarized graphs for r=0.6 =  0.5496837499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.42250499999999996
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.58
SUFF++ for r=0.6 class 0 = 0.469 +- 0.276 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.6 class 1 = 0.452 +- 0.276 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.6 class 2 = 0.693 +- 0.276 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.6 all KL = 0.483 +- 0.276 (in-sample avg dev_std = 0.506)
SUFF++ for r=0.6 all L1 = 0.541 +- 0.210 (in-sample avg dev_std = 0.506)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.819
Model XAI F1 of binarized graphs for r=0.9 =  0.44285875
Model XAI WIoU of binarized graphs for r=0.9 =  0.31431625
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.759
SUFF++ for r=0.9 class 0 = 0.618 +- 0.198 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 1 = 0.749 +- 0.198 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 class 2 = 0.881 +- 0.198 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all KL = 0.808 +- 0.198 (in-sample avg dev_std = 0.329)
SUFF++ for r=0.9 all L1 = 0.752 +- 0.182 (in-sample avg dev_std = 0.329)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:44:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:44:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.9236
Train Loss: 0.3823
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3640
ID Test ACCURACY: 0.9223
ID Test Loss: 0.3970
OOD Validation ACCURACY: 0.9163
OOD Validation Loss: 0.4602
OOD Test ACCURACY: 0.6380
OOD Test Loss: 1.7702

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9191
Train Loss: 0.3765
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3656
ID Test ACCURACY: 0.9180
ID Test Loss: 0.3905
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.4647
OOD Test ACCURACY: 0.5130
OOD Test Loss: 1.8937

[0m[1;37mINFO[0m: [1mChartInfo 0.9223 0.6380 0.9180 0.5130 0.9240 0.9257[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.611
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.524
WIoU for r=0.6 = 0.397
F1 for r=0.9 = 0.434
WIoU for r=0.9 = 0.307
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.313


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.451
Model XAI F1 of binarized graphs for r=0.3 =  0.6108812499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.48214375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.345
NEC for r=0.3 class 0 = 0.561 +- 0.299 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 1 = 0.521 +- 0.299 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 2 = 0.686 +- 0.299 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all KL = 0.655 +- 0.299 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all L1 = 0.591 +- 0.149 (in-sample avg dev_std = 0.412)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.743
Model XAI F1 of binarized graphs for r=0.6 =  0.524485
Model XAI WIoU of binarized graphs for r=0.6 =  0.3973925
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.459
NEC for r=0.6 class 0 = 0.65 +- 0.263 (in-sample avg dev_std = 0.581)
NEC for r=0.6 class 1 = 0.514 +- 0.263 (in-sample avg dev_std = 0.581)
NEC for r=0.6 class 2 = 0.628 +- 0.263 (in-sample avg dev_std = 0.581)
NEC for r=0.6 all KL = 0.716 +- 0.263 (in-sample avg dev_std = 0.581)
NEC for r=0.6 all L1 = 0.598 +- 0.153 (in-sample avg dev_std = 0.581)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.88
Model XAI F1 of binarized graphs for r=0.9 =  0.43436875
Model XAI WIoU of binarized graphs for r=0.9 =  0.30680250000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.533
NEC for r=0.9 class 0 = 0.574 +- 0.279 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 1 = 0.45 +- 0.279 (in-sample avg dev_std = 0.581)
NEC for r=0.9 class 2 = 0.556 +- 0.279 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all KL = 0.586 +- 0.279 (in-sample avg dev_std = 0.581)
NEC for r=0.9 all L1 = 0.528 +- 0.166 (in-sample avg dev_std = 0.581)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.31279
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.592
NEC for r=1.0 class 0 = 0.525 +- 0.290 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 1 = 0.37 +- 0.290 (in-sample avg dev_std = 0.576)
NEC for r=1.0 class 2 = 0.529 +- 0.290 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all KL = 0.526 +- 0.290 (in-sample avg dev_std = 0.576)
NEC for r=1.0 all L1 = 0.476 +- 0.191 (in-sample avg dev_std = 0.576)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.451
Model XAI F1 of binarized graphs for r=0.3 =  0.6108812499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.48214375
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.487
SUFF++ for r=0.3 class 0 = 0.435 +- 0.297 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.3 class 1 = 0.548 +- 0.297 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.3 class 2 = 0.54 +- 0.297 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.3 all KL = 0.445 +- 0.297 (in-sample avg dev_std = 0.507)
SUFF++ for r=0.3 all L1 = 0.508 +- 0.169 (in-sample avg dev_std = 0.507)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.743
Model XAI F1 of binarized graphs for r=0.6 =  0.524485
Model XAI WIoU of binarized graphs for r=0.6 =  0.3973925
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.588
SUFF++ for r=0.6 class 0 = 0.414 +- 0.287 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 class 1 = 0.508 +- 0.287 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 class 2 = 0.699 +- 0.287 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 all KL = 0.442 +- 0.287 (in-sample avg dev_std = 0.514)
SUFF++ for r=0.6 all L1 = 0.543 +- 0.199 (in-sample avg dev_std = 0.514)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.879
Model XAI F1 of binarized graphs for r=0.9 =  0.43436875
Model XAI WIoU of binarized graphs for r=0.9 =  0.30680250000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.797
SUFF++ for r=0.9 class 0 = 0.612 +- 0.214 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.9 class 1 = 0.762 +- 0.214 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.9 class 2 = 0.839 +- 0.214 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.9 all KL = 0.782 +- 0.214 (in-sample avg dev_std = 0.356)
SUFF++ for r=0.9 all L1 = 0.74 +- 0.185 (in-sample avg dev_std = 0.356)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:45:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:45:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 0.9211
Train Loss: 0.3738
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3569
ID Test ACCURACY: 0.9193
ID Test Loss: 0.3863
OOD Validation ACCURACY: 0.8863
OOD Validation Loss: 0.4868
OOD Test ACCURACY: 0.6483
OOD Test Loss: 1.2024

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9178
Train Loss: 0.3688
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3548
ID Test ACCURACY: 0.9177
ID Test Loss: 0.3860
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.4565
OOD Test ACCURACY: 0.6407
OOD Test Loss: 1.2257

[0m[1;37mINFO[0m: [1mChartInfo 0.9193 0.6483 0.9177 0.6407 0.9257 0.9277[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.638
WIoU for r=0.3 = 0.508
F1 for r=0.6 = 0.535
WIoU for r=0.6 = 0.410
F1 for r=0.9 = 0.434
WIoU for r=0.9 = 0.306
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.312


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.354
Model XAI F1 of binarized graphs for r=0.3 =  0.6377700000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.50820875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.369
NEC for r=0.3 class 0 = 0.579 +- 0.307 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 1 = 0.442 +- 0.307 (in-sample avg dev_std = 0.408)
NEC for r=0.3 class 2 = 0.642 +- 0.307 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all KL = 0.537 +- 0.307 (in-sample avg dev_std = 0.408)
NEC for r=0.3 all L1 = 0.556 +- 0.168 (in-sample avg dev_std = 0.408)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.569
Model XAI F1 of binarized graphs for r=0.6 =  0.53502875
Model XAI WIoU of binarized graphs for r=0.6 =  0.40990125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.365
NEC for r=0.6 class 0 = 0.586 +- 0.271 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 1 = 0.583 +- 0.271 (in-sample avg dev_std = 0.531)
NEC for r=0.6 class 2 = 0.606 +- 0.271 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all KL = 0.676 +- 0.271 (in-sample avg dev_std = 0.531)
NEC for r=0.6 all L1 = 0.592 +- 0.146 (in-sample avg dev_std = 0.531)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.814
Model XAI F1 of binarized graphs for r=0.9 =  0.43376875
Model XAI WIoU of binarized graphs for r=0.9 =  0.30591125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.488
NEC for r=0.9 class 0 = 0.54 +- 0.257 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 1 = 0.514 +- 0.257 (in-sample avg dev_std = 0.569)
NEC for r=0.9 class 2 = 0.539 +- 0.257 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all KL = 0.555 +- 0.257 (in-sample avg dev_std = 0.569)
NEC for r=0.9 all L1 = 0.531 +- 0.146 (in-sample avg dev_std = 0.569)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.31191625
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.567
NEC for r=1.0 class 0 = 0.527 +- 0.283 (in-sample avg dev_std = 0.575)
NEC for r=1.0 class 1 = 0.454 +- 0.283 (in-sample avg dev_std = 0.575)
NEC for r=1.0 class 2 = 0.504 +- 0.283 (in-sample avg dev_std = 0.575)
NEC for r=1.0 all KL = 0.538 +- 0.283 (in-sample avg dev_std = 0.575)
NEC for r=1.0 all L1 = 0.495 +- 0.171 (in-sample avg dev_std = 0.575)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.354
Model XAI F1 of binarized graphs for r=0.3 =  0.6377700000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.50820875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.369
SUFF++ for r=0.3 class 0 = 0.444 +- 0.278 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 1 = 0.533 +- 0.278 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 class 2 = 0.564 +- 0.278 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 all KL = 0.524 +- 0.278 (in-sample avg dev_std = 0.476)
SUFF++ for r=0.3 all L1 = 0.514 +- 0.163 (in-sample avg dev_std = 0.476)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.567
Model XAI F1 of binarized graphs for r=0.6 =  0.53502875
Model XAI WIoU of binarized graphs for r=0.6 =  0.40990125
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.52
SUFF++ for r=0.6 class 0 = 0.444 +- 0.312 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 1 = 0.453 +- 0.312 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 class 2 = 0.726 +- 0.312 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 all KL = 0.502 +- 0.312 (in-sample avg dev_std = 0.455)
SUFF++ for r=0.6 all L1 = 0.544 +- 0.229 (in-sample avg dev_std = 0.455)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.814
Model XAI F1 of binarized graphs for r=0.9 =  0.43376875
Model XAI WIoU of binarized graphs for r=0.9 =  0.30591125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.737
SUFF++ for r=0.9 class 0 = 0.62 +- 0.211 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 1 = 0.653 +- 0.211 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 class 2 = 0.858 +- 0.211 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 all KL = 0.775 +- 0.211 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.9 all L1 = 0.713 +- 0.189 (in-sample avg dev_std = 0.359)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:46:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:46:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9218
Train Loss: 0.3744
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3613
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3906
OOD Validation ACCURACY: 0.7447
OOD Validation Loss: 0.5801
OOD Test ACCURACY: 0.5590
OOD Test Loss: 1.9371

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 19...
[0m[1;37mINFO[0m: [1mCheckpoint 19: 
-----------------------------------
Train ACCURACY: 0.9174
Train Loss: 0.3778
ID Validation ACCURACY: 0.9213
ID Validation Loss: 0.3598
ID Test ACCURACY: 0.9153
ID Test Loss: 0.3903
OOD Validation ACCURACY: 0.9237
OOD Validation Loss: 0.4252
OOD Test ACCURACY: 0.4633
OOD Test Loss: 2.5793

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.5590 0.9153 0.4633 0.9213 0.9237[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.667
WIoU for r=0.3 = 0.538
F1 for r=0.6 = 0.561
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.454
WIoU for r=0.9 = 0.324
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.315


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.379
Model XAI F1 of binarized graphs for r=0.3 =  0.666645
Model XAI WIoU of binarized graphs for r=0.3 =  0.537935
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.576 +- 0.282 (in-sample avg dev_std = 0.446)
NEC for r=0.3 class 1 = 0.562 +- 0.282 (in-sample avg dev_std = 0.446)
NEC for r=0.3 class 2 = 0.682 +- 0.282 (in-sample avg dev_std = 0.446)
NEC for r=0.3 all KL = 0.613 +- 0.282 (in-sample avg dev_std = 0.446)
NEC for r=0.3 all L1 = 0.608 +- 0.152 (in-sample avg dev_std = 0.446)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.551
Model XAI F1 of binarized graphs for r=0.6 =  0.5611800000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.43384500000000004
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.383
NEC for r=0.6 class 0 = 0.578 +- 0.276 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 1 = 0.593 +- 0.276 (in-sample avg dev_std = 0.512)
NEC for r=0.6 class 2 = 0.579 +- 0.276 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all KL = 0.653 +- 0.276 (in-sample avg dev_std = 0.512)
NEC for r=0.6 all L1 = 0.583 +- 0.153 (in-sample avg dev_std = 0.512)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.814
Model XAI F1 of binarized graphs for r=0.9 =  0.45365125000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.32435375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.494
NEC for r=0.9 class 0 = 0.533 +- 0.250 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 1 = 0.523 +- 0.250 (in-sample avg dev_std = 0.522)
NEC for r=0.9 class 2 = 0.526 +- 0.250 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all KL = 0.519 +- 0.250 (in-sample avg dev_std = 0.522)
NEC for r=0.9 all L1 = 0.527 +- 0.144 (in-sample avg dev_std = 0.522)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.31504375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.559
NEC for r=1.0 class 0 = 0.533 +- 0.270 (in-sample avg dev_std = 0.533)
NEC for r=1.0 class 1 = 0.424 +- 0.270 (in-sample avg dev_std = 0.533)
NEC for r=1.0 class 2 = 0.513 +- 0.270 (in-sample avg dev_std = 0.533)
NEC for r=1.0 all KL = 0.484 +- 0.270 (in-sample avg dev_std = 0.533)
NEC for r=1.0 all L1 = 0.491 +- 0.168 (in-sample avg dev_std = 0.533)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.38
Model XAI F1 of binarized graphs for r=0.3 =  0.666645
Model XAI WIoU of binarized graphs for r=0.3 =  0.537935
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.359
SUFF++ for r=0.3 class 0 = 0.424 +- 0.280 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 1 = 0.524 +- 0.280 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 2 = 0.515 +- 0.280 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all KL = 0.487 +- 0.280 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all L1 = 0.488 +- 0.178 (in-sample avg dev_std = 0.520)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.554
Model XAI F1 of binarized graphs for r=0.6 =  0.5611800000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.43384500000000004
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.513
SUFF++ for r=0.6 class 0 = 0.453 +- 0.274 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 1 = 0.44 +- 0.274 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 class 2 = 0.696 +- 0.274 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 all KL = 0.494 +- 0.274 (in-sample avg dev_std = 0.478)
SUFF++ for r=0.6 all L1 = 0.533 +- 0.205 (in-sample avg dev_std = 0.478)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.814
Model XAI F1 of binarized graphs for r=0.9 =  0.45365125000000006
Model XAI WIoU of binarized graphs for r=0.9 =  0.32435375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.783
SUFF++ for r=0.9 class 0 = 0.66 +- 0.210 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 1 = 0.676 +- 0.210 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 class 2 = 0.829 +- 0.210 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all KL = 0.802 +- 0.210 (in-sample avg dev_std = 0.320)
SUFF++ for r=0.9 all L1 = 0.724 +- 0.191 (in-sample avg dev_std = 0.320)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:48:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:48:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9188
Train Loss: 0.3755
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3545
ID Test ACCURACY: 0.9160
ID Test Loss: 0.3848
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4576
OOD Test ACCURACY: 0.6873
OOD Test Loss: 1.1964

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9188
Train Loss: 0.3755
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3545
ID Test ACCURACY: 0.9160
ID Test Loss: 0.3848
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4576
OOD Test ACCURACY: 0.6873
OOD Test Loss: 1.1964

[0m[1;37mINFO[0m: [1mChartInfo 0.9160 0.6873 0.9160 0.6873 0.9260 0.9263[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.630
WIoU for r=0.3 = 0.509
F1 for r=0.6 = 0.528
WIoU for r=0.6 = 0.410
F1 for r=0.9 = 0.432
WIoU for r=0.9 = 0.309
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.315


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.458
Model XAI F1 of binarized graphs for r=0.3 =  0.63029125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5089725
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.335
NEC for r=0.3 class 0 = 0.575 +- 0.318 (in-sample avg dev_std = 0.424)
NEC for r=0.3 class 1 = 0.543 +- 0.318 (in-sample avg dev_std = 0.424)
NEC for r=0.3 class 2 = 0.644 +- 0.318 (in-sample avg dev_std = 0.424)
NEC for r=0.3 all KL = 0.597 +- 0.318 (in-sample avg dev_std = 0.424)
NEC for r=0.3 all L1 = 0.588 +- 0.152 (in-sample avg dev_std = 0.424)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.5277925
Model XAI WIoU of binarized graphs for r=0.6 =  0.41023375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.349
NEC for r=0.6 class 0 = 0.552 +- 0.273 (in-sample avg dev_std = 0.470)
NEC for r=0.6 class 1 = 0.587 +- 0.273 (in-sample avg dev_std = 0.470)
NEC for r=0.6 class 2 = 0.586 +- 0.273 (in-sample avg dev_std = 0.470)
NEC for r=0.6 all KL = 0.613 +- 0.273 (in-sample avg dev_std = 0.470)
NEC for r=0.6 all L1 = 0.576 +- 0.163 (in-sample avg dev_std = 0.470)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.777
Model XAI F1 of binarized graphs for r=0.9 =  0.43223750000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.30906375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.453
NEC for r=0.9 class 0 = 0.51 +- 0.270 (in-sample avg dev_std = 0.525)
NEC for r=0.9 class 1 = 0.535 +- 0.270 (in-sample avg dev_std = 0.525)
NEC for r=0.9 class 2 = 0.512 +- 0.270 (in-sample avg dev_std = 0.525)
NEC for r=0.9 all KL = 0.519 +- 0.270 (in-sample avg dev_std = 0.525)
NEC for r=0.9 all L1 = 0.519 +- 0.168 (in-sample avg dev_std = 0.525)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.31467999999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.536
NEC for r=1.0 class 0 = 0.525 +- 0.267 (in-sample avg dev_std = 0.591)
NEC for r=1.0 class 1 = 0.508 +- 0.267 (in-sample avg dev_std = 0.591)
NEC for r=1.0 class 2 = 0.526 +- 0.267 (in-sample avg dev_std = 0.591)
NEC for r=1.0 all KL = 0.553 +- 0.267 (in-sample avg dev_std = 0.591)
NEC for r=1.0 all L1 = 0.52 +- 0.162 (in-sample avg dev_std = 0.591)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.458
Model XAI F1 of binarized graphs for r=0.3 =  0.63029125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5089725
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.38
SUFF++ for r=0.3 class 0 = 0.415 +- 0.319 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.3 class 1 = 0.479 +- 0.319 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.3 class 2 = 0.598 +- 0.319 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.3 all KL = 0.493 +- 0.319 (in-sample avg dev_std = 0.484)
SUFF++ for r=0.3 all L1 = 0.499 +- 0.193 (in-sample avg dev_std = 0.484)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.541
Model XAI F1 of binarized graphs for r=0.6 =  0.5277925
Model XAI WIoU of binarized graphs for r=0.6 =  0.41023375
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.562
SUFF++ for r=0.6 class 0 = 0.468 +- 0.261 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 1 = 0.513 +- 0.261 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 class 2 = 0.631 +- 0.261 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all KL = 0.517 +- 0.261 (in-sample avg dev_std = 0.505)
SUFF++ for r=0.6 all L1 = 0.539 +- 0.200 (in-sample avg dev_std = 0.505)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.777
Model XAI F1 of binarized graphs for r=0.9 =  0.43223750000000005
Model XAI WIoU of binarized graphs for r=0.9 =  0.30906375
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.744
SUFF++ for r=0.9 class 0 = 0.647 +- 0.163 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 class 1 = 0.716 +- 0.163 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 class 2 = 0.829 +- 0.163 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 all KL = 0.81 +- 0.163 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 all L1 = 0.732 +- 0.166 (in-sample avg dev_std = 0.354)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.616, 0.714, 0.583, 0.549], 'all_L1': [0.602, 0.613, 0.54, 0.517]}), defaultdict(<class 'list'>, {'all_KL': [0.655, 0.716, 0.586, 0.526], 'all_L1': [0.591, 0.598, 0.528, 0.476]}), defaultdict(<class 'list'>, {'all_KL': [0.537, 0.676, 0.555, 0.538], 'all_L1': [0.556, 0.592, 0.531, 0.495]}), defaultdict(<class 'list'>, {'all_KL': [0.613, 0.653, 0.519, 0.484], 'all_L1': [0.608, 0.583, 0.527, 0.491]}), defaultdict(<class 'list'>, {'all_KL': [0.597, 0.613, 0.519, 0.553], 'all_L1': [0.588, 0.576, 0.519, 0.52]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.485, 0.483, 0.808, 1.0], 'all_L1': [0.503, 0.541, 0.752, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.445, 0.442, 0.782, 1.0], 'all_L1': [0.508, 0.543, 0.74, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.524, 0.502, 0.775, 1.0], 'all_L1': [0.514, 0.544, 0.713, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.487, 0.494, 0.802, 1.0], 'all_L1': [0.488, 0.533, 0.724, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.493, 0.517, 0.81, 1.0], 'all_L1': [0.499, 0.539, 0.732, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.589 +- 0.018, 0.592 +- 0.013, 0.529 +- 0.007, 0.500 +- 0.017
nec class all_KL  =  0.604 +- 0.038, 0.674 +- 0.039, 0.552 +- 0.029, 0.530 +- 0.025
nec_acc_int  =  0.341 +- 0.017, 0.387 +- 0.038, 0.486 +- 0.028, 0.559 +- 0.020
suff++ class all_L1  =  0.502 +- 0.009, 0.540 +- 0.004, 0.732 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.487 +- 0.025, 0.488 +- 0.025, 0.795 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.403 +- 0.047, 0.553 +- 0.031, 0.764 +- 0.023


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.546 +- 0.006, 0.566 +- 0.008, 0.631 +- 0.009, 0.750 +- 0.008
Faith. Armon (L1)= 		  =  0.542 +- 0.005, 0.565 +- 0.007, 0.614 +- 0.008, 0.666 +- 0.015
Faith. GMean (L1)= 	  =  0.544 +- 0.005, 0.566 +- 0.007, 0.622 +- 0.008, 0.707 +- 0.012
Faith. Aritm (KL)= 		  =  0.545 +- 0.008, 0.581 +- 0.012, 0.674 +- 0.014, 0.765 +- 0.012
Faith. Armon (KL)= 		  =  0.537 +- 0.006, 0.564 +- 0.011, 0.651 +- 0.019, 0.692 +- 0.022
Faith. GMean (KL)= 	  =  0.541 +- 0.006, 0.573 +- 0.010, 0.663 +- 0.016, 0.728 +- 0.017
Computed for split load_split = id



Completed in  0:06:19.171518  for GSATGIN GOODMotif2/basis



DONE GSAT GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:49:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:49:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9183
Train Loss: 0.3635
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3453
ID Test ACCURACY: 0.9183
ID Test Loss: 0.3797
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.3967
OOD Test ACCURACY: 0.5967
OOD Test Loss: 1.6249

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9122
Train Loss: 0.3796
ID Validation ACCURACY: 0.9193
ID Validation Loss: 0.3644
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3900
OOD Validation ACCURACY: 0.9283
OOD Validation Loss: 0.4281
OOD Test ACCURACY: 0.4487
OOD Test Loss: 2.3059

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.5967 0.9107 0.4487 0.9193 0.9283[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.633
WIoU for r=0.3 = 0.499
F1 for r=0.6 = 0.549
WIoU for r=0.6 = 0.424
F1 for r=0.9 = 0.444
WIoU for r=0.9 = 0.316
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.313


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.406
Model XAI F1 of binarized graphs for r=0.3 =  0.632705
Model XAI WIoU of binarized graphs for r=0.3 =  0.49911625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.299
NEC for r=0.3 class 0 = 0.655 +- 0.257 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 1 = 0.578 +- 0.257 (in-sample avg dev_std = 0.484)
NEC for r=0.3 class 2 = 0.631 +- 0.257 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all KL = 0.68 +- 0.257 (in-sample avg dev_std = 0.484)
NEC for r=0.3 all L1 = 0.622 +- 0.144 (in-sample avg dev_std = 0.484)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.598
Model XAI F1 of binarized graphs for r=0.6 =  0.5488225000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.42393749999999997
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.377
NEC for r=0.6 class 0 = 0.591 +- 0.257 (in-sample avg dev_std = 0.559)
NEC for r=0.6 class 1 = 0.609 +- 0.257 (in-sample avg dev_std = 0.559)
NEC for r=0.6 class 2 = 0.591 +- 0.257 (in-sample avg dev_std = 0.559)
NEC for r=0.6 all KL = 0.715 +- 0.257 (in-sample avg dev_std = 0.559)
NEC for r=0.6 all L1 = 0.597 +- 0.158 (in-sample avg dev_std = 0.559)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.875
Model XAI F1 of binarized graphs for r=0.9 =  0.444325
Model XAI WIoU of binarized graphs for r=0.9 =  0.31589375000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.498
NEC for r=0.9 class 0 = 0.55 +- 0.261 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 1 = 0.548 +- 0.261 (in-sample avg dev_std = 0.566)
NEC for r=0.9 class 2 = 0.515 +- 0.261 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all KL = 0.572 +- 0.261 (in-sample avg dev_std = 0.566)
NEC for r=0.9 all L1 = 0.537 +- 0.157 (in-sample avg dev_std = 0.566)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.31339125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.54
NEC for r=1.0 class 0 = 0.533 +- 0.262 (in-sample avg dev_std = 0.603)
NEC for r=1.0 class 1 = 0.495 +- 0.262 (in-sample avg dev_std = 0.603)
NEC for r=1.0 class 2 = 0.532 +- 0.262 (in-sample avg dev_std = 0.603)
NEC for r=1.0 all KL = 0.565 +- 0.262 (in-sample avg dev_std = 0.603)
NEC for r=1.0 all L1 = 0.52 +- 0.168 (in-sample avg dev_std = 0.603)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.406
Model XAI F1 of binarized graphs for r=0.3 =  0.632705
Model XAI WIoU of binarized graphs for r=0.3 =  0.49911625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.371
SUFF++ for r=0.3 class 0 = 0.369 +- 0.282 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.3 class 1 = 0.482 +- 0.282 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.3 class 2 = 0.558 +- 0.282 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.3 all KL = 0.411 +- 0.282 (in-sample avg dev_std = 0.535)
SUFF++ for r=0.3 all L1 = 0.471 +- 0.191 (in-sample avg dev_std = 0.535)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.596
Model XAI F1 of binarized graphs for r=0.6 =  0.5488225000000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.42393749999999997
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.549
SUFF++ for r=0.6 class 0 = 0.404 +- 0.306 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 1 = 0.458 +- 0.306 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 class 2 = 0.773 +- 0.306 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 all KL = 0.485 +- 0.306 (in-sample avg dev_std = 0.477)
SUFF++ for r=0.6 all L1 = 0.55 +- 0.243 (in-sample avg dev_std = 0.477)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.875
Model XAI F1 of binarized graphs for r=0.9 =  0.444325
Model XAI WIoU of binarized graphs for r=0.9 =  0.31589375000000003
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.798
SUFF++ for r=0.9 class 0 = 0.619 +- 0.211 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.9 class 1 = 0.718 +- 0.211 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.9 class 2 = 0.882 +- 0.211 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.9 all KL = 0.794 +- 0.211 (in-sample avg dev_std = 0.360)
SUFF++ for r=0.9 all L1 = 0.742 +- 0.195 (in-sample avg dev_std = 0.360)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:51:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:51:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9226
Train Loss: 0.3760
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3533
ID Test ACCURACY: 0.9217
ID Test Loss: 0.3886
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.4360
OOD Test ACCURACY: 0.6600
OOD Test Loss: 1.8532

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.3991
ID Validation ACCURACY: 0.9190
ID Validation Loss: 0.3768
ID Test ACCURACY: 0.9117
ID Test Loss: 0.4074
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.4230
OOD Test ACCURACY: 0.6430
OOD Test Loss: 2.0371

[0m[1;37mINFO[0m: [1mChartInfo 0.9217 0.6600 0.9117 0.6430 0.9190 0.9277[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.663
WIoU for r=0.3 = 0.536
F1 for r=0.6 = 0.550
WIoU for r=0.6 = 0.425
F1 for r=0.9 = 0.443
WIoU for r=0.9 = 0.317
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.316


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.41
Model XAI F1 of binarized graphs for r=0.3 =  0.6633275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5356525
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.328
NEC for r=0.3 class 0 = 0.644 +- 0.234 (in-sample avg dev_std = 0.568)
NEC for r=0.3 class 1 = 0.679 +- 0.234 (in-sample avg dev_std = 0.568)
NEC for r=0.3 class 2 = 0.68 +- 0.234 (in-sample avg dev_std = 0.568)
NEC for r=0.3 all KL = 0.766 +- 0.234 (in-sample avg dev_std = 0.568)
NEC for r=0.3 all L1 = 0.668 +- 0.142 (in-sample avg dev_std = 0.568)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.543
Model XAI F1 of binarized graphs for r=0.6 =  0.550355
Model XAI WIoU of binarized graphs for r=0.6 =  0.42516625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.358
NEC for r=0.6 class 0 = 0.574 +- 0.259 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 1 = 0.588 +- 0.259 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 2 = 0.6 +- 0.259 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all KL = 0.708 +- 0.259 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all L1 = 0.588 +- 0.189 (in-sample avg dev_std = 0.579)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.781
Model XAI F1 of binarized graphs for r=0.9 =  0.44300125
Model XAI WIoU of binarized graphs for r=0.9 =  0.31712375000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.432
NEC for r=0.9 class 0 = 0.591 +- 0.247 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 1 = 0.591 +- 0.247 (in-sample avg dev_std = 0.611)
NEC for r=0.9 class 2 = 0.537 +- 0.247 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all KL = 0.673 +- 0.247 (in-sample avg dev_std = 0.611)
NEC for r=0.9 all L1 = 0.572 +- 0.149 (in-sample avg dev_std = 0.611)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.31623375
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.555
NEC for r=1.0 class 0 = 0.548 +- 0.283 (in-sample avg dev_std = 0.643)
NEC for r=1.0 class 1 = 0.469 +- 0.283 (in-sample avg dev_std = 0.643)
NEC for r=1.0 class 2 = 0.531 +- 0.283 (in-sample avg dev_std = 0.643)
NEC for r=1.0 all KL = 0.615 +- 0.283 (in-sample avg dev_std = 0.643)
NEC for r=1.0 all L1 = 0.516 +- 0.176 (in-sample avg dev_std = 0.643)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.41
Model XAI F1 of binarized graphs for r=0.3 =  0.6633275000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.5356525
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.385
SUFF++ for r=0.3 class 0 = 0.366 +- 0.262 (in-sample avg dev_std = 0.618)
SUFF++ for r=0.3 class 1 = 0.375 +- 0.262 (in-sample avg dev_std = 0.618)
SUFF++ for r=0.3 class 2 = 0.487 +- 0.262 (in-sample avg dev_std = 0.618)
SUFF++ for r=0.3 all KL = 0.308 +- 0.262 (in-sample avg dev_std = 0.618)
SUFF++ for r=0.3 all L1 = 0.411 +- 0.176 (in-sample avg dev_std = 0.618)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.541
Model XAI F1 of binarized graphs for r=0.6 =  0.550355
Model XAI WIoU of binarized graphs for r=0.6 =  0.42516625
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.553
SUFF++ for r=0.6 class 0 = 0.453 +- 0.298 (in-sample avg dev_std = 0.581)
SUFF++ for r=0.6 class 1 = 0.477 +- 0.298 (in-sample avg dev_std = 0.581)
SUFF++ for r=0.6 class 2 = 0.612 +- 0.298 (in-sample avg dev_std = 0.581)
SUFF++ for r=0.6 all KL = 0.424 +- 0.298 (in-sample avg dev_std = 0.581)
SUFF++ for r=0.6 all L1 = 0.516 +- 0.206 (in-sample avg dev_std = 0.581)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.784
Model XAI F1 of binarized graphs for r=0.9 =  0.44300125
Model XAI WIoU of binarized graphs for r=0.9 =  0.31712375000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.706
SUFF++ for r=0.9 class 0 = 0.563 +- 0.246 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 class 1 = 0.734 +- 0.246 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 class 2 = 0.855 +- 0.246 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 all KL = 0.753 +- 0.246 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.9 all L1 = 0.719 +- 0.228 (in-sample avg dev_std = 0.354)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:52:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:52:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 0.9206
Train Loss: 0.3749
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3546
ID Test ACCURACY: 0.9180
ID Test Loss: 0.3946
OOD Validation ACCURACY: 0.8573
OOD Validation Loss: 0.4990
OOD Test ACCURACY: 0.6083
OOD Test Loss: 2.0427

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 18...
[0m[1;37mINFO[0m: [1mCheckpoint 18: 
-----------------------------------
Train ACCURACY: 0.9151
Train Loss: 0.3775
ID Validation ACCURACY: 0.9230
ID Validation Loss: 0.3601
ID Test ACCURACY: 0.9143
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.9273
OOD Validation Loss: 0.4167
OOD Test ACCURACY: 0.4877
OOD Test Loss: 2.2773

[0m[1;37mINFO[0m: [1mChartInfo 0.9180 0.6083 0.9143 0.4877 0.9230 0.9273[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.635
WIoU for r=0.3 = 0.511
F1 for r=0.6 = 0.528
WIoU for r=0.6 = 0.405
F1 for r=0.9 = 0.434
WIoU for r=0.9 = 0.307
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.312


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.407
Model XAI F1 of binarized graphs for r=0.3 =  0.63518875
Model XAI WIoU of binarized graphs for r=0.3 =  0.51149875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.327
NEC for r=0.3 class 0 = 0.576 +- 0.314 (in-sample avg dev_std = 0.488)
NEC for r=0.3 class 1 = 0.52 +- 0.314 (in-sample avg dev_std = 0.488)
NEC for r=0.3 class 2 = 0.627 +- 0.314 (in-sample avg dev_std = 0.488)
NEC for r=0.3 all KL = 0.597 +- 0.314 (in-sample avg dev_std = 0.488)
NEC for r=0.3 all L1 = 0.576 +- 0.171 (in-sample avg dev_std = 0.488)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.546
Model XAI F1 of binarized graphs for r=0.6 =  0.528145
Model XAI WIoU of binarized graphs for r=0.6 =  0.40477374999999993
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.343
NEC for r=0.6 class 0 = 0.58 +- 0.255 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 1 = 0.634 +- 0.255 (in-sample avg dev_std = 0.579)
NEC for r=0.6 class 2 = 0.587 +- 0.255 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all KL = 0.735 +- 0.255 (in-sample avg dev_std = 0.579)
NEC for r=0.6 all L1 = 0.6 +- 0.150 (in-sample avg dev_std = 0.579)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.731
Model XAI F1 of binarized graphs for r=0.9 =  0.4343575
Model XAI WIoU of binarized graphs for r=0.9 =  0.30720125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.445
NEC for r=0.9 class 0 = 0.521 +- 0.272 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 1 = 0.589 +- 0.272 (in-sample avg dev_std = 0.585)
NEC for r=0.9 class 2 = 0.501 +- 0.272 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all KL = 0.585 +- 0.272 (in-sample avg dev_std = 0.585)
NEC for r=0.9 all L1 = 0.536 +- 0.159 (in-sample avg dev_std = 0.585)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.31226374999999995
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.552
NEC for r=1.0 class 0 = 0.54 +- 0.290 (in-sample avg dev_std = 0.625)
NEC for r=1.0 class 1 = 0.529 +- 0.290 (in-sample avg dev_std = 0.625)
NEC for r=1.0 class 2 = 0.498 +- 0.290 (in-sample avg dev_std = 0.625)
NEC for r=1.0 all KL = 0.602 +- 0.290 (in-sample avg dev_std = 0.625)
NEC for r=1.0 all L1 = 0.522 +- 0.177 (in-sample avg dev_std = 0.625)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.41
Model XAI F1 of binarized graphs for r=0.3 =  0.63518875
Model XAI WIoU of binarized graphs for r=0.3 =  0.51149875
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.338
SUFF++ for r=0.3 class 0 = 0.383 +- 0.283 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 class 1 = 0.473 +- 0.283 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 class 2 = 0.548 +- 0.283 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all KL = 0.438 +- 0.283 (in-sample avg dev_std = 0.541)
SUFF++ for r=0.3 all L1 = 0.47 +- 0.194 (in-sample avg dev_std = 0.541)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.545
Model XAI F1 of binarized graphs for r=0.6 =  0.528145
Model XAI WIoU of binarized graphs for r=0.6 =  0.40477374999999993
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.48
SUFF++ for r=0.6 class 0 = 0.433 +- 0.327 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 class 1 = 0.41 +- 0.327 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 class 2 = 0.77 +- 0.327 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all KL = 0.477 +- 0.327 (in-sample avg dev_std = 0.482)
SUFF++ for r=0.6 all L1 = 0.542 +- 0.256 (in-sample avg dev_std = 0.482)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  0.4343575
Model XAI WIoU of binarized graphs for r=0.9 =  0.30720125
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.69
SUFF++ for r=0.9 class 0 = 0.63 +- 0.248 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.9 class 1 = 0.639 +- 0.248 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.9 class 2 = 0.896 +- 0.248 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.9 all KL = 0.764 +- 0.248 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.9 all L1 = 0.725 +- 0.208 (in-sample avg dev_std = 0.384)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:53:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:53:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9223
Train Loss: 0.3703
ID Validation ACCURACY: 0.9287
ID Validation Loss: 0.3556
ID Test ACCURACY: 0.9193
ID Test Loss: 0.3858
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5414
OOD Test ACCURACY: 0.6283
OOD Test Loss: 1.5128

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 19...
[0m[1;37mINFO[0m: [1mCheckpoint 19: 
-----------------------------------
Train ACCURACY: 0.9189
Train Loss: 0.3742
ID Validation ACCURACY: 0.9217
ID Validation Loss: 0.3598
ID Test ACCURACY: 0.9187
ID Test Loss: 0.3893
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.4142
OOD Test ACCURACY: 0.3853
OOD Test Loss: 3.0322

[0m[1;37mINFO[0m: [1mChartInfo 0.9193 0.6283 0.9187 0.3853 0.9217 0.9270[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.651
WIoU for r=0.3 = 0.519
F1 for r=0.6 = 0.556
WIoU for r=0.6 = 0.429
F1 for r=0.9 = 0.442
WIoU for r=0.9 = 0.316
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.315


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.393
Model XAI F1 of binarized graphs for r=0.3 =  0.6511000000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.51900625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.357
NEC for r=0.3 class 0 = 0.622 +- 0.260 (in-sample avg dev_std = 0.509)
NEC for r=0.3 class 1 = 0.548 +- 0.260 (in-sample avg dev_std = 0.509)
NEC for r=0.3 class 2 = 0.675 +- 0.260 (in-sample avg dev_std = 0.509)
NEC for r=0.3 all KL = 0.653 +- 0.260 (in-sample avg dev_std = 0.509)
NEC for r=0.3 all L1 = 0.616 +- 0.154 (in-sample avg dev_std = 0.509)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.54
Model XAI F1 of binarized graphs for r=0.6 =  0.5555549999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.4287425
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.363
NEC for r=0.6 class 0 = 0.567 +- 0.277 (in-sample avg dev_std = 0.507)
NEC for r=0.6 class 1 = 0.625 +- 0.277 (in-sample avg dev_std = 0.507)
NEC for r=0.6 class 2 = 0.574 +- 0.277 (in-sample avg dev_std = 0.507)
NEC for r=0.6 all KL = 0.681 +- 0.277 (in-sample avg dev_std = 0.507)
NEC for r=0.6 all L1 = 0.588 +- 0.171 (in-sample avg dev_std = 0.507)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.705
Model XAI F1 of binarized graphs for r=0.9 =  0.44221625000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.3155
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.449
NEC for r=0.9 class 0 = 0.497 +- 0.262 (in-sample avg dev_std = 0.529)
NEC for r=0.9 class 1 = 0.547 +- 0.262 (in-sample avg dev_std = 0.529)
NEC for r=0.9 class 2 = 0.499 +- 0.262 (in-sample avg dev_std = 0.529)
NEC for r=0.9 all KL = 0.523 +- 0.262 (in-sample avg dev_std = 0.529)
NEC for r=0.9 all L1 = 0.514 +- 0.149 (in-sample avg dev_std = 0.529)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.3154075
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.543
NEC for r=1.0 class 0 = 0.543 +- 0.280 (in-sample avg dev_std = 0.588)
NEC for r=1.0 class 1 = 0.463 +- 0.280 (in-sample avg dev_std = 0.588)
NEC for r=1.0 class 2 = 0.524 +- 0.280 (in-sample avg dev_std = 0.588)
NEC for r=1.0 all KL = 0.535 +- 0.280 (in-sample avg dev_std = 0.588)
NEC for r=1.0 all L1 = 0.511 +- 0.170 (in-sample avg dev_std = 0.588)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.391
Model XAI F1 of binarized graphs for r=0.3 =  0.6511000000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.51900625
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.358
SUFF++ for r=0.3 class 0 = 0.413 +- 0.291 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 1 = 0.569 +- 0.291 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 class 2 = 0.592 +- 0.291 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all KL = 0.519 +- 0.291 (in-sample avg dev_std = 0.520)
SUFF++ for r=0.3 all L1 = 0.525 +- 0.205 (in-sample avg dev_std = 0.520)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.539
Model XAI F1 of binarized graphs for r=0.6 =  0.5555549999999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.4287425
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.489
SUFF++ for r=0.6 class 0 = 0.492 +- 0.307 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 class 1 = 0.434 +- 0.307 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 class 2 = 0.71 +- 0.307 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 all KL = 0.503 +- 0.307 (in-sample avg dev_std = 0.483)
SUFF++ for r=0.6 all L1 = 0.548 +- 0.222 (in-sample avg dev_std = 0.483)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.705
Model XAI F1 of binarized graphs for r=0.9 =  0.44221625000000003
Model XAI WIoU of binarized graphs for r=0.9 =  0.3155
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.698
SUFF++ for r=0.9 class 0 = 0.629 +- 0.167 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 1 = 0.744 +- 0.167 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 class 2 = 0.852 +- 0.167 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 all KL = 0.823 +- 0.167 (in-sample avg dev_std = 0.314)
SUFF++ for r=0.9 all L1 = 0.744 +- 0.181 (in-sample avg dev_std = 0.314)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:55:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:55:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9216
Train Loss: 0.3786
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3624
ID Test ACCURACY: 0.9187
ID Test Loss: 0.3935
OOD Validation ACCURACY: 0.7530
OOD Validation Loss: 0.5677
OOD Test ACCURACY: 0.5490
OOD Test Loss: 2.4004

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.9197
Train Loss: 0.3800
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3687
ID Test ACCURACY: 0.9173
ID Test Loss: 0.3987
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.4403
OOD Test ACCURACY: 0.6493
OOD Test Loss: 2.0116

[0m[1;37mINFO[0m: [1mChartInfo 0.9187 0.5490 0.9173 0.6493 0.9250 0.9290[0mGOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))

Gold ratio (id_test) =  tensor(0.3032) +- tensor(0.1592)
F1 for r=0.3 = 0.644
WIoU for r=0.3 = 0.512
F1 for r=0.6 = 0.552
WIoU for r=0.6 = 0.429
F1 for r=0.9 = 0.441
WIoU for r=0.9 = 0.316
F1 for r=1.0 = 0.444
WIoU for r=1.0 = 0.316


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.461
Model XAI F1 of binarized graphs for r=0.3 =  0.64399625
Model XAI WIoU of binarized graphs for r=0.3 =  0.5121850000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.346
NEC for r=0.3 class 0 = 0.656 +- 0.279 (in-sample avg dev_std = 0.593)
NEC for r=0.3 class 1 = 0.569 +- 0.279 (in-sample avg dev_std = 0.593)
NEC for r=0.3 class 2 = 0.678 +- 0.279 (in-sample avg dev_std = 0.593)
NEC for r=0.3 all KL = 0.714 +- 0.279 (in-sample avg dev_std = 0.593)
NEC for r=0.3 all L1 = 0.636 +- 0.173 (in-sample avg dev_std = 0.593)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.56
Model XAI F1 of binarized graphs for r=0.6 =  0.5522212500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.42887375000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.359
NEC for r=0.6 class 0 = 0.593 +- 0.245 (in-sample avg dev_std = 0.592)
NEC for r=0.6 class 1 = 0.615 +- 0.245 (in-sample avg dev_std = 0.592)
NEC for r=0.6 class 2 = 0.631 +- 0.245 (in-sample avg dev_std = 0.592)
NEC for r=0.6 all KL = 0.716 +- 0.245 (in-sample avg dev_std = 0.592)
NEC for r=0.6 all L1 = 0.614 +- 0.159 (in-sample avg dev_std = 0.592)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.765
Model XAI F1 of binarized graphs for r=0.9 =  0.44097375
Model XAI WIoU of binarized graphs for r=0.9 =  0.31581499999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.44
NEC for r=0.9 class 0 = 0.539 +- 0.271 (in-sample avg dev_std = 0.582)
NEC for r=0.9 class 1 = 0.601 +- 0.271 (in-sample avg dev_std = 0.582)
NEC for r=0.9 class 2 = 0.536 +- 0.271 (in-sample avg dev_std = 0.582)
NEC for r=0.9 all KL = 0.606 +- 0.271 (in-sample avg dev_std = 0.582)
NEC for r=0.9 all L1 = 0.558 +- 0.157 (in-sample avg dev_std = 0.582)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  0.44384
Model XAI WIoU of binarized graphs for r=1.0 =  0.31609125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.523
NEC for r=1.0 class 0 = 0.543 +- 0.290 (in-sample avg dev_std = 0.658)
NEC for r=1.0 class 1 = 0.532 +- 0.290 (in-sample avg dev_std = 0.658)
NEC for r=1.0 class 2 = 0.548 +- 0.290 (in-sample avg dev_std = 0.658)
NEC for r=1.0 all KL = 0.619 +- 0.290 (in-sample avg dev_std = 0.658)
NEC for r=1.0 all L1 = 0.541 +- 0.169 (in-sample avg dev_std = 0.658)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.463
Model XAI F1 of binarized graphs for r=0.3 =  0.64399625
Model XAI WIoU of binarized graphs for r=0.3 =  0.5121850000000001
len(reference) = 800
Effective ratio: 0.312 +- 0.010
Model Accuracy over intervened graphs for r=0.3 =  0.402
SUFF++ for r=0.3 class 0 = 0.356 +- 0.297 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 1 = 0.572 +- 0.297 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 class 2 = 0.51 +- 0.297 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all KL = 0.41 +- 0.297 (in-sample avg dev_std = 0.608)
SUFF++ for r=0.3 all L1 = 0.479 +- 0.216 (in-sample avg dev_std = 0.608)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.561
Model XAI F1 of binarized graphs for r=0.6 =  0.5522212500000001
Model XAI WIoU of binarized graphs for r=0.6 =  0.42887375000000005
len(reference) = 800
Effective ratio: 0.611 +- 0.007
Model Accuracy over intervened graphs for r=0.6 =  0.574
SUFF++ for r=0.6 class 0 = 0.431 +- 0.302 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.6 class 1 = 0.477 +- 0.302 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.6 class 2 = 0.649 +- 0.302 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.6 all KL = 0.458 +- 0.302 (in-sample avg dev_std = 0.550)
SUFF++ for r=0.6 all L1 = 0.521 +- 0.216 (in-sample avg dev_std = 0.550)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.765
Model XAI F1 of binarized graphs for r=0.9 =  0.44097375
Model XAI WIoU of binarized graphs for r=0.9 =  0.31581499999999996
len(reference) = 800
Effective ratio: 0.914 +- 0.011
Model Accuracy over intervened graphs for r=0.9 =  0.758
SUFF++ for r=0.9 class 0 = 0.622 +- 0.185 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 1 = 0.76 +- 0.185 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 2 = 0.881 +- 0.185 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all KL = 0.821 +- 0.185 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all L1 = 0.757 +- 0.196 (in-sample avg dev_std = 0.324)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.68, 0.715, 0.572, 0.565], 'all_L1': [0.622, 0.597, 0.537, 0.52]}), defaultdict(<class 'list'>, {'all_KL': [0.766, 0.708, 0.673, 0.615], 'all_L1': [0.668, 0.588, 0.572, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.597, 0.735, 0.585, 0.602], 'all_L1': [0.576, 0.6, 0.536, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.653, 0.681, 0.523, 0.535], 'all_L1': [0.616, 0.588, 0.514, 0.511]}), defaultdict(<class 'list'>, {'all_KL': [0.714, 0.716, 0.606, 0.619], 'all_L1': [0.636, 0.614, 0.558, 0.541]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.411, 0.485, 0.794, 1.0], 'all_L1': [0.471, 0.55, 0.742, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.308, 0.424, 0.753, 1.0], 'all_L1': [0.411, 0.516, 0.719, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.438, 0.477, 0.764, 1.0], 'all_L1': [0.47, 0.542, 0.725, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.519, 0.503, 0.823, 1.0], 'all_L1': [0.525, 0.548, 0.744, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.458, 0.821, 1.0], 'all_L1': [0.479, 0.521, 0.757, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.624 +- 0.030, 0.597 +- 0.010, 0.543 +- 0.020, 0.522 +- 0.010
nec class all_KL  =  0.682 +- 0.057, 0.711 +- 0.017, 0.592 +- 0.049, 0.587 +- 0.032
nec_acc_int  =  0.332 +- 0.020, 0.360 +- 0.011, 0.453 +- 0.023, 0.543 +- 0.011
suff++ class all_L1  =  0.471 +- 0.036, 0.535 +- 0.014, 0.737 +- 0.014, 1.000 +- 0.000
suff++ class all_KL  =  0.417 +- 0.068, 0.469 +- 0.027, 0.791 +- 0.029, 1.000 +- 0.000
suff++_acc_int  =  0.371 +- 0.022, 0.529 +- 0.038, 0.730 +- 0.041


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.547 +- 0.016, 0.566 +- 0.008, 0.640 +- 0.010, 0.761 +- 0.005
Faith. Armon (L1)= 		  =  0.535 +- 0.021, 0.565 +- 0.008, 0.625 +- 0.013, 0.686 +- 0.009
Faith. GMean (L1)= 	  =  0.541 +- 0.018, 0.565 +- 0.008, 0.633 +- 0.012, 0.722 +- 0.007
Faith. Aritm (KL)= 		  =  0.550 +- 0.023, 0.590 +- 0.014, 0.691 +- 0.018, 0.794 +- 0.016
Faith. Armon (KL)= 		  =  0.511 +- 0.044, 0.565 +- 0.019, 0.675 +- 0.026, 0.739 +- 0.026
Faith. GMean (KL)= 	  =  0.530 +- 0.032, 0.577 +- 0.016, 0.683 +- 0.022, 0.766 +- 0.021
Computed for split load_split = id



Completed in  0:06:49.269881  for GSATGIN GOODMotif2/basis



DONE GSAT GOODMotif2/basis mitigation_readout weighted

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:56:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 12:56:58 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:10 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:12 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:14 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:18 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:57:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9010
Train Loss: 0.4113
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3841
ID Test ACCURACY: 0.9073
ID Test Loss: 0.4060
OOD Validation ACCURACY: 0.7423
OOD Validation Loss: 0.6636
OOD Test ACCURACY: 0.4077
OOD Test Loss: 1.2302

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8978
Train Loss: 0.4102
ID Validation ACCURACY: 0.8993
ID Validation Loss: 0.3779
ID Test ACCURACY: 0.9033
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8020
OOD Validation Loss: 0.6381
OOD Test ACCURACY: 0.5353
OOD Test Loss: 1.1219

[0m[1;37mINFO[0m: [1mChartInfo 0.9073 0.4077 0.9033 0.5353 0.8993 0.8020[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.632
WIoU for r=0.3 = 0.503
F1 for r=0.6 = 0.561
WIoU for r=0.6 = 0.435
F1 for r=0.9 = 0.508
WIoU for r=0.9 = 0.377
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.378


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.445
Model XAI F1 of binarized graphs for r=0.3 =  0.63185125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5029675
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.358
NEC for r=0.3 class 0 = 0.456 +- 0.281 (in-sample avg dev_std = 0.297)
NEC for r=0.3 class 1 = 0.405 +- 0.281 (in-sample avg dev_std = 0.297)
NEC for r=0.3 class 2 = 0.527 +- 0.281 (in-sample avg dev_std = 0.297)
NEC for r=0.3 all KL = 0.357 +- 0.281 (in-sample avg dev_std = 0.297)
NEC for r=0.3 all L1 = 0.462 +- 0.177 (in-sample avg dev_std = 0.297)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  0.56061625
Model XAI WIoU of binarized graphs for r=0.6 =  0.4353975
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.385
NEC for r=0.6 class 0 = 0.442 +- 0.314 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 1 = 0.382 +- 0.314 (in-sample avg dev_std = 0.390)
NEC for r=0.6 class 2 = 0.596 +- 0.314 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all KL = 0.429 +- 0.314 (in-sample avg dev_std = 0.390)
NEC for r=0.6 all L1 = 0.472 +- 0.183 (in-sample avg dev_std = 0.390)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.793
Model XAI F1 of binarized graphs for r=0.9 =  0.5077974999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.3765962500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.445
NEC for r=0.9 class 0 = 0.469 +- 0.307 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 1 = 0.425 +- 0.307 (in-sample avg dev_std = 0.467)
NEC for r=0.9 class 2 = 0.571 +- 0.307 (in-sample avg dev_std = 0.467)
NEC for r=0.9 all KL = 0.469 +- 0.307 (in-sample avg dev_std = 0.467)
NEC for r=0.9 all L1 = 0.487 +- 0.179 (in-sample avg dev_std = 0.467)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.913
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.37770499999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.491
NEC for r=1.0 class 0 = 0.528 +- 0.283 (in-sample avg dev_std = 0.533)
NEC for r=1.0 class 1 = 0.525 +- 0.283 (in-sample avg dev_std = 0.533)
NEC for r=1.0 class 2 = 0.572 +- 0.283 (in-sample avg dev_std = 0.533)
NEC for r=1.0 all KL = 0.552 +- 0.283 (in-sample avg dev_std = 0.533)
NEC for r=1.0 all L1 = 0.541 +- 0.163 (in-sample avg dev_std = 0.533)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.447
Model XAI F1 of binarized graphs for r=0.3 =  0.63185125
Model XAI WIoU of binarized graphs for r=0.3 =  0.5029675
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.409
SUFF++ for r=0.3 class 0 = 0.556 +- 0.222 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.3 class 1 = 0.582 +- 0.222 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.3 class 2 = 0.597 +- 0.222 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.3 all KL = 0.671 +- 0.222 (in-sample avg dev_std = 0.397)
SUFF++ for r=0.3 all L1 = 0.578 +- 0.140 (in-sample avg dev_std = 0.397)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  0.56061625
Model XAI WIoU of binarized graphs for r=0.6 =  0.4353975
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.556
SUFF++ for r=0.6 class 0 = 0.591 +- 0.219 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.6 class 1 = 0.592 +- 0.219 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.6 class 2 = 0.788 +- 0.219 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.6 all KL = 0.736 +- 0.219 (in-sample avg dev_std = 0.368)
SUFF++ for r=0.6 all L1 = 0.656 +- 0.191 (in-sample avg dev_std = 0.368)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.791
Model XAI F1 of binarized graphs for r=0.9 =  0.5077974999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.3765962500000001
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.755
SUFF++ for r=0.9 class 0 = 0.766 +- 0.157 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 class 1 = 0.747 +- 0.157 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 class 2 = 0.912 +- 0.157 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all KL = 0.888 +- 0.157 (in-sample avg dev_std = 0.231)
SUFF++ for r=0.9 all L1 = 0.808 +- 0.168 (in-sample avg dev_std = 0.231)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 12:58:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:33 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:45 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:49 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:52 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 12:58:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8982
Train Loss: 0.4154
ID Validation ACCURACY: 0.9063
ID Validation Loss: 0.3884
ID Test ACCURACY: 0.9040
ID Test Loss: 0.4108
OOD Validation ACCURACY: 0.7660
OOD Validation Loss: 0.6770
OOD Test ACCURACY: 0.3893
OOD Test Loss: 1.9553

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8992
Train Loss: 0.4251
ID Validation ACCURACY: 0.9040
ID Validation Loss: 0.3990
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4150
OOD Validation ACCURACY: 0.8080
OOD Validation Loss: 0.6806
OOD Test ACCURACY: 0.5023
OOD Test Loss: 1.2075

[0m[1;37mINFO[0m: [1mChartInfo 0.9040 0.3893 0.9030 0.5023 0.9040 0.8080[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.622
WIoU for r=0.3 = 0.503
F1 for r=0.6 = 0.607
WIoU for r=0.6 = 0.480
F1 for r=0.9 = 0.511
WIoU for r=0.9 = 0.378
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.377


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.411
Model XAI F1 of binarized graphs for r=0.3 =  0.6217812500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.50313625
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.334
NEC for r=0.3 class 0 = 0.503 +- 0.272 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 1 = 0.487 +- 0.272 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 2 = 0.539 +- 0.272 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all KL = 0.407 +- 0.272 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all L1 = 0.51 +- 0.176 (in-sample avg dev_std = 0.320)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.666
Model XAI F1 of binarized graphs for r=0.6 =  0.60691875
Model XAI WIoU of binarized graphs for r=0.6 =  0.48027749999999997
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.399
NEC for r=0.6 class 0 = 0.421 +- 0.281 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 1 = 0.479 +- 0.281 (in-sample avg dev_std = 0.380)
NEC for r=0.6 class 2 = 0.554 +- 0.281 (in-sample avg dev_std = 0.380)
NEC for r=0.6 all KL = 0.414 +- 0.281 (in-sample avg dev_std = 0.380)
NEC for r=0.6 all L1 = 0.484 +- 0.181 (in-sample avg dev_std = 0.380)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  0.5106050000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.37848875
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.464
NEC for r=0.9 class 0 = 0.425 +- 0.281 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 1 = 0.521 +- 0.281 (in-sample avg dev_std = 0.443)
NEC for r=0.9 class 2 = 0.562 +- 0.281 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all KL = 0.445 +- 0.281 (in-sample avg dev_std = 0.443)
NEC for r=0.9 all L1 = 0.502 +- 0.164 (in-sample avg dev_std = 0.443)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.909
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.37658500000000006
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.481
NEC for r=1.0 class 0 = 0.525 +- 0.279 (in-sample avg dev_std = 0.505)
NEC for r=1.0 class 1 = 0.527 +- 0.279 (in-sample avg dev_std = 0.505)
NEC for r=1.0 class 2 = 0.567 +- 0.279 (in-sample avg dev_std = 0.505)
NEC for r=1.0 all KL = 0.524 +- 0.279 (in-sample avg dev_std = 0.505)
NEC for r=1.0 all L1 = 0.539 +- 0.165 (in-sample avg dev_std = 0.505)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.411
Model XAI F1 of binarized graphs for r=0.3 =  0.6217812500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.50313625
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.397
SUFF++ for r=0.3 class 0 = 0.566 +- 0.225 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 class 1 = 0.569 +- 0.225 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 class 2 = 0.599 +- 0.225 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 all KL = 0.677 +- 0.225 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 all L1 = 0.578 +- 0.147 (in-sample avg dev_std = 0.410)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.668
Model XAI F1 of binarized graphs for r=0.6 =  0.60691875
Model XAI WIoU of binarized graphs for r=0.6 =  0.48027749999999997
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.598
SUFF++ for r=0.6 class 0 = 0.576 +- 0.223 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 1 = 0.576 +- 0.223 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 class 2 = 0.741 +- 0.223 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all KL = 0.72 +- 0.223 (in-sample avg dev_std = 0.386)
SUFF++ for r=0.6 all L1 = 0.63 +- 0.182 (in-sample avg dev_std = 0.386)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.829
Model XAI F1 of binarized graphs for r=0.9 =  0.5106050000000001
Model XAI WIoU of binarized graphs for r=0.9 =  0.37848875
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.802
SUFF++ for r=0.9 class 0 = 0.685 +- 0.159 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 1 = 0.797 +- 0.159 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 class 2 = 0.867 +- 0.159 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all KL = 0.874 +- 0.159 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.9 all L1 = 0.782 +- 0.168 (in-sample avg dev_std = 0.252)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 13:00:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:19 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:21 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:23 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:00:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 0.8945
Train Loss: 0.4116
ID Validation ACCURACY: 0.9040
ID Validation Loss: 0.3795
ID Test ACCURACY: 0.8997
ID Test Loss: 0.4107
OOD Validation ACCURACY: 0.7253
OOD Validation Loss: 0.6863
OOD Test ACCURACY: 0.4013
OOD Test Loss: 2.0413

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8913
Train Loss: 0.4172
ID Validation ACCURACY: 0.8983
ID Validation Loss: 0.3806
ID Test ACCURACY: 0.8980
ID Test Loss: 0.4151
OOD Validation ACCURACY: 0.8380
OOD Validation Loss: 0.6095
OOD Test ACCURACY: 0.5037
OOD Test Loss: 0.9645

[0m[1;37mINFO[0m: [1mChartInfo 0.8997 0.4013 0.8980 0.5037 0.8983 0.8380[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.573
WIoU for r=0.3 = 0.471
F1 for r=0.6 = 0.553
WIoU for r=0.6 = 0.430
F1 for r=0.9 = 0.509
WIoU for r=0.9 = 0.376
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.377


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.389
Model XAI F1 of binarized graphs for r=0.3 =  0.5725375
Model XAI WIoU of binarized graphs for r=0.3 =  0.47080750000000005
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.351
NEC for r=0.3 class 0 = 0.487 +- 0.283 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 1 = 0.454 +- 0.283 (in-sample avg dev_std = 0.300)
NEC for r=0.3 class 2 = 0.59 +- 0.283 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all KL = 0.428 +- 0.283 (in-sample avg dev_std = 0.300)
NEC for r=0.3 all L1 = 0.509 +- 0.178 (in-sample avg dev_std = 0.300)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.58
Model XAI F1 of binarized graphs for r=0.6 =  0.553
Model XAI WIoU of binarized graphs for r=0.6 =  0.42965875000000003
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.39
NEC for r=0.6 class 0 = 0.463 +- 0.300 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 1 = 0.381 +- 0.300 (in-sample avg dev_std = 0.384)
NEC for r=0.6 class 2 = 0.608 +- 0.300 (in-sample avg dev_std = 0.384)
NEC for r=0.6 all KL = 0.438 +- 0.300 (in-sample avg dev_std = 0.384)
NEC for r=0.6 all L1 = 0.483 +- 0.195 (in-sample avg dev_std = 0.384)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.725
Model XAI F1 of binarized graphs for r=0.9 =  0.50920875
Model XAI WIoU of binarized graphs for r=0.9 =  0.37592125000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.435
NEC for r=0.9 class 0 = 0.46 +- 0.277 (in-sample avg dev_std = 0.451)
NEC for r=0.9 class 1 = 0.444 +- 0.277 (in-sample avg dev_std = 0.451)
NEC for r=0.9 class 2 = 0.563 +- 0.277 (in-sample avg dev_std = 0.451)
NEC for r=0.9 all KL = 0.443 +- 0.277 (in-sample avg dev_std = 0.451)
NEC for r=0.9 all L1 = 0.488 +- 0.168 (in-sample avg dev_std = 0.451)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.905
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.37655500000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.464
NEC for r=1.0 class 0 = 0.517 +- 0.284 (in-sample avg dev_std = 0.541)
NEC for r=1.0 class 1 = 0.569 +- 0.284 (in-sample avg dev_std = 0.541)
NEC for r=1.0 class 2 = 0.586 +- 0.284 (in-sample avg dev_std = 0.541)
NEC for r=1.0 all KL = 0.576 +- 0.284 (in-sample avg dev_std = 0.541)
NEC for r=1.0 all L1 = 0.557 +- 0.171 (in-sample avg dev_std = 0.541)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.387
Model XAI F1 of binarized graphs for r=0.3 =  0.5725375
Model XAI WIoU of binarized graphs for r=0.3 =  0.47080750000000005
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.38
SUFF++ for r=0.3 class 0 = 0.548 +- 0.219 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 1 = 0.571 +- 0.219 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 2 = 0.574 +- 0.219 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 all KL = 0.634 +- 0.219 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 all L1 = 0.564 +- 0.141 (in-sample avg dev_std = 0.420)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.579
Model XAI F1 of binarized graphs for r=0.6 =  0.553
Model XAI WIoU of binarized graphs for r=0.6 =  0.42965875000000003
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.528
SUFF++ for r=0.6 class 0 = 0.567 +- 0.230 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.6 class 1 = 0.589 +- 0.230 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.6 class 2 = 0.733 +- 0.230 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.6 all KL = 0.696 +- 0.230 (in-sample avg dev_std = 0.388)
SUFF++ for r=0.6 all L1 = 0.629 +- 0.193 (in-sample avg dev_std = 0.388)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.725
Model XAI F1 of binarized graphs for r=0.9 =  0.50920875
Model XAI WIoU of binarized graphs for r=0.9 =  0.37592125000000004
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.699
SUFF++ for r=0.9 class 0 = 0.751 +- 0.178 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.9 class 1 = 0.691 +- 0.178 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.9 class 2 = 0.856 +- 0.178 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.9 all KL = 0.843 +- 0.178 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.9 all L1 = 0.765 +- 0.179 (in-sample avg dev_std = 0.311)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 13:01:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 01:01:40 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:01:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:01:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:01:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:00 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:02:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4122
ID Validation ACCURACY: 0.9040
ID Validation Loss: 0.3819
ID Test ACCURACY: 0.9023
ID Test Loss: 0.4090
OOD Validation ACCURACY: 0.7800
OOD Validation Loss: 0.6749
OOD Test ACCURACY: 0.4270
OOD Test Loss: 1.3846

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.8968
Train Loss: 0.4227
ID Validation ACCURACY: 0.9027
ID Validation Loss: 0.3960
ID Test ACCURACY: 0.8967
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.6848
OOD Test ACCURACY: 0.4540
OOD Test Loss: 1.3474

[0m[1;37mINFO[0m: [1mChartInfo 0.9023 0.4270 0.8967 0.4540 0.9027 0.7857[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.582
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.533
WIoU for r=0.6 = 0.412
F1 for r=0.9 = 0.490
WIoU for r=0.9 = 0.361
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.376


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.391
Model XAI F1 of binarized graphs for r=0.3 =  0.5824750000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.46326875
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.341
NEC for r=0.3 class 0 = 0.501 +- 0.270 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 1 = 0.416 +- 0.270 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 2 = 0.565 +- 0.270 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all KL = 0.393 +- 0.270 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all L1 = 0.493 +- 0.174 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.64
Model XAI F1 of binarized graphs for r=0.6 =  0.53337
Model XAI WIoU of binarized graphs for r=0.6 =  0.41204875
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.403
NEC for r=0.6 class 0 = 0.373 +- 0.299 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 1 = 0.402 +- 0.299 (in-sample avg dev_std = 0.352)
NEC for r=0.6 class 2 = 0.608 +- 0.299 (in-sample avg dev_std = 0.352)
NEC for r=0.6 all KL = 0.374 +- 0.299 (in-sample avg dev_std = 0.352)
NEC for r=0.6 all L1 = 0.46 +- 0.191 (in-sample avg dev_std = 0.352)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.817
Model XAI F1 of binarized graphs for r=0.9 =  0.4904125
Model XAI WIoU of binarized graphs for r=0.9 =  0.3608175
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.467
NEC for r=0.9 class 0 = 0.368 +- 0.299 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 1 = 0.446 +- 0.299 (in-sample avg dev_std = 0.402)
NEC for r=0.9 class 2 = 0.546 +- 0.299 (in-sample avg dev_std = 0.402)
NEC for r=0.9 all KL = 0.363 +- 0.299 (in-sample avg dev_std = 0.402)
NEC for r=0.9 all L1 = 0.453 +- 0.191 (in-sample avg dev_std = 0.402)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.911
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.37582625000000003
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.496
NEC for r=1.0 class 0 = 0.508 +- 0.286 (in-sample avg dev_std = 0.521)
NEC for r=1.0 class 1 = 0.533 +- 0.286 (in-sample avg dev_std = 0.521)
NEC for r=1.0 class 2 = 0.575 +- 0.286 (in-sample avg dev_std = 0.521)
NEC for r=1.0 all KL = 0.544 +- 0.286 (in-sample avg dev_std = 0.521)
NEC for r=1.0 all L1 = 0.538 +- 0.171 (in-sample avg dev_std = 0.521)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.389
Model XAI F1 of binarized graphs for r=0.3 =  0.5824750000000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.46326875
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.414
SUFF++ for r=0.3 class 0 = 0.541 +- 0.229 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 1 = 0.587 +- 0.229 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 class 2 = 0.598 +- 0.229 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all KL = 0.656 +- 0.229 (in-sample avg dev_std = 0.407)
SUFF++ for r=0.3 all L1 = 0.575 +- 0.141 (in-sample avg dev_std = 0.407)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.53337
Model XAI WIoU of binarized graphs for r=0.6 =  0.41204875
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.6
SUFF++ for r=0.6 class 0 = 0.595 +- 0.202 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 1 = 0.602 +- 0.202 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 class 2 = 0.741 +- 0.202 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 all KL = 0.75 +- 0.202 (in-sample avg dev_std = 0.354)
SUFF++ for r=0.6 all L1 = 0.645 +- 0.172 (in-sample avg dev_std = 0.354)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.819
Model XAI F1 of binarized graphs for r=0.9 =  0.4904125
Model XAI WIoU of binarized graphs for r=0.9 =  0.3608175
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.753
SUFF++ for r=0.9 class 0 = 0.696 +- 0.148 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 1 = 0.75 +- 0.148 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 class 2 = 0.865 +- 0.148 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all KL = 0.874 +- 0.148 (in-sample avg dev_std = 0.273)
SUFF++ for r=0.9 all L1 = 0.77 +- 0.150 (in-sample avg dev_std = 0.273)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 13:03:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:14 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:26 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:28 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:30 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:33 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:03:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9022
Train Loss: 0.4024
ID Validation ACCURACY: 0.9063
ID Validation Loss: 0.3754
ID Test ACCURACY: 0.9057
ID Test Loss: 0.3967
OOD Validation ACCURACY: 0.8143
OOD Validation Loss: 0.6194
OOD Test ACCURACY: 0.5047
OOD Test Loss: 0.9707

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8958
Train Loss: 0.4127
ID Validation ACCURACY: 0.9017
ID Validation Loss: 0.3839
ID Test ACCURACY: 0.8987
ID Test Loss: 0.4093
OOD Validation ACCURACY: 0.8263
OOD Validation Loss: 0.6432
OOD Test ACCURACY: 0.5150
OOD Test Loss: 1.2884

[0m[1;37mINFO[0m: [1mChartInfo 0.9057 0.5047 0.8987 0.5150 0.9017 0.8263[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.646
WIoU for r=0.3 = 0.528
F1 for r=0.6 = 0.601
WIoU for r=0.6 = 0.476
F1 for r=0.9 = 0.526
WIoU for r=0.9 = 0.396
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.382


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.366
Model XAI F1 of binarized graphs for r=0.3 =  0.6458824999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.52752875
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.359
NEC for r=0.3 class 0 = 0.485 +- 0.285 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 1 = 0.453 +- 0.285 (in-sample avg dev_std = 0.289)
NEC for r=0.3 class 2 = 0.505 +- 0.285 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all KL = 0.389 +- 0.285 (in-sample avg dev_std = 0.289)
NEC for r=0.3 all L1 = 0.481 +- 0.189 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.64
Model XAI F1 of binarized graphs for r=0.6 =  0.60062625
Model XAI WIoU of binarized graphs for r=0.6 =  0.47595624999999997
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.414
NEC for r=0.6 class 0 = 0.476 +- 0.289 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 1 = 0.477 +- 0.289 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 2 = 0.591 +- 0.289 (in-sample avg dev_std = 0.405)
NEC for r=0.6 all KL = 0.469 +- 0.289 (in-sample avg dev_std = 0.405)
NEC for r=0.6 all L1 = 0.514 +- 0.167 (in-sample avg dev_std = 0.405)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  0.52620375
Model XAI WIoU of binarized graphs for r=0.9 =  0.3962975
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.449
NEC for r=0.9 class 0 = 0.48 +- 0.271 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 1 = 0.512 +- 0.271 (in-sample avg dev_std = 0.460)
NEC for r=0.9 class 2 = 0.562 +- 0.271 (in-sample avg dev_std = 0.460)
NEC for r=0.9 all KL = 0.48 +- 0.271 (in-sample avg dev_std = 0.460)
NEC for r=0.9 all L1 = 0.517 +- 0.155 (in-sample avg dev_std = 0.460)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.913
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.38152749999999996
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.483
NEC for r=1.0 class 0 = 0.525 +- 0.287 (in-sample avg dev_std = 0.535)
NEC for r=1.0 class 1 = 0.542 +- 0.287 (in-sample avg dev_std = 0.535)
NEC for r=1.0 class 2 = 0.572 +- 0.287 (in-sample avg dev_std = 0.535)
NEC for r=1.0 all KL = 0.568 +- 0.287 (in-sample avg dev_std = 0.535)
NEC for r=1.0 all L1 = 0.546 +- 0.173 (in-sample avg dev_std = 0.535)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.365
Model XAI F1 of binarized graphs for r=0.3 =  0.6458824999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.52752875
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.379
SUFF++ for r=0.3 class 0 = 0.548 +- 0.228 (in-sample avg dev_std = 0.399)
SUFF++ for r=0.3 class 1 = 0.59 +- 0.228 (in-sample avg dev_std = 0.399)
SUFF++ for r=0.3 class 2 = 0.606 +- 0.228 (in-sample avg dev_std = 0.399)
SUFF++ for r=0.3 all KL = 0.657 +- 0.228 (in-sample avg dev_std = 0.399)
SUFF++ for r=0.3 all L1 = 0.581 +- 0.136 (in-sample avg dev_std = 0.399)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.64
Model XAI F1 of binarized graphs for r=0.6 =  0.60062625
Model XAI WIoU of binarized graphs for r=0.6 =  0.47595624999999997
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.606
SUFF++ for r=0.6 class 0 = 0.56 +- 0.233 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 1 = 0.572 +- 0.233 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 class 2 = 0.727 +- 0.233 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all KL = 0.689 +- 0.233 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.6 all L1 = 0.619 +- 0.188 (in-sample avg dev_std = 0.377)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.826
Model XAI F1 of binarized graphs for r=0.9 =  0.52620375
Model XAI WIoU of binarized graphs for r=0.9 =  0.3962975
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.819
SUFF++ for r=0.9 class 0 = 0.751 +- 0.148 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 class 1 = 0.773 +- 0.148 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 class 2 = 0.856 +- 0.148 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 all KL = 0.879 +- 0.148 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.9 all L1 = 0.793 +- 0.167 (in-sample avg dev_std = 0.253)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.357, 0.429, 0.469, 0.552], 'all_L1': [0.462, 0.472, 0.487, 0.541]}), defaultdict(<class 'list'>, {'all_KL': [0.407, 0.414, 0.445, 0.524], 'all_L1': [0.51, 0.484, 0.502, 0.539]}), defaultdict(<class 'list'>, {'all_KL': [0.428, 0.438, 0.443, 0.576], 'all_L1': [0.509, 0.483, 0.488, 0.557]}), defaultdict(<class 'list'>, {'all_KL': [0.393, 0.374, 0.363, 0.544], 'all_L1': [0.493, 0.46, 0.453, 0.538]}), defaultdict(<class 'list'>, {'all_KL': [0.389, 0.469, 0.48, 0.568], 'all_L1': [0.481, 0.514, 0.517, 0.546]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.671, 0.736, 0.888, 1.0], 'all_L1': [0.578, 0.656, 0.808, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.677, 0.72, 0.874, 1.0], 'all_L1': [0.578, 0.63, 0.782, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.634, 0.696, 0.843, 1.0], 'all_L1': [0.564, 0.629, 0.765, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.75, 0.874, 1.0], 'all_L1': [0.575, 0.645, 0.77, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.657, 0.689, 0.879, 1.0], 'all_L1': [0.581, 0.619, 0.793, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.491 +- 0.018, 0.483 +- 0.018, 0.489 +- 0.021, 0.544 +- 0.007
nec class all_KL  =  0.395 +- 0.023, 0.425 +- 0.031, 0.440 +- 0.041, 0.553 +- 0.018
nec_acc_int  =  0.349 +- 0.010, 0.398 +- 0.010, 0.452 +- 0.012, 0.483 +- 0.011
suff++ class all_L1  =  0.575 +- 0.006, 0.636 +- 0.013, 0.784 +- 0.016, 1.000 +- 0.000
suff++ class all_KL  =  0.659 +- 0.015, 0.718 +- 0.023, 0.872 +- 0.015, 1.000 +- 0.000
suff++_acc_int  =  0.396 +- 0.014, 0.578 +- 0.031, 0.766 +- 0.042


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.533 +- 0.008, 0.559 +- 0.005, 0.637 +- 0.016, 0.772 +- 0.003
Faith. Armon (L1)= 		  =  0.530 +- 0.010, 0.548 +- 0.008, 0.602 +- 0.019, 0.705 +- 0.006
Faith. GMean (L1)= 	  =  0.531 +- 0.009, 0.554 +- 0.006, 0.619 +- 0.017, 0.738 +- 0.005
Faith. Aritm (KL)= 		  =  0.527 +- 0.009, 0.572 +- 0.008, 0.656 +- 0.023, 0.776 +- 0.009
Faith. Armon (KL)= 		  =  0.493 +- 0.016, 0.533 +- 0.020, 0.584 +- 0.038, 0.712 +- 0.015
Faith. GMean (KL)= 	  =  0.510 +- 0.013, 0.552 +- 0.013, 0.619 +- 0.031, 0.743 +- 0.012
Computed for split load_split = id



Completed in  0:07:51.642018  for GSATGIN GOODMotif/size



DONE GSAT GOODMotif/size

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 13:05:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:18 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:05:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 19...
[0m[1;37mINFO[0m: [1mCheckpoint 19: 
-----------------------------------
Train ACCURACY: 0.9038
Train Loss: 0.4142
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3817
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4094
OOD Validation ACCURACY: 0.7697
OOD Validation Loss: 0.6289
OOD Test ACCURACY: 0.4233
OOD Test Loss: 1.0667

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 14...
[0m[1;37mINFO[0m: [1mCheckpoint 14: 
-----------------------------------
Train ACCURACY: 0.8992
Train Loss: 0.4285
ID Validation ACCURACY: 0.9037
ID Validation Loss: 0.3948
ID Test ACCURACY: 0.9020
ID Test Loss: 0.4249
OOD Validation ACCURACY: 0.8220
OOD Validation Loss: 0.6187
OOD Test ACCURACY: 0.4447
OOD Test Loss: 1.4516

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.4233 0.9020 0.4447 0.9037 0.8220[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.713
WIoU for r=0.3 = 0.586
F1 for r=0.6 = 0.627
WIoU for r=0.6 = 0.490
F1 for r=0.9 = 0.530
WIoU for r=0.9 = 0.389
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.371


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.501
Model XAI F1 of binarized graphs for r=0.3 =  0.712915
Model XAI WIoU of binarized graphs for r=0.3 =  0.5860525
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.323
NEC for r=0.3 class 0 = 0.467 +- 0.328 (in-sample avg dev_std = 0.331)
NEC for r=0.3 class 1 = 0.432 +- 0.328 (in-sample avg dev_std = 0.331)
NEC for r=0.3 class 2 = 0.521 +- 0.328 (in-sample avg dev_std = 0.331)
NEC for r=0.3 all KL = 0.425 +- 0.328 (in-sample avg dev_std = 0.331)
NEC for r=0.3 all L1 = 0.473 +- 0.214 (in-sample avg dev_std = 0.331)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.694
Model XAI F1 of binarized graphs for r=0.6 =  0.62722375
Model XAI WIoU of binarized graphs for r=0.6 =  0.4903875
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.379
NEC for r=0.6 class 0 = 0.552 +- 0.289 (in-sample avg dev_std = 0.492)
NEC for r=0.6 class 1 = 0.539 +- 0.289 (in-sample avg dev_std = 0.492)
NEC for r=0.6 class 2 = 0.625 +- 0.289 (in-sample avg dev_std = 0.492)
NEC for r=0.6 all KL = 0.602 +- 0.289 (in-sample avg dev_std = 0.492)
NEC for r=0.6 all L1 = 0.572 +- 0.170 (in-sample avg dev_std = 0.492)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.79
Model XAI F1 of binarized graphs for r=0.9 =  0.52985
Model XAI WIoU of binarized graphs for r=0.9 =  0.388575
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.43
NEC for r=0.9 class 0 = 0.549 +- 0.268 (in-sample avg dev_std = 0.524)
NEC for r=0.9 class 1 = 0.545 +- 0.268 (in-sample avg dev_std = 0.524)
NEC for r=0.9 class 2 = 0.573 +- 0.268 (in-sample avg dev_std = 0.524)
NEC for r=0.9 all KL = 0.575 +- 0.268 (in-sample avg dev_std = 0.524)
NEC for r=0.9 all L1 = 0.555 +- 0.169 (in-sample avg dev_std = 0.524)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.916
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.37144875
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.468
NEC for r=1.0 class 0 = 0.527 +- 0.279 (in-sample avg dev_std = 0.594)
NEC for r=1.0 class 1 = 0.604 +- 0.279 (in-sample avg dev_std = 0.594)
NEC for r=1.0 class 2 = 0.581 +- 0.279 (in-sample avg dev_std = 0.594)
NEC for r=1.0 all KL = 0.628 +- 0.279 (in-sample avg dev_std = 0.594)
NEC for r=1.0 all L1 = 0.57 +- 0.167 (in-sample avg dev_std = 0.594)


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.502
Model XAI F1 of binarized graphs for r=0.3 =  0.712915
Model XAI WIoU of binarized graphs for r=0.3 =  0.5860525
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.458
SUFF++ for r=0.3 class 0 = 0.589 +- 0.252 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 1 = 0.595 +- 0.252 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 2 = 0.638 +- 0.252 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 all KL = 0.641 +- 0.252 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 all L1 = 0.607 +- 0.163 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.695
Model XAI F1 of binarized graphs for r=0.6 =  0.62722375
Model XAI WIoU of binarized graphs for r=0.6 =  0.4903875
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.627
SUFF++ for r=0.6 class 0 = 0.548 +- 0.283 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 1 = 0.51 +- 0.283 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 class 2 = 0.755 +- 0.283 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all KL = 0.605 +- 0.283 (in-sample avg dev_std = 0.466)
SUFF++ for r=0.6 all L1 = 0.603 +- 0.227 (in-sample avg dev_std = 0.466)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.789
Model XAI F1 of binarized graphs for r=0.9 =  0.52985
Model XAI WIoU of binarized graphs for r=0.9 =  0.388575
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.76
SUFF++ for r=0.9 class 0 = 0.7 +- 0.216 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 class 1 = 0.75 +- 0.216 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 class 2 = 0.866 +- 0.216 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 all KL = 0.831 +- 0.216 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.9 all L1 = 0.772 +- 0.208 (in-sample avg dev_std = 0.309)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 13:06:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 01:06:57 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:09 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:11 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:13 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:17 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:07:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8976
Train Loss: 0.4171
ID Validation ACCURACY: 0.9083
ID Validation Loss: 0.3873
ID Test ACCURACY: 0.9037
ID Test Loss: 0.4105
OOD Validation ACCURACY: 0.7960
OOD Validation Loss: 0.6690
OOD Test ACCURACY: 0.5293
OOD Test Loss: 1.4019

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 0.8962
Train Loss: 0.4251
ID Validation ACCURACY: 0.9033
ID Validation Loss: 0.3892
ID Test ACCURACY: 0.8970
ID Test Loss: 0.4230
OOD Validation ACCURACY: 0.8147
OOD Validation Loss: 0.6240
OOD Test ACCURACY: 0.5143
OOD Test Loss: 2.0630

[0m[1;37mINFO[0m: [1mChartInfo 0.9037 0.5293 0.8970 0.5143 0.9033 0.8147[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.667
WIoU for r=0.3 = 0.540
F1 for r=0.6 = 0.624
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.530
WIoU for r=0.9 = 0.388
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.370


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.417
Model XAI F1 of binarized graphs for r=0.3 =  0.6672437500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.540065
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.312
NEC for r=0.3 class 0 = 0.443 +- 0.292 (in-sample avg dev_std = 0.313)
NEC for r=0.3 class 1 = 0.428 +- 0.292 (in-sample avg dev_std = 0.313)
NEC for r=0.3 class 2 = 0.467 +- 0.292 (in-sample avg dev_std = 0.313)
NEC for r=0.3 all KL = 0.38 +- 0.292 (in-sample avg dev_std = 0.313)
NEC for r=0.3 all L1 = 0.446 +- 0.204 (in-sample avg dev_std = 0.313)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.62365625
Model XAI WIoU of binarized graphs for r=0.6 =  0.4867
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.388
NEC for r=0.6 class 0 = 0.525 +- 0.295 (in-sample avg dev_std = 0.439)
NEC for r=0.6 class 1 = 0.458 +- 0.295 (in-sample avg dev_std = 0.439)
NEC for r=0.6 class 2 = 0.593 +- 0.295 (in-sample avg dev_std = 0.439)
NEC for r=0.6 all KL = 0.537 +- 0.295 (in-sample avg dev_std = 0.439)
NEC for r=0.6 all L1 = 0.525 +- 0.189 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  0.5300149999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.388335
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.436
NEC for r=0.9 class 0 = 0.517 +- 0.265 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 1 = 0.535 +- 0.265 (in-sample avg dev_std = 0.486)
NEC for r=0.9 class 2 = 0.59 +- 0.265 (in-sample avg dev_std = 0.486)
NEC for r=0.9 all KL = 0.552 +- 0.265 (in-sample avg dev_std = 0.486)
NEC for r=0.9 all L1 = 0.547 +- 0.162 (in-sample avg dev_std = 0.486)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.91
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.37011750000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.453
NEC for r=1.0 class 0 = 0.519 +- 0.280 (in-sample avg dev_std = 0.550)
NEC for r=1.0 class 1 = 0.598 +- 0.280 (in-sample avg dev_std = 0.550)
NEC for r=1.0 class 2 = 0.567 +- 0.280 (in-sample avg dev_std = 0.550)
NEC for r=1.0 all KL = 0.579 +- 0.280 (in-sample avg dev_std = 0.550)
NEC for r=1.0 all L1 = 0.561 +- 0.168 (in-sample avg dev_std = 0.550)


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.417
Model XAI F1 of binarized graphs for r=0.3 =  0.6672437500000001
Model XAI WIoU of binarized graphs for r=0.3 =  0.540065
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.385
SUFF++ for r=0.3 class 0 = 0.6 +- 0.236 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 class 1 = 0.592 +- 0.236 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 class 2 = 0.569 +- 0.236 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 all KL = 0.633 +- 0.236 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.3 all L1 = 0.587 +- 0.155 (in-sample avg dev_std = 0.410)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.635
Model XAI F1 of binarized graphs for r=0.6 =  0.62365625
Model XAI WIoU of binarized graphs for r=0.6 =  0.4867
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.604
SUFF++ for r=0.6 class 0 = 0.604 +- 0.256 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 1 = 0.529 +- 0.256 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 class 2 = 0.692 +- 0.256 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all KL = 0.622 +- 0.256 (in-sample avg dev_std = 0.429)
SUFF++ for r=0.6 all L1 = 0.607 +- 0.204 (in-sample avg dev_std = 0.429)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  0.5300149999999999
Model XAI WIoU of binarized graphs for r=0.9 =  0.388335
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.827
SUFF++ for r=0.9 class 0 = 0.775 +- 0.159 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 1 = 0.769 +- 0.159 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 class 2 = 0.824 +- 0.159 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all KL = 0.866 +- 0.159 (in-sample avg dev_std = 0.232)
SUFF++ for r=0.9 all L1 = 0.789 +- 0.173 (in-sample avg dev_std = 0.232)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 13:08:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:32 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:44 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:46 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:48 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:51 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:08:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.9023
Train Loss: 0.4189
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3843
ID Test ACCURACY: 0.9067
ID Test Loss: 0.4168
OOD Validation ACCURACY: 0.8087
OOD Validation Loss: 0.5972
OOD Test ACCURACY: 0.4643
OOD Test Loss: 1.0326

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8933
Train Loss: 0.4149
ID Validation ACCURACY: 0.9020
ID Validation Loss: 0.3780
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4124
OOD Validation ACCURACY: 0.8173
OOD Validation Loss: 0.6143
OOD Test ACCURACY: 0.5067
OOD Test Loss: 0.9804

[0m[1;37mINFO[0m: [1mChartInfo 0.9067 0.4643 0.8983 0.5067 0.9020 0.8173[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.636
WIoU for r=0.3 = 0.516
F1 for r=0.6 = 0.600
WIoU for r=0.6 = 0.472
F1 for r=0.9 = 0.511
WIoU for r=0.9 = 0.381
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.378


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.366
Model XAI F1 of binarized graphs for r=0.3 =  0.6361574999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.51579
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.312
NEC for r=0.3 class 0 = 0.61 +- 0.287 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 1 = 0.534 +- 0.287 (in-sample avg dev_std = 0.407)
NEC for r=0.3 class 2 = 0.603 +- 0.287 (in-sample avg dev_std = 0.407)
NEC for r=0.3 all KL = 0.563 +- 0.287 (in-sample avg dev_std = 0.407)
NEC for r=0.3 all L1 = 0.582 +- 0.184 (in-sample avg dev_std = 0.407)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  0.59970125
Model XAI WIoU of binarized graphs for r=0.6 =  0.47159625
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.399
NEC for r=0.6 class 0 = 0.486 +- 0.293 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 1 = 0.522 +- 0.293 (in-sample avg dev_std = 0.489)
NEC for r=0.6 class 2 = 0.586 +- 0.293 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all KL = 0.533 +- 0.293 (in-sample avg dev_std = 0.489)
NEC for r=0.6 all L1 = 0.531 +- 0.187 (in-sample avg dev_std = 0.489)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.855
Model XAI F1 of binarized graphs for r=0.9 =  0.51054
Model XAI WIoU of binarized graphs for r=0.9 =  0.38104375000000007
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.451
NEC for r=0.9 class 0 = 0.511 +- 0.274 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 1 = 0.587 +- 0.274 (in-sample avg dev_std = 0.533)
NEC for r=0.9 class 2 = 0.564 +- 0.274 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all KL = 0.578 +- 0.274 (in-sample avg dev_std = 0.533)
NEC for r=0.9 all L1 = 0.554 +- 0.157 (in-sample avg dev_std = 0.533)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.913
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.37846375000000004
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.462
NEC for r=1.0 class 0 = 0.54 +- 0.283 (in-sample avg dev_std = 0.582)
NEC for r=1.0 class 1 = 0.567 +- 0.283 (in-sample avg dev_std = 0.582)
NEC for r=1.0 class 2 = 0.59 +- 0.283 (in-sample avg dev_std = 0.582)
NEC for r=1.0 all KL = 0.625 +- 0.283 (in-sample avg dev_std = 0.582)
NEC for r=1.0 all L1 = 0.565 +- 0.170 (in-sample avg dev_std = 0.582)


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.364
Model XAI F1 of binarized graphs for r=0.3 =  0.6361574999999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.51579
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.382
SUFF++ for r=0.3 class 0 = 0.502 +- 0.260 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 1 = 0.517 +- 0.260 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 class 2 = 0.596 +- 0.260 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all KL = 0.571 +- 0.260 (in-sample avg dev_std = 0.479)
SUFF++ for r=0.3 all L1 = 0.538 +- 0.175 (in-sample avg dev_std = 0.479)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.632
Model XAI F1 of binarized graphs for r=0.6 =  0.59970125
Model XAI WIoU of binarized graphs for r=0.6 =  0.47159625
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.581
SUFF++ for r=0.6 class 0 = 0.517 +- 0.276 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 1 = 0.532 +- 0.276 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 class 2 = 0.779 +- 0.276 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all KL = 0.641 +- 0.276 (in-sample avg dev_std = 0.438)
SUFF++ for r=0.6 all L1 = 0.608 +- 0.220 (in-sample avg dev_std = 0.438)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.856
Model XAI F1 of binarized graphs for r=0.9 =  0.51054
Model XAI WIoU of binarized graphs for r=0.9 =  0.38104375000000007
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.795
SUFF++ for r=0.9 class 0 = 0.641 +- 0.198 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 1 = 0.786 +- 0.198 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 2 = 0.89 +- 0.198 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 all KL = 0.841 +- 0.198 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 all L1 = 0.771 +- 0.199 (in-sample avg dev_std = 0.270)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 13:10:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:05 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:21 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:10:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8964
Train Loss: 0.4200
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3920
ID Test ACCURACY: 0.9020
ID Test Loss: 0.4102
OOD Validation ACCURACY: 0.7103
OOD Validation Loss: 0.7179
OOD Test ACCURACY: 0.3923
OOD Test Loss: 1.6691

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.8956
Train Loss: 0.4223
ID Validation ACCURACY: 0.9017
ID Validation Loss: 0.3896
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4149
OOD Validation ACCURACY: 0.8050
OOD Validation Loss: 0.6482
OOD Test ACCURACY: 0.5313
OOD Test Loss: 1.3730

[0m[1;37mINFO[0m: [1mChartInfo 0.9020 0.3923 0.8977 0.5313 0.9017 0.8050[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.678
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.632
WIoU for r=0.6 = 0.500
F1 for r=0.9 = 0.529
WIoU for r=0.9 = 0.395
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.376


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.421
Model XAI F1 of binarized graphs for r=0.3 =  0.6777887499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.547735
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.314
NEC for r=0.3 class 0 = 0.577 +- 0.299 (in-sample avg dev_std = 0.349)
NEC for r=0.3 class 1 = 0.521 +- 0.299 (in-sample avg dev_std = 0.349)
NEC for r=0.3 class 2 = 0.548 +- 0.299 (in-sample avg dev_std = 0.349)
NEC for r=0.3 all KL = 0.504 +- 0.299 (in-sample avg dev_std = 0.349)
NEC for r=0.3 all L1 = 0.549 +- 0.187 (in-sample avg dev_std = 0.349)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.69
Model XAI F1 of binarized graphs for r=0.6 =  0.6322687499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.50043
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.385
NEC for r=0.6 class 0 = 0.55 +- 0.279 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 1 = 0.534 +- 0.279 (in-sample avg dev_std = 0.468)
NEC for r=0.6 class 2 = 0.591 +- 0.279 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all KL = 0.588 +- 0.279 (in-sample avg dev_std = 0.468)
NEC for r=0.6 all L1 = 0.558 +- 0.174 (in-sample avg dev_std = 0.468)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.52871625
Model XAI WIoU of binarized graphs for r=0.9 =  0.39454124999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.458
NEC for r=0.9 class 0 = 0.527 +- 0.268 (in-sample avg dev_std = 0.526)
NEC for r=0.9 class 1 = 0.56 +- 0.268 (in-sample avg dev_std = 0.526)
NEC for r=0.9 class 2 = 0.569 +- 0.268 (in-sample avg dev_std = 0.526)
NEC for r=0.9 all KL = 0.587 +- 0.268 (in-sample avg dev_std = 0.526)
NEC for r=0.9 all L1 = 0.552 +- 0.159 (in-sample avg dev_std = 0.526)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.911
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.37649125
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.476
NEC for r=1.0 class 0 = 0.557 +- 0.282 (in-sample avg dev_std = 0.556)
NEC for r=1.0 class 1 = 0.54 +- 0.282 (in-sample avg dev_std = 0.556)
NEC for r=1.0 class 2 = 0.58 +- 0.282 (in-sample avg dev_std = 0.556)
NEC for r=1.0 all KL = 0.596 +- 0.282 (in-sample avg dev_std = 0.556)
NEC for r=1.0 all L1 = 0.559 +- 0.165 (in-sample avg dev_std = 0.556)


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.423
Model XAI F1 of binarized graphs for r=0.3 =  0.6777887499999999
Model XAI WIoU of binarized graphs for r=0.3 =  0.547735
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.387
SUFF++ for r=0.3 class 0 = 0.519 +- 0.252 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 class 1 = 0.557 +- 0.252 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 class 2 = 0.551 +- 0.252 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 all KL = 0.57 +- 0.252 (in-sample avg dev_std = 0.459)
SUFF++ for r=0.3 all L1 = 0.542 +- 0.151 (in-sample avg dev_std = 0.459)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.689
Model XAI F1 of binarized graphs for r=0.6 =  0.6322687499999999
Model XAI WIoU of binarized graphs for r=0.6 =  0.50043
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.595
SUFF++ for r=0.6 class 0 = 0.483 +- 0.274 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 1 = 0.546 +- 0.274 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 class 2 = 0.743 +- 0.274 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all KL = 0.595 +- 0.274 (in-sample avg dev_std = 0.440)
SUFF++ for r=0.6 all L1 = 0.59 +- 0.216 (in-sample avg dev_std = 0.440)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.845
Model XAI F1 of binarized graphs for r=0.9 =  0.52871625
Model XAI WIoU of binarized graphs for r=0.9 =  0.39454124999999995
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.817
SUFF++ for r=0.9 class 0 = 0.706 +- 0.182 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 1 = 0.818 +- 0.182 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 class 2 = 0.893 +- 0.182 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 all KL = 0.861 +- 0.182 (in-sample avg dev_std = 0.270)
SUFF++ for r=0.9 all L1 = 0.805 +- 0.182 (in-sample avg dev_std = 0.270)


ratio=1.0



Zero intervened samples, skipping weight=1.0

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May  3 13:11:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 05/03/2024 01:11:40 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 05/03/2024 01:11:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 05/03/2024 01:11:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 05/03/2024 01:11:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 05/03/2024 01:11:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/03/2024 01:12:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9009
Train Loss: 0.4088
ID Validation ACCURACY: 0.9063
ID Validation Loss: 0.3809
ID Test ACCURACY: 0.9057
ID Test Loss: 0.4066
OOD Validation ACCURACY: 0.7963
OOD Validation Loss: 0.6194
OOD Test ACCURACY: 0.4960
OOD Test Loss: 1.0559

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8913
Train Loss: 0.4166
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.3853
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4143
OOD Validation ACCURACY: 0.8630
OOD Validation Loss: 0.6041
OOD Test ACCURACY: 0.6130
OOD Test Loss: 0.9214

[0m[1;37mINFO[0m: [1mChartInfo 0.9057 0.4960 0.8977 0.6130 0.8990 0.8630[0mGOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))

Gold ratio (id_test) =  tensor(0.3660) +- tensor(0.1922)
F1 for r=0.3 = 0.671
WIoU for r=0.3 = 0.547
F1 for r=0.6 = 0.603
WIoU for r=0.6 = 0.473
F1 for r=0.9 = 0.517
WIoU for r=0.9 = 0.386
F1 for r=1.0 = 0.509
WIoU for r=1.0 = 0.379


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.411
Model XAI F1 of binarized graphs for r=0.3 =  0.6713825
Model XAI WIoU of binarized graphs for r=0.3 =  0.5470524999999999
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.335
NEC for r=0.3 class 0 = 0.566 +- 0.275 (in-sample avg dev_std = 0.382)
NEC for r=0.3 class 1 = 0.53 +- 0.275 (in-sample avg dev_std = 0.382)
NEC for r=0.3 class 2 = 0.577 +- 0.275 (in-sample avg dev_std = 0.382)
NEC for r=0.3 all KL = 0.521 +- 0.275 (in-sample avg dev_std = 0.382)
NEC for r=0.3 all L1 = 0.557 +- 0.180 (in-sample avg dev_std = 0.382)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.6
Model XAI F1 of binarized graphs for r=0.6 =  0.60325125
Model XAI WIoU of binarized graphs for r=0.6 =  0.47318875
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.399
NEC for r=0.6 class 0 = 0.458 +- 0.284 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 1 = 0.493 +- 0.284 (in-sample avg dev_std = 0.444)
NEC for r=0.6 class 2 = 0.582 +- 0.284 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all KL = 0.486 +- 0.284 (in-sample avg dev_std = 0.444)
NEC for r=0.6 all L1 = 0.511 +- 0.183 (in-sample avg dev_std = 0.444)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  0.51700875
Model XAI WIoU of binarized graphs for r=0.9 =  0.38577125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.454
NEC for r=0.9 class 0 = 0.472 +- 0.275 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 1 = 0.55 +- 0.275 (in-sample avg dev_std = 0.498)
NEC for r=0.9 class 2 = 0.591 +- 0.275 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all KL = 0.532 +- 0.275 (in-sample avg dev_std = 0.498)
NEC for r=0.9 all L1 = 0.537 +- 0.155 (in-sample avg dev_std = 0.498)


ratio=1.0


Computing with masking

Model Accuracy of binarized graphs for r=1.0 =  0.914
Model XAI F1 of binarized graphs for r=1.0 =  0.5090349999999999
Model XAI WIoU of binarized graphs for r=1.0 =  0.37917249999999997
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model Accuracy over intervened graphs for r=1.0 =  0.477
NEC for r=1.0 class 0 = 0.533 +- 0.282 (in-sample avg dev_std = 0.563)
NEC for r=1.0 class 1 = 0.563 +- 0.282 (in-sample avg dev_std = 0.563)
NEC for r=1.0 class 2 = 0.59 +- 0.282 (in-sample avg dev_std = 0.563)
NEC for r=1.0 all KL = 0.612 +- 0.282 (in-sample avg dev_std = 0.563)
NEC for r=1.0 all L1 = 0.562 +- 0.171 (in-sample avg dev_std = 0.563)


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model Accuracy of binarized graphs for r=0.3 =  0.412
Model XAI F1 of binarized graphs for r=0.3 =  0.6713825
Model XAI WIoU of binarized graphs for r=0.3 =  0.5470524999999999
len(reference) = 800
Effective ratio: 0.314 +- 0.012
Model Accuracy over intervened graphs for r=0.3 =  0.4
SUFF++ for r=0.3 class 0 = 0.524 +- 0.249 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 1 = 0.519 +- 0.249 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 class 2 = 0.573 +- 0.249 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 all KL = 0.575 +- 0.249 (in-sample avg dev_std = 0.456)
SUFF++ for r=0.3 all L1 = 0.538 +- 0.155 (in-sample avg dev_std = 0.456)


ratio=0.6


Computing with masking

Model Accuracy of binarized graphs for r=0.6 =  0.6
Model XAI F1 of binarized graphs for r=0.6 =  0.60325125
Model XAI WIoU of binarized graphs for r=0.6 =  0.47318875
len(reference) = 800
Effective ratio: 0.614 +- 0.011
Model Accuracy over intervened graphs for r=0.6 =  0.579
SUFF++ for r=0.6 class 0 = 0.542 +- 0.255 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 1 = 0.54 +- 0.255 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 2 = 0.741 +- 0.255 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all KL = 0.647 +- 0.255 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all L1 = 0.607 +- 0.199 (in-sample avg dev_std = 0.422)


ratio=0.9


Computing with masking

Model Accuracy of binarized graphs for r=0.9 =  0.832
Model XAI F1 of binarized graphs for r=0.9 =  0.51700875
Model XAI WIoU of binarized graphs for r=0.9 =  0.38577125
len(reference) = 800
Effective ratio: 0.914 +- 0.012
Model Accuracy over intervened graphs for r=0.9 =  0.806
SUFF++ for r=0.9 class 0 = 0.698 +- 0.181 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.9 class 1 = 0.734 +- 0.181 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.9 class 2 = 0.853 +- 0.181 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.9 all KL = 0.834 +- 0.181 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.9 all L1 = 0.761 +- 0.182 (in-sample avg dev_std = 0.272)


ratio=1.0



Zero intervened samples, skipping weight=1.0


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_test
nec = [defaultdict(<class 'list'>, {'all_KL': [0.425, 0.602, 0.575, 0.628], 'all_L1': [0.473, 0.572, 0.555, 0.57]}), defaultdict(<class 'list'>, {'all_KL': [0.38, 0.537, 0.552, 0.579], 'all_L1': [0.446, 0.525, 0.547, 0.561]}), defaultdict(<class 'list'>, {'all_KL': [0.563, 0.533, 0.578, 0.625], 'all_L1': [0.582, 0.531, 0.554, 0.565]}), defaultdict(<class 'list'>, {'all_KL': [0.504, 0.588, 0.587, 0.596], 'all_L1': [0.549, 0.558, 0.552, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.521, 0.486, 0.532, 0.612], 'all_L1': [0.557, 0.511, 0.537, 0.562]})]
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.641, 0.605, 0.831, 1.0], 'all_L1': [0.607, 0.603, 0.772, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.633, 0.622, 0.866, 1.0], 'all_L1': [0.587, 0.607, 0.789, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.571, 0.641, 0.841, 1.0], 'all_L1': [0.538, 0.608, 0.771, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.57, 0.595, 0.861, 1.0], 'all_L1': [0.542, 0.59, 0.805, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.575, 0.647, 0.834, 1.0], 'all_L1': [0.538, 0.607, 0.761, 1.0], 0: [1.0], 1: [1.0], 2: [1.0]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_test
nec class all_L1  =  0.521 +- 0.052, 0.539 +- 0.022, 0.549 +- 0.007, 0.563 +- 0.004
nec class all_KL  =  0.479 +- 0.067, 0.549 +- 0.042, 0.565 +- 0.020, 0.608 +- 0.018
nec_acc_int  =  0.319 +- 0.009, 0.390 +- 0.008, 0.446 +- 0.011, 0.467 +- 0.009
suff++ class all_L1  =  0.562 +- 0.029, 0.603 +- 0.007, 0.780 +- 0.016, 1.000 +- 0.000
suff++ class all_KL  =  0.598 +- 0.032, 0.622 +- 0.020, 0.847 +- 0.014, 1.000 +- 0.000
suff++_acc_int  =  0.403 +- 0.028, 0.597 +- 0.017, 0.801 +- 0.023


 -------------------------------------------------- 
Computing faithfulness

Eval split id_test
Faith. Aritm (L1)= 		  =  0.542 +- 0.014, 0.571 +- 0.010, 0.664 +- 0.010, 0.782 +- 0.002
Faith. Armon (L1)= 		  =  0.538 +- 0.018, 0.569 +- 0.011, 0.644 +- 0.008, 0.721 +- 0.003
Faith. GMean (L1)= 	  =  0.540 +- 0.016, 0.570 +- 0.010, 0.654 +- 0.009, 0.751 +- 0.003
Faith. Aritm (KL)= 		  =  0.538 +- 0.020, 0.586 +- 0.012, 0.706 +- 0.013, 0.804 +- 0.009
Faith. Armon (KL)= 		  =  0.527 +- 0.032, 0.582 +- 0.016, 0.677 +- 0.016, 0.756 +- 0.014
Faith. GMean (KL)= 	  =  0.533 +- 0.026, 0.584 +- 0.014, 0.691 +- 0.015, 0.780 +- 0.012
Computed for split load_split = id



Completed in  0:07:56.769680  for GSATGIN GOODMotif/size



DONE GSAT GOODMotif/size mitigation_readout weighted
DONE all :)
