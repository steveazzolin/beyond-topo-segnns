nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 2101772

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:01:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:01:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.667
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.741
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.989
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.989
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.906
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.957
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.955



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.954513
Original XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6514, device='cuda:1')  +-  tensor(0.2730, device='cuda:1') (0.10145808756351471)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.887412
Original XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6514, device='cuda:1')  +-  tensor(0.2730, device='cuda:1') (0.10145808756351471)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.915833
Original XAI WIoU for r=0.9 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6514, device='cuda:1')  +-  tensor(0.2730, device='cuda:1') (0.10145808756351471)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.201312
Original XAI WIoU for r=0.3 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6598, device='cuda:1')  +-  tensor(0.2728, device='cuda:1') (0.10055670887231827)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.906902
Original XAI WIoU for r=0.6 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6598, device='cuda:1')  +-  tensor(0.2728, device='cuda:1') (0.10055670887231827)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.884316
Original XAI WIoU for r=0.9 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6598, device='cuda:1')  +-  tensor(0.2728, device='cuda:1') (0.10055670887231827)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.165464
Original XAI WIoU for r=0.3 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3298, device='cuda:1')  +-  tensor(0.0641, device='cuda:1') (0.0878911092877388)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.116341
Original XAI WIoU for r=0.6 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3298, device='cuda:1')  +-  tensor(0.0641, device='cuda:1') (0.0878911092877388)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.224422
Original XAI WIoU for r=0.9 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3298, device='cuda:1')  +-  tensor(0.0641, device='cuda:1') (0.0878911092877388)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.910434
Original XAI WIoU for r=0.3 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8302, device='cuda:1')  +-  tensor(0.1649, device='cuda:1') (0.06928016990423203)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.897145
Original XAI WIoU for r=0.6 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.8302, device='cuda:1')  +-  tensor(0.1649, device='cuda:1') (0.06928016990423203)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.961745
Original XAI WIoU for r=0.9 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.8302, device='cuda:1')  +-  tensor(0.1649, device='cuda:1') (0.06928016990423203)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:08:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:08:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.767
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.713
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.777
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.774
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.995
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.836
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.840
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.788



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.126257
Original XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6750, device='cuda:1')  +-  tensor(0.2931, device='cuda:1') (0.08561138063669205)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.860200
Original XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6750, device='cuda:1')  +-  tensor(0.2931, device='cuda:1') (0.08561138063669205)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.856732
Original XAI WIoU for r=0.9 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6750, device='cuda:1')  +-  tensor(0.2931, device='cuda:1') (0.08561138063669205)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.940328
Original XAI WIoU for r=0.3 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6793, device='cuda:1')  +-  tensor(0.2919, device='cuda:1') (0.0844365581870079)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.856615
Original XAI WIoU for r=0.6 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6793, device='cuda:1')  +-  tensor(0.2919, device='cuda:1') (0.0844365581870079)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.803349
Original XAI WIoU for r=0.9 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6793, device='cuda:1')  +-  tensor(0.2919, device='cuda:1') (0.0844365581870079)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.341669
Original XAI WIoU for r=0.3 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3539, device='cuda:1')  +-  tensor(0.0767, device='cuda:1') (0.11467626690864563)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.107904
Original XAI WIoU for r=0.6 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3539, device='cuda:1')  +-  tensor(0.0767, device='cuda:1') (0.11467626690864563)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.295948
Original XAI WIoU for r=0.9 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3539, device='cuda:1')  +-  tensor(0.0767, device='cuda:1') (0.11467626690864563)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.848190
Original XAI WIoU for r=0.3 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7479, device='cuda:1')  +-  tensor(0.2013, device='cuda:1') (0.11037370562553406)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.839042
Original XAI WIoU for r=0.6 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7479, device='cuda:1')  +-  tensor(0.2013, device='cuda:1') (0.11037370562553406)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.680744
Original XAI WIoU for r=0.9 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7479, device='cuda:1')  +-  tensor(0.2013, device='cuda:1') (0.11037370562553406)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:13:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:13:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.697
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.687
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.700
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.994
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.745
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.685



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.916348
Original XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6168, device='cuda:1')  +-  tensor(0.2715, device='cuda:1') (0.09258031845092773)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.839578
Original XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6168, device='cuda:1')  +-  tensor(0.2715, device='cuda:1') (0.09258031845092773)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.964193
Original XAI WIoU for r=0.9 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6168, device='cuda:1')  +-  tensor(0.2715, device='cuda:1') (0.09258031845092773)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.088968
Original XAI WIoU for r=0.3 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6200, device='cuda:1')  +-  tensor(0.2690, device='cuda:1') (0.09431933611631393)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.809389
Original XAI WIoU for r=0.6 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6200, device='cuda:1')  +-  tensor(0.2690, device='cuda:1') (0.09431937336921692)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.098701
Original XAI WIoU for r=0.9 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6200, device='cuda:1')  +-  tensor(0.2690, device='cuda:1') (0.09431937336921692)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.073035
Original XAI WIoU for r=0.3 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.0634, device='cuda:1') (0.09265893697738647)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.118499
Original XAI WIoU for r=0.6 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.0634, device='cuda:1') (0.09265893697738647)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.063635
Original XAI WIoU for r=0.9 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.0634, device='cuda:1') (0.09265893697738647)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.876821
Original XAI WIoU for r=0.3 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6378, device='cuda:1')  +-  tensor(0.1711, device='cuda:1') (0.10082198679447174)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.831103
Original XAI WIoU for r=0.6 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6378, device='cuda:1')  +-  tensor(0.1711, device='cuda:1') (0.10082187503576279)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.848702
Original XAI WIoU for r=0.9 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6378, device='cuda:1')  +-  tensor(0.1711, device='cuda:1') (0.10082198679447174)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:18:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:18:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.905
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.845
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.904
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.908
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.996
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.996
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.996
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.850
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.846
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.846



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.197610
Original XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6671, device='cuda:1')  +-  tensor(0.2495, device='cuda:1') (0.1474357694387436)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.931103
Original XAI WIoU for r=0.6 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6671, device='cuda:1')  +-  tensor(0.2495, device='cuda:1') (0.14743565022945404)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.923732
Original XAI WIoU for r=0.9 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6671, device='cuda:1')  +-  tensor(0.2495, device='cuda:1') (0.14743565022945404)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.184801
Original XAI WIoU for r=0.3 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6683, device='cuda:1')  +-  tensor(0.2468, device='cuda:1') (0.14761552214622498)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.943095
Original XAI WIoU for r=0.6 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6683, device='cuda:1')  +-  tensor(0.2468, device='cuda:1') (0.14761555194854736)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.404572
Original XAI WIoU for r=0.9 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6683, device='cuda:1')  +-  tensor(0.2468, device='cuda:1') (0.14761552214622498)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.130848
Original XAI WIoU for r=0.3 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.1417, device='cuda:1') (0.15767209231853485)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.142492
Original XAI WIoU for r=0.6 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.1417, device='cuda:1') (0.15767209231853485)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.107020
Original XAI WIoU for r=0.9 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.1417, device='cuda:1') (0.15767209231853485)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.951346
Original XAI WIoU for r=0.3 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6398, device='cuda:1')  +-  tensor(0.2021, device='cuda:1') (0.1714533269405365)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.967502
Original XAI WIoU for r=0.6 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6398, device='cuda:1')  +-  tensor(0.2021, device='cuda:1') (0.1714533269405365)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.944005
Original XAI WIoU for r=0.9 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6398, device='cuda:1')  +-  tensor(0.2021, device='cuda:1') (0.1714533269405365)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:23:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:23:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.716
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.653
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.720
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.713
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.930
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.927
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.927
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.897
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.845
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.822



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.953831
Original XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6494, device='cuda:1')  +-  tensor(0.2594, device='cuda:1') (0.11234758049249649)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.934638
Original XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6494, device='cuda:1')  +-  tensor(0.2594, device='cuda:1') (0.11234758049249649)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.326235
Original XAI WIoU for r=0.9 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6494, device='cuda:1')  +-  tensor(0.2594, device='cuda:1') (0.11234758049249649)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.012636
Original XAI WIoU for r=0.3 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6546, device='cuda:1')  +-  tensor(0.2583, device='cuda:1') (0.11343184113502502)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.962009
Original XAI WIoU for r=0.6 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6546, device='cuda:1')  +-  tensor(0.2583, device='cuda:1') (0.11343184113502502)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.935601
Original XAI WIoU for r=0.9 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6546, device='cuda:1')  +-  tensor(0.2583, device='cuda:1') (0.11343184113502502)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.380956
Original XAI WIoU for r=0.3 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3670, device='cuda:1')  +-  tensor(0.1055, device='cuda:1') (0.10504388064146042)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.130280
Original XAI WIoU for r=0.6 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3670, device='cuda:1')  +-  tensor(0.1055, device='cuda:1') (0.10504388064146042)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.869699
Original XAI WIoU for r=0.9 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3670, device='cuda:1')  +-  tensor(0.1055, device='cuda:1') (0.10504388064146042)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.222628
Original XAI WIoU for r=0.3 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8098, device='cuda:1')  +-  tensor(0.1186, device='cuda:1') (0.12792463600635529)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.948791
Original XAI WIoU for r=0.6 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.8098, device='cuda:1')  +-  tensor(0.1186, device='cuda:1') (0.12792463600635529)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.225917
Original XAI WIoU for r=0.9 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.8098, device='cuda:1')  +-  tensor(0.1186, device='cuda:1') (0.12792463600635529)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) id_val WIOU_ORIGINAL: 	[0.76367326 0.76367326 0.76367326] +- [0.07432533 0.07432533 0.07432533] (mean across ratios: 0.7636732578277586)
(id) id_val WIOU_PERTURBED: 	[0.65195575 0.65195574 0.65195574] +- [0.02001625 0.02001624 0.02001624] (mean across ratios: 0.6519557396570842)
(id) id_test WIOU_ORIGINAL: 	[0.76730324 0.76730324 0.76730324] +- [0.07490313 0.07490313 0.07490313] (mean across ratios: 0.7673032402992247)
(id) id_test WIOU_PERTURBED: 	[0.65638751 0.6563875  0.65638748] +- [0.02003427 0.02003432 0.02003431] (mean across ratios: 0.6563874959945678)
(id) val WIOU_ORIGINAL: 	[0.98065083 0.98065083 0.98065083] +- [0.02661738 0.02661738 0.02661738] (mean across ratios: 0.98065083026886)
(id) val WIOU_PERTURBED: 	[0.36106752 0.36106752 0.36106752] +- [0.03837744 0.03837744 0.03837744] (mean across ratios: 0.361067521572113)
(id) test WIOU_ORIGINAL: 	[0.81706636 0.81706636 0.81706636] +- [0.08885075 0.08885075 0.08885075] (mean across ratios: 0.8170663595199587)
(id) test WIOU_PERTURBED: 	[0.73308194 0.73308194 0.73308194] +- [0.08161087 0.08161087 0.08161087] (mean across ratios: 0.7330819368362427)
DONE LECI GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:29:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:29:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.667
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.741
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.989
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.989
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.906
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.957
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.955



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.264871
Original XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6454, device='cuda:1')  +-  tensor(0.2858, device='cuda:1') (0.09806277602910995)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.004689
Original XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6454, device='cuda:1')  +-  tensor(0.2858, device='cuda:1') (0.09806277602910995)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.212767
Original XAI WIoU for r=0.9 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6454, device='cuda:1')  +-  tensor(0.2858, device='cuda:1') (0.09806270897388458)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.266987
Original XAI WIoU for r=0.3 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6516, device='cuda:1')  +-  tensor(0.2833, device='cuda:1') (0.0991898626089096)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.267258
Original XAI WIoU for r=0.6 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6516, device='cuda:1')  +-  tensor(0.2833, device='cuda:1') (0.0991898626089096)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.204464
Original XAI WIoU for r=0.9 =  tensor(0.7407, device='cuda:1')  +-  tensor(0.2522, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6516, device='cuda:1')  +-  tensor(0.2833, device='cuda:1') (0.0991898626089096)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.199627
Original XAI WIoU for r=0.3 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2825, device='cuda:1')  +-  tensor(0.0885, device='cuda:1') (0.06709951162338257)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.682361
Original XAI WIoU for r=0.6 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2825, device='cuda:1')  +-  tensor(0.0885, device='cuda:1') (0.06709951162338257)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.559959
Original XAI WIoU for r=0.9 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2825, device='cuda:1')  +-  tensor(0.0885, device='cuda:1') (0.06709951162338257)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.517961
Original XAI WIoU for r=0.3 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8312, device='cuda:1')  +-  tensor(0.1262, device='cuda:1') (0.118670754134655)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.234795
Original XAI WIoU for r=0.6 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.8312, device='cuda:1')  +-  tensor(0.1262, device='cuda:1') (0.11867088824510574)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.498749
Original XAI WIoU for r=0.9 =  tensor(0.9551, device='cuda:1')  +-  tensor(0.0953, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.8312, device='cuda:1')  +-  tensor(0.1262, device='cuda:1') (0.118670754134655)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:34:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:34:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.767
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.713
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.777
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.774
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.995
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.836
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.840
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.788



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.257351
Original XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6457, device='cuda:1')  +-  tensor(0.3022, device='cuda:1') (0.08036809414625168)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.363247
Original XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6457, device='cuda:1')  +-  tensor(0.3022, device='cuda:1') (0.08036809414625168)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.226022
Original XAI WIoU for r=0.9 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6457, device='cuda:1')  +-  tensor(0.3022, device='cuda:1') (0.08036809414625168)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.457712
Original XAI WIoU for r=0.3 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6491, device='cuda:1')  +-  tensor(0.2994, device='cuda:1') (0.08086496591567993)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.591235
Original XAI WIoU for r=0.6 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6491, device='cuda:1')  +-  tensor(0.2994, device='cuda:1') (0.08086496591567993)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.529790
Original XAI WIoU for r=0.9 =  tensor(0.7745, device='cuda:1')  +-  tensor(0.2404, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6491, device='cuda:1')  +-  tensor(0.2994, device='cuda:1') (0.08086496591567993)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.602717
Original XAI WIoU for r=0.3 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2920, device='cuda:1')  +-  tensor(0.0930, device='cuda:1') (0.08526962250471115)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.997107
Original XAI WIoU for r=0.6 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2920, device='cuda:1')  +-  tensor(0.0930, device='cuda:1') (0.08526962250471115)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.310012
Original XAI WIoU for r=0.9 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2920, device='cuda:1')  +-  tensor(0.0930, device='cuda:1') (0.08526952564716339)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.414180
Original XAI WIoU for r=0.3 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7464, device='cuda:1')  +-  tensor(0.1022, device='cuda:1') (0.14703334867954254)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.241708
Original XAI WIoU for r=0.6 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7464, device='cuda:1')  +-  tensor(0.1022, device='cuda:1') (0.14703334867954254)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.303090
Original XAI WIoU for r=0.9 =  tensor(0.7803, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7464, device='cuda:1')  +-  tensor(0.1022, device='cuda:1') (0.14703334867954254)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:40:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:40:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.697
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.687
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.700
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.994
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.745
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.685



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.482756
Original XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6138, device='cuda:1')  +-  tensor(0.2901, device='cuda:1') (0.08341387659311295)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.482887
Original XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6138, device='cuda:1')  +-  tensor(0.2901, device='cuda:1') (0.08341387659311295)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.195723
Original XAI WIoU for r=0.9 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6138, device='cuda:1')  +-  tensor(0.2901, device='cuda:1') (0.0834139734506607)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.152900
Original XAI WIoU for r=0.3 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6164, device='cuda:1')  +-  tensor(0.2872, device='cuda:1') (0.08396016061306)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.221355
Original XAI WIoU for r=0.6 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6164, device='cuda:1')  +-  tensor(0.2872, device='cuda:1') (0.08396016061306)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.111176
Original XAI WIoU for r=0.9 =  tensor(0.6998, device='cuda:1')  +-  tensor(0.2270, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6164, device='cuda:1')  +-  tensor(0.2872, device='cuda:1') (0.08396016061306)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.346109
Original XAI WIoU for r=0.3 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2669, device='cuda:1')  +-  tensor(0.0784, device='cuda:1') (0.061007533222436905)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.561907
Original XAI WIoU for r=0.6 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2669, device='cuda:1')  +-  tensor(0.0784, device='cuda:1') (0.061007533222436905)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.413818
Original XAI WIoU for r=0.9 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2669, device='cuda:1')  +-  tensor(0.0784, device='cuda:1') (0.061007533222436905)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.207619
Original XAI WIoU for r=0.3 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6615, device='cuda:1')  +-  tensor(0.0866, device='cuda:1') (0.1285254955291748)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.297618
Original XAI WIoU for r=0.6 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6615, device='cuda:1')  +-  tensor(0.0866, device='cuda:1') (0.1285254955291748)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.177001
Original XAI WIoU for r=0.9 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.2682, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6615, device='cuda:1')  +-  tensor(0.0866, device='cuda:1') (0.1285254955291748)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:47:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:47:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.905
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.845
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.904
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.908
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.996
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.996
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.996
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.850
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.846
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.846



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.163325
Original XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6308, device='cuda:1')  +-  tensor(0.2773, device='cuda:1') (0.12393961101770401)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.251337
Original XAI WIoU for r=0.6 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6308, device='cuda:1')  +-  tensor(0.2773, device='cuda:1') (0.12393949925899506)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.440122
Original XAI WIoU for r=0.9 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6308, device='cuda:1')  +-  tensor(0.2773, device='cuda:1') (0.12393949925899506)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.415990
Original XAI WIoU for r=0.3 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6303, device='cuda:1')  +-  tensor(0.2735, device='cuda:1') (0.12560684978961945)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.122172
Original XAI WIoU for r=0.6 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6303, device='cuda:1')  +-  tensor(0.2735, device='cuda:1') (0.12560679018497467)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.220827
Original XAI WIoU for r=0.9 =  tensor(0.9081, device='cuda:1')  +-  tensor(0.1867, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6303, device='cuda:1')  +-  tensor(0.2735, device='cuda:1') (0.12560679018497467)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.039030
Original XAI WIoU for r=0.3 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3136, device='cuda:1')  +-  tensor(0.1152, device='cuda:1') (0.12412916868925095)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.309232
Original XAI WIoU for r=0.6 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3136, device='cuda:1')  +-  tensor(0.1152, device='cuda:1') (0.12412913143634796)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.120130
Original XAI WIoU for r=0.9 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3136, device='cuda:1')  +-  tensor(0.1152, device='cuda:1') (0.12412913143634796)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.453567
Original XAI WIoU for r=0.3 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6455, device='cuda:1')  +-  tensor(0.1838, device='cuda:1') (0.18348278105258942)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.227175
Original XAI WIoU for r=0.6 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6455, device='cuda:1')  +-  tensor(0.1838, device='cuda:1') (0.18348278105258942)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.726336
Original XAI WIoU for r=0.9 =  tensor(0.8460, device='cuda:1')  +-  tensor(0.2260, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6455, device='cuda:1')  +-  tensor(0.1838, device='cuda:1') (0.18348278105258942)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:52:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:52:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.716
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.653
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.720
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.713
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.930
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.927
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.927
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.897
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.845
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.822



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.248978
Original XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6224, device='cuda:1')  +-  tensor(0.2655, device='cuda:1') (0.11180293560028076)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.225757
Original XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6224, device='cuda:1')  +-  tensor(0.2655, device='cuda:1') (0.11180293560028076)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.317294
Original XAI WIoU for r=0.9 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6224, device='cuda:1')  +-  tensor(0.2655, device='cuda:1') (0.11180293560028076)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.299356
Original XAI WIoU for r=0.3 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6280, device='cuda:1')  +-  tensor(0.2627, device='cuda:1') (0.11409159004688263)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.259844
Original XAI WIoU for r=0.6 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6280, device='cuda:1')  +-  tensor(0.2627, device='cuda:1') (0.11409159004688263)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.275313
Original XAI WIoU for r=0.9 =  tensor(0.7133, device='cuda:1')  +-  tensor(0.2467, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6280, device='cuda:1')  +-  tensor(0.2627, device='cuda:1') (0.11409159004688263)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.468986
Original XAI WIoU for r=0.3 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2863, device='cuda:1')  +-  tensor(0.0908, device='cuda:1') (0.07755762338638306)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.293007
Original XAI WIoU for r=0.6 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2863, device='cuda:1')  +-  tensor(0.0908, device='cuda:1') (0.07755762338638306)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.391391
Original XAI WIoU for r=0.9 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2863, device='cuda:1')  +-  tensor(0.0908, device='cuda:1') (0.07755762338638306)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.332998
Original XAI WIoU for r=0.3 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7081, device='cuda:1')  +-  tensor(0.1052, device='cuda:1') (0.13981026411056519)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.212994
Original XAI WIoU for r=0.6 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7081, device='cuda:1')  +-  tensor(0.1052, device='cuda:1') (0.13981014490127563)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.177981
Original XAI WIoU for r=0.9 =  tensor(0.8218, device='cuda:1')  +-  tensor(0.1873, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7081, device='cuda:1')  +-  tensor(0.1052, device='cuda:1') (0.13981026411056519)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) id_val WIOU_ORIGINAL: 	[0.76367326 0.76367326 0.76367326] +- [0.07432533 0.07432533 0.07432533] (mean across ratios: 0.7636732578277586)
(id) id_val WIOU_PERTURBED: 	[0.63159659 0.63159658 0.63159659] +- [0.0125901  0.01259011 0.01259015] (mean across ratios: 0.631596585114797)
(id) id_test WIOU_ORIGINAL: 	[0.76730324 0.76730324 0.76730324] +- [0.07490313 0.07490313 0.07490313] (mean across ratios: 0.7673032402992247)
(id) id_test WIOU_PERTURBED: 	[0.6350733  0.63507329 0.63507329] +- [0.01335823 0.01335824 0.01335824] (mean across ratios: 0.6350732962290446)
(id) val WIOU_ORIGINAL: 	[0.98065083 0.98065083 0.98065076] +- [0.02661738 0.02661738 0.02661752] (mean across ratios: 0.980650806427002)
(id) val WIOU_PERTURBED: 	[0.2882324  0.28823242 0.28823243] +- [0.01515821 0.01515823 0.01515823] (mean across ratios: 0.2882324159145355)
(id) test WIOU_ORIGINAL: 	[0.81706636 0.81706636 0.81706636] +- [0.08885075 0.08885075 0.08885075] (mean across ratios: 0.8170663595199587)
(id) test WIOU_PERTURBED: 	[0.71852727 0.71852725 0.71852727] +- [0.06656756 0.06656752 0.06656756] (mean across ratios: 0.7185272614161174)
DONE LECI GOODMotif2/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 15:58:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 03:58:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.600
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.599
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.626
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.607
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.409
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.358
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.355
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.108
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.232
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.250



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.301275
Original XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5083, device='cuda:1')  +-  tensor(0.2805, device='cuda:1') (0.09462638199329376)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.804191
Original XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5083, device='cuda:1')  +-  tensor(0.2805, device='cuda:1') (0.09462638199329376)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.410653
Original XAI WIoU for r=0.9 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5083, device='cuda:1')  +-  tensor(0.2805, device='cuda:1') (0.09462638199329376)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.961877
Original XAI WIoU for r=0.3 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2787, device='cuda:1') (0.09599733352661133)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.281953
Original XAI WIoU for r=0.6 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2787, device='cuda:1') (0.09599733352661133)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.739562
Original XAI WIoU for r=0.9 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2787, device='cuda:1') (0.09599733352661133)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.733207
Original XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2321, device='cuda:1')  +-  tensor(0.0696, device='cuda:1') (0.047380995005369186)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.879327
Original XAI WIoU for r=0.6 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2321, device='cuda:1')  +-  tensor(0.0696, device='cuda:1') (0.04738098755478859)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.937098
Original XAI WIoU for r=0.9 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2321, device='cuda:1')  +-  tensor(0.0696, device='cuda:1') (0.047380995005369186)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.364507
Original XAI WIoU for r=0.3 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3108, device='cuda:1')  +-  tensor(0.1623, device='cuda:1') (0.053981781005859375)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.244809
Original XAI WIoU for r=0.6 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3108, device='cuda:1')  +-  tensor(0.1623, device='cuda:1') (0.05398177355527878)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.858223
Original XAI WIoU for r=0.9 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3108, device='cuda:1')  +-  tensor(0.1623, device='cuda:1') (0.05398177355527878)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 16:05:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 04:05:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.480
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.512
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.481
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.509
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.508
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.474
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.341
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.308
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.311



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.994794
Original XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5239, device='cuda:1')  +-  tensor(0.2820, device='cuda:1') (0.06783194094896317)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.414016
Original XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5239, device='cuda:1')  +-  tensor(0.2820, device='cuda:1') (0.06783194094896317)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.631144
Original XAI WIoU for r=0.9 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5239, device='cuda:1')  +-  tensor(0.2820, device='cuda:1') (0.06783194094896317)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.690264
Original XAI WIoU for r=0.3 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5195, device='cuda:1')  +-  tensor(0.2769, device='cuda:1') (0.06780162453651428)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.631833
Original XAI WIoU for r=0.6 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5195, device='cuda:1')  +-  tensor(0.2769, device='cuda:1') (0.06780162453651428)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.637776
Original XAI WIoU for r=0.9 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5195, device='cuda:1')  +-  tensor(0.2769, device='cuda:1') (0.06780162453651428)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.972495
Original XAI WIoU for r=0.3 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2826, device='cuda:1')  +-  tensor(0.0651, device='cuda:1') (0.05203045532107353)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.749317
Original XAI WIoU for r=0.6 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2826, device='cuda:1')  +-  tensor(0.0651, device='cuda:1') (0.05203045532107353)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.897077
Original XAI WIoU for r=0.9 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2826, device='cuda:1')  +-  tensor(0.0651, device='cuda:1') (0.05203045532107353)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.622238
Original XAI WIoU for r=0.3 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3799, device='cuda:1')  +-  tensor(0.1307, device='cuda:1') (0.06394309550523758)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.647138
Original XAI WIoU for r=0.6 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3799, device='cuda:1')  +-  tensor(0.1307, device='cuda:1') (0.06394309550523758)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.851224
Original XAI WIoU for r=0.9 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3799, device='cuda:1')  +-  tensor(0.1307, device='cuda:1') (0.06394309550523758)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 16:12:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:56 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:56 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:56 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:56 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:12:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:57 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:12:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:57 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 04:12:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.684
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.727
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.691
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.909
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.907
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.906
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.140
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.218
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.231



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.649096
Original XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6090, device='cuda:1')  +-  tensor(0.2674, device='cuda:1') (0.1279824674129486)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.617927
Original XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6090, device='cuda:1')  +-  tensor(0.2674, device='cuda:1') (0.1279824674129486)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.616406
Original XAI WIoU for r=0.9 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6090, device='cuda:1')  +-  tensor(0.2674, device='cuda:1') (0.1279824674129486)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.607663
Original XAI WIoU for r=0.3 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6113, device='cuda:1')  +-  tensor(0.2652, device='cuda:1') (0.1277405321598053)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.441114
Original XAI WIoU for r=0.6 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6113, device='cuda:1')  +-  tensor(0.2652, device='cuda:1') (0.1277405321598053)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.687051
Original XAI WIoU for r=0.9 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6113, device='cuda:1')  +-  tensor(0.2652, device='cuda:1') (0.1277405321598053)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.592788
Original XAI WIoU for r=0.3 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4402, device='cuda:1')  +-  tensor(0.1395, device='cuda:1') (0.16885486245155334)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.913942
Original XAI WIoU for r=0.6 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4402, device='cuda:1')  +-  tensor(0.1395, device='cuda:1') (0.16885486245155334)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.734359
Original XAI WIoU for r=0.9 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4402, device='cuda:1')  +-  tensor(0.1395, device='cuda:1') (0.16885486245155334)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.998781
Original XAI WIoU for r=0.3 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3453, device='cuda:1')  +-  tensor(0.2130, device='cuda:1') (0.08723428100347519)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.847813
Original XAI WIoU for r=0.6 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3453, device='cuda:1')  +-  tensor(0.2130, device='cuda:1') (0.08723428100347519)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.237719
Original XAI WIoU for r=0.9 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3453, device='cuda:1')  +-  tensor(0.2130, device='cuda:1') (0.08723428100347519)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 16:18:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 04:18:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.484
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.510
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.515
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.507
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.294
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.166
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.292
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.274



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.151560
Original XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5196, device='cuda:1')  +-  tensor(0.2978, device='cuda:1') (0.06063264235854149)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.146941
Original XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5196, device='cuda:1')  +-  tensor(0.2978, device='cuda:1') (0.06063264235854149)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.395502
Original XAI WIoU for r=0.9 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5196, device='cuda:1')  +-  tensor(0.2978, device='cuda:1') (0.06063264235854149)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.703171
Original XAI WIoU for r=0.3 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5174, device='cuda:1')  +-  tensor(0.2946, device='cuda:1') (0.06008384749293327)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.482004
Original XAI WIoU for r=0.6 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5174, device='cuda:1')  +-  tensor(0.2946, device='cuda:1') (0.06008384749293327)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.386886
Original XAI WIoU for r=0.9 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5174, device='cuda:1')  +-  tensor(0.2946, device='cuda:1') (0.06008384749293327)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.123714
Original XAI WIoU for r=0.3 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2684, device='cuda:1')  +-  tensor(0.0670, device='cuda:1') (0.051646169275045395)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.047750
Original XAI WIoU for r=0.6 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2684, device='cuda:1')  +-  tensor(0.0670, device='cuda:1') (0.051646169275045395)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.119080
Original XAI WIoU for r=0.9 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2684, device='cuda:1')  +-  tensor(0.0670, device='cuda:1') (0.051646169275045395)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.450993
Original XAI WIoU for r=0.3 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3584, device='cuda:1')  +-  tensor(0.1549, device='cuda:1') (0.0667540431022644)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.080108
Original XAI WIoU for r=0.6 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3584, device='cuda:1')  +-  tensor(0.1549, device='cuda:1') (0.0667540431022644)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.546450
Original XAI WIoU for r=0.9 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3584, device='cuda:1')  +-  tensor(0.1549, device='cuda:1') (0.0667540431022644)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 16:26:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 04:26:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.374
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.367
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.471
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.467
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.461
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.330
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.187
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.274



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.639480
Original XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3425, device='cuda:1')  +-  tensor(0.1547, device='cuda:1') (0.12093371152877808)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.545199
Original XAI WIoU for r=0.6 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3425, device='cuda:1')  +-  tensor(0.1547, device='cuda:1') (0.12093371152877808)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.306303
Original XAI WIoU for r=0.9 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3425, device='cuda:1')  +-  tensor(0.1547, device='cuda:1') (0.12093371152877808)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.792847
Original XAI WIoU for r=0.3 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3421, device='cuda:1')  +-  tensor(0.1553, device='cuda:1') (0.11752109974622726)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.553008
Original XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3421, device='cuda:1')  +-  tensor(0.1553, device='cuda:1') (0.11752109974622726)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.571457
Original XAI WIoU for r=0.9 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3421, device='cuda:1')  +-  tensor(0.1553, device='cuda:1') (0.11752109974622726)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.610383
Original XAI WIoU for r=0.3 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2413, device='cuda:1')  +-  tensor(0.0609, device='cuda:1') (0.05962599068880081)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.627193
Original XAI WIoU for r=0.6 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2413, device='cuda:1')  +-  tensor(0.0609, device='cuda:1') (0.05962599068880081)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.645720
Original XAI WIoU for r=0.9 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2413, device='cuda:1')  +-  tensor(0.0609, device='cuda:1') (0.05962599068880081)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.722763
Original XAI WIoU for r=0.3 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3233, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.11118689924478531)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.872445
Original XAI WIoU for r=0.6 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3233, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.11118689924478531)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.797209
Original XAI WIoU for r=0.9 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3233, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.11118689924478531)
len(reference) = 3000


DONE GOODMotif2 - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.56387447 0.56387447 0.5638744 ] +- [0.09189798 0.09189798 0.09189802] (mean across ratios: 0.5638744473457337)
(id) id_val WIOU_PERTURBED: 	[0.50066455 0.50066455 0.50066455] +- [0.08686936 0.08686936 0.08686936] (mean across ratios: 0.5006645500659943)
(id) id_test WIOU_ORIGINAL: 	[0.56484793 0.56484793 0.56484793] +- [0.09662339 0.09662339 0.09662339] (mean across ratios: 0.5648479282855987)
(id) id_test WIOU_PERTURBED: 	[0.49963872 0.49963872 0.49963872] +- [0.08725334 0.08725334 0.08725334] (mean across ratios: 0.4996387243270874)
(id) val WIOU_ORIGINAL: 	[0.44159026 0.44159026 0.44159026] +- [0.23328466 0.23328466 0.23328466] (mean across ratios: 0.4415902614593506)
(id) val WIOU_PERTURBED: 	[0.29290868 0.29290869 0.29290868] +- [0.07583978 0.07583977 0.07583978] (mean across ratios: 0.2929086814324061)
(id) test WIOU_ORIGINAL: 	[0.26772853 0.26772853 0.26772853] +- [0.026681 0.026681 0.026681] (mean across ratios: 0.26772852540016173)
(id) test WIOU_PERTURBED: 	[0.34353904 0.34353904 0.34353904] +- [0.02459566 0.02459566 0.02459566] (mean across ratios: 0.34353904128074647)
DONE CIGA GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 16:31:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 04:31:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.618
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.600
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.599
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.626
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.607
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.409
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.358
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.355
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.108
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.232
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.250



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.125482
Original XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5204, device='cuda:1')  +-  tensor(0.3105, device='cuda:1') (0.0846465453505516)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.210315
Original XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5204, device='cuda:1')  +-  tensor(0.3105, device='cuda:1') (0.0846465453505516)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.741632
Original XAI WIoU for r=0.9 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5204, device='cuda:1')  +-  tensor(0.3105, device='cuda:1') (0.0846465453505516)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.232455
Original XAI WIoU for r=0.3 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5154, device='cuda:1')  +-  tensor(0.3075, device='cuda:1') (0.08637724816799164)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.403675
Original XAI WIoU for r=0.6 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5154, device='cuda:1')  +-  tensor(0.3075, device='cuda:1') (0.08637724816799164)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.170751
Original XAI WIoU for r=0.9 =  tensor(0.6074, device='cuda:1')  +-  tensor(0.2838, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5154, device='cuda:1')  +-  tensor(0.3075, device='cuda:1') (0.08637724816799164)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.917336
Original XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2359, device='cuda:1')  +-  tensor(0.0839, device='cuda:1') (0.04501895233988762)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.260953
Original XAI WIoU for r=0.6 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2359, device='cuda:1')  +-  tensor(0.0839, device='cuda:1') (0.04501895233988762)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.368929
Original XAI WIoU for r=0.9 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2359, device='cuda:1')  +-  tensor(0.0839, device='cuda:1') (0.04501895233988762)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.715103
Original XAI WIoU for r=0.3 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3802, device='cuda:1')  +-  tensor(0.2163, device='cuda:1') (0.0701722577214241)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.807168
Original XAI WIoU for r=0.6 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3802, device='cuda:1')  +-  tensor(0.2163, device='cuda:1') (0.0701722577214241)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.828617
Original XAI WIoU for r=0.9 =  tensor(0.2552, device='cuda:1')  +-  tensor(0.1239, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3802, device='cuda:1')  +-  tensor(0.2163, device='cuda:1') (0.0701722577214241)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 16:38:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 04:38:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.479
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.512
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.512
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.481
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.509
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.508
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.474
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.341
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.308
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.311



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.662429
Original XAI WIoU for r=0.3 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5422, device='cuda:1')  +-  tensor(0.3035, device='cuda:1') (0.05870094895362854)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.426001
Original XAI WIoU for r=0.6 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5422, device='cuda:1')  +-  tensor(0.3035, device='cuda:1') (0.05870094895362854)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.632760
Original XAI WIoU for r=0.9 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5422, device='cuda:1')  +-  tensor(0.3035, device='cuda:1') (0.0587010495364666)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.678998
Original XAI WIoU for r=0.3 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5384, device='cuda:1')  +-  tensor(0.2990, device='cuda:1') (0.05958055704832077)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.631522
Original XAI WIoU for r=0.6 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5384, device='cuda:1')  +-  tensor(0.2990, device='cuda:1') (0.05958055704832077)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.643947
Original XAI WIoU for r=0.9 =  tensor(0.5080, device='cuda:1')  +-  tensor(0.2588, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5384, device='cuda:1')  +-  tensor(0.2990, device='cuda:1') (0.05958055704832077)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.942742
Original XAI WIoU for r=0.3 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2710, device='cuda:1')  +-  tensor(0.0825, device='cuda:1') (0.05477532744407654)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.713231
Original XAI WIoU for r=0.6 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2710, device='cuda:1')  +-  tensor(0.0825, device='cuda:1') (0.05477532744407654)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.910848
Original XAI WIoU for r=0.9 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2710, device='cuda:1')  +-  tensor(0.0825, device='cuda:1') (0.05477531999349594)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.629463
Original XAI WIoU for r=0.3 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4708, device='cuda:1')  +-  tensor(0.1872, device='cuda:1') (0.09280609339475632)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.747137
Original XAI WIoU for r=0.6 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4708, device='cuda:1')  +-  tensor(0.1872, device='cuda:1') (0.09280609339475632)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.845239
Original XAI WIoU for r=0.9 =  tensor(0.3112, device='cuda:1')  +-  tensor(0.0992, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4708, device='cuda:1')  +-  tensor(0.1872, device='cuda:1') (0.09280609339475632)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 16:45:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 04:45:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.685
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.727
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.691
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.909
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.907
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.906
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.140
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.218
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.231



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.654613
Original XAI WIoU for r=0.3 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5919, device='cuda:1')  +-  tensor(0.2857, device='cuda:1') (0.12280014157295227)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.658275
Original XAI WIoU for r=0.6 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5919, device='cuda:1')  +-  tensor(0.2857, device='cuda:1') (0.12280014157295227)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.638452
Original XAI WIoU for r=0.9 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5919, device='cuda:1')  +-  tensor(0.2857, device='cuda:1') (0.12280014157295227)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.632025
Original XAI WIoU for r=0.3 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5939, device='cuda:1')  +-  tensor(0.2820, device='cuda:1') (0.12402324378490448)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.408985
Original XAI WIoU for r=0.6 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5939, device='cuda:1')  +-  tensor(0.2820, device='cuda:1') (0.12402324378490448)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.637759
Original XAI WIoU for r=0.9 =  tensor(0.7345, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5939, device='cuda:1')  +-  tensor(0.2820, device='cuda:1') (0.12402322143316269)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.696848
Original XAI WIoU for r=0.3 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3181, device='cuda:1')  +-  tensor(0.1073, device='cuda:1') (0.11603860557079315)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.691173
Original XAI WIoU for r=0.6 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3181, device='cuda:1')  +-  tensor(0.1073, device='cuda:1') (0.11603860557079315)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.696507
Original XAI WIoU for r=0.9 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3181, device='cuda:1')  +-  tensor(0.1073, device='cuda:1') (0.11603860557079315)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.863731
Original XAI WIoU for r=0.3 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4351, device='cuda:1')  +-  tensor(0.2656, device='cuda:1') (0.11414150893688202)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.627925
Original XAI WIoU for r=0.6 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4351, device='cuda:1')  +-  tensor(0.2656, device='cuda:1') (0.11414150893688202)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.845523
Original XAI WIoU for r=0.9 =  tensor(0.2292, device='cuda:1')  +-  tensor(0.1194, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4351, device='cuda:1')  +-  tensor(0.2656, device='cuda:1') (0.11414150893688202)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 16:50:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 04:50:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.517
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.510
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.483
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.515
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.507
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.294
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.166
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.292
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.274



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.630705
Original XAI WIoU for r=0.3 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5334, device='cuda:1')  +-  tensor(0.3067, device='cuda:1') (0.06333492696285248)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.634880
Original XAI WIoU for r=0.6 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5334, device='cuda:1')  +-  tensor(0.3067, device='cuda:1') (0.06333492696285248)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.387432
Original XAI WIoU for r=0.9 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5334, device='cuda:1')  +-  tensor(0.3067, device='cuda:1') (0.06333492696285248)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.855009
Original XAI WIoU for r=0.3 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5315, device='cuda:1')  +-  tensor(0.3045, device='cuda:1') (0.06145186722278595)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.621662
Original XAI WIoU for r=0.6 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5315, device='cuda:1')  +-  tensor(0.3045, device='cuda:1') (0.06145186722278595)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.760153
Original XAI WIoU for r=0.9 =  tensor(0.5071, device='cuda:1')  +-  tensor(0.2816, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5315, device='cuda:1')  +-  tensor(0.3045, device='cuda:1') (0.06145186722278595)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.788217
Original XAI WIoU for r=0.3 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0907, device='cuda:1') (0.06016821041703224)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.676912
Original XAI WIoU for r=0.6 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0907, device='cuda:1') (0.060168325901031494)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.670513
Original XAI WIoU for r=0.9 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0907, device='cuda:1') (0.06016812101006508)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.857371
Original XAI WIoU for r=0.3 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4685, device='cuda:1')  +-  tensor(0.2223, device='cuda:1') (0.10128531605005264)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.772027
Original XAI WIoU for r=0.6 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4685, device='cuda:1')  +-  tensor(0.2223, device='cuda:1') (0.10128531605005264)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.851951
Original XAI WIoU for r=0.9 =  tensor(0.2719, device='cuda:1')  +-  tensor(0.1128, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4685, device='cuda:1')  +-  tensor(0.2223, device='cuda:1') (0.10128531605005264)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 16:54:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 04:54:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.366
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.471
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.467
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.461
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.330
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.187
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.274



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.903270
Original XAI WIoU for r=0.3 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3695, device='cuda:1')  +-  tensor(0.2339, device='cuda:1') (0.10776787996292114)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.651073
Original XAI WIoU for r=0.6 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3695, device='cuda:1')  +-  tensor(0.2339, device='cuda:1') (0.10776787996292114)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.895468
Original XAI WIoU for r=0.9 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3695, device='cuda:1')  +-  tensor(0.2339, device='cuda:1') (0.10776787996292114)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.666958
Original XAI WIoU for r=0.3 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3707, device='cuda:1')  +-  tensor(0.2347, device='cuda:1') (0.10459741950035095)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.672317
Original XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3707, device='cuda:1')  +-  tensor(0.2347, device='cuda:1') (0.10459741950035095)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.644273
Original XAI WIoU for r=0.9 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3707, device='cuda:1')  +-  tensor(0.2347, device='cuda:1') (0.10459741950035095)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.720124
Original XAI WIoU for r=0.3 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2150, device='cuda:1')  +-  tensor(0.0680, device='cuda:1') (0.07087045907974243)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.465910
Original XAI WIoU for r=0.6 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2150, device='cuda:1')  +-  tensor(0.0680, device='cuda:1') (0.07087045907974243)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.719650
Original XAI WIoU for r=0.9 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2150, device='cuda:1')  +-  tensor(0.0680, device='cuda:1') (0.07087045907974243)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.653892
Original XAI WIoU for r=0.3 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3317, device='cuda:1')  +-  tensor(0.1390, device='cuda:1') (0.14971879124641418)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.401443
Original XAI WIoU for r=0.6 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3317, device='cuda:1')  +-  tensor(0.1390, device='cuda:1') (0.14971879124641418)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.647658
Original XAI WIoU for r=0.9 =  tensor(0.2711, device='cuda:1')  +-  tensor(0.0772, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3317, device='cuda:1')  +-  tensor(0.1390, device='cuda:1') (0.14971879124641418)
len(reference) = 3000


DONE GOODMotif2 - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.56387447 0.56387447 0.56387447] +- [0.09189798 0.09189798 0.09189798] (mean across ratios: 0.5638744711875916)
(id) id_val WIOU_PERTURBED: 	[0.51149301 0.51149301 0.511493  ] +- [0.07500277 0.07500277 0.07500276] (mean across ratios: 0.5114930053551991)
(id) id_test WIOU_ORIGINAL: 	[0.56484793 0.56484793 0.56484793] +- [0.09662339 0.09662339 0.09662339] (mean across ratios: 0.5648479282855987)
(id) id_test WIOU_PERTURBED: 	[0.50997813 0.50997813 0.50997812] +- [0.07447444 0.07447444 0.07447442] (mean across ratios: 0.5099781235059102)
(id) val WIOU_ORIGINAL: 	[0.44159026 0.44159026 0.44159026] +- [0.23328466 0.23328466 0.23328466] (mean across ratios: 0.4415902614593506)
(id) val WIOU_PERTURBED: 	[0.26216239 0.26216239 0.26216238] +- [0.03518748 0.03518748 0.03518748] (mean across ratios: 0.2621623853842417)
(id) test WIOU_ORIGINAL: 	[0.26772853 0.26772853 0.26772853] +- [0.026681 0.026681 0.026681] (mean across ratios: 0.26772852540016173)
(id) test WIOU_PERTURBED: 	[0.41724112 0.41724112 0.41724112] +- [0.05385432 0.05385432 0.05385432] (mean across ratios: 0.41724112033844)
DONE CIGA GOODMotif2/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:00:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:00:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.574
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.201
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.153
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.592
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.377
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.273



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.015392
Original XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3772, device='cuda:1')  +-  tensor(0.2186, device='cuda:1') (0.006408134941011667)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.731360
Original XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3772, device='cuda:1')  +-  tensor(0.2186, device='cuda:1') (0.006408134941011667)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.081021
Original XAI WIoU for r=0.9 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3772, device='cuda:1')  +-  tensor(0.2186, device='cuda:1') (0.006408134941011667)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.995198
Original XAI WIoU for r=0.3 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3764, device='cuda:1')  +-  tensor(0.2187, device='cuda:1') (0.0062218476086854935)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.187051
Original XAI WIoU for r=0.6 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3764, device='cuda:1')  +-  tensor(0.2187, device='cuda:1') (0.0062218476086854935)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.939652
Original XAI WIoU for r=0.9 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3764, device='cuda:1')  +-  tensor(0.2187, device='cuda:1') (0.0062218476086854935)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.520021
Original XAI WIoU for r=0.3 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1858, device='cuda:1')  +-  tensor(0.0567, device='cuda:1') (0.006582552567124367)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.201033
Original XAI WIoU for r=0.6 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1858, device='cuda:1')  +-  tensor(0.0567, device='cuda:1') (0.006582451984286308)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.954430
Original XAI WIoU for r=0.9 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1858, device='cuda:1')  +-  tensor(0.0567, device='cuda:1') (0.006582451984286308)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.237099
Original XAI WIoU for r=0.3 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2971, device='cuda:1')  +-  tensor(0.1214, device='cuda:1') (0.005456435959786177)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.988034
Original XAI WIoU for r=0.6 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2971, device='cuda:1')  +-  tensor(0.1214, device='cuda:1') (0.005456435959786177)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.165274
Original XAI WIoU for r=0.9 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2971, device='cuda:1')  +-  tensor(0.1214, device='cuda:1') (0.005456435959786177)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:05:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:05:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.547
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.323
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.435
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.242
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.174
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.498
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.332
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.269



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.946133
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3729, device='cuda:1')  +-  tensor(0.2155, device='cuda:1') (0.0053411442786455154)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.134389
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3729, device='cuda:1')  +-  tensor(0.2155, device='cuda:1') (0.0053411442786455154)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.899991
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3729, device='cuda:1')  +-  tensor(0.2155, device='cuda:1') (0.0053411442786455154)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.931664
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3721, device='cuda:1')  +-  tensor(0.2157, device='cuda:1') (0.005448097363114357)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.124863
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3721, device='cuda:1')  +-  tensor(0.2157, device='cuda:1') (0.005448097363114357)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.875789
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3721, device='cuda:1')  +-  tensor(0.2157, device='cuda:1') (0.005448097363114357)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.199878
Original XAI WIoU for r=0.3 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1859, device='cuda:1')  +-  tensor(0.0559, device='cuda:1') (0.005019344389438629)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.030141
Original XAI WIoU for r=0.6 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1859, device='cuda:1')  +-  tensor(0.0559, device='cuda:1') (0.005019344389438629)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.172286
Original XAI WIoU for r=0.9 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1859, device='cuda:1')  +-  tensor(0.0559, device='cuda:1') (0.005019344389438629)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.050857
Original XAI WIoU for r=0.3 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2951, device='cuda:1')  +-  tensor(0.1183, device='cuda:1') (0.0038433296140283346)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.239956
Original XAI WIoU for r=0.6 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2951, device='cuda:1')  +-  tensor(0.1183, device='cuda:1') (0.0038433296140283346)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.023240
Original XAI WIoU for r=0.9 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2951, device='cuda:1')  +-  tensor(0.1183, device='cuda:1') (0.0038433296140283346)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:10:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:10:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.546
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.329
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.369
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.210
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.160
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.589
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.374
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.265



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.931517
Original XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3707, device='cuda:1')  +-  tensor(0.2157, device='cuda:1') (0.005148936063051224)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.016922
Original XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3707, device='cuda:1')  +-  tensor(0.2157, device='cuda:1') (0.005148936063051224)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.188184
Original XAI WIoU for r=0.9 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3707, device='cuda:1')  +-  tensor(0.2157, device='cuda:1') (0.005148936063051224)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.907641
Original XAI WIoU for r=0.3 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3697, device='cuda:1')  +-  tensor(0.2158, device='cuda:1') (0.0050736223347485065)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.907215
Original XAI WIoU for r=0.6 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3697, device='cuda:1')  +-  tensor(0.2158, device='cuda:1') (0.0050736223347485065)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.692654
Original XAI WIoU for r=0.9 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3697, device='cuda:1')  +-  tensor(0.2158, device='cuda:1') (0.0050736223347485065)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.422151
Original XAI WIoU for r=0.3 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1842, device='cuda:1')  +-  tensor(0.0554, device='cuda:1') (0.005181208718568087)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.193397
Original XAI WIoU for r=0.6 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1842, device='cuda:1')  +-  tensor(0.0554, device='cuda:1') (0.005181208718568087)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.213375
Original XAI WIoU for r=0.9 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1842, device='cuda:1')  +-  tensor(0.0554, device='cuda:1') (0.005181208718568087)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.026245
Original XAI WIoU for r=0.3 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2944, device='cuda:1')  +-  tensor(0.1194, device='cuda:1') (0.0033184196799993515)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.945405
Original XAI WIoU for r=0.6 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2944, device='cuda:1')  +-  tensor(0.1194, device='cuda:1') (0.0033184196799993515)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.550931
Original XAI WIoU for r=0.9 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2944, device='cuda:1')  +-  tensor(0.1194, device='cuda:1') (0.0033184196799993515)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:15:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:15:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.328
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.327
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.234
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.171
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.370
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.293
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.244



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.034027
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3707, device='cuda:1')  +-  tensor(0.2139, device='cuda:1') (0.005983154755085707)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.700469
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3707, device='cuda:1')  +-  tensor(0.2139, device='cuda:1') (0.005983154755085707)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.959493
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3707, device='cuda:1')  +-  tensor(0.2139, device='cuda:1') (0.005983154755085707)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.962485
Original XAI WIoU for r=0.3 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3699, device='cuda:1')  +-  tensor(0.2141, device='cuda:1') (0.005865353159606457)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.697740
Original XAI WIoU for r=0.6 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3699, device='cuda:1')  +-  tensor(0.2141, device='cuda:1') (0.005865353159606457)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.909423
Original XAI WIoU for r=0.9 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3699, device='cuda:1')  +-  tensor(0.2141, device='cuda:1') (0.005865353159606457)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.191856
Original XAI WIoU for r=0.3 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1849, device='cuda:1')  +-  tensor(0.0556, device='cuda:1') (0.005843806080520153)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.174497
Original XAI WIoU for r=0.6 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1849, device='cuda:1')  +-  tensor(0.0556, device='cuda:1') (0.005843806080520153)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.240914
Original XAI WIoU for r=0.9 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1849, device='cuda:1')  +-  tensor(0.0556, device='cuda:1') (0.005843806080520153)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.969013
Original XAI WIoU for r=0.3 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2934, device='cuda:1')  +-  tensor(0.1184, device='cuda:1') (0.005337114445865154)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.994989
Original XAI WIoU for r=0.6 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2934, device='cuda:1')  +-  tensor(0.1184, device='cuda:1') (0.00533710140734911)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.005133
Original XAI WIoU for r=0.9 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2934, device='cuda:1')  +-  tensor(0.1184, device='cuda:1') (0.005337114445865154)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:20:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:20:54 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:20:54 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:20:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:20:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:20:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:20:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:20:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:20:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:20:54 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:20:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.338
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.407
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.228
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.165
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.316
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.255



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.242333
Original XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3739, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.005559918470680714)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.152971
Original XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3739, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.005559918470680714)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.566696
Original XAI WIoU for r=0.9 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3739, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.005559918470680714)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.157594
Original XAI WIoU for r=0.3 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3730, device='cuda:1')  +-  tensor(0.2166, device='cuda:1') (0.005414804443717003)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.928891
Original XAI WIoU for r=0.6 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3730, device='cuda:1')  +-  tensor(0.2166, device='cuda:1') (0.005414804443717003)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.024657
Original XAI WIoU for r=0.9 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3730, device='cuda:1')  +-  tensor(0.2166, device='cuda:1') (0.005414804443717003)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.390870
Original XAI WIoU for r=0.3 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1861, device='cuda:1')  +-  tensor(0.0558, device='cuda:1') (0.005176544655114412)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.988256
Original XAI WIoU for r=0.6 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1861, device='cuda:1')  +-  tensor(0.0558, device='cuda:1') (0.005176544655114412)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.644292
Original XAI WIoU for r=0.9 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1861, device='cuda:1')  +-  tensor(0.0558, device='cuda:1') (0.005176544655114412)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.359354
Original XAI WIoU for r=0.3 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2946, device='cuda:1')  +-  tensor(0.1205, device='cuda:1') (0.004361016675829887)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.698853
Original XAI WIoU for r=0.6 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2946, device='cuda:1')  +-  tensor(0.1205, device='cuda:1') (0.004361016675829887)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.153108
Original XAI WIoU for r=0.9 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2946, device='cuda:1')  +-  tensor(0.1205, device='cuda:1') (0.004361016675829887)
len(reference) = 3000


DONE GOODMotif2 - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.32386574 0.3238658  0.32386574] +- [0.00206968 0.00206961 0.00206968] (mean across ratios: 0.3238657573858897)
(id) id_val WIOU_PERTURBED: 	[0.37307301 0.37307301 0.37307301] +- [0.00242307 0.00242307 0.00242307] (mean across ratios: 0.373073011636734)
(id) id_test WIOU_ORIGINAL: 	[0.32323713 0.32323706 0.32323692] +- [0.00206065 0.00206082 0.00206088] (mean across ratios: 0.3232370356718699)
(id) id_test WIOU_PERTURBED: 	[0.37221595 0.37221595 0.37221595] +- [0.00243048 0.00243048 0.00243048] (mean across ratios: 0.37221595048904427)
(id) val WIOU_ORIGINAL: 	[0.1707504 0.1707504 0.1707504] +- [0.00277189 0.00277189 0.00277189] (mean across ratios: 0.1707504004240036)
(id) val WIOU_PERTURBED: 	[0.18539389 0.1853939  0.1853939 ] +- [0.00072497 0.00072498 0.00072498] (mean across ratios: 0.18539389471213022)
(id) test WIOU_ORIGINAL: 	[0.26244532 0.26244532 0.26244532] +- [0.00308772 0.00308772 0.00308772] (mean across ratios: 0.26244532465934756)
(id) test WIOU_PERTURBED: 	[0.29492577 0.29492576 0.29492577] +- [0.00122595 0.00122597 0.00122595] (mean across ratios: 0.29492576320966085)
DONE GSAT GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:26:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:26:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.574
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.201
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.153
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.592
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.377
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.273



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.865512
Original XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4101, device='cuda:1')  +-  tensor(0.2560, device='cuda:1') (0.006500108167529106)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.445528
Original XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4101, device='cuda:1')  +-  tensor(0.2560, device='cuda:1') (0.006500108167529106)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.874453
Original XAI WIoU for r=0.9 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4101, device='cuda:1')  +-  tensor(0.2560, device='cuda:1') (0.006500108167529106)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.586932
Original XAI WIoU for r=0.3 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4090, device='cuda:1')  +-  tensor(0.2564, device='cuda:1') (0.006348327733576298)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.937382
Original XAI WIoU for r=0.6 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4090, device='cuda:1')  +-  tensor(0.2564, device='cuda:1') (0.006348327733576298)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.163984
Original XAI WIoU for r=0.9 =  tensor(0.3270, device='cuda:1')  +-  tensor(0.1670, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4090, device='cuda:1')  +-  tensor(0.2564, device='cuda:1') (0.006348327733576298)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.478414
Original XAI WIoU for r=0.3 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2053, device='cuda:1')  +-  tensor(0.0717, device='cuda:1') (0.007969412952661514)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.964015
Original XAI WIoU for r=0.6 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2053, device='cuda:1')  +-  tensor(0.0717, device='cuda:1') (0.007969412952661514)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.164337
Original XAI WIoU for r=0.9 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2053, device='cuda:1')  +-  tensor(0.0717, device='cuda:1') (0.007969412952661514)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.600545
Original XAI WIoU for r=0.3 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3392, device='cuda:1')  +-  tensor(0.1533, device='cuda:1') (0.006667877081781626)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.045903
Original XAI WIoU for r=0.6 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3392, device='cuda:1')  +-  tensor(0.1533, device='cuda:1') (0.006667856592684984)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.336329
Original XAI WIoU for r=0.9 =  tensor(0.2671, device='cuda:1')  +-  tensor(0.1011, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3392, device='cuda:1')  +-  tensor(0.1533, device='cuda:1') (0.006667781621217728)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:33:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:33:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.547
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.435
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.242
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.174
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.498
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.332
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.269



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.597338
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4064, device='cuda:1')  +-  tensor(0.2546, device='cuda:1') (0.005615974310785532)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.815588
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4064, device='cuda:1')  +-  tensor(0.2546, device='cuda:1') (0.005615974310785532)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.904809
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4064, device='cuda:1')  +-  tensor(0.2546, device='cuda:1') (0.005616096314042807)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.668333
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4055, device='cuda:1')  +-  tensor(0.2551, device='cuda:1') (0.005663130432367325)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.070504
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4055, device='cuda:1')  +-  tensor(0.2551, device='cuda:1') (0.005663130432367325)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.234005
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.1639, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4055, device='cuda:1')  +-  tensor(0.2551, device='cuda:1') (0.005663130432367325)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.305163
Original XAI WIoU for r=0.3 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2045, device='cuda:1')  +-  tensor(0.0701, device='cuda:1') (0.006435378920286894)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.835335
Original XAI WIoU for r=0.6 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2045, device='cuda:1')  +-  tensor(0.0701, device='cuda:1') (0.006435378920286894)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.032346
Original XAI WIoU for r=0.9 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2045, device='cuda:1')  +-  tensor(0.0701, device='cuda:1') (0.006435378920286894)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.178645
Original XAI WIoU for r=0.3 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3356, device='cuda:1')  +-  tensor(0.1490, device='cuda:1') (0.005584392696619034)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.060129
Original XAI WIoU for r=0.6 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3356, device='cuda:1')  +-  tensor(0.1490, device='cuda:1') (0.0055843135342001915)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.222426
Original XAI WIoU for r=0.9 =  tensor(0.2627, device='cuda:1')  +-  tensor(0.0951, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3356, device='cuda:1')  +-  tensor(0.1490, device='cuda:1') (0.005584392696619034)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:39:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:39:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.546
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.329
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.369
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.210
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.160
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.589
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.374
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.265



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.108716
Original XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4038, device='cuda:1')  +-  tensor(0.2543, device='cuda:1') (0.00529827643185854)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.192004
Original XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4038, device='cuda:1')  +-  tensor(0.2543, device='cuda:1') (0.00529827643185854)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.359309
Original XAI WIoU for r=0.9 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4038, device='cuda:1')  +-  tensor(0.2543, device='cuda:1') (0.00529827643185854)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.393636
Original XAI WIoU for r=0.3 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4027, device='cuda:1')  +-  tensor(0.2547, device='cuda:1') (0.0051760184578597546)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.210501
Original XAI WIoU for r=0.6 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4027, device='cuda:1')  +-  tensor(0.2547, device='cuda:1') (0.0051760184578597546)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.332679
Original XAI WIoU for r=0.9 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4027, device='cuda:1')  +-  tensor(0.2547, device='cuda:1') (0.0051760184578597546)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.565866
Original XAI WIoU for r=0.3 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2028, device='cuda:1')  +-  tensor(0.0698, device='cuda:1') (0.006160662043839693)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.156170
Original XAI WIoU for r=0.6 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2028, device='cuda:1')  +-  tensor(0.0698, device='cuda:1') (0.006160662043839693)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.232032
Original XAI WIoU for r=0.9 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2028, device='cuda:1')  +-  tensor(0.0698, device='cuda:1') (0.006160662043839693)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.941554
Original XAI WIoU for r=0.3 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3332, device='cuda:1')  +-  tensor(0.1483, device='cuda:1') (0.004872472491115332)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.844133
Original XAI WIoU for r=0.6 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3332, device='cuda:1')  +-  tensor(0.1483, device='cuda:1') (0.004872472491115332)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.010897
Original XAI WIoU for r=0.9 =  tensor(0.2643, device='cuda:1')  +-  tensor(0.0990, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3332, device='cuda:1')  +-  tensor(0.1483, device='cuda:1') (0.004872472491115332)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:46:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:46:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.328
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.327
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.234
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.171
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.370
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.293
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.244



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.888508
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2533, device='cuda:1') (0.006454927381128073)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.886089
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2533, device='cuda:1') (0.006454927381128073)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.234423
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2533, device='cuda:1') (0.006454927381128073)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.877452
Original XAI WIoU for r=0.3 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4028, device='cuda:1')  +-  tensor(0.2538, device='cuda:1') (0.006392926909029484)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.899283
Original XAI WIoU for r=0.6 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4028, device='cuda:1')  +-  tensor(0.2538, device='cuda:1') (0.006392926909029484)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.872211
Original XAI WIoU for r=0.9 =  tensor(0.3222, device='cuda:1')  +-  tensor(0.1627, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4028, device='cuda:1')  +-  tensor(0.2538, device='cuda:1') (0.006392926909029484)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.109585
Original XAI WIoU for r=0.3 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2039, device='cuda:1')  +-  tensor(0.0702, device='cuda:1') (0.0069379438646137714)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.086053
Original XAI WIoU for r=0.6 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2039, device='cuda:1')  +-  tensor(0.0702, device='cuda:1') (0.0069379438646137714)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.856972
Original XAI WIoU for r=0.9 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2039, device='cuda:1')  +-  tensor(0.0702, device='cuda:1') (0.0069379438646137714)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.100317
Original XAI WIoU for r=0.3 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3335, device='cuda:1')  +-  tensor(0.1490, device='cuda:1') (0.006449088919907808)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.852702
Original XAI WIoU for r=0.6 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3335, device='cuda:1')  +-  tensor(0.1490, device='cuda:1') (0.006449088919907808)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.095772
Original XAI WIoU for r=0.9 =  tensor(0.2591, device='cuda:1')  +-  tensor(0.0941, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3335, device='cuda:1')  +-  tensor(0.1490, device='cuda:1') (0.006449088919907808)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:51:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/05/2024 05:51:03 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:51:03 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:51:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:51:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:51:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:51:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:51:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:51:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 05:51:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.338
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.337
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.407
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.228
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.165
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.462
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.316
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.255



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.958322
Original XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4069, device='cuda:1')  +-  tensor(0.2549, device='cuda:1') (0.005726720206439495)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.903187
Original XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4069, device='cuda:1')  +-  tensor(0.2549, device='cuda:1') (0.005726827774196863)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.908649
Original XAI WIoU for r=0.9 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4069, device='cuda:1')  +-  tensor(0.2549, device='cuda:1') (0.005726827774196863)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.173890
Original XAI WIoU for r=0.3 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4059, device='cuda:1')  +-  tensor(0.2553, device='cuda:1') (0.005705308169126511)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.924830
Original XAI WIoU for r=0.6 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4059, device='cuda:1')  +-  tensor(0.2553, device='cuda:1') (0.005705183371901512)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.290158
Original XAI WIoU for r=0.9 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.1643, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4059, device='cuda:1')  +-  tensor(0.2553, device='cuda:1') (0.005705183371901512)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.121807
Original XAI WIoU for r=0.3 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2045, device='cuda:1')  +-  tensor(0.0702, device='cuda:1') (0.006495148409157991)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.135715
Original XAI WIoU for r=0.6 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2045, device='cuda:1')  +-  tensor(0.0702, device='cuda:1') (0.006495216395705938)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.095430
Original XAI WIoU for r=0.9 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2045, device='cuda:1')  +-  tensor(0.0702, device='cuda:1') (0.006495216395705938)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.881312
Original XAI WIoU for r=0.3 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3345, device='cuda:1')  +-  tensor(0.1504, device='cuda:1') (0.005713658407330513)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.905386
Original XAI WIoU for r=0.6 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3345, device='cuda:1')  +-  tensor(0.1504, device='cuda:1') (0.005713658407330513)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.950911
Original XAI WIoU for r=0.9 =  tensor(0.2590, device='cuda:1')  +-  tensor(0.0947, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3345, device='cuda:1')  +-  tensor(0.1504, device='cuda:1') (0.005713658407330513)
len(reference) = 3000


DONE GOODMotif2 - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.32386587 0.32386567 0.32386567] +- [0.00206954 0.00206975 0.00206975] (mean across ratios: 0.32386573553085324)
(id) id_val WIOU_PERTURBED: 	[0.40617546 0.40617548 0.40617546] +- [0.00236322 0.00236322 0.00236322] (mean across ratios: 0.4061754703521729)
(id) id_test WIOU_ORIGINAL: 	[0.32323726 0.32323706 0.32323733] +- [0.00206079 0.00206102 0.00206072] (mean across ratios: 0.32323721845944725)
(id) id_test WIOU_PERTURBED: 	[0.40516438 0.4051644  0.4051644 ] +- [0.00230537 0.00230537 0.00230537] (mean across ratios: 0.4051643908023834)
(id) val WIOU_ORIGINAL: 	[0.17075033 0.17075033 0.17075033] +- [0.00277182 0.00277182 0.00277182] (mean across ratios: 0.17075033187866215)
(id) val WIOU_PERTURBED: 	[0.20419655 0.20419654 0.20419654] +- [0.0008324  0.00083239 0.00083239] (mean across ratios: 0.2041965405146281)
(id) test WIOU_ORIGINAL: 	[0.26244532 0.26244532 0.26244532] +- [0.00308772 0.00308772 0.00308772] (mean across ratios: 0.26244532465934756)
(id) test WIOU_PERTURBED: 	[0.33520658 0.33520659 0.33520657] +- [0.00217591 0.00217592 0.00217589] (mean across ratios: 0.33520658016204835)
DONE GSAT GOODMotif2/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 17:56:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:23 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:36 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:38 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:40 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:42 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 05:56:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.765
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.671
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.764
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.775
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.892
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.267
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.403
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.448



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.981976
Original XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6067, device='cuda:1')  +-  tensor(0.2611, device='cuda:1') (0.09666911512613297)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.703309
Original XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6067, device='cuda:1')  +-  tensor(0.2611, device='cuda:1') (0.09666911512613297)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.006023
Original XAI WIoU for r=0.9 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6067, device='cuda:1')  +-  tensor(0.2611, device='cuda:1') (0.09666911512613297)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.083404
Original XAI WIoU for r=0.3 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6185, device='cuda:1')  +-  tensor(0.2612, device='cuda:1') (0.09841504693031311)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.909943
Original XAI WIoU for r=0.6 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6185, device='cuda:1')  +-  tensor(0.2612, device='cuda:1') (0.09841504693031311)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.663656
Original XAI WIoU for r=0.9 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6185, device='cuda:1')  +-  tensor(0.2612, device='cuda:1') (0.09841504693031311)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.085558
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.829157
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.027749
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.857529
Original XAI WIoU for r=0.3 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5128, device='cuda:1')  +-  tensor(0.1435, device='cuda:1') (0.07151094824075699)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.826114
Original XAI WIoU for r=0.6 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5128, device='cuda:1')  +-  tensor(0.1435, device='cuda:1') (0.07151105254888535)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.779826
Original XAI WIoU for r=0.9 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5128, device='cuda:1')  +-  tensor(0.1435, device='cuda:1') (0.07151105254888535)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:01:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:17 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:31 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:35 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:01:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.750
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.641
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.755
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.760
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.284
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.472



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.966623
Original XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6177, device='cuda:1')  +-  tensor(0.2728, device='cuda:1') (0.11023050546646118)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.131784
Original XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6177, device='cuda:1')  +-  tensor(0.2728, device='cuda:1') (0.11023050546646118)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.944722
Original XAI WIoU for r=0.9 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6177, device='cuda:1')  +-  tensor(0.2728, device='cuda:1') (0.11023050546646118)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.911191
Original XAI WIoU for r=0.3 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6295, device='cuda:1')  +-  tensor(0.2695, device='cuda:1') (0.10930100083351135)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.106843
Original XAI WIoU for r=0.6 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6295, device='cuda:1')  +-  tensor(0.2695, device='cuda:1') (0.10930100083351135)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.866277
Original XAI WIoU for r=0.9 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6295, device='cuda:1')  +-  tensor(0.2695, device='cuda:1') (0.10930100083351135)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.840166
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.892285
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.875377
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.877887
Original XAI WIoU for r=0.3 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5220, device='cuda:1')  +-  tensor(0.1626, device='cuda:1') (0.07674439251422882)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.908360
Original XAI WIoU for r=0.6 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5220, device='cuda:1')  +-  tensor(0.1626, device='cuda:1') (0.07674439251422882)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.150921
Original XAI WIoU for r=0.9 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5220, device='cuda:1')  +-  tensor(0.1626, device='cuda:1') (0.07674439251422882)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:06:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:12 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:25 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:29 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:31 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:06:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.789
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.789
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.719
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.797
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.798
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.884
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.582
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.608



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.256614
Original XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6366, device='cuda:1')  +-  tensor(0.2716, device='cuda:1') (0.09341750293970108)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.012112
Original XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6366, device='cuda:1')  +-  tensor(0.2716, device='cuda:1') (0.09341750293970108)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.211675
Original XAI WIoU for r=0.9 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6366, device='cuda:1')  +-  tensor(0.2716, device='cuda:1') (0.09341750293970108)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.021573
Original XAI WIoU for r=0.3 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6486, device='cuda:1')  +-  tensor(0.2720, device='cuda:1') (0.09161165356636047)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.818108
Original XAI WIoU for r=0.6 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6486, device='cuda:1')  +-  tensor(0.2720, device='cuda:1') (0.09161165356636047)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.999633
Original XAI WIoU for r=0.9 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6486, device='cuda:1')  +-  tensor(0.2720, device='cuda:1') (0.09161165356636047)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.045579
Original XAI WIoU for r=0.3 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9941, device='cuda:1')  +-  tensor(0.0454, device='cuda:1') (0.0017062530387192965)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.862649
Original XAI WIoU for r=0.6 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9941, device='cuda:1')  +-  tensor(0.0454, device='cuda:1') (0.0017062530387192965)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.904925
Original XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9941, device='cuda:1')  +-  tensor(0.0454, device='cuda:1') (0.0017062530387192965)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.877118
Original XAI WIoU for r=0.3 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7608, device='cuda:1')  +-  tensor(0.1934, device='cuda:1') (0.11210428923368454)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.100999
Original XAI WIoU for r=0.6 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7608, device='cuda:1')  +-  tensor(0.1934, device='cuda:1') (0.11210428923368454)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.870408
Original XAI WIoU for r=0.9 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7608, device='cuda:1')  +-  tensor(0.1934, device='cuda:1') (0.11210428923368454)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:11:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:33 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:35 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:37 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:11:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.830
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.824
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.738
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.835
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.830
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.888
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.980
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.410
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.548
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.512



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.015999
Original XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6383, device='cuda:1')  +-  tensor(0.2481, device='cuda:1') (0.1258159577846527)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.978742
Original XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6383, device='cuda:1')  +-  tensor(0.2481, device='cuda:1') (0.1258159577846527)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.985499
Original XAI WIoU for r=0.9 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6383, device='cuda:1')  +-  tensor(0.2481, device='cuda:1') (0.1258159577846527)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.961386
Original XAI WIoU for r=0.3 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6501, device='cuda:1')  +-  tensor(0.2474, device='cuda:1') (0.12661364674568176)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.976597
Original XAI WIoU for r=0.6 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6501, device='cuda:1')  +-  tensor(0.2474, device='cuda:1') (0.12661364674568176)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.209994
Original XAI WIoU for r=0.9 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6501, device='cuda:1')  +-  tensor(0.2474, device='cuda:1') (0.12661364674568176)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.896810
Original XAI WIoU for r=0.3 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9818, device='cuda:1')  +-  tensor(0.0481, device='cuda:1') (0.00437130406498909)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.890031
Original XAI WIoU for r=0.6 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9818, device='cuda:1')  +-  tensor(0.0481, device='cuda:1') (0.00437130406498909)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.873196
Original XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9818, device='cuda:1')  +-  tensor(0.0481, device='cuda:1') (0.00437130406498909)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.872907
Original XAI WIoU for r=0.3 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5340, device='cuda:1')  +-  tensor(0.1514, device='cuda:1') (0.07868479192256927)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.868904
Original XAI WIoU for r=0.6 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5340, device='cuda:1')  +-  tensor(0.1514, device='cuda:1') (0.07868479192256927)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.124535
Original XAI WIoU for r=0.9 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5340, device='cuda:1')  +-  tensor(0.1514, device='cuda:1') (0.07868479192256927)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:16:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:29 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:46 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:16:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.802
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.800
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.812
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.810
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.414
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.511
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.368492
Original XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6368, device='cuda:1')  +-  tensor(0.2529, device='cuda:1') (0.1120976060628891)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.996306
Original XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6368, device='cuda:1')  +-  tensor(0.2529, device='cuda:1') (0.11209747195243835)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.291498
Original XAI WIoU for r=0.9 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6368, device='cuda:1')  +-  tensor(0.2529, device='cuda:1') (0.11209741979837418)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.983243
Original XAI WIoU for r=0.3 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6456, device='cuda:1')  +-  tensor(0.2502, device='cuda:1') (0.11176399886608124)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.983860
Original XAI WIoU for r=0.6 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6456, device='cuda:1')  +-  tensor(0.2502, device='cuda:1') (0.11176399886608124)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.992785
Original XAI WIoU for r=0.9 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6456, device='cuda:1')  +-  tensor(0.2502, device='cuda:1') (0.11176399886608124)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.126753
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0024, device='cuda:1') (6.618858606088907e-05)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.874214
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0024, device='cuda:1') (6.618858606088907e-05)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.904512
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0024, device='cuda:1') (6.618858606088907e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.933686
Original XAI WIoU for r=0.3 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5598, device='cuda:1')  +-  tensor(0.1553, device='cuda:1') (0.08102326095104218)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.907841
Original XAI WIoU for r=0.6 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5598, device='cuda:1')  +-  tensor(0.1553, device='cuda:1') (0.08102326095104218)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.174744
Original XAI WIoU for r=0.9 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5598, device='cuda:1')  +-  tensor(0.1553, device='cuda:1') (0.08102326095104218)
len(reference) = 3000


DONE GOODMotif - LECIGIN
(id) id_val WIOU_ORIGINAL: 	[0.78548733 0.78548733 0.78548733] +- [0.02587127 0.02587127 0.02587127] (mean across ratios: 0.7854873299598694)
(id) id_val WIOU_PERTURBED: 	[0.62722178 0.62722175 0.62722174] +- [0.01273517 0.01273515 0.01273514] (mean across ratios: 0.6272217551867167)
(id) id_test WIOU_ORIGINAL: 	[0.79421998 0.79421998 0.79421998] +- [0.02474969 0.02474969 0.02474969] (mean across ratios: 0.7942199826240538)
(id) id_test WIOU_PERTURBED: 	[0.63846526 0.63846526 0.63846526] +- [0.01239416 0.01239416 0.01239416] (mean across ratios: 0.6384652614593506)
(id) val WIOU_ORIGINAL: 	[0.99601128 0.99601128 0.99601128] +- [0.00793648 0.00793648 0.00793648] (mean across ratios: 0.9960112810134888)
(id) val WIOU_PERTURBED: 	[0.99513828 0.99513828 0.99513828] +- [0.00703681 0.00703681 0.00703681] (mean across ratios: 0.9951382756233217)
(id) test WIOU_ORIGINAL: 	[0.50390708 0.50390708 0.50390708] +- [0.05632264 0.05632264 0.05632264] (mean across ratios: 0.5039070844650269)
(id) test WIOU_PERTURBED: 	[0.57787222 0.57787223 0.57787223] +- [0.09280161 0.0928016  0.0928016 ] (mean across ratios: 0.5778722246487935)
DONE LECI GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:22:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:11 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:24 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:29 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:30 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:22:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.765
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.671
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.764
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.775
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.892
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.267
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.403
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.448



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.226864
Original XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5873, device='cuda:1')  +-  tensor(0.2688, device='cuda:1') (0.09979450702667236)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.251121
Original XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5873, device='cuda:1')  +-  tensor(0.2688, device='cuda:1') (0.09979450702667236)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.989577
Original XAI WIoU for r=0.9 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5873, device='cuda:1')  +-  tensor(0.2688, device='cuda:1') (0.09979450702667236)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.054376
Original XAI WIoU for r=0.3 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5990, device='cuda:1')  +-  tensor(0.2687, device='cuda:1') (0.10296010971069336)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.992584
Original XAI WIoU for r=0.6 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5990, device='cuda:1')  +-  tensor(0.2687, device='cuda:1') (0.10296010971069336)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.990734
Original XAI WIoU for r=0.9 =  tensor(0.7749, device='cuda:1')  +-  tensor(0.2595, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5990, device='cuda:1')  +-  tensor(0.2687, device='cuda:1') (0.10296010971069336)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.951963
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.921052
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.131682
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.040231
Original XAI WIoU for r=0.3 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5669, device='cuda:1')  +-  tensor(0.1466, device='cuda:1') (0.099809430539608)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.981457
Original XAI WIoU for r=0.6 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5669, device='cuda:1')  +-  tensor(0.1466, device='cuda:1') (0.099809430539608)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.874164
Original XAI WIoU for r=0.9 =  tensor(0.4462, device='cuda:1')  +-  tensor(0.1373, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5669, device='cuda:1')  +-  tensor(0.1466, device='cuda:1') (0.099809430539608)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:27:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:26 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:39 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:43 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:27:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.750
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.641
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.755
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.760
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.284
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.472



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.020110
Original XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5964, device='cuda:1')  +-  tensor(0.2786, device='cuda:1') (0.1152258887887001)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.983753
Original XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5964, device='cuda:1')  +-  tensor(0.2786, device='cuda:1') (0.11522580683231354)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.004901
Original XAI WIoU for r=0.9 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5964, device='cuda:1')  +-  tensor(0.2786, device='cuda:1') (0.1152258887887001)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.023576
Original XAI WIoU for r=0.3 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6063, device='cuda:1')  +-  tensor(0.2772, device='cuda:1') (0.11427171528339386)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.788674
Original XAI WIoU for r=0.6 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6063, device='cuda:1')  +-  tensor(0.2772, device='cuda:1') (0.11427171528339386)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.125566
Original XAI WIoU for r=0.9 =  tensor(0.7596, device='cuda:1')  +-  tensor(0.2519, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6063, device='cuda:1')  +-  tensor(0.2772, device='cuda:1') (0.11427171528339386)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.918308
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.121611
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.891809
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.915711
Original XAI WIoU for r=0.3 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.1849, device='cuda:1') (0.10611848533153534)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.639271
Original XAI WIoU for r=0.6 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.1849, device='cuda:1') (0.10611848533153534)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.887172
Original XAI WIoU for r=0.9 =  tensor(0.4650, device='cuda:1')  +-  tensor(0.1601, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.1849, device='cuda:1') (0.10611848533153534)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:32:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:32:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:32:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:32:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:32:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:32:58 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:33:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.789
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.789
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.719
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.797
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.798
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.884
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.582
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.608



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.983870
Original XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6085, device='cuda:1')  +-  tensor(0.2913, device='cuda:1') (0.07693131268024445)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.066096
Original XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6085, device='cuda:1')  +-  tensor(0.2913, device='cuda:1') (0.07693137228488922)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.942036
Original XAI WIoU for r=0.9 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6085, device='cuda:1')  +-  tensor(0.2913, device='cuda:1') (0.07693137228488922)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.217192
Original XAI WIoU for r=0.3 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6184, device='cuda:1')  +-  tensor(0.2935, device='cuda:1') (0.07567456364631653)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.953570
Original XAI WIoU for r=0.6 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6184, device='cuda:1')  +-  tensor(0.2935, device='cuda:1') (0.07567456364631653)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.206713
Original XAI WIoU for r=0.9 =  tensor(0.7976, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6184, device='cuda:1')  +-  tensor(0.2935, device='cuda:1') (0.07567456364631653)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.894714
Original XAI WIoU for r=0.3 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9923, device='cuda:1')  +-  tensor(0.0449, device='cuda:1') (0.0047798603773117065)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.912803
Original XAI WIoU for r=0.6 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9923, device='cuda:1')  +-  tensor(0.0449, device='cuda:1') (0.0047798603773117065)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.982192
Original XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9923, device='cuda:1')  +-  tensor(0.0449, device='cuda:1') (0.0047798603773117065)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.884274
Original XAI WIoU for r=0.3 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8592, device='cuda:1')  +-  tensor(0.1519, device='cuda:1') (0.10402284562587738)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.862171
Original XAI WIoU for r=0.6 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.8592, device='cuda:1')  +-  tensor(0.1519, device='cuda:1') (0.10402284562587738)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.886795
Original XAI WIoU for r=0.9 =  tensor(0.6084, device='cuda:1')  +-  tensor(0.2294, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.8592, device='cuda:1')  +-  tensor(0.1519, device='cuda:1') (0.10402284562587738)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:37:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:37:54 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:12 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:38:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.830
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.824
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.738
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.835
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.830
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.888
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.980
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.410
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.548
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.512



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.984332
Original XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5962, device='cuda:1')  +-  tensor(0.2425, device='cuda:1') (0.12973876297473907)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.054119
Original XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5962, device='cuda:1')  +-  tensor(0.2425, device='cuda:1') (0.12973876297473907)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.056743
Original XAI WIoU for r=0.9 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5962, device='cuda:1')  +-  tensor(0.2425, device='cuda:1') (0.12973876297473907)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.334298
Original XAI WIoU for r=0.3 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6050, device='cuda:1')  +-  tensor(0.2442, device='cuda:1') (0.1285545378923416)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.970953
Original XAI WIoU for r=0.6 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6050, device='cuda:1')  +-  tensor(0.2442, device='cuda:1') (0.1285545378923416)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.340358
Original XAI WIoU for r=0.9 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2295, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6050, device='cuda:1')  +-  tensor(0.2442, device='cuda:1') (0.1285545378923416)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.896357
Original XAI WIoU for r=0.3 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9833, device='cuda:1')  +-  tensor(0.0442, device='cuda:1') (0.006825560703873634)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.014339
Original XAI WIoU for r=0.6 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9833, device='cuda:1')  +-  tensor(0.0442, device='cuda:1') (0.006825560703873634)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.959108
Original XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9833, device='cuda:1')  +-  tensor(0.0442, device='cuda:1') (0.006825560703873634)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.874969
Original XAI WIoU for r=0.3 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5622, device='cuda:1')  +-  tensor(0.1510, device='cuda:1') (0.1033530905842781)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.885534
Original XAI WIoU for r=0.6 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5622, device='cuda:1')  +-  tensor(0.1510, device='cuda:1') (0.1033530905842781)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.867977
Original XAI WIoU for r=0.9 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1820, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5622, device='cuda:1')  +-  tensor(0.1510, device='cuda:1') (0.1033530905842781)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:43:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:20 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:22 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:24 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:43:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.802
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.800
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.812
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.810
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.414
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.511
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.096074
Original XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6126, device='cuda:1')  +-  tensor(0.2647, device='cuda:1') (0.10982377082109451)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.868061
Original XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6126, device='cuda:1')  +-  tensor(0.2647, device='cuda:1') (0.10982377082109451)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.996981
Original XAI WIoU for r=0.9 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6126, device='cuda:1')  +-  tensor(0.2647, device='cuda:1') (0.10982377082109451)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.992552
Original XAI WIoU for r=0.3 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6223, device='cuda:1')  +-  tensor(0.2627, device='cuda:1') (0.10936491936445236)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.798200
Original XAI WIoU for r=0.6 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6223, device='cuda:1')  +-  tensor(0.2627, device='cuda:1') (0.10936491936445236)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.959089
Original XAI WIoU for r=0.9 =  tensor(0.8094, device='cuda:1')  +-  tensor(0.2412, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6223, device='cuda:1')  +-  tensor(0.2627, device='cuda:1') (0.10936491936445236)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.918166
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0018, device='cuda:1') (0.00010804185149027035)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.896752
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0018, device='cuda:1') (0.00010804185149027035)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.977216
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0018, device='cuda:1') (0.00010804185149027035)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.882216
Original XAI WIoU for r=0.3 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6218, device='cuda:1')  +-  tensor(0.1625, device='cuda:1') (0.1032026931643486)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.866407
Original XAI WIoU for r=0.6 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6218, device='cuda:1')  +-  tensor(0.1625, device='cuda:1') (0.1032026931643486)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.866714
Original XAI WIoU for r=0.9 =  tensor(0.4941, device='cuda:1')  +-  tensor(0.1570, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6218, device='cuda:1')  +-  tensor(0.1625, device='cuda:1') (0.1032026931643486)
len(reference) = 3000


DONE GOODMotif - LECIGIN
(id) id_val WIOU_ORIGINAL: 	[0.78548733 0.78548733 0.78548733] +- [0.02587127 0.02587127 0.02587127] (mean across ratios: 0.7854873299598694)
(id) id_val WIOU_PERTURBED: 	[0.60020878 0.60020882 0.60020881] +- [0.00915549 0.00915551 0.00915551] (mean across ratios: 0.6002088030179341)
(id) id_test WIOU_ORIGINAL: 	[0.79421998 0.79421998 0.79421998] +- [0.02474969 0.02474969 0.02474969] (mean across ratios: 0.7942199826240538)
(id) id_test WIOU_PERTURBED: 	[0.61020479 0.61020479 0.61020479] +- [0.00871574 0.00871574 0.00871574] (mean across ratios: 0.6102047920227051)
(id) val WIOU_ORIGINAL: 	[0.99601128 0.99601128 0.99601128] +- [0.00793648 0.00793648 0.00793648] (mean across ratios: 0.9960112810134888)
(id) val WIOU_PERTURBED: 	[0.99509605 0.99509605 0.99509605] +- [0.00658288 0.00658288 0.00658288] (mean across ratios: 0.9950960516929627)
(id) test WIOU_ORIGINAL: 	[0.50390714 0.50390714 0.50390708] +- [0.05632275 0.05632275 0.05632264] (mean across ratios: 0.5039071242014567)
(id) test WIOU_PERTURBED: 	[0.64018255 0.64018255 0.64018255] +- [0.11154371 0.11154371 0.11154371] (mean across ratios: 0.6401825547218323)
DONE LECI GOODMotif/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:48:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:48:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:01 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:03 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:05 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 06:49:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.690
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.738
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.707
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.752
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.754
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.896
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.356
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.427



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.932894
Original XAI WIoU for r=0.3 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5827, device='cuda:1')  +-  tensor(0.2775, device='cuda:1') (0.11598470062017441)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.724028
Original XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5827, device='cuda:1')  +-  tensor(0.2775, device='cuda:1') (0.11598470062017441)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.676476
Original XAI WIoU for r=0.9 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5827, device='cuda:1')  +-  tensor(0.2775, device='cuda:1') (0.11598470062017441)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.988145
Original XAI WIoU for r=0.3 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5935, device='cuda:1')  +-  tensor(0.2729, device='cuda:1') (0.11712395399808884)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.716636
Original XAI WIoU for r=0.6 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5935, device='cuda:1')  +-  tensor(0.2729, device='cuda:1') (0.11712395399808884)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.996679
Original XAI WIoU for r=0.9 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5935, device='cuda:1')  +-  tensor(0.2729, device='cuda:1') (0.11712395399808884)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.026569
Original XAI WIoU for r=0.3 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9992, device='cuda:1')  +-  tensor(0.0080, device='cuda:1') (0.000173883032402955)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.696446
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9992, device='cuda:1')  +-  tensor(0.0080, device='cuda:1') (0.000173883032402955)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.710756
Original XAI WIoU for r=0.9 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9992, device='cuda:1')  +-  tensor(0.0080, device='cuda:1') (0.000173883032402955)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.945114
Original XAI WIoU for r=0.3 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5383, device='cuda:1')  +-  tensor(0.2038, device='cuda:1') (0.08222635090351105)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.698983
Original XAI WIoU for r=0.6 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5383, device='cuda:1')  +-  tensor(0.2038, device='cuda:1') (0.08222635090351105)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.431935
Original XAI WIoU for r=0.9 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5383, device='cuda:1')  +-  tensor(0.2038, device='cuda:1') (0.08222635090351105)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:54:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:00 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:17 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:19 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 06:54:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.643
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.696
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.657
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.709
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.713
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.896
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.156
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.400
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.709909
Original XAI WIoU for r=0.3 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6124, device='cuda:1')  +-  tensor(0.2788, device='cuda:1') (0.10401896387338638)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.692820
Original XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6124, device='cuda:1')  +-  tensor(0.2788, device='cuda:1') (0.1040189191699028)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.672512
Original XAI WIoU for r=0.9 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6124, device='cuda:1')  +-  tensor(0.2788, device='cuda:1') (0.1040189191699028)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.702349
Original XAI WIoU for r=0.3 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6269, device='cuda:1')  +-  tensor(0.2726, device='cuda:1') (0.1012253686785698)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.689088
Original XAI WIoU for r=0.6 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6269, device='cuda:1')  +-  tensor(0.2726, device='cuda:1') (0.1012253686785698)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.680928
Original XAI WIoU for r=0.9 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6269, device='cuda:1')  +-  tensor(0.2726, device='cuda:1') (0.10122539848089218)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.914624
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.658345
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.672527
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.655362
Original XAI WIoU for r=0.3 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6168, device='cuda:1')  +-  tensor(0.2188, device='cuda:1') (0.10292831063270569)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.665123
Original XAI WIoU for r=0.6 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6168, device='cuda:1')  +-  tensor(0.2188, device='cuda:1') (0.10292831063270569)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.636949
Original XAI WIoU for r=0.9 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6168, device='cuda:1')  +-  tensor(0.2188, device='cuda:1') (0.10292831063270569)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 18:59:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:10 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:23 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:25 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:27 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 06:59:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.545
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.562
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.572
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.559
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.573
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.583
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.790
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.422
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.908881
Original XAI WIoU for r=0.3 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5476, device='cuda:1')  +-  tensor(0.2802, device='cuda:1') (0.06974150240421295)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.676630
Original XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5476, device='cuda:1')  +-  tensor(0.2802, device='cuda:1') (0.06974150240421295)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.682081
Original XAI WIoU for r=0.9 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5476, device='cuda:1')  +-  tensor(0.2802, device='cuda:1') (0.06974150240421295)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.665403
Original XAI WIoU for r=0.3 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5591, device='cuda:1')  +-  tensor(0.2814, device='cuda:1') (0.06928378343582153)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.667778
Original XAI WIoU for r=0.6 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5591, device='cuda:1')  +-  tensor(0.2814, device='cuda:1') (0.06928378343582153)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.643402
Original XAI WIoU for r=0.9 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5591, device='cuda:1')  +-  tensor(0.2814, device='cuda:1') (0.06928378343582153)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.914301
Original XAI WIoU for r=0.3 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9963, device='cuda:1')  +-  tensor(0.0111, device='cuda:1') (0.001385863870382309)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.649676
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9963, device='cuda:1')  +-  tensor(0.0111, device='cuda:1') (0.001385863870382309)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.899222
Original XAI WIoU for r=0.9 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9963, device='cuda:1')  +-  tensor(0.0111, device='cuda:1') (0.001385863870382309)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.643867
Original XAI WIoU for r=0.3 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6014, device='cuda:1')  +-  tensor(0.1914, device='cuda:1') (0.07134431600570679)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.653736
Original XAI WIoU for r=0.6 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6014, device='cuda:1')  +-  tensor(0.1914, device='cuda:1') (0.07134431600570679)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.635964
Original XAI WIoU for r=0.9 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6014, device='cuda:1')  +-  tensor(0.1914, device='cuda:1') (0.07134431600570679)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:04:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:20 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:33 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:35 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:37 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 07:04:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.544
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.542
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.551
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.552
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.551
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.814
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.407
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.475



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.710043
Original XAI WIoU for r=0.3 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5260, device='cuda:1')  +-  tensor(0.2958, device='cuda:1') (0.05762177333235741)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.465215
Original XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5260, device='cuda:1')  +-  tensor(0.2958, device='cuda:1') (0.05762177333235741)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.669365
Original XAI WIoU for r=0.9 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5260, device='cuda:1')  +-  tensor(0.2958, device='cuda:1') (0.05762177333235741)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.698385
Original XAI WIoU for r=0.3 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5362, device='cuda:1')  +-  tensor(0.2967, device='cuda:1') (0.05779918283224106)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.668666
Original XAI WIoU for r=0.6 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5362, device='cuda:1')  +-  tensor(0.2967, device='cuda:1') (0.057799141854047775)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.687073
Original XAI WIoU for r=0.9 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5362, device='cuda:1')  +-  tensor(0.2967, device='cuda:1') (0.05779918283224106)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.907249
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0031, device='cuda:1') (9.822397987591103e-05)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.668424
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0031, device='cuda:1') (9.822397987591103e-05)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.908056
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0031, device='cuda:1') (9.822397987591103e-05)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.697456
Original XAI WIoU for r=0.3 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6179, device='cuda:1')  +-  tensor(0.1940, device='cuda:1') (0.08003371953964233)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.682467
Original XAI WIoU for r=0.6 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6179, device='cuda:1')  +-  tensor(0.1940, device='cuda:1') (0.08003371953964233)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.948646
Original XAI WIoU for r=0.9 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6179, device='cuda:1')  +-  tensor(0.1940, device='cuda:1') (0.08003371953964233)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:09:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:32 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:45 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:49 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:51 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 07:09:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.684
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.723
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.731
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.701
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.740
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.748
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.891
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.164
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.373
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.424



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.921636
Original XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2691, device='cuda:1') (0.11484258621931076)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.680775
Original XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2691, device='cuda:1') (0.11484258621931076)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.994127
Original XAI WIoU for r=0.9 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2691, device='cuda:1') (0.11484252661466599)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.714941
Original XAI WIoU for r=0.3 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6093, device='cuda:1')  +-  tensor(0.2628, device='cuda:1') (0.11385902762413025)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.692571
Original XAI WIoU for r=0.6 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6093, device='cuda:1')  +-  tensor(0.2628, device='cuda:1') (0.11385902762413025)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.677903
Original XAI WIoU for r=0.9 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6093, device='cuda:1')  +-  tensor(0.2628, device='cuda:1') (0.11385902762413025)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.911024
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.661308
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.921434
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.770716
Original XAI WIoU for r=0.3 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5364, device='cuda:1')  +-  tensor(0.2044, device='cuda:1') (0.08017910271883011)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.792693
Original XAI WIoU for r=0.6 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5364, device='cuda:1')  +-  tensor(0.2044, device='cuda:1') (0.08017910271883011)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.678673
Original XAI WIoU for r=0.9 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5364, device='cuda:1')  +-  tensor(0.2044, device='cuda:1') (0.08017910271883011)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.65580273 0.65580273 0.65580273] +- [0.08244711 0.08244711 0.08244711] (mean across ratios: 0.6558027267456055)
(id) id_val WIOU_PERTURBED: 	[0.57380639 0.57380642 0.57380643] +- [0.03237312 0.03237315 0.03237316] (mean across ratios: 0.5738064130147298)
(id) id_test WIOU_ORIGINAL: 	[0.66961046 0.66961046 0.66961046] +- [0.08590984 0.08590984 0.08590984] (mean across ratios: 0.6696104645729065)
(id) id_test WIOU_PERTURBED: 	[0.5850054  0.58500541 0.58500539] +- [0.03306042 0.0330604  0.0330604 ] (mean across ratios: 0.5850054025650024)
(id) val WIOU_ORIGINAL: 	[0.99980891 0.99980891 0.99980891] +- [0.0002322 0.0002322 0.0002322] (mean across ratios: 0.9998089075088501)
(id) val WIOU_PERTURBED: 	[0.99906334 0.99906334 0.99906334] +- [0.00140867 0.00140867 0.00140867] (mean across ratios: 0.9990633368492127)
(id) test WIOU_ORIGINAL: 	[0.4539116 0.4539116 0.4539116] +- [0.02255264 0.02255264 0.02255264] (mean across ratios: 0.45391159653663643)
(id) test WIOU_PERTURBED: 	[0.58213167 0.58213167 0.58213167] +- [0.03705647 0.03705647 0.03705647] (mean across ratios: 0.5821316719055176)
DONE CIGA GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:15:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:15 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:31 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:35 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 07:15:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.690
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.738
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.707
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.752
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.754
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.896
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.146
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.356
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.427



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.710911
Original XAI WIoU for r=0.3 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5653, device='cuda:1')  +-  tensor(0.2953, device='cuda:1') (0.1126687228679657)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.713836
Original XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5653, device='cuda:1')  +-  tensor(0.2953, device='cuda:1') (0.1126687228679657)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.897819
Original XAI WIoU for r=0.9 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5653, device='cuda:1')  +-  tensor(0.2953, device='cuda:1') (0.1126687228679657)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.722051
Original XAI WIoU for r=0.3 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5787, device='cuda:1')  +-  tensor(0.2925, device='cuda:1') (0.11335384100675583)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.712749
Original XAI WIoU for r=0.6 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5787, device='cuda:1')  +-  tensor(0.2925, device='cuda:1') (0.11335384100675583)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.683167
Original XAI WIoU for r=0.9 =  tensor(0.7545, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5787, device='cuda:1')  +-  tensor(0.2925, device='cuda:1') (0.11335384100675583)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.708278
Original XAI WIoU for r=0.3 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9991, device='cuda:1')  +-  tensor(0.0083, device='cuda:1') (0.000482509087305516)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.389317
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9991, device='cuda:1')  +-  tensor(0.0083, device='cuda:1') (0.000482509087305516)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.617606
Original XAI WIoU for r=0.9 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9991, device='cuda:1')  +-  tensor(0.0083, device='cuda:1') (0.000482509087305516)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.716947
Original XAI WIoU for r=0.3 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6481, device='cuda:1')  +-  tensor(0.2193, device='cuda:1') (0.10270324349403381)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.622449
Original XAI WIoU for r=0.6 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6481, device='cuda:1')  +-  tensor(0.2193, device='cuda:1') (0.10270324349403381)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.709942
Original XAI WIoU for r=0.9 =  tensor(0.4281, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6481, device='cuda:1')  +-  tensor(0.2193, device='cuda:1') (0.10270324349403381)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:20:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:25 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:38 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:43 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 07:20:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.643
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.696
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.657
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.709
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.713
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.896
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.156
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.400
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.901474
Original XAI WIoU for r=0.3 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6019, device='cuda:1')  +-  tensor(0.2923, device='cuda:1') (0.10367283225059509)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.655921
Original XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6019, device='cuda:1')  +-  tensor(0.2923, device='cuda:1') (0.10367283225059509)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.671313
Original XAI WIoU for r=0.9 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6019, device='cuda:1')  +-  tensor(0.2923, device='cuda:1') (0.10367283225059509)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.681874
Original XAI WIoU for r=0.3 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6144, device='cuda:1')  +-  tensor(0.2888, device='cuda:1') (0.09935908764600754)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.648124
Original XAI WIoU for r=0.6 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6144, device='cuda:1')  +-  tensor(0.2888, device='cuda:1') (0.09935908764600754)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.629532
Original XAI WIoU for r=0.9 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2590, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6144, device='cuda:1')  +-  tensor(0.2888, device='cuda:1') (0.09935908764600754)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.915115
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (8.957827049016487e-06)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.660194
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (8.957827049016487e-06)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.877001
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1') (8.957827049016487e-06)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.885597
Original XAI WIoU for r=0.3 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7358, device='cuda:1')  +-  tensor(0.2080, device='cuda:1') (0.11751139163970947)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.613038
Original XAI WIoU for r=0.6 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7358, device='cuda:1')  +-  tensor(0.2080, device='cuda:1') (0.11751139163970947)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.585725
Original XAI WIoU for r=0.9 =  tensor(0.4710, device='cuda:1')  +-  tensor(0.2019, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7358, device='cuda:1')  +-  tensor(0.2080, device='cuda:1') (0.11751139163970947)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:25:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:32 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:45 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:49 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:51 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 07:25:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.546
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.562
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.572
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.559
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.573
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.583
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.790
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.421
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.471



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.648111
Original XAI WIoU for r=0.3 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5521, device='cuda:1')  +-  tensor(0.3001, device='cuda:1') (0.06012454628944397)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.603799
Original XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5521, device='cuda:1')  +-  tensor(0.3001, device='cuda:1') (0.06012454628944397)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.360271
Original XAI WIoU for r=0.9 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5521, device='cuda:1')  +-  tensor(0.3001, device='cuda:1') (0.06012454628944397)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.847794
Original XAI WIoU for r=0.3 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5633, device='cuda:1')  +-  tensor(0.3025, device='cuda:1') (0.058956775814294815)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.605405
Original XAI WIoU for r=0.6 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5633, device='cuda:1')  +-  tensor(0.3025, device='cuda:1') (0.05895683914422989)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.854788
Original XAI WIoU for r=0.9 =  tensor(0.5826, device='cuda:1')  +-  tensor(0.2190, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5633, device='cuda:1')  +-  tensor(0.3025, device='cuda:1') (0.05895683914422989)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.618765
Original XAI WIoU for r=0.3 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9951, device='cuda:1')  +-  tensor(0.0184, device='cuda:1') (0.003282376332208514)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.596436
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9951, device='cuda:1')  +-  tensor(0.0184, device='cuda:1') (0.003282376332208514)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.571922
Original XAI WIoU for r=0.9 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9951, device='cuda:1')  +-  tensor(0.0184, device='cuda:1') (0.003282376332208514)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.884653
Original XAI WIoU for r=0.3 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7142, device='cuda:1')  +-  tensor(0.1908, device='cuda:1') (0.08653373271226883)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.574541
Original XAI WIoU for r=0.6 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7142, device='cuda:1')  +-  tensor(0.1908, device='cuda:1') (0.08653373271226883)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.830290
Original XAI WIoU for r=0.9 =  tensor(0.4707, device='cuda:1')  +-  tensor(0.1631, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7142, device='cuda:1')  +-  tensor(0.1908, device='cuda:1') (0.08653373271226883)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:30:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:57 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 07:30:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.544
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.542
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.551
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.552
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.551
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.814
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.186
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.407
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.475



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.867815
Original XAI WIoU for r=0.3 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5363, device='cuda:1')  +-  tensor(0.3142, device='cuda:1') (0.04899293929338455)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.629351
Original XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5363, device='cuda:1')  +-  tensor(0.3142, device='cuda:1') (0.04899293929338455)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.418797
Original XAI WIoU for r=0.9 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5363, device='cuda:1')  +-  tensor(0.3142, device='cuda:1') (0.04899293929338455)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.769913
Original XAI WIoU for r=0.3 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5473, device='cuda:1')  +-  tensor(0.3155, device='cuda:1') (0.04838034138083458)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.537091
Original XAI WIoU for r=0.6 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5473, device='cuda:1')  +-  tensor(0.3155, device='cuda:1') (0.04838034138083458)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.737836
Original XAI WIoU for r=0.9 =  tensor(0.5506, device='cuda:1')  +-  tensor(0.2592, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5473, device='cuda:1')  +-  tensor(0.3155, device='cuda:1') (0.04838034138083458)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.481404
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9994, device='cuda:1')  +-  tensor(0.0080, device='cuda:1') (0.00042280153138563037)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.512652
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9994, device='cuda:1')  +-  tensor(0.0080, device='cuda:1') (0.00042280153138563037)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.564161
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9994, device='cuda:1')  +-  tensor(0.0080, device='cuda:1') (0.00042280153138563037)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.632034
Original XAI WIoU for r=0.3 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7333, device='cuda:1')  +-  tensor(0.1883, device='cuda:1') (0.09602149575948715)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.855414
Original XAI WIoU for r=0.6 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7333, device='cuda:1')  +-  tensor(0.1883, device='cuda:1') (0.09602149575948715)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.787536
Original XAI WIoU for r=0.9 =  tensor(0.4751, device='cuda:1')  +-  tensor(0.1564, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7333, device='cuda:1')  +-  tensor(0.1883, device='cuda:1') (0.09602149575948715)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:35:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:35:43 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:35:57 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:35:59 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:01 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 07:36:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.685
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.723
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.731
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.700
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.740
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.748
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.891
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.164
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.373
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.424



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.210085
Original XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5835, device='cuda:1')  +-  tensor(0.2840, device='cuda:1') (0.11478675901889801)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.274037
Original XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5835, device='cuda:1')  +-  tensor(0.2840, device='cuda:1') (0.11478675901889801)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.332725
Original XAI WIoU for r=0.9 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5835, device='cuda:1')  +-  tensor(0.2840, device='cuda:1') (0.11478675901889801)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.870563
Original XAI WIoU for r=0.3 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5959, device='cuda:1')  +-  tensor(0.2822, device='cuda:1') (0.11256007105112076)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.241173
Original XAI WIoU for r=0.6 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5959, device='cuda:1')  +-  tensor(0.2822, device='cuda:1') (0.11256007105112076)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.119080
Original XAI WIoU for r=0.9 =  tensor(0.7478, device='cuda:1')  +-  tensor(0.2653, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5959, device='cuda:1')  +-  tensor(0.2822, device='cuda:1') (0.11256007105112076)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.247985
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.026524
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.180485
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.142519
Original XAI WIoU for r=0.3 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6467, device='cuda:1')  +-  tensor(0.2216, device='cuda:1') (0.1011107787489891)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.884771
Original XAI WIoU for r=0.6 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6467, device='cuda:1')  +-  tensor(0.2216, device='cuda:1') (0.1011107787489891)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.007223
Original XAI WIoU for r=0.9 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6467, device='cuda:1')  +-  tensor(0.2216, device='cuda:1') (0.1011107787489891)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.65580273 0.65580273 0.65580273] +- [0.08244711 0.08244711 0.08244711] (mean across ratios: 0.6558027267456055)
(id) id_val WIOU_PERTURBED: 	[0.56783841 0.56783841 0.56783841] +- [0.02302979 0.02302979 0.02302979] (mean across ratios: 0.5678384065628052)
(id) id_test WIOU_ORIGINAL: 	[0.66961046 0.66961046 0.66961046] +- [0.08590984 0.08590984 0.08590984] (mean across ratios: 0.6696104645729065)
(id) id_test WIOU_PERTURBED: 	[0.57992232 0.57992231 0.57992231] +- [0.02360532 0.02360533 0.02360533] (mean across ratios: 0.5799223105112712)
(id) val WIOU_ORIGINAL: 	[0.99980891 0.99980891 0.99980891] +- [0.0002322 0.0002322 0.0002322] (mean across ratios: 0.9998089075088501)
(id) val WIOU_PERTURBED: 	[0.99871403 0.99871403 0.99871403] +- [0.00182411 0.00182411 0.00182411] (mean across ratios: 0.998714029788971)
(id) test WIOU_ORIGINAL: 	[0.4539116 0.4539116 0.4539116] +- [0.02255264 0.02255264 0.02255264] (mean across ratios: 0.45391159653663643)
(id) test WIOU_PERTURBED: 	[0.69563488 0.69563488 0.69563488] +- [0.04007451 0.04007451 0.04007451] (mean across ratios: 0.6956348776817322)
DONE CIGA GOODMotif/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:42:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:03 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 07:42:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.582
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.492
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.348
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.175
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.451
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.424



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.900536
Original XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3652, device='cuda:1')  +-  tensor(0.2145, device='cuda:1') (0.004172624088823795)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.190146
Original XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3652, device='cuda:1')  +-  tensor(0.2145, device='cuda:1') (0.004172624088823795)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.862913
Original XAI WIoU for r=0.9 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3652, device='cuda:1')  +-  tensor(0.2145, device='cuda:1') (0.004172624088823795)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.972944
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3713, device='cuda:1')  +-  tensor(0.2162, device='cuda:1') (0.0042888992466032505)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.979631
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3713, device='cuda:1')  +-  tensor(0.2162, device='cuda:1') (0.0042888992466032505)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.891298
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3713, device='cuda:1')  +-  tensor(0.2162, device='cuda:1') (0.0042888992466032505)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.610955
Original XAI WIoU for r=0.3 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4662, device='cuda:1')  +-  tensor(0.0910, device='cuda:1') (0.0012653283774852753)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.245604
Original XAI WIoU for r=0.6 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4662, device='cuda:1')  +-  tensor(0.0910, device='cuda:1') (0.0012653283774852753)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.455817
Original XAI WIoU for r=0.9 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4662, device='cuda:1')  +-  tensor(0.0910, device='cuda:1') (0.0012653283774852753)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.960735
Original XAI WIoU for r=0.3 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4271, device='cuda:1')  +-  tensor(0.1142, device='cuda:1') (0.0050662909634411335)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.791006
Original XAI WIoU for r=0.6 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4271, device='cuda:1')  +-  tensor(0.1142, device='cuda:1') (0.0050662909634411335)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.640537
Original XAI WIoU for r=0.9 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4271, device='cuda:1')  +-  tensor(0.1142, device='cuda:1') (0.0050662909634411335)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:48:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:36 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:52 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:55 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:57 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 07:48:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.495
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.356
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.260
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.431



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.102377
Original XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.2180, device='cuda:1') (0.006204941775649786)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.788857
Original XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.2180, device='cuda:1') (0.006204941775649786)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.990813
Original XAI WIoU for r=0.9 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.2180, device='cuda:1') (0.006204941775649786)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.701532
Original XAI WIoU for r=0.3 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3787, device='cuda:1')  +-  tensor(0.2196, device='cuda:1') (0.006327808368951082)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.720613
Original XAI WIoU for r=0.6 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3787, device='cuda:1')  +-  tensor(0.2196, device='cuda:1') (0.006327808368951082)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.614257
Original XAI WIoU for r=0.9 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3787, device='cuda:1')  +-  tensor(0.2196, device='cuda:1') (0.006327808368951082)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.630393
Original XAI WIoU for r=0.3 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4730, device='cuda:1')  +-  tensor(0.0980, device='cuda:1') (0.0008580085122957826)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.459041
Original XAI WIoU for r=0.6 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4730, device='cuda:1')  +-  tensor(0.0980, device='cuda:1') (0.0008580085122957826)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.638148
Original XAI WIoU for r=0.9 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4730, device='cuda:1')  +-  tensor(0.0980, device='cuda:1') (0.0008580085122957826)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.702629
Original XAI WIoU for r=0.3 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4385, device='cuda:1')  +-  tensor(0.1197, device='cuda:1') (0.007347801234573126)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.268163
Original XAI WIoU for r=0.6 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4385, device='cuda:1')  +-  tensor(0.1197, device='cuda:1') (0.007347801234573126)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.807345
Original XAI WIoU for r=0.9 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4385, device='cuda:1')  +-  tensor(0.1197, device='cuda:1') (0.007347801234573126)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 19:55:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:22 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:24 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:27 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 07:55:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.494
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.299
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.480
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.417



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.115317
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3699, device='cuda:1')  +-  tensor(0.2161, device='cuda:1') (0.005883726757019758)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.635524
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3699, device='cuda:1')  +-  tensor(0.2161, device='cuda:1') (0.005883726757019758)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.980046
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3699, device='cuda:1')  +-  tensor(0.2161, device='cuda:1') (0.005883726757019758)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.760842
Original XAI WIoU for r=0.3 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3762, device='cuda:1')  +-  tensor(0.2177, device='cuda:1') (0.005798889324069023)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.759337
Original XAI WIoU for r=0.6 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3762, device='cuda:1')  +-  tensor(0.2177, device='cuda:1') (0.005798889324069023)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.509916
Original XAI WIoU for r=0.9 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3762, device='cuda:1')  +-  tensor(0.2177, device='cuda:1') (0.005798889324069023)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.185464
Original XAI WIoU for r=0.3 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4739, device='cuda:1')  +-  tensor(0.0944, device='cuda:1') (0.0005915037472732365)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.604852
Original XAI WIoU for r=0.6 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4739, device='cuda:1')  +-  tensor(0.0944, device='cuda:1') (0.0005915037472732365)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.810577
Original XAI WIoU for r=0.9 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4739, device='cuda:1')  +-  tensor(0.0944, device='cuda:1') (0.0005915037472732365)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.607183
Original XAI WIoU for r=0.3 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4361, device='cuda:1')  +-  tensor(0.1180, device='cuda:1') (0.007312458008527756)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.763920
Original XAI WIoU for r=0.6 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4361, device='cuda:1')  +-  tensor(0.1180, device='cuda:1') (0.007312458008527756)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.404257
Original XAI WIoU for r=0.9 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4361, device='cuda:1')  +-  tensor(0.1180, device='cuda:1') (0.007312458008527756)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 20:01:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 08:01:40 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 08:01:55 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 08:01:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:00 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:02 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 08:02:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.481
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.346
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.252
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.425



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.823538
Original XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3689, device='cuda:1')  +-  tensor(0.2148, device='cuda:1') (0.005169262643903494)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.770085
Original XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3689, device='cuda:1')  +-  tensor(0.2148, device='cuda:1') (0.005169262643903494)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.646842
Original XAI WIoU for r=0.9 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3689, device='cuda:1')  +-  tensor(0.2148, device='cuda:1') (0.005169262643903494)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.083488
Original XAI WIoU for r=0.3 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3750, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.005232914350926876)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.517695
Original XAI WIoU for r=0.6 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3750, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.005232914350926876)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.763174
Original XAI WIoU for r=0.9 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3750, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.005232914350926876)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.541956
Original XAI WIoU for r=0.3 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4720, device='cuda:1')  +-  tensor(0.0948, device='cuda:1') (0.0011291292030364275)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.583171
Original XAI WIoU for r=0.6 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4720, device='cuda:1')  +-  tensor(0.0948, device='cuda:1') (0.0011291292030364275)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.673848
Original XAI WIoU for r=0.9 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4720, device='cuda:1')  +-  tensor(0.0948, device='cuda:1') (0.0011291292030364275)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.802610
Original XAI WIoU for r=0.3 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4341, device='cuda:1')  +-  tensor(0.1157, device='cuda:1') (0.0065144868567585945)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.492948
Original XAI WIoU for r=0.6 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4341, device='cuda:1')  +-  tensor(0.1157, device='cuda:1') (0.0065144868567585945)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.456053
Original XAI WIoU for r=0.9 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4341, device='cuda:1')  +-  tensor(0.1157, device='cuda:1') (0.0065144868567585945)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 20:08:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:14 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:31 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:35 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 08:08:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.530
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.238
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.417



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.329051
Original XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3685, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.005840024445205927)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.774693
Original XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3685, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.005840031895786524)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.034954
Original XAI WIoU for r=0.9 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3685, device='cuda:1')  +-  tensor(0.2165, device='cuda:1') (0.005840031895786524)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.946532
Original XAI WIoU for r=0.3 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3746, device='cuda:1')  +-  tensor(0.2181, device='cuda:1') (0.005996481981128454)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.923684
Original XAI WIoU for r=0.6 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3746, device='cuda:1')  +-  tensor(0.2181, device='cuda:1') (0.005996481981128454)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.712335
Original XAI WIoU for r=0.9 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3746, device='cuda:1')  +-  tensor(0.2181, device='cuda:1') (0.005996481981128454)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.711477
Original XAI WIoU for r=0.3 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4840, device='cuda:1')  +-  tensor(0.0931, device='cuda:1') (0.0015668104169890285)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.930355
Original XAI WIoU for r=0.6 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4840, device='cuda:1')  +-  tensor(0.0931, device='cuda:1') (0.0015668104169890285)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.531950
Original XAI WIoU for r=0.9 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4840, device='cuda:1')  +-  tensor(0.0931, device='cuda:1') (0.0015668104169890285)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.703442
Original XAI WIoU for r=0.3 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4340, device='cuda:1')  +-  tensor(0.1177, device='cuda:1') (0.0071276710368692875)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.765426
Original XAI WIoU for r=0.6 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4340, device='cuda:1')  +-  tensor(0.1177, device='cuda:1') (0.0071276710368692875)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.504002
Original XAI WIoU for r=0.9 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4340, device='cuda:1')  +-  tensor(0.1177, device='cuda:1') (0.0071276710368692875)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.32219606 0.32219606 0.32219606] +- [0.0026828 0.0026828 0.0026828] (mean across ratios: 0.32219606041908266)
(id) id_val WIOU_PERTURBED: 	[0.36901857 0.36901859 0.36901859] +- [0.0023355 0.0023355 0.0023355] (mean across ratios: 0.3690185844898224)
(id) id_test WIOU_ORIGINAL: 	[0.32659646 0.32659646 0.32659646] +- [0.0027637 0.0027637 0.0027637] (mean across ratios: 0.32659646272659304)
(id) id_test WIOU_PERTURBED: 	[0.37517419 0.37517419 0.3751742 ] +- [0.00240121 0.00240121 0.00240121] (mean across ratios: 0.3751741965611776)
(id) val WIOU_ORIGINAL: 	[0.44520326 0.44520326 0.44520326] +- [0.00595847 0.00595847 0.00595847] (mean across ratios: 0.44520326256752013)
(id) val WIOU_PERTURBED: 	[0.47380313 0.47380313 0.47380313] +- [0.00577514 0.00577514 0.00577514] (mean across ratios: 0.4738031327724457)
(id) test WIOU_ORIGINAL: 	[0.39671335 0.39671335 0.39671335] +- [0.00250526 0.00250526 0.00250526] (mean across ratios: 0.39671334624290466)
(id) test WIOU_PERTURBED: 	[0.43396508 0.43396508 0.43396508] +- [0.00379757 0.00379757 0.00379757] (mean across ratios: 0.4339650809764863)
DONE GSAT GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 20:15:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:15 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:32 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:34 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:36 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 08:15:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.582
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.492
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.348
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.175
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.451
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.424



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.839168
Original XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3983, device='cuda:1')  +-  tensor(0.2537, device='cuda:1') (0.004530305974185467)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.172969
Original XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3983, device='cuda:1')  +-  tensor(0.2537, device='cuda:1') (0.004530305974185467)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.906313
Original XAI WIoU for r=0.9 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3983, device='cuda:1')  +-  tensor(0.2537, device='cuda:1') (0.004530305974185467)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.891164
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4056, device='cuda:1')  +-  tensor(0.2561, device='cuda:1') (0.0046852752566337585)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.022499
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4056, device='cuda:1')  +-  tensor(0.2561, device='cuda:1') (0.0046852752566337585)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.988031
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1630, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4056, device='cuda:1')  +-  tensor(0.2561, device='cuda:1') (0.0046852752566337585)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.700155
Original XAI WIoU for r=0.3 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4986, device='cuda:1')  +-  tensor(0.1039, device='cuda:1') (0.002068132162094116)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.047784
Original XAI WIoU for r=0.6 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4986, device='cuda:1')  +-  tensor(0.1039, device='cuda:1') (0.002068132162094116)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.624444
Original XAI WIoU for r=0.9 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4986, device='cuda:1')  +-  tensor(0.1039, device='cuda:1') (0.002068132162094116)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.866668
Original XAI WIoU for r=0.3 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4657, device='cuda:1')  +-  tensor(0.1309, device='cuda:1') (0.005966847762465477)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.817097
Original XAI WIoU for r=0.6 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4657, device='cuda:1')  +-  tensor(0.1309, device='cuda:1') (0.005966847762465477)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.757935
Original XAI WIoU for r=0.9 =  tensor(0.3929, device='cuda:1')  +-  tensor(0.0984, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4657, device='cuda:1')  +-  tensor(0.1309, device='cuda:1') (0.005966847762465477)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 20:21:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 08:21:46 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:01 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:03 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:05 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 08:22:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.590
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.495
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.356
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.260
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.431



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.679267
Original XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4050, device='cuda:1')  +-  tensor(0.2557, device='cuda:1') (0.005808765534311533)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.189396
Original XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4050, device='cuda:1')  +-  tensor(0.2557, device='cuda:1') (0.005808765534311533)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.089897
Original XAI WIoU for r=0.9 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4050, device='cuda:1')  +-  tensor(0.2557, device='cuda:1') (0.005808765534311533)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.744569
Original XAI WIoU for r=0.3 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4122, device='cuda:1')  +-  tensor(0.2581, device='cuda:1') (0.005865391809493303)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.143781
Original XAI WIoU for r=0.6 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4122, device='cuda:1')  +-  tensor(0.2581, device='cuda:1') (0.005865391809493303)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.849833
Original XAI WIoU for r=0.9 =  tensor(0.3311, device='cuda:1')  +-  tensor(0.1684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4122, device='cuda:1')  +-  tensor(0.2581, device='cuda:1') (0.005865391809493303)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.623838
Original XAI WIoU for r=0.3 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5067, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.0015969241503626108)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.323405
Original XAI WIoU for r=0.6 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5067, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.0015969241503626108)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.660440
Original XAI WIoU for r=0.9 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5067, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.0015969241503626108)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.621943
Original XAI WIoU for r=0.3 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4786, device='cuda:1')  +-  tensor(0.1360, device='cuda:1') (0.007973756641149521)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.257969
Original XAI WIoU for r=0.6 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4786, device='cuda:1')  +-  tensor(0.1360, device='cuda:1') (0.007973765954375267)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.418269
Original XAI WIoU for r=0.9 =  tensor(0.4004, device='cuda:1')  +-  tensor(0.1039, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4786, device='cuda:1')  +-  tensor(0.1360, device='cuda:1') (0.007973765954375267)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 20:28:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:18 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:33 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:35 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:37 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 08:28:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.494
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.352
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.299
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.480
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.417



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.046554
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4026, device='cuda:1')  +-  tensor(0.2547, device='cuda:1') (0.006022168323397636)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.029295
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4026, device='cuda:1')  +-  tensor(0.2547, device='cuda:1') (0.006022168323397636)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.131075
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4026, device='cuda:1')  +-  tensor(0.2547, device='cuda:1') (0.006022168323397636)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.774022
Original XAI WIoU for r=0.3 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4099, device='cuda:1')  +-  tensor(0.2571, device='cuda:1') (0.005894543137401342)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.761611
Original XAI WIoU for r=0.6 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4099, device='cuda:1')  +-  tensor(0.2571, device='cuda:1') (0.005894608795642853)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.837565
Original XAI WIoU for r=0.9 =  tensor(0.3275, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4099, device='cuda:1')  +-  tensor(0.2571, device='cuda:1') (0.005894543137401342)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.078573
Original XAI WIoU for r=0.3 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5060, device='cuda:1')  +-  tensor(0.1059, device='cuda:1') (0.0011118848342448473)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.708274
Original XAI WIoU for r=0.6 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5060, device='cuda:1')  +-  tensor(0.1059, device='cuda:1') (0.0011118848342448473)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.960167
Original XAI WIoU for r=0.9 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5060, device='cuda:1')  +-  tensor(0.1059, device='cuda:1') (0.0011118848342448473)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.469267
Original XAI WIoU for r=0.3 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4755, device='cuda:1')  +-  tensor(0.1328, device='cuda:1') (0.007914452813565731)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.635191
Original XAI WIoU for r=0.6 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4755, device='cuda:1')  +-  tensor(0.1328, device='cuda:1') (0.007914452813565731)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.865665
Original XAI WIoU for r=0.9 =  tensor(0.3981, device='cuda:1')  +-  tensor(0.1035, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4755, device='cuda:1')  +-  tensor(0.1328, device='cuda:1') (0.007914452813565731)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 20:34:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 08:34:51 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:10 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:12 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 08:35:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.481
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.346
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.252
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.425



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.725477
Original XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4021, device='cuda:1')  +-  tensor(0.2539, device='cuda:1') (0.005492566153407097)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.827362
Original XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4021, device='cuda:1')  +-  tensor(0.2539, device='cuda:1') (0.005492566153407097)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.912731
Original XAI WIoU for r=0.9 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4021, device='cuda:1')  +-  tensor(0.2539, device='cuda:1') (0.005492566153407097)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.029981
Original XAI WIoU for r=0.3 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4093, device='cuda:1')  +-  tensor(0.2563, device='cuda:1') (0.0053436425514519215)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.865388
Original XAI WIoU for r=0.6 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4093, device='cuda:1')  +-  tensor(0.2563, device='cuda:1') (0.0053436425514519215)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.845135
Original XAI WIoU for r=0.9 =  tensor(0.3264, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4093, device='cuda:1')  +-  tensor(0.2563, device='cuda:1') (0.0053436425514519215)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.719328
Original XAI WIoU for r=0.3 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5048, device='cuda:1')  +-  tensor(0.1069, device='cuda:1') (0.0018557372968643904)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.368920
Original XAI WIoU for r=0.6 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5048, device='cuda:1')  +-  tensor(0.1069, device='cuda:1') (0.0018557372968643904)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.919748
Original XAI WIoU for r=0.9 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5048, device='cuda:1')  +-  tensor(0.1069, device='cuda:1') (0.0018557372968643904)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.687893
Original XAI WIoU for r=0.3 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4729, device='cuda:1')  +-  tensor(0.1311, device='cuda:1') (0.006757437251508236)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.828664
Original XAI WIoU for r=0.6 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4729, device='cuda:1')  +-  tensor(0.1311, device='cuda:1') (0.006757437251508236)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.159006
Original XAI WIoU for r=0.9 =  tensor(0.3965, device='cuda:1')  +-  tensor(0.1016, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4729, device='cuda:1')  +-  tensor(0.1311, device='cuda:1') (0.006757437251508236)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 20:41:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:24 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:39 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:46 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 08:41:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.530
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.331
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.238
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.417



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.797173
Original XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4017, device='cuda:1')  +-  tensor(0.2554, device='cuda:1') (0.005591132212430239)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.740788
Original XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4017, device='cuda:1')  +-  tensor(0.2554, device='cuda:1') (0.005591132212430239)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.642188
Original XAI WIoU for r=0.9 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4017, device='cuda:1')  +-  tensor(0.2554, device='cuda:1') (0.005591022316366434)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.938627
Original XAI WIoU for r=0.3 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4091, device='cuda:1')  +-  tensor(0.2578, device='cuda:1') (0.005651812069118023)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.886706
Original XAI WIoU for r=0.6 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4091, device='cuda:1')  +-  tensor(0.2578, device='cuda:1') (0.005651812069118023)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.655312
Original XAI WIoU for r=0.9 =  tensor(0.3251, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4091, device='cuda:1')  +-  tensor(0.2578, device='cuda:1') (0.005651812069118023)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.670311
Original XAI WIoU for r=0.3 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5156, device='cuda:1')  +-  tensor(0.1032, device='cuda:1') (0.002570974873378873)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.780115
Original XAI WIoU for r=0.6 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5156, device='cuda:1')  +-  tensor(0.1032, device='cuda:1') (0.002570974873378873)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.603444
Original XAI WIoU for r=0.9 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5156, device='cuda:1')  +-  tensor(0.1032, device='cuda:1') (0.002570974873378873)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.125447
Original XAI WIoU for r=0.3 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4742, device='cuda:1')  +-  tensor(0.1337, device='cuda:1') (0.007803591433912516)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.659738
Original XAI WIoU for r=0.6 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4742, device='cuda:1')  +-  tensor(0.1337, device='cuda:1') (0.007803591433912516)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.945527
Original XAI WIoU for r=0.9 =  tensor(0.3957, device='cuda:1')  +-  tensor(0.1022, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4742, device='cuda:1')  +-  tensor(0.1337, device='cuda:1') (0.007803591433912516)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.32219606 0.32219606 0.32219606] +- [0.0026828 0.0026828 0.0026828] (mean across ratios: 0.32219606041908266)
(id) id_val WIOU_PERTURBED: 	[0.40193374 0.40193374 0.40193376] +- [0.00215061 0.00215061 0.00215061] (mean across ratios: 0.4019337475299835)
(id) id_test WIOU_ORIGINAL: 	[0.32659646 0.32659646 0.32659646] +- [0.0027637 0.0027637 0.0027637] (mean across ratios: 0.32659646272659304)
(id) id_test WIOU_PERTURBED: 	[0.40921317 0.40921316 0.40921317] +- [0.00213853 0.00213852 0.00213853] (mean across ratios: 0.40921316544214886)
(id) val WIOU_ORIGINAL: 	[0.44520326 0.44520326 0.44520326] +- [0.00595847 0.00595847 0.00595847] (mean across ratios: 0.44520326256752013)
(id) val WIOU_PERTURBED: 	[0.50633687 0.50633687 0.50633687] +- [0.00544856 0.00544856 0.00544856] (mean across ratios: 0.5063368678092957)
(id) test WIOU_ORIGINAL: 	[0.39671335 0.39671335 0.39671335] +- [0.00250526 0.00250526 0.00250526] (mean across ratios: 0.39671334624290466)
(id) test WIOU_PERTURBED: 	[0.4733817  0.47338172 0.47338172] +- [0.00428218 0.0042822  0.0042822 ] (mean across ratios: 0.47338171005249025)
DONE GSAT GOODMotif/basis 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 20:48:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:27 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:41 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:43 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:46 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:49 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:48:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.382
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.467
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.262
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.226
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.196
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.134
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.096
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.078



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.582489
Original XAI WIoU for r=0.3 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5116, device='cuda:1')  +-  tensor(0.2767, device='cuda:1') (0.03988851234316826)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.949155
Original XAI WIoU for r=0.6 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5116, device='cuda:1')  +-  tensor(0.2767, device='cuda:1') (0.03988851234316826)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.602684
Original XAI WIoU for r=0.9 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5116, device='cuda:1')  +-  tensor(0.2767, device='cuda:1') (0.03988851234316826)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.616943
Original XAI WIoU for r=0.3 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5145, device='cuda:1')  +-  tensor(0.2776, device='cuda:1') (0.03965692222118378)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.641334
Original XAI WIoU for r=0.6 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5145, device='cuda:1')  +-  tensor(0.2776, device='cuda:1') (0.03965699300169945)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.216678
Original XAI WIoU for r=0.9 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5145, device='cuda:1')  +-  tensor(0.2776, device='cuda:1') (0.03965692222118378)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.339876
Original XAI WIoU for r=0.3 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2308, device='cuda:1')  +-  tensor(0.1366, device='cuda:1') (0.010948212817311287)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.101973
Original XAI WIoU for r=0.6 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2308, device='cuda:1')  +-  tensor(0.1366, device='cuda:1') (0.01094828825443983)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.215158
Original XAI WIoU for r=0.9 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2308, device='cuda:1')  +-  tensor(0.1366, device='cuda:1') (0.010948257520794868)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.376340
Original XAI WIoU for r=0.3 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1004, device='cuda:1')  +-  tensor(0.0600, device='cuda:1') (0.001995365833863616)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.441265
Original XAI WIoU for r=0.6 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1004, device='cuda:1')  +-  tensor(0.0600, device='cuda:1') (0.001995365833863616)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.987567
Original XAI WIoU for r=0.9 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1004, device='cuda:1')  +-  tensor(0.0600, device='cuda:1') (0.001995365833863616)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 20:57:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:22 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:38 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:40 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 08:57:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.382
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.464
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.442
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.344
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.334
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.295
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.281
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.281



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.848116
Original XAI WIoU for r=0.3 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5122, device='cuda:1')  +-  tensor(0.2684, device='cuda:1') (0.03303704038262367)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.844531
Original XAI WIoU for r=0.6 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5122, device='cuda:1')  +-  tensor(0.2684, device='cuda:1') (0.03303704038262367)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.062567
Original XAI WIoU for r=0.9 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5122, device='cuda:1')  +-  tensor(0.2684, device='cuda:1') (0.03303704038262367)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.836336
Original XAI WIoU for r=0.3 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5141, device='cuda:1')  +-  tensor(0.2695, device='cuda:1') (0.03187153488397598)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.386668
Original XAI WIoU for r=0.6 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5141, device='cuda:1')  +-  tensor(0.2695, device='cuda:1') (0.03187153488397598)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.744117
Original XAI WIoU for r=0.9 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5141, device='cuda:1')  +-  tensor(0.2695, device='cuda:1') (0.03187153488397598)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.181698
Original XAI WIoU for r=0.3 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3359, device='cuda:1')  +-  tensor(0.2633, device='cuda:1') (0.02388833835721016)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.998733
Original XAI WIoU for r=0.6 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3359, device='cuda:1')  +-  tensor(0.2633, device='cuda:1') (0.02388821169734001)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.962378
Original XAI WIoU for r=0.9 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3359, device='cuda:1')  +-  tensor(0.2633, device='cuda:1') (0.02388821169734001)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.263157
Original XAI WIoU for r=0.3 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2919, device='cuda:1')  +-  tensor(0.3303, device='cuda:1') (0.018799932673573494)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.186050
Original XAI WIoU for r=0.6 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2919, device='cuda:1')  +-  tensor(0.3303, device='cuda:1') (0.018799932673573494)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.282565
Original XAI WIoU for r=0.9 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2919, device='cuda:1')  +-  tensor(0.3303, device='cuda:1') (0.018799932673573494)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 21:06:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:18 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:06:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.590
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.593
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.597
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.597
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.215
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.165
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.146



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.018947
Original XAI WIoU for r=0.3 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6550, device='cuda:1')  +-  tensor(0.3258, device='cuda:1') (0.04384210333228111)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.786427
Original XAI WIoU for r=0.6 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6550, device='cuda:1')  +-  tensor(0.3258, device='cuda:1') (0.04384210333228111)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.623821
Original XAI WIoU for r=0.9 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6550, device='cuda:1')  +-  tensor(0.3258, device='cuda:1') (0.04384210333228111)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.978814
Original XAI WIoU for r=0.3 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6566, device='cuda:1')  +-  tensor(0.3268, device='cuda:1') (0.04353118687868118)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.655042
Original XAI WIoU for r=0.6 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6566, device='cuda:1')  +-  tensor(0.3268, device='cuda:1') (0.04353118687868118)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.840390
Original XAI WIoU for r=0.9 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6566, device='cuda:1')  +-  tensor(0.3268, device='cuda:1') (0.04353118687868118)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.950346
Original XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4732, device='cuda:1')  +-  tensor(0.3432, device='cuda:1') (0.050580594688653946)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.029431
Original XAI WIoU for r=0.6 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4732, device='cuda:1')  +-  tensor(0.3432, device='cuda:1') (0.050580594688653946)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.001496
Original XAI WIoU for r=0.9 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4732, device='cuda:1')  +-  tensor(0.3432, device='cuda:1') (0.050580594688653946)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.360962
Original XAI WIoU for r=0.3 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1668, device='cuda:1')  +-  tensor(0.1116, device='cuda:1') (0.020400630310177803)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.137690
Original XAI WIoU for r=0.6 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1668, device='cuda:1')  +-  tensor(0.1116, device='cuda:1') (0.020400630310177803)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.155829
Original XAI WIoU for r=0.9 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1668, device='cuda:1')  +-  tensor(0.1116, device='cuda:1') (0.020400630310177803)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 21:15:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:16 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:30 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:32 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:34 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:15:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.368
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.408
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.365
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.377
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.415
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.315
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.320
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.256
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.262
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.263



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.722129
Original XAI WIoU for r=0.3 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4188, device='cuda:1')  +-  tensor(0.2556, device='cuda:1') (0.049717120826244354)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.001036
Original XAI WIoU for r=0.6 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4188, device='cuda:1')  +-  tensor(0.2556, device='cuda:1') (0.049717120826244354)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.673580
Original XAI WIoU for r=0.9 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4188, device='cuda:1')  +-  tensor(0.2556, device='cuda:1') (0.049717120826244354)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.745208
Original XAI WIoU for r=0.3 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4230, device='cuda:1')  +-  tensor(0.2591, device='cuda:1') (0.047361109405756)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.570274
Original XAI WIoU for r=0.6 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4230, device='cuda:1')  +-  tensor(0.2591, device='cuda:1') (0.047361109405756)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.753416
Original XAI WIoU for r=0.9 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4230, device='cuda:1')  +-  tensor(0.2591, device='cuda:1') (0.047361109405756)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.275172
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3231, device='cuda:1')  +-  tensor(0.3273, device='cuda:1') (0.024876177310943604)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.053352
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3231, device='cuda:1')  +-  tensor(0.3273, device='cuda:1') (0.024876177310943604)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.242577
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3231, device='cuda:1')  +-  tensor(0.3273, device='cuda:1') (0.024876177310943604)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.404285
Original XAI WIoU for r=0.3 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2647, device='cuda:1')  +-  tensor(0.3832, device='cuda:1') (0.0073289526626467705)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.271992
Original XAI WIoU for r=0.6 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2647, device='cuda:1')  +-  tensor(0.3832, device='cuda:1') (0.0073289526626467705)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.085372
Original XAI WIoU for r=0.9 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2647, device='cuda:1')  +-  tensor(0.3832, device='cuda:1') (0.0073289526626467705)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 21:24:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:15 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:29 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:31 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:37 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:44 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:44 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:44 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:24:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.313
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.395
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.251
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.402
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.280
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.237
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.266
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.244



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.909437
Original XAI WIoU for r=0.3 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4917, device='cuda:1')  +-  tensor(0.2811, device='cuda:1') (0.04805610701441765)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.672186
Original XAI WIoU for r=0.6 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4917, device='cuda:1')  +-  tensor(0.2811, device='cuda:1') (0.04805610701441765)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.261213
Original XAI WIoU for r=0.9 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4917, device='cuda:1')  +-  tensor(0.2811, device='cuda:1') (0.04805610701441765)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.850255
Original XAI WIoU for r=0.3 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4966, device='cuda:1')  +-  tensor(0.2842, device='cuda:1') (0.04550398886203766)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.719406
Original XAI WIoU for r=0.6 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4966, device='cuda:1')  +-  tensor(0.2842, device='cuda:1') (0.04550398886203766)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.010663
Original XAI WIoU for r=0.9 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4966, device='cuda:1')  +-  tensor(0.2842, device='cuda:1') (0.04550398886203766)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.227975
Original XAI WIoU for r=0.3 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2475, device='cuda:1')  +-  tensor(0.1648, device='cuda:1') (0.033489521592855453)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.148743
Original XAI WIoU for r=0.6 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2475, device='cuda:1')  +-  tensor(0.1648, device='cuda:1') (0.0334896445274353)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.130048
Original XAI WIoU for r=0.9 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2475, device='cuda:1')  +-  tensor(0.1648, device='cuda:1') (0.033489521592855453)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.185243
Original XAI WIoU for r=0.3 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2073, device='cuda:1')  +-  tensor(0.2442, device='cuda:1') (0.013488474301993847)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.222294
Original XAI WIoU for r=0.6 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2073, device='cuda:1')  +-  tensor(0.2442, device='cuda:1') (0.013488474301993847)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.989583
Original XAI WIoU for r=0.9 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2073, device='cuda:1')  +-  tensor(0.2442, device='cuda:1') (0.013488474301993847)
len(reference) = 3000


DONE GOODMotif - LECIvGIN
(id) id_val WIOU_ORIGINAL: 	[0.44761314 0.44761314 0.44761314] +- [0.07279325 0.07279325 0.07279325] (mean across ratios: 0.44761313796043395)
(id) id_val WIOU_PERTURBED: 	[0.51788022 0.51788022 0.51788022] +- [0.07665269 0.07665269 0.07665269] (mean across ratios: 0.5178802192211152)
(id) id_test WIOU_ORIGINAL: 	[0.45311112 0.45311112 0.45311112] +- [0.07175872 0.07175872 0.07175872] (mean across ratios: 0.45311111807823173)
(id) id_test WIOU_PERTURBED: 	[0.52096484 0.52096483 0.52096485] +- [0.0757316 0.0757316 0.0757316] (mean across ratios: 0.5209648430347443)
(id) val WIOU_ORIGINAL: 	[0.30000614 0.30000614 0.30000606] +- [0.08320276 0.08320276 0.08320286] (mean across ratios: 0.30000611245632175)
(id) val WIOU_PERTURBED: 	[0.32208891 0.32208891 0.32208894] +- [0.08592075 0.08592077 0.08592074] (mean across ratios: 0.32208892007668816)
(id) test WIOU_ORIGINAL: 	[0.20151746 0.20151746 0.20151746] +- [0.08016272 0.08016272 0.08016272] (mean across ratios: 0.20151746422052383)
(id) test WIOU_PERTURBED: 	[0.20622374 0.20622374 0.20622374] +- [0.06857652 0.06857652 0.06857652] (mean across ratios: 0.2062237411737442)
DONE LECI GOODMotif/size 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 21:33:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 09:33:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:04 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:11 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:34:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.382
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.467
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.262
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.226
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.196
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.134
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.096
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.078



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.810667
Original XAI WIoU for r=0.3 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5507, device='cuda:1')  +-  tensor(0.3004, device='cuda:1') (0.03916708379983902)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.300224
Original XAI WIoU for r=0.6 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5507, device='cuda:1')  +-  tensor(0.3004, device='cuda:1') (0.03916708379983902)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.505973
Original XAI WIoU for r=0.9 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5507, device='cuda:1')  +-  tensor(0.3004, device='cuda:1') (0.03916708379983902)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.585556
Original XAI WIoU for r=0.3 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5517, device='cuda:1')  +-  tensor(0.3003, device='cuda:1') (0.04012657701969147)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.676694
Original XAI WIoU for r=0.6 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5517, device='cuda:1')  +-  tensor(0.3003, device='cuda:1') (0.040126726031303406)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.137670
Original XAI WIoU for r=0.9 =  tensor(0.4203, device='cuda:1')  +-  tensor(0.2173, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5517, device='cuda:1')  +-  tensor(0.3003, device='cuda:1') (0.04012657701969147)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.757622
Original XAI WIoU for r=0.3 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2784, device='cuda:1')  +-  tensor(0.1843, device='cuda:1') (0.025222599506378174)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.143018
Original XAI WIoU for r=0.6 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2784, device='cuda:1')  +-  tensor(0.1843, device='cuda:1') (0.025222696363925934)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.308430
Original XAI WIoU for r=0.9 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2784, device='cuda:1')  +-  tensor(0.1843, device='cuda:1') (0.025222599506378174)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.264029
Original XAI WIoU for r=0.3 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1121, device='cuda:1')  +-  tensor(0.0771, device='cuda:1') (0.0016690506599843502)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.054505
Original XAI WIoU for r=0.6 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1121, device='cuda:1')  +-  tensor(0.0771, device='cuda:1') (0.0016690506599843502)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.399157
Original XAI WIoU for r=0.9 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0389, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1121, device='cuda:1')  +-  tensor(0.0771, device='cuda:1') (0.0016690791817381978)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 21:42:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 09:42:41 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 09:42:55 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 09:42:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:00 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:43:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.382
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.464
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.442
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.344
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.334
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.295
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.281
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.281



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.827329
Original XAI WIoU for r=0.3 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5446, device='cuda:1')  +-  tensor(0.2887, device='cuda:1') (0.032149408012628555)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.398015
Original XAI WIoU for r=0.6 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5446, device='cuda:1')  +-  tensor(0.2887, device='cuda:1') (0.032149408012628555)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.952296
Original XAI WIoU for r=0.9 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5446, device='cuda:1')  +-  tensor(0.2887, device='cuda:1') (0.032149408012628555)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.706068
Original XAI WIoU for r=0.3 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5456, device='cuda:1')  +-  tensor(0.2890, device='cuda:1') (0.03143804520368576)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.310699
Original XAI WIoU for r=0.6 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5456, device='cuda:1')  +-  tensor(0.2890, device='cuda:1') (0.03143804520368576)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.721030
Original XAI WIoU for r=0.9 =  tensor(0.4280, device='cuda:1')  +-  tensor(0.2063, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5456, device='cuda:1')  +-  tensor(0.2890, device='cuda:1') (0.03143804520368576)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.268055
Original XAI WIoU for r=0.3 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3354, device='cuda:1')  +-  tensor(0.2375, device='cuda:1') (0.02556479535996914)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.950386
Original XAI WIoU for r=0.6 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3354, device='cuda:1')  +-  tensor(0.2375, device='cuda:1') (0.025564828887581825)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.952416
Original XAI WIoU for r=0.9 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3354, device='cuda:1')  +-  tensor(0.2375, device='cuda:1') (0.025564778596162796)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.089508
Original XAI WIoU for r=0.3 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1527, device='cuda:1')  +-  tensor(0.0989, device='cuda:1') (0.009385351091623306)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.362471
Original XAI WIoU for r=0.6 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1527, device='cuda:1')  +-  tensor(0.0989, device='cuda:1') (0.00938542652875185)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.320019
Original XAI WIoU for r=0.9 =  tensor(0.2806, device='cuda:1')  +-  tensor(0.3447, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1527, device='cuda:1')  +-  tensor(0.0989, device='cuda:1') (0.009385351091623306)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 21:51:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 09:51:33 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 09:51:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 09:51:49 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 09:51:51 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 09:51:55 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 09:52:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.590
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.593
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.597
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.597
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.215
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.165
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.146



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.894386
Original XAI WIoU for r=0.3 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6768, device='cuda:1')  +-  tensor(0.3280, device='cuda:1') (0.047296538949012756)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.323409
Original XAI WIoU for r=0.6 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6768, device='cuda:1')  +-  tensor(0.3280, device='cuda:1') (0.04729663208127022)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.677546
Original XAI WIoU for r=0.9 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6768, device='cuda:1')  +-  tensor(0.3280, device='cuda:1') (0.04729663208127022)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.035395
Original XAI WIoU for r=0.3 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6779, device='cuda:1')  +-  tensor(0.3297, device='cuda:1') (0.04648803547024727)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.652764
Original XAI WIoU for r=0.6 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6779, device='cuda:1')  +-  tensor(0.3297, device='cuda:1') (0.04648803547024727)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.324736
Original XAI WIoU for r=0.9 =  tensor(0.5958, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6779, device='cuda:1')  +-  tensor(0.3297, device='cuda:1') (0.04648803547024727)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.543089
Original XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4325, device='cuda:1')  +-  tensor(0.3174, device='cuda:1') (0.05871583893895149)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.593919
Original XAI WIoU for r=0.6 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4325, device='cuda:1')  +-  tensor(0.3174, device='cuda:1') (0.05871583893895149)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.512029
Original XAI WIoU for r=0.9 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4325, device='cuda:1')  +-  tensor(0.3174, device='cuda:1') (0.05871583893895149)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.468083
Original XAI WIoU for r=0.3 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2081, device='cuda:1')  +-  tensor(0.1411, device='cuda:1') (0.03201762214303017)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.544059
Original XAI WIoU for r=0.6 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2081, device='cuda:1')  +-  tensor(0.1411, device='cuda:1') (0.03201762214303017)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.491115
Original XAI WIoU for r=0.9 =  tensor(0.1424, device='cuda:1')  +-  tensor(0.0973, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2081, device='cuda:1')  +-  tensor(0.1411, device='cuda:1') (0.03201762214303017)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 22:00:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:18 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:30 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:32 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:34 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:37 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:00:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.367
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.408
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.365
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.377
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.415
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.312
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.315
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.320
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.256
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.262
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.263



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.072050
Original XAI WIoU for r=0.3 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4461, device='cuda:1')  +-  tensor(0.2823, device='cuda:1') (0.04553020000457764)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.083506
Original XAI WIoU for r=0.6 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4461, device='cuda:1')  +-  tensor(0.2823, device='cuda:1') (0.04553020000457764)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.039214
Original XAI WIoU for r=0.9 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4461, device='cuda:1')  +-  tensor(0.2823, device='cuda:1') (0.04553020000457764)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.294241
Original XAI WIoU for r=0.3 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4496, device='cuda:1')  +-  tensor(0.2847, device='cuda:1') (0.04504300281405449)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.102011
Original XAI WIoU for r=0.6 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4496, device='cuda:1')  +-  tensor(0.2847, device='cuda:1') (0.04504300281405449)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.066300
Original XAI WIoU for r=0.9 =  tensor(0.4179, device='cuda:1')  +-  tensor(0.2355, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4496, device='cuda:1')  +-  tensor(0.2847, device='cuda:1') (0.04504300281405449)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.508061
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3248, device='cuda:1')  +-  tensor(0.3248, device='cuda:1') (0.029907185584306717)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.412875
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3248, device='cuda:1')  +-  tensor(0.3248, device='cuda:1') (0.029907185584306717)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.568721
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3248, device='cuda:1')  +-  tensor(0.3248, device='cuda:1') (0.029907185584306717)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.495280
Original XAI WIoU for r=0.3 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2756, device='cuda:1')  +-  tensor(0.3783, device='cuda:1') (0.013598647899925709)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.572099
Original XAI WIoU for r=0.6 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2756, device='cuda:1')  +-  tensor(0.3783, device='cuda:1') (0.013598647899925709)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.659580
Original XAI WIoU for r=0.9 =  tensor(0.2679, device='cuda:1')  +-  tensor(0.3829, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2756, device='cuda:1')  +-  tensor(0.3783, device='cuda:1') (0.013598647899925709)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 22:07:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 10:07:43 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 10:07:55 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 10:07:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 10:07:59 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:02 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/05/2024 10:08:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.313
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.395
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.251
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.322
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.402
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.280
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.237
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.266
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.252
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.244



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.086599
Original XAI WIoU for r=0.3 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5392, device='cuda:1')  +-  tensor(0.3027, device='cuda:1') (0.05277547612786293)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.374444
Original XAI WIoU for r=0.6 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5392, device='cuda:1')  +-  tensor(0.3027, device='cuda:1') (0.05277547612786293)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.059825
Original XAI WIoU for r=0.9 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5392, device='cuda:1')  +-  tensor(0.3027, device='cuda:1') (0.05277547612786293)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.142189
Original XAI WIoU for r=0.3 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5419, device='cuda:1')  +-  tensor(0.3043, device='cuda:1') (0.05136820301413536)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.025342
Original XAI WIoU for r=0.6 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5419, device='cuda:1')  +-  tensor(0.3043, device='cuda:1') (0.05136820301413536)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.842280
Original XAI WIoU for r=0.9 =  tensor(0.4036, device='cuda:1')  +-  tensor(0.2112, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5419, device='cuda:1')  +-  tensor(0.3043, device='cuda:1') (0.05136820301413536)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.880271
Original XAI WIoU for r=0.3 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2419, device='cuda:1')  +-  tensor(0.1522, device='cuda:1') (0.02645103633403778)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.528339
Original XAI WIoU for r=0.6 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2419, device='cuda:1')  +-  tensor(0.1522, device='cuda:1') (0.02645103633403778)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.651747
Original XAI WIoU for r=0.9 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2419, device='cuda:1')  +-  tensor(0.1522, device='cuda:1') (0.02645103633403778)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.718217
Original XAI WIoU for r=0.3 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1572, device='cuda:1')  +-  tensor(0.1383, device='cuda:1') (0.011012439616024494)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.558631
Original XAI WIoU for r=0.6 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1572, device='cuda:1')  +-  tensor(0.1383, device='cuda:1') (0.011012439616024494)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.586621
Original XAI WIoU for r=0.9 =  tensor(0.2428, device='cuda:1')  +-  tensor(0.3044, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1572, device='cuda:1')  +-  tensor(0.1383, device='cuda:1') (0.011012439616024494)
len(reference) = 3000


DONE GOODMotif - LECIvGIN
(id) id_val WIOU_ORIGINAL: 	[0.44761314 0.44761314 0.44761314] +- [0.07279325 0.07279325 0.07279325] (mean across ratios: 0.44761313796043395)
(id) id_val WIOU_PERTURBED: 	[0.55148935 0.55148934 0.55148937] +- [0.07349407 0.07349405 0.07349405] (mean across ratios: 0.5514893531799316)
(id) id_test WIOU_ORIGINAL: 	[0.45311112 0.45311112 0.45311112] +- [0.07175872 0.07175872 0.07175872] (mean across ratios: 0.45311111807823173)
(id) id_test WIOU_PERTURBED: 	[0.5533437  0.55334371 0.5533437 ] +- [0.07274636 0.07274636 0.07274636] (mean across ratios: 0.5533436993757884)
(id) val WIOU_ORIGINAL: 	[0.30000614 0.30000614 0.30000614] +- [0.08320276 0.08320276 0.08320276] (mean across ratios: 0.3000061362981796)
(id) val WIOU_PERTURBED: 	[0.32260382 0.32260383 0.3226038 ] +- [0.06436379 0.06436377 0.06436378] (mean across ratios: 0.32260381579399106)
(id) test WIOU_ORIGINAL: 	[0.20151746 0.20151746 0.20151746] +- [0.08016272 0.08016272 0.08016272] (mean across ratios: 0.20151746422052383)
(id) test WIOU_PERTURBED: 	[0.18115516 0.18115517 0.18115514] +- [0.05620102 0.05620101 0.05620103] (mean across ratios: 0.181155156592528)
DONE LECI GOODMotif/size 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 22:15:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 10:15:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 10:15:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 10:15:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 10:15:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 10:15:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 10:16:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.533
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.436
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.531
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.536
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.342
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.353
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.361
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.277
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.282
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.289



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.741340
Original XAI WIoU for r=0.3 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6153, device='cuda:1')  +-  tensor(0.3194, device='cuda:1') (0.05978367477655411)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.895577
Original XAI WIoU for r=0.6 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6153, device='cuda:1')  +-  tensor(0.3194, device='cuda:1') (0.05978367477655411)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.648683
Original XAI WIoU for r=0.9 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6153, device='cuda:1')  +-  tensor(0.3194, device='cuda:1') (0.05978367477655411)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.741343
Original XAI WIoU for r=0.3 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6149, device='cuda:1')  +-  tensor(0.3241, device='cuda:1') (0.05660603940486908)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.448639
Original XAI WIoU for r=0.6 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6149, device='cuda:1')  +-  tensor(0.3241, device='cuda:1') (0.05660603940486908)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.654737
Original XAI WIoU for r=0.9 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6149, device='cuda:1')  +-  tensor(0.3241, device='cuda:1') (0.05660603940486908)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.857258
Original XAI WIoU for r=0.3 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3924, device='cuda:1')  +-  tensor(0.3498, device='cuda:1') (0.039912521839141846)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.577049
Original XAI WIoU for r=0.6 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3924, device='cuda:1')  +-  tensor(0.3498, device='cuda:1') (0.039912521839141846)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.116178
Original XAI WIoU for r=0.9 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3924, device='cuda:1')  +-  tensor(0.3498, device='cuda:1') (0.039912573993206024)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.305507
Original XAI WIoU for r=0.3 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2953, device='cuda:1')  +-  tensor(0.3737, device='cuda:1') (0.016363751143217087)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.285378
Original XAI WIoU for r=0.6 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2953, device='cuda:1')  +-  tensor(0.3737, device='cuda:1') (0.016363751143217087)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.185912
Original XAI WIoU for r=0.9 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2953, device='cuda:1')  +-  tensor(0.3737, device='cuda:1') (0.016363751143217087)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 22:22:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:33 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:45 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:48 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:52 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 10:22:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.417
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.513
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.411
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.515
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.342
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.352
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.357
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.275
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.282
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.905861
Original XAI WIoU for r=0.3 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5752, device='cuda:1')  +-  tensor(0.3139, device='cuda:1') (0.05728151276707649)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.736501
Original XAI WIoU for r=0.6 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5752, device='cuda:1')  +-  tensor(0.3139, device='cuda:1') (0.05728151276707649)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.663769
Original XAI WIoU for r=0.9 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5752, device='cuda:1')  +-  tensor(0.3139, device='cuda:1') (0.05728151276707649)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.642148
Original XAI WIoU for r=0.3 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5765, device='cuda:1')  +-  tensor(0.3190, device='cuda:1') (0.05501684546470642)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.652073
Original XAI WIoU for r=0.6 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5765, device='cuda:1')  +-  tensor(0.3190, device='cuda:1') (0.05501684546470642)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.788603
Original XAI WIoU for r=0.9 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5765, device='cuda:1')  +-  tensor(0.3190, device='cuda:1') (0.05501684546470642)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.837553
Original XAI WIoU for r=0.3 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3643, device='cuda:1')  +-  tensor(0.3456, device='cuda:1') (0.03247528895735741)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.067978
Original XAI WIoU for r=0.6 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3643, device='cuda:1')  +-  tensor(0.3456, device='cuda:1') (0.03247528895735741)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.790721
Original XAI WIoU for r=0.9 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3643, device='cuda:1')  +-  tensor(0.3456, device='cuda:1') (0.03247528895735741)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.452165
Original XAI WIoU for r=0.3 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2829, device='cuda:1')  +-  tensor(0.3769, device='cuda:1') (0.013012594543397427)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.204378
Original XAI WIoU for r=0.6 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2829, device='cuda:1')  +-  tensor(0.3769, device='cuda:1') (0.013012594543397427)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.287974
Original XAI WIoU for r=0.9 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2829, device='cuda:1')  +-  tensor(0.3769, device='cuda:1') (0.013012594543397427)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 22:29:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:23 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:37 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:39 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:42 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 10:29:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.461
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.513
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.518
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.456
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.516
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.522
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.355
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.354
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.359
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.282
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.284
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.707014
Original XAI WIoU for r=0.3 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5883, device='cuda:1')  +-  tensor(0.3154, device='cuda:1') (0.06374723464250565)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.660409
Original XAI WIoU for r=0.6 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5883, device='cuda:1')  +-  tensor(0.3154, device='cuda:1') (0.06374723464250565)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.055824
Original XAI WIoU for r=0.9 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5883, device='cuda:1')  +-  tensor(0.3154, device='cuda:1') (0.06374723464250565)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.632231
Original XAI WIoU for r=0.3 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5891, device='cuda:1')  +-  tensor(0.3199, device='cuda:1') (0.059594735503196716)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.627100
Original XAI WIoU for r=0.6 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5891, device='cuda:1')  +-  tensor(0.3199, device='cuda:1') (0.059594735503196716)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.443325
Original XAI WIoU for r=0.9 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5891, device='cuda:1')  +-  tensor(0.3199, device='cuda:1') (0.059594735503196716)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.029091
Original XAI WIoU for r=0.3 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3747, device='cuda:1')  +-  tensor(0.3468, device='cuda:1') (0.03800053521990776)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.787756
Original XAI WIoU for r=0.6 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3747, device='cuda:1')  +-  tensor(0.3468, device='cuda:1') (0.038000550121068954)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.026946
Original XAI WIoU for r=0.9 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3747, device='cuda:1')  +-  tensor(0.3468, device='cuda:1') (0.03800048679113388)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.185036
Original XAI WIoU for r=0.3 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2872, device='cuda:1')  +-  tensor(0.3756, device='cuda:1') (0.014303027652204037)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.442495
Original XAI WIoU for r=0.6 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2872, device='cuda:1')  +-  tensor(0.3756, device='cuda:1') (0.014303027652204037)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.166074
Original XAI WIoU for r=0.9 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2872, device='cuda:1')  +-  tensor(0.3756, device='cuda:1') (0.014303027652204037)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 22:36:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:16 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:28 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:30 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:32 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:36 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 10:36:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.511
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.581
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.576
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.517
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.586
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.583
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.438
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.417
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.513
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.495
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.491



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.670818
Original XAI WIoU for r=0.3 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5807, device='cuda:1')  +-  tensor(0.3056, device='cuda:1') (0.06311044096946716)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.404391
Original XAI WIoU for r=0.6 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5807, device='cuda:1')  +-  tensor(0.3056, device='cuda:1') (0.06311044096946716)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.667428
Original XAI WIoU for r=0.9 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5807, device='cuda:1')  +-  tensor(0.3056, device='cuda:1') (0.06311044096946716)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.700619
Original XAI WIoU for r=0.3 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5900, device='cuda:1')  +-  tensor(0.3071, device='cuda:1') (0.06141462177038193)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.938833
Original XAI WIoU for r=0.6 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5900, device='cuda:1')  +-  tensor(0.3071, device='cuda:1') (0.06141462177038193)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.696561
Original XAI WIoU for r=0.9 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5900, device='cuda:1')  +-  tensor(0.3071, device='cuda:1') (0.06141462177038193)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.851907
Original XAI WIoU for r=0.3 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3821, device='cuda:1')  +-  tensor(0.3284, device='cuda:1') (0.03343050926923752)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.040798
Original XAI WIoU for r=0.6 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3821, device='cuda:1')  +-  tensor(0.3284, device='cuda:1') (0.03343050926923752)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.795095
Original XAI WIoU for r=0.9 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3821, device='cuda:1')  +-  tensor(0.3284, device='cuda:1') (0.03343050926923752)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.220003
Original XAI WIoU for r=0.3 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3814, device='cuda:1')  +-  tensor(0.3613, device='cuda:1') (0.036059971898794174)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.419201
Original XAI WIoU for r=0.6 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3814, device='cuda:1')  +-  tensor(0.3613, device='cuda:1') (0.036059971898794174)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.161614
Original XAI WIoU for r=0.9 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3814, device='cuda:1')  +-  tensor(0.3613, device='cuda:1') (0.036059971898794174)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 22:43:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:09 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:21 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:25 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:28 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 10:43:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.587
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.707
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.717
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.716
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.727
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.610
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.581
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.578
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.380
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.365
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.362



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.975503
Original XAI WIoU for r=0.3 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6810, device='cuda:1')  +-  tensor(0.3203, device='cuda:1') (0.06173447519540787)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.682564
Original XAI WIoU for r=0.6 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6810, device='cuda:1')  +-  tensor(0.3203, device='cuda:1') (0.06173447519540787)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.677960
Original XAI WIoU for r=0.9 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6810, device='cuda:1')  +-  tensor(0.3203, device='cuda:1') (0.06173447519540787)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.055866
Original XAI WIoU for r=0.3 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6854, device='cuda:1')  +-  tensor(0.3212, device='cuda:1') (0.06063971295952797)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.813333
Original XAI WIoU for r=0.6 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6854, device='cuda:1')  +-  tensor(0.3212, device='cuda:1') (0.06063971295952797)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.474720
Original XAI WIoU for r=0.9 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6854, device='cuda:1')  +-  tensor(0.3212, device='cuda:1') (0.06063971295952797)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.042485
Original XAI WIoU for r=0.3 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4794, device='cuda:1')  +-  tensor(0.3407, device='cuda:1') (0.07117737829685211)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.871308
Original XAI WIoU for r=0.6 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4794, device='cuda:1')  +-  tensor(0.3407, device='cuda:1') (0.0711774006485939)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.045149
Original XAI WIoU for r=0.9 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4794, device='cuda:1')  +-  tensor(0.3407, device='cuda:1') (0.07117737829685211)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.326338
Original XAI WIoU for r=0.3 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3408, device='cuda:1')  +-  tensor(0.3602, device='cuda:1') (0.027984419837594032)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.269661
Original XAI WIoU for r=0.6 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3408, device='cuda:1')  +-  tensor(0.3602, device='cuda:1') (0.027984419837594032)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.499817
Original XAI WIoU for r=0.9 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3408, device='cuda:1')  +-  tensor(0.3602, device='cuda:1') (0.027984419837594032)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.57071018 0.57071018 0.57071018] +- [0.0766256 0.0766256 0.0766256] (mean across ratios: 0.5707101821899414)
(id) id_val WIOU_PERTURBED: 	[0.60808679 0.60808679 0.60808679] +- [0.03895346 0.03895346 0.03895346] (mean across ratios: 0.6080867886543274)
(id) id_test WIOU_ORIGINAL: 	[0.57590812 0.57590812 0.57590812] +- [0.07943805 0.07943805 0.07943805] (mean across ratios: 0.5759081244468689)
(id) id_test WIOU_PERTURBED: 	[0.61116408 0.61116408 0.61116408] +- [0.0391509 0.0391509 0.0391509] (mean across ratios: 0.6111640810966492)
(id) val WIOU_ORIGINAL: 	[0.41252714 0.41252714 0.41252714] +- [0.08479544 0.08479544 0.08479544] (mean across ratios: 0.4125271439552307)
(id) val WIOU_PERTURBED: 	[0.3985823  0.39858232 0.39858234] +- [0.04143414 0.04143408 0.04143412] (mean across ratios: 0.3985823214054108)
(id) test WIOU_ORIGINAL: 	[0.34305007 0.34305013 0.34305   ] +- [0.07925067 0.07925079 0.07925054] (mean across ratios: 0.3430500686168671)
(id) test WIOU_PERTURBED: 	[0.31751836 0.31751836 0.31751836] +- [0.0380202 0.0380202 0.0380202] (mean across ratios: 0.3175183594226837)
DONE CIGA GOODMotif/size 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 22:50:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:48 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 10:50:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.533
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.436
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.531
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.536
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.342
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.353
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.361
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.277
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.282
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.289



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.682041
Original XAI WIoU for r=0.3 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6483, device='cuda:1')  +-  tensor(0.3232, device='cuda:1') (0.06211187317967415)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.637006
Original XAI WIoU for r=0.6 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6483, device='cuda:1')  +-  tensor(0.3232, device='cuda:1') (0.06211187317967415)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.848309
Original XAI WIoU for r=0.9 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6483, device='cuda:1')  +-  tensor(0.3232, device='cuda:1') (0.06211187317967415)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.690621
Original XAI WIoU for r=0.3 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6469, device='cuda:1')  +-  tensor(0.3262, device='cuda:1') (0.06025011092424393)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.646438
Original XAI WIoU for r=0.6 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6469, device='cuda:1')  +-  tensor(0.3262, device='cuda:1') (0.06025011092424393)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.645576
Original XAI WIoU for r=0.9 =  tensor(0.5353, device='cuda:1')  +-  tensor(0.3186, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6469, device='cuda:1')  +-  tensor(0.3262, device='cuda:1') (0.06025011092424393)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.049944
Original XAI WIoU for r=0.3 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4316, device='cuda:1')  +-  tensor(0.3601, device='cuda:1') (0.04842105507850647)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.773742
Original XAI WIoU for r=0.6 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4316, device='cuda:1')  +-  tensor(0.3601, device='cuda:1') (0.04842105507850647)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.781516
Original XAI WIoU for r=0.9 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4316, device='cuda:1')  +-  tensor(0.3601, device='cuda:1') (0.04842105507850647)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.164348
Original XAI WIoU for r=0.3 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3091, device='cuda:1')  +-  tensor(0.3686, device='cuda:1') (0.02252776548266411)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.205146
Original XAI WIoU for r=0.6 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3091, device='cuda:1')  +-  tensor(0.3686, device='cuda:1') (0.02252776548266411)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.354421
Original XAI WIoU for r=0.9 =  tensor(0.2893, device='cuda:1')  +-  tensor(0.3779, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3091, device='cuda:1')  +-  tensor(0.3686, device='cuda:1') (0.02252776548266411)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 22:57:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:17 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:28 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:30 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:32 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:35 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 10:57:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.417
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.513
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.411
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.515
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.341
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.352
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.357
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.275
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.282
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.939030
Original XAI WIoU for r=0.3 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6045, device='cuda:1')  +-  tensor(0.3185, device='cuda:1') (0.06271574646234512)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.599733
Original XAI WIoU for r=0.6 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6045, device='cuda:1')  +-  tensor(0.3185, device='cuda:1') (0.06271574646234512)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.629666
Original XAI WIoU for r=0.9 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6045, device='cuda:1')  +-  tensor(0.3185, device='cuda:1') (0.06271574646234512)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.586297
Original XAI WIoU for r=0.3 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6050, device='cuda:1')  +-  tensor(0.3221, device='cuda:1') (0.060189057141542435)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.810031
Original XAI WIoU for r=0.6 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6050, device='cuda:1')  +-  tensor(0.3221, device='cuda:1') (0.060189057141542435)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.632642
Original XAI WIoU for r=0.9 =  tensor(0.5142, device='cuda:1')  +-  tensor(0.3120, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6050, device='cuda:1')  +-  tensor(0.3221, device='cuda:1') (0.060189057141542435)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.962076
Original XAI WIoU for r=0.3 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3874, device='cuda:1')  +-  tensor(0.3486, device='cuda:1') (0.03961921110749245)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.732859
Original XAI WIoU for r=0.6 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3874, device='cuda:1')  +-  tensor(0.3486, device='cuda:1') (0.03961921110749245)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.817878
Original XAI WIoU for r=0.9 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3874, device='cuda:1')  +-  tensor(0.3486, device='cuda:1') (0.03961921110749245)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.514206
Original XAI WIoU for r=0.3 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2872, device='cuda:1')  +-  tensor(0.3744, device='cuda:1') (0.015647485852241516)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.126012
Original XAI WIoU for r=0.6 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2872, device='cuda:1')  +-  tensor(0.3744, device='cuda:1') (0.015647387132048607)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.134446
Original XAI WIoU for r=0.9 =  tensor(0.2865, device='cuda:1')  +-  tensor(0.3781, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2872, device='cuda:1')  +-  tensor(0.3744, device='cuda:1') (0.015647485852241516)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 23:04:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:01 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:14 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:16 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:19 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 11:04:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.461
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.513
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.518
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.456
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.516
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.522
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.355
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.354
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.359
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.282
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.284
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.287



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.842509
Original XAI WIoU for r=0.3 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6206, device='cuda:1')  +-  tensor(0.3225, device='cuda:1') (0.06773790717124939)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.597518
Original XAI WIoU for r=0.6 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6206, device='cuda:1')  +-  tensor(0.3225, device='cuda:1') (0.06773790717124939)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.614680
Original XAI WIoU for r=0.9 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6206, device='cuda:1')  +-  tensor(0.3225, device='cuda:1') (0.06773790717124939)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.600831
Original XAI WIoU for r=0.3 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6218, device='cuda:1')  +-  tensor(0.3244, device='cuda:1') (0.06483270227909088)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.348584
Original XAI WIoU for r=0.6 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6218, device='cuda:1')  +-  tensor(0.3244, device='cuda:1') (0.06483270227909088)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.588176
Original XAI WIoU for r=0.9 =  tensor(0.5209, device='cuda:1')  +-  tensor(0.3129, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6218, device='cuda:1')  +-  tensor(0.3244, device='cuda:1') (0.06483270227909088)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.774634
Original XAI WIoU for r=0.3 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4012, device='cuda:1')  +-  tensor(0.3517, device='cuda:1') (0.04688509926199913)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.983199
Original XAI WIoU for r=0.6 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4012, device='cuda:1')  +-  tensor(0.3517, device='cuda:1') (0.04688509926199913)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.744154
Original XAI WIoU for r=0.9 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4012, device='cuda:1')  +-  tensor(0.3517, device='cuda:1') (0.046885132789611816)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.405457
Original XAI WIoU for r=0.3 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2927, device='cuda:1')  +-  tensor(0.3727, device='cuda:1') (0.01750810816884041)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.114483
Original XAI WIoU for r=0.6 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2927, device='cuda:1')  +-  tensor(0.3727, device='cuda:1') (0.01750810816884041)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.866599
Original XAI WIoU for r=0.9 =  tensor(0.2870, device='cuda:1')  +-  tensor(0.3778, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2927, device='cuda:1')  +-  tensor(0.3727, device='cuda:1') (0.01750810816884041)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 23:10:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 11:10:45 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 11:10:57 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 11:10:59 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:01 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:04 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 11:11:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.511
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.581
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.576
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.517
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.586
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.583
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.438
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.417
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.513
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.495
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.491



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.722207
Original XAI WIoU for r=0.3 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5971, device='cuda:1')  +-  tensor(0.3206, device='cuda:1') (0.06447730213403702)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.009482
Original XAI WIoU for r=0.6 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5971, device='cuda:1')  +-  tensor(0.3206, device='cuda:1') (0.06447730213403702)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.622691
Original XAI WIoU for r=0.9 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5971, device='cuda:1')  +-  tensor(0.3206, device='cuda:1') (0.06447730213403702)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.623666
Original XAI WIoU for r=0.3 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6037, device='cuda:1')  +-  tensor(0.3203, device='cuda:1') (0.06456887722015381)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.868987
Original XAI WIoU for r=0.6 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6037, device='cuda:1')  +-  tensor(0.3203, device='cuda:1') (0.06456887722015381)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.752760
Original XAI WIoU for r=0.9 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2737, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6037, device='cuda:1')  +-  tensor(0.3203, device='cuda:1') (0.06456887722015381)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.984959
Original XAI WIoU for r=0.3 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3977, device='cuda:1')  +-  tensor(0.3374, device='cuda:1') (0.04439239576458931)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.742579
Original XAI WIoU for r=0.6 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3977, device='cuda:1')  +-  tensor(0.3374, device='cuda:1') (0.04439239576458931)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.784475
Original XAI WIoU for r=0.9 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3977, device='cuda:1')  +-  tensor(0.3374, device='cuda:1') (0.04439239576458931)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.136255
Original XAI WIoU for r=0.3 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3495, device='cuda:1')  +-  tensor(0.3538, device='cuda:1') (0.03419199958443642)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.145478
Original XAI WIoU for r=0.6 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3495, device='cuda:1')  +-  tensor(0.3538, device='cuda:1') (0.03419199958443642)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.364271
Original XAI WIoU for r=0.9 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3602, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3495, device='cuda:1')  +-  tensor(0.3538, device='cuda:1') (0.03419199958443642)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 23:17:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 11:17:38 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 11:17:49 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 11:17:51 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 11:17:53 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 11:17:56 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/05/2024 11:18:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.587
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.707
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.717
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.716
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.727
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.611
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.581
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.578
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.380
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.365
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.362



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.609522
Original XAI WIoU for r=0.3 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6941, device='cuda:1')  +-  tensor(0.3360, device='cuda:1') (0.052891362458467484)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.671005
Original XAI WIoU for r=0.6 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6941, device='cuda:1')  +-  tensor(0.3360, device='cuda:1') (0.052891362458467484)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.383390
Original XAI WIoU for r=0.9 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6941, device='cuda:1')  +-  tensor(0.3360, device='cuda:1') (0.052891362458467484)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.999217
Original XAI WIoU for r=0.3 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6959, device='cuda:1')  +-  tensor(0.3372, device='cuda:1') (0.05297542363405228)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.606224
Original XAI WIoU for r=0.6 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6959, device='cuda:1')  +-  tensor(0.3372, device='cuda:1') (0.05297542363405228)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.957213
Original XAI WIoU for r=0.9 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2684, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6959, device='cuda:1')  +-  tensor(0.3372, device='cuda:1') (0.05297542363405228)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.738770
Original XAI WIoU for r=0.3 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5190, device='cuda:1')  +-  tensor(0.3779, device='cuda:1') (0.06468108296394348)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.751193
Original XAI WIoU for r=0.6 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5190, device='cuda:1')  +-  tensor(0.3779, device='cuda:1') (0.06468108296394348)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.744725
Original XAI WIoU for r=0.9 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5190, device='cuda:1')  +-  tensor(0.3779, device='cuda:1') (0.06468108296394348)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.117759
Original XAI WIoU for r=0.3 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3793, device='cuda:1')  +-  tensor(0.3635, device='cuda:1') (0.04747792333364487)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.326087
Original XAI WIoU for r=0.6 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3793, device='cuda:1')  +-  tensor(0.3635, device='cuda:1') (0.04747800529003143)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.097184
Original XAI WIoU for r=0.9 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.3461, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3793, device='cuda:1')  +-  tensor(0.3635, device='cuda:1') (0.04747800529003143)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val WIOU_ORIGINAL: 	[0.57071018 0.57071018 0.57071018] +- [0.0766256 0.0766256 0.0766256] (mean across ratios: 0.5707101821899414)
(id) id_val WIOU_PERTURBED: 	[0.63292339 0.63292339 0.63292338] +- [0.03525635 0.03525635 0.03525635] (mean across ratios: 0.6329233845074972)
(id) id_test WIOU_ORIGINAL: 	[0.57590805 0.57590805 0.57590805] +- [0.07943791 0.07943791 0.07943791] (mean across ratios: 0.5759080529212952)
(id) id_test WIOU_PERTURBED: 	[0.63466805 0.63466805 0.63466805] +- [0.03434111 0.03434111 0.03434111] (mean across ratios: 0.6346680521965027)
(id) val WIOU_ORIGINAL: 	[0.41252714 0.41252714 0.41252714] +- [0.08479544 0.08479544 0.08479544] (mean across ratios: 0.4125271439552307)
(id) val WIOU_PERTURBED: 	[0.42738701 0.42738701 0.42738699] +- [0.04812281 0.04812281 0.04812282] (mean across ratios: 0.427386999130249)
(id) test WIOU_ORIGINAL: 	[0.34305021 0.34305013 0.34305007] +- [0.07925093 0.07925079 0.07925067] (mean across ratios: 0.34305013815561924)
(id) test WIOU_PERTURBED: 	[0.32356106 0.32356106 0.32356105] +- [0.03541659 0.03541656 0.03541657] (mean across ratios: 0.3235610564549764)
DONE CIGA GOODMotif/size 0.08

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 23:24:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 11:24:53 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:07 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:09 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:13 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 11:25:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.626
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.412
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.172
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.237054
Original XAI WIoU for r=0.3 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4437, device='cuda:1')  +-  tensor(0.2364, device='cuda:1') (0.007021850440651178)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.411197
Original XAI WIoU for r=0.6 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4437, device='cuda:1')  +-  tensor(0.2364, device='cuda:1') (0.007021850440651178)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.173166
Original XAI WIoU for r=0.9 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4437, device='cuda:1')  +-  tensor(0.2364, device='cuda:1') (0.007021850440651178)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.256516
Original XAI WIoU for r=0.3 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4461, device='cuda:1')  +-  tensor(0.2391, device='cuda:1') (0.006792840082198381)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.888403
Original XAI WIoU for r=0.6 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4461, device='cuda:1')  +-  tensor(0.2391, device='cuda:1') (0.006792840082198381)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.400676
Original XAI WIoU for r=0.9 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4461, device='cuda:1')  +-  tensor(0.2391, device='cuda:1') (0.006792840082198381)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.947509
Original XAI WIoU for r=0.3 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1819, device='cuda:1')  +-  tensor(0.0981, device='cuda:1') (0.0030778266955167055)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.102920
Original XAI WIoU for r=0.6 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1819, device='cuda:1')  +-  tensor(0.0981, device='cuda:1') (0.0030778266955167055)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.781418
Original XAI WIoU for r=0.9 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1819, device='cuda:1')  +-  tensor(0.0981, device='cuda:1') (0.0030778266955167055)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.301677
Original XAI WIoU for r=0.3 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0765, device='cuda:1')  +-  tensor(0.0345, device='cuda:1') (0.0008256827131845057)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.027035
Original XAI WIoU for r=0.6 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0765, device='cuda:1')  +-  tensor(0.0345, device='cuda:1') (0.0008256827131845057)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.916328
Original XAI WIoU for r=0.9 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0765, device='cuda:1')  +-  tensor(0.0345, device='cuda:1') (0.0008256827131845057)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 23:31:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 11:31:57 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:09 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:11 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:13 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:16 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 11:32:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.397
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.608
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.528
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.401
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.240
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.168
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.202
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.108
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.139251
Original XAI WIoU for r=0.3 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4376, device='cuda:1')  +-  tensor(0.2342, device='cuda:1') (0.00536448834463954)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.104456
Original XAI WIoU for r=0.6 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4376, device='cuda:1')  +-  tensor(0.2342, device='cuda:1') (0.00536448834463954)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.867308
Original XAI WIoU for r=0.9 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4376, device='cuda:1')  +-  tensor(0.2342, device='cuda:1') (0.00536448834463954)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.423824
Original XAI WIoU for r=0.3 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4400, device='cuda:1')  +-  tensor(0.2370, device='cuda:1') (0.005196074955165386)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.286258
Original XAI WIoU for r=0.6 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4400, device='cuda:1')  +-  tensor(0.2370, device='cuda:1') (0.005196074955165386)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.112008
Original XAI WIoU for r=0.9 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4400, device='cuda:1')  +-  tensor(0.2370, device='cuda:1') (0.005196074955165386)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.749773
Original XAI WIoU for r=0.3 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1777, device='cuda:1')  +-  tensor(0.0953, device='cuda:1') (0.002234365325421095)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.730581
Original XAI WIoU for r=0.6 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1777, device='cuda:1')  +-  tensor(0.0953, device='cuda:1') (0.002234365325421095)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.698317
Original XAI WIoU for r=0.9 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1777, device='cuda:1')  +-  tensor(0.0953, device='cuda:1') (0.002234365325421095)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.086677
Original XAI WIoU for r=0.3 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0759, device='cuda:1')  +-  tensor(0.0344, device='cuda:1') (0.0006548023666255176)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.697843
Original XAI WIoU for r=0.6 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0759, device='cuda:1')  +-  tensor(0.0344, device='cuda:1') (0.0006548023666255176)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.924494
Original XAI WIoU for r=0.9 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0759, device='cuda:1')  +-  tensor(0.0344, device='cuda:1') (0.0006548023666255176)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 23:38:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 11:38:57 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:09 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:11 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:13 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:17 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 11:39:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.410
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.616
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.547
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.413
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.442
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.123170
Original XAI WIoU for r=0.3 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4413, device='cuda:1')  +-  tensor(0.2349, device='cuda:1') (0.005584282334893942)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.859543
Original XAI WIoU for r=0.6 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4413, device='cuda:1')  +-  tensor(0.2349, device='cuda:1') (0.005584282334893942)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.130274
Original XAI WIoU for r=0.9 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4413, device='cuda:1')  +-  tensor(0.2349, device='cuda:1') (0.005584282334893942)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.172618
Original XAI WIoU for r=0.3 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4440, device='cuda:1')  +-  tensor(0.2375, device='cuda:1') (0.005407906603068113)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.079720
Original XAI WIoU for r=0.6 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4440, device='cuda:1')  +-  tensor(0.2375, device='cuda:1') (0.005407850723713636)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.939992
Original XAI WIoU for r=0.9 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4440, device='cuda:1')  +-  tensor(0.2375, device='cuda:1') (0.005407906603068113)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.927044
Original XAI WIoU for r=0.3 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1795, device='cuda:1')  +-  tensor(0.0957, device='cuda:1') (0.0024146451614797115)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.707493
Original XAI WIoU for r=0.6 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1795, device='cuda:1')  +-  tensor(0.0957, device='cuda:1') (0.0024146451614797115)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.836826
Original XAI WIoU for r=0.9 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1795, device='cuda:1')  +-  tensor(0.0957, device='cuda:1') (0.0024146451614797115)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.320158
Original XAI WIoU for r=0.3 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0763, device='cuda:1')  +-  tensor(0.0343, device='cuda:1') (0.0006931782700121403)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.069172
Original XAI WIoU for r=0.6 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0763, device='cuda:1')  +-  tensor(0.0343, device='cuda:1') (0.0006931782700121403)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.149986
Original XAI WIoU for r=0.9 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0763, device='cuda:1')  +-  tensor(0.0343, device='cuda:1') (0.0006931782700121403)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 23:46:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:00 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:14 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:16 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:19 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 11:46:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.407
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.445
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.110
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.076



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.365919
Original XAI WIoU for r=0.3 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4393, device='cuda:1')  +-  tensor(0.2339, device='cuda:1') (0.006492401473224163)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.109353
Original XAI WIoU for r=0.6 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4393, device='cuda:1')  +-  tensor(0.2339, device='cuda:1') (0.0064924671314656734)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.353107
Original XAI WIoU for r=0.9 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4393, device='cuda:1')  +-  tensor(0.2339, device='cuda:1') (0.0064924671314656734)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.099797
Original XAI WIoU for r=0.3 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4418, device='cuda:1')  +-  tensor(0.2367, device='cuda:1') (0.006276508327573538)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.118656
Original XAI WIoU for r=0.6 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4418, device='cuda:1')  +-  tensor(0.2367, device='cuda:1') (0.006276508327573538)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.440875
Original XAI WIoU for r=0.9 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4418, device='cuda:1')  +-  tensor(0.2367, device='cuda:1') (0.006276508327573538)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.707786
Original XAI WIoU for r=0.3 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1795, device='cuda:1')  +-  tensor(0.0963, device='cuda:1') (0.0030842942651361227)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.769427
Original XAI WIoU for r=0.6 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1795, device='cuda:1')  +-  tensor(0.0963, device='cuda:1') (0.0030842942651361227)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.721336
Original XAI WIoU for r=0.9 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1795, device='cuda:1')  +-  tensor(0.0963, device='cuda:1') (0.0030842942651361227)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.132756
Original XAI WIoU for r=0.3 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0779, device='cuda:1')  +-  tensor(0.0359, device='cuda:1') (0.0008933955687098205)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.938452
Original XAI WIoU for r=0.6 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0779, device='cuda:1')  +-  tensor(0.0359, device='cuda:1') (0.0008933955687098205)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.921067
Original XAI WIoU for r=0.9 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0779, device='cuda:1')  +-  tensor(0.0359, device='cuda:1') (0.0008933955687098205)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Aug  5 23:53:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:16 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:18 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:21 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/05/2024 11:53:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.604
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.536
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.407
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.437
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.169
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.201
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.107
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.074



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.125618
Original XAI WIoU for r=0.3 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4398, device='cuda:1')  +-  tensor(0.2355, device='cuda:1') (0.005735419690608978)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.879321
Original XAI WIoU for r=0.6 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4398, device='cuda:1')  +-  tensor(0.2355, device='cuda:1') (0.005735389422625303)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.105678
Original XAI WIoU for r=0.9 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4398, device='cuda:1')  +-  tensor(0.2355, device='cuda:1') (0.005735389422625303)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.107424
Original XAI WIoU for r=0.3 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4421, device='cuda:1')  +-  tensor(0.2381, device='cuda:1') (0.0053024557419121265)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.104880
Original XAI WIoU for r=0.6 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4421, device='cuda:1')  +-  tensor(0.2381, device='cuda:1') (0.0053024557419121265)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.866044
Original XAI WIoU for r=0.9 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4421, device='cuda:1')  +-  tensor(0.2381, device='cuda:1') (0.0053024557419121265)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.919880
Original XAI WIoU for r=0.3 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1781, device='cuda:1')  +-  tensor(0.0964, device='cuda:1') (0.002761643612757325)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.780280
Original XAI WIoU for r=0.6 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1781, device='cuda:1')  +-  tensor(0.0964, device='cuda:1') (0.0027617402374744415)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.716083
Original XAI WIoU for r=0.9 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1781, device='cuda:1')  +-  tensor(0.0964, device='cuda:1') (0.0027617402374744415)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.198990
Original XAI WIoU for r=0.3 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0751, device='cuda:1')  +-  tensor(0.0338, device='cuda:1') (0.0008121926803141832)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.967376
Original XAI WIoU for r=0.6 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0751, device='cuda:1')  +-  tensor(0.0338, device='cuda:1') (0.0008121926803141832)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.044350
Original XAI WIoU for r=0.9 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0751, device='cuda:1')  +-  tensor(0.0338, device='cuda:1') (0.0008121926803141832)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.38347052 0.38347052 0.38347059] +- [0.00255777 0.00255777 0.00255775] (mean across ratios: 0.38347054322560625)
(id) id_val WIOU_PERTURBED: 	[0.44032762 0.44032762 0.44032762] +- [0.00204598 0.00204598 0.00204598] (mean across ratios: 0.44032762050628654)
(id) id_test WIOU_ORIGINAL: 	[0.38640491 0.38640491 0.38640491] +- [0.00261254 0.00261254 0.00261254] (mean across ratios: 0.3864049077033996)
(id) id_test WIOU_PERTURBED: 	[0.44280557 0.44280558 0.44280557] +- [0.00207005 0.00207006 0.00207005] (mean across ratios: 0.4428055723508199)
(id) val WIOU_ORIGINAL: 	[0.15535186 0.15535186 0.15535186] +- [0.00119181 0.00119181 0.00119181] (mean across ratios: 0.155351859331131)
(id) val WIOU_PERTURBED: 	[0.17934286 0.17934286 0.17934286] +- [0.0014878  0.00148781 0.00148781] (mean across ratios: 0.17934286097685495)
(id) test WIOU_ORIGINAL: 	[0.06810767 0.06810767 0.06810767] +- [0.00054001 0.00054001 0.00054001] (mean across ratios: 0.06810766607522964)
(id) test WIOU_PERTURBED: 	[0.07632021 0.07632021 0.07632021] +- [0.0008997 0.0008997 0.0008997] (mean across ratios: 0.0763202115893364)
DONE GSAT GOODMotif/size 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Aug  6 00:00:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:33 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:44 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:46 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:48 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:51 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/06/2024 12:00:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.626
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.412
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.172
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.940920
Original XAI WIoU for r=0.3 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4780, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.00711054215207696)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.125392
Original XAI WIoU for r=0.6 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4780, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.00711054215207696)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.843352
Original XAI WIoU for r=0.9 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4780, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.00711054215207696)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.907187
Original XAI WIoU for r=0.3 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4795, device='cuda:1')  +-  tensor(0.2648, device='cuda:1') (0.006985354702919722)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.641111
Original XAI WIoU for r=0.6 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4795, device='cuda:1')  +-  tensor(0.2648, device='cuda:1') (0.006985354702919722)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.829367
Original XAI WIoU for r=0.9 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.1916, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4795, device='cuda:1')  +-  tensor(0.2648, device='cuda:1') (0.006985354702919722)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.486398
Original XAI WIoU for r=0.3 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2033, device='cuda:1')  +-  tensor(0.1208, device='cuda:1') (0.003957404289394617)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.710628
Original XAI WIoU for r=0.6 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2033, device='cuda:1')  +-  tensor(0.1208, device='cuda:1') (0.003957404289394617)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.425249
Original XAI WIoU for r=0.9 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2033, device='cuda:1')  +-  tensor(0.1208, device='cuda:1') (0.003957404289394617)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:06.041446
Original XAI WIoU for r=0.3 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0859, device='cuda:1')  +-  tensor(0.0410, device='cuda:1') (0.0011013594921678305)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.586160
Original XAI WIoU for r=0.6 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0859, device='cuda:1')  +-  tensor(0.0410, device='cuda:1') (0.0011013594921678305)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.620725
Original XAI WIoU for r=0.9 =  tensor(0.0682, device='cuda:1')  +-  tensor(0.0281, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0859, device='cuda:1')  +-  tensor(0.0410, device='cuda:1') (0.0011013594921678305)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Aug  6 00:07:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:03 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:15 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:17 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:19 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:22 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/06/2024 12:07:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.397
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.608
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.528
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.401
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.240
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.168
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.202
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.108
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.907500
Original XAI WIoU for r=0.3 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4724, device='cuda:1')  +-  tensor(0.2618, device='cuda:1') (0.005361035466194153)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.001762
Original XAI WIoU for r=0.6 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4724, device='cuda:1')  +-  tensor(0.2618, device='cuda:1') (0.005361035466194153)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.619413
Original XAI WIoU for r=0.9 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4724, device='cuda:1')  +-  tensor(0.2618, device='cuda:1') (0.005361035466194153)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.094086
Original XAI WIoU for r=0.3 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4739, device='cuda:1')  +-  tensor(0.2631, device='cuda:1') (0.005232241936028004)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.890076
Original XAI WIoU for r=0.6 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4739, device='cuda:1')  +-  tensor(0.2631, device='cuda:1') (0.005232241936028004)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.606934
Original XAI WIoU for r=0.9 =  tensor(0.3827, device='cuda:1')  +-  tensor(0.1888, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4739, device='cuda:1')  +-  tensor(0.2631, device='cuda:1') (0.005232241936028004)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.696166
Original XAI WIoU for r=0.3 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1989, device='cuda:1')  +-  tensor(0.1173, device='cuda:1') (0.0026781149208545685)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.435877
Original XAI WIoU for r=0.6 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1989, device='cuda:1')  +-  tensor(0.1173, device='cuda:1') (0.0026781149208545685)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.406577
Original XAI WIoU for r=0.9 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1989, device='cuda:1')  +-  tensor(0.1173, device='cuda:1') (0.0026781149208545685)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.885596
Original XAI WIoU for r=0.3 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0852, device='cuda:1')  +-  tensor(0.0407, device='cuda:1') (0.0007762284367345273)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.591089
Original XAI WIoU for r=0.6 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0852, device='cuda:1')  +-  tensor(0.0407, device='cuda:1') (0.0007762284367345273)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.336901
Original XAI WIoU for r=0.9 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0288, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0852, device='cuda:1')  +-  tensor(0.0407, device='cuda:1') (0.0007763389148749411)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Aug  6 00:13:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:33 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:45 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:47 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:49 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/06/2024 12:13:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.410
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.616
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.547
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.413
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.442
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.204
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.109
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.075



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.837131
Original XAI WIoU for r=0.3 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4761, device='cuda:1')  +-  tensor(0.2625, device='cuda:1') (0.005626177415251732)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.897648
Original XAI WIoU for r=0.6 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4761, device='cuda:1')  +-  tensor(0.2625, device='cuda:1') (0.005626177415251732)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.053606
Original XAI WIoU for r=0.9 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4761, device='cuda:1')  +-  tensor(0.2625, device='cuda:1') (0.005626177415251732)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.813120
Original XAI WIoU for r=0.3 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4777, device='cuda:1')  +-  tensor(0.2637, device='cuda:1') (0.00554680498316884)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.825486
Original XAI WIoU for r=0.6 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4777, device='cuda:1')  +-  tensor(0.2637, device='cuda:1') (0.005546843633055687)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.820120
Original XAI WIoU for r=0.9 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4777, device='cuda:1')  +-  tensor(0.2637, device='cuda:1') (0.005546843633055687)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.396750
Original XAI WIoU for r=0.3 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2007, device='cuda:1')  +-  tensor(0.1180, device='cuda:1') (0.002826757961884141)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.640773
Original XAI WIoU for r=0.6 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2007, device='cuda:1')  +-  tensor(0.1180, device='cuda:1') (0.002826757961884141)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.383218
Original XAI WIoU for r=0.9 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2007, device='cuda:1')  +-  tensor(0.1180, device='cuda:1') (0.002826757961884141)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.613757
Original XAI WIoU for r=0.3 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0857, device='cuda:1')  +-  tensor(0.0408, device='cuda:1') (0.0008309699478559196)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.543687
Original XAI WIoU for r=0.6 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0857, device='cuda:1')  +-  tensor(0.0408, device='cuda:1') (0.0008309699478559196)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.537320
Original XAI WIoU for r=0.9 =  tensor(0.0680, device='cuda:1')  +-  tensor(0.0285, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0857, device='cuda:1')  +-  tensor(0.0408, device='cuda:1') (0.0008309699478559196)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Aug  6 00:20:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:03 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:15 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:17 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:19 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:22 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/06/2024 12:20:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.407
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.445
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.207
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.110
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.076



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.095201
Original XAI WIoU for r=0.3 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4742, device='cuda:1')  +-  tensor(0.2623, device='cuda:1') (0.006665417924523354)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.835659
Original XAI WIoU for r=0.6 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4742, device='cuda:1')  +-  tensor(0.2623, device='cuda:1') (0.006665417924523354)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.851280
Original XAI WIoU for r=0.9 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4742, device='cuda:1')  +-  tensor(0.2623, device='cuda:1') (0.006665417924523354)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.833501
Original XAI WIoU for r=0.3 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4757, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.006670754868537188)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.915717
Original XAI WIoU for r=0.6 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4757, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.006670754868537188)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.835898
Original XAI WIoU for r=0.9 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.1877, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4757, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.006670754868537188)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.392146
Original XAI WIoU for r=0.3 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.2002, device='cuda:1')  +-  tensor(0.1189, device='cuda:1') (0.003625777317211032)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.635057
Original XAI WIoU for r=0.6 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2002, device='cuda:1')  +-  tensor(0.1189, device='cuda:1') (0.003625777317211032)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.405706
Original XAI WIoU for r=0.9 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2002, device='cuda:1')  +-  tensor(0.1189, device='cuda:1') (0.003625777317211032)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.592682
Original XAI WIoU for r=0.3 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0871, device='cuda:1')  +-  tensor(0.0424, device='cuda:1') (0.0011006577406078577)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.628549
Original XAI WIoU for r=0.6 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0871, device='cuda:1')  +-  tensor(0.0424, device='cuda:1') (0.0011006577406078577)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.547286
Original XAI WIoU for r=0.9 =  tensor(0.0690, device='cuda:1')  +-  tensor(0.0291, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0871, device='cuda:1')  +-  tensor(0.0424, device='cuda:1') (0.0011006577406078577)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Aug  6 00:26:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:34 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:45 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:47 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:49 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/06/2024 12:26:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.604
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.536
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.407
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.437
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.169
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.201
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.107
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.074



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.077949
Original XAI WIoU for r=0.3 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4748, device='cuda:1')  +-  tensor(0.2632, device='cuda:1') (0.005922923795878887)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.842821
Original XAI WIoU for r=0.6 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4748, device='cuda:1')  +-  tensor(0.2632, device='cuda:1') (0.005922979209572077)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.857955
Original XAI WIoU for r=0.9 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4748, device='cuda:1')  +-  tensor(0.2632, device='cuda:1') (0.005922979209572077)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.951593
Original XAI WIoU for r=0.3 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4762, device='cuda:1')  +-  tensor(0.2645, device='cuda:1') (0.005842185113579035)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.923381
Original XAI WIoU for r=0.6 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4762, device='cuda:1')  +-  tensor(0.2645, device='cuda:1') (0.005842185113579035)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.847878
Original XAI WIoU for r=0.9 =  tensor(0.3854, device='cuda:1')  +-  tensor(0.1901, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4762, device='cuda:1')  +-  tensor(0.2645, device='cuda:1') (0.005842185113579035)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.394946
Original XAI WIoU for r=0.3 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.1995, device='cuda:1')  +-  tensor(0.1189, device='cuda:1') (0.003413480008020997)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.638901
Original XAI WIoU for r=0.6 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.1995, device='cuda:1')  +-  tensor(0.1189, device='cuda:1') (0.003413480008020997)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.418972
Original XAI WIoU for r=0.9 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1995, device='cuda:1')  +-  tensor(0.1189, device='cuda:1') (0.003413480008020997)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.595512
Original XAI WIoU for r=0.3 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.0843, device='cuda:1')  +-  tensor(0.0400, device='cuda:1') (0.0010371709940955043)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.585816
Original XAI WIoU for r=0.6 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.0843, device='cuda:1')  +-  tensor(0.0400, device='cuda:1') (0.0010371709940955043)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.542279
Original XAI WIoU for r=0.9 =  tensor(0.0673, device='cuda:1')  +-  tensor(0.0279, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.0843, device='cuda:1')  +-  tensor(0.0400, device='cuda:1') (0.0010371709940955043)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val WIOU_ORIGINAL: 	[0.38347059 0.38347052 0.38347059] +- [0.00255775 0.00255777 0.00255775] (mean across ratios: 0.38347056905428567)
(id) id_val WIOU_PERTURBED: 	[0.47511009 0.47511008 0.47511008] +- [0.00188467 0.00188467 0.00188467] (mean across ratios: 0.47511008183161413)
(id) id_test WIOU_ORIGINAL: 	[0.38640491 0.38640491 0.38640497] +- [0.00261254 0.00261254 0.00261251] (mean across ratios: 0.386404929558436)
(id) id_test WIOU_PERTURBED: 	[0.47660916 0.47660915 0.47660915] +- [0.00188315 0.00188315 0.00188315] (mean across ratios: 0.4766091505686442)
(id) val WIOU_ORIGINAL: 	[0.15535186 0.15535186 0.15535186] +- [0.00119181 0.00119181 0.00119181] (mean across ratios: 0.155351859331131)
(id) val WIOU_PERTURBED: 	[0.20051589 0.20051589 0.20051589] +- [0.00153114 0.00153114 0.00153114] (mean across ratios: 0.20051589012145996)
(id) test WIOU_ORIGINAL: 	[0.06810767 0.06810767 0.06810767] +- [0.00054001 0.00054001 0.00054001] (mean across ratios: 0.06810766607522964)
(id) test WIOU_PERTURBED: 	[0.08565398 0.08565398 0.08565397] +- [0.00090818 0.00090818 0.00090819] (mean across ratios: 0.08565398007631302)
DONE GSAT GOODMotif/size 0.08
DONE all :)
