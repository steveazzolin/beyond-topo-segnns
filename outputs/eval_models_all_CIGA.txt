Time to train models with hard masking!
The PID of this script is: 2265320

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:58:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.4515
Train Loss: 2.0116
ID Validation ACCURACY: 0.4543
ID Validation Loss: 2.0095
ID Test ACCURACY: 0.4537
ID Test Loss: 1.9627
OOD Validation ACCURACY: 0.3667
OOD Validation Loss: 1.7075
OOD Test ACCURACY: 0.4907
OOD Test Loss: 20.5069

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 0.3873
Train Loss: 2.8169
ID Validation ACCURACY: 0.4017
ID Validation Loss: 2.8787
ID Test ACCURACY: 0.3987
ID Test Loss: 2.7126
OOD Validation ACCURACY: 0.4830
OOD Validation Loss: 1.4196
OOD Test ACCURACY: 0.3533
OOD Test Loss: 4.9358

[0m[1;37mINFO[0m: [1mChartInfo 0.4537 0.4907 0.3987 0.3533 0.4017 0.4830[0mId_val ACCURACY: 0.4543Id_val Loss: 2.0095
Id_test ACCURACY: 0.4537Id_test Loss: 1.9628
Test ACCURACY: 0.4907Test Loss: 20.5069


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:58:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ACCURACY: 0.5550
Train Loss: 1.0486
ID Validation ACCURACY: 0.5667
ID Validation Loss: 1.0182
ID Test ACCURACY: 0.5497
ID Test Loss: 1.0586
OOD Validation ACCURACY: 0.2923
OOD Validation Loss: 1.8056
OOD Test ACCURACY: 0.3420
OOD Test Loss: 2.4359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.3756
Train Loss: 1.3215
ID Validation ACCURACY: 0.3880
ID Validation Loss: 1.2841
ID Test ACCURACY: 0.3630
ID Test Loss: 1.3120
OOD Validation ACCURACY: 0.4910
OOD Validation Loss: 1.0719
OOD Test ACCURACY: 0.4573
OOD Test Loss: 1.3658

[0m[1;37mINFO[0m: [1mChartInfo 0.5497 0.3420 0.3630 0.4573 0.3880 0.4910[0mId_val ACCURACY: 0.5667Id_val Loss: 1.0182
Id_test ACCURACY: 0.5497Id_test Loss: 1.0586
Test ACCURACY: 0.3420Test Loss: 2.4359


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:58:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.3922
Train Loss: 2.5243
ID Validation ACCURACY: 0.4000
ID Validation Loss: 2.6128
ID Test ACCURACY: 0.4023
ID Test Loss: 2.4780
OOD Validation ACCURACY: 0.3473
OOD Validation Loss: 1.5777
OOD Test ACCURACY: 0.4613
OOD Test Loss: 12.1111

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 105...
[0m[1;37mINFO[0m: [1mCheckpoint 105: 
-----------------------------------
Train ACCURACY: 0.3601
Train Loss: 2.8396
ID Validation ACCURACY: 0.3580
ID Validation Loss: 2.9725
ID Test ACCURACY: 0.3643
ID Test Loss: 2.7594
OOD Validation ACCURACY: 0.4673
OOD Validation Loss: 1.2057
OOD Test ACCURACY: 0.3347
OOD Test Loss: 10.3926

[0m[1;37mINFO[0m: [1mChartInfo 0.4023 0.4613 0.3643 0.3347 0.3580 0.4673[0mId_val ACCURACY: 0.4000Id_val Loss: 2.6128
Id_test ACCURACY: 0.4023Id_test Loss: 2.4779
Test ACCURACY: 0.4613Test Loss: 12.1111


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:58:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:38 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.4899
Train Loss: 2.0486
ID Validation ACCURACY: 0.4887
ID Validation Loss: 2.1187
ID Test ACCURACY: 0.4963
ID Test Loss: 1.9416
OOD Validation ACCURACY: 0.3943
OOD Validation Loss: 1.1884
OOD Test ACCURACY: 0.4750
OOD Test Loss: 32.6168

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.3959
Train Loss: 2.6359
ID Validation ACCURACY: 0.4100
ID Validation Loss: 2.6788
ID Test ACCURACY: 0.4033
ID Test Loss: 2.6084
OOD Validation ACCURACY: 0.5240
OOD Validation Loss: 1.4202
OOD Test ACCURACY: 0.4643
OOD Test Loss: 2.3969

[0m[1;37mINFO[0m: [1mChartInfo 0.4963 0.4750 0.4033 0.4643 0.4100 0.5240[0mId_val ACCURACY: 0.4887Id_val Loss: 2.1188
Id_test ACCURACY: 0.4963Id_test Loss: 1.9416
Test ACCURACY: 0.4750Test Loss: 32.6168


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif2/basis/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:58:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:42 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.5243
Train Loss: 1.6300
ID Validation ACCURACY: 0.5290
ID Validation Loss: 1.6217
ID Test ACCURACY: 0.5153
ID Test Loss: 1.6486
OOD Validation ACCURACY: 0.3360
OOD Validation Loss: 2.9312
OOD Test ACCURACY: 0.5983
OOD Test Loss: 1.1300

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ACCURACY: 0.3722
Train Loss: 2.1560
ID Validation ACCURACY: 0.3763
ID Validation Loss: 2.0934
ID Test ACCURACY: 0.3590
ID Test Loss: 2.1927
OOD Validation ACCURACY: 0.4270
OOD Validation Loss: 1.7656
OOD Test ACCURACY: 0.5453
OOD Test Loss: 1.2780

[0m[1;37mINFO[0m: [1mChartInfo 0.5153 0.5983 0.3590 0.5453 0.3763 0.4270[0mId_val ACCURACY: 0.5290Id_val Loss: 1.6217
Id_test ACCURACY: 0.5153Id_test Loss: 1.6486
Test ACCURACY: 0.5983Test Loss: 1.1300


Final accuracies: 
ID_VAL     = 0.488 +- 0.058
ID_TEST    = 0.483 +- 0.051
TEST       = 0.473 +- 0.082

Final losses: 
ID_VAL     = 1.8762 +- 0.5329
ID_TEST    = 1.8179 +- 0.4641
TEST       = 13.7601 +- 11.7607
Diff id_val-test  = 11.8839 
DONE TRAIN CIGA GOODMotif2/basis

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:58:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:58:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ROC-AUC: 0.9480
Train Loss: 0.3695
ID Validation ROC-AUC: 0.9027
ID Validation Loss: 0.4699
ID Test ROC-AUC: 0.9084
ID Test Loss: 0.4696
OOD Validation ROC-AUC: 0.5843
OOD Validation Loss: 0.5387
OOD Test ROC-AUC: 0.6552
OOD Test Loss: 0.8904

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 45...
[0m[1;37mINFO[0m: [1mCheckpoint 45: 
-----------------------------------
Train ROC-AUC: 0.9099
Train Loss: 0.2545
ID Validation ROC-AUC: 0.8783
ID Validation Loss: 0.2915
ID Test ROC-AUC: 0.8887
ID Test Loss: 0.2844
OOD Validation ROC-AUC: 0.6509
OOD Validation Loss: 0.3384
OOD Test ROC-AUC: 0.6766
OOD Test Loss: 0.5363

[0m[1;37mINFO[0m: [1mChartInfo 0.9084 0.6552 0.8887 0.6766 0.8783 0.6509[0mId_val ROC-AUC: 0.9027Id_val Loss: 0.4699
Id_test ROC-AUC: 0.9084Id_test Loss: 0.4696
Test ROC-AUC: 0.6552Test Loss: 0.8904


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:59:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 150...
[0m[1;37mINFO[0m: [1mCheckpoint 150: 
-----------------------------------
Train ROC-AUC: 0.9689
Train Loss: 0.1480
ID Validation ROC-AUC: 0.9058
ID Validation Loss: 0.2470
ID Test ROC-AUC: 0.9023
ID Test Loss: 0.2550
OOD Validation ROC-AUC: 0.6055
OOD Validation Loss: 0.6083
OOD Test ROC-AUC: 0.6627
OOD Test Loss: 0.6582

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 10...
[0m[1;37mINFO[0m: [1mCheckpoint 10: 
-----------------------------------
Train ROC-AUC: 0.8477
Train Loss: 0.3118
ID Validation ROC-AUC: 0.8262
ID Validation Loss: 0.3219
ID Test ROC-AUC: 0.8375
ID Test Loss: 0.3183
OOD Validation ROC-AUC: 0.6697
OOD Validation Loss: 0.4002
OOD Test ROC-AUC: 0.6582
OOD Test Loss: 0.4850

[0m[1;37mINFO[0m: [1mChartInfo 0.9023 0.6627 0.8375 0.6582 0.8262 0.6697[0mId_val ROC-AUC: 0.9058Id_val Loss: 0.2470
Id_test ROC-AUC: 0.9023Id_test Loss: 0.2550
Test ROC-AUC: 0.6627Test Loss: 0.6582


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:59:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9459
Train Loss: 0.2739
ID Validation ROC-AUC: 0.9033
ID Validation Loss: 0.3429
ID Test ROC-AUC: 0.9089
ID Test Loss: 0.3383
OOD Validation ROC-AUC: 0.6038
OOD Validation Loss: 0.4024
OOD Test ROC-AUC: 0.6620
OOD Test Loss: 0.6481

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 14...
[0m[1;37mINFO[0m: [1mCheckpoint 14: 
-----------------------------------
Train ROC-AUC: 0.8786
Train Loss: 0.2942
ID Validation ROC-AUC: 0.8634
ID Validation Loss: 0.3109
ID Test ROC-AUC: 0.8696
ID Test Loss: 0.3099
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.3274
OOD Test ROC-AUC: 0.6934
OOD Test Loss: 0.5211

[0m[1;37mINFO[0m: [1mChartInfo 0.9089 0.6620 0.8696 0.6934 0.8634 0.6437[0mId_val ROC-AUC: 0.9033Id_val Loss: 0.3429
Id_test ROC-AUC: 0.9089Id_test Loss: 0.3383
Test ROC-AUC: 0.6620Test Loss: 0.6481


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:59:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 159...
[0m[1;37mINFO[0m: [1mCheckpoint 159: 
-----------------------------------
Train ROC-AUC: 0.9548
Train Loss: 0.3192
ID Validation ROC-AUC: 0.9041
ID Validation Loss: 0.4545
ID Test ROC-AUC: 0.9006
ID Test Loss: 0.4686
OOD Validation ROC-AUC: 0.5961
OOD Validation Loss: 0.5439
OOD Test ROC-AUC: 0.6685
OOD Test Loss: 0.8654

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.8746
Train Loss: 0.3120
ID Validation ROC-AUC: 0.8599
ID Validation Loss: 0.3287
ID Test ROC-AUC: 0.8641
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.6526
OOD Validation Loss: 0.3467
OOD Test ROC-AUC: 0.6783
OOD Test Loss: 0.5797

[0m[1;37mINFO[0m: [1mChartInfo 0.9006 0.6685 0.8641 0.6783 0.8599 0.6526[0mId_val ROC-AUC: 0.9041Id_val Loss: 0.4545
Id_test ROC-AUC: 0.9006Id_test Loss: 0.4686
Test ROC-AUC: 0.6685Test Loss: 0.8654


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 10:59:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 10:59:59 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 152...
[0m[1;37mINFO[0m: [1mCheckpoint 152: 
-----------------------------------
Train ROC-AUC: 0.9637
Train Loss: 0.2273
ID Validation ROC-AUC: 0.9083
ID Validation Loss: 0.3490
ID Test ROC-AUC: 0.9104
ID Test Loss: 0.3513
OOD Validation ROC-AUC: 0.5940
OOD Validation Loss: 0.4940
OOD Test ROC-AUC: 0.6574
OOD Test Loss: 0.7667

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.8938
Train Loss: 0.2424
ID Validation ROC-AUC: 0.8717
ID Validation Loss: 0.2611
ID Test ROC-AUC: 0.8711
ID Test Loss: 0.2630
OOD Validation ROC-AUC: 0.6590
OOD Validation Loss: 0.3149
OOD Test ROC-AUC: 0.6741
OOD Test Loss: 0.4665

[0m[1;37mINFO[0m: [1mChartInfo 0.9104 0.6574 0.8711 0.6741 0.8717 0.6590[0mId_val ROC-AUC: 0.9083Id_val Loss: 0.3491
Id_test ROC-AUC: 0.9104Id_test Loss: 0.3513
Test ROC-AUC: 0.6574Test Loss: 0.7667


Final accuracies: 
ID_VAL     = 0.905 +- 0.002
ID_TEST    = 0.906 +- 0.004
TEST       = 0.661 +- 0.005

Final losses: 
ID_VAL     = 0.3727 +- 0.0817
ID_TEST    = 0.3766 +- 0.0825
TEST       = 0.7657 +- 0.1009
Diff id_val-test  = 0.3931 
DONE TRAIN CIGA LBAPcore/assay

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 11:00:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.2955
Train Loss: 2.1309
ID Validation ACCURACY: 0.2990
ID Validation Loss: 2.1134
ID Test ACCURACY: 0.2890
ID Test Loss: 2.1875
OOD Validation ACCURACY: 0.2706
OOD Validation Loss: 2.4837
OOD Test ACCURACY: 0.2086
OOD Test Loss: 4.6387

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.2797
Train Loss: 2.1018
ID Validation ACCURACY: 0.2841
ID Validation Loss: 2.0829
ID Test ACCURACY: 0.2744
ID Test Loss: 2.1502
OOD Validation ACCURACY: 0.2713
OOD Validation Loss: 2.2479
OOD Test ACCURACY: 0.1836
OOD Test Loss: 3.7387

[0m[1;37mINFO[0m: [1mChartInfo 0.2890 0.2086 0.2744 0.1836 0.2841 0.2713[0mId_val ACCURACY: 0.2961Id_val Loss: 2.1378
Id_test ACCURACY: 0.2903Id_test Loss: 2.1489
Test ACCURACY: 0.1973Test Loss: 4.7923


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 11:00:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.4261
Train Loss: 1.5957
ID Validation ACCURACY: 0.4141
ID Validation Loss: 1.6418
ID Test ACCURACY: 0.4197
ID Test Loss: 1.6257
OOD Validation ACCURACY: 0.3443
OOD Validation Loss: 2.1405
OOD Test ACCURACY: 0.2526
OOD Test Loss: 2.5709

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.3952
Train Loss: 1.7198
ID Validation ACCURACY: 0.3889
ID Validation Loss: 1.7556
ID Test ACCURACY: 0.3903
ID Test Loss: 1.7504
OOD Validation ACCURACY: 0.3587
OOD Validation Loss: 2.0597
OOD Test ACCURACY: 0.2260
OOD Test Loss: 2.7268

[0m[1;37mINFO[0m: [1mChartInfo 0.4197 0.2526 0.3903 0.2260 0.3889 0.3587[0mId_val ACCURACY: 0.4321Id_val Loss: 1.5902
Id_test ACCURACY: 0.4196Id_test Loss: 1.6198
Test ACCURACY: 0.2504Test Loss: 2.5615


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 11:00:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 11:00:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.3742
Train Loss: 1.7882
ID Validation ACCURACY: 0.3836
ID Validation Loss: 1.7873
ID Test ACCURACY: 0.3733
ID Test Loss: 1.8005
OOD Validation ACCURACY: 0.3237
OOD Validation Loss: 2.1818
OOD Test ACCURACY: 0.1913
OOD Test Loss: 3.2680

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.3845
Train Loss: 1.7577
ID Validation ACCURACY: 0.3803
ID Validation Loss: 1.7604
ID Test ACCURACY: 0.3764
ID Test Loss: 1.7715
OOD Validation ACCURACY: 0.3377
OOD Validation Loss: 2.0441
OOD Test ACCURACY: 0.1530
OOD Test Loss: 4.8804

[0m[1;37mINFO[0m: [1mChartInfo 0.3733 0.1913 0.3764 0.1530 0.3803 0.3377[0mId_val ACCURACY: 0.3751Id_val Loss: 1.7760
Id_test ACCURACY: 0.3736Id_test Loss: 1.7953
Test ACCURACY: 0.1830Test Loss: 3.3392


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 11:01:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.4318
Train Loss: 1.6191
ID Validation ACCURACY: 0.4249
ID Validation Loss: 1.6400
ID Test ACCURACY: 0.4277
ID Test Loss: 1.6411
OOD Validation ACCURACY: 0.3363
OOD Validation Loss: 2.1037
OOD Test ACCURACY: 0.2310
OOD Test Loss: 2.6250

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.4277
Train Loss: 1.6056
ID Validation ACCURACY: 0.4169
ID Validation Loss: 1.6171
ID Test ACCURACY: 0.4223
ID Test Loss: 1.6322
OOD Validation ACCURACY: 0.3510
OOD Validation Loss: 1.9996
OOD Test ACCURACY: 0.2556
OOD Test Loss: 2.4187

[0m[1;37mINFO[0m: [1mChartInfo 0.4277 0.2310 0.4223 0.2556 0.4169 0.3510[0mId_val ACCURACY: 0.4277Id_val Loss: 1.6182
Id_test ACCURACY: 0.4250Id_test Loss: 1.6288
Test ACCURACY: 0.2327Test Loss: 2.5861


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 11:01:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mCreating GINFeatExtractor:  5
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing  5  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 11:01:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.4111
Train Loss: 1.6693
ID Validation ACCURACY: 0.4090
ID Validation Loss: 1.6845
ID Test ACCURACY: 0.4119
ID Test Loss: 1.6805
OOD Validation ACCURACY: 0.3519
OOD Validation Loss: 2.0506
OOD Test ACCURACY: 0.2664
OOD Test Loss: 2.5518

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 0.4111
Train Loss: 1.6693
ID Validation ACCURACY: 0.4090
ID Validation Loss: 1.6845
ID Test ACCURACY: 0.4119
ID Test Loss: 1.6805
OOD Validation ACCURACY: 0.3519
OOD Validation Loss: 2.0506
OOD Test ACCURACY: 0.2664
OOD Test Loss: 2.5518

[0m[1;37mINFO[0m: [1mChartInfo 0.4119 0.2664 0.4119 0.2664 0.4090 0.3519[0mId_val ACCURACY: 0.4136Id_val Loss: 1.6448
Id_test ACCURACY: 0.4091Id_test Loss: 1.6794
Test ACCURACY: 0.2693Test Loss: 2.5413


Final accuracies: 
ID_VAL     = 0.389 +- 0.051
ID_TEST    = 0.384 +- 0.050
TEST       = 0.227 +- 0.032

Final losses: 
ID_VAL     = 1.7534 +- 0.2025
ID_TEST    = 1.7744 +- 0.1974
TEST       = 3.1641 +- 0.8679
Diff id_val-test  = 1.4107 
DONE TRAIN CIGA GOODCMNIST/color
DONE all :)
Time to train models with hard masking!
The PID of this script is: 2316632

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 23:59:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:12 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:12 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8550
Train Loss: 0.4111
ID Validation ACCURACY: 0.8098
ID Validation Loss: 0.4890
ID Test ACCURACY: 0.8080
ID Test Loss: 0.5001
OOD Validation ACCURACY: 0.7392
OOD Validation Loss: 0.5336
OOD Test ACCURACY: 0.5942
OOD Test Loss: 0.6023

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8550
Train Loss: 0.4111
ID Validation ACCURACY: 0.8098
ID Validation Loss: 0.4890
ID Test ACCURACY: 0.8080
ID Test Loss: 0.5001
OOD Validation ACCURACY: 0.7392
OOD Validation Loss: 0.5336
OOD Test ACCURACY: 0.5942
OOD Test Loss: 0.6023

[0m[1;37mINFO[0m: [1mChartInfo 0.8080 0.5942 0.8080 0.5942 0.8098 0.7392[0mId_val ACCURACY: 0.8098Id_val Loss: 0.4890
Id_test ACCURACY: 0.8080Id_test Loss: 0.5001
Test ACCURACY: 0.5942Test Loss: 0.6023


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 23:59:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0754
ID Validation ACCURACY: 0.8604
ID Validation Loss: 1.0229
ID Test ACCURACY: 0.8561
ID Test Loss: 1.1527
OOD Validation ACCURACY: 0.8477
OOD Validation Loss: 3.3872
OOD Test ACCURACY: 0.7903
OOD Test Loss: 4.9558

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0768
ID Validation ACCURACY: 0.8532
ID Validation Loss: 1.2979
ID Test ACCURACY: 0.8521
ID Test Loss: 1.5484
OOD Validation ACCURACY: 0.8587
OOD Validation Loss: 3.8430
OOD Test ACCURACY: 0.8120
OOD Test Loss: 5.5150

[0m[1;37mINFO[0m: [1mChartInfo 0.8561 0.7903 0.8521 0.8120 0.8532 0.8587[0mId_val ACCURACY: 0.8604Id_val Loss: 1.0229
Id_test ACCURACY: 0.8561Id_test Loss: 1.1527
Test ACCURACY: 0.7903Test Loss: 4.9663


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 23:59:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8623
ID Validation Loss: 2.4682
ID Test ACCURACY: 0.8612
ID Test Loss: 2.9010
OOD Validation ACCURACY: 0.8557
OOD Validation Loss: 5.3706
OOD Test ACCURACY: 0.7949
OOD Test Loss: 8.1971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 74...
[0m[1;37mINFO[0m: [1mCheckpoint 74: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0805
ID Validation ACCURACY: 0.8544
ID Validation Loss: 0.8464
ID Test ACCURACY: 0.8542
ID Test Loss: 1.0687
OOD Validation ACCURACY: 0.8595
OOD Validation Loss: 2.9836
OOD Test ACCURACY: 0.7982
OOD Test Loss: 3.4505

[0m[1;37mINFO[0m: [1mChartInfo 0.8612 0.7949 0.8542 0.7982 0.8544 0.8595[0mId_val ACCURACY: 0.8623Id_val Loss: 2.4682
Id_test ACCURACY: 0.8612Id_test Loss: 2.9010
Test ACCURACY: 0.7948Test Loss: 8.1971


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri May 17 23:59:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/17/2024 11:59:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 170...
[0m[1;37mINFO[0m: [1mCheckpoint 170: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8623
ID Validation Loss: 1.5974
ID Test ACCURACY: 0.8544
ID Test Loss: 2.0365
OOD Validation ACCURACY: 0.8543
OOD Validation Loss: 3.4836
OOD Test ACCURACY: 0.7864
OOD Test Loss: 7.7740

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0755
ID Validation ACCURACY: 0.8536
ID Validation Loss: 1.0924
ID Test ACCURACY: 0.8563
ID Test Loss: 1.3289
OOD Validation ACCURACY: 0.8577
OOD Validation Loss: 2.8081
OOD Test ACCURACY: 0.7972
OOD Test Loss: 3.9612

[0m[1;37mINFO[0m: [1mChartInfo 0.8544 0.7864 0.8563 0.7972 0.8536 0.8577[0mId_val ACCURACY: 0.8623Id_val Loss: 1.5974
Id_test ACCURACY: 0.8544Id_test Loss: 2.0365
Test ACCURACY: 0.7864Test Loss: 7.7740


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/CIGA.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat May 18 00:00:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing  3  layers for classifier
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mUsing feature sampling = raw
[0m[1;34mDEBUG[0m: 05/18/2024 12:00:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0757
ID Validation ACCURACY: 0.8610
ID Validation Loss: 0.8028
ID Test ACCURACY: 0.8600
ID Test Loss: 1.0996
OOD Validation ACCURACY: 0.8599
OOD Validation Loss: 2.7628
OOD Test ACCURACY: 0.8133
OOD Test Loss: 3.9052

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9481
Train Loss: 0.0779
ID Validation ACCURACY: 0.8563
ID Validation Loss: 0.7223
ID Test ACCURACY: 0.8585
ID Test Loss: 0.9870
OOD Validation ACCURACY: 0.8610
OOD Validation Loss: 2.2647
OOD Test ACCURACY: 0.8027
OOD Test Loss: 3.2630

[0m[1;37mINFO[0m: [1mChartInfo 0.8600 0.8133 0.8585 0.8027 0.8563 0.8610[0mId_val ACCURACY: 0.8610Id_val Loss: 0.8028
Id_test ACCURACY: 0.8600Id_test Loss: 1.0996
Test ACCURACY: 0.8133Test Loss: 3.9052


Final accuracies: 
ID_VAL     = 0.851 +- 0.021
ID_TEST    = 0.848 +- 0.020
TEST       = 0.756 +- 0.081

Final losses: 
ID_VAL     = 1.2761 +- 0.6974
ID_TEST    = 1.5380 +- 0.8395
TEST       = 5.0890 +- 2.7719
Diff id_val-test  = 3.8129 
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
DONE TRAIN CIGA GOODSST2/length
DONE all :)
