nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 1493285

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Aug  3 23:49:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.734
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.989
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.989
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.989



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.940490
Original XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8609, device='cuda:0')  +-  tensor(0.2160, device='cuda:0') (0.003937524277716875)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.155919
Original XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6037, device='cuda:0')  +-  tensor(0.3193, device='cuda:0') (5.400617730799695e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.841277
Original XAI WIoU for r=0.9 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.6169, device='cuda:0')  +-  tensor(0.3045, device='cuda:0') (6.1225509107032394e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.182184
Original XAI WIoU for r=0.3 =  tensor(0.9897, device='cuda:0')  +-  tensor(0.0502, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8722, device='cuda:0')  +-  tensor(0.1827, device='cuda:0') (2.657825781682277e-08)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.097464
Original XAI WIoU for r=0.6 =  tensor(0.9897, device='cuda:0')  +-  tensor(0.0502, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.3724, device='cuda:0')  +-  tensor(0.1640, device='cuda:0') (3.8609555552682195e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:06.948546
Original XAI WIoU for r=0.9 =  tensor(0.9897, device='cuda:0')  +-  tensor(0.0502, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.5050, device='cuda:0')  +-  tensor(0.1956, device='cuda:0') (5.239570999293619e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Aug  3 23:56:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.767
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.767
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.995
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.995



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.000571
Original XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9235, device='cuda:0')  +-  tensor(0.1760, device='cuda:0') (0.006657704710960388)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.595068
Original XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6343, device='cuda:0')  +-  tensor(0.3279, device='cuda:0') (8.559076114522668e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.000350
Original XAI WIoU for r=0.9 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.6571, device='cuda:0')  +-  tensor(0.3115, device='cuda:0') (1.1492624629738657e-08)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.615283
Original XAI WIoU for r=0.3 =  tensor(0.9950, device='cuda:0')  +-  tensor(0.0432, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9078, device='cuda:0')  +-  tensor(0.1813, device='cuda:0') (1.349460321264928e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.702863
Original XAI WIoU for r=0.6 =  tensor(0.9950, device='cuda:0')  +-  tensor(0.0432, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4097, device='cuda:0')  +-  tensor(0.1851, device='cuda:0') (3.951197147245011e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.789992
Original XAI WIoU for r=0.9 =  tensor(0.9950, device='cuda:0')  +-  tensor(0.0432, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.5384, device='cuda:0')  +-  tensor(0.2521, device='cuda:0') (1.5196532388017658e-07)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:11:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:11:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.697
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.697
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.994
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.994



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.626337
Original XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8987, device='cuda:0')  +-  tensor(0.1895, device='cuda:0') (0.003929413389414549)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.883291
Original XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6629, device='cuda:0')  +-  tensor(0.3151, device='cuda:0') (2.094995510404374e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.800565
Original XAI WIoU for r=0.9 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.5528, device='cuda:0')  +-  tensor(0.2625, device='cuda:0') (2.9432674075735576e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.781147
Original XAI WIoU for r=0.3 =  tensor(0.9944, device='cuda:0')  +-  tensor(0.0460, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8463, device='cuda:0')  +-  tensor(0.2054, device='cuda:0') (2.7266873203757314e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.652456
Original XAI WIoU for r=0.6 =  tensor(0.9944, device='cuda:0')  +-  tensor(0.0460, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4322, device='cuda:0')  +-  tensor(0.1799, device='cuda:0') (1.5239987760651275e-07)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.990709
Original XAI WIoU for r=0.9 =  tensor(0.9944, device='cuda:0')  +-  tensor(0.0460, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4064, device='cuda:0')  +-  tensor(0.1623, device='cuda:0') (2.8710738231296773e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:16:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.905
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.905
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.996
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.996
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.996
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.996



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.776732
Original XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:0')  +-  tensor(0.1937, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8906, device='cuda:0')  +-  tensor(0.2280, device='cuda:0') (0.00940254982560873)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.560634
Original XAI WIoU for r=0.6 =  tensor(0.9049, device='cuda:0')  +-  tensor(0.1937, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6816, device='cuda:0')  +-  tensor(0.3291, device='cuda:0') (5.027850136229972e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.158683
Original XAI WIoU for r=0.9 =  tensor(0.9049, device='cuda:0')  +-  tensor(0.1937, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.7608, device='cuda:0')  +-  tensor(0.3295, device='cuda:0') (4.627663141576477e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.543218
Original XAI WIoU for r=0.3 =  tensor(0.9965, device='cuda:0')  +-  tensor(0.0489, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6903, device='cuda:0')  +-  tensor(0.2951, device='cuda:0') (4.73907668663287e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.835604
Original XAI WIoU for r=0.6 =  tensor(0.9965, device='cuda:0')  +-  tensor(0.0489, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.3965, device='cuda:0')  +-  tensor(0.2367, device='cuda:0') (3.2323876908435523e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.974340
Original XAI WIoU for r=0.9 =  tensor(0.9965, device='cuda:0')  +-  tensor(0.0489, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3719, device='cuda:0')  +-  tensor(0.1886, device='cuda:0') (4.240664708277109e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:20:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:20:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.716
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.715
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.930
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.927
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.927
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.927



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.680863
Original XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8347, device='cuda:0')  +-  tensor(0.2234, device='cuda:0') (0.006040261592715979)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.814126
Original XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6265, device='cuda:0')  +-  tensor(0.3126, device='cuda:0') (1.6202727692871122e-07)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.778668
Original XAI WIoU for r=0.9 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.6582, device='cuda:0')  +-  tensor(0.3389, device='cuda:0') (9.251508004126663e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.747745
Original XAI WIoU for r=0.3 =  tensor(0.9276, device='cuda:0')  +-  tensor(0.1148, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7409, device='cuda:0')  +-  tensor(0.2464, device='cuda:0') (9.930750444198111e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.849613
Original XAI WIoU for r=0.6 =  tensor(0.9276, device='cuda:0')  +-  tensor(0.1148, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.3262, device='cuda:0')  +-  tensor(0.1831, device='cuda:0') (3.3910048102825385e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.986594
Original XAI WIoU for r=0.9 =  tensor(0.9276, device='cuda:0')  +-  tensor(0.1148, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3258, device='cuda:0')  +-  tensor(0.1435, device='cuda:0') (3.2580718123398356e-09)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) id_val Accuracy SUFF_SIMPLE: 	[] +- []
(id) id_val Accuracy WIOU_ORIGINAL: 	[0.7636732  0.76367326 0.7636732 ] +- [0.07432535 0.07432533 0.07432535]
(id) id_val Accuracy WIOU_PERTURBED: 	[0.88165094 0.64181021 0.64914979] +- [0.03083963 0.02745962 0.06774388]
(id) val Accuracy SUFF_SIMPLE: 	[] +- []
(id) val Accuracy WIOU_ORIGINAL: 	[0.98065083 0.98065076 0.98065076] +- [0.02661738 0.02661752 0.02661752]
(id) val Accuracy WIOU_PERTURBED: 	[0.81150106 0.3874148  0.42950832] +- [0.08226679 0.0361962  0.08023319]
DONE LECI GOODMotif2/basis 0.65

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:24:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:24:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.603
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.356



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.606611
Original XAI WIoU for r=0.8 =  tensor(0.6003, device='cuda:0')  +-  tensor(0.2865, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.4501, device='cuda:0')  +-  tensor(0.2607, device='cuda:0') (1.919568859420906e-07)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.644935
Original XAI WIoU for r=0.8 =  tensor(0.3555, device='cuda:0')  +-  tensor(0.1920, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.2436, device='cuda:0')  +-  tensor(0.1098, device='cuda:0') (2.4976121171249588e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:25:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.512
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.337



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.428116
Original XAI WIoU for r=0.8 =  tensor(0.5115, device='cuda:0')  +-  tensor(0.2630, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.5250, device='cuda:0')  +-  tensor(0.2919, device='cuda:0') (2.665600407070201e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.457646
Original XAI WIoU for r=0.8 =  tensor(0.3371, device='cuda:0')  +-  tensor(0.0888, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.3623, device='cuda:0')  +-  tensor(0.1021, device='cuda:0') (2.993246983606923e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:27:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.727
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.906



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.872130
Original XAI WIoU for r=0.8 =  tensor(0.7270, device='cuda:0')  +-  tensor(0.2704, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.6022, device='cuda:0')  +-  tensor(0.3148, device='cuda:0') (3.6945851888958714e-07)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.439300
Original XAI WIoU for r=0.8 =  tensor(0.9059, device='cuda:0')  +-  tensor(0.1089, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.4879, device='cuda:0')  +-  tensor(0.2687, device='cuda:0') (6.450198153373776e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:28:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.510
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.665083
Original XAI WIoU for r=0.8 =  tensor(0.5095, device='cuda:0')  +-  tensor(0.2852, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.5119, device='cuda:0')  +-  tensor(0.2846, device='cuda:0') (1.171753538642406e-08)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.475936
Original XAI WIoU for r=0.8 =  tensor(0.2859, device='cuda:0')  +-  tensor(0.0785, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.3674, device='cuda:0')  +-  tensor(0.1128, device='cuda:0') (1.855926825555798e-07)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:29:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.471
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.324



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.547702
Original XAI WIoU for r=0.8 =  tensor(0.4711, device='cuda:0')  +-  tensor(0.2612, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.3762, device='cuda:0')  +-  tensor(0.2610, device='cuda:0') (1.085676881729114e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.459994
Original XAI WIoU for r=0.8 =  tensor(0.3235, device='cuda:0')  +-  tensor(0.0936, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.2158, device='cuda:0')  +-  tensor(0.1351, device='cuda:0') (1.2661602877273026e-09)
len(reference) = 3000


DONE GOODMotif2 - CIGAGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.5638744] +- [0.09189802]
(id) id_val WIOU_PERTURBED: 	[0.49308036] +- [0.07591248]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.44159026] +- [0.23328466]
(id) val WIOU_PERTURBED: 	[0.33540523] +- [0.09770199]
DONE CIGA GOODMotif2/basis 0.65

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:31:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:31:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.328
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.201
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.153
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.168



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.760997
Original XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7353, device='cuda:0')  +-  tensor(0.2484, device='cuda:0') (0.00024941653828136623)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.818932
Original XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4765, device='cuda:0')  +-  tensor(0.2345, device='cuda:0') (1.965880347398752e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.958757
Original XAI WIoU for r=0.9 =  tensor(0.3277, device='cuda:0')  +-  tensor(0.1673, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3395, device='cuda:0')  +-  tensor(0.1657, device='cuda:0') (4.456550684039939e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.770427
Original XAI WIoU for r=0.3 =  tensor(0.1680, device='cuda:0')  +-  tensor(0.0481, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4542, device='cuda:0')  +-  tensor(0.1196, device='cuda:0') (5.4089479561980625e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.850973
Original XAI WIoU for r=0.6 =  tensor(0.1680, device='cuda:0')  +-  tensor(0.0481, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2585, device='cuda:0')  +-  tensor(0.0735, device='cuda:0') (2.0991604010589526e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.838755
Original XAI WIoU for r=0.9 =  tensor(0.1680, device='cuda:0')  +-  tensor(0.0481, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1808, device='cuda:0')  +-  tensor(0.0517, device='cuda:0') (1.5271670594785292e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:35:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:35:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.323
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.435
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.242
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.174
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.174



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.487113
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7169, device='cuda:0')  +-  tensor(0.2354, device='cuda:0') (0.00023217848502099514)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.774116
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4656, device='cuda:0')  +-  tensor(0.2226, device='cuda:0') (1.6771070088239526e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.972224
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1641, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3354, device='cuda:0')  +-  tensor(0.1635, device='cuda:0') (2.6961439747452687e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.339351
Original XAI WIoU for r=0.3 =  tensor(0.1739, device='cuda:0')  +-  tensor(0.0475, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4870, device='cuda:0')  +-  tensor(0.1356, device='cuda:0') (3.6096674538299567e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.038660
Original XAI WIoU for r=0.6 =  tensor(0.1739, device='cuda:0')  +-  tensor(0.0475, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2634, device='cuda:0')  +-  tensor(0.0727, device='cuda:0') (2.6045139378538806e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.169894
Original XAI WIoU for r=0.9 =  tensor(0.1739, device='cuda:0')  +-  tensor(0.0475, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1824, device='cuda:0')  +-  tensor(0.0502, device='cuda:0') (1.879803646076539e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:38:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:38:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.322
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.369
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.210
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.160
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.167



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.465936
Original XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7155, device='cuda:0')  +-  tensor(0.2376, device='cuda:0') (0.00021666550310328603)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.503278
Original XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4713, device='cuda:0')  +-  tensor(0.2328, device='cuda:0') (1.976987018537102e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.019060
Original XAI WIoU for r=0.9 =  tensor(0.3217, device='cuda:0')  +-  tensor(0.1637, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3343, device='cuda:0')  +-  tensor(0.1635, device='cuda:0') (4.592607627529333e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.893241
Original XAI WIoU for r=0.3 =  tensor(0.1672, device='cuda:0')  +-  tensor(0.0476, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4622, device='cuda:0')  +-  tensor(0.1367, device='cuda:0') (5.103514055804226e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.131310
Original XAI WIoU for r=0.6 =  tensor(0.1672, device='cuda:0')  +-  tensor(0.0476, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2559, device='cuda:0')  +-  tensor(0.0707, device='cuda:0') (2.299080481549254e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.002579
Original XAI WIoU for r=0.9 =  tensor(0.1672, device='cuda:0')  +-  tensor(0.0476, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1796, device='cuda:0')  +-  tensor(0.0499, device='cuda:0') (1.4438669149186012e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:41:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:41:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.328
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.323
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.234
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.171
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.174



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.453043
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7021, device='cuda:0')  +-  tensor(0.2297, device='cuda:0') (0.0002333133015781641)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.514111
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4684, device='cuda:0')  +-  tensor(0.2303, device='cuda:0') (1.6382336598397274e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.789351
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:0')  +-  tensor(0.1629, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3353, device='cuda:0')  +-  tensor(0.1637, device='cuda:0') (3.3708740243554303e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.747492
Original XAI WIoU for r=0.3 =  tensor(0.1737, device='cuda:0')  +-  tensor(0.0477, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4713, device='cuda:0')  +-  tensor(0.1302, device='cuda:0') (3.2431470842197996e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.090346
Original XAI WIoU for r=0.6 =  tensor(0.1737, device='cuda:0')  +-  tensor(0.0477, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2576, device='cuda:0')  +-  tensor(0.0714, device='cuda:0') (2.138033750043178e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.508660
Original XAI WIoU for r=0.9 =  tensor(0.1737, device='cuda:0')  +-  tensor(0.0477, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1814, device='cuda:0')  +-  tensor(0.0493, device='cuda:0') (1.4466434716808863e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:45:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:45:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.338
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.324
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.407
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.228
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.165
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.171



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.447562
Original XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7189, device='cuda:0')  +-  tensor(0.2350, device='cuda:0') (0.00023859580687712878)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.574041
Original XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4782, device='cuda:0')  +-  tensor(0.2336, device='cuda:0') (3.826247318983178e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.701720
Original XAI WIoU for r=0.9 =  tensor(0.3241, device='cuda:0')  +-  tensor(0.1645, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3383, device='cuda:0')  +-  tensor(0.1653, device='cuda:0') (4.60093740883849e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.662827
Original XAI WIoU for r=0.3 =  tensor(0.1710, device='cuda:0')  +-  tensor(0.0483, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4808, device='cuda:0')  +-  tensor(0.1344, device='cuda:0') (1.540494878327081e-07)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.533614
Original XAI WIoU for r=0.6 =  tensor(0.1710, device='cuda:0')  +-  tensor(0.0483, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2604, device='cuda:0')  +-  tensor(0.0722, device='cuda:0') (1.848652004809992e-07)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.547903
Original XAI WIoU for r=0.9 =  tensor(0.1710, device='cuda:0')  +-  tensor(0.0483, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1812, device='cuda:0')  +-  tensor(0.0497, device='cuda:0') (1.4688569249798888e-09)
len(reference) = 3000


DONE GOODMotif2 - GSATGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.32386574 0.32386593 0.32386613] +- [0.00206968 0.00206947 0.00206926]
(id) id_val WIOU_PERTURBED: 	[0.71772375 0.47200999 0.33655353] +- [0.01058693 0.00474426 0.0019879 ]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.17075033 0.17075033 0.17075033] +- [0.00277182 0.00277182 0.00277182]
(id) val WIOU_PERTURBED: 	[0.47110169 0.25918424 0.18107052] +- [0.01193089 0.0025669  0.00089192]
DONE GSAT GOODMotif2/basis 0.65

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:50:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:42 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:50:59 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:02 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:05 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:07 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:51:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.765
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.765
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.892
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.515469
Original XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:0')  +-  tensor(0.2609, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(nan, device='cuda:0')  +-  tensor(nan, device='cuda:0') (nan)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.521947
Original XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:0')  +-  tensor(0.2609, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5805, device='cuda:0')  +-  tensor(0.2645, device='cuda:0') (3.998400721627604e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.616063
Original XAI WIoU for r=0.9 =  tensor(0.7649, device='cuda:0')  +-  tensor(0.2609, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.7051, device='cuda:0')  +-  tensor(0.3087, device='cuda:0') (3.165400386251349e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.534967
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9568, device='cuda:0')  +-  tensor(0.1235, device='cuda:0') (3.10986708607075e-10)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.706115
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.9936, device='cuda:0')  +-  tensor(0.0301, device='cuda:0') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.112013
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:54:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:04 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:20 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:22 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:24 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:54:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.750
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.750
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.535897
Original XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:0')  +-  tensor(0.2537, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8261, device='cuda:0')  +-  tensor(0.2399, device='cuda:0') (0.005225412081927061)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.534844
Original XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:0')  +-  tensor(0.2537, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5651, device='cuda:0')  +-  tensor(0.3162, device='cuda:0') (1.3800035558730883e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.600265
Original XAI WIoU for r=0.9 =  tensor(0.7502, device='cuda:0')  +-  tensor(0.2537, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.6054, device='cuda:0')  +-  tensor(0.2958, device='cuda:0') (2.2046737768732783e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.472939
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9997, device='cuda:0')  +-  tensor(0.0176, device='cuda:0') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.539432
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.9843, device='cuda:0')  +-  tensor(0.0446, device='cuda:0') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.157928
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:58:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:31 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:46 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:51 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:53 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:58:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.789
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.789
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.789
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.884
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.540195
Original XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:0')  +-  tensor(0.2203, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9311, device='cuda:0')  +-  tensor(0.1567, device='cuda:0') (0.006972742732614279)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.717016
Original XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:0')  +-  tensor(0.2203, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.7231, device='cuda:0')  +-  tensor(0.2911, device='cuda:0') (2.5330149089342058e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.035502
Original XAI WIoU for r=0.9 =  tensor(0.7890, device='cuda:0')  +-  tensor(0.2203, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.6537, device='cuda:0')  +-  tensor(0.3179, device='cuda:0') (2.4476320970023835e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.540745
Original XAI WIoU for r=0.3 =  tensor(0.9999, device='cuda:0')  +-  tensor(0.0004, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9986, device='cuda:0')  +-  tensor(0.0224, device='cuda:0') (4.442667414505941e-11)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.111936
Original XAI WIoU for r=0.6 =  tensor(0.9999, device='cuda:0')  +-  tensor(0.0004, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.530280
Original XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:0')  +-  tensor(0.0004, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:02:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:25 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:38 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:40 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:42 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:44 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:02:46 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.830
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.824
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.824
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.888
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.980
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.980



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.670928
Original XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:0')  +-  tensor(0.2282, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8523, device='cuda:0')  +-  tensor(0.2055, device='cuda:0') (0.007869631052017212)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.947383
Original XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:0')  +-  tensor(0.2282, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5755, device='cuda:0')  +-  tensor(0.2651, device='cuda:0') (1.743747035654053e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.954158
Original XAI WIoU for r=0.9 =  tensor(0.8237, device='cuda:0')  +-  tensor(0.2282, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.7150, device='cuda:0')  +-  tensor(0.3062, device='cuda:0') (2.632280171610546e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.653815
Original XAI WIoU for r=0.3 =  tensor(0.9801, device='cuda:0')  +-  tensor(0.0528, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9603, device='cuda:0')  +-  tensor(0.1397, device='cuda:0') (3.5541339316047527e-10)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.467352
Original XAI WIoU for r=0.6 =  tensor(0.9801, device='cuda:0')  +-  tensor(0.0528, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.9645, device='cuda:0')  +-  tensor(0.0711, device='cuda:0') (6.952774800339512e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.496792
Original XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:0')  +-  tensor(0.0528, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:0')  +-  tensor(0.0528, device='cuda:0') (5.975387296075496e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:06:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:17 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:30 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:32 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:34 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:36 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:06:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.802
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.800
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.800
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.576254
Original XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:0')  +-  tensor(0.2459, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8456, device='cuda:0')  +-  tensor(0.2210, device='cuda:0') (0.008043893612921238)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.557654
Original XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:0')  +-  tensor(0.2459, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6022, device='cuda:0')  +-  tensor(0.3158, device='cuda:0') (2.096383733274365e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.568714
Original XAI WIoU for r=0.9 =  tensor(0.7997, device='cuda:0')  +-  tensor(0.2459, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.6635, device='cuda:0')  +-  tensor(0.3348, device='cuda:0') (2.186625325251157e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.609338
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:0')  +-  tensor(0.0002, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9942, device='cuda:0')  +-  tensor(0.0337, device='cuda:0') (0.0)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.652123
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:0')  +-  tensor(0.0002, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.9529, device='cuda:0')  +-  tensor(0.0834, device='cuda:0') (4.7314410167587084e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.694870
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:0')  +-  tensor(0.0002, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:0')  +-  tensor(0.0014, device='cuda:0') (1.9547736762604018e-09)
len(reference) = 3000


DONE GOODMotif - LECIGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.78548733 0.78548733 0.78548733] +- [0.02587127 0.02587127 0.02587127]
(id) id_val WIOU_PERTURBED: 	[       nan 0.60929073 0.66854343] +- [       nan 0.05818146 0.03929742]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.99601128 0.99601128 0.99601128] +- [0.00793648 0.00793648 0.00793648]
(id) val WIOU_PERTURBED: 	[0.98190198 0.97905172 0.9960122 ] +- [0.01919701 0.01774642 0.00793635]
DONE LECI GOODMotif/basis 0.65

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:11:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:02 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:17 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:19 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:22 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:24 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.441847
Original XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:0')  +-  tensor(0.2729, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5589, device='cuda:0')  +-  tensor(0.3262, device='cuda:0') (1.4383135793494262e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.248764
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:0')  +-  tensor(0.0057, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.9987, device='cuda:0')  +-  tensor(0.0114, device='cuda:0') (1.7770669658023763e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:12:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:12:40 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:12:52 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:12:54 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:12:56 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:12:58 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.556085
Original XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:0')  +-  tensor(0.2686, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5653, device='cuda:0')  +-  tensor(0.3197, device='cuda:0') (3.717957275384265e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.518866
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.9999, device='cuda:0')  +-  tensor(0.0044, device='cuda:0') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:13:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:05 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:07 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:09 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:10 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.562
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:04.531878
Original XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:0')  +-  tensor(0.2147, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5622, device='cuda:0')  +-  tensor(0.3042, device='cuda:0') (9.837731518302917e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.773969
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:0')  +-  tensor(0.0017, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.9939, device='cuda:0')  +-  tensor(0.0231, device='cuda:0') (1.2950375882780918e-08)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:15:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:09 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:22 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:24 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:26 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:27 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.544
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.480192
Original XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:0')  +-  tensor(0.2566, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5644, device='cuda:0')  +-  tensor(0.3056, device='cuda:0') (1.4646919233030076e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.340344
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:0')  +-  tensor(7.2843e-05, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.9987, device='cuda:0')  +-  tensor(0.0127, device='cuda:0') (4.220534477461513e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:16:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:24 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:38 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:40 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:42 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:44 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:46 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.723
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:04.251379
Original XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:0')  +-  tensor(0.2769, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5621, device='cuda:0')  +-  tensor(0.3222, device='cuda:0') (8.42996161765086e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.544313
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.9998, device='cuda:0')  +-  tensor(0.0031, device='cuda:0') (4.131680775287805e-09)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.65580273] +- [0.08244711]
(id) id_val WIOU_PERTURBED: 	[0.56258819] +- [0.00221097]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.99980891] +- [0.0002322]
(id) val WIOU_PERTURBED: 	[0.9981909] +- [0.00220275]
DONE CIGA GOODMotif/basis 0.65

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:18:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:10 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:22 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:25 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:27 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:28 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:18:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.318
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.438



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.986003
Original XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:0')  +-  tensor(0.1621, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7260, device='cuda:0')  +-  tensor(0.2451, device='cuda:0') (0.00017605281027499586)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.623537
Original XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:0')  +-  tensor(0.1621, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4843, device='cuda:0')  +-  tensor(0.2465, device='cuda:0') (2.015860367521327e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.712419
Original XAI WIoU for r=0.9 =  tensor(0.3183, device='cuda:0')  +-  tensor(0.1621, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3357, device='cuda:0')  +-  tensor(0.1661, device='cuda:0') (1.924230330629939e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.546689
Original XAI WIoU for r=0.3 =  tensor(0.4379, device='cuda:0')  +-  tensor(0.0807, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9932, device='cuda:0')  +-  tensor(0.0315, device='cuda:0') (2.0880537299206026e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.583523
Original XAI WIoU for r=0.6 =  tensor(0.4379, device='cuda:0')  +-  tensor(0.0807, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6001, device='cuda:0')  +-  tensor(0.1499, device='cuda:0') (7.119375311503973e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.777067
Original XAI WIoU for r=0.9 =  tensor(0.4379, device='cuda:0')  +-  tensor(0.0807, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4539, device='cuda:0')  +-  tensor(0.0897, device='cuda:0') (4.276067500086356e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:22:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:05 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:18 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:20 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:22 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:24 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.327
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.443



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.614541
Original XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:0')  +-  tensor(0.1674, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7387, device='cuda:0')  +-  tensor(0.2349, device='cuda:0') (0.0002225506614195183)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.659294
Original XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:0')  +-  tensor(0.1674, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4881, device='cuda:0')  +-  tensor(0.2414, device='cuda:0') (2.304633817118429e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.926246
Original XAI WIoU for r=0.9 =  tensor(0.3266, device='cuda:0')  +-  tensor(0.1674, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3449, device='cuda:0')  +-  tensor(0.1732, device='cuda:0') (3.118197478002571e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.556775
Original XAI WIoU for r=0.3 =  tensor(0.4434, device='cuda:0')  +-  tensor(0.0872, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9931, device='cuda:0')  +-  tensor(0.0339, device='cuda:0') (4.886934190651004e-10)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.793001
Original XAI WIoU for r=0.6 =  tensor(0.4434, device='cuda:0')  +-  tensor(0.0872, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6218, device='cuda:0')  +-  tensor(0.1592, device='cuda:0') (6.70842803529581e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.600008
Original XAI WIoU for r=0.9 =  tensor(0.4434, device='cuda:0')  +-  tensor(0.0872, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4491, device='cuda:0')  +-  tensor(0.0897, device='cuda:0') (6.65289467960406e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:26:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:45 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:00 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:03 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:08 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:27:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.323
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.446



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.620435
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1654, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7319, device='cuda:0')  +-  tensor(0.2375, device='cuda:0') (0.00024030667555052787)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.652925
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1654, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4821, device='cuda:0')  +-  tensor(0.2398, device='cuda:0') (2.632280393655151e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.715528
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:0')  +-  tensor(0.1654, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3394, device='cuda:0')  +-  tensor(0.1679, device='cuda:0') (3.67945119705837e-07)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.703352
Original XAI WIoU for r=0.3 =  tensor(0.4456, device='cuda:0')  +-  tensor(0.0849, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9935, device='cuda:0')  +-  tensor(0.0302, device='cuda:0') (2.2213337072529704e-11)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.771927
Original XAI WIoU for r=0.6 =  tensor(0.4456, device='cuda:0')  +-  tensor(0.0849, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6174, device='cuda:0')  +-  tensor(0.1548, device='cuda:0') (5.0979616084134705e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.386477
Original XAI WIoU for r=0.9 =  tensor(0.4456, device='cuda:0')  +-  tensor(0.0849, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4509, device='cuda:0')  +-  tensor(0.0869, device='cuda:0') (4.264960828948006e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:31:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:19 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:38 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:40 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:43 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:45 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:31:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.322
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.443



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.589037
Original XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:0')  +-  tensor(0.1642, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7304, device='cuda:0')  +-  tensor(0.2477, device='cuda:0') (0.0002235349384136498)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.829272
Original XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:0')  +-  tensor(0.1642, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4775, device='cuda:0')  +-  tensor(0.2384, device='cuda:0') (3.7485006210147276e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.888578
Original XAI WIoU for r=0.9 =  tensor(0.3221, device='cuda:0')  +-  tensor(0.1642, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3389, device='cuda:0')  +-  tensor(0.1689, device='cuda:0') (4.531520936268407e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.855321
Original XAI WIoU for r=0.3 =  tensor(0.4431, device='cuda:0')  +-  tensor(0.0848, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9934, device='cuda:0')  +-  tensor(0.0306, device='cuda:0') (1.9992003885693777e-10)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.511777
Original XAI WIoU for r=0.6 =  tensor(0.4431, device='cuda:0')  +-  tensor(0.0848, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6149, device='cuda:0')  +-  tensor(0.1550, device='cuda:0') (2.7655604473153517e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.275540
Original XAI WIoU for r=0.9 =  tensor(0.4431, device='cuda:0')  +-  tensor(0.0848, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4496, device='cuda:0')  +-  tensor(0.0888, device='cuda:0') (2.4212536420264996e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:35:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:35:43 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:35:58 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:02 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:04 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:36:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.321
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.456



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.566643
Original XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:0')  +-  tensor(0.1636, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7046, device='cuda:0')  +-  tensor(0.2352, device='cuda:0') (0.00018392888887319714)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.877147
Original XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:0')  +-  tensor(0.1636, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4701, device='cuda:0')  +-  tensor(0.2365, device='cuda:0') (2.6045139378538806e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.826890
Original XAI WIoU for r=0.9 =  tensor(0.3211, device='cuda:0')  +-  tensor(0.1636, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3342, device='cuda:0')  +-  tensor(0.1662, device='cuda:0') (4.298280842363056e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.654895
Original XAI WIoU for r=0.3 =  tensor(0.4560, device='cuda:0')  +-  tensor(0.0850, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9928, device='cuda:0')  +-  tensor(0.0348, device='cuda:0') (2.2213337072529704e-11)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.758646
Original XAI WIoU for r=0.6 =  tensor(0.4560, device='cuda:0')  +-  tensor(0.0850, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6214, device='cuda:0')  +-  tensor(0.1506, device='cuda:0') (6.575148425724819e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.996908
Original XAI WIoU for r=0.9 =  tensor(0.4560, device='cuda:0')  +-  tensor(0.0850, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4612, device='cuda:0')  +-  tensor(0.0866, device='cuda:0') (4.109467433011105e-09)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.32219606 0.32219606 0.32219606] +- [0.0026828 0.0026828 0.0026828]
(id) id_val WIOU_PERTURBED: 	[0.72632964 0.48043473 0.33864405] +- [0.0115884  0.00619628 0.00369129]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.44520326 0.44520326 0.44520326] +- [0.00595847 0.00595847 0.00595847]
(id) val WIOU_PERTURBED: 	[0.99321456 0.61509634 0.45295618] +- [0.00026472 0.00794407 0.00446409]
DONE GSAT GOODMotif/basis 0.65

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:39:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:00 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:12 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:14 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:16 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:20 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.414
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.262
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.226
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.196
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.185



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.114795
Original XAI WIoU for r=0.3 =  tensor(0.4143, device='cuda:0')  +-  tensor(0.2121, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7182, device='cuda:0')  +-  tensor(0.2752, device='cuda:0') (5.7056022342294455e-05)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.380761
Original XAI WIoU for r=0.6 =  tensor(0.4143, device='cuda:0')  +-  tensor(0.2121, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5292, device='cuda:0')  +-  tensor(0.2533, device='cuda:0') (4.859167734849734e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.660518
Original XAI WIoU for r=0.9 =  tensor(0.4143, device='cuda:0')  +-  tensor(0.2121, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4341, device='cuda:0')  +-  tensor(0.2159, device='cuda:0') (4.387134211469856e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.135087
Original XAI WIoU for r=0.3 =  tensor(0.1854, device='cuda:0')  +-  tensor(0.1094, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3460, device='cuda:0')  +-  tensor(0.1922, device='cuda:0') (1.5280276954854344e-07)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.990964
Original XAI WIoU for r=0.6 =  tensor(0.1854, device='cuda:0')  +-  tensor(0.1094, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2493, device='cuda:0')  +-  tensor(0.1678, device='cuda:0') (1.5208277659439773e-07)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.051653
Original XAI WIoU for r=0.9 =  tensor(0.1854, device='cuda:0')  +-  tensor(0.1094, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1951, device='cuda:0')  +-  tensor(0.1147, device='cuda:0') (1.838115082364311e-07)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:44:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:44:49 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:01 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:03 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:04 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.423
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.344
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.334
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.320



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.743878
Original XAI WIoU for r=0.3 =  tensor(0.4232, device='cuda:0')  +-  tensor(0.2026, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6889, device='cuda:0')  +-  tensor(0.2520, device='cuda:0') (5.319288175087422e-05)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.267571
Original XAI WIoU for r=0.6 =  tensor(0.4232, device='cuda:0')  +-  tensor(0.2026, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4961, device='cuda:0')  +-  tensor(0.2161, device='cuda:0') (3.2750788747648585e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.599196
Original XAI WIoU for r=0.9 =  tensor(0.4232, device='cuda:0')  +-  tensor(0.2026, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4365, device='cuda:0')  +-  tensor(0.2024, device='cuda:0') (2.6295037258705634e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.880819
Original XAI WIoU for r=0.3 =  tensor(0.3198, device='cuda:0')  +-  tensor(0.3062, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3577, device='cuda:0')  +-  tensor(0.1673, device='cuda:0') (4.126821995242835e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.997460
Original XAI WIoU for r=0.6 =  tensor(0.3198, device='cuda:0')  +-  tensor(0.3062, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.3013, device='cuda:0')  +-  tensor(0.2338, device='cuda:0') (3.1209741457871587e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.054931
Original XAI WIoU for r=0.9 =  tensor(0.3198, device='cuda:0')  +-  tensor(0.3062, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3226, device='cuda:0')  +-  tensor(0.3038, device='cuda:0') (5.37285060886461e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:49:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:49:46 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:49:58 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:00 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:02 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:05 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.590
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.593
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.592
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.431



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.909818
Original XAI WIoU for r=0.3 =  tensor(0.5922, device='cuda:0')  +-  tensor(0.3091, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8591, device='cuda:0')  +-  tensor(0.2112, device='cuda:0') (0.00033212098060175776)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.982701
Original XAI WIoU for r=0.6 =  tensor(0.5922, device='cuda:0')  +-  tensor(0.3091, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.6785, device='cuda:0')  +-  tensor(0.3071, device='cuda:0') (9.671131451227666e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.603022
Original XAI WIoU for r=0.9 =  tensor(0.5922, device='cuda:0')  +-  tensor(0.3091, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.6017, device='cuda:0')  +-  tensor(0.3048, device='cuda:0') (1.0220912116665204e-08)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.083528
Original XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:0')  +-  tensor(0.3487, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.5988, device='cuda:0')  +-  tensor(0.2711, device='cuda:0') (5.39263478316343e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.219455
Original XAI WIoU for r=0.6 =  tensor(0.4310, device='cuda:0')  +-  tensor(0.3487, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4120, device='cuda:0')  +-  tensor(0.2827, device='cuda:0') (6.792074902506329e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.088447
Original XAI WIoU for r=0.9 =  tensor(0.4310, device='cuda:0')  +-  tensor(0.3487, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4320, device='cuda:0')  +-  tensor(0.3466, device='cuda:0') (3.759607292153078e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:55:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:55:56 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:08 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:10 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:12 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:15 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:22 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.368
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.408
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.411
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.315
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.320
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.322



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.638996
Original XAI WIoU for r=0.3 =  tensor(0.4112, device='cuda:0')  +-  tensor(0.2328, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4769, device='cuda:0')  +-  tensor(0.3239, device='cuda:0') (0.0001754805853124708)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.301151
Original XAI WIoU for r=0.6 =  tensor(0.4112, device='cuda:0')  +-  tensor(0.2328, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.3871, device='cuda:0')  +-  tensor(0.2309, device='cuda:0') (3.434737383400943e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.587454
Original XAI WIoU for r=0.9 =  tensor(0.4112, device='cuda:0')  +-  tensor(0.2328, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3961, device='cuda:0')  +-  tensor(0.2374, device='cuda:0') (4.178190238235402e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.851499
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:0')  +-  tensor(0.3396, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3153, device='cuda:0')  +-  tensor(0.2121, device='cuda:0') (2.512189567482892e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.991815
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:0')  +-  tensor(0.3396, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.3209, device='cuda:0')  +-  tensor(0.3216, device='cuda:0') (6.5682055350180235e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.058294
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:0')  +-  tensor(0.3396, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3159, device='cuda:0')  +-  tensor(0.3407, device='cuda:0') (4.652306095920267e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:01:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:10 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:22 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:24 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:26 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:30 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:36 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.313
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.395
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.397
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.280
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.237
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.241



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.379925
Original XAI WIoU for r=0.3 =  tensor(0.3971, device='cuda:0')  +-  tensor(0.2053, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6216, device='cuda:0')  +-  tensor(0.2979, device='cuda:0') (3.229878711863421e-05)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.762700
Original XAI WIoU for r=0.6 =  tensor(0.3971, device='cuda:0')  +-  tensor(0.2053, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.4670, device='cuda:0')  +-  tensor(0.2713, device='cuda:0') (3.6919260981704838e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.812555
Original XAI WIoU for r=0.9 =  tensor(0.3971, device='cuda:0')  +-  tensor(0.2053, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.4042, device='cuda:0')  +-  tensor(0.2071, device='cuda:0') (3.195943731881812e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.077697
Original XAI WIoU for r=0.3 =  tensor(0.2415, device='cuda:0')  +-  tensor(0.1914, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3830, device='cuda:0')  +-  tensor(0.2267, device='cuda:0') (2.538568022458776e-09)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.217975
Original XAI WIoU for r=0.6 =  tensor(0.2415, device='cuda:0')  +-  tensor(0.1914, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2345, device='cuda:0')  +-  tensor(0.1530, device='cuda:0') (2.7232163191115433e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.106998
Original XAI WIoU for r=0.9 =  tensor(0.2415, device='cuda:0')  +-  tensor(0.1914, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.2451, device='cuda:0')  +-  tensor(0.1878, device='cuda:0') (1.9082644353574096e-09)
len(reference) = 3000


DONE GOODMotif - LECIvGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.44761314 0.44761314 0.44761314] +- [0.07279325 0.07279325 0.07279325]
(id) id_val WIOU_PERTURBED: 	[0.67292328 0.51158072 0.45452967] +- [0.12493716 0.09581207 0.07531412]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.30000606 0.30000606 0.30000606] +- [0.08320286 0.08320286 0.08320286]
(id) val WIOU_PERTURBED: 	[0.40016746 0.30357974 0.30214641] +- [0.10165351 0.06288428 0.08022419]
DONE LECI GOODMotif/size 0.65

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:06:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:06:47 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:06:59 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:01 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:03 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:07 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.534
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.360



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:04.232920
Original XAI WIoU for r=0.8 =  tensor(0.5329, device='cuda:0')  +-  tensor(0.3104, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.5533, device='cuda:0')  +-  tensor(0.3144, device='cuda:0') (3.455562280763047e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.488619
Original XAI WIoU for r=0.8 =  tensor(0.3607, device='cuda:0')  +-  tensor(0.3526, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.3565, device='cuda:0')  +-  tensor(0.3490, device='cuda:0') (1.5007887155249477e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:08:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:34 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:46 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:48 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:53 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.512
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.356



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.433926
Original XAI WIoU for r=0.8 =  tensor(0.5114, device='cuda:0')  +-  tensor(0.3038, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.5131, device='cuda:0')  +-  tensor(0.3052, device='cuda:0') (4.445444012901589e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.475399
Original XAI WIoU for r=0.8 =  tensor(0.3574, device='cuda:0')  +-  tensor(0.3518, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.3435, device='cuda:0')  +-  tensor(0.3465, device='cuda:0') (1.0870652156214078e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:10:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:22 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:34 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:36 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:38 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:41 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.520
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.357



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.336831
Original XAI WIoU for r=0.8 =  tensor(0.5173, device='cuda:0')  +-  tensor(0.3040, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.5265, device='cuda:0')  +-  tensor(0.3086, device='cuda:0') (6.6723315761407775e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.647257
Original XAI WIoU for r=0.8 =  tensor(0.3588, device='cuda:0')  +-  tensor(0.3514, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.3563, device='cuda:0')  +-  tensor(0.3470, device='cuda:0') (1.4889878219292996e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:12:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:11 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:23 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:25 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:27 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:30 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.579
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.411



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.332735
Original XAI WIoU for r=0.8 =  tensor(0.5745, device='cuda:0')  +-  tensor(0.2710, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.5514, device='cuda:0')  +-  tensor(0.2900, device='cuda:0') (3.373650470095413e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.452287
Original XAI WIoU for r=0.8 =  tensor(0.4078, device='cuda:0')  +-  tensor(0.3081, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.3735, device='cuda:0')  +-  tensor(0.3271, device='cuda:0') (1.2342286082045462e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:13:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:13:58 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:10 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:12 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:14 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:17 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.716
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.578



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.314485
Original XAI WIoU for r=0.8 =  tensor(0.7175, device='cuda:0')  +-  tensor(0.2690, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.6614, device='cuda:0')  +-  tensor(0.3144, device='cuda:0') (7.655271083706339e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.618263
Original XAI WIoU for r=0.8 =  tensor(0.5778, device='cuda:0')  +-  tensor(0.2951, device='cuda:0')
Intervened XAI WIoU for r=0.8 =  tensor(0.4753, device='cuda:0')  +-  tensor(0.3206, device='cuda:0') (2.8519839823104576e-09)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.57071018] +- [0.0766256]
(id) id_val WIOU_PERTURBED: 	[0.56113547] +- [0.05237011]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.41252714] +- [0.08479544]
(id) val WIOU_PERTURBED: 	[0.38101786] +- [0.04808104]
DONE CIGA GOODMotif/size 0.65

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:16:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:15 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:27 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:29 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:34 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:16:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.387
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.172
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.157



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.745190
Original XAI WIoU for r=0.3 =  tensor(0.3875, device='cuda:0')  +-  tensor(0.1876, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8080, device='cuda:0')  +-  tensor(0.2362, device='cuda:0') (0.0004793676489498466)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.784751
Original XAI WIoU for r=0.6 =  tensor(0.3875, device='cuda:0')  +-  tensor(0.1876, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5524, device='cuda:0')  +-  tensor(0.2458, device='cuda:0') (4.856391289109752e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.639827
Original XAI WIoU for r=0.9 =  tensor(0.3875, device='cuda:0')  +-  tensor(0.1876, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3993, device='cuda:0')  +-  tensor(0.1896, device='cuda:0') (3.984517604749271e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.889923
Original XAI WIoU for r=0.3 =  tensor(0.1574, device='cuda:0')  +-  tensor(0.0734, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4333, device='cuda:0')  +-  tensor(0.1947, device='cuda:0') (0.0001460877392673865)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.096876
Original XAI WIoU for r=0.6 =  tensor(0.1574, device='cuda:0')  +-  tensor(0.0734, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2318, device='cuda:0')  +-  tensor(0.1092, device='cuda:0') (2.712803759408189e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.224644
Original XAI WIoU for r=0.9 =  tensor(0.1574, device='cuda:0')  +-  tensor(0.0734, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1651, device='cuda:0')  +-  tensor(0.0777, device='cuda:0') (1.700708573970644e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:21:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:21:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:04 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:06 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:08 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:11 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:22:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.397
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.380
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.240
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.168
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.154



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.054875
Original XAI WIoU for r=0.3 =  tensor(0.3798, device='cuda:0')  +-  tensor(0.1846, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7963, device='cuda:0')  +-  tensor(0.2364, device='cuda:0') (0.0003502659674268216)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.792333
Original XAI WIoU for r=0.6 =  tensor(0.3798, device='cuda:0')  +-  tensor(0.1846, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5397, device='cuda:0')  +-  tensor(0.2378, device='cuda:0') (9.04638142174008e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.644079
Original XAI WIoU for r=0.9 =  tensor(0.3798, device='cuda:0')  +-  tensor(0.1846, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3916, device='cuda:0')  +-  tensor(0.1846, device='cuda:0') (5.694944515965972e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.883157
Original XAI WIoU for r=0.3 =  tensor(0.1540, device='cuda:0')  +-  tensor(0.0726, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4268, device='cuda:0')  +-  tensor(0.1921, device='cuda:0') (0.00010529328574193642)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.077658
Original XAI WIoU for r=0.6 =  tensor(0.1540, device='cuda:0')  +-  tensor(0.0726, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2245, device='cuda:0')  +-  tensor(0.1072, device='cuda:0') (2.712803759408189e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.497732
Original XAI WIoU for r=0.9 =  tensor(0.1540, device='cuda:0')  +-  tensor(0.0726, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1613, device='cuda:0')  +-  tensor(0.0745, device='cuda:0') (1.6451752182788937e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:27:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:20 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:32 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:34 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:36 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:39 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:27:46 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.546
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.410
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.385
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.442
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.155



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.587379
Original XAI WIoU for r=0.3 =  tensor(0.3848, device='cuda:0')  +-  tensor(0.1861, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.8010, device='cuda:0')  +-  tensor(0.2320, device='cuda:0') (0.00035179752740077674)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.270207
Original XAI WIoU for r=0.6 =  tensor(0.3848, device='cuda:0')  +-  tensor(0.1861, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5503, device='cuda:0')  +-  tensor(0.2396, device='cuda:0') (4.0817007551652296e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.859717
Original XAI WIoU for r=0.9 =  tensor(0.3848, device='cuda:0')  +-  tensor(0.1861, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3977, device='cuda:0')  +-  tensor(0.1878, device='cuda:0') (3.021013883497403e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.895556
Original XAI WIoU for r=0.3 =  tensor(0.1552, device='cuda:0')  +-  tensor(0.0726, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4306, device='cuda:0')  +-  tensor(0.1976, device='cuda:0') (0.00012671644799411297)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.278457
Original XAI WIoU for r=0.6 =  tensor(0.1552, device='cuda:0')  +-  tensor(0.0726, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2260, device='cuda:0')  +-  tensor(0.1088, device='cuda:0') (2.676707078208551e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.469615
Original XAI WIoU for r=0.9 =  tensor(0.1552, device='cuda:0')  +-  tensor(0.0726, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1625, device='cuda:0')  +-  tensor(0.0760, device='cuda:0') (1.160646911912977e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:32:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:31 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:42 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:44 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:46 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:50 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:32:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.383
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.445
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.156



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.547937
Original XAI WIoU for r=0.3 =  tensor(0.3829, device='cuda:0')  +-  tensor(0.1837, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7965, device='cuda:0')  +-  tensor(0.2343, device='cuda:0') (0.0004318394639994949)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.620145
Original XAI WIoU for r=0.6 =  tensor(0.3829, device='cuda:0')  +-  tensor(0.1837, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5392, device='cuda:0')  +-  tensor(0.2333, device='cuda:0') (3.9262078033175385e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.715981
Original XAI WIoU for r=0.9 =  tensor(0.3829, device='cuda:0')  +-  tensor(0.1837, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3957, device='cuda:0')  +-  tensor(0.1860, device='cuda:0') (3.6402105774158144e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.918062
Original XAI WIoU for r=0.3 =  tensor(0.1558, device='cuda:0')  +-  tensor(0.0717, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4314, device='cuda:0')  +-  tensor(0.1948, device='cuda:0') (0.00014943978749215603)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.135575
Original XAI WIoU for r=0.6 =  tensor(0.1558, device='cuda:0')  +-  tensor(0.0717, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2261, device='cuda:0')  +-  tensor(0.1068, device='cuda:0') (2.5378736889791753e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.505438
Original XAI WIoU for r=0.9 =  tensor(0.1558, device='cuda:0')  +-  tensor(0.0717, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1636, device='cuda:0')  +-  tensor(0.0763, device='cuda:0') (1.3119751951506942e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:37:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:28 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:40 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:42 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:44 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:47 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:37:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.382
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.437
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.169
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.154



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.047044
Original XAI WIoU for r=0.3 =  tensor(0.3825, device='cuda:0')  +-  tensor(0.1861, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.7957, device='cuda:0')  +-  tensor(0.2354, device='cuda:0') (0.00037973347934894264)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.907995
Original XAI WIoU for r=0.6 =  tensor(0.3825, device='cuda:0')  +-  tensor(0.1861, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.5444, device='cuda:0')  +-  tensor(0.2420, device='cuda:0') (4.062264302717722e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.053683
Original XAI WIoU for r=0.9 =  tensor(0.3825, device='cuda:0')  +-  tensor(0.1861, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.3961, device='cuda:0')  +-  tensor(0.1876, device='cuda:0') (3.7540544006731125e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.183507
Original XAI WIoU for r=0.3 =  tensor(0.1544, device='cuda:0')  +-  tensor(0.0727, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4292, device='cuda:0')  +-  tensor(0.1956, device='cuda:0') (0.00010980665683746338)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.296698
Original XAI WIoU for r=0.6 =  tensor(0.1544, device='cuda:0')  +-  tensor(0.0727, device='cuda:0')
Intervened XAI WIoU for r=0.6 =  tensor(0.2278, device='cuda:0')  +-  tensor(0.1073, device='cuda:0') (2.8766271586988523e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.505524
Original XAI WIoU for r=0.9 =  tensor(0.1544, device='cuda:0')  +-  tensor(0.0727, device='cuda:0')
Intervened XAI WIoU for r=0.9 =  tensor(0.1615, device='cuda:0')  +-  tensor(0.0760, device='cuda:0') (1.5785351914487933e-09)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.38347059 0.38347059 0.38347059] +- [0.00255775 0.00255775 0.00255775]
(id) id_val WIOU_PERTURBED: 	[0.79950763 0.54518675 0.39608554] +- [0.00465302 0.00538386 0.00256634]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.15535186 0.15535186 0.15535186] +- [0.00119181 0.00119181 0.00119181]
(id) val WIOU_PERTURBED: 	[0.43025716 0.2272198  0.16279526] +- [0.00216335 0.0025059  0.00142339]
DONE GSAT GOODMotif/size 0.65
DONE all :)
