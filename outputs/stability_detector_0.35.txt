nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 1493359

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Aug  3 23:49:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:49:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.741
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.734
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.734
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.989
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.989
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.989
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.989



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.220044
Original XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7842, device='cuda:1')  +-  tensor(0.2744, device='cuda:1') (0.047275930643081665)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.753970
Original XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6007, device='cuda:1')  +-  tensor(0.3218, device='cuda:1') (0.003820206969976425)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.421914
Original XAI WIoU for r=0.9 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2531, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6167, device='cuda:1')  +-  tensor(0.3040, device='cuda:1') (6.119774464963257e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.176088
Original XAI WIoU for r=0.3 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2449, device='cuda:1') (0.05860615149140358)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:06.784436
Original XAI WIoU for r=0.6 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3727, device='cuda:1')  +-  tensor(0.1642, device='cuda:1') (3.851237551089071e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.576755
Original XAI WIoU for r=0.9 =  tensor(0.9897, device='cuda:1')  +-  tensor(0.0502, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5042, device='cuda:1')  +-  tensor(0.1945, device='cuda:1') (5.1396109590484684e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sat Aug  3 23:56:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/03/2024 11:56:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.770
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.767
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.767
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.995
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.995
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.995
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.995



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.470872
Original XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8267, device='cuda:1')  +-  tensor(0.2553, device='cuda:1') (0.05212226137518883)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.647343
Original XAI WIoU for r=0.6 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6330, device='cuda:1')  +-  tensor(0.3295, device='cuda:1') (0.0044566490687429905)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.880413
Original XAI WIoU for r=0.9 =  tensor(0.7670, device='cuda:1')  +-  tensor(0.2417, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6561, device='cuda:1')  +-  tensor(0.3118, device='cuda:1') (1.1395441035233489e-08)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.749741
Original XAI WIoU for r=0.3 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8450, device='cuda:1')  +-  tensor(0.2053, device='cuda:1') (0.06452349573373795)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.065826
Original XAI WIoU for r=0.6 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4109, device='cuda:1')  +-  tensor(0.1862, device='cuda:1') (3.887334010244103e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.217499
Original XAI WIoU for r=0.9 =  tensor(0.9950, device='cuda:1')  +-  tensor(0.0432, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5381, device='cuda:1')  +-  tensor(0.2524, device='cuda:1') (3.009457429925533e-07)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:12:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:12:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.684
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.697
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.697
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.994
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.994
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.994
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.994



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.667265
Original XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7950, device='cuda:1')  +-  tensor(0.2760, device='cuda:1') (0.03312014043331146)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.871168
Original XAI WIoU for r=0.6 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6618, device='cuda:1')  +-  tensor(0.3166, device='cuda:1') (0.003012463916093111)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.917764
Original XAI WIoU for r=0.9 =  tensor(0.6969, device='cuda:1')  +-  tensor(0.2256, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.5524, device='cuda:1')  +-  tensor(0.2624, device='cuda:1') (2.923830733081445e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.935259
Original XAI WIoU for r=0.3 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7644, device='cuda:1')  +-  tensor(0.2488, device='cuda:1') (0.04842628911137581)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.381264
Original XAI WIoU for r=0.6 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4332, device='cuda:1')  +-  tensor(0.1809, device='cuda:1') (1.5236101091886667e-07)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.535271
Original XAI WIoU for r=0.9 =  tensor(0.9944, device='cuda:1')  +-  tensor(0.0460, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4070, device='cuda:1')  +-  tensor(0.1632, device='cuda:1') (2.8710740451742822e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:16:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:16:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.901
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.905
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.905
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.996
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.996
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.996
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.996



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.643833
Original XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8215, device='cuda:1')  +-  tensor(0.2811, device='cuda:1') (0.054015304893255234)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.657416
Original XAI WIoU for r=0.6 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6813, device='cuda:1')  +-  tensor(0.3284, device='cuda:1') (0.0069929021410644054)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.724569
Original XAI WIoU for r=0.9 =  tensor(0.9049, device='cuda:1')  +-  tensor(0.1937, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7607, device='cuda:1')  +-  tensor(0.3289, device='cuda:1') (4.622109806007302e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.292273
Original XAI WIoU for r=0.3 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6535, device='cuda:1')  +-  tensor(0.2884, device='cuda:1') (0.06921461969614029)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.229123
Original XAI WIoU for r=0.6 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3944, device='cuda:1')  +-  tensor(0.2355, device='cuda:1') (3.300415940543644e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.886516
Original XAI WIoU for r=0.9 =  tensor(0.9965, device='cuda:1')  +-  tensor(0.0489, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3719, device='cuda:1')  +-  tensor(0.1880, device='cuda:1') (4.353814198054806e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:21:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:21:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.716
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.715
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.930
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.927
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.927
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.927



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.659158
Original XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7504, device='cuda:1')  +-  tensor(0.2944, device='cuda:1') (0.04329823702573776)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.670289
Original XAI WIoU for r=0.6 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6249, device='cuda:1')  +-  tensor(0.3137, device='cuda:1') (0.0038856922183185816)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.734273
Original XAI WIoU for r=0.9 =  tensor(0.7154, device='cuda:1')  +-  tensor(0.2482, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6582, device='cuda:1')  +-  tensor(0.3392, device='cuda:1') (9.25601995049874e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.029573
Original XAI WIoU for r=0.3 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6643, device='cuda:1')  +-  tensor(0.2770, device='cuda:1') (0.047865405678749084)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.812466
Original XAI WIoU for r=0.6 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3263, device='cuda:1')  +-  tensor(0.1824, device='cuda:1') (3.366015022265856e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.114296
Original XAI WIoU for r=0.9 =  tensor(0.9276, device='cuda:1')  +-  tensor(0.1148, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3259, device='cuda:1')  +-  tensor(0.1438, device='cuda:1') (3.2990277176736527e-09)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) id_val Accuracy SUFF_SIMPLE: 	[] +- []
(id) id_val Accuracy WIOU_ORIGINAL: 	[0.76367326 0.76367332 0.7636732 ] +- [0.07432533 0.07432533 0.07432535]
(id) id_val Accuracy WIOU_PERTURBED: 	[0.79556464 0.64035987 0.64880512] +- [0.02761178 0.02828566 0.06780248]
(id) val Accuracy SUFF_SIMPLE: 	[] +- []
(id) val Accuracy WIOU_ORIGINAL: 	[0.98065083 0.9806507  0.98065076] +- [0.02661738 0.02661764 0.02661752]
(id) val Accuracy WIOU_PERTURBED: 	[0.73842925 0.38751754 0.42941537] +- [0.07133977 0.03644603 0.079913  ]
DONE LECI GOODMotif2/basis 0.35

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:25:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:25:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.603
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.356



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.369604
Original XAI WIoU for r=0.8 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.2865, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.4499, device='cuda:1')  +-  tensor(0.2605, device='cuda:1') (1.919846539522041e-07)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:04.214437
Original XAI WIoU for r=0.8 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1920, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.2434, device='cuda:1')  +-  tensor(0.1104, device='cuda:1') (2.478175442632846e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:27:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:27:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.512
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.337



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.413024
Original XAI WIoU for r=0.8 =  tensor(0.5115, device='cuda:1')  +-  tensor(0.2630, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.5248, device='cuda:1')  +-  tensor(0.2915, device='cuda:1') (2.585077041317163e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.681528
Original XAI WIoU for r=0.8 =  tensor(0.3371, device='cuda:1')  +-  tensor(0.0888, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.3622, device='cuda:1')  +-  tensor(0.1019, device='cuda:1') (2.976586976899398e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:28:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:28:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.727
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.906



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.570167
Original XAI WIoU for r=0.8 =  tensor(0.7270, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.6028, device='cuda:1')  +-  tensor(0.3146, device='cuda:1') (5.183889584259305e-07)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:04.005523
Original XAI WIoU for r=0.8 =  tensor(0.9059, device='cuda:1')  +-  tensor(0.1089, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.4870, device='cuda:1')  +-  tensor(0.2680, device='cuda:1') (6.383557682454466e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:29:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:29:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.510
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.286



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.550204
Original XAI WIoU for r=0.8 =  tensor(0.5095, device='cuda:1')  +-  tensor(0.2852, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.5123, device='cuda:1')  +-  tensor(0.2844, device='cuda:1') (1.1734194949042376e-08)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.418954
Original XAI WIoU for r=0.8 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.0785, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.3681, device='cuda:1')  +-  tensor(0.1125, device='cuda:1') (3.0765470171445486e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:31:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 12:31:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.471
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.324



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.458738
Original XAI WIoU for r=0.8 =  tensor(0.4711, device='cuda:1')  +-  tensor(0.2612, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.3759, device='cuda:1')  +-  tensor(0.2604, device='cuda:1') (1.085676881729114e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.472134
Original XAI WIoU for r=0.8 =  tensor(0.3235, device='cuda:1')  +-  tensor(0.0936, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.2159, device='cuda:1')  +-  tensor(0.1368, device='cuda:1') (1.2661601767050001e-09)
len(reference) = 3000


DONE GOODMotif2 - CIGAGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.5638744] +- [0.09189802]
(id) id_val WIOU_PERTURBED: 	[0.49315351] +- [0.07618803]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.44159033] +- [0.23328462]
(id) val WIOU_PERTURBED: 	[0.33531492] +- [0.0974888]
DONE CIGA GOODMotif2/basis 0.35

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:32:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:32:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3185
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3441
OOD Validation ACCURACY: 0.8640
OOD Validation Loss: 0.4793
OOD Test ACCURACY: 0.6850
OOD Test Loss: 1.1140

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9250
Train Loss: 0.3289
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3194
ID Test ACCURACY: 0.9213
ID Test Loss: 0.3502
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3665
OOD Test ACCURACY: 0.6453
OOD Test Loss: 0.9689

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6850 0.9213 0.6453 0.9303 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.576
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.333
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.328
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.201
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.153
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.168



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.080968
Original XAI WIoU for r=0.3 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6705, device='cuda:1')  +-  tensor(0.3157, device='cuda:1') (0.0026785442605614662)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.331703
Original XAI WIoU for r=0.6 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4752, device='cuda:1')  +-  tensor(0.2359, device='cuda:1') (0.00025126402033492923)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.717529
Original XAI WIoU for r=0.9 =  tensor(0.3277, device='cuda:1')  +-  tensor(0.1673, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3395, device='cuda:1')  +-  tensor(0.1657, device='cuda:1') (4.4732106907474645e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.640466
Original XAI WIoU for r=0.3 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4226, device='cuda:1')  +-  tensor(0.1467, device='cuda:1') (0.002121252939105034)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.304768
Original XAI WIoU for r=0.6 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2586, device='cuda:1')  +-  tensor(0.0736, device='cuda:1') (2.0825003943514275e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.917876
Original XAI WIoU for r=0.9 =  tensor(0.1680, device='cuda:1')  +-  tensor(0.0481, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1807, device='cuda:1')  +-  tensor(0.0516, device='cuda:1') (1.5216137239093541e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:36:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:36:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 182...
[0m[1;37mINFO[0m: [1mCheckpoint 182: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3197
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3118
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3429
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3727
OOD Test ACCURACY: 0.7160
OOD Test Loss: 0.9099

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 194...
[0m[1;37mINFO[0m: [1mCheckpoint 194: 
-----------------------------------
Train ACCURACY: 0.9302
Train Loss: 0.3212
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9257
ID Test Loss: 0.3419
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3812
OOD Test ACCURACY: 0.6987
OOD Test Loss: 0.8929

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.7160 0.9257 0.6987 0.9347 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.433
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.324
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.323
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.435
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.242
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.174
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.174



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.157331
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6510, device='cuda:1')  +-  tensor(0.3026, device='cuda:1') (0.0024768533185124397)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.606726
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4643, device='cuda:1')  +-  tensor(0.2242, device='cuda:1') (0.0002679899043869227)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.735085
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1641, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1635, device='cuda:1') (2.712803759408189e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.693085
Original XAI WIoU for r=0.3 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4473, device='cuda:1')  +-  tensor(0.1708, device='cuda:1') (0.002096670214086771)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.763156
Original XAI WIoU for r=0.6 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2634, device='cuda:1')  +-  tensor(0.0727, device='cuda:1') (2.6156206089922307e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.914009
Original XAI WIoU for r=0.9 =  tensor(0.1739, device='cuda:1')  +-  tensor(0.0475, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1824, device='cuda:1')  +-  tensor(0.0502, device='cuda:1') (1.8575903037998387e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:40:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:40:46 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 125...
[0m[1;37mINFO[0m: [1mCheckpoint 125: 
-----------------------------------
Train ACCURACY: 0.9305
Train Loss: 0.3203
ID Validation ACCURACY: 0.9370
ID Validation Loss: 0.3167
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3450
OOD Validation ACCURACY: 0.7720
OOD Validation Loss: 0.5765
OOD Test ACCURACY: 0.5833
OOD Test Loss: 1.5578

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9248
Train Loss: 0.3355
ID Validation ACCURACY: 0.9310
ID Validation Loss: 0.3225
ID Test ACCURACY: 0.9200
ID Test Loss: 0.3594
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.3760
OOD Test ACCURACY: 0.7793
OOD Test Loss: 0.9678

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5833 0.9200 0.7793 0.9310 0.9307[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.548
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.442
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.322
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.369
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.210
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.160
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.167



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.328207
Original XAI WIoU for r=0.3 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6487, device='cuda:1')  +-  tensor(0.3045, device='cuda:1') (0.002279123058542609)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.494133
Original XAI WIoU for r=0.6 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4699, device='cuda:1')  +-  tensor(0.2344, device='cuda:1') (0.00022722889843862504)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.650257
Original XAI WIoU for r=0.9 =  tensor(0.3217, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3343, device='cuda:1')  +-  tensor(0.1635, device='cuda:1') (4.614820969806033e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.677110
Original XAI WIoU for r=0.3 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4294, device='cuda:1')  +-  tensor(0.1643, device='cuda:1') (0.0016776520060375333)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.956760
Original XAI WIoU for r=0.6 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2559, device='cuda:1')  +-  tensor(0.0707, device='cuda:1') (2.287973588366299e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.126123
Original XAI WIoU for r=0.9 =  tensor(0.1672, device='cuda:1')  +-  tensor(0.0476, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1796, device='cuda:1')  +-  tensor(0.0500, device='cuda:1') (1.399440230365201e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:45:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:45:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3175
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3091
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3417
OOD Validation ACCURACY: 0.9290
OOD Validation Loss: 0.3763
OOD Test ACCURACY: 0.6370
OOD Test Loss: 1.3612

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9214
Train Loss: 0.3499
ID Validation ACCURACY: 0.9247
ID Validation Loss: 0.3441
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3725
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4342
OOD Test ACCURACY: 0.6417
OOD Test Loss: 1.3495

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.6370 0.9190 0.6417 0.9247 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.328
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.323
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.412
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.234
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.171
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.174



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.835256
Original XAI WIoU for r=0.3 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6373, device='cuda:1')  +-  tensor(0.2954, device='cuda:1') (0.0023852491285651922)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.503977
Original XAI WIoU for r=0.6 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2318, device='cuda:1') (0.00024166305956896394)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.877395
Original XAI WIoU for r=0.9 =  tensor(0.3228, device='cuda:1')  +-  tensor(0.1629, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1637, device='cuda:1') (3.373650470095413e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.657191
Original XAI WIoU for r=0.3 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4352, device='cuda:1')  +-  tensor(0.1624, device='cuda:1') (0.0020634103566408157)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.549583
Original XAI WIoU for r=0.6 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2576, device='cuda:1')  +-  tensor(0.0714, device='cuda:1') (2.0769468367376476e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.900575
Original XAI WIoU for r=0.9 =  tensor(0.1737, device='cuda:1')  +-  tensor(0.0477, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1814, device='cuda:1')  +-  tensor(0.0493, device='cuda:1') (1.4410902471340137e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:49:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 12:49:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 160...
[0m[1;37mINFO[0m: [1mCheckpoint 160: 
-----------------------------------
Train ACCURACY: 0.9314
Train Loss: 0.3115
ID Validation ACCURACY: 0.9367
ID Validation Loss: 0.3032
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3364
OOD Validation ACCURACY: 0.9037
OOD Validation Loss: 0.4375
OOD Test ACCURACY: 0.5013
OOD Test Loss: 1.2586

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.9304
Train Loss: 0.3218
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.3115
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3512
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.4025
OOD Test ACCURACY: 0.6150
OOD Test Loss: 1.1616

[0m[1;37mINFO[0m: [1mChartInfo 0.9260 0.5013 0.9260 0.6150 0.9363 0.9317[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))

Gold ratio (id_val) =  tensor(0.3069) +- tensor(0.1609)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.549
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.338
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.324
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))

Gold ratio (val) =  tensor(0.1607) +- tensor(0.0464)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.407
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.228
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.165
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.171



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.728436
Original XAI WIoU for r=0.3 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6528, device='cuda:1')  +-  tensor(0.3030, device='cuda:1') (0.002421386307105422)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.980171
Original XAI WIoU for r=0.6 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4769, device='cuda:1')  +-  tensor(0.2354, device='cuda:1') (0.00026805922971107066)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.912657
Original XAI WIoU for r=0.9 =  tensor(0.3241, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3383, device='cuda:1')  +-  tensor(0.1653, device='cuda:1') (4.603714298667683e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.631137
Original XAI WIoU for r=0.3 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.1675, device='cuda:1') (0.0021190764382481575)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.748038
Original XAI WIoU for r=0.6 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2604, device='cuda:1')  +-  tensor(0.0722, device='cuda:1') (1.8490406716864527e-07)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.886838
Original XAI WIoU for r=0.9 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0483, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1812, device='cuda:1')  +-  tensor(0.0497, device='cuda:1') (1.488293488449699e-09)
len(reference) = 3000


DONE GOODMotif2 - GSATGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.3238658  0.32386587 0.32386574] +- [0.00206961 0.00206954 0.00206968]
(id) id_val WIOU_PERTURBED: 	[0.65206792 0.47070986 0.33654166] +- [0.01066524 0.00474596 0.00199352]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.17075033 0.17075033 0.17075033] +- [0.00277182 0.00277182 0.00277182]
(id) val WIOU_PERTURBED: 	[0.43558857 0.2591767  0.18107073] +- [0.00901256 0.00254856 0.0009106 ]
DONE GSAT GOODMotif2/basis 0.35

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:53:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:33 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:46 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:48 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:53 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:53 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:53 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:53:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.754
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.765
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.765
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.892
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.282273
Original XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(nan, device='cuda:1')  +-  tensor(nan, device='cuda:1') (nan)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.756289
Original XAI WIoU for r=0.6 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5799, device='cuda:1')  +-  tensor(0.2653, device='cuda:1') (0.0017406352562829852)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.680642
Original XAI WIoU for r=0.9 =  tensor(0.7649, device='cuda:1')  +-  tensor(0.2609, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7051, device='cuda:1')  +-  tensor(0.3088, device='cuda:1') (3.165400386251349e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.432957
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9615, device='cuda:1')  +-  tensor(0.1153, device='cuda:1') (0.0020063717383891344)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.620688
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9936, device='cuda:1')  +-  tensor(0.0301, device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.622831
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 00:57:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:34 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:46 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:48 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 12:57:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.747
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.750
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.750
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.747230
Original XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7700, device='cuda:1')  +-  tensor(0.2777, device='cuda:1') (0.046701863408088684)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.646858
Original XAI WIoU for r=0.6 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5643, device='cuda:1')  +-  tensor(0.3167, device='cuda:1') (0.0029854781460016966)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.741976
Original XAI WIoU for r=0.9 =  tensor(0.7502, device='cuda:1')  +-  tensor(0.2537, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6056, device='cuda:1')  +-  tensor(0.2955, device='cuda:1') (2.193567105734928e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.898683
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9981, device='cuda:1')  +-  tensor(0.0098, device='cuda:1') (0.0032037333585321903)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.587737
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9843, device='cuda:1')  +-  tensor(0.0446, device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.431051
Original XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:00:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:00:57 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:10 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:12 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:14 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:15 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:01:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.789
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.789
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.789
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.884
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.680498
Original XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8603, device='cuda:1')  +-  tensor(0.2261, device='cuda:1') (0.048919983208179474)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.681636
Original XAI WIoU for r=0.6 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.7198, device='cuda:1')  +-  tensor(0.2932, device='cuda:1') (0.003585664089769125)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.046949
Original XAI WIoU for r=0.9 =  tensor(0.7890, device='cuda:1')  +-  tensor(0.2203, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6535, device='cuda:1')  +-  tensor(0.3183, device='cuda:1') (2.5090658439808067e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.917636
Original XAI WIoU for r=0.3 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9983, device='cuda:1')  +-  tensor(0.0257, device='cuda:1') (4.442667414505941e-11)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.140838
Original XAI WIoU for r=0.6 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.968958
Original XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0004, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:04:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:10 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:28 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:31 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:34 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:35 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:04:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.830
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.824
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.824
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.888
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.980
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.980
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.980



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.645560
Original XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7791, device='cuda:1')  +-  tensor(0.2609, device='cuda:1') (0.05351397767663002)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.653678
Original XAI WIoU for r=0.6 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5735, device='cuda:1')  +-  tensor(0.2663, device='cuda:1') (0.003987790551036596)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.705023
Original XAI WIoU for r=0.9 =  tensor(0.8237, device='cuda:1')  +-  tensor(0.2282, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.7152, device='cuda:1')  +-  tensor(0.3061, device='cuda:1') (2.6156206089922307e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.550664
Original XAI WIoU for r=0.3 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9688, device='cuda:1')  +-  tensor(0.1154, device='cuda:1') (0.0024611682165414095)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:05.116865
Original XAI WIoU for r=0.6 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9645, device='cuda:1')  +-  tensor(0.0711, device='cuda:1') (6.952774800339512e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.609229
Original XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9801, device='cuda:1')  +-  tensor(0.0528, device='cuda:1') (5.975387296075496e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:07:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:27 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:44 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:47 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:07:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.802
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.800
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.800
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 1.000
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.486881
Original XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7741, device='cuda:1')  +-  tensor(0.2719, device='cuda:1') (0.05037418007850647)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.470170
Original XAI WIoU for r=0.6 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6012, device='cuda:1')  +-  tensor(0.3152, device='cuda:1') (0.006026469636708498)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.742542
Original XAI WIoU for r=0.9 =  tensor(0.7997, device='cuda:1')  +-  tensor(0.2459, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6631, device='cuda:1')  +-  tensor(0.3346, device='cuda:1') (2.111655295067294e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.502152
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9960, device='cuda:1')  +-  tensor(0.0174, device='cuda:1') (0.006505770143121481)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.517805
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9529, device='cuda:1')  +-  tensor(0.0834, device='cuda:1') (4.7314410167587084e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.683488
Original XAI WIoU for r=0.9 =  tensor(1.0000, device='cuda:1')  +-  tensor(0.0002, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0014, device='cuda:1') (1.9547736762604018e-09)
len(reference) = 3000


DONE GOODMotif - LECIGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.78548733 0.78548733 0.78548733] +- [0.02587127 0.02587127 0.02587127]
(id) id_val WIOU_PERTURBED: 	[       nan 0.60774709 0.66851211] +- [       nan 0.05732079 0.03932034]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.99601128 0.99601128 0.99601128] +- [0.00793648 0.00793648 0.00793648]
(id) val WIOU_PERTURBED: 	[0.98453473 0.97905172 0.9960122 ] +- [0.01603576 0.01774642 0.00793635]
DONE LECI GOODMotif/basis 0.35

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:11:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:22 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:37 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:40 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:43 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:45 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:11:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.471403
Original XAI WIoU for r=0.6 =  tensor(0.7376, device='cuda:1')  +-  tensor(0.2729, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5580, device='cuda:1')  +-  tensor(0.3265, device='cuda:1') (0.0016154220793396235)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.269217
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0057, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9987, device='cuda:1')  +-  tensor(0.0114, device='cuda:1') (1.7770669658023763e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:12:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:12:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:06 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:08 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:11 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:13 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:13:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.383361
Original XAI WIoU for r=0.6 =  tensor(0.6962, device='cuda:1')  +-  tensor(0.2686, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5654, device='cuda:1')  +-  tensor(0.3198, device='cuda:1') (0.0030245312955230474)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.496480
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9999, device='cuda:1')  +-  tensor(0.0044, device='cuda:1') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:14:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:07 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:21 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:24 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:26 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:28 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:29 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:29 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:14:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.562
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.368822
Original XAI WIoU for r=0.6 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.2147, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5616, device='cuda:1')  +-  tensor(0.3047, device='cuda:1') (0.0012073895195499063)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.278955
Original XAI WIoU for r=0.6 =  tensor(0.9995, device='cuda:1')  +-  tensor(0.0017, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9939, device='cuda:1')  +-  tensor(0.0231, device='cuda:1') (1.2950375882780918e-08)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:15:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:27 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:42 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:44 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:47 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:50 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:15:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.544
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.924650
Original XAI WIoU for r=0.6 =  tensor(0.5418, device='cuda:1')  +-  tensor(0.2566, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5642, device='cuda:1')  +-  tensor(0.3055, device='cuda:1') (0.0017051189206540585)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.454150
Original XAI WIoU for r=0.6 =  tensor(1.0000, device='cuda:1')  +-  tensor(7.2843e-05, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9987, device='cuda:1')  +-  tensor(0.0127, device='cuda:1') (4.220534477461513e-10)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:16:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:16:48 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:04 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:07 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:09 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:11 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 01:17:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.723
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 1.000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.597160
Original XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2769, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5615, device='cuda:1')  +-  tensor(0.3226, device='cuda:1') (0.0014798053307458758)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.6


Computing with masking
Completed in  0:00:03.277203
Original XAI WIoU for r=0.6 =  tensor(1., device='cuda:1')  +-  tensor(0., device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.9998, device='cuda:1')  +-  tensor(0.0031, device='cuda:1') (4.131680775287805e-09)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.65580264] +- [0.08244707]
(id) id_val WIOU_PERTURBED: 	[0.56214427] +- [0.0025495]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.99980891] +- [0.0002322]
(id) val WIOU_PERTURBED: 	[0.9981909] +- [0.00220275]
DONE CIGA GOODMotif/basis 0.35

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:18:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:18 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:31 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:33 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:35 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:37 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:18:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.343
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.318
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.477
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.438



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.734475
Original XAI WIoU for r=0.3 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6654, device='cuda:1')  +-  tensor(0.3081, device='cuda:1') (0.0017866455018520355)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.541524
Original XAI WIoU for r=0.6 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4836, device='cuda:1')  +-  tensor(0.2475, device='cuda:1') (0.0001633144565857947)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.612618
Original XAI WIoU for r=0.9 =  tensor(0.3183, device='cuda:1')  +-  tensor(0.1621, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3357, device='cuda:1')  +-  tensor(0.1661, device='cuda:1') (1.918676995060764e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.517419
Original XAI WIoU for r=0.3 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9137, device='cuda:1')  +-  tensor(0.1325, device='cuda:1') (0.00031773277441971004)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.497517
Original XAI WIoU for r=0.6 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6001, device='cuda:1')  +-  tensor(0.1499, device='cuda:1') (7.119375311503973e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.480122
Original XAI WIoU for r=0.9 =  tensor(0.4379, device='cuda:1')  +-  tensor(0.0807, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4539, device='cuda:1')  +-  tensor(0.0897, device='cuda:1') (4.276067500086356e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:22:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:11 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:24 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:26 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:28 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:30 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:22:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.488
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.351
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.327
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.783
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.695
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.443



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.531818
Original XAI WIoU for r=0.3 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6733, device='cuda:1')  +-  tensor(0.3036, device='cuda:1') (0.0022633769549429417)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.321635
Original XAI WIoU for r=0.6 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4874, device='cuda:1')  +-  tensor(0.2424, device='cuda:1') (0.00016067890101112425)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.604986
Original XAI WIoU for r=0.9 =  tensor(0.3266, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3450, device='cuda:1')  +-  tensor(0.1732, device='cuda:1') (3.095983913681266e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.428008
Original XAI WIoU for r=0.3 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9195, device='cuda:1')  +-  tensor(0.1258, device='cuda:1') (0.0005130023346282542)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.469075
Original XAI WIoU for r=0.6 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6218, device='cuda:1')  +-  tensor(0.1592, device='cuda:1') (6.70842803529581e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.298485
Original XAI WIoU for r=0.9 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.0872, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4491, device='cuda:1')  +-  tensor(0.0897, device='cuda:1') (6.65289467960406e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:26:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:44 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:57 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:26:59 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:01 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:03 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:27:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.584
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.347
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.323
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.698
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.485
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.446



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.752833
Original XAI WIoU for r=0.3 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6684, device='cuda:1')  +-  tensor(0.3041, device='cuda:1') (0.002516980515792966)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.529700
Original XAI WIoU for r=0.6 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4812, device='cuda:1')  +-  tensor(0.2408, device='cuda:1') (0.00020613340893760324)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.598059
Original XAI WIoU for r=0.9 =  tensor(0.3230, device='cuda:1')  +-  tensor(0.1654, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3394, device='cuda:1')  +-  tensor(0.1679, device='cuda:1') (4.83519102090213e-07)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.403573
Original XAI WIoU for r=0.3 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9161, device='cuda:1')  +-  tensor(0.1296, device='cuda:1') (0.0004565230628941208)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.437815
Original XAI WIoU for r=0.6 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6174, device='cuda:1')  +-  tensor(0.1548, device='cuda:1') (5.0979616084134705e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.993579
Original XAI WIoU for r=0.9 =  tensor(0.4456, device='cuda:1')  +-  tensor(0.0849, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4509, device='cuda:1')  +-  tensor(0.0869, device='cuda:1') (4.264960828948006e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:31:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:13 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:29 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:31 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:33 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:35 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:37 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:37 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:31:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:31:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:31:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.474
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.341
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.322
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.782
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.483
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.443



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.748934
Original XAI WIoU for r=0.3 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6719, device='cuda:1')  +-  tensor(0.3100, device='cuda:1') (0.002018819795921445)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.866300
Original XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4767, device='cuda:1')  +-  tensor(0.2393, device='cuda:1') (0.0001825654471758753)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.620027
Original XAI WIoU for r=0.9 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1642, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3389, device='cuda:1')  +-  tensor(0.1689, device='cuda:1') (4.537074271837582e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.624698
Original XAI WIoU for r=0.3 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9157, device='cuda:1')  +-  tensor(0.1294, device='cuda:1') (0.00035248015774413943)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.377529
Original XAI WIoU for r=0.6 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6149, device='cuda:1')  +-  tensor(0.1550, device='cuda:1') (2.7655604473153517e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.256699
Original XAI WIoU for r=0.9 =  tensor(0.4431, device='cuda:1')  +-  tensor(0.0848, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4496, device='cuda:1')  +-  tensor(0.0888, device='cuda:1') (2.4212536420264996e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:35:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:35:38 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:35:52 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:35:55 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:35:57 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:35:58 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 01:36:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))

Gold ratio (id_val) =  tensor(0.3045) +- tensor(0.1614)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.535
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.450
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.330
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.321
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))

Gold ratio (val) =  tensor(0.4122) +- tensor(0.0828)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.784
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.706
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.495
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.456



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.521067
Original XAI WIoU for r=0.3 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6483, device='cuda:1')  +-  tensor(0.2935, device='cuda:1') (0.002164003672078252)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.736501
Original XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4695, device='cuda:1')  +-  tensor(0.2373, device='cuda:1') (0.00015990129031706601)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.239513
Original XAI WIoU for r=0.9 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.1636, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3342, device='cuda:1')  +-  tensor(0.1662, device='cuda:1') (4.284397281395513e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.670697
Original XAI WIoU for r=0.3 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.9162, device='cuda:1')  +-  tensor(0.1292, device='cuda:1') (0.0005644807242788374)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.038400
Original XAI WIoU for r=0.6 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6214, device='cuda:1')  +-  tensor(0.1506, device='cuda:1') (6.575148425724819e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.700037
Original XAI WIoU for r=0.9 =  tensor(0.4560, device='cuda:1')  +-  tensor(0.0850, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4612, device='cuda:1')  +-  tensor(0.0866, device='cuda:1') (4.109467433011105e-09)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.32219606 0.32219606 0.32219606] +- [0.0026828 0.0026828 0.0026828]
(id) id_val WIOU_PERTURBED: 	[0.66545593 0.47966049 0.33863742] +- [0.00902082 0.00615739 0.00370168]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.44520326 0.44520326 0.44520326] +- [0.00595847 0.00595847 0.00595847]
(id) val WIOU_PERTURBED: 	[0.91624715 0.61509634 0.45295618] +- [0.00185146 0.00794407 0.00446409]
DONE GSAT GOODMotif/basis 0.35

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:39:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:00 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:12 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:14 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:16 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:20 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:40:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.414
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.262
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.226
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.196
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.185



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.896975
Original XAI WIoU for r=0.3 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7001, device='cuda:1')  +-  tensor(0.2919, device='cuda:1') (0.002460549119859934)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.545528
Original XAI WIoU for r=0.6 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5289, device='cuda:1')  +-  tensor(0.2537, device='cuda:1') (6.756332822988043e-06)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.647196
Original XAI WIoU for r=0.9 =  tensor(0.4143, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4341, device='cuda:1')  +-  tensor(0.2159, device='cuda:1') (4.381580875900681e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.150851
Original XAI WIoU for r=0.3 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3402, device='cuda:1')  +-  tensor(0.1975, device='cuda:1') (0.0009990173857659101)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.978817
Original XAI WIoU for r=0.6 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2493, device='cuda:1')  +-  tensor(0.1678, device='cuda:1') (3.0112956572736493e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.041938
Original XAI WIoU for r=0.9 =  tensor(0.1854, device='cuda:1')  +-  tensor(0.1094, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1951, device='cuda:1')  +-  tensor(0.1147, device='cuda:1') (1.8380595179223747e-07)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:44:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:44:43 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:44:55 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:44:57 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:44:59 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:02 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:45:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.437
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.423
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.344
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.334
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.325
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.320



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.692706
Original XAI WIoU for r=0.3 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6681, device='cuda:1')  +-  tensor(0.2716, device='cuda:1') (0.003830148372799158)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.278805
Original XAI WIoU for r=0.6 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4955, device='cuda:1')  +-  tensor(0.2167, device='cuda:1') (0.00018887566693592817)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.662732
Original XAI WIoU for r=0.9 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2026, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4365, device='cuda:1')  +-  tensor(0.2024, device='cuda:1') (2.6295037258705634e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.883111
Original XAI WIoU for r=0.3 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3480, device='cuda:1')  +-  tensor(0.1754, device='cuda:1') (0.0038086394779384136)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.963961
Original XAI WIoU for r=0.6 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3012, device='cuda:1')  +-  tensor(0.2338, device='cuda:1') (3.1348572626654914e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.046982
Original XAI WIoU for r=0.9 =  tensor(0.3198, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3226, device='cuda:1')  +-  tensor(0.3038, device='cuda:1') (5.378404832612205e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:49:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:49:43 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:49:55 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:49:57 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:49:59 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:02 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:08 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:50:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.590
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.593
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.592
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.436
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.432
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.431



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.170331
Original XAI WIoU for r=0.3 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.8296, device='cuda:1')  +-  tensor(0.2519, device='cuda:1') (0.015559765510261059)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.385566
Original XAI WIoU for r=0.6 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.6766, device='cuda:1')  +-  tensor(0.3096, device='cuda:1') (0.00038868331466801465)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.666089
Original XAI WIoU for r=0.9 =  tensor(0.5922, device='cuda:1')  +-  tensor(0.3091, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.6017, device='cuda:1')  +-  tensor(0.3048, device='cuda:1') (1.0243125458941904e-08)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.181160
Original XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2944, device='cuda:1') (0.01186809316277504)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.257673
Original XAI WIoU for r=0.6 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4120, device='cuda:1')  +-  tensor(0.2827, device='cuda:1') (6.780968231367979e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.291587
Original XAI WIoU for r=0.9 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.3487, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4320, device='cuda:1')  +-  tensor(0.3466, device='cuda:1') (3.759607292153078e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 01:55:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 01:55:52 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:04 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:06 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:08 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:11 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 01:56:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.368
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.408
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.411
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.313
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.315
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.320
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.322



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.060330
Original XAI WIoU for r=0.3 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.4620, device='cuda:1')  +-  tensor(0.3255, device='cuda:1') (0.005260286387056112)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.784530
Original XAI WIoU for r=0.6 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3870, device='cuda:1')  +-  tensor(0.2309, device='cuda:1') (0.00027454583323560655)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.565556
Original XAI WIoU for r=0.9 =  tensor(0.4112, device='cuda:1')  +-  tensor(0.2328, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3963, device='cuda:1')  +-  tensor(0.2373, device='cuda:1') (4.1754133484062095e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.860916
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3069, device='cuda:1')  +-  tensor(0.2152, device='cuda:1') (0.004949943628162146)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.965624
Original XAI WIoU for r=0.6 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.3209, device='cuda:1')  +-  tensor(0.3216, device='cuda:1') (6.576536204505601e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.037805
Original XAI WIoU for r=0.9 =  tensor(0.3225, device='cuda:1')  +-  tensor(0.3396, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3159, device='cuda:1')  +-  tensor(0.3407, device='cuda:1') (4.653693874701048e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:01:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:05 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:17 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:19 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:21 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:24 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 02:01:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.313
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.395
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.397
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.280
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.237
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.241



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.613603
Original XAI WIoU for r=0.3 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.6007, device='cuda:1')  +-  tensor(0.3058, device='cuda:1') (0.006952022667974234)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.383709
Original XAI WIoU for r=0.6 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.4669, device='cuda:1')  +-  tensor(0.2713, device='cuda:1') (0.00011781030480051413)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.796992
Original XAI WIoU for r=0.9 =  tensor(0.3971, device='cuda:1')  +-  tensor(0.2053, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.4042, device='cuda:1')  +-  tensor(0.2071, device='cuda:1') (3.2098275148939592e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.076356
Original XAI WIoU for r=0.3 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.2307, device='cuda:1') (0.0005091316415928304)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.200130
Original XAI WIoU for r=0.6 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2345, device='cuda:1')  +-  tensor(0.1531, device='cuda:1') (2.7232163191115433e-09)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.039220
Original XAI WIoU for r=0.9 =  tensor(0.2415, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.2451, device='cuda:1')  +-  tensor(0.1878, device='cuda:1') (1.9082644353574096e-09)
len(reference) = 3000


DONE GOODMotif - LECIvGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.44761314 0.44761314 0.44761314] +- [0.07279325 0.07279325 0.07279325]
(id) id_val WIOU_PERTURBED: 	[0.65211272 0.51099182 0.45455886] +- [0.12067704 0.09519771 0.07529012]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.30000606 0.30000606 0.30000606] +- [0.08320286 0.08320286 0.08320286]
(id) val WIOU_PERTURBED: 	[0.39055443 0.30359313 0.30214749] +- [0.09647853 0.06287782 0.08022624]
DONE LECI GOODMotif/size 0.35

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:06:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:06:47 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:00 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:01 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:04 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:07 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:07:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.535
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.360



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.694068
Original XAI WIoU for r=0.8 =  tensor(0.5329, device='cuda:1')  +-  tensor(0.3104, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.5532, device='cuda:1')  +-  tensor(0.3145, device='cuda:1') (3.477775845084352e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.433266
Original XAI WIoU for r=0.8 =  tensor(0.3607, device='cuda:1')  +-  tensor(0.3526, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.3567, device='cuda:1')  +-  tensor(0.3490, device='cuda:1') (1.5118952756409954e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:08:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:34 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:46 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:48 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:08:53 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:09:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.512
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.356



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.340639
Original XAI WIoU for r=0.8 =  tensor(0.5114, device='cuda:1')  +-  tensor(0.3038, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.5131, device='cuda:1')  +-  tensor(0.3053, device='cuda:1') (4.423230670624889e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.488719
Original XAI WIoU for r=0.8 =  tensor(0.3574, device='cuda:1')  +-  tensor(0.3518, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.3437, device='cuda:1')  +-  tensor(0.3465, device='cuda:1') (1.0773468783753515e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:10:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:22 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:34 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:36 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:38 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:42 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:10:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.520
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.357



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.262561
Original XAI WIoU for r=0.8 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.3040, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.5263, device='cuda:1')  +-  tensor(0.3085, device='cuda:1') (6.622351111928992e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.565880
Original XAI WIoU for r=0.8 =  tensor(0.3588, device='cuda:1')  +-  tensor(0.3514, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.3562, device='cuda:1')  +-  tensor(0.3470, device='cuda:1') (1.5236961692366435e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:12:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:13 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:24 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:26 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:28 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:32 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:12:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.579
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.411



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.257572
Original XAI WIoU for r=0.8 =  tensor(0.5745, device='cuda:1')  +-  tensor(0.2710, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.5507, device='cuda:1')  +-  tensor(0.2897, device='cuda:1') (3.395864034416718e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.391773
Original XAI WIoU for r=0.8 =  tensor(0.4078, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.3735, device='cuda:1')  +-  tensor(0.3271, device='cuda:1') (1.2619951750281189e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:14:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:01 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:13 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:15 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:17 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:20 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 08/04/2024 02:14:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.716
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.578



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.283888
Original XAI WIoU for r=0.8 =  tensor(0.7175, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.6612, device='cuda:1')  +-  tensor(0.3141, device='cuda:1') (7.633058629608058e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.8


Computing with masking
Completed in  0:00:03.476779
Original XAI WIoU for r=0.8 =  tensor(0.5778, device='cuda:1')  +-  tensor(0.2951, device='cuda:1')
Intervened XAI WIoU for r=0.8 =  tensor(0.4754, device='cuda:1')  +-  tensor(0.3206, device='cuda:1') (2.841571866696313e-09)
len(reference) = 3000


DONE GOODMotif - CIGAGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.57071018] +- [0.0766256]
(id) id_val WIOU_PERTURBED: 	[0.5608884] +- [0.05235787]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.41252714] +- [0.08479544]
(id) val WIOU_PERTURBED: 	[0.38109839] +- [0.04807751]
DONE CIGA GOODMotif/size 0.35

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:16:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:15 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:27 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:29 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:31 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:35 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:16:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.9274
Train Loss: 0.3249
ID Validation ACCURACY: 0.9343
ID Validation Loss: 0.3005
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3247
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4865
OOD Test ACCURACY: 0.4907
OOD Test Loss: 2.1636

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 84...
[0m[1;37mINFO[0m: [1mCheckpoint 84: 
-----------------------------------
Train ACCURACY: 0.9263
Train Loss: 0.3304
ID Validation ACCURACY: 0.9323
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3315
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4661
OOD Test ACCURACY: 0.5197
OOD Test Loss: 1.7017

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4907 0.9280 0.5197 0.9323 0.9040[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.624
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.543
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.409
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.387
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.443
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.172
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.157



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.859367
Original XAI WIoU for r=0.3 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7562, device='cuda:1')  +-  tensor(0.2956, device='cuda:1') (0.002213689498603344)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.865888
Original XAI WIoU for r=0.6 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5500, device='cuda:1')  +-  tensor(0.2495, device='cuda:1') (0.00037036772118881345)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.709952
Original XAI WIoU for r=0.9 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3993, device='cuda:1')  +-  tensor(0.1896, device='cuda:1') (4.003954057196779e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.047983
Original XAI WIoU for r=0.3 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3988, device='cuda:1')  +-  tensor(0.2296, device='cuda:1') (0.0013576612109318376)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.170075
Original XAI WIoU for r=0.6 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2313, device='cuda:1')  +-  tensor(0.1100, device='cuda:1') (0.00015383349091280252)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.389733
Original XAI WIoU for r=0.9 =  tensor(0.1574, device='cuda:1')  +-  tensor(0.0734, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1652, device='cuda:1')  +-  tensor(0.0777, device='cuda:1') (1.711815467153599e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:22:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:00 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:12 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:14 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:16 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:20 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:27 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:27 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:27 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:22:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:22:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 122...
[0m[1;37mINFO[0m: [1mCheckpoint 122: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3371
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.3138
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3425
OOD Validation ACCURACY: 0.8697
OOD Validation Loss: 0.5698
OOD Test ACCURACY: 0.5503
OOD Test Loss: 1.5812

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ACCURACY: 0.9264
Train Loss: 0.3343
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3132
ID Test ACCURACY: 0.9273
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4750
OOD Test ACCURACY: 0.5800
OOD Test Loss: 2.8730

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5503 0.9273 0.5800 0.9327 0.9030[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.526
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.397
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.380
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.240
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.168
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.154



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.893073
Original XAI WIoU for r=0.3 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7444, device='cuda:1')  +-  tensor(0.2940, device='cuda:1') (0.0015089097432792187)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.905437
Original XAI WIoU for r=0.6 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5374, device='cuda:1')  +-  tensor(0.2412, device='cuda:1') (0.0003213454911019653)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.745355
Original XAI WIoU for r=0.9 =  tensor(0.3798, device='cuda:1')  +-  tensor(0.1846, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3916, device='cuda:1')  +-  tensor(0.1846, device='cuda:1') (5.706050743015112e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.089023
Original XAI WIoU for r=0.3 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3921, device='cuda:1')  +-  tensor(0.2271, device='cuda:1') (0.0010334501275792718)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.255492
Original XAI WIoU for r=0.6 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2239, device='cuda:1')  +-  tensor(0.1079, device='cuda:1') (0.0001258505944861099)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.561024
Original XAI WIoU for r=0.9 =  tensor(0.1540, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1613, device='cuda:1')  +-  tensor(0.0745, device='cuda:1') (1.6410103276243149e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:27:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:38 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:50 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:52 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:54 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:27:59 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:07 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:07 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:28:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:08 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:08 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:28:08 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:28:08 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3328
ID Validation ACCURACY: 0.9347
ID Validation Loss: 0.3080
ID Test ACCURACY: 0.9293
ID Test Loss: 0.3378
OOD Validation ACCURACY: 0.8910
OOD Validation Loss: 0.5238
OOD Test ACCURACY: 0.4787
OOD Test Loss: 2.2870

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3400
ID Validation ACCURACY: 0.9327
ID Validation Loss: 0.3125
ID Test ACCURACY: 0.9237
ID Test Loss: 0.3418
OOD Validation ACCURACY: 0.9017
OOD Validation Loss: 0.4991
OOD Test ACCURACY: 0.6000
OOD Test Loss: 1.5258

[0m[1;37mINFO[0m: [1mChartInfo 0.9293 0.4787 0.9237 0.6000 0.9327 0.9017[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.615
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.545
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.410
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.385
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.442
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.244
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.155



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.719125
Original XAI WIoU for r=0.3 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7483, device='cuda:1')  +-  tensor(0.2919, device='cuda:1') (0.0015561080072075129)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.907736
Original XAI WIoU for r=0.6 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5480, device='cuda:1')  +-  tensor(0.2429, device='cuda:1') (0.0003637686022557318)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.973110
Original XAI WIoU for r=0.9 =  tensor(0.3848, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3977, device='cuda:1')  +-  tensor(0.1878, device='cuda:1') (2.9793638667285904e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.109583
Original XAI WIoU for r=0.3 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3979, device='cuda:1')  +-  tensor(0.2312, device='cuda:1') (0.0008975643431767821)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.387729
Original XAI WIoU for r=0.6 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2253, device='cuda:1')  +-  tensor(0.1095, device='cuda:1') (0.0001681104040471837)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.094196
Original XAI WIoU for r=0.9 =  tensor(0.1552, device='cuda:1')  +-  tensor(0.0726, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1625, device='cuda:1')  +-  tensor(0.0761, device='cuda:1') (1.1634235796975645e-09)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:33:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:04 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:19 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:22 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:25 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:29 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:33:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 135...
[0m[1;37mINFO[0m: [1mCheckpoint 135: 
-----------------------------------
Train ACCURACY: 0.9276
Train Loss: 0.3309
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3021
ID Test ACCURACY: 0.9290
ID Test Loss: 0.3333
OOD Validation ACCURACY: 0.9093
OOD Validation Loss: 0.4749
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.2733

[0m[1;37mINFO[0m: [1mChartInfo 0.9290 0.5283 0.9290 0.5283 0.9337 0.9093[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.614
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.529
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.383
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.445
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.246
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.170
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.156



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.691282
Original XAI WIoU for r=0.3 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7461, device='cuda:1')  +-  tensor(0.2921, device='cuda:1') (0.001915748929604888)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.722351
Original XAI WIoU for r=0.6 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5367, device='cuda:1')  +-  tensor(0.2368, device='cuda:1') (0.0003233441384509206)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.558634
Original XAI WIoU for r=0.9 =  tensor(0.3829, device='cuda:1')  +-  tensor(0.1837, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3956, device='cuda:1')  +-  tensor(0.1860, device='cuda:1') (3.654093694294147e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.085664
Original XAI WIoU for r=0.3 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3979, device='cuda:1')  +-  tensor(0.2284, device='cuda:1') (0.0011503376299515367)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.746610
Original XAI WIoU for r=0.6 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2255, device='cuda:1')  +-  tensor(0.1076, device='cuda:1') (0.00016148589202202857)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:05.021914
Original XAI WIoU for r=0.9 =  tensor(0.1558, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1636, device='cuda:1')  +-  tensor(0.0763, device='cuda:1') (1.5035568878829508e-07)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 02:38:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:20 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:36 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:38 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:43 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 08/04/2024 02:38:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3330
ID Validation ACCURACY: 0.9337
ID Validation Loss: 0.3044
ID Test ACCURACY: 0.9297
ID Test Loss: 0.3362
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4896
OOD Test ACCURACY: 0.5230
OOD Test Loss: 2.0987

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9253
Train Loss: 0.3396
ID Validation ACCURACY: 0.9320
ID Validation Loss: 0.3109
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3440
OOD Validation ACCURACY: 0.9000
OOD Validation Loss: 0.4703
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.1198

[0m[1;37mINFO[0m: [1mChartInfo 0.9297 0.5230 0.9260 0.5683 0.9320 0.9000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))

Gold ratio (id_val) =  tensor(0.3588) +- tensor(0.1832)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.602
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.534
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.404
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.382
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))

Gold ratio (val) =  tensor(0.1399) +- tensor(0.0666)
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.437
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.243
F1 for r=0.9 = 0.000
WIoU for r=0.9 = 0.169
F1 for r=1.0 = 0.000
WIoU for r=1.0 = 0.154



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.852493
Original XAI WIoU for r=0.3 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.7453, device='cuda:1')  +-  tensor(0.2920, device='cuda:1') (0.0017027572030201554)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:03.870773
Original XAI WIoU for r=0.6 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.5424, device='cuda:1')  +-  tensor(0.2453, device='cuda:1') (0.0003540478937793523)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:03.897021
Original XAI WIoU for r=0.9 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.1861, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.3961, device='cuda:1')  +-  tensor(0.1876, device='cuda:1') (3.767937517551445e-09)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.014729
Original XAI WIoU for r=0.3 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.3 =  tensor(0.3956, device='cuda:1')  +-  tensor(0.2294, device='cuda:1') (0.0011448434088379145)
len(reference) = 3000


ratio=0.6


Computing with masking
Completed in  0:00:04.306656
Original XAI WIoU for r=0.6 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.6 =  tensor(0.2271, device='cuda:1')  +-  tensor(0.1081, device='cuda:1') (0.000154917172039859)
len(reference) = 3000


ratio=0.9


Computing with masking
Completed in  0:00:04.528840
Original XAI WIoU for r=0.9 =  tensor(0.1544, device='cuda:1')  +-  tensor(0.0727, device='cuda:1')
Intervened XAI WIoU for r=0.9 =  tensor(0.1615, device='cuda:1')  +-  tensor(0.0760, device='cuda:1') (1.5688169652250394e-09)
len(reference) = 3000


DONE GOODMotif - GSATGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.38347059 0.38347059 0.38347059] +- [0.00255775 0.00255775 0.00255775]
(id) id_val WIOU_PERTURBED: 	[0.74805654 0.54288849 0.39607754] +- [0.00429161 0.0053711  0.00260445]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.15535186 0.15535186 0.15535186] +- [0.00119181 0.00119181 0.00119181]
(id) val WIOU_PERTURBED: 	[0.39646805 0.22661721 0.16281879] +- [0.00243167 0.00253138 0.00143472]
DONE GSAT GOODMotif/size 0.35
DONE all :)
