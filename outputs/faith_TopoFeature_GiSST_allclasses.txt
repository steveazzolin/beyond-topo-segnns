nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 1496126

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 10:43:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 10:43:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.034


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.961 +- 0.471 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.183 +- 0.471 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all KL = 0.417 +- 0.471 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all L1 = 0.53 +- 0.394 (in-sample avg dev_std = 0.434)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.482
SUFF_SIMPLE for r=0.1 class 0.0 = 0.943 +- 0.461 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.176 +- 0.461 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.1 all KL = 0.394 +- 0.461 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.1 all L1 = 0.518 +- 0.390 (in-sample avg dev_std = 0.432)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.946 +- 0.466 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.177 +- 0.466 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.2 all KL = 0.404 +- 0.466 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.2 all L1 = 0.52 +- 0.392 (in-sample avg dev_std = 0.442)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.488
SUFF_SIMPLE for r=0.4 class 0.0 = 0.957 +- 0.473 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.175 +- 0.473 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.4 all KL = 0.414 +- 0.473 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.4 all L1 = 0.524 +- 0.397 (in-sample avg dev_std = 0.420)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013504
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.984 +- 0.485 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.144 +- 0.485 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all KL = 0.445 +- 0.485 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all L1 = 0.515 +- 0.420 (in-sample avg dev_std = 0.094)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.05 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.05 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.024)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.1 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.1 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.021)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.2 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.2 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.024)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.4 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.4 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.022)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.8 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.8 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.007)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.935 +- 0.316 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.881 +- 0.316 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.05 all KL = 0.88 +- 0.316 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.05 all L1 = 0.909 +- 0.246 (in-sample avg dev_std = 0.211)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.935 +- 0.316 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.881 +- 0.316 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.1 all KL = 0.88 +- 0.316 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.1 all L1 = 0.908 +- 0.246 (in-sample avg dev_std = 0.214)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009295999999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.934 +- 0.317 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.88 +- 0.317 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 all KL = 0.879 +- 0.317 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 all L1 = 0.907 +- 0.248 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0051328
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.489
SUFF_SIMPLE for r=0.4 class 0.0 = 0.931 +- 0.317 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.873 +- 0.317 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all KL = 0.88 +- 0.317 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all L1 = 0.903 +- 0.259 (in-sample avg dev_std = 0.184)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0339894
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.489
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.211 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.94 +- 0.211 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.211 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.956 +- 0.180 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.83
NEC for r=0.05 class 0.0 = 0.018 +- 0.371 (in-sample avg dev_std = 0.191)
NEC for r=0.05 class 1.0 = 0.298 +- 0.371 (in-sample avg dev_std = 0.191)
NEC for r=0.05 all KL = 0.227 +- 0.371 (in-sample avg dev_std = 0.191)
NEC for r=0.05 all L1 = 0.173 +- 0.297 (in-sample avg dev_std = 0.191)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.828
NEC for r=0.1 class 0.0 = 0.017 +- 0.376 (in-sample avg dev_std = 0.225)
NEC for r=0.1 class 1.0 = 0.311 +- 0.376 (in-sample avg dev_std = 0.225)
NEC for r=0.1 all KL = 0.248 +- 0.376 (in-sample avg dev_std = 0.225)
NEC for r=0.1 all L1 = 0.18 +- 0.296 (in-sample avg dev_std = 0.225)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.824
NEC for r=0.2 class 0.0 = 0.031 +- 0.382 (in-sample avg dev_std = 0.258)
NEC for r=0.2 class 1.0 = 0.314 +- 0.382 (in-sample avg dev_std = 0.258)
NEC for r=0.2 all KL = 0.266 +- 0.382 (in-sample avg dev_std = 0.258)
NEC for r=0.2 all L1 = 0.188 +- 0.295 (in-sample avg dev_std = 0.258)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.829
NEC for r=0.4 class 0.0 = 0.033 +- 0.380 (in-sample avg dev_std = 0.278)
NEC for r=0.4 class 1.0 = 0.316 +- 0.380 (in-sample avg dev_std = 0.278)
NEC for r=0.4 all KL = 0.278 +- 0.380 (in-sample avg dev_std = 0.278)
NEC for r=0.4 all L1 = 0.19 +- 0.291 (in-sample avg dev_std = 0.278)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013504
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.81
NEC for r=0.8 class 0.0 = 0.039 +- 0.398 (in-sample avg dev_std = 0.330)
NEC for r=0.8 class 1.0 = 0.347 +- 0.398 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all KL = 0.316 +- 0.398 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all L1 = 0.21 +- 0.297 (in-sample avg dev_std = 0.330)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.5
NEC for r=0.05 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.084)
NEC for r=0.05 class 1.0 = 0.648 +- 0.463 (in-sample avg dev_std = 0.084)
NEC for r=0.05 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.084)
NEC for r=0.05 all L1 = 0.383 +- 0.404 (in-sample avg dev_std = 0.084)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.499
NEC for r=0.1 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.082)
NEC for r=0.1 class 1.0 = 0.648 +- 0.463 (in-sample avg dev_std = 0.082)
NEC for r=0.1 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.082)
NEC for r=0.1 all L1 = 0.383 +- 0.405 (in-sample avg dev_std = 0.082)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.499
NEC for r=0.2 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.086)
NEC for r=0.2 class 1.0 = 0.648 +- 0.463 (in-sample avg dev_std = 0.086)
NEC for r=0.2 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.086)
NEC for r=0.2 all L1 = 0.383 +- 0.405 (in-sample avg dev_std = 0.086)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.501
NEC for r=0.4 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.106)
NEC for r=0.4 class 1.0 = 0.647 +- 0.463 (in-sample avg dev_std = 0.106)
NEC for r=0.4 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.106)
NEC for r=0.4 all L1 = 0.382 +- 0.404 (in-sample avg dev_std = 0.106)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.504
NEC for r=0.8 class 0.0 = 0.114 +- 0.462 (in-sample avg dev_std = 0.166)
NEC for r=0.8 class 1.0 = 0.645 +- 0.462 (in-sample avg dev_std = 0.166)
NEC for r=0.8 all KL = 0.418 +- 0.462 (in-sample avg dev_std = 0.166)
NEC for r=0.8 all L1 = 0.381 +- 0.402 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.037 +- 0.207 (in-sample avg dev_std = 0.051)
NEC for r=0.05 class 1.0 = 0.05 +- 0.207 (in-sample avg dev_std = 0.051)
NEC for r=0.05 all KL = 0.052 +- 0.207 (in-sample avg dev_std = 0.051)
NEC for r=0.05 all L1 = 0.044 +- 0.173 (in-sample avg dev_std = 0.051)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.509
NEC for r=0.1 class 0.0 = 0.047 +- 0.234 (in-sample avg dev_std = 0.087)
NEC for r=0.1 class 1.0 = 0.059 +- 0.234 (in-sample avg dev_std = 0.087)
NEC for r=0.1 all KL = 0.066 +- 0.234 (in-sample avg dev_std = 0.087)
NEC for r=0.1 all L1 = 0.053 +- 0.191 (in-sample avg dev_std = 0.087)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009295999999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.508
NEC for r=0.2 class 0.0 = 0.055 +- 0.266 (in-sample avg dev_std = 0.112)
NEC for r=0.2 class 1.0 = 0.079 +- 0.266 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all KL = 0.085 +- 0.266 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all L1 = 0.067 +- 0.215 (in-sample avg dev_std = 0.112)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0051328
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.513
NEC for r=0.4 class 0.0 = 0.048 +- 0.286 (in-sample avg dev_std = 0.193)
NEC for r=0.4 class 1.0 = 0.095 +- 0.286 (in-sample avg dev_std = 0.193)
NEC for r=0.4 all KL = 0.1 +- 0.286 (in-sample avg dev_std = 0.193)
NEC for r=0.4 all L1 = 0.071 +- 0.215 (in-sample avg dev_std = 0.193)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.519
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0339894
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.505
NEC for r=0.8 class 0.0 = 0.041 +- 0.279 (in-sample avg dev_std = 0.201)
NEC for r=0.8 class 1.0 = 0.083 +- 0.279 (in-sample avg dev_std = 0.201)
NEC for r=0.8 all KL = 0.097 +- 0.279 (in-sample avg dev_std = 0.201)
NEC for r=0.8 all L1 = 0.062 +- 0.195 (in-sample avg dev_std = 0.201)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 10:58:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 10:58:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.002
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.007
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.024
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.058
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.004
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.028
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.073


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.544
SUFF_SIMPLE for r=0.05 class 0.0 = 0.916 +- 0.464 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.225 +- 0.464 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.05 all KL = 0.4 +- 0.464 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.05 all L1 = 0.533 +- 0.370 (in-sample avg dev_std = 0.488)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.538
SUFF_SIMPLE for r=0.1 class 0.0 = 0.917 +- 0.468 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.217 +- 0.468 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 all KL = 0.402 +- 0.468 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 all L1 = 0.529 +- 0.373 (in-sample avg dev_std = 0.486)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.544
SUFF_SIMPLE for r=0.2 class 0.0 = 0.905 +- 0.459 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.224 +- 0.459 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.2 all KL = 0.392 +- 0.459 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.2 all L1 = 0.528 +- 0.367 (in-sample avg dev_std = 0.505)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024278
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.544
SUFF_SIMPLE for r=0.4 class 0.0 = 0.909 +- 0.463 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.232 +- 0.463 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.4 all KL = 0.402 +- 0.463 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.4 all L1 = 0.534 +- 0.372 (in-sample avg dev_std = 0.489)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.058072000000000006
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.582
SUFF_SIMPLE for r=0.8 class 0.0 = 0.94 +- 0.478 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.31 +- 0.478 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.8 all KL = 0.504 +- 0.478 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.8 all L1 = 0.591 +- 0.394 (in-sample avg dev_std = 0.319)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.1 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.1 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.008)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.4 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.4 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.014)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.931 +- 0.323 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.874 +- 0.323 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.05 all KL = 0.873 +- 0.323 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.05 all L1 = 0.903 +- 0.253 (in-sample avg dev_std = 0.210)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.494
SUFF_SIMPLE for r=0.1 class 0.0 = 0.931 +- 0.324 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.874 +- 0.324 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.1 all KL = 0.874 +- 0.324 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.1 all L1 = 0.903 +- 0.254 (in-sample avg dev_std = 0.214)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.49
SUFF_SIMPLE for r=0.2 class 0.0 = 0.929 +- 0.325 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.869 +- 0.325 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.2 all KL = 0.873 +- 0.325 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.2 all L1 = 0.9 +- 0.260 (in-sample avg dev_std = 0.196)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.027949800000000004
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.494
SUFF_SIMPLE for r=0.4 class 0.0 = 0.929 +- 0.320 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.871 +- 0.320 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.4 all KL = 0.877 +- 0.320 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.4 all L1 = 0.9 +- 0.261 (in-sample avg dev_std = 0.177)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.519
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07330260000000001
len(reference) = 4915
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.52
SUFF_SIMPLE for r=0.8 class 0.0 = 0.948 +- 0.253 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.926 +- 0.253 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all KL = 0.924 +- 0.253 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.8 all L1 = 0.937 +- 0.211 (in-sample avg dev_std = 0.085)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.902
NEC for r=0.05 class 0.0 = 0.064 +- 0.322 (in-sample avg dev_std = 0.173)
NEC for r=0.05 class 1.0 = 0.192 +- 0.322 (in-sample avg dev_std = 0.173)
NEC for r=0.05 all KL = 0.181 +- 0.322 (in-sample avg dev_std = 0.173)
NEC for r=0.05 all L1 = 0.135 +- 0.246 (in-sample avg dev_std = 0.173)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.906
NEC for r=0.1 class 0.0 = 0.062 +- 0.316 (in-sample avg dev_std = 0.181)
NEC for r=0.1 class 1.0 = 0.193 +- 0.316 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all KL = 0.18 +- 0.316 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all L1 = 0.134 +- 0.243 (in-sample avg dev_std = 0.181)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.9
NEC for r=0.2 class 0.0 = 0.067 +- 0.331 (in-sample avg dev_std = 0.228)
NEC for r=0.2 class 1.0 = 0.208 +- 0.331 (in-sample avg dev_std = 0.228)
NEC for r=0.2 all KL = 0.201 +- 0.331 (in-sample avg dev_std = 0.228)
NEC for r=0.2 all L1 = 0.145 +- 0.248 (in-sample avg dev_std = 0.228)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024278
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.884
NEC for r=0.4 class 0.0 = 0.071 +- 0.357 (in-sample avg dev_std = 0.285)
NEC for r=0.4 class 1.0 = 0.239 +- 0.357 (in-sample avg dev_std = 0.285)
NEC for r=0.4 all KL = 0.237 +- 0.357 (in-sample avg dev_std = 0.285)
NEC for r=0.4 all L1 = 0.164 +- 0.259 (in-sample avg dev_std = 0.285)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.058072000000000006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.879
NEC for r=0.8 class 0.0 = 0.077 +- 0.387 (in-sample avg dev_std = 0.396)
NEC for r=0.8 class 1.0 = 0.273 +- 0.387 (in-sample avg dev_std = 0.396)
NEC for r=0.8 all KL = 0.305 +- 0.387 (in-sample avg dev_std = 0.396)
NEC for r=0.8 all L1 = 0.186 +- 0.252 (in-sample avg dev_std = 0.396)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.042)
NEC for r=0.05 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all L1 = 0.232 +- 0.355 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.040)
NEC for r=0.1 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.040)
NEC for r=0.1 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.040)
NEC for r=0.1 all L1 = 0.232 +- 0.355 (in-sample avg dev_std = 0.040)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.057)
NEC for r=0.2 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.057)
NEC for r=0.2 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.057)
NEC for r=0.2 all L1 = 0.232 +- 0.355 (in-sample avg dev_std = 0.057)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.072)
NEC for r=0.4 class 1.0 = 0.442 +- 0.394 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all KL = 0.243 +- 0.394 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all L1 = 0.232 +- 0.355 (in-sample avg dev_std = 0.072)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.02 +- 0.393 (in-sample avg dev_std = 0.112)
NEC for r=0.8 class 1.0 = 0.442 +- 0.393 (in-sample avg dev_std = 0.112)
NEC for r=0.8 all KL = 0.244 +- 0.393 (in-sample avg dev_std = 0.112)
NEC for r=0.8 all L1 = 0.232 +- 0.353 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.511
NEC for r=0.05 class 0.0 = 0.049 +- 0.258 (in-sample avg dev_std = 0.068)
NEC for r=0.05 class 1.0 = 0.084 +- 0.258 (in-sample avg dev_std = 0.068)
NEC for r=0.05 all KL = 0.079 +- 0.258 (in-sample avg dev_std = 0.068)
NEC for r=0.05 all L1 = 0.066 +- 0.217 (in-sample avg dev_std = 0.068)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.515
NEC for r=0.1 class 0.0 = 0.058 +- 0.284 (in-sample avg dev_std = 0.123)
NEC for r=0.1 class 1.0 = 0.098 +- 0.284 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all KL = 0.097 +- 0.284 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all L1 = 0.077 +- 0.233 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.51
NEC for r=0.2 class 0.0 = 0.059 +- 0.295 (in-sample avg dev_std = 0.162)
NEC for r=0.2 class 1.0 = 0.107 +- 0.295 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all KL = 0.107 +- 0.295 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all L1 = 0.083 +- 0.237 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.027949800000000004
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.503
NEC for r=0.4 class 0.0 = 0.052 +- 0.286 (in-sample avg dev_std = 0.198)
NEC for r=0.4 class 1.0 = 0.091 +- 0.286 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all KL = 0.101 +- 0.286 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all L1 = 0.071 +- 0.213 (in-sample avg dev_std = 0.198)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.523
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07330260000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.494
NEC for r=0.8 class 0.0 = 0.043 +- 0.295 (in-sample avg dev_std = 0.209)
NEC for r=0.8 class 1.0 = 0.104 +- 0.295 (in-sample avg dev_std = 0.209)
NEC for r=0.8 all KL = 0.108 +- 0.295 (in-sample avg dev_std = 0.209)
NEC for r=0.8 all L1 = 0.073 +- 0.214 (in-sample avg dev_std = 0.209)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 11:13:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 11:13:39 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 11:13:39 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 11:13:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 11:13:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:13:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:13:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:13:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:13:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:13:40 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 11:13:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.486
SUFF_SIMPLE for r=0.05 class 0.0 = 0.931 +- 0.461 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.179 +- 0.461 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.05 all KL = 0.413 +- 0.461 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.05 all L1 = 0.514 +- 0.387 (in-sample avg dev_std = 0.414)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.483
SUFF_SIMPLE for r=0.1 class 0.0 = 0.923 +- 0.459 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.177 +- 0.459 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all KL = 0.409 +- 0.459 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all L1 = 0.51 +- 0.385 (in-sample avg dev_std = 0.425)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.485
SUFF_SIMPLE for r=0.2 class 0.0 = 0.938 +- 0.466 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.175 +- 0.466 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 all KL = 0.422 +- 0.466 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 all L1 = 0.515 +- 0.391 (in-sample avg dev_std = 0.395)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.481
SUFF_SIMPLE for r=0.4 class 0.0 = 0.935 +- 0.462 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.172 +- 0.462 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.4 all KL = 0.417 +- 0.462 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.4 all L1 = 0.512 +- 0.391 (in-sample avg dev_std = 0.399)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012755999999999998
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.96 +- 0.478 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.144 +- 0.478 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.8 all KL = 0.44 +- 0.478 (in-sample avg dev_std = 0.083)
SUFF_SIMPLE for r=0.8 all L1 = 0.504 +- 0.413 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.1 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.1 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.010)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.2 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.2 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.010)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.010)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.936 +- 0.301 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.897 +- 0.301 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.05 all KL = 0.892 +- 0.301 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.234 (in-sample avg dev_std = 0.203)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.935 +- 0.304 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.896 +- 0.304 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 all KL = 0.889 +- 0.304 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.235 (in-sample avg dev_std = 0.203)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009086000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.935 +- 0.302 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.894 +- 0.302 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 all KL = 0.891 +- 0.302 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.239 (in-sample avg dev_std = 0.201)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.004990400000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.488
SUFF_SIMPLE for r=0.4 class 0.0 = 0.932 +- 0.305 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.888 +- 0.305 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all KL = 0.89 +- 0.305 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.248 (in-sample avg dev_std = 0.174)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.504
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.032675800000000005
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.944 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.951 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.957 +- 0.179 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.817
NEC for r=0.05 class 0.0 = 0.045 +- 0.370 (in-sample avg dev_std = 0.194)
NEC for r=0.05 class 1.0 = 0.34 +- 0.370 (in-sample avg dev_std = 0.194)
NEC for r=0.05 all KL = 0.264 +- 0.370 (in-sample avg dev_std = 0.194)
NEC for r=0.05 all L1 = 0.208 +- 0.303 (in-sample avg dev_std = 0.194)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.826
NEC for r=0.1 class 0.0 = 0.044 +- 0.356 (in-sample avg dev_std = 0.208)
NEC for r=0.1 class 1.0 = 0.332 +- 0.356 (in-sample avg dev_std = 0.208)
NEC for r=0.1 all KL = 0.261 +- 0.356 (in-sample avg dev_std = 0.208)
NEC for r=0.1 all L1 = 0.204 +- 0.293 (in-sample avg dev_std = 0.208)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.826
NEC for r=0.2 class 0.0 = 0.046 +- 0.354 (in-sample avg dev_std = 0.213)
NEC for r=0.2 class 1.0 = 0.325 +- 0.354 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all KL = 0.26 +- 0.354 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all L1 = 0.2 +- 0.288 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.826
NEC for r=0.4 class 0.0 = 0.053 +- 0.355 (in-sample avg dev_std = 0.236)
NEC for r=0.4 class 1.0 = 0.328 +- 0.355 (in-sample avg dev_std = 0.236)
NEC for r=0.4 all KL = 0.271 +- 0.355 (in-sample avg dev_std = 0.236)
NEC for r=0.4 all L1 = 0.206 +- 0.286 (in-sample avg dev_std = 0.236)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012755999999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.813
NEC for r=0.8 class 0.0 = 0.058 +- 0.364 (in-sample avg dev_std = 0.286)
NEC for r=0.8 class 1.0 = 0.35 +- 0.364 (in-sample avg dev_std = 0.286)
NEC for r=0.8 all KL = 0.301 +- 0.364 (in-sample avg dev_std = 0.286)
NEC for r=0.8 all L1 = 0.22 +- 0.288 (in-sample avg dev_std = 0.286)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.040)
NEC for r=0.05 class 1.0 = 0.628 +- 0.439 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all KL = 0.36 +- 0.439 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.040)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.041)
NEC for r=0.1 class 1.0 = 0.629 +- 0.439 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.041)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.049)
NEC for r=0.2 class 1.0 = 0.628 +- 0.439 (in-sample avg dev_std = 0.049)
NEC for r=0.2 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.049)
NEC for r=0.2 all L1 = 0.342 +- 0.390 (in-sample avg dev_std = 0.049)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.077)
NEC for r=0.4 class 1.0 = 0.628 +- 0.439 (in-sample avg dev_std = 0.077)
NEC for r=0.4 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.077)
NEC for r=0.4 all L1 = 0.342 +- 0.390 (in-sample avg dev_std = 0.077)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
NEC for r=0.8 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.100)
NEC for r=0.8 class 1.0 = 0.627 +- 0.439 (in-sample avg dev_std = 0.100)
NEC for r=0.8 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.100)
NEC for r=0.8 all L1 = 0.341 +- 0.389 (in-sample avg dev_std = 0.100)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.502
NEC for r=0.05 class 0.0 = 0.038 +- 0.220 (in-sample avg dev_std = 0.051)
NEC for r=0.05 class 1.0 = 0.06 +- 0.220 (in-sample avg dev_std = 0.051)
NEC for r=0.05 all KL = 0.059 +- 0.220 (in-sample avg dev_std = 0.051)
NEC for r=0.05 all L1 = 0.049 +- 0.186 (in-sample avg dev_std = 0.051)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.051 +- 0.247 (in-sample avg dev_std = 0.093)
NEC for r=0.1 class 1.0 = 0.069 +- 0.247 (in-sample avg dev_std = 0.093)
NEC for r=0.1 all KL = 0.074 +- 0.247 (in-sample avg dev_std = 0.093)
NEC for r=0.1 all L1 = 0.06 +- 0.205 (in-sample avg dev_std = 0.093)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009086000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.053 +- 0.254 (in-sample avg dev_std = 0.109)
NEC for r=0.2 class 1.0 = 0.071 +- 0.254 (in-sample avg dev_std = 0.109)
NEC for r=0.2 all KL = 0.077 +- 0.254 (in-sample avg dev_std = 0.109)
NEC for r=0.2 all L1 = 0.062 +- 0.207 (in-sample avg dev_std = 0.109)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.004990400000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.508
NEC for r=0.4 class 0.0 = 0.045 +- 0.263 (in-sample avg dev_std = 0.174)
NEC for r=0.4 class 1.0 = 0.078 +- 0.263 (in-sample avg dev_std = 0.174)
NEC for r=0.4 all KL = 0.085 +- 0.263 (in-sample avg dev_std = 0.174)
NEC for r=0.4 all L1 = 0.061 +- 0.198 (in-sample avg dev_std = 0.174)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.032675800000000005
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.502
NEC for r=0.8 class 0.0 = 0.038 +- 0.250 (in-sample avg dev_std = 0.170)
NEC for r=0.8 class 1.0 = 0.066 +- 0.250 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all KL = 0.078 +- 0.250 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all L1 = 0.052 +- 0.178 (in-sample avg dev_std = 0.170)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 11:29:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 11:29:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.031


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.487
SUFF_SIMPLE for r=0.05 class 0.0 = 0.951 +- 0.462 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.181 +- 0.462 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.05 all KL = 0.41 +- 0.462 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.05 all L1 = 0.524 +- 0.391 (in-sample avg dev_std = 0.431)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.487
SUFF_SIMPLE for r=0.1 class 0.0 = 0.959 +- 0.465 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.179 +- 0.465 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.1 all KL = 0.421 +- 0.465 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.1 all L1 = 0.527 +- 0.396 (in-sample avg dev_std = 0.411)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.481
SUFF_SIMPLE for r=0.2 class 0.0 = 0.956 +- 0.465 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.174 +- 0.465 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.2 all KL = 0.416 +- 0.465 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.2 all L1 = 0.523 +- 0.396 (in-sample avg dev_std = 0.406)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.482
SUFF_SIMPLE for r=0.4 class 0.0 = 0.961 +- 0.468 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.173 +- 0.468 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.4 all KL = 0.421 +- 0.468 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.4 all L1 = 0.524 +- 0.398 (in-sample avg dev_std = 0.408)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012008
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.483 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.146 +- 0.483 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.8 all KL = 0.448 +- 0.483 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.8 all L1 = 0.516 +- 0.419 (in-sample avg dev_std = 0.109)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.2 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.2 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.009)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.4 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.4 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.007)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.938 +- 0.305 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.305 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.05 all KL = 0.888 +- 0.305 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.239 (in-sample avg dev_std = 0.207)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.937 +- 0.307 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.888 +- 0.307 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 all KL = 0.887 +- 0.307 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 all L1 = 0.913 +- 0.240 (in-sample avg dev_std = 0.206)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.936 +- 0.307 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.887 +- 0.307 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.2 all KL = 0.887 +- 0.307 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.2 all L1 = 0.911 +- 0.244 (in-sample avg dev_std = 0.199)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048382
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.489
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.309 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.88 +- 0.309 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all KL = 0.886 +- 0.309 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all L1 = 0.907 +- 0.252 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0313284
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.491
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.209 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.94 +- 0.209 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.209 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.957 +- 0.181 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.804
NEC for r=0.05 class 0.0 = 0.018 +- 0.374 (in-sample avg dev_std = 0.190)
NEC for r=0.05 class 1.0 = 0.338 +- 0.374 (in-sample avg dev_std = 0.190)
NEC for r=0.05 all KL = 0.251 +- 0.374 (in-sample avg dev_std = 0.190)
NEC for r=0.05 all L1 = 0.195 +- 0.310 (in-sample avg dev_std = 0.190)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.802
NEC for r=0.1 class 0.0 = 0.024 +- 0.384 (in-sample avg dev_std = 0.233)
NEC for r=0.1 class 1.0 = 0.35 +- 0.384 (in-sample avg dev_std = 0.233)
NEC for r=0.1 all KL = 0.27 +- 0.384 (in-sample avg dev_std = 0.233)
NEC for r=0.1 all L1 = 0.204 +- 0.311 (in-sample avg dev_std = 0.233)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.808
NEC for r=0.2 class 0.0 = 0.024 +- 0.375 (in-sample avg dev_std = 0.240)
NEC for r=0.2 class 1.0 = 0.342 +- 0.375 (in-sample avg dev_std = 0.240)
NEC for r=0.2 all KL = 0.271 +- 0.375 (in-sample avg dev_std = 0.240)
NEC for r=0.2 all L1 = 0.2 +- 0.304 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.812
NEC for r=0.4 class 0.0 = 0.028 +- 0.377 (in-sample avg dev_std = 0.261)
NEC for r=0.4 class 1.0 = 0.343 +- 0.377 (in-sample avg dev_std = 0.261)
NEC for r=0.4 all KL = 0.277 +- 0.377 (in-sample avg dev_std = 0.261)
NEC for r=0.4 all L1 = 0.203 +- 0.303 (in-sample avg dev_std = 0.261)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012008
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.805
NEC for r=0.8 class 0.0 = 0.037 +- 0.388 (in-sample avg dev_std = 0.317)
NEC for r=0.8 class 1.0 = 0.363 +- 0.388 (in-sample avg dev_std = 0.317)
NEC for r=0.8 all KL = 0.317 +- 0.388 (in-sample avg dev_std = 0.317)
NEC for r=0.8 all L1 = 0.217 +- 0.300 (in-sample avg dev_std = 0.317)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.019)
NEC for r=0.05 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all L1 = 0.133 +- 0.282 (in-sample avg dev_std = 0.019)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.004 +- 0.302 (in-sample avg dev_std = 0.031)
NEC for r=0.1 class 1.0 = 0.261 +- 0.302 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.132 +- 0.302 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.134 +- 0.282 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.038)
NEC for r=0.2 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.038)
NEC for r=0.2 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.038)
NEC for r=0.2 all L1 = 0.133 +- 0.282 (in-sample avg dev_std = 0.038)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.042)
NEC for r=0.4 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.042)
NEC for r=0.4 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.042)
NEC for r=0.4 all L1 = 0.134 +- 0.282 (in-sample avg dev_std = 0.042)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
NEC for r=0.8 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.059)
NEC for r=0.8 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.059)
NEC for r=0.8 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.059)
NEC for r=0.8 all L1 = 0.133 +- 0.282 (in-sample avg dev_std = 0.059)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.505
NEC for r=0.05 class 0.0 = 0.037 +- 0.220 (in-sample avg dev_std = 0.047)
NEC for r=0.05 class 1.0 = 0.062 +- 0.220 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all KL = 0.059 +- 0.220 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all L1 = 0.049 +- 0.188 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.503
NEC for r=0.1 class 0.0 = 0.048 +- 0.246 (in-sample avg dev_std = 0.084)
NEC for r=0.1 class 1.0 = 0.071 +- 0.246 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all KL = 0.072 +- 0.246 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all L1 = 0.06 +- 0.206 (in-sample avg dev_std = 0.084)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.053 +- 0.259 (in-sample avg dev_std = 0.116)
NEC for r=0.2 class 1.0 = 0.076 +- 0.259 (in-sample avg dev_std = 0.116)
NEC for r=0.2 all KL = 0.08 +- 0.259 (in-sample avg dev_std = 0.116)
NEC for r=0.2 all L1 = 0.064 +- 0.211 (in-sample avg dev_std = 0.116)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048382
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.044 +- 0.271 (in-sample avg dev_std = 0.185)
NEC for r=0.4 class 1.0 = 0.084 +- 0.271 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all KL = 0.089 +- 0.271 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all L1 = 0.064 +- 0.202 (in-sample avg dev_std = 0.185)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0313284
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.504
NEC for r=0.8 class 0.0 = 0.037 +- 0.261 (in-sample avg dev_std = 0.187)
NEC for r=0.8 class 1.0 = 0.076 +- 0.261 (in-sample avg dev_std = 0.187)
NEC for r=0.8 all KL = 0.085 +- 0.261 (in-sample avg dev_std = 0.187)
NEC for r=0.8 all L1 = 0.056 +- 0.186 (in-sample avg dev_std = 0.187)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 11:44:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 11:44:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.489
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.468 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.18 +- 0.468 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.05 all KL = 0.409 +- 0.468 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.05 all L1 = 0.525 +- 0.393 (in-sample avg dev_std = 0.441)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.481
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.467 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.176 +- 0.467 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.1 all KL = 0.403 +- 0.467 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.395 (in-sample avg dev_std = 0.411)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.483
SUFF_SIMPLE for r=0.2 class 0.0 = 0.959 +- 0.471 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.174 +- 0.471 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all KL = 0.417 +- 0.471 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all L1 = 0.524 +- 0.398 (in-sample avg dev_std = 0.407)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.477
SUFF_SIMPLE for r=0.4 class 0.0 = 0.95 +- 0.466 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.172 +- 0.466 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.4 all KL = 0.405 +- 0.466 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.4 all L1 = 0.519 +- 0.396 (in-sample avg dev_std = 0.413)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013048
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.486 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.146 +- 0.486 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.8 all KL = 0.447 +- 0.486 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.8 all L1 = 0.517 +- 0.421 (in-sample avg dev_std = 0.095)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.1 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.1 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.004)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.94 +- 0.306 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.891 +- 0.306 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 all KL = 0.888 +- 0.306 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 all L1 = 0.916 +- 0.238 (in-sample avg dev_std = 0.205)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.94 +- 0.306 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.891 +- 0.306 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.1 all KL = 0.888 +- 0.306 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.238 (in-sample avg dev_std = 0.202)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.49
SUFF_SIMPLE for r=0.2 class 0.0 = 0.939 +- 0.308 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.886 +- 0.308 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all KL = 0.887 +- 0.308 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all L1 = 0.913 +- 0.243 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005054
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.488
SUFF_SIMPLE for r=0.4 class 0.0 = 0.936 +- 0.308 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.882 +- 0.308 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all KL = 0.888 +- 0.308 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all L1 = 0.909 +- 0.251 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.505
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033212599999999995
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.489
SUFF_SIMPLE for r=0.8 class 0.0 = 0.976 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.947 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.956 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.169 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.817
NEC for r=0.05 class 0.0 = 0.016 +- 0.374 (in-sample avg dev_std = 0.179)
NEC for r=0.05 class 1.0 = 0.316 +- 0.374 (in-sample avg dev_std = 0.179)
NEC for r=0.05 all KL = 0.237 +- 0.374 (in-sample avg dev_std = 0.179)
NEC for r=0.05 all L1 = 0.182 +- 0.308 (in-sample avg dev_std = 0.179)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.816
NEC for r=0.1 class 0.0 = 0.019 +- 0.377 (in-sample avg dev_std = 0.215)
NEC for r=0.1 class 1.0 = 0.326 +- 0.377 (in-sample avg dev_std = 0.215)
NEC for r=0.1 all KL = 0.255 +- 0.377 (in-sample avg dev_std = 0.215)
NEC for r=0.1 all L1 = 0.189 +- 0.306 (in-sample avg dev_std = 0.215)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.817
NEC for r=0.2 class 0.0 = 0.026 +- 0.381 (in-sample avg dev_std = 0.245)
NEC for r=0.2 class 1.0 = 0.331 +- 0.381 (in-sample avg dev_std = 0.245)
NEC for r=0.2 all KL = 0.272 +- 0.381 (in-sample avg dev_std = 0.245)
NEC for r=0.2 all L1 = 0.195 +- 0.304 (in-sample avg dev_std = 0.245)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.811
NEC for r=0.4 class 0.0 = 0.028 +- 0.383 (in-sample avg dev_std = 0.253)
NEC for r=0.4 class 1.0 = 0.341 +- 0.383 (in-sample avg dev_std = 0.253)
NEC for r=0.4 all KL = 0.285 +- 0.383 (in-sample avg dev_std = 0.253)
NEC for r=0.4 all L1 = 0.201 +- 0.305 (in-sample avg dev_std = 0.253)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013048
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.8
NEC for r=0.8 class 0.0 = 0.032 +- 0.398 (in-sample avg dev_std = 0.319)
NEC for r=0.8 class 1.0 = 0.37 +- 0.398 (in-sample avg dev_std = 0.319)
NEC for r=0.8 all KL = 0.334 +- 0.398 (in-sample avg dev_std = 0.319)
NEC for r=0.8 all L1 = 0.219 +- 0.303 (in-sample avg dev_std = 0.319)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.059)
NEC for r=0.05 class 1.0 = 0.508 +- 0.414 (in-sample avg dev_std = 0.059)
NEC for r=0.05 all KL = 0.28 +- 0.414 (in-sample avg dev_std = 0.059)
NEC for r=0.05 all L1 = 0.266 +- 0.370 (in-sample avg dev_std = 0.059)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.061)
NEC for r=0.1 class 1.0 = 0.508 +- 0.414 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all KL = 0.28 +- 0.414 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all L1 = 0.266 +- 0.370 (in-sample avg dev_std = 0.061)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.063)
NEC for r=0.2 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.063)
NEC for r=0.2 all KL = 0.28 +- 0.414 (in-sample avg dev_std = 0.063)
NEC for r=0.2 all L1 = 0.266 +- 0.370 (in-sample avg dev_std = 0.063)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.021 +- 0.413 (in-sample avg dev_std = 0.089)
NEC for r=0.4 class 1.0 = 0.508 +- 0.413 (in-sample avg dev_std = 0.089)
NEC for r=0.4 all KL = 0.281 +- 0.413 (in-sample avg dev_std = 0.089)
NEC for r=0.4 all L1 = 0.266 +- 0.370 (in-sample avg dev_std = 0.089)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.022 +- 0.413 (in-sample avg dev_std = 0.120)
NEC for r=0.8 class 1.0 = 0.509 +- 0.413 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all KL = 0.284 +- 0.413 (in-sample avg dev_std = 0.120)
NEC for r=0.8 all L1 = 0.268 +- 0.369 (in-sample avg dev_std = 0.120)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.508
NEC for r=0.05 class 0.0 = 0.034 +- 0.202 (in-sample avg dev_std = 0.050)
NEC for r=0.05 class 1.0 = 0.048 +- 0.202 (in-sample avg dev_std = 0.050)
NEC for r=0.05 all KL = 0.049 +- 0.202 (in-sample avg dev_std = 0.050)
NEC for r=0.05 all L1 = 0.041 +- 0.167 (in-sample avg dev_std = 0.050)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.508
NEC for r=0.1 class 0.0 = 0.046 +- 0.231 (in-sample avg dev_std = 0.088)
NEC for r=0.1 class 1.0 = 0.056 +- 0.231 (in-sample avg dev_std = 0.088)
NEC for r=0.1 all KL = 0.064 +- 0.231 (in-sample avg dev_std = 0.088)
NEC for r=0.1 all L1 = 0.051 +- 0.188 (in-sample avg dev_std = 0.088)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.508
NEC for r=0.2 class 0.0 = 0.051 +- 0.260 (in-sample avg dev_std = 0.117)
NEC for r=0.2 class 1.0 = 0.074 +- 0.260 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all KL = 0.08 +- 0.260 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all L1 = 0.063 +- 0.210 (in-sample avg dev_std = 0.117)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005054
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.045 +- 0.279 (in-sample avg dev_std = 0.195)
NEC for r=0.4 class 1.0 = 0.09 +- 0.279 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all KL = 0.094 +- 0.279 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all L1 = 0.067 +- 0.210 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.516
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033212599999999995
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.503
NEC for r=0.8 class 0.0 = 0.039 +- 0.278 (in-sample avg dev_std = 0.197)
NEC for r=0.8 class 1.0 = 0.08 +- 0.278 (in-sample avg dev_std = 0.197)
NEC for r=0.8 all KL = 0.096 +- 0.278 (in-sample avg dev_std = 0.197)
NEC for r=0.8 all L1 = 0.059 +- 0.190 (in-sample avg dev_std = 0.197)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 11:59:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 11:59:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.511
SUFF_SIMPLE for r=0.05 class 0.0 = 0.911 +- 0.459 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.196 +- 0.459 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.05 all KL = 0.416 +- 0.459 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.05 all L1 = 0.515 +- 0.374 (in-sample avg dev_std = 0.438)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.504
SUFF_SIMPLE for r=0.1 class 0.0 = 0.898 +- 0.451 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.195 +- 0.451 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.1 all KL = 0.404 +- 0.451 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.1 all L1 = 0.509 +- 0.370 (in-sample avg dev_std = 0.444)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.508
SUFF_SIMPLE for r=0.2 class 0.0 = 0.906 +- 0.456 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.194 +- 0.456 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.2 all KL = 0.413 +- 0.456 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.2 all L1 = 0.511 +- 0.373 (in-sample avg dev_std = 0.444)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.497
SUFF_SIMPLE for r=0.4 class 0.0 = 0.901 +- 0.457 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.187 +- 0.457 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.4 all KL = 0.405 +- 0.457 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.4 all L1 = 0.505 +- 0.374 (in-sample avg dev_std = 0.443)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013047999999999999
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.445
SUFF_SIMPLE for r=0.8 class 0.0 = 0.932 +- 0.473 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.142 +- 0.473 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.8 all KL = 0.431 +- 0.473 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.8 all L1 = 0.491 +- 0.404 (in-sample avg dev_std = 0.108)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.010)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.4 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.005)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.494
SUFF_SIMPLE for r=0.05 class 0.0 = 0.933 +- 0.310 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.883 +- 0.310 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.310 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.05 all L1 = 0.908 +- 0.243 (in-sample avg dev_std = 0.207)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.494
SUFF_SIMPLE for r=0.1 class 0.0 = 0.933 +- 0.311 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.881 +- 0.311 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all KL = 0.88 +- 0.311 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all L1 = 0.907 +- 0.245 (in-sample avg dev_std = 0.208)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.493
SUFF_SIMPLE for r=0.2 class 0.0 = 0.932 +- 0.312 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.879 +- 0.312 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all KL = 0.88 +- 0.312 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all L1 = 0.906 +- 0.248 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.49
SUFF_SIMPLE for r=0.4 class 0.0 = 0.93 +- 0.313 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.873 +- 0.313 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.4 all KL = 0.88 +- 0.313 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.4 all L1 = 0.902 +- 0.256 (in-sample avg dev_std = 0.180)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0332018
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.936 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.953 +- 0.184 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.88
NEC for r=0.05 class 0.0 = 0.069 +- 0.303 (in-sample avg dev_std = 0.149)
NEC for r=0.05 class 1.0 = 0.254 +- 0.303 (in-sample avg dev_std = 0.149)
NEC for r=0.05 all KL = 0.193 +- 0.303 (in-sample avg dev_std = 0.149)
NEC for r=0.05 all L1 = 0.171 +- 0.262 (in-sample avg dev_std = 0.149)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.884
NEC for r=0.1 class 0.0 = 0.069 +- 0.296 (in-sample avg dev_std = 0.169)
NEC for r=0.1 class 1.0 = 0.251 +- 0.296 (in-sample avg dev_std = 0.169)
NEC for r=0.1 all KL = 0.195 +- 0.296 (in-sample avg dev_std = 0.169)
NEC for r=0.1 all L1 = 0.17 +- 0.255 (in-sample avg dev_std = 0.169)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.887
NEC for r=0.2 class 0.0 = 0.075 +- 0.290 (in-sample avg dev_std = 0.196)
NEC for r=0.2 class 1.0 = 0.244 +- 0.290 (in-sample avg dev_std = 0.196)
NEC for r=0.2 all KL = 0.195 +- 0.290 (in-sample avg dev_std = 0.196)
NEC for r=0.2 all L1 = 0.169 +- 0.248 (in-sample avg dev_std = 0.196)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.882
NEC for r=0.4 class 0.0 = 0.074 +- 0.292 (in-sample avg dev_std = 0.208)
NEC for r=0.4 class 1.0 = 0.25 +- 0.292 (in-sample avg dev_std = 0.208)
NEC for r=0.4 all KL = 0.201 +- 0.292 (in-sample avg dev_std = 0.208)
NEC for r=0.4 all L1 = 0.172 +- 0.250 (in-sample avg dev_std = 0.208)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013047999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.874
NEC for r=0.8 class 0.0 = 0.083 +- 0.308 (in-sample avg dev_std = 0.268)
NEC for r=0.8 class 1.0 = 0.269 +- 0.308 (in-sample avg dev_std = 0.268)
NEC for r=0.8 all KL = 0.232 +- 0.308 (in-sample avg dev_std = 0.268)
NEC for r=0.8 all L1 = 0.186 +- 0.252 (in-sample avg dev_std = 0.268)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.039)
NEC for r=0.05 class 1.0 = 0.416 +- 0.363 (in-sample avg dev_std = 0.039)
NEC for r=0.05 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.039)
NEC for r=0.05 all L1 = 0.216 +- 0.335 (in-sample avg dev_std = 0.039)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.049)
NEC for r=0.1 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.049)
NEC for r=0.1 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.049)
NEC for r=0.1 all L1 = 0.216 +- 0.335 (in-sample avg dev_std = 0.049)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.044)
NEC for r=0.2 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.044)
NEC for r=0.2 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.044)
NEC for r=0.2 all L1 = 0.216 +- 0.335 (in-sample avg dev_std = 0.044)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.072)
NEC for r=0.4 class 1.0 = 0.416 +- 0.363 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all KL = 0.215 +- 0.363 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all L1 = 0.216 +- 0.334 (in-sample avg dev_std = 0.072)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.012 +- 0.362 (in-sample avg dev_std = 0.095)
NEC for r=0.8 class 1.0 = 0.417 +- 0.362 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all KL = 0.215 +- 0.362 (in-sample avg dev_std = 0.095)
NEC for r=0.8 all L1 = 0.216 +- 0.334 (in-sample avg dev_std = 0.095)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.039 +- 0.208 (in-sample avg dev_std = 0.047)
NEC for r=0.05 class 1.0 = 0.058 +- 0.208 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all KL = 0.056 +- 0.208 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all L1 = 0.049 +- 0.178 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.51
NEC for r=0.1 class 0.0 = 0.049 +- 0.234 (in-sample avg dev_std = 0.077)
NEC for r=0.1 class 1.0 = 0.067 +- 0.234 (in-sample avg dev_std = 0.077)
NEC for r=0.1 all KL = 0.07 +- 0.234 (in-sample avg dev_std = 0.077)
NEC for r=0.1 all L1 = 0.058 +- 0.195 (in-sample avg dev_std = 0.077)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.509
NEC for r=0.2 class 0.0 = 0.055 +- 0.258 (in-sample avg dev_std = 0.109)
NEC for r=0.2 class 1.0 = 0.082 +- 0.258 (in-sample avg dev_std = 0.109)
NEC for r=0.2 all KL = 0.084 +- 0.258 (in-sample avg dev_std = 0.109)
NEC for r=0.2 all L1 = 0.068 +- 0.215 (in-sample avg dev_std = 0.109)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.512
NEC for r=0.4 class 0.0 = 0.049 +- 0.275 (in-sample avg dev_std = 0.185)
NEC for r=0.4 class 1.0 = 0.094 +- 0.275 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all KL = 0.097 +- 0.275 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all L1 = 0.071 +- 0.212 (in-sample avg dev_std = 0.185)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.517
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0332018
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.504
NEC for r=0.8 class 0.0 = 0.043 +- 0.265 (in-sample avg dev_std = 0.190)
NEC for r=0.8 class 1.0 = 0.083 +- 0.265 (in-sample avg dev_std = 0.190)
NEC for r=0.8 all KL = 0.094 +- 0.265 (in-sample avg dev_std = 0.190)
NEC for r=0.8 all L1 = 0.063 +- 0.194 (in-sample avg dev_std = 0.190)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 12:13:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 12:13:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.032


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.486
SUFF_SIMPLE for r=0.05 class 0.0 = 0.914 +- 0.458 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.179 +- 0.458 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.05 all KL = 0.398 +- 0.458 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.05 all L1 = 0.507 +- 0.385 (in-sample avg dev_std = 0.413)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.482
SUFF_SIMPLE for r=0.1 class 0.0 = 0.918 +- 0.462 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.174 +- 0.462 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.1 all KL = 0.4 +- 0.462 (in-sample avg dev_std = 0.397)
SUFF_SIMPLE for r=0.1 all L1 = 0.506 +- 0.388 (in-sample avg dev_std = 0.397)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.479
SUFF_SIMPLE for r=0.2 class 0.0 = 0.909 +- 0.456 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.175 +- 0.456 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.2 all KL = 0.392 +- 0.456 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.2 all L1 = 0.502 +- 0.384 (in-sample avg dev_std = 0.409)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.475
SUFF_SIMPLE for r=0.4 class 0.0 = 0.91 +- 0.456 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.17 +- 0.456 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.4 all KL = 0.392 +- 0.456 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.4 all L1 = 0.5 +- 0.387 (in-sample avg dev_std = 0.406)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012206
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.444
SUFF_SIMPLE for r=0.8 class 0.0 = 0.947 +- 0.478 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.145 +- 0.478 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 all KL = 0.435 +- 0.478 (in-sample avg dev_std = 0.100)
SUFF_SIMPLE for r=0.8 all L1 = 0.499 +- 0.412 (in-sample avg dev_std = 0.100)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.05 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.05 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.015)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.1 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.1 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.022)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.2 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.2 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.013)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.4 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.4 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.019)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.938 +- 0.297 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.901 +- 0.297 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.05 all KL = 0.895 +- 0.297 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.05 all L1 = 0.92 +- 0.231 (in-sample avg dev_std = 0.199)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.938 +- 0.298 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.9 +- 0.298 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all KL = 0.894 +- 0.298 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all L1 = 0.919 +- 0.233 (in-sample avg dev_std = 0.196)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.936 +- 0.300 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.897 +- 0.300 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all KL = 0.892 +- 0.300 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all L1 = 0.917 +- 0.236 (in-sample avg dev_std = 0.192)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048786
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.489
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.300 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.892 +- 0.300 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all KL = 0.894 +- 0.300 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all L1 = 0.913 +- 0.245 (in-sample avg dev_std = 0.173)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.503
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0316882
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.197 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.951 +- 0.197 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.956 +- 0.197 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.169 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.818
NEC for r=0.05 class 0.0 = 0.054 +- 0.375 (in-sample avg dev_std = 0.163)
NEC for r=0.05 class 1.0 = 0.302 +- 0.375 (in-sample avg dev_std = 0.163)
NEC for r=0.05 all KL = 0.235 +- 0.375 (in-sample avg dev_std = 0.163)
NEC for r=0.05 all L1 = 0.191 +- 0.312 (in-sample avg dev_std = 0.163)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.823
NEC for r=0.1 class 0.0 = 0.065 +- 0.371 (in-sample avg dev_std = 0.209)
NEC for r=0.1 class 1.0 = 0.299 +- 0.371 (in-sample avg dev_std = 0.209)
NEC for r=0.1 all KL = 0.246 +- 0.371 (in-sample avg dev_std = 0.209)
NEC for r=0.1 all L1 = 0.194 +- 0.308 (in-sample avg dev_std = 0.209)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.817
NEC for r=0.2 class 0.0 = 0.068 +- 0.379 (in-sample avg dev_std = 0.219)
NEC for r=0.2 class 1.0 = 0.311 +- 0.379 (in-sample avg dev_std = 0.219)
NEC for r=0.2 all KL = 0.265 +- 0.379 (in-sample avg dev_std = 0.219)
NEC for r=0.2 all L1 = 0.203 +- 0.310 (in-sample avg dev_std = 0.219)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.82
NEC for r=0.4 class 0.0 = 0.072 +- 0.380 (in-sample avg dev_std = 0.239)
NEC for r=0.4 class 1.0 = 0.317 +- 0.380 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all KL = 0.277 +- 0.380 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all L1 = 0.208 +- 0.308 (in-sample avg dev_std = 0.239)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012206
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.813
NEC for r=0.8 class 0.0 = 0.075 +- 0.389 (in-sample avg dev_std = 0.292)
NEC for r=0.8 class 1.0 = 0.332 +- 0.389 (in-sample avg dev_std = 0.292)
NEC for r=0.8 all KL = 0.307 +- 0.389 (in-sample avg dev_std = 0.292)
NEC for r=0.8 all L1 = 0.217 +- 0.305 (in-sample avg dev_std = 0.292)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.092)
NEC for r=0.05 class 1.0 = 0.846 +- 0.441 (in-sample avg dev_std = 0.092)
NEC for r=0.05 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.092)
NEC for r=0.05 all L1 = 0.592 +- 0.372 (in-sample avg dev_std = 0.092)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.087)
NEC for r=0.1 class 1.0 = 0.847 +- 0.441 (in-sample avg dev_std = 0.087)
NEC for r=0.1 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.087)
NEC for r=0.1 all L1 = 0.592 +- 0.372 (in-sample avg dev_std = 0.087)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.090)
NEC for r=0.2 class 1.0 = 0.846 +- 0.441 (in-sample avg dev_std = 0.090)
NEC for r=0.2 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.090)
NEC for r=0.2 all L1 = 0.592 +- 0.372 (in-sample avg dev_std = 0.090)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.5
NEC for r=0.4 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.113)
NEC for r=0.4 class 1.0 = 0.845 +- 0.441 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all L1 = 0.591 +- 0.372 (in-sample avg dev_std = 0.113)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.502
NEC for r=0.8 class 0.0 = 0.332 +- 0.440 (in-sample avg dev_std = 0.160)
NEC for r=0.8 class 1.0 = 0.843 +- 0.440 (in-sample avg dev_std = 0.160)
NEC for r=0.8 all KL = 0.656 +- 0.440 (in-sample avg dev_std = 0.160)
NEC for r=0.8 all L1 = 0.59 +- 0.371 (in-sample avg dev_std = 0.160)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.503
NEC for r=0.05 class 0.0 = 0.036 +- 0.215 (in-sample avg dev_std = 0.040)
NEC for r=0.05 class 1.0 = 0.055 +- 0.215 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all KL = 0.054 +- 0.215 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all L1 = 0.045 +- 0.181 (in-sample avg dev_std = 0.040)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.502
NEC for r=0.1 class 0.0 = 0.047 +- 0.241 (in-sample avg dev_std = 0.084)
NEC for r=0.1 class 1.0 = 0.064 +- 0.241 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all KL = 0.068 +- 0.241 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all L1 = 0.056 +- 0.200 (in-sample avg dev_std = 0.084)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.502
NEC for r=0.2 class 0.0 = 0.052 +- 0.253 (in-sample avg dev_std = 0.114)
NEC for r=0.2 class 1.0 = 0.069 +- 0.253 (in-sample avg dev_std = 0.114)
NEC for r=0.2 all KL = 0.075 +- 0.253 (in-sample avg dev_std = 0.114)
NEC for r=0.2 all L1 = 0.061 +- 0.206 (in-sample avg dev_std = 0.114)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048786
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.508
NEC for r=0.4 class 0.0 = 0.045 +- 0.269 (in-sample avg dev_std = 0.192)
NEC for r=0.4 class 1.0 = 0.081 +- 0.269 (in-sample avg dev_std = 0.192)
NEC for r=0.4 all KL = 0.087 +- 0.269 (in-sample avg dev_std = 0.192)
NEC for r=0.4 all L1 = 0.063 +- 0.201 (in-sample avg dev_std = 0.192)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0316882
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.502
NEC for r=0.8 class 0.0 = 0.038 +- 0.260 (in-sample avg dev_std = 0.184)
NEC for r=0.8 class 1.0 = 0.07 +- 0.260 (in-sample avg dev_std = 0.184)
NEC for r=0.8 all KL = 0.083 +- 0.260 (in-sample avg dev_std = 0.184)
NEC for r=0.8 all L1 = 0.054 +- 0.182 (in-sample avg dev_std = 0.184)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 12:27:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 12:27:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.034


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.514
SUFF_SIMPLE for r=0.05 class 0.0 = 0.93 +- 0.464 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.197 +- 0.464 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.05 all KL = 0.402 +- 0.464 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.05 all L1 = 0.524 +- 0.380 (in-sample avg dev_std = 0.467)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.511
SUFF_SIMPLE for r=0.1 class 0.0 = 0.931 +- 0.467 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.194 +- 0.467 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.1 all KL = 0.407 +- 0.467 (in-sample avg dev_std = 0.464)
SUFF_SIMPLE for r=0.1 all L1 = 0.523 +- 0.382 (in-sample avg dev_std = 0.464)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.501
SUFF_SIMPLE for r=0.2 class 0.0 = 0.93 +- 0.465 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.185 +- 0.465 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.2 all KL = 0.403 +- 0.465 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.2 all L1 = 0.517 +- 0.384 (in-sample avg dev_std = 0.449)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.469 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.175 +- 0.469 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all KL = 0.411 +- 0.469 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all L1 = 0.514 +- 0.390 (in-sample avg dev_std = 0.428)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013253999999999998
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.444
SUFF_SIMPLE for r=0.8 class 0.0 = 0.962 +- 0.483 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.14 +- 0.483 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all KL = 0.434 +- 0.483 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all L1 = 0.503 +- 0.415 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.012)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.014)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.001)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.494
SUFF_SIMPLE for r=0.05 class 0.0 = 0.934 +- 0.324 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.87 +- 0.324 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all KL = 0.872 +- 0.324 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all L1 = 0.902 +- 0.255 (in-sample avg dev_std = 0.212)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.934 +- 0.326 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.869 +- 0.326 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all KL = 0.871 +- 0.326 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all L1 = 0.902 +- 0.256 (in-sample avg dev_std = 0.208)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009226000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.493
SUFF_SIMPLE for r=0.2 class 0.0 = 0.931 +- 0.327 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.867 +- 0.327 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.2 all KL = 0.87 +- 0.327 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.2 all L1 = 0.899 +- 0.260 (in-sample avg dev_std = 0.207)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0050878
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.49
SUFF_SIMPLE for r=0.4 class 0.0 = 0.929 +- 0.328 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.86 +- 0.328 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.871 +- 0.328 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.895 +- 0.269 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.515
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0335534
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.491
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.928 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.942 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.195 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.88
NEC for r=0.05 class 0.0 = 0.042 +- 0.342 (in-sample avg dev_std = 0.165)
NEC for r=0.05 class 1.0 = 0.243 +- 0.342 (in-sample avg dev_std = 0.165)
NEC for r=0.05 all KL = 0.201 +- 0.342 (in-sample avg dev_std = 0.165)
NEC for r=0.05 all L1 = 0.153 +- 0.267 (in-sample avg dev_std = 0.165)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.874
NEC for r=0.1 class 0.0 = 0.044 +- 0.346 (in-sample avg dev_std = 0.201)
NEC for r=0.1 class 1.0 = 0.247 +- 0.346 (in-sample avg dev_std = 0.201)
NEC for r=0.1 all KL = 0.209 +- 0.346 (in-sample avg dev_std = 0.201)
NEC for r=0.1 all L1 = 0.156 +- 0.268 (in-sample avg dev_std = 0.201)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.88
NEC for r=0.2 class 0.0 = 0.047 +- 0.340 (in-sample avg dev_std = 0.211)
NEC for r=0.2 class 1.0 = 0.243 +- 0.340 (in-sample avg dev_std = 0.211)
NEC for r=0.2 all KL = 0.215 +- 0.340 (in-sample avg dev_std = 0.211)
NEC for r=0.2 all L1 = 0.155 +- 0.260 (in-sample avg dev_std = 0.211)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.874
NEC for r=0.4 class 0.0 = 0.051 +- 0.348 (in-sample avg dev_std = 0.234)
NEC for r=0.4 class 1.0 = 0.248 +- 0.348 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all KL = 0.222 +- 0.348 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all L1 = 0.16 +- 0.265 (in-sample avg dev_std = 0.234)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013253999999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.867
NEC for r=0.8 class 0.0 = 0.057 +- 0.368 (in-sample avg dev_std = 0.307)
NEC for r=0.8 class 1.0 = 0.27 +- 0.368 (in-sample avg dev_std = 0.307)
NEC for r=0.8 all KL = 0.263 +- 0.368 (in-sample avg dev_std = 0.307)
NEC for r=0.8 all L1 = 0.175 +- 0.263 (in-sample avg dev_std = 0.307)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.239 (in-sample avg dev_std = 0.027)
NEC for r=0.05 class 1.0 = 0.161 +- 0.239 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all KL = 0.079 +- 0.239 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.027)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.028)
NEC for r=0.1 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.028)
NEC for r=0.1 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.028)
NEC for r=0.1 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.028)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.002 +- 0.239 (in-sample avg dev_std = 0.033)
NEC for r=0.2 class 1.0 = 0.161 +- 0.239 (in-sample avg dev_std = 0.033)
NEC for r=0.2 all KL = 0.08 +- 0.239 (in-sample avg dev_std = 0.033)
NEC for r=0.2 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.033)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.045)
NEC for r=0.4 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all L1 = 0.082 +- 0.226 (in-sample avg dev_std = 0.045)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.002 +- 0.239 (in-sample avg dev_std = 0.068)
NEC for r=0.8 class 1.0 = 0.162 +- 0.239 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all KL = 0.081 +- 0.239 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all L1 = 0.083 +- 0.226 (in-sample avg dev_std = 0.068)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.039 +- 0.215 (in-sample avg dev_std = 0.046)
NEC for r=0.05 class 1.0 = 0.054 +- 0.215 (in-sample avg dev_std = 0.046)
NEC for r=0.05 all KL = 0.056 +- 0.215 (in-sample avg dev_std = 0.046)
NEC for r=0.05 all L1 = 0.046 +- 0.179 (in-sample avg dev_std = 0.046)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.513
NEC for r=0.1 class 0.0 = 0.049 +- 0.240 (in-sample avg dev_std = 0.084)
NEC for r=0.1 class 1.0 = 0.065 +- 0.240 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all KL = 0.07 +- 0.240 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all L1 = 0.057 +- 0.200 (in-sample avg dev_std = 0.084)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009226000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.51
NEC for r=0.2 class 0.0 = 0.056 +- 0.270 (in-sample avg dev_std = 0.119)
NEC for r=0.2 class 1.0 = 0.085 +- 0.270 (in-sample avg dev_std = 0.119)
NEC for r=0.2 all KL = 0.087 +- 0.270 (in-sample avg dev_std = 0.119)
NEC for r=0.2 all L1 = 0.07 +- 0.222 (in-sample avg dev_std = 0.119)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0050878
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.513
NEC for r=0.4 class 0.0 = 0.049 +- 0.290 (in-sample avg dev_std = 0.201)
NEC for r=0.4 class 1.0 = 0.101 +- 0.290 (in-sample avg dev_std = 0.201)
NEC for r=0.4 all KL = 0.103 +- 0.290 (in-sample avg dev_std = 0.201)
NEC for r=0.4 all L1 = 0.075 +- 0.222 (in-sample avg dev_std = 0.201)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0335534
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.506
NEC for r=0.8 class 0.0 = 0.044 +- 0.286 (in-sample avg dev_std = 0.206)
NEC for r=0.8 class 1.0 = 0.093 +- 0.286 (in-sample avg dev_std = 0.206)
NEC for r=0.8 all KL = 0.103 +- 0.286 (in-sample avg dev_std = 0.206)
NEC for r=0.8 all L1 = 0.068 +- 0.207 (in-sample avg dev_std = 0.206)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 12:42:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 12:42:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.002
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.007
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.024
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.057
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.004
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.028
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.073


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.507
SUFF_SIMPLE for r=0.05 class 0.0 = 0.954 +- 0.475 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.186 +- 0.475 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.05 all KL = 0.409 +- 0.475 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.05 all L1 = 0.529 +- 0.390 (in-sample avg dev_std = 0.467)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.939 +- 0.469 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.182 +- 0.469 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.1 all KL = 0.395 +- 0.469 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.1 all L1 = 0.519 +- 0.387 (in-sample avg dev_std = 0.462)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.5
SUFF_SIMPLE for r=0.2 class 0.0 = 0.942 +- 0.470 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.183 +- 0.470 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.2 all KL = 0.397 +- 0.470 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.2 all L1 = 0.521 +- 0.389 (in-sample avg dev_std = 0.453)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024214000000000003
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.509
SUFF_SIMPLE for r=0.4 class 0.0 = 0.953 +- 0.476 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.197 +- 0.476 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.4 all KL = 0.42 +- 0.476 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.4 all L1 = 0.534 +- 0.394 (in-sample avg dev_std = 0.434)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057266000000000004
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.561
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.486 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.283 +- 0.486 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.8 all KL = 0.5 +- 0.486 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.8 all L1 = 0.59 +- 0.403 (in-sample avg dev_std = 0.313)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.001)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.937 +- 0.315 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.882 +- 0.315 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.315 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.245 (in-sample avg dev_std = 0.217)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.937 +- 0.314 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.881 +- 0.314 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all KL = 0.882 +- 0.314 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.1 all L1 = 0.909 +- 0.247 (in-sample avg dev_std = 0.211)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.49
SUFF_SIMPLE for r=0.2 class 0.0 = 0.936 +- 0.312 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.88 +- 0.312 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.312 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all L1 = 0.909 +- 0.250 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0279488
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.936 +- 0.308 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.308 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.4 all KL = 0.887 +- 0.308 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.4 all L1 = 0.907 +- 0.254 (in-sample avg dev_std = 0.170)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.516
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07271140000000001
len(reference) = 4915
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.516
SUFF_SIMPLE for r=0.8 class 0.0 = 0.956 +- 0.241 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.929 +- 0.241 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.8 all KL = 0.932 +- 0.241 (in-sample avg dev_std = 0.082)
SUFF_SIMPLE for r=0.8 all L1 = 0.943 +- 0.200 (in-sample avg dev_std = 0.082)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.855
NEC for r=0.05 class 0.0 = 0.028 +- 0.363 (in-sample avg dev_std = 0.210)
NEC for r=0.05 class 1.0 = 0.27 +- 0.363 (in-sample avg dev_std = 0.210)
NEC for r=0.05 all KL = 0.225 +- 0.363 (in-sample avg dev_std = 0.210)
NEC for r=0.05 all L1 = 0.162 +- 0.283 (in-sample avg dev_std = 0.210)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.849
NEC for r=0.1 class 0.0 = 0.03 +- 0.374 (in-sample avg dev_std = 0.231)
NEC for r=0.1 class 1.0 = 0.287 +- 0.374 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all KL = 0.246 +- 0.374 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all L1 = 0.172 +- 0.286 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.839
NEC for r=0.2 class 0.0 = 0.03 +- 0.384 (in-sample avg dev_std = 0.268)
NEC for r=0.2 class 1.0 = 0.311 +- 0.384 (in-sample avg dev_std = 0.268)
NEC for r=0.2 all KL = 0.272 +- 0.384 (in-sample avg dev_std = 0.268)
NEC for r=0.2 all L1 = 0.186 +- 0.292 (in-sample avg dev_std = 0.268)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024214000000000003
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.826
NEC for r=0.4 class 0.0 = 0.035 +- 0.401 (in-sample avg dev_std = 0.332)
NEC for r=0.4 class 1.0 = 0.339 +- 0.401 (in-sample avg dev_std = 0.332)
NEC for r=0.4 all KL = 0.306 +- 0.401 (in-sample avg dev_std = 0.332)
NEC for r=0.4 all L1 = 0.203 +- 0.297 (in-sample avg dev_std = 0.332)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057266000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.811
NEC for r=0.8 class 0.0 = 0.041 +- 0.423 (in-sample avg dev_std = 0.424)
NEC for r=0.8 class 1.0 = 0.379 +- 0.423 (in-sample avg dev_std = 0.424)
NEC for r=0.8 all KL = 0.377 +- 0.423 (in-sample avg dev_std = 0.424)
NEC for r=0.8 all L1 = 0.228 +- 0.291 (in-sample avg dev_std = 0.424)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.211 (in-sample avg dev_std = 0.028)
NEC for r=0.05 class 1.0 = 0.123 +- 0.211 (in-sample avg dev_std = 0.028)
NEC for r=0.05 all KL = 0.06 +- 0.211 (in-sample avg dev_std = 0.028)
NEC for r=0.05 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.028)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.021)
NEC for r=0.1 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.021)
NEC for r=0.1 all KL = 0.06 +- 0.210 (in-sample avg dev_std = 0.021)
NEC for r=0.1 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.021)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.0 +- 0.211 (in-sample avg dev_std = 0.038)
NEC for r=0.2 class 1.0 = 0.123 +- 0.211 (in-sample avg dev_std = 0.038)
NEC for r=0.2 all KL = 0.06 +- 0.211 (in-sample avg dev_std = 0.038)
NEC for r=0.2 all L1 = 0.062 +- 0.199 (in-sample avg dev_std = 0.038)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.0 +- 0.212 (in-sample avg dev_std = 0.051)
NEC for r=0.4 class 1.0 = 0.123 +- 0.212 (in-sample avg dev_std = 0.051)
NEC for r=0.4 all KL = 0.061 +- 0.212 (in-sample avg dev_std = 0.051)
NEC for r=0.4 all L1 = 0.062 +- 0.199 (in-sample avg dev_std = 0.051)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.0 +- 0.213 (in-sample avg dev_std = 0.072)
NEC for r=0.8 class 1.0 = 0.124 +- 0.213 (in-sample avg dev_std = 0.072)
NEC for r=0.8 all KL = 0.063 +- 0.213 (in-sample avg dev_std = 0.072)
NEC for r=0.8 all L1 = 0.063 +- 0.199 (in-sample avg dev_std = 0.072)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.509
NEC for r=0.05 class 0.0 = 0.043 +- 0.248 (in-sample avg dev_std = 0.069)
NEC for r=0.05 class 1.0 = 0.08 +- 0.248 (in-sample avg dev_std = 0.069)
NEC for r=0.05 all KL = 0.073 +- 0.248 (in-sample avg dev_std = 0.069)
NEC for r=0.05 all L1 = 0.061 +- 0.211 (in-sample avg dev_std = 0.069)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.512
NEC for r=0.1 class 0.0 = 0.054 +- 0.277 (in-sample avg dev_std = 0.123)
NEC for r=0.1 class 1.0 = 0.095 +- 0.277 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all KL = 0.092 +- 0.277 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all L1 = 0.074 +- 0.229 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.506
NEC for r=0.2 class 0.0 = 0.053 +- 0.286 (in-sample avg dev_std = 0.159)
NEC for r=0.2 class 1.0 = 0.1 +- 0.286 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all KL = 0.098 +- 0.286 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all L1 = 0.076 +- 0.228 (in-sample avg dev_std = 0.159)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0279488
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.502
NEC for r=0.4 class 0.0 = 0.046 +- 0.279 (in-sample avg dev_std = 0.195)
NEC for r=0.4 class 1.0 = 0.085 +- 0.279 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all KL = 0.095 +- 0.279 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all L1 = 0.065 +- 0.204 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.52
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07271140000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.494
NEC for r=0.8 class 0.0 = 0.037 +- 0.288 (in-sample avg dev_std = 0.217)
NEC for r=0.8 class 1.0 = 0.096 +- 0.288 (in-sample avg dev_std = 0.217)
NEC for r=0.8 all KL = 0.102 +- 0.288 (in-sample avg dev_std = 0.217)
NEC for r=0.8 all L1 = 0.066 +- 0.203 (in-sample avg dev_std = 0.217)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 12:56:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 12:56:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.491
SUFF_SIMPLE for r=0.05 class 0.0 = 0.94 +- 0.466 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.182 +- 0.466 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.05 all KL = 0.411 +- 0.466 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.05 all L1 = 0.52 +- 0.388 (in-sample avg dev_std = 0.423)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.487
SUFF_SIMPLE for r=0.1 class 0.0 = 0.944 +- 0.467 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.179 +- 0.467 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.1 all KL = 0.415 +- 0.467 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.1 all L1 = 0.52 +- 0.390 (in-sample avg dev_std = 0.402)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.487
SUFF_SIMPLE for r=0.2 class 0.0 = 0.944 +- 0.466 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.177 +- 0.466 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.2 all KL = 0.414 +- 0.466 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.2 all L1 = 0.519 +- 0.390 (in-sample avg dev_std = 0.417)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.484
SUFF_SIMPLE for r=0.4 class 0.0 = 0.939 +- 0.465 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.175 +- 0.465 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.4 all KL = 0.406 +- 0.465 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.4 all L1 = 0.515 +- 0.389 (in-sample avg dev_std = 0.427)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013007999999999999
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.443
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.483 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.143 +- 0.483 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.8 all KL = 0.441 +- 0.483 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.8 all L1 = 0.508 +- 0.415 (in-sample avg dev_std = 0.110)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.05 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.006)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.494
SUFF_SIMPLE for r=0.05 class 0.0 = 0.937 +- 0.307 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.893 +- 0.307 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.05 all KL = 0.886 +- 0.307 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.05 all L1 = 0.915 +- 0.235 (in-sample avg dev_std = 0.216)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.494
SUFF_SIMPLE for r=0.1 class 0.0 = 0.937 +- 0.303 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.894 +- 0.303 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.1 all KL = 0.889 +- 0.303 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.236 (in-sample avg dev_std = 0.205)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.935 +- 0.305 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.889 +- 0.305 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all KL = 0.889 +- 0.305 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all L1 = 0.913 +- 0.241 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.489
SUFF_SIMPLE for r=0.4 class 0.0 = 0.933 +- 0.307 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.884 +- 0.307 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all KL = 0.888 +- 0.307 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all L1 = 0.909 +- 0.250 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.506
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033146
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.491
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.945 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.952 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.959 +- 0.175 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.844
NEC for r=0.05 class 0.0 = 0.032 +- 0.358 (in-sample avg dev_std = 0.170)
NEC for r=0.05 class 1.0 = 0.289 +- 0.358 (in-sample avg dev_std = 0.170)
NEC for r=0.05 all KL = 0.224 +- 0.358 (in-sample avg dev_std = 0.170)
NEC for r=0.05 all L1 = 0.174 +- 0.290 (in-sample avg dev_std = 0.170)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.849
NEC for r=0.1 class 0.0 = 0.035 +- 0.356 (in-sample avg dev_std = 0.202)
NEC for r=0.1 class 1.0 = 0.285 +- 0.356 (in-sample avg dev_std = 0.202)
NEC for r=0.1 all KL = 0.229 +- 0.356 (in-sample avg dev_std = 0.202)
NEC for r=0.1 all L1 = 0.174 +- 0.284 (in-sample avg dev_std = 0.202)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.845
NEC for r=0.2 class 0.0 = 0.041 +- 0.360 (in-sample avg dev_std = 0.232)
NEC for r=0.2 class 1.0 = 0.288 +- 0.360 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all KL = 0.242 +- 0.360 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all L1 = 0.178 +- 0.280 (in-sample avg dev_std = 0.232)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.85
NEC for r=0.4 class 0.0 = 0.045 +- 0.356 (in-sample avg dev_std = 0.257)
NEC for r=0.4 class 1.0 = 0.284 +- 0.356 (in-sample avg dev_std = 0.257)
NEC for r=0.4 all KL = 0.248 +- 0.356 (in-sample avg dev_std = 0.257)
NEC for r=0.4 all L1 = 0.178 +- 0.275 (in-sample avg dev_std = 0.257)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013007999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.841
NEC for r=0.8 class 0.0 = 0.048 +- 0.365 (in-sample avg dev_std = 0.287)
NEC for r=0.8 class 1.0 = 0.304 +- 0.365 (in-sample avg dev_std = 0.287)
NEC for r=0.8 all KL = 0.275 +- 0.365 (in-sample avg dev_std = 0.287)
NEC for r=0.8 all L1 = 0.19 +- 0.277 (in-sample avg dev_std = 0.287)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.018)
NEC for r=0.05 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.018)
NEC for r=0.05 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.018)
NEC for r=0.05 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.018)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.020)
NEC for r=0.1 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.020)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.025)
NEC for r=0.2 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.025)
NEC for r=0.2 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.025)
NEC for r=0.2 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.025)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.031)
NEC for r=0.4 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.031)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
NEC for r=0.8 class 0.0 = 0.001 +- 0.205 (in-sample avg dev_std = 0.042)
NEC for r=0.8 class 1.0 = 0.11 +- 0.205 (in-sample avg dev_std = 0.042)
NEC for r=0.8 all KL = 0.055 +- 0.205 (in-sample avg dev_std = 0.042)
NEC for r=0.8 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.042)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.039 +- 0.220 (in-sample avg dev_std = 0.052)
NEC for r=0.05 class 1.0 = 0.061 +- 0.220 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all KL = 0.058 +- 0.220 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all L1 = 0.05 +- 0.188 (in-sample avg dev_std = 0.052)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.503
NEC for r=0.1 class 0.0 = 0.049 +- 0.245 (in-sample avg dev_std = 0.079)
NEC for r=0.1 class 1.0 = 0.07 +- 0.245 (in-sample avg dev_std = 0.079)
NEC for r=0.1 all KL = 0.072 +- 0.245 (in-sample avg dev_std = 0.079)
NEC for r=0.1 all L1 = 0.06 +- 0.206 (in-sample avg dev_std = 0.079)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.053 +- 0.256 (in-sample avg dev_std = 0.112)
NEC for r=0.2 class 1.0 = 0.074 +- 0.256 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all KL = 0.079 +- 0.256 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all L1 = 0.063 +- 0.210 (in-sample avg dev_std = 0.112)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.509
NEC for r=0.4 class 0.0 = 0.045 +- 0.270 (in-sample avg dev_std = 0.187)
NEC for r=0.4 class 1.0 = 0.084 +- 0.270 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all KL = 0.089 +- 0.270 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all L1 = 0.064 +- 0.203 (in-sample avg dev_std = 0.187)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.511
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033146
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.504
NEC for r=0.8 class 0.0 = 0.039 +- 0.259 (in-sample avg dev_std = 0.185)
NEC for r=0.8 class 1.0 = 0.072 +- 0.259 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all KL = 0.085 +- 0.259 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all L1 = 0.055 +- 0.183 (in-sample avg dev_std = 0.185)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.417, 0.394, 0.404, 0.414, 0.445], 'all_L1': [0.53, 0.518, 0.52, 0.524, 0.515]}), defaultdict(<class 'list'>, {'all_KL': [0.4, 0.402, 0.392, 0.402, 0.504], 'all_L1': [0.533, 0.529, 0.528, 0.534, 0.591]}), defaultdict(<class 'list'>, {'all_KL': [0.413, 0.409, 0.422, 0.417, 0.44], 'all_L1': [0.514, 0.51, 0.515, 0.512, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.421, 0.416, 0.421, 0.448], 'all_L1': [0.524, 0.527, 0.523, 0.524, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.409, 0.403, 0.417, 0.405, 0.447], 'all_L1': [0.525, 0.522, 0.524, 0.519, 0.517]}), defaultdict(<class 'list'>, {'all_KL': [0.416, 0.404, 0.413, 0.405, 0.431], 'all_L1': [0.515, 0.509, 0.511, 0.505, 0.491]}), defaultdict(<class 'list'>, {'all_KL': [0.398, 0.4, 0.392, 0.392, 0.435], 'all_L1': [0.507, 0.506, 0.502, 0.5, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.407, 0.403, 0.411, 0.434], 'all_L1': [0.524, 0.523, 0.517, 0.514, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.409, 0.395, 0.397, 0.42, 0.5], 'all_L1': [0.529, 0.519, 0.521, 0.534, 0.59]}), defaultdict(<class 'list'>, {'all_KL': [0.411, 0.415, 0.414, 0.406, 0.441], 'all_L1': [0.52, 0.52, 0.519, 0.515, 0.508]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.227, 0.248, 0.266, 0.278, 0.316], 'all_L1': [0.173, 0.18, 0.188, 0.19, 0.21]}), defaultdict(<class 'list'>, {'all_KL': [0.181, 0.18, 0.201, 0.237, 0.305], 'all_L1': [0.135, 0.134, 0.145, 0.164, 0.186]}), defaultdict(<class 'list'>, {'all_KL': [0.264, 0.261, 0.26, 0.271, 0.301], 'all_L1': [0.208, 0.204, 0.2, 0.206, 0.22]}), defaultdict(<class 'list'>, {'all_KL': [0.251, 0.27, 0.271, 0.277, 0.317], 'all_L1': [0.195, 0.204, 0.2, 0.203, 0.217]}), defaultdict(<class 'list'>, {'all_KL': [0.237, 0.255, 0.272, 0.285, 0.334], 'all_L1': [0.182, 0.189, 0.195, 0.201, 0.219]}), defaultdict(<class 'list'>, {'all_KL': [0.193, 0.195, 0.195, 0.201, 0.232], 'all_L1': [0.171, 0.17, 0.169, 0.172, 0.186]}), defaultdict(<class 'list'>, {'all_KL': [0.235, 0.246, 0.265, 0.277, 0.307], 'all_L1': [0.191, 0.194, 0.203, 0.208, 0.217]}), defaultdict(<class 'list'>, {'all_KL': [0.201, 0.209, 0.215, 0.222, 0.263], 'all_L1': [0.153, 0.156, 0.155, 0.16, 0.175]}), defaultdict(<class 'list'>, {'all_KL': [0.225, 0.246, 0.272, 0.306, 0.377], 'all_L1': [0.162, 0.172, 0.186, 0.203, 0.228]}), defaultdict(<class 'list'>, {'all_KL': [0.224, 0.229, 0.242, 0.248, 0.275], 'all_L1': [0.174, 0.174, 0.178, 0.178, 0.19]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.582, 0.582, 0.582, 0.582, 0.582], 'all_L1': [0.615, 0.615, 0.615, 0.615, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.758, 0.758, 0.758, 0.758, 0.758], 'all_L1': [0.768, 0.768, 0.768, 0.768, 0.768]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.639, 0.639, 0.639, 0.639], 'all_L1': [0.658, 0.658, 0.658, 0.658, 0.658]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.868, 0.868, 0.868, 0.868], 'all_L1': [0.867, 0.867, 0.867, 0.867, 0.867]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.721, 0.721, 0.721, 0.721], 'all_L1': [0.734, 0.734, 0.734, 0.734, 0.734]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.786, 0.786, 0.786, 0.786], 'all_L1': [0.784, 0.784, 0.784, 0.784, 0.784]}), defaultdict(<class 'list'>, {'all_KL': [0.344, 0.344, 0.344, 0.344, 0.344], 'all_L1': [0.407, 0.407, 0.407, 0.407, 0.407]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.921, 0.921, 0.921, 0.921], 'all_L1': [0.918, 0.918, 0.918, 0.918, 0.918]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.941, 0.941, 0.941, 0.941], 'all_L1': [0.938, 0.938, 0.938, 0.938, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.945, 0.945, 0.945, 0.945], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.418, 0.418, 0.418, 0.418, 0.418], 'all_L1': [0.383, 0.383, 0.383, 0.382, 0.381]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.242, 0.242, 0.243, 0.244], 'all_L1': [0.232, 0.232, 0.232, 0.232, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.36, 0.361, 0.361, 0.361, 0.361], 'all_L1': [0.342, 0.342, 0.342, 0.342, 0.341]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.132, 0.132, 0.132, 0.132], 'all_L1': [0.133, 0.134, 0.133, 0.134, 0.133]}), defaultdict(<class 'list'>, {'all_KL': [0.28, 0.28, 0.28, 0.281, 0.284], 'all_L1': [0.266, 0.266, 0.266, 0.266, 0.268]}), defaultdict(<class 'list'>, {'all_KL': [0.214, 0.214, 0.214, 0.215, 0.215], 'all_L1': [0.216, 0.216, 0.216, 0.216, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.656, 0.656, 0.656, 0.656], 'all_L1': [0.592, 0.592, 0.592, 0.591, 0.59]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.08, 0.079, 0.081], 'all_L1': [0.082, 0.082, 0.082, 0.082, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.06, 0.06, 0.06, 0.061, 0.063], 'all_L1': [0.062, 0.062, 0.062, 0.062, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.055, 0.055, 0.055, 0.055], 'all_L1': [0.056, 0.056, 0.056, 0.056, 0.056]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.88, 0.88, 0.879, 0.88, 0.95], 'all_L1': [0.909, 0.908, 0.907, 0.903, 0.956]}), defaultdict(<class 'list'>, {'all_KL': [0.873, 0.874, 0.873, 0.877, 0.924], 'all_L1': [0.903, 0.903, 0.9, 0.9, 0.937]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.889, 0.891, 0.89, 0.951], 'all_L1': [0.917, 0.916, 0.914, 0.91, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.887, 0.887, 0.886, 0.95], 'all_L1': [0.914, 0.913, 0.911, 0.907, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.888, 0.887, 0.888, 0.956], 'all_L1': [0.916, 0.916, 0.913, 0.909, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.88, 0.88, 0.88, 0.947], 'all_L1': [0.908, 0.907, 0.906, 0.902, 0.953]}), defaultdict(<class 'list'>, {'all_KL': [0.895, 0.894, 0.892, 0.894, 0.956], 'all_L1': [0.92, 0.919, 0.917, 0.913, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.872, 0.871, 0.87, 0.871, 0.942], 'all_L1': [0.902, 0.902, 0.899, 0.895, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.882, 0.884, 0.887, 0.932], 'all_L1': [0.91, 0.909, 0.909, 0.907, 0.943]}), defaultdict(<class 'list'>, {'all_KL': [0.886, 0.889, 0.889, 0.888, 0.952], 'all_L1': [0.915, 0.916, 0.913, 0.909, 0.959]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.052, 0.066, 0.085, 0.1, 0.097], 'all_L1': [0.044, 0.053, 0.067, 0.071, 0.062]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.097, 0.107, 0.101, 0.108], 'all_L1': [0.066, 0.077, 0.083, 0.071, 0.073]}), defaultdict(<class 'list'>, {'all_KL': [0.059, 0.074, 0.077, 0.085, 0.078], 'all_L1': [0.049, 0.06, 0.062, 0.061, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.059, 0.072, 0.08, 0.089, 0.085], 'all_L1': [0.049, 0.06, 0.064, 0.064, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.049, 0.064, 0.08, 0.094, 0.096], 'all_L1': [0.041, 0.051, 0.063, 0.067, 0.059]}), defaultdict(<class 'list'>, {'all_KL': [0.056, 0.07, 0.084, 0.097, 0.094], 'all_L1': [0.049, 0.058, 0.068, 0.071, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.068, 0.075, 0.087, 0.083], 'all_L1': [0.045, 0.056, 0.061, 0.063, 0.054]}), defaultdict(<class 'list'>, {'all_KL': [0.056, 0.07, 0.087, 0.103, 0.103], 'all_L1': [0.046, 0.057, 0.07, 0.075, 0.068]}), defaultdict(<class 'list'>, {'all_KL': [0.073, 0.092, 0.098, 0.095, 0.102], 'all_L1': [0.061, 0.074, 0.076, 0.065, 0.066]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.072, 0.079, 0.089, 0.085], 'all_L1': [0.05, 0.06, 0.063, 0.064, 0.055]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.522 +- 0.008, 0.518 +- 0.007, 0.518 +- 0.007, 0.518 +- 0.011, 0.523 +- 0.034
suff_simple class all_KL  =  0.408 +- 0.006, 0.405 +- 0.008, 0.407 +- 0.010, 0.409 +- 0.009, 0.452 +- 0.025
suff_simple_acc_int  =  0.501 +- 0.017, 0.495 +- 0.017, 0.496 +- 0.018, 0.493 +- 0.020, 0.469 +- 0.052
nec class all_L1  =  0.174 +- 0.020, 0.178 +- 0.021, 0.182 +- 0.019, 0.188 +- 0.017, 0.205 +- 0.018
nec class all_KL  =  0.224 +- 0.024, 0.234 +- 0.028, 0.246 +- 0.029, 0.260 +- 0.031, 0.303 +- 0.038
nec_acc_int  =  0.845 +- 0.032, 0.846 +- 0.032, 0.844 +- 0.031, 0.841 +- 0.028, 0.831 +- 0.029

Eval split val
suff_simple class all_L1  =  0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161
suff_simple class all_KL  =  0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180
suff_simple_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000
nec class all_L1  =  0.236 +- 0.161, 0.236 +- 0.161, 0.236 +- 0.161, 0.236 +- 0.160, 0.236 +- 0.160
nec class all_KL  =  0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.251 +- 0.180
nec_acc_int  =  0.497 +- 0.001, 0.497 +- 0.001, 0.497 +- 0.001, 0.498 +- 0.001, 0.499 +- 0.002

Eval split test
suff_simple class all_L1  =  0.911 +- 0.006, 0.911 +- 0.006, 0.909 +- 0.006, 0.906 +- 0.005, 0.954 +- 0.008
suff_simple class all_KL  =  0.884 +- 0.007, 0.883 +- 0.007, 0.883 +- 0.007, 0.884 +- 0.007, 0.946 +- 0.010
suff_simple_acc_int  =  0.493 +- 0.001, 0.493 +- 0.001, 0.491 +- 0.001, 0.490 +- 0.002, 0.496 +- 0.011
nec class all_L1  =  0.050 +- 0.007, 0.061 +- 0.008, 0.068 +- 0.007, 0.067 +- 0.004, 0.061 +- 0.006
nec class all_KL  =  0.059 +- 0.009, 0.074 +- 0.010, 0.085 +- 0.010, 0.094 +- 0.006, 0.093 +- 0.009
nec_acc_int  =  0.508 +- 0.004, 0.508 +- 0.005, 0.507 +- 0.002, 0.509 +- 0.003, 0.502 +- 0.004


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.348 +- 0.008, 0.348 +- 0.009, 0.350 +- 0.009, 0.353 +- 0.010, 0.364 +- 0.020
Faith. Armon (L1)= 		  =  0.261 +- 0.022, 0.264 +- 0.023, 0.269 +- 0.021, 0.276 +- 0.019, 0.294 +- 0.020
Faith. GMean (L1)= 	  =  0.301 +- 0.016, 0.303 +- 0.017, 0.306 +- 0.016, 0.312 +- 0.015, 0.327 +- 0.019
Faith. Aritm (KL)= 		  =  0.316 +- 0.013, 0.319 +- 0.015, 0.326 +- 0.016, 0.335 +- 0.017, 0.378 +- 0.028
Faith. Armon (KL)= 		  =  0.288 +- 0.021, 0.296 +- 0.024, 0.306 +- 0.024, 0.317 +- 0.025, 0.362 +- 0.033
Faith. GMean (KL)= 	  =  0.302 +- 0.017, 0.307 +- 0.020, 0.316 +- 0.020, 0.326 +- 0.021, 0.370 +- 0.031

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.001, 0.500 +- 0.001
Faith. Armon (L1)= 		  =  0.309 +- 0.140, 0.309 +- 0.140, 0.309 +- 0.140, 0.309 +- 0.140, 0.310 +- 0.139
Faith. GMean (L1)= 	  =  0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.096
Faith. Aritm (KL)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.501 +- 0.001
Faith. Armon (KL)= 		  =  0.310 +- 0.142, 0.310 +- 0.142, 0.310 +- 0.142, 0.310 +- 0.142, 0.311 +- 0.141
Faith. GMean (KL)= 	  =  0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.098, 0.381 +- 0.098, 0.383 +- 0.098

Eval split test
Faith. Aritm (L1)= 		  =  0.481 +- 0.003, 0.486 +- 0.004, 0.488 +- 0.002, 0.486 +- 0.001, 0.507 +- 0.002
Faith. Armon (L1)= 		  =  0.095 +- 0.013, 0.114 +- 0.014, 0.126 +- 0.011, 0.125 +- 0.007, 0.114 +- 0.011
Faith. GMean (L1)= 	  =  0.213 +- 0.015, 0.234 +- 0.015, 0.248 +- 0.011, 0.247 +- 0.007, 0.240 +- 0.012
Faith. Aritm (KL)= 		  =  0.472 +- 0.004, 0.479 +- 0.005, 0.484 +- 0.004, 0.489 +- 0.001, 0.520 +- 0.003
Faith. Armon (KL)= 		  =  0.111 +- 0.015, 0.137 +- 0.017, 0.155 +- 0.016, 0.170 +- 0.010, 0.169 +- 0.015
Faith. GMean (KL)= 	  =  0.229 +- 0.016, 0.256 +- 0.017, 0.274 +- 0.014, 0.288 +- 0.008, 0.296 +- 0.014
Computed for split load_split = id



Completed in  2:27:03.010557  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 13:10:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 01:10:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.029
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.035
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.020
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.030
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.046


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.954 +- 0.470 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.184 +- 0.470 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all KL = 0.412 +- 0.470 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all L1 = 0.528 +- 0.392 (in-sample avg dev_std = 0.442)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012716000000000002
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.489
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.468 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.18 +- 0.468 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all KL = 0.405 +- 0.468 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.1 all L1 = 0.524 +- 0.392 (in-sample avg dev_std = 0.438)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02169
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.487
SUFF_SIMPLE for r=0.2 class 0.0 = 0.948 +- 0.465 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.183 +- 0.465 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.2 all KL = 0.404 +- 0.465 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.2 all L1 = 0.524 +- 0.392 (in-sample avg dev_std = 0.419)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028654000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.484
SUFF_SIMPLE for r=0.4 class 0.0 = 0.947 +- 0.465 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.178 +- 0.465 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.4 all KL = 0.402 +- 0.465 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.4 all L1 = 0.521 +- 0.392 (in-sample avg dev_std = 0.432)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034980000000000004
len(reference) = 497
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.459
SUFF_SIMPLE for r=0.8 class 0.0 = 0.983 +- 0.485 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.161 +- 0.485 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.8 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.8 all L1 = 0.525 +- 0.417 (in-sample avg dev_std = 0.198)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023496
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.05 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.05 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.023)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0028454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.1 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.1 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.023)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019380000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.022)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010522
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.4 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.4 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.022)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005406
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.8 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0082018
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.935 +- 0.315 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.884 +- 0.315 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.315 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.244 (in-sample avg dev_std = 0.213)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012098600000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.935 +- 0.315 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.883 +- 0.315 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.1 all KL = 0.88 +- 0.315 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.1 all L1 = 0.909 +- 0.244 (in-sample avg dev_std = 0.215)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0198236
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.934 +- 0.316 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.88 +- 0.316 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 all KL = 0.881 +- 0.316 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 all L1 = 0.907 +- 0.249 (in-sample avg dev_std = 0.210)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0301872
len(reference) = 4996
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.932 +- 0.315 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.88 +- 0.315 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.4 all KL = 0.882 +- 0.315 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.4 all L1 = 0.906 +- 0.252 (in-sample avg dev_std = 0.196)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.512
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0462344
len(reference) = 4874
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.473
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.261 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.898 +- 0.261 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.922 +- 0.261 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.933 +- 0.224 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.808
NEC for r=0.05 class 0.0 = 0.025 +- 0.397 (in-sample avg dev_std = 0.283)
NEC for r=0.05 class 1.0 = 0.346 +- 0.397 (in-sample avg dev_std = 0.283)
NEC for r=0.05 all KL = 0.285 +- 0.397 (in-sample avg dev_std = 0.283)
NEC for r=0.05 all L1 = 0.203 +- 0.307 (in-sample avg dev_std = 0.283)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012716000000000002
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.806
NEC for r=0.1 class 0.0 = 0.03 +- 0.403 (in-sample avg dev_std = 0.318)
NEC for r=0.1 class 1.0 = 0.354 +- 0.403 (in-sample avg dev_std = 0.318)
NEC for r=0.1 all KL = 0.305 +- 0.403 (in-sample avg dev_std = 0.318)
NEC for r=0.1 all L1 = 0.209 +- 0.304 (in-sample avg dev_std = 0.318)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02169
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.804
NEC for r=0.2 class 0.0 = 0.031 +- 0.411 (in-sample avg dev_std = 0.352)
NEC for r=0.2 class 1.0 = 0.372 +- 0.411 (in-sample avg dev_std = 0.352)
NEC for r=0.2 all KL = 0.332 +- 0.411 (in-sample avg dev_std = 0.352)
NEC for r=0.2 all L1 = 0.22 +- 0.303 (in-sample avg dev_std = 0.352)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028654000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.805
NEC for r=0.4 class 0.0 = 0.03 +- 0.408 (in-sample avg dev_std = 0.354)
NEC for r=0.4 class 1.0 = 0.368 +- 0.408 (in-sample avg dev_std = 0.354)
NEC for r=0.4 all KL = 0.337 +- 0.408 (in-sample avg dev_std = 0.354)
NEC for r=0.4 all L1 = 0.217 +- 0.298 (in-sample avg dev_std = 0.354)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034980000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.801
NEC for r=0.8 class 0.0 = 0.042 +- 0.414 (in-sample avg dev_std = 0.386)
NEC for r=0.8 class 1.0 = 0.377 +- 0.414 (in-sample avg dev_std = 0.386)
NEC for r=0.8 all KL = 0.365 +- 0.414 (in-sample avg dev_std = 0.386)
NEC for r=0.8 all L1 = 0.228 +- 0.296 (in-sample avg dev_std = 0.386)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023496
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.502
NEC for r=0.05 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.115)
NEC for r=0.05 class 1.0 = 0.646 +- 0.463 (in-sample avg dev_std = 0.115)
NEC for r=0.05 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.115)
NEC for r=0.05 all L1 = 0.382 +- 0.403 (in-sample avg dev_std = 0.115)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0028454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.107)
NEC for r=0.1 class 1.0 = 0.647 +- 0.463 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all L1 = 0.382 +- 0.404 (in-sample avg dev_std = 0.107)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019380000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.5
NEC for r=0.2 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.097)
NEC for r=0.2 class 1.0 = 0.648 +- 0.463 (in-sample avg dev_std = 0.097)
NEC for r=0.2 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.097)
NEC for r=0.2 all L1 = 0.383 +- 0.404 (in-sample avg dev_std = 0.097)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010522
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.5
NEC for r=0.4 class 0.0 = 0.113 +- 0.463 (in-sample avg dev_std = 0.103)
NEC for r=0.4 class 1.0 = 0.647 +- 0.463 (in-sample avg dev_std = 0.103)
NEC for r=0.4 all KL = 0.417 +- 0.463 (in-sample avg dev_std = 0.103)
NEC for r=0.4 all L1 = 0.382 +- 0.404 (in-sample avg dev_std = 0.103)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005406
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.502
NEC for r=0.8 class 0.0 = 0.114 +- 0.462 (in-sample avg dev_std = 0.137)
NEC for r=0.8 class 1.0 = 0.646 +- 0.462 (in-sample avg dev_std = 0.137)
NEC for r=0.8 all KL = 0.418 +- 0.462 (in-sample avg dev_std = 0.137)
NEC for r=0.8 all L1 = 0.382 +- 0.403 (in-sample avg dev_std = 0.137)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0082018
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.042 +- 0.240 (in-sample avg dev_std = 0.047)
NEC for r=0.05 class 1.0 = 0.074 +- 0.240 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all KL = 0.069 +- 0.240 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all L1 = 0.057 +- 0.203 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012098600000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.503
NEC for r=0.1 class 0.0 = 0.05 +- 0.262 (in-sample avg dev_std = 0.115)
NEC for r=0.1 class 1.0 = 0.085 +- 0.262 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all KL = 0.082 +- 0.262 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all L1 = 0.067 +- 0.218 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0198236
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.501
NEC for r=0.2 class 0.0 = 0.051 +- 0.279 (in-sample avg dev_std = 0.158)
NEC for r=0.2 class 1.0 = 0.091 +- 0.279 (in-sample avg dev_std = 0.158)
NEC for r=0.2 all KL = 0.094 +- 0.279 (in-sample avg dev_std = 0.158)
NEC for r=0.2 all L1 = 0.071 +- 0.218 (in-sample avg dev_std = 0.158)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0301872
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.046 +- 0.294 (in-sample avg dev_std = 0.215)
NEC for r=0.4 class 1.0 = 0.094 +- 0.294 (in-sample avg dev_std = 0.215)
NEC for r=0.4 all KL = 0.105 +- 0.294 (in-sample avg dev_std = 0.215)
NEC for r=0.4 all L1 = 0.07 +- 0.208 (in-sample avg dev_std = 0.215)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.519
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0462344
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.499
NEC for r=0.8 class 0.0 = 0.042 +- 0.295 (in-sample avg dev_std = 0.212)
NEC for r=0.8 class 1.0 = 0.093 +- 0.295 (in-sample avg dev_std = 0.212)
NEC for r=0.8 all KL = 0.108 +- 0.295 (in-sample avg dev_std = 0.212)
NEC for r=0.8 all L1 = 0.067 +- 0.201 (in-sample avg dev_std = 0.212)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 13:25:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 01:25:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.001
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.004
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.014
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.051
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.001
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.006
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.020
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.058


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000876
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.544
SUFF_SIMPLE for r=0.05 class 0.0 = 0.912 +- 0.462 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.225 +- 0.462 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.05 all KL = 0.395 +- 0.462 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.05 all L1 = 0.531 +- 0.368 (in-sample avg dev_std = 0.502)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.00073
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.54
SUFF_SIMPLE for r=0.1 class 0.0 = 0.912 +- 0.464 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.22 +- 0.464 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.1 all KL = 0.398 +- 0.464 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.1 all L1 = 0.529 +- 0.370 (in-sample avg dev_std = 0.491)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.003902
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.541
SUFF_SIMPLE for r=0.2 class 0.0 = 0.916 +- 0.466 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.217 +- 0.466 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.2 all KL = 0.4 +- 0.466 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.2 all L1 = 0.528 +- 0.372 (in-sample avg dev_std = 0.489)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.014376
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.529
SUFF_SIMPLE for r=0.4 class 0.0 = 0.899 +- 0.458 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.209 +- 0.458 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.4 all KL = 0.384 +- 0.458 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.4 all L1 = 0.517 +- 0.368 (in-sample avg dev_std = 0.511)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.050894
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.527
SUFF_SIMPLE for r=0.8 class 0.0 = 0.937 +- 0.480 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.217 +- 0.480 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.8 all KL = 0.439 +- 0.480 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.8 all L1 = 0.537 +- 0.392 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.1 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.1 all L1 = 0.768 +- 0.355 (in-sample avg dev_std = 0.017)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.2 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.006)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.4 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.010)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.9e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006433999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.932 +- 0.323 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.873 +- 0.323 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all KL = 0.874 +- 0.323 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all L1 = 0.903 +- 0.254 (in-sample avg dev_std = 0.212)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001472
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.931 +- 0.322 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.874 +- 0.322 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 all KL = 0.875 +- 0.322 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 all L1 = 0.903 +- 0.253 (in-sample avg dev_std = 0.213)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.005711
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.93 +- 0.324 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.87 +- 0.324 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.2 all KL = 0.873 +- 0.324 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.2 all L1 = 0.9 +- 0.258 (in-sample avg dev_std = 0.204)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0203982
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.927 +- 0.324 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.868 +- 0.324 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all KL = 0.874 +- 0.324 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all L1 = 0.898 +- 0.264 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.518
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0577382
len(reference) = 4916
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.482
SUFF_SIMPLE for r=0.8 class 0.0 = 0.946 +- 0.299 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.877 +- 0.299 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all KL = 0.894 +- 0.299 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all L1 = 0.912 +- 0.252 (in-sample avg dev_std = 0.094)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000876
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.902
NEC for r=0.05 class 0.0 = 0.065 +- 0.325 (in-sample avg dev_std = 0.188)
NEC for r=0.05 class 1.0 = 0.198 +- 0.325 (in-sample avg dev_std = 0.188)
NEC for r=0.05 all KL = 0.186 +- 0.325 (in-sample avg dev_std = 0.188)
NEC for r=0.05 all L1 = 0.138 +- 0.247 (in-sample avg dev_std = 0.188)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.00073
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.908
NEC for r=0.1 class 0.0 = 0.06 +- 0.321 (in-sample avg dev_std = 0.194)
NEC for r=0.1 class 1.0 = 0.193 +- 0.321 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all KL = 0.183 +- 0.321 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all L1 = 0.134 +- 0.239 (in-sample avg dev_std = 0.194)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.003902
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.91
NEC for r=0.2 class 0.0 = 0.067 +- 0.328 (in-sample avg dev_std = 0.235)
NEC for r=0.2 class 1.0 = 0.2 +- 0.328 (in-sample avg dev_std = 0.235)
NEC for r=0.2 all KL = 0.201 +- 0.328 (in-sample avg dev_std = 0.235)
NEC for r=0.2 all L1 = 0.141 +- 0.239 (in-sample avg dev_std = 0.235)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.014376
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.899
NEC for r=0.4 class 0.0 = 0.07 +- 0.340 (in-sample avg dev_std = 0.281)
NEC for r=0.4 class 1.0 = 0.213 +- 0.340 (in-sample avg dev_std = 0.281)
NEC for r=0.4 all KL = 0.219 +- 0.340 (in-sample avg dev_std = 0.281)
NEC for r=0.4 all L1 = 0.149 +- 0.243 (in-sample avg dev_std = 0.281)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.050894
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.873
NEC for r=0.8 class 0.0 = 0.081 +- 0.392 (in-sample avg dev_std = 0.403)
NEC for r=0.8 class 1.0 = 0.274 +- 0.392 (in-sample avg dev_std = 0.403)
NEC for r=0.8 all KL = 0.316 +- 0.392 (in-sample avg dev_std = 0.403)
NEC for r=0.8 all L1 = 0.188 +- 0.254 (in-sample avg dev_std = 0.403)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.035)
NEC for r=0.05 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.035)
NEC for r=0.05 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.035)
NEC for r=0.05 all L1 = 0.232 +- 0.355 (in-sample avg dev_std = 0.035)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.034)
NEC for r=0.1 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.034)
NEC for r=0.1 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.034)
NEC for r=0.1 all L1 = 0.232 +- 0.355 (in-sample avg dev_std = 0.034)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.047)
NEC for r=0.2 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.047)
NEC for r=0.2 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.047)
NEC for r=0.2 all L1 = 0.232 +- 0.355 (in-sample avg dev_std = 0.047)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.067)
NEC for r=0.4 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.067)
NEC for r=0.4 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.067)
NEC for r=0.4 all L1 = 0.232 +- 0.355 (in-sample avg dev_std = 0.067)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.9e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.113)
NEC for r=0.8 class 1.0 = 0.442 +- 0.394 (in-sample avg dev_std = 0.113)
NEC for r=0.8 all KL = 0.244 +- 0.394 (in-sample avg dev_std = 0.113)
NEC for r=0.8 all L1 = 0.232 +- 0.354 (in-sample avg dev_std = 0.113)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006433999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.517
NEC for r=0.05 class 0.0 = 0.047 +- 0.238 (in-sample avg dev_std = 0.067)
NEC for r=0.05 class 1.0 = 0.066 +- 0.238 (in-sample avg dev_std = 0.067)
NEC for r=0.05 all KL = 0.068 +- 0.238 (in-sample avg dev_std = 0.067)
NEC for r=0.05 all L1 = 0.057 +- 0.200 (in-sample avg dev_std = 0.067)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001472
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.516
NEC for r=0.1 class 0.0 = 0.054 +- 0.254 (in-sample avg dev_std = 0.110)
NEC for r=0.1 class 1.0 = 0.072 +- 0.254 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all KL = 0.078 +- 0.254 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all L1 = 0.063 +- 0.209 (in-sample avg dev_std = 0.110)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.005711
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.507
NEC for r=0.2 class 0.0 = 0.056 +- 0.279 (in-sample avg dev_std = 0.140)
NEC for r=0.2 class 1.0 = 0.091 +- 0.279 (in-sample avg dev_std = 0.140)
NEC for r=0.2 all KL = 0.095 +- 0.279 (in-sample avg dev_std = 0.140)
NEC for r=0.2 all L1 = 0.073 +- 0.224 (in-sample avg dev_std = 0.140)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0203982
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.502
NEC for r=0.4 class 0.0 = 0.051 +- 0.291 (in-sample avg dev_std = 0.198)
NEC for r=0.4 class 1.0 = 0.096 +- 0.291 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all KL = 0.104 +- 0.291 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all L1 = 0.073 +- 0.216 (in-sample avg dev_std = 0.198)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.523
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0577382
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.497
NEC for r=0.8 class 0.0 = 0.047 +- 0.307 (in-sample avg dev_std = 0.223)
NEC for r=0.8 class 1.0 = 0.104 +- 0.307 (in-sample avg dev_std = 0.223)
NEC for r=0.8 all KL = 0.118 +- 0.307 (in-sample avg dev_std = 0.223)
NEC for r=0.8 all L1 = 0.075 +- 0.213 (in-sample avg dev_std = 0.223)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 13:39:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 01:39:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.015
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.025
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.021
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.032
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.048


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008884
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.937 +- 0.463 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.183 +- 0.463 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.05 all KL = 0.421 +- 0.463 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.05 all L1 = 0.519 +- 0.388 (in-sample avg dev_std = 0.405)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.015101999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.485
SUFF_SIMPLE for r=0.1 class 0.0 = 0.93 +- 0.458 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.177 +- 0.458 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.1 all KL = 0.414 +- 0.458 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.1 all L1 = 0.513 +- 0.387 (in-sample avg dev_std = 0.413)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.025342000000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.481
SUFF_SIMPLE for r=0.2 class 0.0 = 0.938 +- 0.464 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.173 +- 0.464 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.2 all KL = 0.421 +- 0.464 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.2 all L1 = 0.514 +- 0.392 (in-sample avg dev_std = 0.385)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03263
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.481
SUFF_SIMPLE for r=0.4 class 0.0 = 0.938 +- 0.464 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.173 +- 0.464 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 all KL = 0.42 +- 0.464 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 all L1 = 0.514 +- 0.392 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037082000000000004
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.457
SUFF_SIMPLE for r=0.8 class 0.0 = 0.956 +- 0.478 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.158 +- 0.478 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.8 all KL = 0.446 +- 0.478 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.8 all L1 = 0.512 +- 0.411 (in-sample avg dev_std = 0.165)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0027492000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.05 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.05 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.010)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031244
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.009)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.002121
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0011612
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005922
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089108
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.937 +- 0.302 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.898 +- 0.302 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.05 all KL = 0.891 +- 0.302 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.232 (in-sample avg dev_std = 0.208)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0136316
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.494
SUFF_SIMPLE for r=0.1 class 0.0 = 0.935 +- 0.301 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.898 +- 0.301 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 all KL = 0.892 +- 0.301 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.1 all L1 = 0.917 +- 0.234 (in-sample avg dev_std = 0.204)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0205622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.935 +- 0.301 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.898 +- 0.301 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all KL = 0.892 +- 0.301 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all L1 = 0.917 +- 0.235 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0319246
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.932 +- 0.302 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.894 +- 0.302 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.4 all KL = 0.892 +- 0.302 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.4 all L1 = 0.913 +- 0.242 (in-sample avg dev_std = 0.188)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.504
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047616399999999996
len(reference) = 4866
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.966 +- 0.247 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.913 +- 0.247 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.8 all KL = 0.93 +- 0.247 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.8 all L1 = 0.94 +- 0.212 (in-sample avg dev_std = 0.008)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008884
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.809
NEC for r=0.05 class 0.0 = 0.043 +- 0.367 (in-sample avg dev_std = 0.231)
NEC for r=0.05 class 1.0 = 0.354 +- 0.367 (in-sample avg dev_std = 0.231)
NEC for r=0.05 all KL = 0.28 +- 0.367 (in-sample avg dev_std = 0.231)
NEC for r=0.05 all L1 = 0.215 +- 0.297 (in-sample avg dev_std = 0.231)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.015101999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.819
NEC for r=0.1 class 0.0 = 0.043 +- 0.366 (in-sample avg dev_std = 0.267)
NEC for r=0.1 class 1.0 = 0.351 +- 0.366 (in-sample avg dev_std = 0.267)
NEC for r=0.1 all KL = 0.285 +- 0.366 (in-sample avg dev_std = 0.267)
NEC for r=0.1 all L1 = 0.213 +- 0.290 (in-sample avg dev_std = 0.267)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.025342000000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.805
NEC for r=0.2 class 0.0 = 0.053 +- 0.377 (in-sample avg dev_std = 0.321)
NEC for r=0.2 class 1.0 = 0.371 +- 0.377 (in-sample avg dev_std = 0.321)
NEC for r=0.2 all KL = 0.313 +- 0.377 (in-sample avg dev_std = 0.321)
NEC for r=0.2 all L1 = 0.229 +- 0.293 (in-sample avg dev_std = 0.321)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03263
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.81
NEC for r=0.4 class 0.0 = 0.053 +- 0.379 (in-sample avg dev_std = 0.334)
NEC for r=0.4 class 1.0 = 0.376 +- 0.379 (in-sample avg dev_std = 0.334)
NEC for r=0.4 all KL = 0.328 +- 0.379 (in-sample avg dev_std = 0.334)
NEC for r=0.4 all L1 = 0.232 +- 0.288 (in-sample avg dev_std = 0.334)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037082000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.805
NEC for r=0.8 class 0.0 = 0.06 +- 0.379 (in-sample avg dev_std = 0.351)
NEC for r=0.8 class 1.0 = 0.379 +- 0.379 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all KL = 0.336 +- 0.379 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all L1 = 0.237 +- 0.289 (in-sample avg dev_std = 0.351)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0027492000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.071)
NEC for r=0.05 class 1.0 = 0.628 +- 0.439 (in-sample avg dev_std = 0.071)
NEC for r=0.05 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.071)
NEC for r=0.05 all L1 = 0.342 +- 0.390 (in-sample avg dev_std = 0.071)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031244
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.069)
NEC for r=0.1 class 1.0 = 0.628 +- 0.439 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all L1 = 0.342 +- 0.390 (in-sample avg dev_std = 0.069)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.002121
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.069)
NEC for r=0.2 class 1.0 = 0.628 +- 0.439 (in-sample avg dev_std = 0.069)
NEC for r=0.2 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.069)
NEC for r=0.2 all L1 = 0.342 +- 0.390 (in-sample avg dev_std = 0.069)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0011612
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.072)
NEC for r=0.4 class 1.0 = 0.628 +- 0.439 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all L1 = 0.342 +- 0.390 (in-sample avg dev_std = 0.072)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005922
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
NEC for r=0.8 class 0.0 = 0.051 +- 0.439 (in-sample avg dev_std = 0.100)
NEC for r=0.8 class 1.0 = 0.627 +- 0.439 (in-sample avg dev_std = 0.100)
NEC for r=0.8 all KL = 0.361 +- 0.439 (in-sample avg dev_std = 0.100)
NEC for r=0.8 all L1 = 0.341 +- 0.389 (in-sample avg dev_std = 0.100)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089108
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.042 +- 0.230 (in-sample avg dev_std = 0.037)
NEC for r=0.05 class 1.0 = 0.065 +- 0.230 (in-sample avg dev_std = 0.037)
NEC for r=0.05 all KL = 0.063 +- 0.230 (in-sample avg dev_std = 0.037)
NEC for r=0.05 all L1 = 0.053 +- 0.195 (in-sample avg dev_std = 0.037)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0136316
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.05 +- 0.255 (in-sample avg dev_std = 0.111)
NEC for r=0.1 class 1.0 = 0.075 +- 0.255 (in-sample avg dev_std = 0.111)
NEC for r=0.1 all KL = 0.077 +- 0.255 (in-sample avg dev_std = 0.111)
NEC for r=0.1 all L1 = 0.062 +- 0.209 (in-sample avg dev_std = 0.111)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0205622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.495
NEC for r=0.2 class 0.0 = 0.05 +- 0.262 (in-sample avg dev_std = 0.148)
NEC for r=0.2 class 1.0 = 0.076 +- 0.262 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all KL = 0.082 +- 0.262 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all L1 = 0.063 +- 0.205 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0319246
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
NEC for r=0.4 class 0.0 = 0.043 +- 0.268 (in-sample avg dev_std = 0.195)
NEC for r=0.4 class 1.0 = 0.077 +- 0.268 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all KL = 0.088 +- 0.268 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all L1 = 0.06 +- 0.192 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047616399999999996
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.039 +- 0.269 (in-sample avg dev_std = 0.193)
NEC for r=0.8 class 1.0 = 0.075 +- 0.269 (in-sample avg dev_std = 0.193)
NEC for r=0.8 all KL = 0.09 +- 0.269 (in-sample avg dev_std = 0.193)
NEC for r=0.8 all L1 = 0.057 +- 0.184 (in-sample avg dev_std = 0.193)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 13:53:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 01:53:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.019
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.027
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.036
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.039
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.015
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.023
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.034
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.049


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.014102
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.489
SUFF_SIMPLE for r=0.05 class 0.0 = 0.96 +- 0.467 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.18 +- 0.467 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.05 all KL = 0.421 +- 0.467 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.05 all L1 = 0.528 +- 0.395 (in-sample avg dev_std = 0.416)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.018676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.49
SUFF_SIMPLE for r=0.1 class 0.0 = 0.964 +- 0.469 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.18 +- 0.469 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.1 all KL = 0.428 +- 0.469 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.1 all L1 = 0.53 +- 0.397 (in-sample avg dev_std = 0.420)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.027454
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.486
SUFF_SIMPLE for r=0.2 class 0.0 = 0.955 +- 0.463 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.18 +- 0.463 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.2 all KL = 0.416 +- 0.463 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.2 all L1 = 0.526 +- 0.394 (in-sample avg dev_std = 0.418)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03550199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF_SIMPLE for r=0.4 class 0.0 = 0.948 +- 0.466 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.181 +- 0.466 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.4 all KL = 0.411 +- 0.466 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.4 all L1 = 0.523 +- 0.392 (in-sample avg dev_std = 0.445)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038992000000000006
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.459
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.484 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.157 +- 0.484 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.8 all KL = 0.456 +- 0.484 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.8 all L1 = 0.526 +- 0.418 (in-sample avg dev_std = 0.192)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0024146000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030756
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021922
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012228000000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006318000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009438
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.938 +- 0.305 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.891 +- 0.305 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.05 all KL = 0.889 +- 0.305 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.05 all L1 = 0.915 +- 0.238 (in-sample avg dev_std = 0.203)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0147714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.938 +- 0.306 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.89 +- 0.306 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.1 all KL = 0.888 +- 0.306 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.239 (in-sample avg dev_std = 0.199)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023277600000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.493
SUFF_SIMPLE for r=0.2 class 0.0 = 0.937 +- 0.306 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.888 +- 0.306 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all KL = 0.888 +- 0.306 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all L1 = 0.913 +- 0.242 (in-sample avg dev_std = 0.200)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033895
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.308 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.887 +- 0.308 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all KL = 0.887 +- 0.308 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all L1 = 0.911 +- 0.245 (in-sample avg dev_std = 0.190)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.509
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0490016
len(reference) = 4866
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.477
SUFF_SIMPLE for r=0.8 class 0.0 = 0.967 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.903 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.927 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.936 +- 0.220 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.014102
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.793
NEC for r=0.05 class 0.0 = 0.02 +- 0.391 (in-sample avg dev_std = 0.255)
NEC for r=0.05 class 1.0 = 0.374 +- 0.391 (in-sample avg dev_std = 0.255)
NEC for r=0.05 all KL = 0.287 +- 0.391 (in-sample avg dev_std = 0.255)
NEC for r=0.05 all L1 = 0.216 +- 0.316 (in-sample avg dev_std = 0.255)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.018676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.798
NEC for r=0.1 class 0.0 = 0.019 +- 0.389 (in-sample avg dev_std = 0.287)
NEC for r=0.1 class 1.0 = 0.375 +- 0.389 (in-sample avg dev_std = 0.287)
NEC for r=0.1 all KL = 0.299 +- 0.389 (in-sample avg dev_std = 0.287)
NEC for r=0.1 all L1 = 0.216 +- 0.308 (in-sample avg dev_std = 0.287)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.027454
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.791
NEC for r=0.2 class 0.0 = 0.021 +- 0.407 (in-sample avg dev_std = 0.333)
NEC for r=0.2 class 1.0 = 0.396 +- 0.407 (in-sample avg dev_std = 0.333)
NEC for r=0.2 all KL = 0.331 +- 0.407 (in-sample avg dev_std = 0.333)
NEC for r=0.2 all L1 = 0.229 +- 0.308 (in-sample avg dev_std = 0.333)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03550199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.787
NEC for r=0.4 class 0.0 = 0.026 +- 0.403 (in-sample avg dev_std = 0.353)
NEC for r=0.4 class 1.0 = 0.398 +- 0.403 (in-sample avg dev_std = 0.353)
NEC for r=0.4 all KL = 0.347 +- 0.403 (in-sample avg dev_std = 0.353)
NEC for r=0.4 all L1 = 0.232 +- 0.305 (in-sample avg dev_std = 0.353)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038992000000000006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.783
NEC for r=0.8 class 0.0 = 0.036 +- 0.405 (in-sample avg dev_std = 0.397)
NEC for r=0.8 class 1.0 = 0.412 +- 0.405 (in-sample avg dev_std = 0.397)
NEC for r=0.8 all KL = 0.383 +- 0.405 (in-sample avg dev_std = 0.397)
NEC for r=0.8 all L1 = 0.244 +- 0.299 (in-sample avg dev_std = 0.397)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0024146000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.048)
NEC for r=0.05 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.048)
NEC for r=0.05 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.048)
NEC for r=0.05 all L1 = 0.133 +- 0.282 (in-sample avg dev_std = 0.048)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030756
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.052)
NEC for r=0.1 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.052)
NEC for r=0.1 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.052)
NEC for r=0.1 all L1 = 0.133 +- 0.282 (in-sample avg dev_std = 0.052)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021922
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.047)
NEC for r=0.2 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.047)
NEC for r=0.2 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.047)
NEC for r=0.2 all L1 = 0.133 +- 0.282 (in-sample avg dev_std = 0.047)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012228000000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.046)
NEC for r=0.4 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.046)
NEC for r=0.4 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.046)
NEC for r=0.4 all L1 = 0.133 +- 0.282 (in-sample avg dev_std = 0.046)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006318000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.074)
NEC for r=0.8 class 1.0 = 0.26 +- 0.301 (in-sample avg dev_std = 0.074)
NEC for r=0.8 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.074)
NEC for r=0.8 all L1 = 0.133 +- 0.281 (in-sample avg dev_std = 0.074)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009438
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.503
NEC for r=0.05 class 0.0 = 0.041 +- 0.231 (in-sample avg dev_std = 0.045)
NEC for r=0.05 class 1.0 = 0.068 +- 0.231 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all KL = 0.063 +- 0.231 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all L1 = 0.054 +- 0.197 (in-sample avg dev_std = 0.045)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0147714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.499
NEC for r=0.1 class 0.0 = 0.049 +- 0.255 (in-sample avg dev_std = 0.106)
NEC for r=0.1 class 1.0 = 0.079 +- 0.255 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all KL = 0.077 +- 0.255 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all L1 = 0.064 +- 0.213 (in-sample avg dev_std = 0.106)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023277600000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.495
NEC for r=0.2 class 0.0 = 0.048 +- 0.266 (in-sample avg dev_std = 0.149)
NEC for r=0.2 class 1.0 = 0.084 +- 0.266 (in-sample avg dev_std = 0.149)
NEC for r=0.2 all KL = 0.084 +- 0.266 (in-sample avg dev_std = 0.149)
NEC for r=0.2 all L1 = 0.066 +- 0.211 (in-sample avg dev_std = 0.149)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033895
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.042 +- 0.273 (in-sample avg dev_std = 0.197)
NEC for r=0.4 class 1.0 = 0.084 +- 0.273 (in-sample avg dev_std = 0.197)
NEC for r=0.4 all KL = 0.09 +- 0.273 (in-sample avg dev_std = 0.197)
NEC for r=0.4 all L1 = 0.063 +- 0.198 (in-sample avg dev_std = 0.197)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0490016
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.499
NEC for r=0.8 class 0.0 = 0.038 +- 0.277 (in-sample avg dev_std = 0.199)
NEC for r=0.8 class 1.0 = 0.084 +- 0.277 (in-sample avg dev_std = 0.199)
NEC for r=0.8 all KL = 0.095 +- 0.277 (in-sample avg dev_std = 0.199)
NEC for r=0.8 all L1 = 0.061 +- 0.192 (in-sample avg dev_std = 0.199)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 14:07:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 02:07:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.028
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.034
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.021
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.032
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008905999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.484
SUFF_SIMPLE for r=0.05 class 0.0 = 0.955 +- 0.467 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.177 +- 0.467 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.05 all KL = 0.409 +- 0.467 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.05 all L1 = 0.524 +- 0.395 (in-sample avg dev_std = 0.409)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014178000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.485
SUFF_SIMPLE for r=0.1 class 0.0 = 0.949 +- 0.466 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.181 +- 0.466 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.1 all KL = 0.404 +- 0.466 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.1 all L1 = 0.524 +- 0.393 (in-sample avg dev_std = 0.423)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02224
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.49
SUFF_SIMPLE for r=0.2 class 0.0 = 0.963 +- 0.472 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.179 +- 0.472 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.2 all KL = 0.421 +- 0.472 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.2 all L1 = 0.528 +- 0.397 (in-sample avg dev_std = 0.421)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028222
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.48
SUFF_SIMPLE for r=0.4 class 0.0 = 0.946 +- 0.464 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.174 +- 0.464 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.4 all KL = 0.401 +- 0.464 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.4 all L1 = 0.518 +- 0.393 (in-sample avg dev_std = 0.429)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034212000000000006
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.461
SUFF_SIMPLE for r=0.8 class 0.0 = 0.989 +- 0.486 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.163 +- 0.486 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.8 all KL = 0.459 +- 0.486 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.8 all L1 = 0.53 +- 0.420 (in-sample avg dev_std = 0.154)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023972
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.05 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.05 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.009)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029088
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019487999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.2 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.2 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.012)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010424
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.4 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.4 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.011)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005308
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.007886
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.94 +- 0.307 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.891 +- 0.307 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all KL = 0.888 +- 0.307 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all L1 = 0.916 +- 0.237 (in-sample avg dev_std = 0.212)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012444799999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.94 +- 0.307 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.892 +- 0.307 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.1 all KL = 0.888 +- 0.307 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.237 (in-sample avg dev_std = 0.201)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020794
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.939 +- 0.306 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.89 +- 0.306 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all KL = 0.889 +- 0.306 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all L1 = 0.915 +- 0.240 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031668
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.937 +- 0.304 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.304 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.891 +- 0.304 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.244 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0472654
len(reference) = 4867
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.972 +- 0.242 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.912 +- 0.242 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.242 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.209 (in-sample avg dev_std = 0.015)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008905999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.8
NEC for r=0.05 class 0.0 = 0.027 +- 0.393 (in-sample avg dev_std = 0.254)
NEC for r=0.05 class 1.0 = 0.361 +- 0.393 (in-sample avg dev_std = 0.254)
NEC for r=0.05 all KL = 0.295 +- 0.393 (in-sample avg dev_std = 0.254)
NEC for r=0.05 all L1 = 0.212 +- 0.313 (in-sample avg dev_std = 0.254)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014178000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.805
NEC for r=0.1 class 0.0 = 0.029 +- 0.398 (in-sample avg dev_std = 0.305)
NEC for r=0.1 class 1.0 = 0.365 +- 0.398 (in-sample avg dev_std = 0.305)
NEC for r=0.1 all KL = 0.308 +- 0.398 (in-sample avg dev_std = 0.305)
NEC for r=0.1 all L1 = 0.215 +- 0.307 (in-sample avg dev_std = 0.305)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02224
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.8
NEC for r=0.2 class 0.0 = 0.031 +- 0.406 (in-sample avg dev_std = 0.354)
NEC for r=0.2 class 1.0 = 0.383 +- 0.406 (in-sample avg dev_std = 0.354)
NEC for r=0.2 all KL = 0.344 +- 0.406 (in-sample avg dev_std = 0.354)
NEC for r=0.2 all L1 = 0.226 +- 0.303 (in-sample avg dev_std = 0.354)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028222
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.788
NEC for r=0.4 class 0.0 = 0.033 +- 0.409 (in-sample avg dev_std = 0.353)
NEC for r=0.4 class 1.0 = 0.395 +- 0.409 (in-sample avg dev_std = 0.353)
NEC for r=0.4 all KL = 0.353 +- 0.409 (in-sample avg dev_std = 0.353)
NEC for r=0.4 all L1 = 0.234 +- 0.310 (in-sample avg dev_std = 0.353)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034212000000000006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.791
NEC for r=0.8 class 0.0 = 0.035 +- 0.409 (in-sample avg dev_std = 0.364)
NEC for r=0.8 class 1.0 = 0.388 +- 0.409 (in-sample avg dev_std = 0.364)
NEC for r=0.8 all KL = 0.355 +- 0.409 (in-sample avg dev_std = 0.364)
NEC for r=0.8 all L1 = 0.23 +- 0.304 (in-sample avg dev_std = 0.364)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023972
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.5
NEC for r=0.05 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.088)
NEC for r=0.05 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.088)
NEC for r=0.05 all KL = 0.281 +- 0.414 (in-sample avg dev_std = 0.088)
NEC for r=0.05 all L1 = 0.266 +- 0.369 (in-sample avg dev_std = 0.088)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029088
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.499
NEC for r=0.1 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.092)
NEC for r=0.1 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.092)
NEC for r=0.1 all KL = 0.281 +- 0.414 (in-sample avg dev_std = 0.092)
NEC for r=0.1 all L1 = 0.266 +- 0.370 (in-sample avg dev_std = 0.092)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019487999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.082)
NEC for r=0.2 class 1.0 = 0.508 +- 0.414 (in-sample avg dev_std = 0.082)
NEC for r=0.2 all KL = 0.281 +- 0.414 (in-sample avg dev_std = 0.082)
NEC for r=0.2 all L1 = 0.266 +- 0.370 (in-sample avg dev_std = 0.082)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010424
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.088)
NEC for r=0.4 class 1.0 = 0.508 +- 0.414 (in-sample avg dev_std = 0.088)
NEC for r=0.4 all KL = 0.281 +- 0.414 (in-sample avg dev_std = 0.088)
NEC for r=0.4 all L1 = 0.267 +- 0.370 (in-sample avg dev_std = 0.088)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005308
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.022 +- 0.413 (in-sample avg dev_std = 0.125)
NEC for r=0.8 class 1.0 = 0.509 +- 0.413 (in-sample avg dev_std = 0.125)
NEC for r=0.8 all KL = 0.284 +- 0.413 (in-sample avg dev_std = 0.125)
NEC for r=0.8 all L1 = 0.267 +- 0.369 (in-sample avg dev_std = 0.125)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.007886
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.04 +- 0.235 (in-sample avg dev_std = 0.042)
NEC for r=0.05 class 1.0 = 0.071 +- 0.235 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all KL = 0.065 +- 0.235 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all L1 = 0.055 +- 0.201 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012444799999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.503
NEC for r=0.1 class 0.0 = 0.048 +- 0.258 (in-sample avg dev_std = 0.101)
NEC for r=0.1 class 1.0 = 0.08 +- 0.258 (in-sample avg dev_std = 0.101)
NEC for r=0.1 all KL = 0.078 +- 0.258 (in-sample avg dev_std = 0.101)
NEC for r=0.1 all L1 = 0.064 +- 0.214 (in-sample avg dev_std = 0.101)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020794
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.5
NEC for r=0.2 class 0.0 = 0.047 +- 0.274 (in-sample avg dev_std = 0.156)
NEC for r=0.2 class 1.0 = 0.089 +- 0.274 (in-sample avg dev_std = 0.156)
NEC for r=0.2 all KL = 0.089 +- 0.274 (in-sample avg dev_std = 0.156)
NEC for r=0.2 all L1 = 0.068 +- 0.216 (in-sample avg dev_std = 0.156)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031668
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.044 +- 0.287 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 1.0 = 0.09 +- 0.287 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all KL = 0.1 +- 0.287 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all L1 = 0.066 +- 0.204 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.516
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0472654
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.038 +- 0.283 (in-sample avg dev_std = 0.201)
NEC for r=0.8 class 1.0 = 0.083 +- 0.283 (in-sample avg dev_std = 0.201)
NEC for r=0.8 all KL = 0.099 +- 0.283 (in-sample avg dev_std = 0.201)
NEC for r=0.8 all L1 = 0.06 +- 0.192 (in-sample avg dev_std = 0.201)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 14:21:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 02:21:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.023
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.032
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.020
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008893999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.512
SUFF_SIMPLE for r=0.05 class 0.0 = 0.907 +- 0.456 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.199 +- 0.456 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all KL = 0.413 +- 0.456 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all L1 = 0.515 +- 0.371 (in-sample avg dev_std = 0.440)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013969999999999998
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.505
SUFF_SIMPLE for r=0.1 class 0.0 = 0.903 +- 0.455 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.196 +- 0.455 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.1 all KL = 0.407 +- 0.455 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.1 all L1 = 0.511 +- 0.372 (in-sample avg dev_std = 0.429)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023264
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.503
SUFF_SIMPLE for r=0.2 class 0.0 = 0.905 +- 0.456 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.196 +- 0.456 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.2 all KL = 0.41 +- 0.456 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.2 all L1 = 0.512 +- 0.373 (in-sample avg dev_std = 0.420)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032402
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.505
SUFF_SIMPLE for r=0.4 class 0.0 = 0.905 +- 0.457 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.193 +- 0.457 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.4 all KL = 0.409 +- 0.457 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.4 all L1 = 0.511 +- 0.374 (in-sample avg dev_std = 0.426)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036660000000000005
len(reference) = 497
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.465
SUFF_SIMPLE for r=0.8 class 0.0 = 0.932 +- 0.473 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.16 +- 0.473 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.8 all KL = 0.439 +- 0.473 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.8 all L1 = 0.503 +- 0.402 (in-sample avg dev_std = 0.210)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026088
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030811999999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020392
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010912
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.4 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.001)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.000558
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080208
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.495
SUFF_SIMPLE for r=0.05 class 0.0 = 0.935 +- 0.310 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.883 +- 0.310 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.310 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.05 all L1 = 0.909 +- 0.242 (in-sample avg dev_std = 0.209)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122058
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.494
SUFF_SIMPLE for r=0.1 class 0.0 = 0.934 +- 0.309 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.883 +- 0.309 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.1 all KL = 0.881 +- 0.309 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.1 all L1 = 0.909 +- 0.243 (in-sample avg dev_std = 0.207)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019941000000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.495
SUFF_SIMPLE for r=0.2 class 0.0 = 0.933 +- 0.309 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.882 +- 0.309 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all KL = 0.882 +- 0.309 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all L1 = 0.908 +- 0.245 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0306124
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.494
SUFF_SIMPLE for r=0.4 class 0.0 = 0.93 +- 0.311 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.879 +- 0.311 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 all KL = 0.882 +- 0.311 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 all L1 = 0.905 +- 0.251 (in-sample avg dev_std = 0.187)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.51
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0471452
len(reference) = 4871
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.478
SUFF_SIMPLE for r=0.8 class 0.0 = 0.962 +- 0.260 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.897 +- 0.260 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all KL = 0.92 +- 0.260 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.8 all L1 = 0.93 +- 0.226 (in-sample avg dev_std = 0.013)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008893999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.868
NEC for r=0.05 class 0.0 = 0.069 +- 0.318 (in-sample avg dev_std = 0.225)
NEC for r=0.05 class 1.0 = 0.286 +- 0.318 (in-sample avg dev_std = 0.225)
NEC for r=0.05 all KL = 0.224 +- 0.318 (in-sample avg dev_std = 0.225)
NEC for r=0.05 all L1 = 0.189 +- 0.265 (in-sample avg dev_std = 0.225)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013969999999999998
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.871
NEC for r=0.1 class 0.0 = 0.066 +- 0.320 (in-sample avg dev_std = 0.247)
NEC for r=0.1 class 1.0 = 0.286 +- 0.320 (in-sample avg dev_std = 0.247)
NEC for r=0.1 all KL = 0.231 +- 0.320 (in-sample avg dev_std = 0.247)
NEC for r=0.1 all L1 = 0.188 +- 0.260 (in-sample avg dev_std = 0.247)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023264
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.863
NEC for r=0.2 class 0.0 = 0.075 +- 0.332 (in-sample avg dev_std = 0.294)
NEC for r=0.2 class 1.0 = 0.298 +- 0.332 (in-sample avg dev_std = 0.294)
NEC for r=0.2 all KL = 0.255 +- 0.332 (in-sample avg dev_std = 0.294)
NEC for r=0.2 all L1 = 0.199 +- 0.261 (in-sample avg dev_std = 0.294)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032402
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.863
NEC for r=0.4 class 0.0 = 0.081 +- 0.330 (in-sample avg dev_std = 0.307)
NEC for r=0.4 class 1.0 = 0.298 +- 0.330 (in-sample avg dev_std = 0.307)
NEC for r=0.4 all KL = 0.265 +- 0.330 (in-sample avg dev_std = 0.307)
NEC for r=0.4 all L1 = 0.201 +- 0.257 (in-sample avg dev_std = 0.307)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036660000000000005
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.863
NEC for r=0.8 class 0.0 = 0.084 +- 0.331 (in-sample avg dev_std = 0.339)
NEC for r=0.8 class 1.0 = 0.307 +- 0.331 (in-sample avg dev_std = 0.339)
NEC for r=0.8 all KL = 0.275 +- 0.331 (in-sample avg dev_std = 0.339)
NEC for r=0.8 all L1 = 0.207 +- 0.256 (in-sample avg dev_std = 0.339)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026088
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.012 +- 0.362 (in-sample avg dev_std = 0.070)
NEC for r=0.05 class 1.0 = 0.416 +- 0.362 (in-sample avg dev_std = 0.070)
NEC for r=0.05 all KL = 0.215 +- 0.362 (in-sample avg dev_std = 0.070)
NEC for r=0.05 all L1 = 0.215 +- 0.334 (in-sample avg dev_std = 0.070)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030811999999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.499
NEC for r=0.1 class 0.0 = 0.012 +- 0.362 (in-sample avg dev_std = 0.078)
NEC for r=0.1 class 1.0 = 0.416 +- 0.362 (in-sample avg dev_std = 0.078)
NEC for r=0.1 all KL = 0.214 +- 0.362 (in-sample avg dev_std = 0.078)
NEC for r=0.1 all L1 = 0.215 +- 0.334 (in-sample avg dev_std = 0.078)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020392
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.061)
NEC for r=0.2 class 1.0 = 0.416 +- 0.363 (in-sample avg dev_std = 0.061)
NEC for r=0.2 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.061)
NEC for r=0.2 all L1 = 0.216 +- 0.335 (in-sample avg dev_std = 0.061)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010912
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.068)
NEC for r=0.4 class 1.0 = 0.416 +- 0.363 (in-sample avg dev_std = 0.068)
NEC for r=0.4 all KL = 0.215 +- 0.363 (in-sample avg dev_std = 0.068)
NEC for r=0.4 all L1 = 0.216 +- 0.335 (in-sample avg dev_std = 0.068)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.000558
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.012 +- 0.362 (in-sample avg dev_std = 0.097)
NEC for r=0.8 class 1.0 = 0.416 +- 0.362 (in-sample avg dev_std = 0.097)
NEC for r=0.8 all KL = 0.215 +- 0.362 (in-sample avg dev_std = 0.097)
NEC for r=0.8 all L1 = 0.216 +- 0.334 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080208
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.509
NEC for r=0.05 class 0.0 = 0.044 +- 0.235 (in-sample avg dev_std = 0.045)
NEC for r=0.05 class 1.0 = 0.075 +- 0.235 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all KL = 0.069 +- 0.235 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all L1 = 0.06 +- 0.202 (in-sample avg dev_std = 0.045)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122058
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.505
NEC for r=0.1 class 0.0 = 0.053 +- 0.262 (in-sample avg dev_std = 0.117)
NEC for r=0.1 class 1.0 = 0.087 +- 0.262 (in-sample avg dev_std = 0.117)
NEC for r=0.1 all KL = 0.086 +- 0.262 (in-sample avg dev_std = 0.117)
NEC for r=0.1 all L1 = 0.07 +- 0.217 (in-sample avg dev_std = 0.117)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019941000000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.501
NEC for r=0.2 class 0.0 = 0.053 +- 0.270 (in-sample avg dev_std = 0.157)
NEC for r=0.2 class 1.0 = 0.089 +- 0.270 (in-sample avg dev_std = 0.157)
NEC for r=0.2 all KL = 0.091 +- 0.270 (in-sample avg dev_std = 0.157)
NEC for r=0.2 all L1 = 0.071 +- 0.216 (in-sample avg dev_std = 0.157)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0306124
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.499
NEC for r=0.4 class 0.0 = 0.048 +- 0.285 (in-sample avg dev_std = 0.210)
NEC for r=0.4 class 1.0 = 0.095 +- 0.285 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all KL = 0.104 +- 0.285 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all L1 = 0.071 +- 0.207 (in-sample avg dev_std = 0.210)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.517
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0471452
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.499
NEC for r=0.8 class 0.0 = 0.046 +- 0.288 (in-sample avg dev_std = 0.217)
NEC for r=0.8 class 1.0 = 0.094 +- 0.288 (in-sample avg dev_std = 0.217)
NEC for r=0.8 all KL = 0.109 +- 0.288 (in-sample avg dev_std = 0.217)
NEC for r=0.8 all L1 = 0.069 +- 0.200 (in-sample avg dev_std = 0.217)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 14:36:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 02:36:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.015
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.048


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009027999999999998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.485
SUFF_SIMPLE for r=0.05 class 0.0 = 0.91 +- 0.457 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.18 +- 0.457 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.05 all KL = 0.393 +- 0.457 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.05 all L1 = 0.506 +- 0.383 (in-sample avg dev_std = 0.418)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013548
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.489
SUFF_SIMPLE for r=0.1 class 0.0 = 0.913 +- 0.460 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.181 +- 0.460 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 all KL = 0.397 +- 0.460 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 all L1 = 0.508 +- 0.384 (in-sample avg dev_std = 0.424)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022242
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.486
SUFF_SIMPLE for r=0.2 class 0.0 = 0.913 +- 0.460 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.179 +- 0.460 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.2 all KL = 0.399 +- 0.460 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.2 all L1 = 0.506 +- 0.385 (in-sample avg dev_std = 0.415)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03269799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.483
SUFF_SIMPLE for r=0.4 class 0.0 = 0.899 +- 0.451 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.179 +- 0.451 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all KL = 0.382 +- 0.451 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all L1 = 0.501 +- 0.380 (in-sample avg dev_std = 0.428)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036764
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.457
SUFF_SIMPLE for r=0.8 class 0.0 = 0.944 +- 0.478 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.152 +- 0.478 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.8 all KL = 0.435 +- 0.478 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.8 all L1 = 0.504 +- 0.409 (in-sample avg dev_std = 0.207)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026286
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.05 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.05 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.022)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.003198
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.1 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021996000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.2 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.018)
SUFF_SIMPLE for r=0.2 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.018)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.4 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.4 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.024)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006226000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0096708
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.938 +- 0.298 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.901 +- 0.298 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.05 all KL = 0.895 +- 0.298 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.05 all L1 = 0.919 +- 0.232 (in-sample avg dev_std = 0.197)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014605399999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.938 +- 0.298 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.9 +- 0.298 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.1 all KL = 0.895 +- 0.298 (in-sample avg dev_std = 0.198)
SUFF_SIMPLE for r=0.1 all L1 = 0.919 +- 0.233 (in-sample avg dev_std = 0.198)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022450599999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.937 +- 0.298 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.899 +- 0.298 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.2 all KL = 0.895 +- 0.298 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.236 (in-sample avg dev_std = 0.190)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032692200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.935 +- 0.297 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.897 +- 0.297 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 all KL = 0.896 +- 0.297 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 all L1 = 0.916 +- 0.240 (in-sample avg dev_std = 0.175)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.504
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.048445
len(reference) = 4880
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.244 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.914 +- 0.244 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.932 +- 0.244 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.209 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009027999999999998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.809
NEC for r=0.05 class 0.0 = 0.059 +- 0.387 (in-sample avg dev_std = 0.217)
NEC for r=0.05 class 1.0 = 0.33 +- 0.387 (in-sample avg dev_std = 0.217)
NEC for r=0.05 all KL = 0.27 +- 0.387 (in-sample avg dev_std = 0.217)
NEC for r=0.05 all L1 = 0.209 +- 0.317 (in-sample avg dev_std = 0.217)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013548
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.812
NEC for r=0.1 class 0.0 = 0.065 +- 0.389 (in-sample avg dev_std = 0.251)
NEC for r=0.1 class 1.0 = 0.332 +- 0.389 (in-sample avg dev_std = 0.251)
NEC for r=0.1 all KL = 0.286 +- 0.389 (in-sample avg dev_std = 0.251)
NEC for r=0.1 all L1 = 0.213 +- 0.312 (in-sample avg dev_std = 0.251)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022242
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.799
NEC for r=0.2 class 0.0 = 0.075 +- 0.405 (in-sample avg dev_std = 0.319)
NEC for r=0.2 class 1.0 = 0.357 +- 0.405 (in-sample avg dev_std = 0.319)
NEC for r=0.2 all KL = 0.325 +- 0.405 (in-sample avg dev_std = 0.319)
NEC for r=0.2 all L1 = 0.231 +- 0.313 (in-sample avg dev_std = 0.319)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03269799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.802
NEC for r=0.4 class 0.0 = 0.071 +- 0.406 (in-sample avg dev_std = 0.334)
NEC for r=0.4 class 1.0 = 0.362 +- 0.406 (in-sample avg dev_std = 0.334)
NEC for r=0.4 all KL = 0.333 +- 0.406 (in-sample avg dev_std = 0.334)
NEC for r=0.4 all L1 = 0.232 +- 0.310 (in-sample avg dev_std = 0.334)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036764
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.809
NEC for r=0.8 class 0.0 = 0.07 +- 0.402 (in-sample avg dev_std = 0.336)
NEC for r=0.8 class 1.0 = 0.353 +- 0.402 (in-sample avg dev_std = 0.336)
NEC for r=0.8 all KL = 0.333 +- 0.402 (in-sample avg dev_std = 0.336)
NEC for r=0.8 all L1 = 0.227 +- 0.305 (in-sample avg dev_std = 0.336)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026286
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.502
NEC for r=0.05 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.125)
NEC for r=0.05 class 1.0 = 0.843 +- 0.441 (in-sample avg dev_std = 0.125)
NEC for r=0.05 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.125)
NEC for r=0.05 all L1 = 0.59 +- 0.372 (in-sample avg dev_std = 0.125)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.003198
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.332 +- 0.441 (in-sample avg dev_std = 0.124)
NEC for r=0.1 class 1.0 = 0.844 +- 0.441 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all KL = 0.655 +- 0.441 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all L1 = 0.59 +- 0.372 (in-sample avg dev_std = 0.124)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021996000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.499
NEC for r=0.2 class 0.0 = 0.332 +- 0.441 (in-sample avg dev_std = 0.111)
NEC for r=0.2 class 1.0 = 0.846 +- 0.441 (in-sample avg dev_std = 0.111)
NEC for r=0.2 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.111)
NEC for r=0.2 all L1 = 0.591 +- 0.372 (in-sample avg dev_std = 0.111)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.5
NEC for r=0.4 class 0.0 = 0.332 +- 0.441 (in-sample avg dev_std = 0.121)
NEC for r=0.4 class 1.0 = 0.845 +- 0.441 (in-sample avg dev_std = 0.121)
NEC for r=0.4 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.121)
NEC for r=0.4 all L1 = 0.591 +- 0.372 (in-sample avg dev_std = 0.121)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006226000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.503
NEC for r=0.8 class 0.0 = 0.332 +- 0.441 (in-sample avg dev_std = 0.163)
NEC for r=0.8 class 1.0 = 0.843 +- 0.441 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.163)
NEC for r=0.8 all L1 = 0.59 +- 0.371 (in-sample avg dev_std = 0.163)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0096708
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.041 +- 0.226 (in-sample avg dev_std = 0.039)
NEC for r=0.05 class 1.0 = 0.062 +- 0.226 (in-sample avg dev_std = 0.039)
NEC for r=0.05 all KL = 0.06 +- 0.226 (in-sample avg dev_std = 0.039)
NEC for r=0.05 all L1 = 0.051 +- 0.192 (in-sample avg dev_std = 0.039)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014605399999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.5
NEC for r=0.1 class 0.0 = 0.05 +- 0.250 (in-sample avg dev_std = 0.104)
NEC for r=0.1 class 1.0 = 0.072 +- 0.250 (in-sample avg dev_std = 0.104)
NEC for r=0.1 all KL = 0.073 +- 0.250 (in-sample avg dev_std = 0.104)
NEC for r=0.1 all L1 = 0.061 +- 0.208 (in-sample avg dev_std = 0.104)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022450599999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.048 +- 0.257 (in-sample avg dev_std = 0.147)
NEC for r=0.2 class 1.0 = 0.074 +- 0.257 (in-sample avg dev_std = 0.147)
NEC for r=0.2 all KL = 0.079 +- 0.257 (in-sample avg dev_std = 0.147)
NEC for r=0.2 all L1 = 0.061 +- 0.204 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032692200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.043 +- 0.271 (in-sample avg dev_std = 0.195)
NEC for r=0.4 class 1.0 = 0.077 +- 0.271 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all KL = 0.089 +- 0.271 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all L1 = 0.06 +- 0.194 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.048445
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.497
NEC for r=0.8 class 0.0 = 0.039 +- 0.275 (in-sample avg dev_std = 0.204)
NEC for r=0.8 class 1.0 = 0.077 +- 0.275 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all KL = 0.093 +- 0.275 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all L1 = 0.058 +- 0.186 (in-sample avg dev_std = 0.204)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 14:50:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 02:50:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.024
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.038
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.020
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008289999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.514
SUFF_SIMPLE for r=0.05 class 0.0 = 0.937 +- 0.468 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.198 +- 0.468 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.05 all KL = 0.41 +- 0.468 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.05 all L1 = 0.527 +- 0.383 (in-sample avg dev_std = 0.453)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014301999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.518
SUFF_SIMPLE for r=0.1 class 0.0 = 0.937 +- 0.470 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.199 +- 0.470 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.1 all KL = 0.411 +- 0.470 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.1 all L1 = 0.528 +- 0.382 (in-sample avg dev_std = 0.476)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.508
SUFF_SIMPLE for r=0.2 class 0.0 = 0.928 +- 0.465 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.194 +- 0.465 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.2 all KL = 0.399 +- 0.465 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.381 (in-sample avg dev_std = 0.457)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03254
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.511
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.468 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.191 +- 0.468 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.4 all KL = 0.406 +- 0.468 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.384 (in-sample avg dev_std = 0.460)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037756
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.466
SUFF_SIMPLE for r=0.8 class 0.0 = 0.961 +- 0.484 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.16 +- 0.484 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 all KL = 0.443 +- 0.484 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 all L1 = 0.516 +- 0.412 (in-sample avg dev_std = 0.209)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.002432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029664
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020628
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.005)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010995999999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005606
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081184
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.494
SUFF_SIMPLE for r=0.05 class 0.0 = 0.934 +- 0.325 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.871 +- 0.325 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all KL = 0.872 +- 0.325 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all L1 = 0.902 +- 0.255 (in-sample avg dev_std = 0.213)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122244
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.494
SUFF_SIMPLE for r=0.1 class 0.0 = 0.934 +- 0.325 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.87 +- 0.325 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all KL = 0.873 +- 0.325 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all L1 = 0.902 +- 0.256 (in-sample avg dev_std = 0.209)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019827800000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.933 +- 0.325 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.869 +- 0.325 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 all KL = 0.873 +- 0.325 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.2 all L1 = 0.901 +- 0.258 (in-sample avg dev_std = 0.201)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.030766400000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.93 +- 0.324 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.867 +- 0.324 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 all KL = 0.874 +- 0.324 (in-sample avg dev_std = 0.187)
SUFF_SIMPLE for r=0.4 all L1 = 0.899 +- 0.263 (in-sample avg dev_std = 0.187)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.518
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0468454
len(reference) = 4870
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.479
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.893 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.918 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.929 +- 0.231 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008289999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.869
NEC for r=0.05 class 0.0 = 0.044 +- 0.359 (in-sample avg dev_std = 0.232)
NEC for r=0.05 class 1.0 = 0.269 +- 0.359 (in-sample avg dev_std = 0.232)
NEC for r=0.05 all KL = 0.229 +- 0.359 (in-sample avg dev_std = 0.232)
NEC for r=0.05 all L1 = 0.169 +- 0.276 (in-sample avg dev_std = 0.232)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014301999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.856
NEC for r=0.1 class 0.0 = 0.048 +- 0.372 (in-sample avg dev_std = 0.284)
NEC for r=0.1 class 1.0 = 0.282 +- 0.372 (in-sample avg dev_std = 0.284)
NEC for r=0.1 all KL = 0.253 +- 0.372 (in-sample avg dev_std = 0.284)
NEC for r=0.1 all L1 = 0.178 +- 0.276 (in-sample avg dev_std = 0.284)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.842
NEC for r=0.2 class 0.0 = 0.059 +- 0.393 (in-sample avg dev_std = 0.354)
NEC for r=0.2 class 1.0 = 0.31 +- 0.393 (in-sample avg dev_std = 0.354)
NEC for r=0.2 all KL = 0.298 +- 0.393 (in-sample avg dev_std = 0.354)
NEC for r=0.2 all L1 = 0.198 +- 0.279 (in-sample avg dev_std = 0.354)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03254
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.854
NEC for r=0.4 class 0.0 = 0.048 +- 0.391 (in-sample avg dev_std = 0.348)
NEC for r=0.4 class 1.0 = 0.303 +- 0.391 (in-sample avg dev_std = 0.348)
NEC for r=0.4 all KL = 0.292 +- 0.391 (in-sample avg dev_std = 0.348)
NEC for r=0.4 all L1 = 0.189 +- 0.272 (in-sample avg dev_std = 0.348)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037756
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.845
NEC for r=0.8 class 0.0 = 0.066 +- 0.399 (in-sample avg dev_std = 0.380)
NEC for r=0.8 class 1.0 = 0.314 +- 0.399 (in-sample avg dev_std = 0.380)
NEC for r=0.8 all KL = 0.331 +- 0.399 (in-sample avg dev_std = 0.380)
NEC for r=0.8 all L1 = 0.204 +- 0.269 (in-sample avg dev_std = 0.380)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.002432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.002 +- 0.239 (in-sample avg dev_std = 0.046)
NEC for r=0.05 class 1.0 = 0.162 +- 0.239 (in-sample avg dev_std = 0.046)
NEC for r=0.05 all KL = 0.081 +- 0.239 (in-sample avg dev_std = 0.046)
NEC for r=0.05 all L1 = 0.083 +- 0.227 (in-sample avg dev_std = 0.046)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029664
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.002 +- 0.239 (in-sample avg dev_std = 0.048)
NEC for r=0.1 class 1.0 = 0.162 +- 0.239 (in-sample avg dev_std = 0.048)
NEC for r=0.1 all KL = 0.08 +- 0.239 (in-sample avg dev_std = 0.048)
NEC for r=0.1 all L1 = 0.082 +- 0.226 (in-sample avg dev_std = 0.048)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020628
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.002 +- 0.239 (in-sample avg dev_std = 0.051)
NEC for r=0.2 class 1.0 = 0.162 +- 0.239 (in-sample avg dev_std = 0.051)
NEC for r=0.2 all KL = 0.08 +- 0.239 (in-sample avg dev_std = 0.051)
NEC for r=0.2 all L1 = 0.082 +- 0.226 (in-sample avg dev_std = 0.051)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010995999999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.045)
NEC for r=0.4 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all KL = 0.08 +- 0.238 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all L1 = 0.082 +- 0.226 (in-sample avg dev_std = 0.045)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005606
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.002 +- 0.239 (in-sample avg dev_std = 0.066)
NEC for r=0.8 class 1.0 = 0.162 +- 0.239 (in-sample avg dev_std = 0.066)
NEC for r=0.8 all KL = 0.081 +- 0.239 (in-sample avg dev_std = 0.066)
NEC for r=0.8 all L1 = 0.083 +- 0.226 (in-sample avg dev_std = 0.066)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081184
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.041 +- 0.239 (in-sample avg dev_std = 0.043)
NEC for r=0.05 class 1.0 = 0.075 +- 0.239 (in-sample avg dev_std = 0.043)
NEC for r=0.05 all KL = 0.068 +- 0.239 (in-sample avg dev_std = 0.043)
NEC for r=0.05 all L1 = 0.057 +- 0.204 (in-sample avg dev_std = 0.043)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122244
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.052 +- 0.266 (in-sample avg dev_std = 0.107)
NEC for r=0.1 class 1.0 = 0.086 +- 0.266 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all KL = 0.084 +- 0.266 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all L1 = 0.068 +- 0.221 (in-sample avg dev_std = 0.107)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019827800000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.5
NEC for r=0.2 class 0.0 = 0.053 +- 0.288 (in-sample avg dev_std = 0.162)
NEC for r=0.2 class 1.0 = 0.098 +- 0.288 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all KL = 0.1 +- 0.288 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all L1 = 0.076 +- 0.227 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.030766400000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.5
NEC for r=0.4 class 0.0 = 0.047 +- 0.299 (in-sample avg dev_std = 0.212)
NEC for r=0.4 class 1.0 = 0.103 +- 0.299 (in-sample avg dev_std = 0.212)
NEC for r=0.4 all KL = 0.11 +- 0.299 (in-sample avg dev_std = 0.212)
NEC for r=0.4 all L1 = 0.074 +- 0.217 (in-sample avg dev_std = 0.212)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0468454
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.045 +- 0.305 (in-sample avg dev_std = 0.218)
NEC for r=0.8 class 1.0 = 0.104 +- 0.305 (in-sample avg dev_std = 0.218)
NEC for r=0.8 all KL = 0.116 +- 0.305 (in-sample avg dev_std = 0.218)
NEC for r=0.8 all L1 = 0.074 +- 0.214 (in-sample avg dev_std = 0.218)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 15:05:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 03:05:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.001
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.004
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.052
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.002
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.005
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.020
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.058


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.503
SUFF_SIMPLE for r=0.05 class 0.0 = 0.947 +- 0.470 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.186 +- 0.470 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.05 all KL = 0.397 +- 0.470 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.05 all L1 = 0.525 +- 0.388 (in-sample avg dev_std = 0.459)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001136
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.501
SUFF_SIMPLE for r=0.1 class 0.0 = 0.948 +- 0.471 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.183 +- 0.471 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.1 all KL = 0.403 +- 0.471 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.1 all L1 = 0.524 +- 0.390 (in-sample avg dev_std = 0.446)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0035059999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.501
SUFF_SIMPLE for r=0.2 class 0.0 = 0.952 +- 0.473 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.18 +- 0.473 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 all KL = 0.407 +- 0.473 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 all L1 = 0.524 +- 0.392 (in-sample avg dev_std = 0.447)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012364
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.936 +- 0.466 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.18 +- 0.466 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.4 all KL = 0.385 +- 0.466 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.4 all L1 = 0.517 +- 0.387 (in-sample avg dev_std = 0.459)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.051992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.494
SUFF_SIMPLE for r=0.8 class 0.0 = 0.975 +- 0.487 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.184 +- 0.487 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.8 all KL = 0.448 +- 0.487 (in-sample avg dev_std = 0.328)
SUFF_SIMPLE for r=0.8 all L1 = 0.537 +- 0.408 (in-sample avg dev_std = 0.328)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.002)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.520000000000001e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006754
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.491
SUFF_SIMPLE for r=0.05 class 0.0 = 0.938 +- 0.312 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.882 +- 0.312 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all KL = 0.883 +- 0.312 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.245 (in-sample avg dev_std = 0.212)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0015534
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.937 +- 0.311 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.882 +- 0.311 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 all KL = 0.884 +- 0.311 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.246 (in-sample avg dev_std = 0.206)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0054122
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.489
SUFF_SIMPLE for r=0.2 class 0.0 = 0.936 +- 0.314 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.314 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all KL = 0.882 +- 0.314 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all L1 = 0.907 +- 0.251 (in-sample avg dev_std = 0.200)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.019672199999999997
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.489
SUFF_SIMPLE for r=0.4 class 0.0 = 0.935 +- 0.314 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.875 +- 0.314 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.4 all KL = 0.882 +- 0.314 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.4 all L1 = 0.905 +- 0.256 (in-sample avg dev_std = 0.185)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.514
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057988
len(reference) = 4914
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.48
SUFF_SIMPLE for r=0.8 class 0.0 = 0.953 +- 0.289 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.881 +- 0.289 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.8 all KL = 0.902 +- 0.289 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.245 (in-sample avg dev_std = 0.095)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.859
NEC for r=0.05 class 0.0 = 0.034 +- 0.365 (in-sample avg dev_std = 0.230)
NEC for r=0.05 class 1.0 = 0.263 +- 0.365 (in-sample avg dev_std = 0.230)
NEC for r=0.05 all KL = 0.226 +- 0.365 (in-sample avg dev_std = 0.230)
NEC for r=0.05 all L1 = 0.161 +- 0.279 (in-sample avg dev_std = 0.230)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001136
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.849
NEC for r=0.1 class 0.0 = 0.03 +- 0.370 (in-sample avg dev_std = 0.236)
NEC for r=0.1 class 1.0 = 0.277 +- 0.370 (in-sample avg dev_std = 0.236)
NEC for r=0.1 all KL = 0.238 +- 0.370 (in-sample avg dev_std = 0.236)
NEC for r=0.1 all L1 = 0.167 +- 0.282 (in-sample avg dev_std = 0.236)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0035059999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.842
NEC for r=0.2 class 0.0 = 0.038 +- 0.382 (in-sample avg dev_std = 0.292)
NEC for r=0.2 class 1.0 = 0.302 +- 0.382 (in-sample avg dev_std = 0.292)
NEC for r=0.2 all KL = 0.273 +- 0.382 (in-sample avg dev_std = 0.292)
NEC for r=0.2 all L1 = 0.184 +- 0.287 (in-sample avg dev_std = 0.292)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012364
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.832
NEC for r=0.4 class 0.0 = 0.039 +- 0.392 (in-sample avg dev_std = 0.318)
NEC for r=0.4 class 1.0 = 0.321 +- 0.392 (in-sample avg dev_std = 0.318)
NEC for r=0.4 all KL = 0.296 +- 0.392 (in-sample avg dev_std = 0.318)
NEC for r=0.4 all L1 = 0.195 +- 0.291 (in-sample avg dev_std = 0.318)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.051992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.814
NEC for r=0.8 class 0.0 = 0.047 +- 0.420 (in-sample avg dev_std = 0.419)
NEC for r=0.8 class 1.0 = 0.368 +- 0.420 (in-sample avg dev_std = 0.419)
NEC for r=0.8 all KL = 0.373 +- 0.420 (in-sample avg dev_std = 0.419)
NEC for r=0.8 all L1 = 0.225 +- 0.291 (in-sample avg dev_std = 0.419)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.211 (in-sample avg dev_std = 0.032)
NEC for r=0.05 class 1.0 = 0.123 +- 0.211 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all KL = 0.06 +- 0.211 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.019)
NEC for r=0.1 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.019)
NEC for r=0.1 all KL = 0.06 +- 0.210 (in-sample avg dev_std = 0.019)
NEC for r=0.1 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.019)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.0 +- 0.211 (in-sample avg dev_std = 0.040)
NEC for r=0.2 class 1.0 = 0.123 +- 0.211 (in-sample avg dev_std = 0.040)
NEC for r=0.2 all KL = 0.06 +- 0.211 (in-sample avg dev_std = 0.040)
NEC for r=0.2 all L1 = 0.062 +- 0.199 (in-sample avg dev_std = 0.040)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.0 +- 0.211 (in-sample avg dev_std = 0.048)
NEC for r=0.4 class 1.0 = 0.123 +- 0.211 (in-sample avg dev_std = 0.048)
NEC for r=0.4 all KL = 0.061 +- 0.211 (in-sample avg dev_std = 0.048)
NEC for r=0.4 all L1 = 0.062 +- 0.199 (in-sample avg dev_std = 0.048)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.520000000000001e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.0 +- 0.212 (in-sample avg dev_std = 0.072)
NEC for r=0.8 class 1.0 = 0.124 +- 0.212 (in-sample avg dev_std = 0.072)
NEC for r=0.8 all KL = 0.063 +- 0.212 (in-sample avg dev_std = 0.072)
NEC for r=0.8 all L1 = 0.063 +- 0.199 (in-sample avg dev_std = 0.072)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006754
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.516
NEC for r=0.05 class 0.0 = 0.041 +- 0.231 (in-sample avg dev_std = 0.065)
NEC for r=0.05 class 1.0 = 0.064 +- 0.231 (in-sample avg dev_std = 0.065)
NEC for r=0.05 all KL = 0.063 +- 0.231 (in-sample avg dev_std = 0.065)
NEC for r=0.05 all L1 = 0.053 +- 0.193 (in-sample avg dev_std = 0.065)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0015534
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.516
NEC for r=0.1 class 0.0 = 0.048 +- 0.251 (in-sample avg dev_std = 0.110)
NEC for r=0.1 class 1.0 = 0.073 +- 0.251 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all KL = 0.074 +- 0.251 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all L1 = 0.06 +- 0.205 (in-sample avg dev_std = 0.110)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0054122
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.053 +- 0.273 (in-sample avg dev_std = 0.142)
NEC for r=0.2 class 1.0 = 0.087 +- 0.273 (in-sample avg dev_std = 0.142)
NEC for r=0.2 all KL = 0.089 +- 0.273 (in-sample avg dev_std = 0.142)
NEC for r=0.2 all L1 = 0.07 +- 0.221 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.019672199999999997
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.501
NEC for r=0.4 class 0.0 = 0.044 +- 0.277 (in-sample avg dev_std = 0.198)
NEC for r=0.4 class 1.0 = 0.086 +- 0.277 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all KL = 0.094 +- 0.277 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all L1 = 0.065 +- 0.204 (in-sample avg dev_std = 0.198)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.52
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057988
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.497
NEC for r=0.8 class 0.0 = 0.039 +- 0.293 (in-sample avg dev_std = 0.216)
NEC for r=0.8 class 1.0 = 0.094 +- 0.293 (in-sample avg dev_std = 0.216)
NEC for r=0.8 all KL = 0.105 +- 0.293 (in-sample avg dev_std = 0.216)
NEC for r=0.8 all L1 = 0.066 +- 0.201 (in-sample avg dev_std = 0.216)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 15:19:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 03:19:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.016
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.021
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012080000000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.491
SUFF_SIMPLE for r=0.05 class 0.0 = 0.941 +- 0.465 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.181 +- 0.465 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.05 all KL = 0.41 +- 0.465 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.05 all L1 = 0.52 +- 0.387 (in-sample avg dev_std = 0.426)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.016174
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.931 +- 0.460 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.186 +- 0.460 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.1 all KL = 0.4 +- 0.460 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.1 all L1 = 0.518 +- 0.383 (in-sample avg dev_std = 0.443)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022316
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.94 +- 0.466 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.183 +- 0.466 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.2 all KL = 0.41 +- 0.466 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.2 all L1 = 0.521 +- 0.387 (in-sample avg dev_std = 0.424)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031120000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.49
SUFF_SIMPLE for r=0.4 class 0.0 = 0.928 +- 0.459 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.182 +- 0.459 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.4 all KL = 0.396 +- 0.459 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.4 all L1 = 0.515 +- 0.383 (in-sample avg dev_std = 0.450)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036548000000000004
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.468
SUFF_SIMPLE for r=0.8 class 0.0 = 0.972 +- 0.484 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.168 +- 0.484 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.8 all KL = 0.457 +- 0.484 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.8 all L1 = 0.525 +- 0.414 (in-sample avg dev_std = 0.197)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0025759999999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031368000000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.1 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.004)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021654000000000005
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.001178
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006022
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008990999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.938 +- 0.306 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.894 +- 0.306 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 all KL = 0.888 +- 0.306 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 all L1 = 0.916 +- 0.235 (in-sample avg dev_std = 0.206)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0133226
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.937 +- 0.305 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.891 +- 0.305 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 all KL = 0.888 +- 0.305 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.238 (in-sample avg dev_std = 0.203)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020676600000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.494
SUFF_SIMPLE for r=0.2 class 0.0 = 0.936 +- 0.304 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.893 +- 0.304 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all KL = 0.889 +- 0.304 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.238 (in-sample avg dev_std = 0.205)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0311536
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.494
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.304 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.304 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.4 all KL = 0.89 +- 0.304 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.4 all L1 = 0.912 +- 0.243 (in-sample avg dev_std = 0.189)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047249
len(reference) = 4881
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.477
SUFF_SIMPLE for r=0.8 class 0.0 = 0.967 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.904 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.926 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.936 +- 0.219 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012080000000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.834
NEC for r=0.05 class 0.0 = 0.033 +- 0.377 (in-sample avg dev_std = 0.259)
NEC for r=0.05 class 1.0 = 0.318 +- 0.377 (in-sample avg dev_std = 0.259)
NEC for r=0.05 all KL = 0.263 +- 0.377 (in-sample avg dev_std = 0.259)
NEC for r=0.05 all L1 = 0.191 +- 0.290 (in-sample avg dev_std = 0.259)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.016174
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.84
NEC for r=0.1 class 0.0 = 0.033 +- 0.375 (in-sample avg dev_std = 0.291)
NEC for r=0.1 class 1.0 = 0.316 +- 0.375 (in-sample avg dev_std = 0.291)
NEC for r=0.1 all KL = 0.267 +- 0.375 (in-sample avg dev_std = 0.291)
NEC for r=0.1 all L1 = 0.19 +- 0.283 (in-sample avg dev_std = 0.291)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022316
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.835
NEC for r=0.2 class 0.0 = 0.041 +- 0.379 (in-sample avg dev_std = 0.297)
NEC for r=0.2 class 1.0 = 0.316 +- 0.379 (in-sample avg dev_std = 0.297)
NEC for r=0.2 all KL = 0.28 +- 0.379 (in-sample avg dev_std = 0.297)
NEC for r=0.2 all L1 = 0.193 +- 0.284 (in-sample avg dev_std = 0.297)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031120000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.82
NEC for r=0.4 class 0.0 = 0.046 +- 0.399 (in-sample avg dev_std = 0.356)
NEC for r=0.4 class 1.0 = 0.351 +- 0.399 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all KL = 0.327 +- 0.399 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all L1 = 0.215 +- 0.286 (in-sample avg dev_std = 0.356)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036548000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.821
NEC for r=0.8 class 0.0 = 0.06 +- 0.393 (in-sample avg dev_std = 0.362)
NEC for r=0.8 class 1.0 = 0.345 +- 0.393 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all KL = 0.334 +- 0.393 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all L1 = 0.217 +- 0.284 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0025759999999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.031)
NEC for r=0.05 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.031)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031368000000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.047)
NEC for r=0.1 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all KL = 0.056 +- 0.206 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.047)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021654000000000005
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.039)
NEC for r=0.2 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.039)
NEC for r=0.2 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.039)
NEC for r=0.2 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.039)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.001178
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.036)
NEC for r=0.4 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.036)
NEC for r=0.4 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.036)
NEC for r=0.4 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.036)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006022
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
NEC for r=0.8 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.050)
NEC for r=0.8 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.050)
NEC for r=0.8 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.050)
NEC for r=0.8 all L1 = 0.056 +- 0.192 (in-sample avg dev_std = 0.050)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008990999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.04 +- 0.226 (in-sample avg dev_std = 0.043)
NEC for r=0.05 class 1.0 = 0.065 +- 0.226 (in-sample avg dev_std = 0.043)
NEC for r=0.05 all KL = 0.061 +- 0.226 (in-sample avg dev_std = 0.043)
NEC for r=0.05 all L1 = 0.052 +- 0.193 (in-sample avg dev_std = 0.043)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0133226
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.502
NEC for r=0.1 class 0.0 = 0.05 +- 0.253 (in-sample avg dev_std = 0.104)
NEC for r=0.1 class 1.0 = 0.076 +- 0.253 (in-sample avg dev_std = 0.104)
NEC for r=0.1 all KL = 0.076 +- 0.253 (in-sample avg dev_std = 0.104)
NEC for r=0.1 all L1 = 0.063 +- 0.209 (in-sample avg dev_std = 0.104)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020676600000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.048 +- 0.258 (in-sample avg dev_std = 0.139)
NEC for r=0.2 class 1.0 = 0.077 +- 0.258 (in-sample avg dev_std = 0.139)
NEC for r=0.2 all KL = 0.079 +- 0.258 (in-sample avg dev_std = 0.139)
NEC for r=0.2 all L1 = 0.062 +- 0.205 (in-sample avg dev_std = 0.139)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0311536
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.499
NEC for r=0.4 class 0.0 = 0.044 +- 0.275 (in-sample avg dev_std = 0.196)
NEC for r=0.4 class 1.0 = 0.08 +- 0.275 (in-sample avg dev_std = 0.196)
NEC for r=0.4 all KL = 0.093 +- 0.275 (in-sample avg dev_std = 0.196)
NEC for r=0.4 all L1 = 0.062 +- 0.196 (in-sample avg dev_std = 0.196)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.511
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047249
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.499
NEC for r=0.8 class 0.0 = 0.039 +- 0.279 (in-sample avg dev_std = 0.205)
NEC for r=0.8 class 1.0 = 0.082 +- 0.279 (in-sample avg dev_std = 0.205)
NEC for r=0.8 all KL = 0.097 +- 0.279 (in-sample avg dev_std = 0.205)
NEC for r=0.8 all L1 = 0.06 +- 0.189 (in-sample avg dev_std = 0.205)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.412, 0.405, 0.404, 0.402, 0.449], 'all_L1': [0.528, 0.524, 0.524, 0.521, 0.525]}), defaultdict(<class 'list'>, {'all_KL': [0.395, 0.398, 0.4, 0.384, 0.439], 'all_L1': [0.531, 0.529, 0.528, 0.517, 0.537]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.414, 0.421, 0.42, 0.446], 'all_L1': [0.519, 0.513, 0.514, 0.514, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.421, 0.428, 0.416, 0.411, 0.456], 'all_L1': [0.528, 0.53, 0.526, 0.523, 0.526]}), defaultdict(<class 'list'>, {'all_KL': [0.409, 0.404, 0.421, 0.401, 0.459], 'all_L1': [0.524, 0.524, 0.528, 0.518, 0.53]}), defaultdict(<class 'list'>, {'all_KL': [0.413, 0.407, 0.41, 0.409, 0.439], 'all_L1': [0.515, 0.511, 0.512, 0.511, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.393, 0.397, 0.399, 0.382, 0.435], 'all_L1': [0.506, 0.508, 0.506, 0.501, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.411, 0.399, 0.406, 0.443], 'all_L1': [0.527, 0.528, 0.522, 0.522, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.397, 0.403, 0.407, 0.385, 0.448], 'all_L1': [0.525, 0.524, 0.524, 0.517, 0.537]}), defaultdict(<class 'list'>, {'all_KL': [0.41, 0.4, 0.41, 0.396, 0.457], 'all_L1': [0.52, 0.518, 0.521, 0.515, 0.525]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.285, 0.305, 0.332, 0.337, 0.365], 'all_L1': [0.203, 0.209, 0.22, 0.217, 0.228]}), defaultdict(<class 'list'>, {'all_KL': [0.186, 0.183, 0.201, 0.219, 0.316], 'all_L1': [0.138, 0.134, 0.141, 0.149, 0.188]}), defaultdict(<class 'list'>, {'all_KL': [0.28, 0.285, 0.313, 0.328, 0.336], 'all_L1': [0.215, 0.213, 0.229, 0.232, 0.237]}), defaultdict(<class 'list'>, {'all_KL': [0.287, 0.299, 0.331, 0.347, 0.383], 'all_L1': [0.216, 0.216, 0.229, 0.232, 0.244]}), defaultdict(<class 'list'>, {'all_KL': [0.295, 0.308, 0.344, 0.353, 0.355], 'all_L1': [0.212, 0.215, 0.226, 0.234, 0.23]}), defaultdict(<class 'list'>, {'all_KL': [0.224, 0.231, 0.255, 0.265, 0.275], 'all_L1': [0.189, 0.188, 0.199, 0.201, 0.207]}), defaultdict(<class 'list'>, {'all_KL': [0.27, 0.286, 0.325, 0.333, 0.333], 'all_L1': [0.209, 0.213, 0.231, 0.232, 0.227]}), defaultdict(<class 'list'>, {'all_KL': [0.229, 0.253, 0.298, 0.292, 0.331], 'all_L1': [0.169, 0.178, 0.198, 0.189, 0.204]}), defaultdict(<class 'list'>, {'all_KL': [0.226, 0.238, 0.273, 0.296, 0.373], 'all_L1': [0.161, 0.167, 0.184, 0.195, 0.225]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.267, 0.28, 0.327, 0.334], 'all_L1': [0.191, 0.19, 0.193, 0.215, 0.217]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.582, 0.582, 0.582, 0.582, 0.582], 'all_L1': [0.615, 0.615, 0.615, 0.615, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.758, 0.758, 0.758, 0.758, 0.758], 'all_L1': [0.768, 0.768, 0.768, 0.768, 0.768]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.639, 0.639, 0.639, 0.639], 'all_L1': [0.658, 0.658, 0.658, 0.658, 0.658]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.868, 0.868, 0.868, 0.868], 'all_L1': [0.867, 0.867, 0.867, 0.867, 0.867]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.721, 0.721, 0.721, 0.721], 'all_L1': [0.734, 0.734, 0.734, 0.734, 0.734]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.786, 0.786, 0.786, 0.786], 'all_L1': [0.784, 0.784, 0.784, 0.784, 0.784]}), defaultdict(<class 'list'>, {'all_KL': [0.344, 0.344, 0.344, 0.344, 0.344], 'all_L1': [0.407, 0.407, 0.407, 0.407, 0.407]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.921, 0.921, 0.921, 0.921], 'all_L1': [0.918, 0.918, 0.918, 0.918, 0.918]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.941, 0.941, 0.941, 0.941], 'all_L1': [0.938, 0.938, 0.938, 0.938, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.945, 0.945, 0.945, 0.945], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.418, 0.418, 0.418, 0.417, 0.418], 'all_L1': [0.382, 0.382, 0.383, 0.382, 0.382]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.242, 0.242, 0.242, 0.244], 'all_L1': [0.232, 0.232, 0.232, 0.232, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.361, 0.361, 0.361, 0.361], 'all_L1': [0.342, 0.342, 0.342, 0.342, 0.341]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.132, 0.132, 0.132, 0.132], 'all_L1': [0.133, 0.133, 0.133, 0.133, 0.133]}), defaultdict(<class 'list'>, {'all_KL': [0.281, 0.281, 0.281, 0.281, 0.284], 'all_L1': [0.266, 0.266, 0.266, 0.267, 0.267]}), defaultdict(<class 'list'>, {'all_KL': [0.215, 0.214, 0.214, 0.215, 0.215], 'all_L1': [0.215, 0.215, 0.216, 0.216, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.655, 0.656, 0.656, 0.656], 'all_L1': [0.59, 0.59, 0.591, 0.591, 0.59]}), defaultdict(<class 'list'>, {'all_KL': [0.081, 0.08, 0.08, 0.08, 0.081], 'all_L1': [0.083, 0.082, 0.082, 0.082, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.06, 0.06, 0.06, 0.061, 0.063], 'all_L1': [0.062, 0.062, 0.062, 0.062, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.056, 0.055, 0.055, 0.055], 'all_L1': [0.056, 0.056, 0.056, 0.056, 0.056]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.881, 0.88, 0.881, 0.882, 0.922], 'all_L1': [0.91, 0.909, 0.907, 0.906, 0.933]}), defaultdict(<class 'list'>, {'all_KL': [0.874, 0.875, 0.873, 0.874, 0.894], 'all_L1': [0.903, 0.903, 0.9, 0.898, 0.912]}), defaultdict(<class 'list'>, {'all_KL': [0.891, 0.892, 0.892, 0.892, 0.93], 'all_L1': [0.918, 0.917, 0.917, 0.913, 0.94]}), defaultdict(<class 'list'>, {'all_KL': [0.889, 0.888, 0.888, 0.887, 0.927], 'all_L1': [0.915, 0.914, 0.913, 0.911, 0.936]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.888, 0.889, 0.891, 0.934], 'all_L1': [0.916, 0.916, 0.915, 0.914, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.881, 0.882, 0.882, 0.92], 'all_L1': [0.909, 0.909, 0.908, 0.905, 0.93]}), defaultdict(<class 'list'>, {'all_KL': [0.895, 0.895, 0.895, 0.896, 0.932], 'all_L1': [0.919, 0.919, 0.918, 0.916, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.872, 0.873, 0.873, 0.874, 0.918], 'all_L1': [0.902, 0.902, 0.901, 0.899, 0.929]}), defaultdict(<class 'list'>, {'all_KL': [0.883, 0.884, 0.882, 0.882, 0.902], 'all_L1': [0.91, 0.91, 0.907, 0.905, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.888, 0.889, 0.89, 0.926], 'all_L1': [0.916, 0.914, 0.914, 0.912, 0.936]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.069, 0.082, 0.094, 0.105, 0.108], 'all_L1': [0.057, 0.067, 0.071, 0.07, 0.067]}), defaultdict(<class 'list'>, {'all_KL': [0.068, 0.078, 0.095, 0.104, 0.118], 'all_L1': [0.057, 0.063, 0.073, 0.073, 0.075]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.077, 0.082, 0.088, 0.09], 'all_L1': [0.053, 0.062, 0.063, 0.06, 0.057]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.077, 0.084, 0.09, 0.095], 'all_L1': [0.054, 0.064, 0.066, 0.063, 0.061]}), defaultdict(<class 'list'>, {'all_KL': [0.065, 0.078, 0.089, 0.1, 0.099], 'all_L1': [0.055, 0.064, 0.068, 0.066, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.086, 0.091, 0.104, 0.109], 'all_L1': [0.06, 0.07, 0.071, 0.071, 0.069]}), defaultdict(<class 'list'>, {'all_KL': [0.06, 0.073, 0.079, 0.089, 0.093], 'all_L1': [0.051, 0.061, 0.061, 0.06, 0.058]}), defaultdict(<class 'list'>, {'all_KL': [0.068, 0.084, 0.1, 0.11, 0.116], 'all_L1': [0.057, 0.068, 0.076, 0.074, 0.074]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.074, 0.089, 0.094, 0.105], 'all_L1': [0.053, 0.06, 0.07, 0.065, 0.066]}), defaultdict(<class 'list'>, {'all_KL': [0.061, 0.076, 0.079, 0.093, 0.097], 'all_L1': [0.052, 0.063, 0.062, 0.062, 0.06]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.522 +- 0.007, 0.521 +- 0.008, 0.520 +- 0.007, 0.516 +- 0.006, 0.522 +- 0.012
suff_simple class all_KL  =  0.408 +- 0.010, 0.407 +- 0.009, 0.409 +- 0.008, 0.400 +- 0.012, 0.447 +- 0.008
suff_simple_acc_int  =  0.501 +- 0.018, 0.499 +- 0.017, 0.497 +- 0.017, 0.494 +- 0.015, 0.471 +- 0.021
nec class all_L1  =  0.190 +- 0.025, 0.192 +- 0.025, 0.205 +- 0.027, 0.210 +- 0.026, 0.221 +- 0.016
nec class all_KL  =  0.255 +- 0.034, 0.265 +- 0.038, 0.295 +- 0.042, 0.310 +- 0.040, 0.340 +- 0.030
nec_acc_int  =  0.835 +- 0.035, 0.836 +- 0.033, 0.829 +- 0.035, 0.826 +- 0.034, 0.821 +- 0.029

Eval split val
suff_simple class all_L1  =  0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161
suff_simple class all_KL  =  0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180
suff_simple_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000
nec class all_L1  =  0.236 +- 0.160, 0.236 +- 0.160, 0.236 +- 0.160, 0.236 +- 0.160, 0.236 +- 0.160
nec class all_KL  =  0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.251 +- 0.180
nec_acc_int  =  0.498 +- 0.002, 0.498 +- 0.002, 0.498 +- 0.001, 0.498 +- 0.001, 0.499 +- 0.002

Eval split test
suff_simple class all_L1  =  0.912 +- 0.006, 0.911 +- 0.005, 0.910 +- 0.006, 0.908 +- 0.006, 0.932 +- 0.010
suff_simple class all_KL  =  0.884 +- 0.007, 0.884 +- 0.007, 0.884 +- 0.007, 0.885 +- 0.007, 0.920 +- 0.012
suff_simple_acc_int  =  0.493 +- 0.001, 0.493 +- 0.001, 0.492 +- 0.001, 0.493 +- 0.001, 0.477 +- 0.002
nec class all_L1  =  0.055 +- 0.003, 0.064 +- 0.003, 0.068 +- 0.005, 0.066 +- 0.005, 0.065 +- 0.006
nec class all_KL  =  0.065 +- 0.003, 0.078 +- 0.004, 0.088 +- 0.007, 0.098 +- 0.007, 0.103 +- 0.009
nec_acc_int  =  0.508 +- 0.005, 0.505 +- 0.006, 0.500 +- 0.004, 0.498 +- 0.003, 0.498 +- 0.001


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.356 +- 0.012, 0.357 +- 0.012, 0.363 +- 0.013, 0.363 +- 0.013, 0.371 +- 0.009
Faith. Armon (L1)= 		  =  0.278 +- 0.028, 0.280 +- 0.028, 0.293 +- 0.029, 0.297 +- 0.027, 0.310 +- 0.016
Faith. GMean (L1)= 	  =  0.314 +- 0.021, 0.316 +- 0.021, 0.326 +- 0.022, 0.328 +- 0.021, 0.339 +- 0.013
Faith. Aritm (KL)= 		  =  0.331 +- 0.020, 0.336 +- 0.021, 0.352 +- 0.023, 0.355 +- 0.023, 0.394 +- 0.017
Faith. Armon (KL)= 		  =  0.312 +- 0.028, 0.320 +- 0.030, 0.341 +- 0.031, 0.348 +- 0.029, 0.386 +- 0.021
Faith. GMean (KL)= 	  =  0.322 +- 0.024, 0.328 +- 0.026, 0.346 +- 0.027, 0.351 +- 0.026, 0.390 +- 0.019

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.001, 0.500 +- 0.001, 0.500 +- 0.000, 0.500 +- 0.001, 0.500 +- 0.001
Faith. Armon (L1)= 		  =  0.309 +- 0.140, 0.309 +- 0.140, 0.309 +- 0.140, 0.309 +- 0.140, 0.310 +- 0.139
Faith. GMean (L1)= 	  =  0.381 +- 0.096, 0.381 +- 0.096, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.096
Faith. Aritm (KL)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.501 +- 0.001
Faith. Armon (KL)= 		  =  0.310 +- 0.142, 0.310 +- 0.142, 0.310 +- 0.142, 0.310 +- 0.142, 0.311 +- 0.141
Faith. GMean (KL)= 	  =  0.382 +- 0.098, 0.381 +- 0.098, 0.381 +- 0.098, 0.381 +- 0.098, 0.383 +- 0.098

Eval split test
Faith. Aritm (L1)= 		  =  0.483 +- 0.002, 0.488 +- 0.002, 0.489 +- 0.001, 0.487 +- 0.001, 0.498 +- 0.003
Faith. Armon (L1)= 		  =  0.104 +- 0.005, 0.120 +- 0.005, 0.127 +- 0.008, 0.124 +- 0.009, 0.121 +- 0.011
Faith. GMean (L1)= 	  =  0.224 +- 0.005, 0.242 +- 0.005, 0.249 +- 0.008, 0.245 +- 0.009, 0.245 +- 0.011
Faith. Aritm (KL)= 		  =  0.475 +- 0.002, 0.481 +- 0.003, 0.486 +- 0.001, 0.491 +- 0.002, 0.512 +- 0.004
Faith. Armon (KL)= 		  =  0.121 +- 0.006, 0.144 +- 0.007, 0.160 +- 0.011, 0.176 +- 0.012, 0.185 +- 0.015
Faith. GMean (KL)= 	  =  0.239 +- 0.005, 0.263 +- 0.006, 0.279 +- 0.010, 0.294 +- 0.010, 0.308 +- 0.012
Computed for split load_split = id



Completed in  2:22:51.905383  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.01 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 15:33:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 03:33:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.034


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.488 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.05 all KL = 0.454 +- 0.488 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.05 all L1 = 0.52 +- 0.422 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.988 +- 0.488 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.454 +- 0.488 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.52 +- 0.422 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
SUFF_SIMPLE for r=0.2 class 0.0 = 0.989 +- 0.488 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.144 +- 0.488 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.2 all KL = 0.454 +- 0.488 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.2 all L1 = 0.521 +- 0.422 (in-sample avg dev_std = 0.070)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.989 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.454 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.52 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013504
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.449 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.516 +- 0.422 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.491
SUFF_SIMPLE for r=0.05 class 0.0 = 0.824 +- 0.420 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.771 +- 0.420 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.05 all KL = 0.758 +- 0.420 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.05 all L1 = 0.798 +- 0.355 (in-sample avg dev_std = 0.157)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.49
SUFF_SIMPLE for r=0.1 class 0.0 = 0.825 +- 0.420 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.771 +- 0.420 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 all KL = 0.758 +- 0.420 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 all L1 = 0.798 +- 0.356 (in-sample avg dev_std = 0.152)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009295999999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.489
SUFF_SIMPLE for r=0.2 class 0.0 = 0.825 +- 0.421 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.77 +- 0.421 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.2 all KL = 0.759 +- 0.421 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.2 all L1 = 0.798 +- 0.356 (in-sample avg dev_std = 0.152)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0051328
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.843 +- 0.409 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.787 +- 0.409 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 all KL = 0.777 +- 0.409 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.4 all L1 = 0.815 +- 0.343 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0339894
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.489
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.211 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.94 +- 0.211 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.211 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.956 +- 0.180 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.014 +- 0.488 (in-sample avg dev_std = 0.041)
NEC for r=0.05 class 1.0 = 0.763 +- 0.488 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all KL = 0.493 +- 0.488 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all L1 = 0.429 +- 0.422 (in-sample avg dev_std = 0.041)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.478
NEC for r=0.1 class 0.0 = 0.018 +- 0.487 (in-sample avg dev_std = 0.115)
NEC for r=0.1 class 1.0 = 0.809 +- 0.487 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all KL = 0.526 +- 0.487 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all L1 = 0.456 +- 0.419 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.465
NEC for r=0.2 class 0.0 = 0.024 +- 0.488 (in-sample avg dev_std = 0.165)
NEC for r=0.2 class 1.0 = 0.827 +- 0.488 (in-sample avg dev_std = 0.165)
NEC for r=0.2 all KL = 0.539 +- 0.488 (in-sample avg dev_std = 0.165)
NEC for r=0.2 all L1 = 0.469 +- 0.419 (in-sample avg dev_std = 0.165)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.463
NEC for r=0.4 class 0.0 = 0.035 +- 0.485 (in-sample avg dev_std = 0.237)
NEC for r=0.4 class 1.0 = 0.829 +- 0.485 (in-sample avg dev_std = 0.237)
NEC for r=0.4 all KL = 0.554 +- 0.485 (in-sample avg dev_std = 0.237)
NEC for r=0.4 all L1 = 0.475 +- 0.415 (in-sample avg dev_std = 0.237)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013504
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.479
NEC for r=0.8 class 0.0 = 0.024 +- 0.482 (in-sample avg dev_std = 0.362)
NEC for r=0.8 class 1.0 = 0.833 +- 0.482 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all KL = 0.561 +- 0.482 (in-sample avg dev_std = 0.362)
NEC for r=0.8 all L1 = 0.472 +- 0.408 (in-sample avg dev_std = 0.362)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.038 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.051 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.052 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.044 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.057 +- 0.252 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.07 +- 0.252 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.076 +- 0.252 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009295999999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.51
NEC for r=0.2 class 0.0 = 0.093 +- 0.318 (in-sample avg dev_std = 0.065)
NEC for r=0.2 class 1.0 = 0.113 +- 0.318 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all KL = 0.123 +- 0.318 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all L1 = 0.103 +- 0.269 (in-sample avg dev_std = 0.065)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0051328
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.513
NEC for r=0.4 class 0.0 = 0.133 +- 0.382 (in-sample avg dev_std = 0.144)
NEC for r=0.4 class 1.0 = 0.173 +- 0.382 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all KL = 0.187 +- 0.382 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all L1 = 0.153 +- 0.316 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.519
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0339894
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.507
NEC for r=0.8 class 0.0 = 0.108 +- 0.357 (in-sample avg dev_std = 0.190)
NEC for r=0.8 class 1.0 = 0.149 +- 0.357 (in-sample avg dev_std = 0.190)
NEC for r=0.8 all KL = 0.158 +- 0.357 (in-sample avg dev_std = 0.190)
NEC for r=0.8 all L1 = 0.128 +- 0.293 (in-sample avg dev_std = 0.190)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 15:48:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 03:48:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.002
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.007
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.024
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.058
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.004
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.028
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.073


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.447
SUFF_SIMPLE for r=0.05 class 0.0 = 0.943 +- 0.482 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.137 +- 0.482 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.05 all KL = 0.43 +- 0.482 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.05 all L1 = 0.496 +- 0.412 (in-sample avg dev_std = 0.062)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.445
SUFF_SIMPLE for r=0.1 class 0.0 = 0.94 +- 0.482 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.137 +- 0.482 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.1 all KL = 0.429 +- 0.482 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.1 all L1 = 0.495 +- 0.412 (in-sample avg dev_std = 0.054)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.448
SUFF_SIMPLE for r=0.2 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.14 +- 0.483 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all KL = 0.433 +- 0.483 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all L1 = 0.498 +- 0.413 (in-sample avg dev_std = 0.032)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024278
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.464
SUFF_SIMPLE for r=0.4 class 0.0 = 0.944 +- 0.485 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.165 +- 0.485 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all L1 = 0.512 +- 0.415 (in-sample avg dev_std = 0.032)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.058072000000000006
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.522
SUFF_SIMPLE for r=0.8 class 0.0 = 0.943 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.251 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.494 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.559 +- 0.413 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.822 +- 0.423 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.764 +- 0.423 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 all KL = 0.757 +- 0.423 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.146)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.493
SUFF_SIMPLE for r=0.1 class 0.0 = 0.822 +- 0.423 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.765 +- 0.423 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 all KL = 0.757 +- 0.423 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 all L1 = 0.794 +- 0.359 (in-sample avg dev_std = 0.146)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.493
SUFF_SIMPLE for r=0.2 class 0.0 = 0.823 +- 0.422 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.766 +- 0.422 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.422 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all L1 = 0.795 +- 0.359 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.027949800000000004
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.505
SUFF_SIMPLE for r=0.4 class 0.0 = 0.85 +- 0.392 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.811 +- 0.392 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.4 all KL = 0.801 +- 0.392 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.4 all L1 = 0.831 +- 0.335 (in-sample avg dev_std = 0.078)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.519
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07330260000000001
len(reference) = 4915
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.517
SUFF_SIMPLE for r=0.8 class 0.0 = 0.951 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.926 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.927 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.939 +- 0.210 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.518
NEC for r=0.05 class 0.0 = 0.052 +- 0.483 (in-sample avg dev_std = 0.029)
NEC for r=0.05 class 1.0 = 0.762 +- 0.483 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all KL = 0.512 +- 0.483 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all L1 = 0.446 +- 0.413 (in-sample avg dev_std = 0.029)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.486
NEC for r=0.1 class 0.0 = 0.061 +- 0.484 (in-sample avg dev_std = 0.108)
NEC for r=0.1 class 1.0 = 0.809 +- 0.484 (in-sample avg dev_std = 0.108)
NEC for r=0.1 all KL = 0.546 +- 0.484 (in-sample avg dev_std = 0.108)
NEC for r=0.1 all L1 = 0.475 +- 0.412 (in-sample avg dev_std = 0.108)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.476
NEC for r=0.2 class 0.0 = 0.067 +- 0.482 (in-sample avg dev_std = 0.180)
NEC for r=0.2 class 1.0 = 0.818 +- 0.482 (in-sample avg dev_std = 0.180)
NEC for r=0.2 all KL = 0.555 +- 0.482 (in-sample avg dev_std = 0.180)
NEC for r=0.2 all L1 = 0.483 +- 0.410 (in-sample avg dev_std = 0.180)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024278
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.465
NEC for r=0.4 class 0.0 = 0.068 +- 0.480 (in-sample avg dev_std = 0.286)
NEC for r=0.4 class 1.0 = 0.843 +- 0.480 (in-sample avg dev_std = 0.286)
NEC for r=0.4 all KL = 0.576 +- 0.480 (in-sample avg dev_std = 0.286)
NEC for r=0.4 all L1 = 0.497 +- 0.403 (in-sample avg dev_std = 0.286)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.058072000000000006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.478
NEC for r=0.8 class 0.0 = 0.061 +- 0.480 (in-sample avg dev_std = 0.352)
NEC for r=0.8 class 1.0 = 0.843 +- 0.480 (in-sample avg dev_std = 0.352)
NEC for r=0.8 all KL = 0.573 +- 0.480 (in-sample avg dev_std = 0.352)
NEC for r=0.8 all L1 = 0.494 +- 0.402 (in-sample avg dev_std = 0.352)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.046 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.084 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.077 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.065 +- 0.216 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.517
NEC for r=0.1 class 0.0 = 0.07 +- 0.293 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.102 +- 0.293 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.103 +- 0.293 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.086 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.516
NEC for r=0.2 class 0.0 = 0.111 +- 0.356 (in-sample avg dev_std = 0.124)
NEC for r=0.2 class 1.0 = 0.147 +- 0.356 (in-sample avg dev_std = 0.124)
NEC for r=0.2 all KL = 0.159 +- 0.356 (in-sample avg dev_std = 0.124)
NEC for r=0.2 all L1 = 0.129 +- 0.295 (in-sample avg dev_std = 0.124)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.027949800000000004
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.506
NEC for r=0.4 class 0.0 = 0.136 +- 0.378 (in-sample avg dev_std = 0.169)
NEC for r=0.4 class 1.0 = 0.159 +- 0.378 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all KL = 0.182 +- 0.378 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all L1 = 0.147 +- 0.311 (in-sample avg dev_std = 0.169)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.523
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07330260000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.488
NEC for r=0.8 class 0.0 = 0.11 +- 0.367 (in-sample avg dev_std = 0.173)
NEC for r=0.8 class 1.0 = 0.169 +- 0.367 (in-sample avg dev_std = 0.173)
NEC for r=0.8 all KL = 0.17 +- 0.367 (in-sample avg dev_std = 0.173)
NEC for r=0.8 all L1 = 0.139 +- 0.304 (in-sample avg dev_std = 0.173)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 16:02:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 04:02:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.962 +- 0.481 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.05 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.05 all L1 = 0.509 +- 0.414 (in-sample avg dev_std = 0.008)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.962 +- 0.481 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.144 +- 0.481 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.1 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.1 all L1 = 0.509 +- 0.414 (in-sample avg dev_std = 0.059)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.032)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012755999999999998
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.962 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.143 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.443 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.505 +- 0.414 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.491
SUFF_SIMPLE for r=0.05 class 0.0 = 0.827 +- 0.412 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.786 +- 0.412 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all KL = 0.77 +- 0.412 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all L1 = 0.807 +- 0.350 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.827 +- 0.412 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.786 +- 0.412 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all KL = 0.771 +- 0.412 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all L1 = 0.807 +- 0.351 (in-sample avg dev_std = 0.134)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009086000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.826 +- 0.413 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.786 +- 0.413 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 all KL = 0.771 +- 0.413 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 all L1 = 0.807 +- 0.350 (in-sample avg dev_std = 0.139)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.004990400000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF_SIMPLE for r=0.4 class 0.0 = 0.846 +- 0.399 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.806 +- 0.399 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.4 all KL = 0.791 +- 0.399 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.4 all L1 = 0.826 +- 0.336 (in-sample avg dev_std = 0.127)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.504
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.032675800000000005
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.944 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.951 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.957 +- 0.179 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.039 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.78 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.51 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.449 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.47
NEC for r=0.1 class 0.0 = 0.039 +- 0.479 (in-sample avg dev_std = 0.092)
NEC for r=0.1 class 1.0 = 0.827 +- 0.479 (in-sample avg dev_std = 0.092)
NEC for r=0.1 all KL = 0.539 +- 0.479 (in-sample avg dev_std = 0.092)
NEC for r=0.1 all L1 = 0.476 +- 0.412 (in-sample avg dev_std = 0.092)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.461
NEC for r=0.2 class 0.0 = 0.045 +- 0.481 (in-sample avg dev_std = 0.128)
NEC for r=0.2 class 1.0 = 0.834 +- 0.481 (in-sample avg dev_std = 0.128)
NEC for r=0.2 all KL = 0.546 +- 0.481 (in-sample avg dev_std = 0.128)
NEC for r=0.2 all L1 = 0.482 +- 0.412 (in-sample avg dev_std = 0.128)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.461
NEC for r=0.4 class 0.0 = 0.052 +- 0.478 (in-sample avg dev_std = 0.234)
NEC for r=0.4 class 1.0 = 0.835 +- 0.478 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all KL = 0.556 +- 0.478 (in-sample avg dev_std = 0.234)
NEC for r=0.4 all L1 = 0.486 +- 0.407 (in-sample avg dev_std = 0.234)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012755999999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.47
NEC for r=0.8 class 0.0 = 0.044 +- 0.477 (in-sample avg dev_std = 0.299)
NEC for r=0.8 class 1.0 = 0.84 +- 0.477 (in-sample avg dev_std = 0.299)
NEC for r=0.8 all KL = 0.56 +- 0.477 (in-sample avg dev_std = 0.299)
NEC for r=0.8 all L1 = 0.485 +- 0.405 (in-sample avg dev_std = 0.299)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.5
NEC for r=0.05 class 0.0 = 0.037 +- 0.218 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.06 +- 0.218 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.058 +- 0.218 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.049 +- 0.187 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.499
NEC for r=0.1 class 0.0 = 0.058 +- 0.260 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.078 +- 0.260 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.081 +- 0.260 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.068 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009086000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.091 +- 0.310 (in-sample avg dev_std = 0.064)
NEC for r=0.2 class 1.0 = 0.103 +- 0.310 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all KL = 0.116 +- 0.310 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all L1 = 0.097 +- 0.261 (in-sample avg dev_std = 0.064)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.004990400000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.511
NEC for r=0.4 class 0.0 = 0.13 +- 0.372 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.158 +- 0.372 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.177 +- 0.372 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.144 +- 0.309 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.032675800000000005
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.504
NEC for r=0.8 class 0.0 = 0.107 +- 0.345 (in-sample avg dev_std = 0.164)
NEC for r=0.8 class 1.0 = 0.135 +- 0.345 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all KL = 0.147 +- 0.345 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all L1 = 0.121 +- 0.286 (in-sample avg dev_std = 0.164)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 16:16:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 04:16:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.031


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.99 +- 0.486 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.05 all KL = 0.457 +- 0.486 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.05 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.027)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.99 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
SUFF_SIMPLE for r=0.2 class 0.0 = 0.99 +- 0.486 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.2 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.040)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012008
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.454 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.518 +- 0.422 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.491
SUFF_SIMPLE for r=0.05 class 0.0 = 0.829 +- 0.414 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.778 +- 0.414 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 all KL = 0.767 +- 0.414 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.146)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.828 +- 0.415 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.778 +- 0.415 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all KL = 0.766 +- 0.415 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all L1 = 0.803 +- 0.353 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.828 +- 0.415 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.778 +- 0.415 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all KL = 0.767 +- 0.415 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048382
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF_SIMPLE for r=0.4 class 0.0 = 0.847 +- 0.403 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.798 +- 0.403 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.403 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all L1 = 0.823 +- 0.338 (in-sample avg dev_std = 0.138)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0313284
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.491
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.209 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.94 +- 0.209 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.209 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.957 +- 0.181 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.013 +- 0.483 (in-sample avg dev_std = 0.032)
NEC for r=0.05 class 1.0 = 0.756 +- 0.483 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all KL = 0.489 +- 0.483 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all L1 = 0.425 +- 0.420 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.486
NEC for r=0.1 class 0.0 = 0.01 +- 0.485 (in-sample avg dev_std = 0.107)
NEC for r=0.1 class 1.0 = 0.8 +- 0.485 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all KL = 0.516 +- 0.485 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all L1 = 0.448 +- 0.419 (in-sample avg dev_std = 0.107)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.461
NEC for r=0.2 class 0.0 = 0.02 +- 0.486 (in-sample avg dev_std = 0.153)
NEC for r=0.2 class 1.0 = 0.829 +- 0.486 (in-sample avg dev_std = 0.153)
NEC for r=0.2 all KL = 0.536 +- 0.486 (in-sample avg dev_std = 0.153)
NEC for r=0.2 all L1 = 0.468 +- 0.420 (in-sample avg dev_std = 0.153)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.467
NEC for r=0.4 class 0.0 = 0.028 +- 0.483 (in-sample avg dev_std = 0.238)
NEC for r=0.4 class 1.0 = 0.826 +- 0.483 (in-sample avg dev_std = 0.238)
NEC for r=0.4 all KL = 0.547 +- 0.483 (in-sample avg dev_std = 0.238)
NEC for r=0.4 all L1 = 0.47 +- 0.414 (in-sample avg dev_std = 0.238)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012008
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.479
NEC for r=0.8 class 0.0 = 0.015 +- 0.482 (in-sample avg dev_std = 0.341)
NEC for r=0.8 class 1.0 = 0.833 +- 0.482 (in-sample avg dev_std = 0.341)
NEC for r=0.8 all KL = 0.549 +- 0.482 (in-sample avg dev_std = 0.341)
NEC for r=0.8 all L1 = 0.469 +- 0.410 (in-sample avg dev_std = 0.341)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.037 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.064 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.058 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.05 +- 0.189 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.502
NEC for r=0.1 class 0.0 = 0.058 +- 0.261 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.082 +- 0.261 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.081 +- 0.261 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.07 +- 0.226 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.09 +- 0.313 (in-sample avg dev_std = 0.063)
NEC for r=0.2 class 1.0 = 0.109 +- 0.313 (in-sample avg dev_std = 0.063)
NEC for r=0.2 all KL = 0.118 +- 0.313 (in-sample avg dev_std = 0.063)
NEC for r=0.2 all L1 = 0.099 +- 0.265 (in-sample avg dev_std = 0.063)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048382
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.127 +- 0.371 (in-sample avg dev_std = 0.139)
NEC for r=0.4 class 1.0 = 0.161 +- 0.371 (in-sample avg dev_std = 0.139)
NEC for r=0.4 all KL = 0.175 +- 0.371 (in-sample avg dev_std = 0.139)
NEC for r=0.4 all L1 = 0.144 +- 0.310 (in-sample avg dev_std = 0.139)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0313284
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.505
NEC for r=0.8 class 0.0 = 0.106 +- 0.350 (in-sample avg dev_std = 0.179)
NEC for r=0.8 class 1.0 = 0.143 +- 0.350 (in-sample avg dev_std = 0.179)
NEC for r=0.8 all KL = 0.152 +- 0.350 (in-sample avg dev_std = 0.179)
NEC for r=0.8 all L1 = 0.124 +- 0.289 (in-sample avg dev_std = 0.179)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 16:30:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 04:30:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.447
SUFF_SIMPLE for r=0.05 class 0.0 = 0.991 +- 0.488 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.145 +- 0.488 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.05 all KL = 0.457 +- 0.488 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.05 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.052)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.99 +- 0.487 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.146 +- 0.487 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.1 all KL = 0.457 +- 0.487 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.063)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
SUFF_SIMPLE for r=0.2 class 0.0 = 0.99 +- 0.487 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.145 +- 0.487 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 all KL = 0.455 +- 0.487 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.062)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.447
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.488 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.488 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.4 all KL = 0.457 +- 0.488 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.046)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013048
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.991 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.145 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.452 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.518 +- 0.423 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.49
SUFF_SIMPLE for r=0.05 class 0.0 = 0.832 +- 0.414 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.781 +- 0.414 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all KL = 0.769 +- 0.414 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all L1 = 0.807 +- 0.352 (in-sample avg dev_std = 0.145)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.831 +- 0.415 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.781 +- 0.415 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.1 all KL = 0.768 +- 0.415 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.1 all L1 = 0.806 +- 0.352 (in-sample avg dev_std = 0.143)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.489
SUFF_SIMPLE for r=0.2 class 0.0 = 0.832 +- 0.415 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.78 +- 0.415 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.2 all KL = 0.769 +- 0.415 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.2 all L1 = 0.806 +- 0.352 (in-sample avg dev_std = 0.146)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005054
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.85 +- 0.402 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.799 +- 0.402 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 all KL = 0.789 +- 0.402 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 all L1 = 0.825 +- 0.338 (in-sample avg dev_std = 0.137)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.505
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033212599999999995
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.489
SUFF_SIMPLE for r=0.8 class 0.0 = 0.976 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.947 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.956 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.169 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.5
NEC for r=0.05 class 0.0 = 0.012 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.768 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.495 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.431 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.482
NEC for r=0.1 class 0.0 = 0.013 +- 0.486 (in-sample avg dev_std = 0.124)
NEC for r=0.1 class 1.0 = 0.805 +- 0.486 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all KL = 0.523 +- 0.486 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all L1 = 0.452 +- 0.420 (in-sample avg dev_std = 0.124)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.468
NEC for r=0.2 class 0.0 = 0.021 +- 0.487 (in-sample avg dev_std = 0.169)
NEC for r=0.2 class 1.0 = 0.822 +- 0.487 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all KL = 0.536 +- 0.487 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all L1 = 0.465 +- 0.419 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.47
NEC for r=0.4 class 0.0 = 0.032 +- 0.484 (in-sample avg dev_std = 0.262)
NEC for r=0.4 class 1.0 = 0.822 +- 0.484 (in-sample avg dev_std = 0.262)
NEC for r=0.4 all KL = 0.55 +- 0.484 (in-sample avg dev_std = 0.262)
NEC for r=0.4 all L1 = 0.47 +- 0.414 (in-sample avg dev_std = 0.262)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013048
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.487
NEC for r=0.8 class 0.0 = 0.02 +- 0.481 (in-sample avg dev_std = 0.387)
NEC for r=0.8 class 1.0 = 0.827 +- 0.481 (in-sample avg dev_std = 0.387)
NEC for r=0.8 all KL = 0.555 +- 0.481 (in-sample avg dev_std = 0.387)
NEC for r=0.8 all L1 = 0.467 +- 0.407 (in-sample avg dev_std = 0.387)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.034 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.049 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.049 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.041 +- 0.170 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.054 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.067 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.071 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.061 +- 0.210 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.507
NEC for r=0.2 class 0.0 = 0.085 +- 0.309 (in-sample avg dev_std = 0.061)
NEC for r=0.2 class 1.0 = 0.106 +- 0.309 (in-sample avg dev_std = 0.061)
NEC for r=0.2 all KL = 0.114 +- 0.309 (in-sample avg dev_std = 0.061)
NEC for r=0.2 all L1 = 0.095 +- 0.262 (in-sample avg dev_std = 0.061)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005054
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.511
NEC for r=0.4 class 0.0 = 0.128 +- 0.373 (in-sample avg dev_std = 0.149)
NEC for r=0.4 class 1.0 = 0.163 +- 0.373 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all KL = 0.178 +- 0.373 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all L1 = 0.145 +- 0.313 (in-sample avg dev_std = 0.149)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.516
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033212599999999995
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.506
NEC for r=0.8 class 0.0 = 0.104 +- 0.353 (in-sample avg dev_std = 0.191)
NEC for r=0.8 class 1.0 = 0.144 +- 0.353 (in-sample avg dev_std = 0.191)
NEC for r=0.8 all KL = 0.154 +- 0.353 (in-sample avg dev_std = 0.191)
NEC for r=0.8 all L1 = 0.124 +- 0.290 (in-sample avg dev_std = 0.191)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 16:44:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 04:44:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.932 +- 0.473 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.141 +- 0.473 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.05 all KL = 0.434 +- 0.473 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.05 all L1 = 0.494 +- 0.405 (in-sample avg dev_std = 0.060)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.933 +- 0.474 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.141 +- 0.474 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all KL = 0.435 +- 0.474 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all L1 = 0.495 +- 0.405 (in-sample avg dev_std = 0.053)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.934 +- 0.475 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.141 +- 0.475 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.2 all KL = 0.436 +- 0.475 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.2 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.030)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.475 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.141 +- 0.475 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.4 all KL = 0.436 +- 0.475 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.4 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.024)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013047999999999999
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.933 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.141 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.431 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.491 +- 0.405 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.824 +- 0.416 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.771 +- 0.416 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 all KL = 0.759 +- 0.416 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 all L1 = 0.798 +- 0.354 (in-sample avg dev_std = 0.144)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.824 +- 0.416 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.771 +- 0.416 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all KL = 0.759 +- 0.416 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all L1 = 0.798 +- 0.354 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.825 +- 0.416 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.771 +- 0.416 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.2 all KL = 0.762 +- 0.416 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.2 all L1 = 0.798 +- 0.354 (in-sample avg dev_std = 0.140)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.842 +- 0.405 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.789 +- 0.405 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 all KL = 0.779 +- 0.405 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.4 all L1 = 0.816 +- 0.341 (in-sample avg dev_std = 0.137)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0332018
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.936 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.953 +- 0.184 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.066 +- 0.472 (in-sample avg dev_std = 0.046)
NEC for r=0.05 class 1.0 = 0.763 +- 0.472 (in-sample avg dev_std = 0.046)
NEC for r=0.05 all KL = 0.51 +- 0.472 (in-sample avg dev_std = 0.046)
NEC for r=0.05 all L1 = 0.452 +- 0.404 (in-sample avg dev_std = 0.046)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.486
NEC for r=0.1 class 0.0 = 0.069 +- 0.473 (in-sample avg dev_std = 0.115)
NEC for r=0.1 class 1.0 = 0.808 +- 0.473 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all KL = 0.541 +- 0.473 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all L1 = 0.478 +- 0.403 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.468
NEC for r=0.2 class 0.0 = 0.073 +- 0.475 (in-sample avg dev_std = 0.170)
NEC for r=0.2 class 1.0 = 0.827 +- 0.475 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all KL = 0.553 +- 0.475 (in-sample avg dev_std = 0.170)
NEC for r=0.2 all L1 = 0.491 +- 0.403 (in-sample avg dev_std = 0.170)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.47
NEC for r=0.4 class 0.0 = 0.08 +- 0.471 (in-sample avg dev_std = 0.252)
NEC for r=0.4 class 1.0 = 0.828 +- 0.471 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all KL = 0.563 +- 0.471 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all L1 = 0.494 +- 0.398 (in-sample avg dev_std = 0.252)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013047999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.48
NEC for r=0.8 class 0.0 = 0.078 +- 0.466 (in-sample avg dev_std = 0.369)
NEC for r=0.8 class 1.0 = 0.835 +- 0.466 (in-sample avg dev_std = 0.369)
NEC for r=0.8 all KL = 0.574 +- 0.466 (in-sample avg dev_std = 0.369)
NEC for r=0.8 all L1 = 0.497 +- 0.390 (in-sample avg dev_std = 0.369)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.509
NEC for r=0.05 class 0.0 = 0.039 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.059 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.056 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.049 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.059 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.078 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.081 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.068 +- 0.216 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.51
NEC for r=0.2 class 0.0 = 0.094 +- 0.315 (in-sample avg dev_std = 0.068)
NEC for r=0.2 class 1.0 = 0.114 +- 0.315 (in-sample avg dev_std = 0.068)
NEC for r=0.2 all KL = 0.124 +- 0.315 (in-sample avg dev_std = 0.068)
NEC for r=0.2 all L1 = 0.104 +- 0.267 (in-sample avg dev_std = 0.068)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.513
NEC for r=0.4 class 0.0 = 0.132 +- 0.376 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.171 +- 0.376 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.186 +- 0.376 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.151 +- 0.314 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.517
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0332018
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.506
NEC for r=0.8 class 0.0 = 0.11 +- 0.353 (in-sample avg dev_std = 0.181)
NEC for r=0.8 class 1.0 = 0.151 +- 0.353 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all KL = 0.158 +- 0.353 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all L1 = 0.13 +- 0.293 (in-sample avg dev_std = 0.181)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 16:59:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 04:59:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.032


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.948 +- 0.479 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.144 +- 0.479 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.05 all KL = 0.439 +- 0.479 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.05 all L1 = 0.503 +- 0.413 (in-sample avg dev_std = 0.043)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.949 +- 0.479 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.145 +- 0.479 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.1 all KL = 0.441 +- 0.479 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.1 all L1 = 0.503 +- 0.413 (in-sample avg dev_std = 0.062)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.2 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.2 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.003)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.4 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.022)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012206
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.949 +- 0.479 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.144 +- 0.479 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.436 +- 0.479 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.499 +- 0.413 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.828 +- 0.413 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.789 +- 0.413 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all KL = 0.77 +- 0.413 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all L1 = 0.809 +- 0.349 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.828 +- 0.413 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.788 +- 0.413 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.771 +- 0.413 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.808 +- 0.349 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.412 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.79 +- 0.412 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.2 all KL = 0.774 +- 0.412 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.2 all L1 = 0.81 +- 0.349 (in-sample avg dev_std = 0.140)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048786
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF_SIMPLE for r=0.4 class 0.0 = 0.85 +- 0.397 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.81 +- 0.397 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.4 all KL = 0.796 +- 0.397 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.4 all L1 = 0.83 +- 0.333 (in-sample avg dev_std = 0.127)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.503
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0316882
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.197 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.951 +- 0.197 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.956 +- 0.197 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.169 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.508
NEC for r=0.05 class 0.0 = 0.051 +- 0.478 (in-sample avg dev_std = 0.032)
NEC for r=0.05 class 1.0 = 0.777 +- 0.478 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all KL = 0.518 +- 0.478 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all L1 = 0.453 +- 0.413 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.479
NEC for r=0.1 class 0.0 = 0.051 +- 0.479 (in-sample avg dev_std = 0.112)
NEC for r=0.1 class 1.0 = 0.819 +- 0.479 (in-sample avg dev_std = 0.112)
NEC for r=0.1 all KL = 0.543 +- 0.479 (in-sample avg dev_std = 0.112)
NEC for r=0.1 all L1 = 0.476 +- 0.412 (in-sample avg dev_std = 0.112)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.464
NEC for r=0.2 class 0.0 = 0.062 +- 0.479 (in-sample avg dev_std = 0.138)
NEC for r=0.2 class 1.0 = 0.831 +- 0.479 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all KL = 0.554 +- 0.479 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all L1 = 0.488 +- 0.412 (in-sample avg dev_std = 0.138)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.463
NEC for r=0.4 class 0.0 = 0.074 +- 0.476 (in-sample avg dev_std = 0.236)
NEC for r=0.4 class 1.0 = 0.83 +- 0.476 (in-sample avg dev_std = 0.236)
NEC for r=0.4 all KL = 0.568 +- 0.476 (in-sample avg dev_std = 0.236)
NEC for r=0.4 all L1 = 0.493 +- 0.406 (in-sample avg dev_std = 0.236)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012206
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.479
NEC for r=0.8 class 0.0 = 0.059 +- 0.474 (in-sample avg dev_std = 0.343)
NEC for r=0.8 class 1.0 = 0.833 +- 0.474 (in-sample avg dev_std = 0.343)
NEC for r=0.8 all KL = 0.57 +- 0.474 (in-sample avg dev_std = 0.343)
NEC for r=0.8 all L1 = 0.488 +- 0.400 (in-sample avg dev_std = 0.343)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.502
NEC for r=0.05 class 0.0 = 0.036 +- 0.215 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.056 +- 0.215 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.054 +- 0.215 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.182 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.056 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.074 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.077 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.065 +- 0.219 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.088 +- 0.307 (in-sample avg dev_std = 0.059)
NEC for r=0.2 class 1.0 = 0.101 +- 0.307 (in-sample avg dev_std = 0.059)
NEC for r=0.2 all KL = 0.112 +- 0.307 (in-sample avg dev_std = 0.059)
NEC for r=0.2 all L1 = 0.094 +- 0.260 (in-sample avg dev_std = 0.059)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048786
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.127 +- 0.368 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.153 +- 0.368 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.17 +- 0.368 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.14 +- 0.307 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0316882
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.504
NEC for r=0.8 class 0.0 = 0.106 +- 0.346 (in-sample avg dev_std = 0.175)
NEC for r=0.8 class 1.0 = 0.135 +- 0.346 (in-sample avg dev_std = 0.175)
NEC for r=0.8 all KL = 0.146 +- 0.346 (in-sample avg dev_std = 0.175)
NEC for r=0.8 all L1 = 0.12 +- 0.286 (in-sample avg dev_std = 0.175)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 17:12:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 05:12:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.034


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.447
SUFF_SIMPLE for r=0.05 class 0.0 = 0.963 +- 0.484 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.139 +- 0.484 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all KL = 0.439 +- 0.484 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.05 all L1 = 0.506 +- 0.416 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.964 +- 0.485 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.139 +- 0.485 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.1 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.1 all L1 = 0.507 +- 0.416 (in-sample avg dev_std = 0.062)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
SUFF_SIMPLE for r=0.2 class 0.0 = 0.964 +- 0.485 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.139 +- 0.485 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.2 all KL = 0.44 +- 0.485 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.2 all L1 = 0.507 +- 0.416 (in-sample avg dev_std = 0.054)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.447
SUFF_SIMPLE for r=0.4 class 0.0 = 0.965 +- 0.485 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.4 all L1 = 0.507 +- 0.417 (in-sample avg dev_std = 0.044)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013253999999999998
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.436 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.503 +- 0.416 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.823 +- 0.425 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.758 +- 0.425 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 all KL = 0.745 +- 0.425 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.05 all L1 = 0.791 +- 0.360 (in-sample avg dev_std = 0.146)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.823 +- 0.426 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.758 +- 0.426 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.1 all KL = 0.747 +- 0.426 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.1 all L1 = 0.791 +- 0.361 (in-sample avg dev_std = 0.147)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009226000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.824 +- 0.425 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.759 +- 0.425 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.2 all KL = 0.751 +- 0.425 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.2 all L1 = 0.792 +- 0.361 (in-sample avg dev_std = 0.144)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0050878
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF_SIMPLE for r=0.4 class 0.0 = 0.844 +- 0.412 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.778 +- 0.412 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all KL = 0.773 +- 0.412 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all L1 = 0.811 +- 0.348 (in-sample avg dev_std = 0.136)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.515
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0335534
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.491
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.928 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.942 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.195 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.526
NEC for r=0.05 class 0.0 = 0.038 +- 0.484 (in-sample avg dev_std = 0.032)
NEC for r=0.05 class 1.0 = 0.74 +- 0.484 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all KL = 0.493 +- 0.484 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all L1 = 0.427 +- 0.416 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.039 +- 0.485 (in-sample avg dev_std = 0.123)
NEC for r=0.1 class 1.0 = 0.782 +- 0.485 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all KL = 0.52 +- 0.485 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all L1 = 0.451 +- 0.416 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.472
NEC for r=0.2 class 0.0 = 0.044 +- 0.483 (in-sample avg dev_std = 0.175)
NEC for r=0.2 class 1.0 = 0.823 +- 0.483 (in-sample avg dev_std = 0.175)
NEC for r=0.2 all KL = 0.549 +- 0.483 (in-sample avg dev_std = 0.175)
NEC for r=0.2 all L1 = 0.476 +- 0.412 (in-sample avg dev_std = 0.175)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.47
NEC for r=0.4 class 0.0 = 0.052 +- 0.483 (in-sample avg dev_std = 0.262)
NEC for r=0.4 class 1.0 = 0.827 +- 0.483 (in-sample avg dev_std = 0.262)
NEC for r=0.4 all KL = 0.56 +- 0.483 (in-sample avg dev_std = 0.262)
NEC for r=0.4 all L1 = 0.481 +- 0.409 (in-sample avg dev_std = 0.262)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013253999999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.48
NEC for r=0.8 class 0.0 = 0.047 +- 0.480 (in-sample avg dev_std = 0.365)
NEC for r=0.8 class 1.0 = 0.837 +- 0.480 (in-sample avg dev_std = 0.365)
NEC for r=0.8 all KL = 0.569 +- 0.480 (in-sample avg dev_std = 0.365)
NEC for r=0.8 all L1 = 0.485 +- 0.403 (in-sample avg dev_std = 0.365)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.038 +- 0.216 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.055 +- 0.216 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.057 +- 0.216 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.047 +- 0.181 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.511
NEC for r=0.1 class 0.0 = 0.059 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.077 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.08 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.068 +- 0.222 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009226000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.511
NEC for r=0.2 class 0.0 = 0.093 +- 0.323 (in-sample avg dev_std = 0.059)
NEC for r=0.2 class 1.0 = 0.119 +- 0.323 (in-sample avg dev_std = 0.059)
NEC for r=0.2 all KL = 0.127 +- 0.323 (in-sample avg dev_std = 0.059)
NEC for r=0.2 all L1 = 0.106 +- 0.274 (in-sample avg dev_std = 0.059)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0050878
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.514
NEC for r=0.4 class 0.0 = 0.133 +- 0.381 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.175 +- 0.381 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.188 +- 0.381 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.154 +- 0.320 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0335534
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.507
NEC for r=0.8 class 0.0 = 0.11 +- 0.363 (in-sample avg dev_std = 0.191)
NEC for r=0.8 class 1.0 = 0.16 +- 0.363 (in-sample avg dev_std = 0.191)
NEC for r=0.8 all KL = 0.167 +- 0.363 (in-sample avg dev_std = 0.191)
NEC for r=0.8 all L1 = 0.135 +- 0.300 (in-sample avg dev_std = 0.191)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 17:25:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 05:25:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.002
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.007
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.024
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.057
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.004
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.028
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.073


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.447
SUFF_SIMPLE for r=0.05 class 0.0 = 0.983 +- 0.491 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.137 +- 0.491 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.05 all KL = 0.445 +- 0.491 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.05 all L1 = 0.515 +- 0.422 (in-sample avg dev_std = 0.048)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.444
SUFF_SIMPLE for r=0.1 class 0.0 = 0.978 +- 0.490 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.137 +- 0.490 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all KL = 0.442 +- 0.490 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all L1 = 0.512 +- 0.422 (in-sample avg dev_std = 0.053)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.448
SUFF_SIMPLE for r=0.2 class 0.0 = 0.983 +- 0.491 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.14 +- 0.491 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all KL = 0.447 +- 0.491 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.2 all L1 = 0.516 +- 0.423 (in-sample avg dev_std = 0.014)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024214000000000003
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.464
SUFF_SIMPLE for r=0.4 class 0.0 = 0.983 +- 0.492 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.164 +- 0.492 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.4 all KL = 0.461 +- 0.492 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.4 all L1 = 0.529 +- 0.424 (in-sample avg dev_std = 0.008)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057266000000000004
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.514
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.238 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.502 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.569 +- 0.422 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.829 +- 0.418 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.775 +- 0.418 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 all KL = 0.766 +- 0.418 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.05 all L1 = 0.802 +- 0.355 (in-sample avg dev_std = 0.147)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.83 +- 0.416 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.776 +- 0.416 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all KL = 0.768 +- 0.416 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all L1 = 0.803 +- 0.354 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.493
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.417 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.777 +- 0.417 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all KL = 0.767 +- 0.417 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all L1 = 0.804 +- 0.353 (in-sample avg dev_std = 0.154)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0279488
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.506
SUFF_SIMPLE for r=0.4 class 0.0 = 0.86 +- 0.380 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.827 +- 0.380 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.4 all KL = 0.817 +- 0.380 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.4 all L1 = 0.844 +- 0.326 (in-sample avg dev_std = 0.066)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.516
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07271140000000001
len(reference) = 4915
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.514
SUFF_SIMPLE for r=0.8 class 0.0 = 0.959 +- 0.234 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.93 +- 0.234 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.935 +- 0.234 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.200 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.019 +- 0.490 (in-sample avg dev_std = 0.033)
NEC for r=0.05 class 1.0 = 0.779 +- 0.490 (in-sample avg dev_std = 0.033)
NEC for r=0.05 all KL = 0.51 +- 0.490 (in-sample avg dev_std = 0.033)
NEC for r=0.05 all L1 = 0.44 +- 0.421 (in-sample avg dev_std = 0.033)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.48
NEC for r=0.1 class 0.0 = 0.021 +- 0.490 (in-sample avg dev_std = 0.091)
NEC for r=0.1 class 1.0 = 0.816 +- 0.490 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all KL = 0.534 +- 0.490 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all L1 = 0.461 +- 0.420 (in-sample avg dev_std = 0.091)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.478
NEC for r=0.2 class 0.0 = 0.027 +- 0.490 (in-sample avg dev_std = 0.199)
NEC for r=0.2 class 1.0 = 0.819 +- 0.490 (in-sample avg dev_std = 0.199)
NEC for r=0.2 all KL = 0.541 +- 0.490 (in-sample avg dev_std = 0.199)
NEC for r=0.2 all L1 = 0.466 +- 0.418 (in-sample avg dev_std = 0.199)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024214000000000003
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.468
NEC for r=0.4 class 0.0 = 0.034 +- 0.487 (in-sample avg dev_std = 0.300)
NEC for r=0.4 class 1.0 = 0.842 +- 0.487 (in-sample avg dev_std = 0.300)
NEC for r=0.4 all KL = 0.566 +- 0.487 (in-sample avg dev_std = 0.300)
NEC for r=0.4 all L1 = 0.482 +- 0.412 (in-sample avg dev_std = 0.300)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057266000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.47
NEC for r=0.8 class 0.0 = 0.023 +- 0.487 (in-sample avg dev_std = 0.312)
NEC for r=0.8 class 1.0 = 0.848 +- 0.487 (in-sample avg dev_std = 0.312)
NEC for r=0.8 all KL = 0.562 +- 0.487 (in-sample avg dev_std = 0.312)
NEC for r=0.8 all L1 = 0.48 +- 0.413 (in-sample avg dev_std = 0.312)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.509
NEC for r=0.05 class 0.0 = 0.042 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.079 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.071 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.061 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.512
NEC for r=0.1 class 0.0 = 0.063 +- 0.287 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.102 +- 0.287 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.098 +- 0.287 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.083 +- 0.245 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.513
NEC for r=0.2 class 0.0 = 0.104 +- 0.348 (in-sample avg dev_std = 0.126)
NEC for r=0.2 class 1.0 = 0.142 +- 0.348 (in-sample avg dev_std = 0.126)
NEC for r=0.2 all KL = 0.15 +- 0.348 (in-sample avg dev_std = 0.126)
NEC for r=0.2 all L1 = 0.123 +- 0.290 (in-sample avg dev_std = 0.126)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0279488
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.507
NEC for r=0.4 class 0.0 = 0.128 +- 0.370 (in-sample avg dev_std = 0.166)
NEC for r=0.4 class 1.0 = 0.153 +- 0.370 (in-sample avg dev_std = 0.166)
NEC for r=0.4 all KL = 0.173 +- 0.370 (in-sample avg dev_std = 0.166)
NEC for r=0.4 all L1 = 0.141 +- 0.307 (in-sample avg dev_std = 0.166)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.52
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07271140000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.487
NEC for r=0.8 class 0.0 = 0.103 +- 0.359 (in-sample avg dev_std = 0.173)
NEC for r=0.8 class 1.0 = 0.159 +- 0.359 (in-sample avg dev_std = 0.173)
NEC for r=0.8 all KL = 0.162 +- 0.359 (in-sample avg dev_std = 0.173)
NEC for r=0.8 all L1 = 0.131 +- 0.297 (in-sample avg dev_std = 0.173)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 17:38:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 05:38:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.973 +- 0.485 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.143 +- 0.485 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.05 all KL = 0.448 +- 0.485 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.05 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.050)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.2 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.023)
SUFF_SIMPLE for r=0.2 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.023)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.4 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.4 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.030)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013007999999999999
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.445 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.51 +- 0.417 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.491
SUFF_SIMPLE for r=0.05 class 0.0 = 0.827 +- 0.414 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.781 +- 0.414 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all KL = 0.767 +- 0.414 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.827 +- 0.414 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.782 +- 0.414 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 all KL = 0.768 +- 0.414 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 all L1 = 0.805 +- 0.352 (in-sample avg dev_std = 0.145)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.49
SUFF_SIMPLE for r=0.2 class 0.0 = 0.828 +- 0.415 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.78 +- 0.415 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.2 all KL = 0.768 +- 0.415 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.2 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.150)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
SUFF_SIMPLE for r=0.4 class 0.0 = 0.847 +- 0.400 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.802 +- 0.400 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.4 all KL = 0.79 +- 0.400 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.4 all L1 = 0.825 +- 0.337 (in-sample avg dev_std = 0.134)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.506
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033146
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.491
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.945 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.952 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.959 +- 0.175 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.03 +- 0.484 (in-sample avg dev_std = 0.041)
NEC for r=0.05 class 1.0 = 0.769 +- 0.484 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all KL = 0.503 +- 0.484 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all L1 = 0.439 +- 0.416 (in-sample avg dev_std = 0.041)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.478
NEC for r=0.1 class 0.0 = 0.029 +- 0.484 (in-sample avg dev_std = 0.112)
NEC for r=0.1 class 1.0 = 0.815 +- 0.484 (in-sample avg dev_std = 0.112)
NEC for r=0.1 all KL = 0.532 +- 0.484 (in-sample avg dev_std = 0.112)
NEC for r=0.1 all L1 = 0.464 +- 0.414 (in-sample avg dev_std = 0.112)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.462
NEC for r=0.2 class 0.0 = 0.036 +- 0.485 (in-sample avg dev_std = 0.162)
NEC for r=0.2 class 1.0 = 0.83 +- 0.485 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all KL = 0.543 +- 0.485 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all L1 = 0.476 +- 0.415 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.46
NEC for r=0.4 class 0.0 = 0.048 +- 0.482 (in-sample avg dev_std = 0.233)
NEC for r=0.4 class 1.0 = 0.832 +- 0.482 (in-sample avg dev_std = 0.233)
NEC for r=0.4 all KL = 0.558 +- 0.482 (in-sample avg dev_std = 0.233)
NEC for r=0.4 all L1 = 0.482 +- 0.409 (in-sample avg dev_std = 0.233)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013007999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.482
NEC for r=0.8 class 0.0 = 0.036 +- 0.479 (in-sample avg dev_std = 0.375)
NEC for r=0.8 class 1.0 = 0.834 +- 0.479 (in-sample avg dev_std = 0.375)
NEC for r=0.8 all KL = 0.563 +- 0.479 (in-sample avg dev_std = 0.375)
NEC for r=0.8 all L1 = 0.478 +- 0.402 (in-sample avg dev_std = 0.375)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.039 +- 0.219 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.062 +- 0.219 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.057 +- 0.219 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.05 +- 0.189 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.502
NEC for r=0.1 class 0.0 = 0.06 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.081 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.083 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.071 +- 0.226 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.507
NEC for r=0.2 class 0.0 = 0.093 +- 0.316 (in-sample avg dev_std = 0.075)
NEC for r=0.2 class 1.0 = 0.109 +- 0.316 (in-sample avg dev_std = 0.075)
NEC for r=0.2 all KL = 0.12 +- 0.316 (in-sample avg dev_std = 0.075)
NEC for r=0.2 all L1 = 0.101 +- 0.266 (in-sample avg dev_std = 0.075)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.511
NEC for r=0.4 class 0.0 = 0.13 +- 0.372 (in-sample avg dev_std = 0.151)
NEC for r=0.4 class 1.0 = 0.161 +- 0.372 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all KL = 0.176 +- 0.372 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all L1 = 0.145 +- 0.311 (in-sample avg dev_std = 0.151)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.511
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033146
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.505
NEC for r=0.8 class 0.0 = 0.106 +- 0.349 (in-sample avg dev_std = 0.180)
NEC for r=0.8 class 1.0 = 0.139 +- 0.349 (in-sample avg dev_std = 0.180)
NEC for r=0.8 all KL = 0.151 +- 0.349 (in-sample avg dev_std = 0.180)
NEC for r=0.8 all L1 = 0.123 +- 0.288 (in-sample avg dev_std = 0.180)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.454, 0.454, 0.454, 0.454, 0.449], 'all_L1': [0.52, 0.52, 0.521, 0.52, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.43, 0.429, 0.433, 0.449, 0.494], 'all_L1': [0.496, 0.495, 0.498, 0.512, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.447, 0.447, 0.447, 0.447, 0.443], 'all_L1': [0.509, 0.509, 0.509, 0.509, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.457, 0.458, 0.458, 0.458, 0.454], 'all_L1': [0.522, 0.522, 0.522, 0.522, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.457, 0.457, 0.455, 0.457, 0.452], 'all_L1': [0.522, 0.522, 0.522, 0.522, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.434, 0.435, 0.436, 0.436, 0.431], 'all_L1': [0.494, 0.495, 0.494, 0.494, 0.491]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.441, 0.441, 0.441, 0.436], 'all_L1': [0.503, 0.503, 0.503, 0.503, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.441, 0.44, 0.441, 0.436], 'all_L1': [0.506, 0.507, 0.507, 0.507, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.445, 0.442, 0.447, 0.461, 0.502], 'all_L1': [0.515, 0.512, 0.516, 0.529, 0.569]}), defaultdict(<class 'list'>, {'all_KL': [0.448, 0.449, 0.449, 0.449, 0.445], 'all_L1': [0.513, 0.513, 0.513, 0.513, 0.51]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.493, 0.526, 0.539, 0.554, 0.561], 'all_L1': [0.429, 0.456, 0.469, 0.475, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.512, 0.546, 0.555, 0.576, 0.573], 'all_L1': [0.446, 0.475, 0.483, 0.497, 0.494]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.539, 0.546, 0.556, 0.56], 'all_L1': [0.449, 0.476, 0.482, 0.486, 0.485]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.516, 0.536, 0.547, 0.549], 'all_L1': [0.425, 0.448, 0.468, 0.47, 0.469]}), defaultdict(<class 'list'>, {'all_KL': [0.495, 0.523, 0.536, 0.55, 0.555], 'all_L1': [0.431, 0.452, 0.465, 0.47, 0.467]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.541, 0.553, 0.563, 0.574], 'all_L1': [0.452, 0.478, 0.491, 0.494, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.518, 0.543, 0.554, 0.568, 0.57], 'all_L1': [0.453, 0.476, 0.488, 0.493, 0.488]}), defaultdict(<class 'list'>, {'all_KL': [0.493, 0.52, 0.549, 0.56, 0.569], 'all_L1': [0.427, 0.451, 0.476, 0.481, 0.485]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.534, 0.541, 0.566, 0.562], 'all_L1': [0.44, 0.461, 0.466, 0.482, 0.48]}), defaultdict(<class 'list'>, {'all_KL': [0.503, 0.532, 0.543, 0.558, 0.563], 'all_L1': [0.439, 0.464, 0.476, 0.482, 0.478]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.582, 0.582, 0.582, 0.582, 0.582], 'all_L1': [0.615, 0.615, 0.615, 0.615, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.758, 0.758, 0.758, 0.758, 0.758], 'all_L1': [0.768, 0.768, 0.768, 0.768, 0.768]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.639, 0.639, 0.639, 0.639], 'all_L1': [0.658, 0.658, 0.658, 0.658, 0.658]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.868, 0.868, 0.868, 0.868], 'all_L1': [0.867, 0.867, 0.867, 0.867, 0.867]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.721, 0.721, 0.721, 0.721], 'all_L1': [0.734, 0.734, 0.734, 0.734, 0.734]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.786, 0.786, 0.786, 0.786], 'all_L1': [0.784, 0.784, 0.784, 0.784, 0.784]}), defaultdict(<class 'list'>, {'all_KL': [0.344, 0.344, 0.344, 0.344, 0.344], 'all_L1': [0.407, 0.407, 0.407, 0.407, 0.407]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.921, 0.921, 0.921, 0.921], 'all_L1': [0.918, 0.918, 0.918, 0.918, 0.918]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.941, 0.941, 0.941, 0.941], 'all_L1': [0.938, 0.938, 0.938, 0.938, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.945, 0.945, 0.945, 0.945], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.418, 0.418, 0.418, 0.418, 0.418], 'all_L1': [0.385, 0.385, 0.385, 0.385, 0.385]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.242, 0.242, 0.242, 0.242], 'all_L1': [0.232, 0.232, 0.232, 0.232, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.361, 0.361, 0.361, 0.361], 'all_L1': [0.342, 0.342, 0.342, 0.342, 0.342]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.132, 0.132, 0.132, 0.132], 'all_L1': [0.133, 0.133, 0.133, 0.133, 0.133]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.279, 0.279, 0.279, 0.279], 'all_L1': [0.266, 0.266, 0.266, 0.266, 0.266]}), defaultdict(<class 'list'>, {'all_KL': [0.214, 0.214, 0.214, 0.214, 0.214], 'all_L1': [0.216, 0.216, 0.216, 0.216, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.656, 0.656, 0.656, 0.656], 'all_L1': [0.593, 0.593, 0.593, 0.593, 0.593]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.079, 0.079, 0.079], 'all_L1': [0.082, 0.082, 0.082, 0.082, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.059, 0.059, 0.059, 0.059, 0.059], 'all_L1': [0.062, 0.062, 0.062, 0.062, 0.062]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.055, 0.055, 0.055, 0.055], 'all_L1': [0.056, 0.056, 0.056, 0.056, 0.056]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.758, 0.758, 0.759, 0.777, 0.95], 'all_L1': [0.798, 0.798, 0.798, 0.815, 0.956]}), defaultdict(<class 'list'>, {'all_KL': [0.757, 0.757, 0.758, 0.801, 0.927], 'all_L1': [0.793, 0.794, 0.795, 0.831, 0.939]}), defaultdict(<class 'list'>, {'all_KL': [0.77, 0.771, 0.771, 0.791, 0.951], 'all_L1': [0.807, 0.807, 0.807, 0.826, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.767, 0.766, 0.767, 0.786, 0.95], 'all_L1': [0.804, 0.803, 0.804, 0.823, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.769, 0.768, 0.769, 0.789, 0.956], 'all_L1': [0.807, 0.806, 0.806, 0.825, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.759, 0.759, 0.762, 0.779, 0.947], 'all_L1': [0.798, 0.798, 0.798, 0.816, 0.953]}), defaultdict(<class 'list'>, {'all_KL': [0.77, 0.771, 0.774, 0.796, 0.956], 'all_L1': [0.809, 0.808, 0.81, 0.83, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.747, 0.751, 0.773, 0.942], 'all_L1': [0.791, 0.791, 0.792, 0.811, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [0.766, 0.768, 0.767, 0.817, 0.935], 'all_L1': [0.802, 0.803, 0.804, 0.844, 0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.767, 0.768, 0.768, 0.79, 0.952], 'all_L1': [0.804, 0.805, 0.804, 0.825, 0.959]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.052, 0.076, 0.123, 0.187, 0.158], 'all_L1': [0.044, 0.063, 0.103, 0.153, 0.128]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.103, 0.159, 0.182, 0.17], 'all_L1': [0.065, 0.086, 0.129, 0.147, 0.139]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.081, 0.116, 0.177, 0.147], 'all_L1': [0.049, 0.068, 0.097, 0.144, 0.121]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.081, 0.118, 0.175, 0.152], 'all_L1': [0.05, 0.07, 0.099, 0.144, 0.124]}), defaultdict(<class 'list'>, {'all_KL': [0.049, 0.071, 0.114, 0.178, 0.154], 'all_L1': [0.041, 0.061, 0.095, 0.145, 0.124]}), defaultdict(<class 'list'>, {'all_KL': [0.056, 0.081, 0.124, 0.186, 0.158], 'all_L1': [0.049, 0.068, 0.104, 0.151, 0.13]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.077, 0.112, 0.17, 0.146], 'all_L1': [0.046, 0.065, 0.094, 0.14, 0.12]}), defaultdict(<class 'list'>, {'all_KL': [0.057, 0.08, 0.127, 0.188, 0.167], 'all_L1': [0.047, 0.068, 0.106, 0.154, 0.135]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.098, 0.15, 0.173, 0.162], 'all_L1': [0.061, 0.083, 0.123, 0.141, 0.131]}), defaultdict(<class 'list'>, {'all_KL': [0.057, 0.083, 0.12, 0.176, 0.151], 'all_L1': [0.05, 0.071, 0.101, 0.145, 0.123]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.510 +- 0.010, 0.510 +- 0.010, 0.510 +- 0.010, 0.513 +- 0.010, 0.519 +- 0.024
suff_simple class all_KL  =  0.445 +- 0.009, 0.445 +- 0.009, 0.446 +- 0.008, 0.449 +- 0.008, 0.454 +- 0.023
suff_simple_acc_int  =  0.446 +- 0.000, 0.446 +- 0.001, 0.447 +- 0.001, 0.450 +- 0.007, 0.457 +- 0.031
nec class all_L1  =  0.439 +- 0.010, 0.464 +- 0.011, 0.476 +- 0.009, 0.483 +- 0.009, 0.481 +- 0.010
nec class all_KL  =  0.503 +- 0.010, 0.532 +- 0.010, 0.545 +- 0.007, 0.560 +- 0.008, 0.564 +- 0.008
nec_acc_int  =  0.510 +- 0.008, 0.483 +- 0.008, 0.468 +- 0.006, 0.466 +- 0.004, 0.479 +- 0.005

Eval split val
suff_simple class all_L1  =  0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161
suff_simple class all_KL  =  0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180
suff_simple_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000
nec class all_L1  =  0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161
nec class all_KL  =  0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180
nec_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000

Eval split test
suff_simple class all_L1  =  0.801 +- 0.006, 0.801 +- 0.005, 0.802 +- 0.005, 0.825 +- 0.009, 0.954 +- 0.007
suff_simple class all_KL  =  0.763 +- 0.008, 0.763 +- 0.007, 0.765 +- 0.007, 0.790 +- 0.012, 0.947 +- 0.009
suff_simple_acc_int  =  0.491 +- 0.001, 0.491 +- 0.001, 0.491 +- 0.001, 0.495 +- 0.005, 0.495 +- 0.010
nec class all_L1  =  0.050 +- 0.007, 0.070 +- 0.008, 0.105 +- 0.011, 0.146 +- 0.005, 0.128 +- 0.006
nec class all_KL  =  0.059 +- 0.008, 0.083 +- 0.009, 0.126 +- 0.015, 0.179 +- 0.006, 0.157 +- 0.008
nec_acc_int  =  0.507 +- 0.004, 0.507 +- 0.005, 0.509 +- 0.004, 0.511 +- 0.002, 0.502 +- 0.007


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.475 +- 0.004, 0.487 +- 0.003, 0.493 +- 0.002, 0.498 +- 0.004, 0.500 +- 0.013
Faith. Armon (L1)= 		  =  0.472 +- 0.004, 0.485 +- 0.004, 0.493 +- 0.002, 0.497 +- 0.004, 0.499 +- 0.012
Faith. GMean (L1)= 	  =  0.473 +- 0.004, 0.486 +- 0.004, 0.493 +- 0.002, 0.498 +- 0.004, 0.500 +- 0.012
Faith. Aritm (KL)= 		  =  0.474 +- 0.004, 0.489 +- 0.003, 0.496 +- 0.001, 0.505 +- 0.004, 0.509 +- 0.012
Faith. Armon (KL)= 		  =  0.472 +- 0.004, 0.485 +- 0.004, 0.491 +- 0.002, 0.498 +- 0.005, 0.503 +- 0.014
Faith. GMean (KL)= 	  =  0.473 +- 0.004, 0.487 +- 0.003, 0.493 +- 0.002, 0.501 +- 0.005, 0.506 +- 0.013

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000
Faith. Armon (L1)= 		  =  0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140
Faith. GMean (L1)= 	  =  0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097
Faith. Aritm (KL)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000
Faith. Armon (KL)= 		  =  0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142
Faith. GMean (KL)= 	  =  0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099

Eval split test
Faith. Aritm (L1)= 		  =  0.426 +- 0.004, 0.436 +- 0.004, 0.453 +- 0.005, 0.486 +- 0.003, 0.541 +- 0.002
Faith. Armon (L1)= 		  =  0.094 +- 0.012, 0.129 +- 0.013, 0.186 +- 0.017, 0.249 +- 0.006, 0.225 +- 0.009
Faith. GMean (L1)= 	  =  0.200 +- 0.013, 0.237 +- 0.012, 0.290 +- 0.014, 0.347 +- 0.004, 0.349 +- 0.007
Faith. Aritm (KL)= 		  =  0.411 +- 0.005, 0.423 +- 0.006, 0.445 +- 0.007, 0.485 +- 0.005, 0.552 +- 0.002
Faith. Armon (KL)= 		  =  0.109 +- 0.014, 0.150 +- 0.015, 0.216 +- 0.021, 0.292 +- 0.007, 0.268 +- 0.011
Faith. GMean (KL)= 	  =  0.211 +- 0.014, 0.251 +- 0.014, 0.310 +- 0.017, 0.376 +- 0.005, 0.385 +- 0.008
Computed for split load_split = id



Completed in  2:16:52.358968  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 17:50:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 05:50:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.029
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.035
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.020
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.030
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.046


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.488 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.05 all KL = 0.453 +- 0.488 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.05 all L1 = 0.52 +- 0.422 (in-sample avg dev_std = 0.035)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012716000000000002
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.987 +- 0.488 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.1 all KL = 0.452 +- 0.488 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.1 all L1 = 0.519 +- 0.422 (in-sample avg dev_std = 0.045)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02169
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.445
SUFF_SIMPLE for r=0.2 class 0.0 = 0.985 +- 0.488 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.2 all KL = 0.452 +- 0.488 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.2 all L1 = 0.519 +- 0.422 (in-sample avg dev_std = 0.064)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028654000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.989 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.454 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.52 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034980000000000004
len(reference) = 497
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.449
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.153 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.457 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.523 +- 0.423 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023496
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0028454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019380000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010522
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005406
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0082018
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.491
SUFF_SIMPLE for r=0.05 class 0.0 = 0.826 +- 0.419 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.773 +- 0.419 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all KL = 0.763 +- 0.419 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.05 all L1 = 0.8 +- 0.355 (in-sample avg dev_std = 0.148)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012098600000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.826 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.774 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 all KL = 0.763 +- 0.419 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 all L1 = 0.8 +- 0.355 (in-sample avg dev_std = 0.152)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0198236
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.827 +- 0.418 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.774 +- 0.418 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.2 all KL = 0.765 +- 0.418 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.2 all L1 = 0.801 +- 0.355 (in-sample avg dev_std = 0.144)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0301872
len(reference) = 4996
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF_SIMPLE for r=0.4 class 0.0 = 0.837 +- 0.415 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.775 +- 0.415 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all KL = 0.77 +- 0.415 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.4 all L1 = 0.806 +- 0.351 (in-sample avg dev_std = 0.136)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.512
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0462344
len(reference) = 4874
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.473
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.261 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.898 +- 0.261 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.922 +- 0.261 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.933 +- 0.224 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.511
NEC for r=0.05 class 0.0 = 0.021 +- 0.487 (in-sample avg dev_std = 0.044)
NEC for r=0.05 class 1.0 = 0.748 +- 0.487 (in-sample avg dev_std = 0.044)
NEC for r=0.05 all KL = 0.488 +- 0.487 (in-sample avg dev_std = 0.044)
NEC for r=0.05 all L1 = 0.424 +- 0.421 (in-sample avg dev_std = 0.044)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012716000000000002
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.484
NEC for r=0.1 class 0.0 = 0.027 +- 0.485 (in-sample avg dev_std = 0.127)
NEC for r=0.1 class 1.0 = 0.794 +- 0.485 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all KL = 0.524 +- 0.485 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all L1 = 0.452 +- 0.418 (in-sample avg dev_std = 0.127)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02169
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.468
NEC for r=0.2 class 0.0 = 0.025 +- 0.488 (in-sample avg dev_std = 0.208)
NEC for r=0.2 class 1.0 = 0.827 +- 0.488 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all KL = 0.541 +- 0.488 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all L1 = 0.469 +- 0.418 (in-sample avg dev_std = 0.208)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028654000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.47
NEC for r=0.4 class 0.0 = 0.022 +- 0.487 (in-sample avg dev_std = 0.272)
NEC for r=0.4 class 1.0 = 0.833 +- 0.487 (in-sample avg dev_std = 0.272)
NEC for r=0.4 all KL = 0.548 +- 0.487 (in-sample avg dev_std = 0.272)
NEC for r=0.4 all L1 = 0.471 +- 0.415 (in-sample avg dev_std = 0.272)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034980000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.466
NEC for r=0.8 class 0.0 = 0.02 +- 0.483 (in-sample avg dev_std = 0.294)
NEC for r=0.8 class 1.0 = 0.844 +- 0.483 (in-sample avg dev_std = 0.294)
NEC for r=0.8 all KL = 0.557 +- 0.483 (in-sample avg dev_std = 0.294)
NEC for r=0.8 all L1 = 0.476 +- 0.413 (in-sample avg dev_std = 0.294)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023496
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0028454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019380000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010522
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005406
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0082018
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.042 +- 0.240 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.074 +- 0.240 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.069 +- 0.240 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.058 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012098600000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.062 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.098 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.093 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.08 +- 0.241 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0198236
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.499
NEC for r=0.2 class 0.0 = 0.102 +- 0.344 (in-sample avg dev_std = 0.077)
NEC for r=0.2 class 1.0 = 0.142 +- 0.344 (in-sample avg dev_std = 0.077)
NEC for r=0.2 all KL = 0.145 +- 0.344 (in-sample avg dev_std = 0.077)
NEC for r=0.2 all L1 = 0.122 +- 0.291 (in-sample avg dev_std = 0.077)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0301872
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
NEC for r=0.4 class 0.0 = 0.125 +- 0.370 (in-sample avg dev_std = 0.163)
NEC for r=0.4 class 1.0 = 0.157 +- 0.370 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all KL = 0.172 +- 0.370 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all L1 = 0.141 +- 0.306 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.519
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0462344
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.493
NEC for r=0.8 class 0.0 = 0.108 +- 0.360 (in-sample avg dev_std = 0.190)
NEC for r=0.8 class 1.0 = 0.151 +- 0.360 (in-sample avg dev_std = 0.190)
NEC for r=0.8 all KL = 0.161 +- 0.360 (in-sample avg dev_std = 0.190)
NEC for r=0.8 all L1 = 0.129 +- 0.294 (in-sample avg dev_std = 0.190)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 18:03:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 06:03:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.001
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.004
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.014
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.051
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.001
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.006
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.020
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.058


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000876
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.943 +- 0.482 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.137 +- 0.482 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.05 all KL = 0.43 +- 0.482 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.05 all L1 = 0.496 +- 0.412 (in-sample avg dev_std = 0.045)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.00073
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.137 +- 0.483 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all KL = 0.431 +- 0.483 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.1 all L1 = 0.497 +- 0.412 (in-sample avg dev_std = 0.053)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.003902
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
SUFF_SIMPLE for r=0.2 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.137 +- 0.483 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.2 all KL = 0.431 +- 0.483 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.2 all L1 = 0.497 +- 0.412 (in-sample avg dev_std = 0.047)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.014376
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.136 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.431 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.497 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.050894
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.459
SUFF_SIMPLE for r=0.8 class 0.0 = 0.94 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.158 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.439 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.506 +- 0.413 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.9e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006433999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.822 +- 0.423 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.764 +- 0.423 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all KL = 0.756 +- 0.423 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.135)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001472
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.822 +- 0.424 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.762 +- 0.424 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.1 all KL = 0.756 +- 0.424 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.1 all L1 = 0.792 +- 0.361 (in-sample avg dev_std = 0.142)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.005711
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.823 +- 0.423 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.765 +- 0.423 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all KL = 0.757 +- 0.423 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all L1 = 0.794 +- 0.359 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0203982
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.838 +- 0.412 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.778 +- 0.412 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all KL = 0.773 +- 0.412 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all L1 = 0.808 +- 0.350 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.518
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0577382
len(reference) = 4916
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.479
SUFF_SIMPLE for r=0.8 class 0.0 = 0.944 +- 0.300 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.871 +- 0.300 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.894 +- 0.300 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.907 +- 0.260 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000876
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.052 +- 0.484 (in-sample avg dev_std = 0.011)
NEC for r=0.05 class 1.0 = 0.783 +- 0.484 (in-sample avg dev_std = 0.011)
NEC for r=0.05 all KL = 0.522 +- 0.484 (in-sample avg dev_std = 0.011)
NEC for r=0.05 all L1 = 0.457 +- 0.414 (in-sample avg dev_std = 0.011)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.00073
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.492
NEC for r=0.1 class 0.0 = 0.057 +- 0.484 (in-sample avg dev_std = 0.122)
NEC for r=0.1 class 1.0 = 0.801 +- 0.484 (in-sample avg dev_std = 0.122)
NEC for r=0.1 all KL = 0.537 +- 0.484 (in-sample avg dev_std = 0.122)
NEC for r=0.1 all L1 = 0.469 +- 0.413 (in-sample avg dev_std = 0.122)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.003902
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.464
NEC for r=0.2 class 0.0 = 0.071 +- 0.478 (in-sample avg dev_std = 0.184)
NEC for r=0.2 class 1.0 = 0.836 +- 0.478 (in-sample avg dev_std = 0.184)
NEC for r=0.2 all KL = 0.569 +- 0.478 (in-sample avg dev_std = 0.184)
NEC for r=0.2 all L1 = 0.495 +- 0.407 (in-sample avg dev_std = 0.184)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.014376
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.465
NEC for r=0.4 class 0.0 = 0.065 +- 0.480 (in-sample avg dev_std = 0.278)
NEC for r=0.4 class 1.0 = 0.84 +- 0.480 (in-sample avg dev_std = 0.278)
NEC for r=0.4 all KL = 0.573 +- 0.480 (in-sample avg dev_std = 0.278)
NEC for r=0.4 all L1 = 0.494 +- 0.403 (in-sample avg dev_std = 0.278)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.050894
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.473
NEC for r=0.8 class 0.0 = 0.062 +- 0.478 (in-sample avg dev_std = 0.325)
NEC for r=0.8 class 1.0 = 0.846 +- 0.478 (in-sample avg dev_std = 0.325)
NEC for r=0.8 all KL = 0.576 +- 0.478 (in-sample avg dev_std = 0.325)
NEC for r=0.8 all L1 = 0.497 +- 0.402 (in-sample avg dev_std = 0.325)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.9e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006433999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.049 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.069 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.069 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.059 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001472
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.514
NEC for r=0.1 class 0.0 = 0.072 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.09 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.096 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.081 +- 0.242 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.005711
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.506
NEC for r=0.2 class 0.0 = 0.115 +- 0.356 (in-sample avg dev_std = 0.112)
NEC for r=0.2 class 1.0 = 0.144 +- 0.356 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all KL = 0.159 +- 0.356 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all L1 = 0.129 +- 0.296 (in-sample avg dev_std = 0.112)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0203982
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.494
NEC for r=0.4 class 0.0 = 0.131 +- 0.370 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.156 +- 0.370 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.173 +- 0.370 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.144 +- 0.311 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.523
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0577382
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.489
NEC for r=0.8 class 0.0 = 0.109 +- 0.367 (in-sample avg dev_std = 0.176)
NEC for r=0.8 class 1.0 = 0.168 +- 0.367 (in-sample avg dev_std = 0.176)
NEC for r=0.8 all KL = 0.169 +- 0.367 (in-sample avg dev_std = 0.176)
NEC for r=0.8 all L1 = 0.138 +- 0.304 (in-sample avg dev_std = 0.176)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 18:16:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 06:16:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.015
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.025
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.021
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.032
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.048


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008884
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.003)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.015101999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.025342000000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03263
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.4 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.4 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.030)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037082000000000004
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.448
SUFF_SIMPLE for r=0.8 class 0.0 = 0.958 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.151 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.447 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.509 +- 0.414 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0027492000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031244
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.002121
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0011612
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005922
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089108
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.828 +- 0.411 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.789 +- 0.411 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all KL = 0.775 +- 0.411 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.05 all L1 = 0.808 +- 0.350 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0136316
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.827 +- 0.412 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.788 +- 0.412 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all KL = 0.774 +- 0.412 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all L1 = 0.808 +- 0.350 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0205622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.828 +- 0.411 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.789 +- 0.411 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all KL = 0.775 +- 0.411 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all L1 = 0.809 +- 0.350 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0319246
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF_SIMPLE for r=0.4 class 0.0 = 0.838 +- 0.407 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.79 +- 0.407 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.4 all KL = 0.782 +- 0.407 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.4 all L1 = 0.815 +- 0.346 (in-sample avg dev_std = 0.123)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.504
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047616399999999996
len(reference) = 4866
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.966 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.913 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.93 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.94 +- 0.212 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008884
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.037 +- 0.479 (in-sample avg dev_std = 0.076)
NEC for r=0.05 class 1.0 = 0.777 +- 0.479 (in-sample avg dev_std = 0.076)
NEC for r=0.05 all KL = 0.509 +- 0.479 (in-sample avg dev_std = 0.076)
NEC for r=0.05 all L1 = 0.447 +- 0.411 (in-sample avg dev_std = 0.076)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.015101999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.487
NEC for r=0.1 class 0.0 = 0.038 +- 0.481 (in-sample avg dev_std = 0.154)
NEC for r=0.1 class 1.0 = 0.801 +- 0.481 (in-sample avg dev_std = 0.154)
NEC for r=0.1 all KL = 0.525 +- 0.481 (in-sample avg dev_std = 0.154)
NEC for r=0.1 all L1 = 0.461 +- 0.411 (in-sample avg dev_std = 0.154)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.025342000000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.472
NEC for r=0.2 class 0.0 = 0.041 +- 0.480 (in-sample avg dev_std = 0.194)
NEC for r=0.2 class 1.0 = 0.827 +- 0.480 (in-sample avg dev_std = 0.194)
NEC for r=0.2 all KL = 0.542 +- 0.480 (in-sample avg dev_std = 0.194)
NEC for r=0.2 all L1 = 0.476 +- 0.411 (in-sample avg dev_std = 0.194)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03263
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.463
NEC for r=0.4 class 0.0 = 0.044 +- 0.478 (in-sample avg dev_std = 0.233)
NEC for r=0.4 class 1.0 = 0.838 +- 0.478 (in-sample avg dev_std = 0.233)
NEC for r=0.4 all KL = 0.553 +- 0.478 (in-sample avg dev_std = 0.233)
NEC for r=0.4 all L1 = 0.484 +- 0.408 (in-sample avg dev_std = 0.233)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037082000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.465
NEC for r=0.8 class 0.0 = 0.046 +- 0.476 (in-sample avg dev_std = 0.283)
NEC for r=0.8 class 1.0 = 0.844 +- 0.476 (in-sample avg dev_std = 0.283)
NEC for r=0.8 all KL = 0.561 +- 0.476 (in-sample avg dev_std = 0.283)
NEC for r=0.8 all L1 = 0.488 +- 0.406 (in-sample avg dev_std = 0.283)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0027492000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031244
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.002121
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0011612
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005922
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089108
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.503
NEC for r=0.05 class 0.0 = 0.041 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.066 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.063 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.053 +- 0.195 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0136316
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.494
NEC for r=0.1 class 0.0 = 0.059 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.087 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.086 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.073 +- 0.230 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0205622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.494
NEC for r=0.2 class 0.0 = 0.102 +- 0.332 (in-sample avg dev_std = 0.067)
NEC for r=0.2 class 1.0 = 0.126 +- 0.332 (in-sample avg dev_std = 0.067)
NEC for r=0.2 all KL = 0.134 +- 0.332 (in-sample avg dev_std = 0.067)
NEC for r=0.2 all L1 = 0.114 +- 0.282 (in-sample avg dev_std = 0.067)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0319246
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.485
NEC for r=0.4 class 0.0 = 0.121 +- 0.357 (in-sample avg dev_std = 0.147)
NEC for r=0.4 class 1.0 = 0.141 +- 0.357 (in-sample avg dev_std = 0.147)
NEC for r=0.4 all KL = 0.159 +- 0.357 (in-sample avg dev_std = 0.147)
NEC for r=0.4 all L1 = 0.131 +- 0.297 (in-sample avg dev_std = 0.147)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047616399999999996
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.493
NEC for r=0.8 class 0.0 = 0.107 +- 0.348 (in-sample avg dev_std = 0.171)
NEC for r=0.8 class 1.0 = 0.137 +- 0.348 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all KL = 0.149 +- 0.348 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all L1 = 0.122 +- 0.286 (in-sample avg dev_std = 0.171)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 18:29:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 06:29:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.019
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.027
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.036
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.039
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.015
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.023
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.034
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.049


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.014102
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.989 +- 0.485 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.145 +- 0.485 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.05 all KL = 0.456 +- 0.485 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.05 all L1 = 0.521 +- 0.422 (in-sample avg dev_std = 0.045)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.018676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.027454
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.032)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03550199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.4 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.035)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038992000000000006
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.449
SUFF_SIMPLE for r=0.8 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.15 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.459 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.524 +- 0.422 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0024146000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030756
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021922
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012228000000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006318000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009438
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.493
SUFF_SIMPLE for r=0.05 class 0.0 = 0.829 +- 0.414 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.78 +- 0.414 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.05 all KL = 0.77 +- 0.414 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.05 all L1 = 0.805 +- 0.352 (in-sample avg dev_std = 0.143)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0147714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.829 +- 0.414 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.779 +- 0.414 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all KL = 0.77 +- 0.414 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all L1 = 0.804 +- 0.353 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023277600000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.414 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.78 +- 0.414 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.2 all KL = 0.771 +- 0.414 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.2 all L1 = 0.805 +- 0.353 (in-sample avg dev_std = 0.134)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033895
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.487
SUFF_SIMPLE for r=0.4 class 0.0 = 0.84 +- 0.409 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.781 +- 0.409 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all KL = 0.777 +- 0.409 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all L1 = 0.811 +- 0.348 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.509
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0490016
len(reference) = 4866
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.477
SUFF_SIMPLE for r=0.8 class 0.0 = 0.967 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.903 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.927 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.936 +- 0.220 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.014102
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.013 +- 0.486 (in-sample avg dev_std = 0.032)
NEC for r=0.05 class 1.0 = 0.764 +- 0.486 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all KL = 0.491 +- 0.486 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all L1 = 0.429 +- 0.421 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.018676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.491
NEC for r=0.1 class 0.0 = 0.01 +- 0.486 (in-sample avg dev_std = 0.127)
NEC for r=0.1 class 1.0 = 0.793 +- 0.486 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all KL = 0.508 +- 0.486 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all L1 = 0.444 +- 0.421 (in-sample avg dev_std = 0.127)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.027454
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.474
NEC for r=0.2 class 0.0 = 0.013 +- 0.486 (in-sample avg dev_std = 0.183)
NEC for r=0.2 class 1.0 = 0.817 +- 0.486 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all KL = 0.527 +- 0.486 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all L1 = 0.459 +- 0.419 (in-sample avg dev_std = 0.183)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03550199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.458
NEC for r=0.4 class 0.0 = 0.02 +- 0.484 (in-sample avg dev_std = 0.235)
NEC for r=0.4 class 1.0 = 0.844 +- 0.484 (in-sample avg dev_std = 0.235)
NEC for r=0.4 all KL = 0.55 +- 0.484 (in-sample avg dev_std = 0.235)
NEC for r=0.4 all L1 = 0.477 +- 0.416 (in-sample avg dev_std = 0.235)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038992000000000006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.466
NEC for r=0.8 class 0.0 = 0.017 +- 0.481 (in-sample avg dev_std = 0.286)
NEC for r=0.8 class 1.0 = 0.841 +- 0.481 (in-sample avg dev_std = 0.286)
NEC for r=0.8 all KL = 0.551 +- 0.481 (in-sample avg dev_std = 0.286)
NEC for r=0.8 all L1 = 0.474 +- 0.413 (in-sample avg dev_std = 0.286)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0024146000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030756
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021922
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012228000000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006318000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009438
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.503
NEC for r=0.05 class 0.0 = 0.041 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.068 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.063 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.055 +- 0.198 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0147714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.499
NEC for r=0.1 class 0.0 = 0.061 +- 0.271 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.089 +- 0.271 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.086 +- 0.271 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.075 +- 0.234 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023277600000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
NEC for r=0.2 class 0.0 = 0.1 +- 0.335 (in-sample avg dev_std = 0.079)
NEC for r=0.2 class 1.0 = 0.135 +- 0.335 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.137 +- 0.335 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.117 +- 0.287 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033895
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.484
NEC for r=0.4 class 0.0 = 0.12 +- 0.361 (in-sample avg dev_std = 0.151)
NEC for r=0.4 class 1.0 = 0.15 +- 0.361 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all KL = 0.162 +- 0.361 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all L1 = 0.135 +- 0.302 (in-sample avg dev_std = 0.151)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0490016
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.493
NEC for r=0.8 class 0.0 = 0.105 +- 0.352 (in-sample avg dev_std = 0.172)
NEC for r=0.8 class 1.0 = 0.147 +- 0.352 (in-sample avg dev_std = 0.172)
NEC for r=0.8 all KL = 0.154 +- 0.352 (in-sample avg dev_std = 0.172)
NEC for r=0.8 all L1 = 0.126 +- 0.291 (in-sample avg dev_std = 0.172)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 18:42:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 06:42:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.028
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.034
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.021
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.032
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008905999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.991 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.145 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.457 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014178000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.991 +- 0.488 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.145 +- 0.488 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 all KL = 0.457 +- 0.488 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.050)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02224
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
SUFF_SIMPLE for r=0.2 class 0.0 = 0.991 +- 0.488 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.145 +- 0.488 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.2 all KL = 0.457 +- 0.488 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.053)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028222
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.99 +- 0.487 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.487 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.4 all KL = 0.456 +- 0.487 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.043)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034212000000000006
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.453
SUFF_SIMPLE for r=0.8 class 0.0 = 0.991 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.156 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.462 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.527 +- 0.423 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023972
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029088
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019487999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010424
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005308
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.007886
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.833 +- 0.412 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.784 +- 0.412 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.05 all KL = 0.775 +- 0.412 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.05 all L1 = 0.809 +- 0.352 (in-sample avg dev_std = 0.133)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012444799999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.834 +- 0.412 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.783 +- 0.412 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all KL = 0.775 +- 0.412 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all L1 = 0.809 +- 0.351 (in-sample avg dev_std = 0.135)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020794
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.833 +- 0.413 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.783 +- 0.413 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 all KL = 0.774 +- 0.413 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.2 all L1 = 0.809 +- 0.351 (in-sample avg dev_std = 0.139)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031668
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF_SIMPLE for r=0.4 class 0.0 = 0.844 +- 0.407 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.786 +- 0.407 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.4 all KL = 0.783 +- 0.407 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.4 all L1 = 0.816 +- 0.347 (in-sample avg dev_std = 0.120)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0472654
len(reference) = 4867
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.972 +- 0.241 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.912 +- 0.241 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.241 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.209 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008905999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.02 +- 0.486 (in-sample avg dev_std = 0.019)
NEC for r=0.05 class 1.0 = 0.751 +- 0.486 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all KL = 0.489 +- 0.486 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all L1 = 0.425 +- 0.420 (in-sample avg dev_std = 0.019)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014178000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.495
NEC for r=0.1 class 0.0 = 0.017 +- 0.487 (in-sample avg dev_std = 0.142)
NEC for r=0.1 class 1.0 = 0.784 +- 0.487 (in-sample avg dev_std = 0.142)
NEC for r=0.1 all KL = 0.51 +- 0.487 (in-sample avg dev_std = 0.142)
NEC for r=0.1 all L1 = 0.442 +- 0.420 (in-sample avg dev_std = 0.142)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02224
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.472
NEC for r=0.2 class 0.0 = 0.022 +- 0.486 (in-sample avg dev_std = 0.206)
NEC for r=0.2 class 1.0 = 0.817 +- 0.486 (in-sample avg dev_std = 0.206)
NEC for r=0.2 all KL = 0.534 +- 0.486 (in-sample avg dev_std = 0.206)
NEC for r=0.2 all L1 = 0.463 +- 0.418 (in-sample avg dev_std = 0.206)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028222
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.461
NEC for r=0.4 class 0.0 = 0.025 +- 0.485 (in-sample avg dev_std = 0.251)
NEC for r=0.4 class 1.0 = 0.839 +- 0.485 (in-sample avg dev_std = 0.251)
NEC for r=0.4 all KL = 0.551 +- 0.485 (in-sample avg dev_std = 0.251)
NEC for r=0.4 all L1 = 0.476 +- 0.416 (in-sample avg dev_std = 0.251)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034212000000000006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.474
NEC for r=0.8 class 0.0 = 0.02 +- 0.482 (in-sample avg dev_std = 0.331)
NEC for r=0.8 class 1.0 = 0.837 +- 0.482 (in-sample avg dev_std = 0.331)
NEC for r=0.8 all KL = 0.556 +- 0.482 (in-sample avg dev_std = 0.331)
NEC for r=0.8 all L1 = 0.472 +- 0.411 (in-sample avg dev_std = 0.331)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023972
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029088
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019487999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010424
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005308
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.007886
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.505
NEC for r=0.05 class 0.0 = 0.04 +- 0.237 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.073 +- 0.237 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.066 +- 0.237 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.203 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012444799999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.5
NEC for r=0.1 class 0.0 = 0.058 +- 0.274 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.093 +- 0.274 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.088 +- 0.274 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.075 +- 0.235 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020794
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.096 +- 0.337 (in-sample avg dev_std = 0.071)
NEC for r=0.2 class 1.0 = 0.138 +- 0.337 (in-sample avg dev_std = 0.071)
NEC for r=0.2 all KL = 0.138 +- 0.337 (in-sample avg dev_std = 0.071)
NEC for r=0.2 all L1 = 0.117 +- 0.288 (in-sample avg dev_std = 0.071)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031668
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
NEC for r=0.4 class 0.0 = 0.122 +- 0.364 (in-sample avg dev_std = 0.158)
NEC for r=0.4 class 1.0 = 0.15 +- 0.364 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all KL = 0.165 +- 0.364 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all L1 = 0.136 +- 0.304 (in-sample avg dev_std = 0.158)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.516
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0472654
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.493
NEC for r=0.8 class 0.0 = 0.103 +- 0.353 (in-sample avg dev_std = 0.180)
NEC for r=0.8 class 1.0 = 0.143 +- 0.353 (in-sample avg dev_std = 0.180)
NEC for r=0.8 all KL = 0.153 +- 0.353 (in-sample avg dev_std = 0.180)
NEC for r=0.8 all L1 = 0.123 +- 0.289 (in-sample avg dev_std = 0.180)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 18:55:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 06:55:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.023
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.032
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.020
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008893999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.934 +- 0.475 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.141 +- 0.475 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all KL = 0.436 +- 0.475 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013969999999999998
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.934 +- 0.475 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.141 +- 0.475 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.1 all KL = 0.436 +- 0.475 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.1 all L1 = 0.495 +- 0.406 (in-sample avg dev_std = 0.056)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023264
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.444
SUFF_SIMPLE for r=0.2 class 0.0 = 0.93 +- 0.474 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.141 +- 0.474 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.2 all KL = 0.433 +- 0.474 (in-sample avg dev_std = 0.029)
SUFF_SIMPLE for r=0.2 all L1 = 0.492 +- 0.405 (in-sample avg dev_std = 0.029)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032402
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.447
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.475 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.141 +- 0.475 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.4 all KL = 0.436 +- 0.475 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.4 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.045)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036660000000000005
len(reference) = 497
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.455
SUFF_SIMPLE for r=0.8 class 0.0 = 0.934 +- 0.476 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.156 +- 0.476 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.444 +- 0.476 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.502 +- 0.407 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026088
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030811999999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020392
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010912
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.000558
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080208
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.825 +- 0.415 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.772 +- 0.415 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all KL = 0.764 +- 0.415 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all L1 = 0.799 +- 0.354 (in-sample avg dev_std = 0.142)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122058
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.826 +- 0.415 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.772 +- 0.415 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.1 all KL = 0.764 +- 0.415 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.1 all L1 = 0.799 +- 0.354 (in-sample avg dev_std = 0.141)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019941000000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.49
SUFF_SIMPLE for r=0.2 class 0.0 = 0.827 +- 0.415 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.772 +- 0.415 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all KL = 0.765 +- 0.415 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all L1 = 0.8 +- 0.354 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0306124
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.487
SUFF_SIMPLE for r=0.4 class 0.0 = 0.836 +- 0.411 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.773 +- 0.411 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.4 all KL = 0.771 +- 0.411 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.4 all L1 = 0.805 +- 0.351 (in-sample avg dev_std = 0.122)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.51
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0471452
len(reference) = 4871
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.478
SUFF_SIMPLE for r=0.8 class 0.0 = 0.962 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.897 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.92 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.93 +- 0.226 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008893999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.508
NEC for r=0.05 class 0.0 = 0.065 +- 0.475 (in-sample avg dev_std = 0.065)
NEC for r=0.05 class 1.0 = 0.77 +- 0.475 (in-sample avg dev_std = 0.065)
NEC for r=0.05 all KL = 0.513 +- 0.475 (in-sample avg dev_std = 0.065)
NEC for r=0.05 all L1 = 0.456 +- 0.405 (in-sample avg dev_std = 0.065)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013969999999999998
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.499
NEC for r=0.1 class 0.0 = 0.065 +- 0.476 (in-sample avg dev_std = 0.165)
NEC for r=0.1 class 1.0 = 0.793 +- 0.476 (in-sample avg dev_std = 0.165)
NEC for r=0.1 all KL = 0.528 +- 0.476 (in-sample avg dev_std = 0.165)
NEC for r=0.1 all L1 = 0.468 +- 0.405 (in-sample avg dev_std = 0.165)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023264
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.477
NEC for r=0.2 class 0.0 = 0.077 +- 0.474 (in-sample avg dev_std = 0.213)
NEC for r=0.2 class 1.0 = 0.82 +- 0.474 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all KL = 0.553 +- 0.474 (in-sample avg dev_std = 0.213)
NEC for r=0.2 all L1 = 0.489 +- 0.402 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032402
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.466
NEC for r=0.4 class 0.0 = 0.075 +- 0.470 (in-sample avg dev_std = 0.255)
NEC for r=0.4 class 1.0 = 0.839 +- 0.470 (in-sample avg dev_std = 0.255)
NEC for r=0.4 all KL = 0.565 +- 0.470 (in-sample avg dev_std = 0.255)
NEC for r=0.4 all L1 = 0.498 +- 0.398 (in-sample avg dev_std = 0.255)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036660000000000005
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.471
NEC for r=0.8 class 0.0 = 0.074 +- 0.469 (in-sample avg dev_std = 0.320)
NEC for r=0.8 class 1.0 = 0.842 +- 0.469 (in-sample avg dev_std = 0.320)
NEC for r=0.8 all KL = 0.57 +- 0.469 (in-sample avg dev_std = 0.320)
NEC for r=0.8 all L1 = 0.499 +- 0.395 (in-sample avg dev_std = 0.320)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026088
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030811999999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020392
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010912
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.000558
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080208
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.508
NEC for r=0.05 class 0.0 = 0.044 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.076 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.07 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.06 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122058
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.503
NEC for r=0.1 class 0.0 = 0.065 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.099 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.096 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.082 +- 0.240 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019941000000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.107 +- 0.338 (in-sample avg dev_std = 0.075)
NEC for r=0.2 class 1.0 = 0.138 +- 0.338 (in-sample avg dev_std = 0.075)
NEC for r=0.2 all KL = 0.144 +- 0.338 (in-sample avg dev_std = 0.075)
NEC for r=0.2 all L1 = 0.122 +- 0.290 (in-sample avg dev_std = 0.075)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0306124
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
NEC for r=0.4 class 0.0 = 0.124 +- 0.364 (in-sample avg dev_std = 0.158)
NEC for r=0.4 class 1.0 = 0.157 +- 0.364 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all KL = 0.17 +- 0.364 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all L1 = 0.14 +- 0.304 (in-sample avg dev_std = 0.158)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.517
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0471452
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.492
NEC for r=0.8 class 0.0 = 0.11 +- 0.357 (in-sample avg dev_std = 0.181)
NEC for r=0.8 class 1.0 = 0.155 +- 0.357 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all KL = 0.163 +- 0.357 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all L1 = 0.132 +- 0.295 (in-sample avg dev_std = 0.181)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 19:08:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 07:08:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.015
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.048


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009027999999999998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.05 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.05 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013548
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022242
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
SUFF_SIMPLE for r=0.2 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.2 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.2 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.040)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03269799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036764
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
SUFF_SIMPLE for r=0.8 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.44 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.502 +- 0.414 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026286
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.003198
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021996000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006226000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0096708
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.83 +- 0.410 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.792 +- 0.410 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all KL = 0.778 +- 0.410 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all L1 = 0.811 +- 0.349 (in-sample avg dev_std = 0.134)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014605399999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.829 +- 0.410 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.792 +- 0.410 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.1 all KL = 0.778 +- 0.410 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.1 all L1 = 0.811 +- 0.349 (in-sample avg dev_std = 0.131)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022450599999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.410 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.792 +- 0.410 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all KL = 0.778 +- 0.410 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all L1 = 0.811 +- 0.350 (in-sample avg dev_std = 0.129)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032692200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.485
SUFF_SIMPLE for r=0.4 class 0.0 = 0.842 +- 0.405 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.792 +- 0.405 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.405 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.4 all L1 = 0.817 +- 0.345 (in-sample avg dev_std = 0.122)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.504
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.048445
len(reference) = 4880
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.244 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.914 +- 0.244 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.932 +- 0.244 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.209 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009027999999999998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.5
NEC for r=0.05 class 0.0 = 0.058 +- 0.480 (in-sample avg dev_std = 0.007)
NEC for r=0.05 class 1.0 = 0.773 +- 0.480 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all KL = 0.515 +- 0.480 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all L1 = 0.454 +- 0.414 (in-sample avg dev_std = 0.007)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013548
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.058 +- 0.482 (in-sample avg dev_std = 0.141)
NEC for r=0.1 class 1.0 = 0.789 +- 0.482 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all KL = 0.528 +- 0.482 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all L1 = 0.463 +- 0.413 (in-sample avg dev_std = 0.141)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022242
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.474
NEC for r=0.2 class 0.0 = 0.063 +- 0.479 (in-sample avg dev_std = 0.210)
NEC for r=0.2 class 1.0 = 0.817 +- 0.479 (in-sample avg dev_std = 0.210)
NEC for r=0.2 all KL = 0.55 +- 0.479 (in-sample avg dev_std = 0.210)
NEC for r=0.2 all L1 = 0.481 +- 0.410 (in-sample avg dev_std = 0.210)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03269799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.464
NEC for r=0.4 class 0.0 = 0.065 +- 0.477 (in-sample avg dev_std = 0.268)
NEC for r=0.4 class 1.0 = 0.839 +- 0.477 (in-sample avg dev_std = 0.268)
NEC for r=0.4 all KL = 0.567 +- 0.477 (in-sample avg dev_std = 0.268)
NEC for r=0.4 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.268)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036764
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.465
NEC for r=0.8 class 0.0 = 0.056 +- 0.476 (in-sample avg dev_std = 0.279)
NEC for r=0.8 class 1.0 = 0.844 +- 0.476 (in-sample avg dev_std = 0.279)
NEC for r=0.8 all KL = 0.566 +- 0.476 (in-sample avg dev_std = 0.279)
NEC for r=0.8 all L1 = 0.493 +- 0.406 (in-sample avg dev_std = 0.279)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026286
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.003198
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021996000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006226000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0096708
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.041 +- 0.227 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.063 +- 0.227 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.06 +- 0.227 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.052 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014605399999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.061 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.084 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.084 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.072 +- 0.230 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022450599999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
NEC for r=0.2 class 0.0 = 0.098 +- 0.330 (in-sample avg dev_std = 0.071)
NEC for r=0.2 class 1.0 = 0.127 +- 0.330 (in-sample avg dev_std = 0.071)
NEC for r=0.2 all KL = 0.131 +- 0.330 (in-sample avg dev_std = 0.071)
NEC for r=0.2 all L1 = 0.112 +- 0.282 (in-sample avg dev_std = 0.071)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032692200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.485
NEC for r=0.4 class 0.0 = 0.12 +- 0.356 (in-sample avg dev_std = 0.148)
NEC for r=0.4 class 1.0 = 0.14 +- 0.356 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all KL = 0.156 +- 0.356 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all L1 = 0.13 +- 0.298 (in-sample avg dev_std = 0.148)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.048445
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.492
NEC for r=0.8 class 0.0 = 0.105 +- 0.349 (in-sample avg dev_std = 0.171)
NEC for r=0.8 class 1.0 = 0.137 +- 0.349 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all KL = 0.149 +- 0.349 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all L1 = 0.121 +- 0.286 (in-sample avg dev_std = 0.171)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 19:21:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 07:21:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.024
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.038
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.020
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008289999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.964 +- 0.485 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.05 all KL = 0.44 +- 0.485 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.05 all L1 = 0.507 +- 0.417 (in-sample avg dev_std = 0.041)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014301999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.965 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.507 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.965 +- 0.485 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.2 all L1 = 0.507 +- 0.417 (in-sample avg dev_std = 0.032)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03254
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.965 +- 0.485 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.4 all L1 = 0.507 +- 0.417 (in-sample avg dev_std = 0.019)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037756
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.454
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.152 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.447 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.512 +- 0.417 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.002432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029664
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020628
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010995999999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005606
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081184
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.824 +- 0.424 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.759 +- 0.424 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all KL = 0.754 +- 0.424 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all L1 = 0.792 +- 0.361 (in-sample avg dev_std = 0.145)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122244
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.825 +- 0.424 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.759 +- 0.424 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 all KL = 0.755 +- 0.424 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.1 all L1 = 0.792 +- 0.361 (in-sample avg dev_std = 0.145)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019827800000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.824 +- 0.424 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.759 +- 0.424 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.2 all KL = 0.755 +- 0.424 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.2 all L1 = 0.792 +- 0.362 (in-sample avg dev_std = 0.138)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.030766400000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF_SIMPLE for r=0.4 class 0.0 = 0.836 +- 0.419 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.761 +- 0.419 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all KL = 0.764 +- 0.419 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all L1 = 0.799 +- 0.357 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.518
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0468454
len(reference) = 4870
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.479
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.893 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.918 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.929 +- 0.231 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008289999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.538
NEC for r=0.05 class 0.0 = 0.047 +- 0.485 (in-sample avg dev_std = 0.032)
NEC for r=0.05 class 1.0 = 0.716 +- 0.485 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all KL = 0.48 +- 0.485 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all L1 = 0.418 +- 0.417 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014301999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.048 +- 0.485 (in-sample avg dev_std = 0.145)
NEC for r=0.1 class 1.0 = 0.781 +- 0.485 (in-sample avg dev_std = 0.145)
NEC for r=0.1 all KL = 0.522 +- 0.485 (in-sample avg dev_std = 0.145)
NEC for r=0.1 all L1 = 0.454 +- 0.416 (in-sample avg dev_std = 0.145)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.47
NEC for r=0.2 class 0.0 = 0.049 +- 0.483 (in-sample avg dev_std = 0.228)
NEC for r=0.2 class 1.0 = 0.829 +- 0.483 (in-sample avg dev_std = 0.228)
NEC for r=0.2 all KL = 0.556 +- 0.483 (in-sample avg dev_std = 0.228)
NEC for r=0.2 all L1 = 0.481 +- 0.411 (in-sample avg dev_std = 0.228)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03254
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.468
NEC for r=0.4 class 0.0 = 0.047 +- 0.483 (in-sample avg dev_std = 0.269)
NEC for r=0.4 class 1.0 = 0.838 +- 0.483 (in-sample avg dev_std = 0.269)
NEC for r=0.4 all KL = 0.563 +- 0.483 (in-sample avg dev_std = 0.269)
NEC for r=0.4 all L1 = 0.485 +- 0.409 (in-sample avg dev_std = 0.269)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037756
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.469
NEC for r=0.8 class 0.0 = 0.045 +- 0.480 (in-sample avg dev_std = 0.323)
NEC for r=0.8 class 1.0 = 0.846 +- 0.480 (in-sample avg dev_std = 0.323)
NEC for r=0.8 all KL = 0.569 +- 0.480 (in-sample avg dev_std = 0.323)
NEC for r=0.8 all L1 = 0.489 +- 0.406 (in-sample avg dev_std = 0.323)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.002432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029664
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020628
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010995999999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005606
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081184
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.04 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.075 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.067 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.057 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122244
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.505
NEC for r=0.1 class 0.0 = 0.062 +- 0.279 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.096 +- 0.279 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.092 +- 0.279 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.079 +- 0.240 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019827800000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.105 +- 0.348 (in-sample avg dev_std = 0.072)
NEC for r=0.2 class 1.0 = 0.147 +- 0.348 (in-sample avg dev_std = 0.072)
NEC for r=0.2 all KL = 0.149 +- 0.348 (in-sample avg dev_std = 0.072)
NEC for r=0.2 all L1 = 0.126 +- 0.297 (in-sample avg dev_std = 0.072)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.030766400000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.487
NEC for r=0.4 class 0.0 = 0.125 +- 0.376 (in-sample avg dev_std = 0.159)
NEC for r=0.4 class 1.0 = 0.17 +- 0.376 (in-sample avg dev_std = 0.159)
NEC for r=0.4 all KL = 0.18 +- 0.376 (in-sample avg dev_std = 0.159)
NEC for r=0.4 all L1 = 0.147 +- 0.314 (in-sample avg dev_std = 0.159)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0468454
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.493
NEC for r=0.8 class 0.0 = 0.11 +- 0.370 (in-sample avg dev_std = 0.192)
NEC for r=0.8 class 1.0 = 0.167 +- 0.370 (in-sample avg dev_std = 0.192)
NEC for r=0.8 all KL = 0.172 +- 0.370 (in-sample avg dev_std = 0.192)
NEC for r=0.8 all L1 = 0.138 +- 0.303 (in-sample avg dev_std = 0.192)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 19:34:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 07:34:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.001
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.004
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.052
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.002
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.005
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.020
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.058


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.983 +- 0.491 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.137 +- 0.491 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.05 all KL = 0.445 +- 0.491 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.05 all L1 = 0.515 +- 0.422 (in-sample avg dev_std = 0.011)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001136
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.983 +- 0.491 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.138 +- 0.491 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.1 all KL = 0.445 +- 0.491 (in-sample avg dev_std = 0.064)
SUFF_SIMPLE for r=0.1 all L1 = 0.515 +- 0.422 (in-sample avg dev_std = 0.064)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0035059999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.444
SUFF_SIMPLE for r=0.2 class 0.0 = 0.979 +- 0.490 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.137 +- 0.490 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.2 all KL = 0.443 +- 0.490 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.2 all L1 = 0.513 +- 0.422 (in-sample avg dev_std = 0.041)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012364
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.444
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.490 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.137 +- 0.490 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all KL = 0.443 +- 0.490 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.4 all L1 = 0.513 +- 0.422 (in-sample avg dev_std = 0.032)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.051992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.46
SUFF_SIMPLE for r=0.8 class 0.0 = 0.98 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.161 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.457 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.526 +- 0.423 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.520000000000001e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006754
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.49
SUFF_SIMPLE for r=0.05 class 0.0 = 0.83 +- 0.417 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.773 +- 0.417 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all KL = 0.766 +- 0.417 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all L1 = 0.802 +- 0.355 (in-sample avg dev_std = 0.145)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0015534
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.492
SUFF_SIMPLE for r=0.1 class 0.0 = 0.829 +- 0.417 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.774 +- 0.417 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.1 all KL = 0.766 +- 0.417 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.1 all L1 = 0.802 +- 0.355 (in-sample avg dev_std = 0.144)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0054122
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.418 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.774 +- 0.418 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all KL = 0.766 +- 0.418 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all L1 = 0.802 +- 0.355 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.019672199999999997
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF_SIMPLE for r=0.4 class 0.0 = 0.846 +- 0.405 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.791 +- 0.405 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all KL = 0.785 +- 0.405 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.4 all L1 = 0.819 +- 0.343 (in-sample avg dev_std = 0.125)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.514
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057988
len(reference) = 4914
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.951 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.874 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.9 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.913 +- 0.253 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.512
NEC for r=0.05 class 0.0 = 0.02 +- 0.490 (in-sample avg dev_std = 0.071)
NEC for r=0.05 class 1.0 = 0.768 +- 0.490 (in-sample avg dev_std = 0.071)
NEC for r=0.05 all KL = 0.505 +- 0.490 (in-sample avg dev_std = 0.071)
NEC for r=0.05 all L1 = 0.434 +- 0.420 (in-sample avg dev_std = 0.071)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001136
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.484
NEC for r=0.1 class 0.0 = 0.021 +- 0.492 (in-sample avg dev_std = 0.123)
NEC for r=0.1 class 1.0 = 0.802 +- 0.492 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all KL = 0.523 +- 0.492 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all L1 = 0.454 +- 0.422 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0035059999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.465
NEC for r=0.2 class 0.0 = 0.03 +- 0.490 (in-sample avg dev_std = 0.173)
NEC for r=0.2 class 1.0 = 0.834 +- 0.490 (in-sample avg dev_std = 0.173)
NEC for r=0.2 all KL = 0.551 +- 0.490 (in-sample avg dev_std = 0.173)
NEC for r=0.2 all L1 = 0.475 +- 0.419 (in-sample avg dev_std = 0.173)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012364
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.468
NEC for r=0.4 class 0.0 = 0.037 +- 0.488 (in-sample avg dev_std = 0.291)
NEC for r=0.4 class 1.0 = 0.838 +- 0.488 (in-sample avg dev_std = 0.291)
NEC for r=0.4 all KL = 0.564 +- 0.488 (in-sample avg dev_std = 0.291)
NEC for r=0.4 all L1 = 0.481 +- 0.413 (in-sample avg dev_std = 0.291)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.051992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.47
NEC for r=0.8 class 0.0 = 0.025 +- 0.486 (in-sample avg dev_std = 0.315)
NEC for r=0.8 class 1.0 = 0.848 +- 0.486 (in-sample avg dev_std = 0.315)
NEC for r=0.8 all KL = 0.564 +- 0.486 (in-sample avg dev_std = 0.315)
NEC for r=0.8 all L1 = 0.481 +- 0.413 (in-sample avg dev_std = 0.315)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.520000000000001e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006754
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.516
NEC for r=0.05 class 0.0 = 0.042 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.066 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.062 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.054 +- 0.197 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0015534
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.511
NEC for r=0.1 class 0.0 = 0.065 +- 0.281 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.095 +- 0.281 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.094 +- 0.281 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.08 +- 0.241 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0054122
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.506
NEC for r=0.2 class 0.0 = 0.11 +- 0.349 (in-sample avg dev_std = 0.114)
NEC for r=0.2 class 1.0 = 0.139 +- 0.349 (in-sample avg dev_std = 0.114)
NEC for r=0.2 all KL = 0.15 +- 0.349 (in-sample avg dev_std = 0.114)
NEC for r=0.2 all L1 = 0.125 +- 0.294 (in-sample avg dev_std = 0.114)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.019672199999999997
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.493
NEC for r=0.4 class 0.0 = 0.122 +- 0.358 (in-sample avg dev_std = 0.138)
NEC for r=0.4 class 1.0 = 0.144 +- 0.358 (in-sample avg dev_std = 0.138)
NEC for r=0.4 all KL = 0.159 +- 0.358 (in-sample avg dev_std = 0.138)
NEC for r=0.4 all L1 = 0.133 +- 0.302 (in-sample avg dev_std = 0.138)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.52
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057988
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.488
NEC for r=0.8 class 0.0 = 0.103 +- 0.359 (in-sample avg dev_std = 0.181)
NEC for r=0.8 class 1.0 = 0.16 +- 0.359 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all KL = 0.16 +- 0.359 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all L1 = 0.131 +- 0.298 (in-sample avg dev_std = 0.181)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 19:46:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 07:46:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.016
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.021
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012080000000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.016174
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.1 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.1 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.032)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022316
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.973 +- 0.485 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.2 all KL = 0.448 +- 0.485 (in-sample avg dev_std = 0.033)
SUFF_SIMPLE for r=0.2 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.033)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031120000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.4 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.4 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.017)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036548000000000004
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.456
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.16 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.521 +- 0.418 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0025759999999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031368000000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021654000000000005
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.001178
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006022
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008990999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.492
SUFF_SIMPLE for r=0.05 class 0.0 = 0.828 +- 0.414 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.783 +- 0.414 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.05 all KL = 0.771 +- 0.414 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.05 all L1 = 0.806 +- 0.351 (in-sample avg dev_std = 0.149)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0133226
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.491
SUFF_SIMPLE for r=0.1 class 0.0 = 0.828 +- 0.414 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.782 +- 0.414 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 all KL = 0.771 +- 0.414 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 all L1 = 0.805 +- 0.352 (in-sample avg dev_std = 0.137)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020676600000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
SUFF_SIMPLE for r=0.2 class 0.0 = 0.827 +- 0.414 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.783 +- 0.414 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.2 all KL = 0.771 +- 0.414 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.2 all L1 = 0.806 +- 0.352 (in-sample avg dev_std = 0.140)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0311536
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF_SIMPLE for r=0.4 class 0.0 = 0.84 +- 0.407 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.785 +- 0.407 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 all KL = 0.781 +- 0.407 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.4 all L1 = 0.813 +- 0.347 (in-sample avg dev_std = 0.126)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047249
len(reference) = 4881
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.477
SUFF_SIMPLE for r=0.8 class 0.0 = 0.967 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.904 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.925 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.935 +- 0.219 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012080000000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.508
NEC for r=0.05 class 0.0 = 0.029 +- 0.484 (in-sample avg dev_std = 0.059)
NEC for r=0.05 class 1.0 = 0.771 +- 0.484 (in-sample avg dev_std = 0.059)
NEC for r=0.05 all KL = 0.505 +- 0.484 (in-sample avg dev_std = 0.059)
NEC for r=0.05 all L1 = 0.44 +- 0.415 (in-sample avg dev_std = 0.059)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.016174
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.485
NEC for r=0.1 class 0.0 = 0.026 +- 0.486 (in-sample avg dev_std = 0.115)
NEC for r=0.1 class 1.0 = 0.802 +- 0.486 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all KL = 0.518 +- 0.486 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all L1 = 0.456 +- 0.417 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022316
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.476
NEC for r=0.2 class 0.0 = 0.034 +- 0.486 (in-sample avg dev_std = 0.208)
NEC for r=0.2 class 1.0 = 0.818 +- 0.486 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all KL = 0.536 +- 0.486 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all L1 = 0.468 +- 0.414 (in-sample avg dev_std = 0.208)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031120000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.462
NEC for r=0.4 class 0.0 = 0.034 +- 0.484 (in-sample avg dev_std = 0.246)
NEC for r=0.4 class 1.0 = 0.843 +- 0.484 (in-sample avg dev_std = 0.246)
NEC for r=0.4 all KL = 0.554 +- 0.484 (in-sample avg dev_std = 0.246)
NEC for r=0.4 all L1 = 0.482 +- 0.412 (in-sample avg dev_std = 0.246)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036548000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.47
NEC for r=0.8 class 0.0 = 0.029 +- 0.483 (in-sample avg dev_std = 0.304)
NEC for r=0.8 class 1.0 = 0.843 +- 0.483 (in-sample avg dev_std = 0.304)
NEC for r=0.8 all KL = 0.553 +- 0.483 (in-sample avg dev_std = 0.304)
NEC for r=0.8 all L1 = 0.48 +- 0.409 (in-sample avg dev_std = 0.304)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0025759999999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031368000000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021654000000000005
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.001178
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006022
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008990999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.04 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.065 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.061 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.052 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0133226
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.5
NEC for r=0.1 class 0.0 = 0.062 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.09 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.088 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.076 +- 0.235 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020676600000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.495
NEC for r=0.2 class 0.0 = 0.101 +- 0.331 (in-sample avg dev_std = 0.079)
NEC for r=0.2 class 1.0 = 0.127 +- 0.331 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.132 +- 0.331 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.114 +- 0.282 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0311536
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
NEC for r=0.4 class 0.0 = 0.12 +- 0.361 (in-sample avg dev_std = 0.161)
NEC for r=0.4 class 1.0 = 0.15 +- 0.361 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all KL = 0.162 +- 0.361 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all L1 = 0.135 +- 0.301 (in-sample avg dev_std = 0.161)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.511
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047249
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.492
NEC for r=0.8 class 0.0 = 0.105 +- 0.352 (in-sample avg dev_std = 0.183)
NEC for r=0.8 class 1.0 = 0.144 +- 0.352 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all KL = 0.153 +- 0.352 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all L1 = 0.124 +- 0.288 (in-sample avg dev_std = 0.183)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.453, 0.452, 0.452, 0.454, 0.457], 'all_L1': [0.52, 0.519, 0.519, 0.52, 0.523]}), defaultdict(<class 'list'>, {'all_KL': [0.43, 0.431, 0.431, 0.431, 0.439], 'all_L1': [0.496, 0.497, 0.497, 0.497, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.447, 0.447, 0.447, 0.447, 0.447], 'all_L1': [0.509, 0.509, 0.509, 0.509, 0.509]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.458, 0.458, 0.458, 0.459], 'all_L1': [0.521, 0.522, 0.522, 0.522, 0.524]}), defaultdict(<class 'list'>, {'all_KL': [0.457, 0.457, 0.457, 0.456, 0.462], 'all_L1': [0.522, 0.522, 0.522, 0.522, 0.527]}), defaultdict(<class 'list'>, {'all_KL': [0.436, 0.436, 0.433, 0.436, 0.444], 'all_L1': [0.494, 0.495, 0.492, 0.494, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.441, 0.441, 0.441, 0.441, 0.44], 'all_L1': [0.503, 0.503, 0.503, 0.503, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.44, 0.441, 0.441, 0.441, 0.447], 'all_L1': [0.507, 0.507, 0.507, 0.507, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.445, 0.445, 0.443, 0.443, 0.457], 'all_L1': [0.515, 0.515, 0.513, 0.513, 0.526]}), defaultdict(<class 'list'>, {'all_KL': [0.449, 0.449, 0.448, 0.449, 0.458], 'all_L1': [0.513, 0.513, 0.513, 0.513, 0.521]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.488, 0.524, 0.541, 0.548, 0.557], 'all_L1': [0.424, 0.452, 0.469, 0.471, 0.476]}), defaultdict(<class 'list'>, {'all_KL': [0.522, 0.537, 0.569, 0.573, 0.576], 'all_L1': [0.457, 0.469, 0.495, 0.494, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.509, 0.525, 0.542, 0.553, 0.561], 'all_L1': [0.447, 0.461, 0.476, 0.484, 0.488]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.508, 0.527, 0.55, 0.551], 'all_L1': [0.429, 0.444, 0.459, 0.477, 0.474]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.51, 0.534, 0.551, 0.556], 'all_L1': [0.425, 0.442, 0.463, 0.476, 0.472]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.528, 0.553, 0.565, 0.57], 'all_L1': [0.456, 0.468, 0.489, 0.498, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.515, 0.528, 0.55, 0.567, 0.566], 'all_L1': [0.454, 0.463, 0.481, 0.494, 0.493]}), defaultdict(<class 'list'>, {'all_KL': [0.48, 0.522, 0.556, 0.563, 0.569], 'all_L1': [0.418, 0.454, 0.481, 0.485, 0.489]}), defaultdict(<class 'list'>, {'all_KL': [0.505, 0.523, 0.551, 0.564, 0.564], 'all_L1': [0.434, 0.454, 0.475, 0.481, 0.481]}), defaultdict(<class 'list'>, {'all_KL': [0.505, 0.518, 0.536, 0.554, 0.553], 'all_L1': [0.44, 0.456, 0.468, 0.482, 0.48]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.582, 0.582, 0.582, 0.582, 0.582], 'all_L1': [0.615, 0.615, 0.615, 0.615, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.758, 0.758, 0.758, 0.758, 0.758], 'all_L1': [0.768, 0.768, 0.768, 0.768, 0.768]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.639, 0.639, 0.639, 0.639], 'all_L1': [0.658, 0.658, 0.658, 0.658, 0.658]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.868, 0.868, 0.868, 0.868], 'all_L1': [0.867, 0.867, 0.867, 0.867, 0.867]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.721, 0.721, 0.721, 0.721], 'all_L1': [0.734, 0.734, 0.734, 0.734, 0.734]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.786, 0.786, 0.786, 0.786], 'all_L1': [0.784, 0.784, 0.784, 0.784, 0.784]}), defaultdict(<class 'list'>, {'all_KL': [0.344, 0.344, 0.344, 0.344, 0.344], 'all_L1': [0.407, 0.407, 0.407, 0.407, 0.407]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.921, 0.921, 0.921, 0.921], 'all_L1': [0.918, 0.918, 0.918, 0.918, 0.918]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.941, 0.941, 0.941, 0.941], 'all_L1': [0.938, 0.938, 0.938, 0.938, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.945, 0.945, 0.945, 0.945], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.418, 0.418, 0.418, 0.418, 0.418], 'all_L1': [0.385, 0.385, 0.385, 0.385, 0.385]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.242, 0.242, 0.242, 0.242], 'all_L1': [0.232, 0.232, 0.232, 0.232, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.361, 0.361, 0.361, 0.361], 'all_L1': [0.342, 0.342, 0.342, 0.342, 0.342]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.132, 0.132, 0.132, 0.132], 'all_L1': [0.133, 0.133, 0.133, 0.133, 0.133]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.279, 0.279, 0.279, 0.279], 'all_L1': [0.266, 0.266, 0.266, 0.266, 0.266]}), defaultdict(<class 'list'>, {'all_KL': [0.214, 0.214, 0.214, 0.214, 0.214], 'all_L1': [0.216, 0.216, 0.216, 0.216, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.656, 0.656, 0.656, 0.656], 'all_L1': [0.593, 0.593, 0.593, 0.593, 0.593]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.079, 0.079, 0.079], 'all_L1': [0.082, 0.082, 0.082, 0.082, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.059, 0.059, 0.059, 0.059, 0.059], 'all_L1': [0.062, 0.062, 0.062, 0.062, 0.062]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.055, 0.055, 0.055, 0.055], 'all_L1': [0.056, 0.056, 0.056, 0.056, 0.056]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.763, 0.763, 0.765, 0.77, 0.922], 'all_L1': [0.8, 0.8, 0.801, 0.806, 0.933]}), defaultdict(<class 'list'>, {'all_KL': [0.756, 0.756, 0.757, 0.773, 0.894], 'all_L1': [0.793, 0.792, 0.794, 0.808, 0.907]}), defaultdict(<class 'list'>, {'all_KL': [0.775, 0.774, 0.775, 0.782, 0.93], 'all_L1': [0.808, 0.808, 0.809, 0.815, 0.94]}), defaultdict(<class 'list'>, {'all_KL': [0.77, 0.77, 0.771, 0.777, 0.927], 'all_L1': [0.805, 0.804, 0.805, 0.811, 0.936]}), defaultdict(<class 'list'>, {'all_KL': [0.775, 0.775, 0.774, 0.783, 0.934], 'all_L1': [0.809, 0.809, 0.809, 0.816, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.764, 0.764, 0.765, 0.771, 0.92], 'all_L1': [0.799, 0.799, 0.8, 0.805, 0.93]}), defaultdict(<class 'list'>, {'all_KL': [0.778, 0.778, 0.778, 0.786, 0.932], 'all_L1': [0.811, 0.811, 0.811, 0.817, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.754, 0.755, 0.755, 0.764, 0.918], 'all_L1': [0.792, 0.792, 0.792, 0.799, 0.929]}), defaultdict(<class 'list'>, {'all_KL': [0.766, 0.766, 0.766, 0.785, 0.9], 'all_L1': [0.802, 0.802, 0.802, 0.819, 0.913]}), defaultdict(<class 'list'>, {'all_KL': [0.771, 0.771, 0.771, 0.781, 0.925], 'all_L1': [0.806, 0.805, 0.806, 0.813, 0.935]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.069, 0.093, 0.145, 0.172, 0.161], 'all_L1': [0.058, 0.08, 0.122, 0.141, 0.129]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.096, 0.159, 0.173, 0.169], 'all_L1': [0.059, 0.081, 0.129, 0.144, 0.138]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.086, 0.134, 0.159, 0.149], 'all_L1': [0.053, 0.073, 0.114, 0.131, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.086, 0.137, 0.162, 0.154], 'all_L1': [0.055, 0.075, 0.117, 0.135, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.066, 0.088, 0.138, 0.165, 0.153], 'all_L1': [0.056, 0.075, 0.117, 0.136, 0.123]}), defaultdict(<class 'list'>, {'all_KL': [0.07, 0.096, 0.144, 0.17, 0.163], 'all_L1': [0.06, 0.082, 0.122, 0.14, 0.132]}), defaultdict(<class 'list'>, {'all_KL': [0.06, 0.084, 0.131, 0.156, 0.149], 'all_L1': [0.052, 0.072, 0.112, 0.13, 0.121]}), defaultdict(<class 'list'>, {'all_KL': [0.067, 0.092, 0.149, 0.18, 0.172], 'all_L1': [0.057, 0.079, 0.126, 0.147, 0.138]}), defaultdict(<class 'list'>, {'all_KL': [0.062, 0.094, 0.15, 0.159, 0.16], 'all_L1': [0.054, 0.08, 0.125, 0.133, 0.131]}), defaultdict(<class 'list'>, {'all_KL': [0.061, 0.088, 0.132, 0.162, 0.153], 'all_L1': [0.052, 0.076, 0.114, 0.135, 0.124]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.510 +- 0.010, 0.510 +- 0.009, 0.510 +- 0.010, 0.510 +- 0.009, 0.515 +- 0.010
suff_simple class all_KL  =  0.445 +- 0.008, 0.446 +- 0.008, 0.445 +- 0.009, 0.446 +- 0.008, 0.451 +- 0.008
suff_simple_acc_int  =  0.446 +- 0.000, 0.446 +- 0.000, 0.446 +- 0.001, 0.446 +- 0.001, 0.453 +- 0.004
nec class all_L1  =  0.438 +- 0.014, 0.456 +- 0.009, 0.476 +- 0.011, 0.484 +- 0.008, 0.485 +- 0.009
nec class all_KL  =  0.502 +- 0.013, 0.522 +- 0.008, 0.546 +- 0.012, 0.559 +- 0.008, 0.562 +- 0.008
nec_acc_int  =  0.510 +- 0.011, 0.491 +- 0.005, 0.471 +- 0.004, 0.464 +- 0.003, 0.469 +- 0.003

Eval split val
suff_simple class all_L1  =  0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161
suff_simple class all_KL  =  0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180
suff_simple_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000
nec class all_L1  =  0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161
nec class all_KL  =  0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180
nec_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000

Eval split test
suff_simple class all_L1  =  0.802 +- 0.006, 0.802 +- 0.006, 0.803 +- 0.006, 0.811 +- 0.006, 0.931 +- 0.011
suff_simple class all_KL  =  0.767 +- 0.008, 0.767 +- 0.007, 0.768 +- 0.007, 0.777 +- 0.007, 0.920 +- 0.013
suff_simple_acc_int  =  0.492 +- 0.001, 0.492 +- 0.000, 0.491 +- 0.001, 0.487 +- 0.002, 0.477 +- 0.002
nec class all_L1  =  0.056 +- 0.003, 0.077 +- 0.003, 0.120 +- 0.006, 0.137 +- 0.005, 0.128 +- 0.006
nec class all_KL  =  0.065 +- 0.003, 0.090 +- 0.004, 0.142 +- 0.009, 0.166 +- 0.007, 0.158 +- 0.008
nec_acc_int  =  0.508 +- 0.004, 0.502 +- 0.006, 0.497 +- 0.005, 0.487 +- 0.003, 0.492 +- 0.002


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.474 +- 0.004, 0.483 +- 0.002, 0.493 +- 0.002, 0.497 +- 0.001, 0.500 +- 0.002
Faith. Armon (L1)= 		  =  0.471 +- 0.005, 0.482 +- 0.002, 0.492 +- 0.002, 0.497 +- 0.001, 0.499 +- 0.002
Faith. GMean (L1)= 	  =  0.473 +- 0.005, 0.482 +- 0.002, 0.492 +- 0.002, 0.497 +- 0.001, 0.500 +- 0.002
Faith. Aritm (KL)= 		  =  0.474 +- 0.005, 0.484 +- 0.002, 0.496 +- 0.002, 0.502 +- 0.001, 0.507 +- 0.002
Faith. Armon (KL)= 		  =  0.472 +- 0.005, 0.481 +- 0.002, 0.490 +- 0.002, 0.496 +- 0.002, 0.500 +- 0.003
Faith. GMean (KL)= 	  =  0.473 +- 0.005, 0.482 +- 0.002, 0.493 +- 0.002, 0.499 +- 0.002, 0.504 +- 0.002

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000
Faith. Armon (L1)= 		  =  0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140
Faith. GMean (L1)= 	  =  0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097
Faith. Aritm (KL)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000
Faith. Armon (KL)= 		  =  0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142
Faith. GMean (KL)= 	  =  0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099

Eval split test
Faith. Aritm (L1)= 		  =  0.429 +- 0.002, 0.440 +- 0.002, 0.461 +- 0.001, 0.474 +- 0.001, 0.530 +- 0.004
Faith. Armon (L1)= 		  =  0.104 +- 0.005, 0.141 +- 0.005, 0.208 +- 0.008, 0.235 +- 0.008, 0.226 +- 0.009
Faith. GMean (L1)= 	  =  0.211 +- 0.005, 0.249 +- 0.005, 0.310 +- 0.006, 0.333 +- 0.005, 0.346 +- 0.006
Faith. Aritm (KL)= 		  =  0.416 +- 0.003, 0.429 +- 0.002, 0.455 +- 0.002, 0.472 +- 0.001, 0.539 +- 0.005
Faith. Armon (KL)= 		  =  0.120 +- 0.006, 0.162 +- 0.007, 0.239 +- 0.012, 0.273 +- 0.009, 0.270 +- 0.011
Faith. GMean (KL)= 	  =  0.223 +- 0.005, 0.263 +- 0.005, 0.330 +- 0.009, 0.359 +- 0.006, 0.382 +- 0.008
Computed for split load_split = id



Completed in  2:09:01.764001  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.05 RANDOM

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 19:59:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 07:59:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.014
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.034


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.987 +- 0.488 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.144 +- 0.488 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all KL = 0.453 +- 0.488 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all L1 = 0.52 +- 0.422 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.988 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.453 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.52 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.988 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.454 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.52 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.989 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.454 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.52 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013504
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.449 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.516 +- 0.422 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.487
SUFF_SIMPLE for r=0.05 class 0.0 = 0.741 +- 0.467 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.678 +- 0.467 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all KL = 0.657 +- 0.467 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.05 all L1 = 0.71 +- 0.400 (in-sample avg dev_std = 0.135)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.74 +- 0.468 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.679 +- 0.468 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all KL = 0.658 +- 0.468 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all L1 = 0.71 +- 0.400 (in-sample avg dev_std = 0.135)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009295999999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.486
SUFF_SIMPLE for r=0.2 class 0.0 = 0.743 +- 0.468 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.68 +- 0.468 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all KL = 0.661 +- 0.468 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all L1 = 0.712 +- 0.399 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0051328
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.832 +- 0.410 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.781 +- 0.410 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.777 +- 0.410 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.807 +- 0.354 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0339894
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.489
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.211 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.94 +- 0.211 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.211 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.956 +- 0.180 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.014 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.761 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.491 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.428 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.474
NEC for r=0.1 class 0.0 = 0.018 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.811 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.524 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.457 +- 0.421 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
NEC for r=0.2 class 0.0 = 0.024 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.832 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.539 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.472 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.456
NEC for r=0.4 class 0.0 = 0.039 +- 0.486 (in-sample avg dev_std = 0.044)
NEC for r=0.4 class 1.0 = 0.826 +- 0.486 (in-sample avg dev_std = 0.044)
NEC for r=0.4 all KL = 0.545 +- 0.486 (in-sample avg dev_std = 0.044)
NEC for r=0.4 all L1 = 0.475 +- 0.421 (in-sample avg dev_std = 0.044)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013504
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.452
NEC for r=0.8 class 0.0 = 0.016 +- 0.485 (in-sample avg dev_std = 0.168)
NEC for r=0.8 class 1.0 = 0.852 +- 0.485 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all KL = 0.552 +- 0.485 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all L1 = 0.48 +- 0.419 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.038 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.051 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.052 +- 0.207 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.044 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.057 +- 0.252 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.07 +- 0.252 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.076 +- 0.252 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.063 +- 0.212 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009295999999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.508
NEC for r=0.2 class 0.0 = 0.088 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.112 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.118 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.1 +- 0.267 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0051328
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.52
NEC for r=0.4 class 0.0 = 0.191 +- 0.427 (in-sample avg dev_std = 0.161)
NEC for r=0.4 class 1.0 = 0.221 +- 0.427 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all KL = 0.252 +- 0.427 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all L1 = 0.206 +- 0.355 (in-sample avg dev_std = 0.161)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.519
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0339894
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.519
NEC for r=0.8 class 0.0 = 0.189 +- 0.419 (in-sample avg dev_std = 0.162)
NEC for r=0.8 class 1.0 = 0.21 +- 0.419 (in-sample avg dev_std = 0.162)
NEC for r=0.8 all KL = 0.238 +- 0.419 (in-sample avg dev_std = 0.162)
NEC for r=0.8 all L1 = 0.199 +- 0.354 (in-sample avg dev_std = 0.162)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 20:13:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 08:13:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.002
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.007
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.024
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.058
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.004
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.028
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.073


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.136 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.431 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.497 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.442
SUFF_SIMPLE for r=0.1 class 0.0 = 0.936 +- 0.482 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.136 +- 0.482 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.427 +- 0.482 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.493 +- 0.412 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.448
SUFF_SIMPLE for r=0.2 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.14 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.433 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.498 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024278
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.464
SUFF_SIMPLE for r=0.4 class 0.0 = 0.944 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.165 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.512 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.058072000000000006
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.522
SUFF_SIMPLE for r=0.8 class 0.0 = 0.943 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.251 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.494 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.559 +- 0.413 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.737 +- 0.470 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.671 +- 0.470 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all KL = 0.656 +- 0.470 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all L1 = 0.704 +- 0.403 (in-sample avg dev_std = 0.128)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.49
SUFF_SIMPLE for r=0.1 class 0.0 = 0.739 +- 0.469 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.673 +- 0.469 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all KL = 0.657 +- 0.469 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all L1 = 0.706 +- 0.402 (in-sample avg dev_std = 0.127)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.741 +- 0.469 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.678 +- 0.469 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all KL = 0.66 +- 0.469 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all L1 = 0.71 +- 0.400 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.027949800000000004
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.505
SUFF_SIMPLE for r=0.4 class 0.0 = 0.851 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.813 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.806 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.832 +- 0.335 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.519
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07330260000000001
len(reference) = 4915
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.517
SUFF_SIMPLE for r=0.8 class 0.0 = 0.951 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.926 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.927 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.939 +- 0.210 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.518
NEC for r=0.05 class 0.0 = 0.052 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.763 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.512 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.446 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.486
NEC for r=0.1 class 0.0 = 0.061 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.806 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.54 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.473 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.464
NEC for r=0.2 class 0.0 = 0.063 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.828 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.552 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.487 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024278
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.456
NEC for r=0.4 class 0.0 = 0.069 +- 0.482 (in-sample avg dev_std = 0.130)
NEC for r=0.4 class 1.0 = 0.838 +- 0.482 (in-sample avg dev_std = 0.130)
NEC for r=0.4 all KL = 0.564 +- 0.482 (in-sample avg dev_std = 0.130)
NEC for r=0.4 all L1 = 0.495 +- 0.411 (in-sample avg dev_std = 0.130)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.058072000000000006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
NEC for r=0.8 class 0.0 = 0.06 +- 0.480 (in-sample avg dev_std = 0.091)
NEC for r=0.8 class 1.0 = 0.862 +- 0.480 (in-sample avg dev_std = 0.091)
NEC for r=0.8 all KL = 0.572 +- 0.480 (in-sample avg dev_std = 0.091)
NEC for r=0.8 all L1 = 0.504 +- 0.411 (in-sample avg dev_std = 0.091)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.046 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.084 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.077 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.065 +- 0.216 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.517
NEC for r=0.1 class 0.0 = 0.07 +- 0.293 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.102 +- 0.293 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.103 +- 0.293 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.086 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.516
NEC for r=0.2 class 0.0 = 0.107 +- 0.347 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.145 +- 0.347 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.15 +- 0.347 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.126 +- 0.296 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.027949800000000004
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.514
NEC for r=0.4 class 0.0 = 0.196 +- 0.423 (in-sample avg dev_std = 0.163)
NEC for r=0.4 class 1.0 = 0.207 +- 0.423 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all KL = 0.246 +- 0.423 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all L1 = 0.201 +- 0.353 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.523
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07330260000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
NEC for r=0.8 class 0.0 = 0.181 +- 0.421 (in-sample avg dev_std = 0.156)
NEC for r=0.8 class 1.0 = 0.225 +- 0.421 (in-sample avg dev_std = 0.156)
NEC for r=0.8 all KL = 0.244 +- 0.421 (in-sample avg dev_std = 0.156)
NEC for r=0.8 all L1 = 0.203 +- 0.355 (in-sample avg dev_std = 0.156)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 20:25:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 08:25:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.961 +- 0.479 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.144 +- 0.479 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all KL = 0.446 +- 0.479 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all L1 = 0.508 +- 0.414 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.962 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.447 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.509 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012755999999999998
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.962 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.143 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.443 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.505 +- 0.414 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.742 +- 0.463 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.693 +- 0.463 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all KL = 0.669 +- 0.463 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all L1 = 0.718 +- 0.397 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.741 +- 0.464 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.694 +- 0.464 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.1 all KL = 0.668 +- 0.464 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.1 all L1 = 0.718 +- 0.397 (in-sample avg dev_std = 0.136)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009086000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.487
SUFF_SIMPLE for r=0.2 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.695 +- 0.464 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all KL = 0.671 +- 0.464 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all L1 = 0.719 +- 0.396 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.004990400000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF_SIMPLE for r=0.4 class 0.0 = 0.836 +- 0.402 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.798 +- 0.402 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.788 +- 0.402 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.817 +- 0.346 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.504
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.032675800000000005
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.944 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.951 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.957 +- 0.179 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.039 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.78 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.51 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.449 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.466
NEC for r=0.1 class 0.0 = 0.039 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.829 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.539 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.477 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.456
NEC for r=0.2 class 0.0 = 0.045 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.839 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.546 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.485 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.452
NEC for r=0.4 class 0.0 = 0.054 +- 0.480 (in-sample avg dev_std = 0.043)
NEC for r=0.4 class 1.0 = 0.832 +- 0.480 (in-sample avg dev_std = 0.043)
NEC for r=0.4 all KL = 0.548 +- 0.480 (in-sample avg dev_std = 0.043)
NEC for r=0.4 all L1 = 0.485 +- 0.413 (in-sample avg dev_std = 0.043)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012755999999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.449
NEC for r=0.8 class 0.0 = 0.043 +- 0.477 (in-sample avg dev_std = 0.140)
NEC for r=0.8 class 1.0 = 0.853 +- 0.477 (in-sample avg dev_std = 0.140)
NEC for r=0.8 all KL = 0.558 +- 0.477 (in-sample avg dev_std = 0.140)
NEC for r=0.8 all L1 = 0.492 +- 0.411 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.5
NEC for r=0.05 class 0.0 = 0.037 +- 0.218 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.06 +- 0.218 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.058 +- 0.218 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.049 +- 0.187 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.499
NEC for r=0.1 class 0.0 = 0.058 +- 0.260 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.078 +- 0.260 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.081 +- 0.260 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.068 +- 0.223 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009086000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.503
NEC for r=0.2 class 0.0 = 0.086 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.102 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.111 +- 0.304 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.094 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.004990400000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.517
NEC for r=0.4 class 0.0 = 0.186 +- 0.418 (in-sample avg dev_std = 0.154)
NEC for r=0.4 class 1.0 = 0.204 +- 0.418 (in-sample avg dev_std = 0.154)
NEC for r=0.4 all KL = 0.241 +- 0.418 (in-sample avg dev_std = 0.154)
NEC for r=0.4 all L1 = 0.195 +- 0.348 (in-sample avg dev_std = 0.154)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.032675800000000005
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.518
NEC for r=0.8 class 0.0 = 0.183 +- 0.410 (in-sample avg dev_std = 0.152)
NEC for r=0.8 class 1.0 = 0.195 +- 0.410 (in-sample avg dev_std = 0.152)
NEC for r=0.8 all KL = 0.223 +- 0.410 (in-sample avg dev_std = 0.152)
NEC for r=0.8 all L1 = 0.189 +- 0.347 (in-sample avg dev_std = 0.152)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 20:38:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 08:38:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.031


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.99 +- 0.485 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.145 +- 0.485 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all KL = 0.457 +- 0.485 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.05 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.99 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.99 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012008
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.454 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.518 +- 0.422 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.685 +- 0.464 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all KL = 0.666 +- 0.464 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all L1 = 0.715 +- 0.399 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.686 +- 0.464 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.1 all KL = 0.665 +- 0.464 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.1 all L1 = 0.715 +- 0.399 (in-sample avg dev_std = 0.133)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.746 +- 0.465 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.688 +- 0.465 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all KL = 0.667 +- 0.465 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all L1 = 0.717 +- 0.397 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048382
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.838 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.791 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.815 +- 0.348 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0313284
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.491
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.209 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.94 +- 0.209 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.209 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.957 +- 0.181 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.013 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.755 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.488 +- 0.483 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.424 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.482
NEC for r=0.1 class 0.0 = 0.01 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.805 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.516 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.451 +- 0.421 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.456
NEC for r=0.2 class 0.0 = 0.019 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.832 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.535 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.47 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.452
NEC for r=0.4 class 0.0 = 0.031 +- 0.486 (in-sample avg dev_std = 0.027)
NEC for r=0.4 class 1.0 = 0.828 +- 0.486 (in-sample avg dev_std = 0.027)
NEC for r=0.4 all KL = 0.538 +- 0.486 (in-sample avg dev_std = 0.027)
NEC for r=0.4 all L1 = 0.473 +- 0.422 (in-sample avg dev_std = 0.027)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012008
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.45
NEC for r=0.8 class 0.0 = 0.01 +- 0.486 (in-sample avg dev_std = 0.118)
NEC for r=0.8 class 1.0 = 0.852 +- 0.486 (in-sample avg dev_std = 0.118)
NEC for r=0.8 all KL = 0.542 +- 0.486 (in-sample avg dev_std = 0.118)
NEC for r=0.8 all L1 = 0.477 +- 0.421 (in-sample avg dev_std = 0.118)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.037 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.064 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.058 +- 0.221 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.05 +- 0.189 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.502
NEC for r=0.1 class 0.0 = 0.058 +- 0.261 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.082 +- 0.261 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.081 +- 0.261 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.07 +- 0.226 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.503
NEC for r=0.2 class 0.0 = 0.086 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.109 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.113 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.097 +- 0.264 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048382
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.515
NEC for r=0.4 class 0.0 = 0.184 +- 0.417 (in-sample avg dev_std = 0.156)
NEC for r=0.4 class 1.0 = 0.209 +- 0.417 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all KL = 0.238 +- 0.417 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all L1 = 0.196 +- 0.350 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0313284
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.518
NEC for r=0.8 class 0.0 = 0.187 +- 0.414 (in-sample avg dev_std = 0.148)
NEC for r=0.8 class 1.0 = 0.203 +- 0.414 (in-sample avg dev_std = 0.148)
NEC for r=0.8 all KL = 0.23 +- 0.414 (in-sample avg dev_std = 0.148)
NEC for r=0.8 all L1 = 0.195 +- 0.352 (in-sample avg dev_std = 0.148)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 20:51:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 08:51:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.99 +- 0.487 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.145 +- 0.487 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all KL = 0.456 +- 0.487 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.99 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.145 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.456 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.99 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.145 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.457 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.457 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013048
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.991 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.145 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.452 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.518 +- 0.423 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.487
SUFF_SIMPLE for r=0.05 class 0.0 = 0.746 +- 0.464 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.689 +- 0.464 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.05 all KL = 0.668 +- 0.464 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.05 all L1 = 0.718 +- 0.399 (in-sample avg dev_std = 0.130)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.487
SUFF_SIMPLE for r=0.1 class 0.0 = 0.746 +- 0.465 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.687 +- 0.465 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 all KL = 0.667 +- 0.465 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 all L1 = 0.717 +- 0.399 (in-sample avg dev_std = 0.132)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.487
SUFF_SIMPLE for r=0.2 class 0.0 = 0.749 +- 0.465 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.69 +- 0.465 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all KL = 0.67 +- 0.465 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all L1 = 0.72 +- 0.397 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005054
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.841 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.793 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.789 +- 0.403 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.817 +- 0.348 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.505
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033212599999999995
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.489
SUFF_SIMPLE for r=0.8 class 0.0 = 0.976 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.947 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.956 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.169 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.5
NEC for r=0.05 class 0.0 = 0.012 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.768 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.495 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.431 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.474
NEC for r=0.1 class 0.0 = 0.013 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.812 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.522 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.456 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
NEC for r=0.2 class 0.0 = 0.021 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.832 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.537 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.47 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.454
NEC for r=0.4 class 0.0 = 0.034 +- 0.486 (in-sample avg dev_std = 0.040)
NEC for r=0.4 class 1.0 = 0.825 +- 0.486 (in-sample avg dev_std = 0.040)
NEC for r=0.4 all KL = 0.539 +- 0.486 (in-sample avg dev_std = 0.040)
NEC for r=0.4 all L1 = 0.472 +- 0.422 (in-sample avg dev_std = 0.040)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013048
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.453
NEC for r=0.8 class 0.0 = 0.016 +- 0.484 (in-sample avg dev_std = 0.183)
NEC for r=0.8 class 1.0 = 0.85 +- 0.484 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all KL = 0.553 +- 0.484 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all L1 = 0.478 +- 0.418 (in-sample avg dev_std = 0.183)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.034 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.049 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.049 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.041 +- 0.170 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.054 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.067 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.071 +- 0.246 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.061 +- 0.210 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.506
NEC for r=0.2 class 0.0 = 0.082 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.105 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.11 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.093 +- 0.261 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005054
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.518
NEC for r=0.4 class 0.0 = 0.184 +- 0.418 (in-sample avg dev_std = 0.151)
NEC for r=0.4 class 1.0 = 0.206 +- 0.418 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all KL = 0.239 +- 0.418 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all L1 = 0.195 +- 0.351 (in-sample avg dev_std = 0.151)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.516
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033212599999999995
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.519
NEC for r=0.8 class 0.0 = 0.185 +- 0.416 (in-sample avg dev_std = 0.161)
NEC for r=0.8 class 1.0 = 0.207 +- 0.416 (in-sample avg dev_std = 0.161)
NEC for r=0.8 all KL = 0.232 +- 0.416 (in-sample avg dev_std = 0.161)
NEC for r=0.8 all L1 = 0.196 +- 0.353 (in-sample avg dev_std = 0.161)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 21:03:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 09:03:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.932 +- 0.473 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.141 +- 0.473 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all KL = 0.434 +- 0.473 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all L1 = 0.494 +- 0.404 (in-sample avg dev_std = 0.003)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.933 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.141 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.435 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.494 +- 0.405 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.934 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.141 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.435 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.475 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.14 +- 0.475 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.436 +- 0.475 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013047999999999999
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.933 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.141 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.431 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.491 +- 0.405 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.739 +- 0.464 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.677 +- 0.464 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all KL = 0.658 +- 0.464 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all L1 = 0.708 +- 0.399 (in-sample avg dev_std = 0.122)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.487
SUFF_SIMPLE for r=0.1 class 0.0 = 0.74 +- 0.464 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.677 +- 0.464 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all KL = 0.658 +- 0.464 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all L1 = 0.709 +- 0.399 (in-sample avg dev_std = 0.129)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.68 +- 0.464 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.2 all KL = 0.662 +- 0.464 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.2 all L1 = 0.712 +- 0.398 (in-sample avg dev_std = 0.137)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF_SIMPLE for r=0.4 class 0.0 = 0.832 +- 0.406 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.78 +- 0.406 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.777 +- 0.406 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.807 +- 0.352 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0332018
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.936 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.953 +- 0.184 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.516
NEC for r=0.05 class 0.0 = 0.066 +- 0.473 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.761 +- 0.473 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.508 +- 0.473 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.451 +- 0.404 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.48
NEC for r=0.1 class 0.0 = 0.069 +- 0.474 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.812 +- 0.474 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.541 +- 0.474 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.481 +- 0.405 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
NEC for r=0.2 class 0.0 = 0.073 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.834 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.553 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.458
NEC for r=0.4 class 0.0 = 0.081 +- 0.474 (in-sample avg dev_std = 0.032)
NEC for r=0.4 class 1.0 = 0.827 +- 0.474 (in-sample avg dev_std = 0.032)
NEC for r=0.4 all KL = 0.555 +- 0.474 (in-sample avg dev_std = 0.032)
NEC for r=0.4 all L1 = 0.495 +- 0.405 (in-sample avg dev_std = 0.032)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013047999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.454
NEC for r=0.8 class 0.0 = 0.073 +- 0.470 (in-sample avg dev_std = 0.186)
NEC for r=0.8 class 1.0 = 0.854 +- 0.470 (in-sample avg dev_std = 0.186)
NEC for r=0.8 all KL = 0.57 +- 0.470 (in-sample avg dev_std = 0.186)
NEC for r=0.8 all L1 = 0.505 +- 0.401 (in-sample avg dev_std = 0.186)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.509
NEC for r=0.05 class 0.0 = 0.039 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.059 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.056 +- 0.208 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.049 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.059 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.078 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.081 +- 0.254 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.068 +- 0.216 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.508
NEC for r=0.2 class 0.0 = 0.088 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.113 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.119 +- 0.309 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.101 +- 0.265 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.519
NEC for r=0.4 class 0.0 = 0.19 +- 0.420 (in-sample avg dev_std = 0.149)
NEC for r=0.4 class 1.0 = 0.217 +- 0.420 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all KL = 0.249 +- 0.420 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all L1 = 0.203 +- 0.352 (in-sample avg dev_std = 0.149)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.517
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0332018
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.519
NEC for r=0.8 class 0.0 = 0.188 +- 0.414 (in-sample avg dev_std = 0.161)
NEC for r=0.8 class 1.0 = 0.211 +- 0.414 (in-sample avg dev_std = 0.161)
NEC for r=0.8 all KL = 0.234 +- 0.414 (in-sample avg dev_std = 0.161)
NEC for r=0.8 all L1 = 0.199 +- 0.352 (in-sample avg dev_std = 0.161)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 21:16:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 09:16:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.012
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.032


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.947 +- 0.478 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.145 +- 0.478 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.05 all KL = 0.439 +- 0.478 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.05 all L1 = 0.502 +- 0.412 (in-sample avg dev_std = 0.004)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.948 +- 0.478 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.145 +- 0.478 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.439 +- 0.478 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.503 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.949 +- 0.479 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.144 +- 0.479 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.44 +- 0.479 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012206
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.949 +- 0.479 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.144 +- 0.479 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.436 +- 0.479 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.499 +- 0.413 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.696 +- 0.464 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.05 all KL = 0.668 +- 0.464 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.05 all L1 = 0.72 +- 0.396 (in-sample avg dev_std = 0.133)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.696 +- 0.464 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all KL = 0.669 +- 0.464 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.1 all L1 = 0.72 +- 0.396 (in-sample avg dev_std = 0.135)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.745 +- 0.464 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.699 +- 0.464 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all KL = 0.672 +- 0.464 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all L1 = 0.722 +- 0.395 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048786
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.841 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.804 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.795 +- 0.397 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.823 +- 0.343 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.503
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0316882
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.49
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.197 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.951 +- 0.197 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.956 +- 0.197 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.169 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.508
NEC for r=0.05 class 0.0 = 0.051 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.776 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.516 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.452 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.472
NEC for r=0.1 class 0.0 = 0.051 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.825 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.544 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.48 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
NEC for r=0.2 class 0.0 = 0.062 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.837 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.555 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.491 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.447
NEC for r=0.4 class 0.0 = 0.075 +- 0.479 (in-sample avg dev_std = 0.040)
NEC for r=0.4 class 1.0 = 0.834 +- 0.479 (in-sample avg dev_std = 0.040)
NEC for r=0.4 all KL = 0.559 +- 0.479 (in-sample avg dev_std = 0.040)
NEC for r=0.4 all L1 = 0.495 +- 0.413 (in-sample avg dev_std = 0.040)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.012206
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.451
NEC for r=0.8 class 0.0 = 0.054 +- 0.478 (in-sample avg dev_std = 0.144)
NEC for r=0.8 class 1.0 = 0.853 +- 0.478 (in-sample avg dev_std = 0.144)
NEC for r=0.8 all KL = 0.565 +- 0.478 (in-sample avg dev_std = 0.144)
NEC for r=0.8 all L1 = 0.497 +- 0.411 (in-sample avg dev_std = 0.144)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.502
NEC for r=0.05 class 0.0 = 0.036 +- 0.215 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.056 +- 0.215 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.054 +- 0.215 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.046 +- 0.182 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.056 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.074 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.077 +- 0.256 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.065 +- 0.219 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0008946000000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.503
NEC for r=0.2 class 0.0 = 0.084 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.1 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.108 +- 0.302 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.092 +- 0.258 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0048786
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.515
NEC for r=0.4 class 0.0 = 0.183 +- 0.416 (in-sample avg dev_std = 0.156)
NEC for r=0.4 class 1.0 = 0.199 +- 0.416 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all KL = 0.233 +- 0.416 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all L1 = 0.191 +- 0.347 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0316882
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.518
NEC for r=0.8 class 0.0 = 0.186 +- 0.413 (in-sample avg dev_std = 0.157)
NEC for r=0.8 class 1.0 = 0.198 +- 0.413 (in-sample avg dev_std = 0.157)
NEC for r=0.8 all KL = 0.226 +- 0.413 (in-sample avg dev_std = 0.157)
NEC for r=0.8 all L1 = 0.192 +- 0.350 (in-sample avg dev_std = 0.157)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 21:28:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 09:28:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.034


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.962 +- 0.483 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.14 +- 0.483 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.05 all KL = 0.439 +- 0.483 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.05 all L1 = 0.506 +- 0.415 (in-sample avg dev_std = 0.005)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.963 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.14 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.44 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.507 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.964 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.139 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.507 +- 0.416 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.965 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.507 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013253999999999998
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.436 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.503 +- 0.416 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.738 +- 0.469 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.665 +- 0.469 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all KL = 0.646 +- 0.469 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all L1 = 0.702 +- 0.403 (in-sample avg dev_std = 0.122)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.738 +- 0.470 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.665 +- 0.470 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all KL = 0.646 +- 0.470 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all L1 = 0.702 +- 0.403 (in-sample avg dev_std = 0.134)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009226000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.741 +- 0.471 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.668 +- 0.471 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.2 all KL = 0.651 +- 0.471 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.2 all L1 = 0.705 +- 0.402 (in-sample avg dev_std = 0.149)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0050878
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF_SIMPLE for r=0.4 class 0.0 = 0.834 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.772 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.772 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.803 +- 0.357 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.515
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0335534
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.491
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.928 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.942 +- 0.224 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.949 +- 0.195 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.526
NEC for r=0.05 class 0.0 = 0.038 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.74 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.492 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.427 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.039 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.785 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.518 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.452 +- 0.418 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.462
NEC for r=0.2 class 0.0 = 0.042 +- 0.485 (in-sample avg dev_std = 0.001)
NEC for r=0.2 class 1.0 = 0.831 +- 0.485 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all KL = 0.545 +- 0.485 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all L1 = 0.479 +- 0.417 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.46
NEC for r=0.4 class 0.0 = 0.052 +- 0.485 (in-sample avg dev_std = 0.057)
NEC for r=0.4 class 1.0 = 0.826 +- 0.485 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all KL = 0.55 +- 0.485 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all L1 = 0.481 +- 0.416 (in-sample avg dev_std = 0.057)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013253999999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.458
NEC for r=0.8 class 0.0 = 0.039 +- 0.483 (in-sample avg dev_std = 0.206)
NEC for r=0.8 class 1.0 = 0.853 +- 0.483 (in-sample avg dev_std = 0.206)
NEC for r=0.8 all KL = 0.563 +- 0.483 (in-sample avg dev_std = 0.206)
NEC for r=0.8 all L1 = 0.49 +- 0.412 (in-sample avg dev_std = 0.206)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.038 +- 0.216 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.055 +- 0.216 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.057 +- 0.216 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.047 +- 0.181 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.511
NEC for r=0.1 class 0.0 = 0.059 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.077 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.08 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.068 +- 0.222 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009226000000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.509
NEC for r=0.2 class 0.0 = 0.089 +- 0.318 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.119 +- 0.318 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.123 +- 0.318 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.104 +- 0.273 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0050878
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.519
NEC for r=0.4 class 0.0 = 0.189 +- 0.425 (in-sample avg dev_std = 0.157)
NEC for r=0.4 class 1.0 = 0.222 +- 0.425 (in-sample avg dev_std = 0.157)
NEC for r=0.4 all KL = 0.251 +- 0.425 (in-sample avg dev_std = 0.157)
NEC for r=0.4 all L1 = 0.206 +- 0.357 (in-sample avg dev_std = 0.157)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0335534
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.519
NEC for r=0.8 class 0.0 = 0.188 +- 0.419 (in-sample avg dev_std = 0.162)
NEC for r=0.8 class 1.0 = 0.211 +- 0.419 (in-sample avg dev_std = 0.162)
NEC for r=0.8 all KL = 0.237 +- 0.419 (in-sample avg dev_std = 0.162)
NEC for r=0.8 all L1 = 0.2 +- 0.355 (in-sample avg dev_std = 0.162)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 21:41:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 09:41:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.002
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.007
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.024
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.057
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.004
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.028
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.073


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.983 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.137 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.445 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.514 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.442
SUFF_SIMPLE for r=0.1 class 0.0 = 0.976 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.137 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.441 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.511 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.448
SUFF_SIMPLE for r=0.2 class 0.0 = 0.983 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.14 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.447 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.516 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024214000000000003
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.464
SUFF_SIMPLE for r=0.4 class 0.0 = 0.983 +- 0.492 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.164 +- 0.492 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.461 +- 0.492 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.529 +- 0.424 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057266000000000004
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.514
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.238 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.502 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.569 +- 0.422 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.744 +- 0.467 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.682 +- 0.467 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.05 all KL = 0.666 +- 0.467 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.05 all L1 = 0.714 +- 0.400 (in-sample avg dev_std = 0.132)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.489
SUFF_SIMPLE for r=0.1 class 0.0 = 0.745 +- 0.466 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.684 +- 0.466 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all KL = 0.666 +- 0.466 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all L1 = 0.715 +- 0.400 (in-sample avg dev_std = 0.134)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.749 +- 0.465 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.69 +- 0.465 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.2 all KL = 0.671 +- 0.465 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.2 all L1 = 0.72 +- 0.397 (in-sample avg dev_std = 0.145)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0279488
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.507
SUFF_SIMPLE for r=0.4 class 0.0 = 0.86 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.828 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.821 +- 0.377 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.844 +- 0.327 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.516
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07271140000000001
len(reference) = 4915
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.514
SUFF_SIMPLE for r=0.8 class 0.0 = 0.959 +- 0.234 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.93 +- 0.234 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.935 +- 0.234 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.200 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.019 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.779 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.51 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.44 +- 0.421 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001966
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.482
NEC for r=0.1 class 0.0 = 0.021 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.811 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.529 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.458 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.006834000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.464
NEC for r=0.2 class 0.0 = 0.025 +- 0.491 (in-sample avg dev_std = 0.008)
NEC for r=0.2 class 1.0 = 0.83 +- 0.491 (in-sample avg dev_std = 0.008)
NEC for r=0.2 all KL = 0.539 +- 0.491 (in-sample avg dev_std = 0.008)
NEC for r=0.2 all L1 = 0.471 +- 0.423 (in-sample avg dev_std = 0.008)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.024214000000000003
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.455
NEC for r=0.4 class 0.0 = 0.036 +- 0.490 (in-sample avg dev_std = 0.137)
NEC for r=0.4 class 1.0 = 0.84 +- 0.490 (in-sample avg dev_std = 0.137)
NEC for r=0.4 all KL = 0.554 +- 0.490 (in-sample avg dev_std = 0.137)
NEC for r=0.4 all L1 = 0.481 +- 0.420 (in-sample avg dev_std = 0.137)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057266000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
NEC for r=0.8 class 0.0 = 0.018 +- 0.490 (in-sample avg dev_std = 0.086)
NEC for r=0.8 class 1.0 = 0.862 +- 0.490 (in-sample avg dev_std = 0.086)
NEC for r=0.8 all KL = 0.557 +- 0.490 (in-sample avg dev_std = 0.086)
NEC for r=0.8 all L1 = 0.485 +- 0.421 (in-sample avg dev_std = 0.086)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0020399999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.509
NEC for r=0.05 class 0.0 = 0.042 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.079 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.071 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.061 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.004186
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.512
NEC for r=0.1 class 0.0 = 0.063 +- 0.287 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.102 +- 0.287 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.098 +- 0.287 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.083 +- 0.245 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009569800000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.514
NEC for r=0.2 class 0.0 = 0.101 +- 0.339 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.138 +- 0.339 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.141 +- 0.339 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.12 +- 0.291 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0279488
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.516
NEC for r=0.4 class 0.0 = 0.188 +- 0.418 (in-sample avg dev_std = 0.162)
NEC for r=0.4 class 1.0 = 0.202 +- 0.418 (in-sample avg dev_std = 0.162)
NEC for r=0.4 all KL = 0.237 +- 0.418 (in-sample avg dev_std = 0.162)
NEC for r=0.4 all L1 = 0.195 +- 0.350 (in-sample avg dev_std = 0.162)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.52
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07271140000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.475
NEC for r=0.8 class 0.0 = 0.176 +- 0.418 (in-sample avg dev_std = 0.164)
NEC for r=0.8 class 1.0 = 0.217 +- 0.418 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all KL = 0.238 +- 0.418 (in-sample avg dev_std = 0.164)
NEC for r=0.8 all L1 = 0.196 +- 0.352 (in-sample avg dev_std = 0.164)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 21:53:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 09:53:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.013
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.001
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.005
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.033


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.973 +- 0.485 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.143 +- 0.485 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.143 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013007999999999999
len(reference) = 496
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.442
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.445 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.51 +- 0.417 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.689 +- 0.464 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all KL = 0.668 +- 0.464 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all L1 = 0.716 +- 0.398 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.688 +- 0.464 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all KL = 0.666 +- 0.464 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.1 all L1 = 0.716 +- 0.398 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.745 +- 0.464 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.691 +- 0.464 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all KL = 0.669 +- 0.464 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.2 all L1 = 0.718 +- 0.397 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.492
SUFF_SIMPLE for r=0.4 class 0.0 = 0.837 +- 0.401 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.795 +- 0.401 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.788 +- 0.401 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.816 +- 0.347 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.506
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033146
len(reference) = 4812
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.491
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.945 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.952 +- 0.205 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.959 +- 0.175 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.03 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.767 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.501 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.438 +- 0.416 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.474
NEC for r=0.1 class 0.0 = 0.029 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.817 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.531 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.465 +- 0.416 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.456
NEC for r=0.2 class 0.0 = 0.034 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.834 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.54 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.477 +- 0.418 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.000248
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.452
NEC for r=0.4 class 0.0 = 0.045 +- 0.485 (in-sample avg dev_std = 0.031)
NEC for r=0.4 class 1.0 = 0.833 +- 0.485 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all KL = 0.547 +- 0.485 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all L1 = 0.482 +- 0.417 (in-sample avg dev_std = 0.031)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.013007999999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.451
NEC for r=0.8 class 0.0 = 0.031 +- 0.483 (in-sample avg dev_std = 0.154)
NEC for r=0.8 class 1.0 = 0.854 +- 0.483 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all KL = 0.555 +- 0.483 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all L1 = 0.487 +- 0.414 (in-sample avg dev_std = 0.154)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.039 +- 0.219 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.062 +- 0.219 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.057 +- 0.219 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.05 +- 0.189 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.502
NEC for r=0.1 class 0.0 = 0.06 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.081 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.083 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.071 +- 0.226 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0009156
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.505
NEC for r=0.2 class 0.0 = 0.088 +- 0.308 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.108 +- 0.308 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.114 +- 0.308 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.098 +- 0.264 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.005046200000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.517
NEC for r=0.4 class 0.0 = 0.187 +- 0.419 (in-sample avg dev_std = 0.156)
NEC for r=0.4 class 1.0 = 0.209 +- 0.419 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all KL = 0.241 +- 0.419 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all L1 = 0.198 +- 0.351 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.511
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.033146
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.519
NEC for r=0.8 class 0.0 = 0.188 +- 0.414 (in-sample avg dev_std = 0.153)
NEC for r=0.8 class 1.0 = 0.201 +- 0.414 (in-sample avg dev_std = 0.153)
NEC for r=0.8 all KL = 0.229 +- 0.414 (in-sample avg dev_std = 0.153)
NEC for r=0.8 all L1 = 0.194 +- 0.351 (in-sample avg dev_std = 0.153)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.453, 0.453, 0.454, 0.454, 0.449], 'all_L1': [0.52, 0.52, 0.52, 0.52, 0.516]}), defaultdict(<class 'list'>, {'all_KL': [0.431, 0.427, 0.433, 0.449, 0.494], 'all_L1': [0.497, 0.493, 0.498, 0.512, 0.559]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.447, 0.447, 0.447, 0.443], 'all_L1': [0.508, 0.509, 0.509, 0.509, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.457, 0.458, 0.458, 0.458, 0.454], 'all_L1': [0.522, 0.522, 0.522, 0.522, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.456, 0.456, 0.457, 0.457, 0.452], 'all_L1': [0.522, 0.522, 0.522, 0.522, 0.518]}), defaultdict(<class 'list'>, {'all_KL': [0.434, 0.435, 0.435, 0.436, 0.431], 'all_L1': [0.494, 0.494, 0.494, 0.494, 0.491]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.439, 0.44, 0.441, 0.436], 'all_L1': [0.502, 0.503, 0.503, 0.503, 0.499]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.44, 0.441, 0.441, 0.436], 'all_L1': [0.506, 0.507, 0.507, 0.507, 0.503]}), defaultdict(<class 'list'>, {'all_KL': [0.445, 0.441, 0.447, 0.461, 0.502], 'all_L1': [0.514, 0.511, 0.516, 0.529, 0.569]}), defaultdict(<class 'list'>, {'all_KL': [0.449, 0.449, 0.449, 0.449, 0.445], 'all_L1': [0.513, 0.513, 0.513, 0.513, 0.51]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.491, 0.524, 0.539, 0.545, 0.552], 'all_L1': [0.428, 0.457, 0.472, 0.475, 0.48]}), defaultdict(<class 'list'>, {'all_KL': [0.512, 0.54, 0.552, 0.564, 0.572], 'all_L1': [0.446, 0.473, 0.487, 0.495, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.539, 0.546, 0.548, 0.558], 'all_L1': [0.449, 0.477, 0.485, 0.485, 0.492]}), defaultdict(<class 'list'>, {'all_KL': [0.488, 0.516, 0.535, 0.538, 0.542], 'all_L1': [0.424, 0.451, 0.47, 0.473, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.495, 0.522, 0.537, 0.539, 0.553], 'all_L1': [0.431, 0.456, 0.47, 0.472, 0.478]}), defaultdict(<class 'list'>, {'all_KL': [0.508, 0.541, 0.553, 0.555, 0.57], 'all_L1': [0.451, 0.481, 0.494, 0.495, 0.505]}), defaultdict(<class 'list'>, {'all_KL': [0.516, 0.544, 0.555, 0.559, 0.565], 'all_L1': [0.452, 0.48, 0.491, 0.495, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.492, 0.518, 0.545, 0.55, 0.563], 'all_L1': [0.427, 0.452, 0.479, 0.481, 0.49]}), defaultdict(<class 'list'>, {'all_KL': [0.51, 0.529, 0.539, 0.554, 0.557], 'all_L1': [0.44, 0.458, 0.471, 0.481, 0.485]}), defaultdict(<class 'list'>, {'all_KL': [0.501, 0.531, 0.54, 0.547, 0.555], 'all_L1': [0.438, 0.465, 0.477, 0.482, 0.487]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.582, 0.582, 0.582, 0.582, 0.582], 'all_L1': [0.615, 0.615, 0.615, 0.615, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.758, 0.758, 0.758, 0.758, 0.758], 'all_L1': [0.768, 0.768, 0.768, 0.768, 0.768]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.639, 0.639, 0.639, 0.639], 'all_L1': [0.658, 0.658, 0.658, 0.658, 0.658]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.868, 0.868, 0.868, 0.868], 'all_L1': [0.867, 0.867, 0.867, 0.867, 0.867]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.721, 0.721, 0.721, 0.721], 'all_L1': [0.734, 0.734, 0.734, 0.734, 0.734]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.786, 0.786, 0.786, 0.786], 'all_L1': [0.784, 0.784, 0.784, 0.784, 0.784]}), defaultdict(<class 'list'>, {'all_KL': [0.344, 0.344, 0.344, 0.344, 0.344], 'all_L1': [0.407, 0.407, 0.407, 0.407, 0.407]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.921, 0.921, 0.921, 0.921], 'all_L1': [0.918, 0.918, 0.918, 0.918, 0.918]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.941, 0.941, 0.941, 0.941], 'all_L1': [0.938, 0.938, 0.938, 0.938, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.945, 0.945, 0.945, 0.945], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.418, 0.418, 0.418, 0.418, 0.418], 'all_L1': [0.385, 0.385, 0.385, 0.385, 0.385]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.242, 0.242, 0.242, 0.242], 'all_L1': [0.232, 0.232, 0.232, 0.232, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.361, 0.361, 0.361, 0.361], 'all_L1': [0.342, 0.342, 0.342, 0.342, 0.342]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.132, 0.132, 0.132, 0.132], 'all_L1': [0.133, 0.133, 0.133, 0.133, 0.133]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.279, 0.279, 0.279, 0.279], 'all_L1': [0.266, 0.266, 0.266, 0.266, 0.266]}), defaultdict(<class 'list'>, {'all_KL': [0.214, 0.214, 0.214, 0.214, 0.214], 'all_L1': [0.216, 0.216, 0.216, 0.216, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.656, 0.656, 0.656, 0.656], 'all_L1': [0.593, 0.593, 0.593, 0.593, 0.593]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.079, 0.079, 0.079], 'all_L1': [0.082, 0.082, 0.082, 0.082, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.059, 0.059, 0.059, 0.059, 0.059], 'all_L1': [0.062, 0.062, 0.062, 0.062, 0.062]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.055, 0.055, 0.055, 0.055], 'all_L1': [0.056, 0.056, 0.056, 0.056, 0.056]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.657, 0.658, 0.661, 0.777, 0.95], 'all_L1': [0.71, 0.71, 0.712, 0.807, 0.956]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.657, 0.66, 0.806, 0.927], 'all_L1': [0.704, 0.706, 0.71, 0.832, 0.939]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.668, 0.671, 0.788, 0.951], 'all_L1': [0.718, 0.718, 0.719, 0.817, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.666, 0.665, 0.667, 0.786, 0.95], 'all_L1': [0.715, 0.715, 0.717, 0.815, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.668, 0.667, 0.67, 0.789, 0.956], 'all_L1': [0.718, 0.717, 0.72, 0.817, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.658, 0.658, 0.662, 0.777, 0.947], 'all_L1': [0.708, 0.709, 0.712, 0.807, 0.953]}), defaultdict(<class 'list'>, {'all_KL': [0.668, 0.669, 0.672, 0.795, 0.956], 'all_L1': [0.72, 0.72, 0.722, 0.823, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.646, 0.646, 0.651, 0.772, 0.942], 'all_L1': [0.702, 0.702, 0.705, 0.803, 0.949]}), defaultdict(<class 'list'>, {'all_KL': [0.666, 0.666, 0.671, 0.821, 0.935], 'all_L1': [0.714, 0.715, 0.72, 0.844, 0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.668, 0.666, 0.669, 0.788, 0.952], 'all_L1': [0.716, 0.716, 0.718, 0.816, 0.959]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.052, 0.076, 0.118, 0.252, 0.238], 'all_L1': [0.044, 0.063, 0.1, 0.206, 0.199]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.103, 0.15, 0.246, 0.244], 'all_L1': [0.065, 0.086, 0.126, 0.201, 0.203]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.081, 0.111, 0.241, 0.223], 'all_L1': [0.049, 0.068, 0.094, 0.195, 0.189]}), defaultdict(<class 'list'>, {'all_KL': [0.058, 0.081, 0.113, 0.238, 0.23], 'all_L1': [0.05, 0.07, 0.097, 0.196, 0.195]}), defaultdict(<class 'list'>, {'all_KL': [0.049, 0.071, 0.11, 0.239, 0.232], 'all_L1': [0.041, 0.061, 0.093, 0.195, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.056, 0.081, 0.119, 0.249, 0.234], 'all_L1': [0.049, 0.068, 0.101, 0.203, 0.199]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.077, 0.108, 0.233, 0.226], 'all_L1': [0.046, 0.065, 0.092, 0.191, 0.192]}), defaultdict(<class 'list'>, {'all_KL': [0.057, 0.08, 0.123, 0.251, 0.237], 'all_L1': [0.047, 0.068, 0.104, 0.206, 0.2]}), defaultdict(<class 'list'>, {'all_KL': [0.071, 0.098, 0.141, 0.237, 0.238], 'all_L1': [0.061, 0.083, 0.12, 0.195, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.057, 0.083, 0.114, 0.241, 0.229], 'all_L1': [0.05, 0.071, 0.098, 0.198, 0.194]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.510 +- 0.010, 0.509 +- 0.010, 0.510 +- 0.009, 0.513 +- 0.010, 0.519 +- 0.024
suff_simple class all_KL  =  0.445 +- 0.009, 0.445 +- 0.009, 0.446 +- 0.008, 0.449 +- 0.008, 0.454 +- 0.023
suff_simple_acc_int  =  0.446 +- 0.000, 0.445 +- 0.002, 0.446 +- 0.001, 0.450 +- 0.007, 0.457 +- 0.031
nec class all_L1  =  0.439 +- 0.010, 0.465 +- 0.011, 0.480 +- 0.009, 0.483 +- 0.009, 0.490 +- 0.010
nec class all_KL  =  0.502 +- 0.010, 0.530 +- 0.010, 0.544 +- 0.007, 0.550 +- 0.008, 0.559 +- 0.009
nec_acc_int  =  0.510 +- 0.008, 0.479 +- 0.008, 0.459 +- 0.003, 0.454 +- 0.003, 0.451 +- 0.003

Eval split val
suff_simple class all_L1  =  0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161
suff_simple class all_KL  =  0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180
suff_simple_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000
nec class all_L1  =  0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161
nec class all_KL  =  0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180
nec_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000

Eval split test
suff_simple class all_L1  =  0.712 +- 0.006, 0.713 +- 0.005, 0.716 +- 0.005, 0.818 +- 0.012, 0.954 +- 0.007
suff_simple class all_KL  =  0.662 +- 0.007, 0.662 +- 0.007, 0.665 +- 0.006, 0.790 +- 0.014, 0.947 +- 0.009
suff_simple_acc_int  =  0.488 +- 0.000, 0.488 +- 0.001, 0.488 +- 0.001, 0.494 +- 0.006, 0.495 +- 0.010
nec class all_L1  =  0.050 +- 0.007, 0.070 +- 0.008, 0.102 +- 0.011, 0.199 +- 0.005, 0.196 +- 0.004
nec class all_KL  =  0.059 +- 0.008, 0.083 +- 0.009, 0.121 +- 0.013, 0.243 +- 0.006, 0.233 +- 0.006
nec_acc_int  =  0.507 +- 0.004, 0.507 +- 0.005, 0.507 +- 0.004, 0.517 +- 0.002, 0.510 +- 0.017


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.474 +- 0.003, 0.487 +- 0.004, 0.495 +- 0.002, 0.498 +- 0.003, 0.504 +- 0.013
Faith. Armon (L1)= 		  =  0.471 +- 0.004, 0.486 +- 0.004, 0.494 +- 0.002, 0.498 +- 0.003, 0.503 +- 0.012
Faith. GMean (L1)= 	  =  0.473 +- 0.003, 0.487 +- 0.004, 0.495 +- 0.002, 0.498 +- 0.003, 0.504 +- 0.012
Faith. Aritm (KL)= 		  =  0.474 +- 0.004, 0.487 +- 0.004, 0.495 +- 0.002, 0.500 +- 0.004, 0.506 +- 0.012
Faith. Armon (KL)= 		  =  0.472 +- 0.004, 0.484 +- 0.004, 0.490 +- 0.003, 0.494 +- 0.004, 0.501 +- 0.014
Faith. GMean (KL)= 	  =  0.473 +- 0.004, 0.485 +- 0.004, 0.493 +- 0.002, 0.497 +- 0.004, 0.504 +- 0.013

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000
Faith. Armon (L1)= 		  =  0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140
Faith. GMean (L1)= 	  =  0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097
Faith. Aritm (KL)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000
Faith. Armon (KL)= 		  =  0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142
Faith. GMean (KL)= 	  =  0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099

Eval split test
Faith. Aritm (L1)= 		  =  0.381 +- 0.004, 0.392 +- 0.004, 0.409 +- 0.005, 0.508 +- 0.005, 0.575 +- 0.003
Faith. Armon (L1)= 		  =  0.094 +- 0.012, 0.128 +- 0.013, 0.179 +- 0.016, 0.320 +- 0.006, 0.326 +- 0.005
Faith. GMean (L1)= 	  =  0.189 +- 0.013, 0.224 +- 0.012, 0.270 +- 0.014, 0.403 +- 0.004, 0.433 +- 0.003
Faith. Aritm (KL)= 		  =  0.361 +- 0.005, 0.373 +- 0.005, 0.393 +- 0.006, 0.516 +- 0.006, 0.590 +- 0.003
Faith. Armon (KL)= 		  =  0.108 +- 0.014, 0.147 +- 0.015, 0.204 +- 0.019, 0.371 +- 0.006, 0.374 +- 0.007
Faith. GMean (KL)= 	  =  0.197 +- 0.013, 0.234 +- 0.013, 0.283 +- 0.015, 0.438 +- 0.005, 0.470 +- 0.005
Computed for split load_split = id



Completed in  2:06:28.330412  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 22:06:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 10:06:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 68 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 68...
[0m[1;37mINFO[0m: [1mCheckpoint 68: 
-----------------------------------
Train ACCURACY: 0.9968
Train Loss: 0.0147
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0166
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0277
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0166
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0277

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.029
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.035
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.020
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.030
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.046


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.989 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.143 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.454 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.52 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012716000000000002
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.444
SUFF_SIMPLE for r=0.1 class 0.0 = 0.983 +- 0.488 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 all KL = 0.451 +- 0.488 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 all L1 = 0.518 +- 0.422 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02169
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.444
SUFF_SIMPLE for r=0.2 class 0.0 = 0.985 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.143 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.452 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.518 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028654000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.989 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.454 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.52 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034980000000000004
len(reference) = 497
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.449
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.153 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.457 +- 0.489 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.523 +- 0.423 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023496
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0028454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019380000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010522
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005406
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.886 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.349 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.615 +- 0.406 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0082018
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.742 +- 0.467 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.681 +- 0.467 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all KL = 0.664 +- 0.467 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all L1 = 0.712 +- 0.400 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012098600000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.743 +- 0.467 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.681 +- 0.467 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.1 all KL = 0.665 +- 0.467 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.1 all L1 = 0.712 +- 0.400 (in-sample avg dev_std = 0.124)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0198236
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.486
SUFF_SIMPLE for r=0.2 class 0.0 = 0.745 +- 0.467 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.681 +- 0.467 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all KL = 0.665 +- 0.467 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all L1 = 0.713 +- 0.400 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0301872
len(reference) = 4996
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.467
SUFF_SIMPLE for r=0.4 class 0.0 = 0.803 +- 0.444 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.71 +- 0.444 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all KL = 0.718 +- 0.444 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.4 all L1 = 0.757 +- 0.382 (in-sample avg dev_std = 0.065)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.512
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0462344
len(reference) = 4874
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.473
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.261 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.898 +- 0.261 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.922 +- 0.261 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.933 +- 0.224 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.021 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.749 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.488 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.425 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012716000000000002
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.476
NEC for r=0.1 class 0.0 = 0.026 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.801 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.524 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.455 +- 0.421 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02169
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.454
NEC for r=0.2 class 0.0 = 0.025 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.835 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.54 +- 0.488 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.473 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028654000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.449
NEC for r=0.4 class 0.0 = 0.025 +- 0.488 (in-sample avg dev_std = 0.054)
NEC for r=0.4 class 1.0 = 0.844 +- 0.488 (in-sample avg dev_std = 0.054)
NEC for r=0.4 all KL = 0.547 +- 0.488 (in-sample avg dev_std = 0.054)
NEC for r=0.4 all L1 = 0.479 +- 0.422 (in-sample avg dev_std = 0.054)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034980000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
NEC for r=0.8 class 0.0 = 0.016 +- 0.487 (in-sample avg dev_std = 0.107)
NEC for r=0.8 class 1.0 = 0.856 +- 0.487 (in-sample avg dev_std = 0.107)
NEC for r=0.8 all KL = 0.551 +- 0.487 (in-sample avg dev_std = 0.107)
NEC for r=0.8 all L1 = 0.481 +- 0.421 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.805
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023496
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.805
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0028454
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.805
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019380000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.805
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010522
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.805
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005406
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.114 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.651 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.418 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.385 +- 0.406 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.519
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0082018
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.042 +- 0.240 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.074 +- 0.240 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.069 +- 0.240 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.058 +- 0.205 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.519
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012098600000000001
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.062 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.098 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.093 +- 0.280 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.08 +- 0.241 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.519
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0198236
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.495
NEC for r=0.2 class 0.0 = 0.1 +- 0.343 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.147 +- 0.343 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.144 +- 0.343 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.123 +- 0.294 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.519
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0301872
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.481
NEC for r=0.4 class 0.0 = 0.183 +- 0.419 (in-sample avg dev_std = 0.140)
NEC for r=0.4 class 1.0 = 0.219 +- 0.419 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all KL = 0.238 +- 0.419 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all L1 = 0.201 +- 0.355 (in-sample avg dev_std = 0.140)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.519
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0462344
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.481
NEC for r=0.8 class 0.0 = 0.181 +- 0.420 (in-sample avg dev_std = 0.168)
NEC for r=0.8 class 1.0 = 0.217 +- 0.420 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all KL = 0.238 +- 0.420 (in-sample avg dev_std = 0.168)
NEC for r=0.8 all L1 = 0.199 +- 0.353 (in-sample avg dev_std = 0.168)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 22:19:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 10:19:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 70 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 70...
[0m[1;37mINFO[0m: [1mCheckpoint 70: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0301
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0270
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0289
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0270
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0289

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.001
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.004
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.014
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.051
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.001
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.006
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.020
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.058


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000876
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.137 +- 0.483 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.05 all KL = 0.431 +- 0.483 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.05 all L1 = 0.497 +- 0.413 (in-sample avg dev_std = 0.004)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.00073
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.137 +- 0.483 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.431 +- 0.483 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.497 +- 0.413 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.003902
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.137 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.431 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.497 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.014376
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.944 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.136 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.431 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.497 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.050894
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.459
SUFF_SIMPLE for r=0.8 class 0.0 = 0.94 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.158 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.439 +- 0.483 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.506 +- 0.413 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.9e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.559 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.768 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006433999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.739 +- 0.469 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.671 +- 0.469 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all KL = 0.656 +- 0.469 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all L1 = 0.705 +- 0.403 (in-sample avg dev_std = 0.128)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001472
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.489
SUFF_SIMPLE for r=0.1 class 0.0 = 0.739 +- 0.469 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.671 +- 0.469 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.1 all KL = 0.656 +- 0.469 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.1 all L1 = 0.705 +- 0.402 (in-sample avg dev_std = 0.130)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.005711
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.49
SUFF_SIMPLE for r=0.2 class 0.0 = 0.74 +- 0.469 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.676 +- 0.469 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 all KL = 0.658 +- 0.469 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 all L1 = 0.708 +- 0.401 (in-sample avg dev_std = 0.143)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0203982
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.486
SUFF_SIMPLE for r=0.4 class 0.0 = 0.826 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.761 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.763 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.794 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.518
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0577382
len(reference) = 4916
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.479
SUFF_SIMPLE for r=0.8 class 0.0 = 0.944 +- 0.300 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.871 +- 0.300 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.894 +- 0.300 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.907 +- 0.260 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000876
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.498
NEC for r=0.05 class 0.0 = 0.052 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.783 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.522 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.457 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.00073
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.49
NEC for r=0.1 class 0.0 = 0.057 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.799 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.533 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.468 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.003902
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.456
NEC for r=0.2 class 0.0 = 0.067 +- 0.482 (in-sample avg dev_std = 0.007)
NEC for r=0.2 class 1.0 = 0.841 +- 0.482 (in-sample avg dev_std = 0.007)
NEC for r=0.2 all KL = 0.564 +- 0.482 (in-sample avg dev_std = 0.007)
NEC for r=0.2 all L1 = 0.496 +- 0.412 (in-sample avg dev_std = 0.007)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.014376
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.442
NEC for r=0.4 class 0.0 = 0.07 +- 0.482 (in-sample avg dev_std = 0.047)
NEC for r=0.4 class 1.0 = 0.85 +- 0.482 (in-sample avg dev_std = 0.047)
NEC for r=0.4 all KL = 0.569 +- 0.482 (in-sample avg dev_std = 0.047)
NEC for r=0.4 all L1 = 0.502 +- 0.411 (in-sample avg dev_std = 0.047)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.050894
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
NEC for r=0.8 class 0.0 = 0.058 +- 0.481 (in-sample avg dev_std = 0.083)
NEC for r=0.8 class 1.0 = 0.863 +- 0.481 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all KL = 0.571 +- 0.481 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all L1 = 0.504 +- 0.411 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.724
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.724
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.724
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.724
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.724
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.9e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.019 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.441 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.242 +- 0.394 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.232 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.523
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006433999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.515
NEC for r=0.05 class 0.0 = 0.049 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.069 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.069 +- 0.241 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.059 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.523
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001472
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.514
NEC for r=0.1 class 0.0 = 0.072 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.09 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.096 +- 0.284 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.081 +- 0.242 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.523
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.005711
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.506
NEC for r=0.2 class 0.0 = 0.127 +- 0.365 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.159 +- 0.365 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.169 +- 0.365 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.143 +- 0.313 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.523
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0203982
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.491
NEC for r=0.4 class 0.0 = 0.19 +- 0.423 (in-sample avg dev_std = 0.134)
NEC for r=0.4 class 1.0 = 0.218 +- 0.423 (in-sample avg dev_std = 0.134)
NEC for r=0.4 all KL = 0.245 +- 0.423 (in-sample avg dev_std = 0.134)
NEC for r=0.4 all L1 = 0.204 +- 0.357 (in-sample avg dev_std = 0.134)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.523
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0577382
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.475
NEC for r=0.8 class 0.0 = 0.181 +- 0.423 (in-sample avg dev_std = 0.157)
NEC for r=0.8 class 1.0 = 0.232 +- 0.423 (in-sample avg dev_std = 0.157)
NEC for r=0.8 all KL = 0.243 +- 0.423 (in-sample avg dev_std = 0.157)
NEC for r=0.8 all L1 = 0.206 +- 0.359 (in-sample avg dev_std = 0.157)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 22:32:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 10:32:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0228
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0266
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0223
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0266
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0223

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.015
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.025
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.021
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.032
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.048


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008884
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.05 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.015101999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.025342000000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03263
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.963 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.143 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.447 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.509 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037082000000000004
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.448
SUFF_SIMPLE for r=0.8 class 0.0 = 0.958 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.151 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.447 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.509 +- 0.414 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0027492000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031244
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.002121
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0011612
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005922
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.949 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.371 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.639 +- 0.440 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.658 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089108
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.742 +- 0.464 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.695 +- 0.464 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.05 all KL = 0.673 +- 0.464 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.05 all L1 = 0.719 +- 0.397 (in-sample avg dev_std = 0.124)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0136316
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.696 +- 0.464 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all KL = 0.674 +- 0.464 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all L1 = 0.72 +- 0.397 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0205622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.744 +- 0.463 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.697 +- 0.463 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.2 all KL = 0.675 +- 0.463 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.2 all L1 = 0.72 +- 0.397 (in-sample avg dev_std = 0.128)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0319246
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.468
SUFF_SIMPLE for r=0.4 class 0.0 = 0.803 +- 0.440 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.725 +- 0.440 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.4 all KL = 0.727 +- 0.440 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.4 all L1 = 0.765 +- 0.378 (in-sample avg dev_std = 0.055)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.504
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047616399999999996
len(reference) = 4866
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.966 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.913 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.93 +- 0.247 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.94 +- 0.212 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008884
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.494
NEC for r=0.05 class 0.0 = 0.037 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.78 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.509 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.448 +- 0.412 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.015101999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.476
NEC for r=0.1 class 0.0 = 0.038 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.809 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.525 +- 0.481 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.465 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.025342000000000003
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
NEC for r=0.2 class 0.0 = 0.041 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.836 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.543 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.481 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03263
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.448
NEC for r=0.4 class 0.0 = 0.045 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.845 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.55 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.488 +- 0.415 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037082000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.446
NEC for r=0.8 class 0.0 = 0.042 +- 0.478 (in-sample avg dev_std = 0.080)
NEC for r=0.8 class 1.0 = 0.856 +- 0.478 (in-sample avg dev_std = 0.080)
NEC for r=0.8 all KL = 0.557 +- 0.478 (in-sample avg dev_std = 0.080)
NEC for r=0.8 all L1 = 0.493 +- 0.413 (in-sample avg dev_std = 0.080)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.819
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0027492000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.819
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031244
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.819
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.002121
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.819
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0011612
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.819
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005922
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.051 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.629 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.361 +- 0.440 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.342 +- 0.391 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.508
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089108
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.503
NEC for r=0.05 class 0.0 = 0.041 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.066 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.063 +- 0.229 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.053 +- 0.195 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.508
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0136316
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.494
NEC for r=0.1 class 0.0 = 0.059 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.087 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.086 +- 0.270 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.073 +- 0.230 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.508
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0205622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.49
NEC for r=0.2 class 0.0 = 0.1 +- 0.332 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.13 +- 0.332 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.134 +- 0.332 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.115 +- 0.284 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.508
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0319246
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.481
NEC for r=0.4 class 0.0 = 0.178 +- 0.411 (in-sample avg dev_std = 0.134)
NEC for r=0.4 class 1.0 = 0.204 +- 0.411 (in-sample avg dev_std = 0.134)
NEC for r=0.4 all KL = 0.226 +- 0.411 (in-sample avg dev_std = 0.134)
NEC for r=0.4 all L1 = 0.191 +- 0.349 (in-sample avg dev_std = 0.134)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047616399999999996
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.481
NEC for r=0.8 class 0.0 = 0.177 +- 0.411 (in-sample avg dev_std = 0.162)
NEC for r=0.8 class 1.0 = 0.202 +- 0.411 (in-sample avg dev_std = 0.162)
NEC for r=0.8 all KL = 0.225 +- 0.411 (in-sample avg dev_std = 0.162)
NEC for r=0.8 all L1 = 0.189 +- 0.347 (in-sample avg dev_std = 0.162)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 22:44:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 10:44:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9942
Train Loss: 0.0204
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0352
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0352

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.014
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.019
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.027
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.036
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.039
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.015
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.023
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.034
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.049


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.014102
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.018676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.027454
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03550199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038992000000000006
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.449
SUFF_SIMPLE for r=0.8 class 0.0 = 0.991 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.15 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.459 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.524 +- 0.422 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0024146000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030756
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021922
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012228000000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006318000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.739 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.868 +- 0.301 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.867 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009438
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.489
SUFF_SIMPLE for r=0.05 class 0.0 = 0.744 +- 0.465 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.687 +- 0.465 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.05 all KL = 0.669 +- 0.465 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.05 all L1 = 0.715 +- 0.399 (in-sample avg dev_std = 0.120)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0147714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.489
SUFF_SIMPLE for r=0.1 class 0.0 = 0.744 +- 0.465 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.686 +- 0.465 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all KL = 0.669 +- 0.465 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.1 all L1 = 0.715 +- 0.399 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023277600000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.487
SUFF_SIMPLE for r=0.2 class 0.0 = 0.746 +- 0.465 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.688 +- 0.465 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 all KL = 0.67 +- 0.465 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.2 all L1 = 0.717 +- 0.398 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033895
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.469
SUFF_SIMPLE for r=0.4 class 0.0 = 0.804 +- 0.441 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.716 +- 0.441 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.4 all KL = 0.723 +- 0.441 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.4 all L1 = 0.76 +- 0.381 (in-sample avg dev_std = 0.053)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.509
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0490016
len(reference) = 4866
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.477
SUFF_SIMPLE for r=0.8 class 0.0 = 0.967 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.903 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.927 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.936 +- 0.220 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.014102
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.013 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.764 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.491 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.429 +- 0.421 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.018676
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.484
NEC for r=0.1 class 0.0 = 0.01 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.798 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.508 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.446 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.027454
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.462
NEC for r=0.2 class 0.0 = 0.013 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.826 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.526 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.463 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03550199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.441
NEC for r=0.4 class 0.0 = 0.021 +- 0.485 (in-sample avg dev_std = 0.066)
NEC for r=0.4 class 1.0 = 0.854 +- 0.485 (in-sample avg dev_std = 0.066)
NEC for r=0.4 all KL = 0.548 +- 0.485 (in-sample avg dev_std = 0.066)
NEC for r=0.4 all L1 = 0.483 +- 0.421 (in-sample avg dev_std = 0.066)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.038992000000000006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
NEC for r=0.8 class 0.0 = 0.009 +- 0.486 (in-sample avg dev_std = 0.064)
NEC for r=0.8 class 1.0 = 0.854 +- 0.486 (in-sample avg dev_std = 0.064)
NEC for r=0.8 all KL = 0.542 +- 0.486 (in-sample avg dev_std = 0.064)
NEC for r=0.8 all L1 = 0.477 +- 0.422 (in-sample avg dev_std = 0.064)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.622
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0024146000000000003
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.622
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030756
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.622
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021922
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.622
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012228000000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.622
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006318000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.004 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.261 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.132 +- 0.301 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.133 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009438
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.503
NEC for r=0.05 class 0.0 = 0.041 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.068 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.063 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.055 +- 0.198 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0147714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.499
NEC for r=0.1 class 0.0 = 0.061 +- 0.271 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.089 +- 0.271 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.086 +- 0.271 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.075 +- 0.234 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023277600000000002
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.489
NEC for r=0.2 class 0.0 = 0.099 +- 0.335 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.14 +- 0.335 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.137 +- 0.335 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.119 +- 0.290 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.033895
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.481
NEC for r=0.4 class 0.0 = 0.178 +- 0.414 (in-sample avg dev_std = 0.140)
NEC for r=0.4 class 1.0 = 0.211 +- 0.414 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all KL = 0.23 +- 0.414 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all L1 = 0.194 +- 0.351 (in-sample avg dev_std = 0.140)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0490016
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.48
NEC for r=0.8 class 0.0 = 0.18 +- 0.415 (in-sample avg dev_std = 0.160)
NEC for r=0.8 class 1.0 = 0.212 +- 0.415 (in-sample avg dev_std = 0.160)
NEC for r=0.8 all KL = 0.232 +- 0.415 (in-sample avg dev_std = 0.160)
NEC for r=0.8 all L1 = 0.196 +- 0.352 (in-sample avg dev_std = 0.160)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 22:57:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 10:57:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9978
Train Loss: 0.0136
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0196
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0292
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0196
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0292

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.028
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.034
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.021
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.032
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008905999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.991 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.145 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.457 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014178000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.99 +- 0.487 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.145 +- 0.487 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 all KL = 0.456 +- 0.487 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02224
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.444
SUFF_SIMPLE for r=0.2 class 0.0 = 0.987 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.145 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.455 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.52 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028222
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.145 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.457 +- 0.488 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.522 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034212000000000006
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.453
SUFF_SIMPLE for r=0.8 class 0.0 = 0.991 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.156 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.462 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.527 +- 0.423 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023972
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029088
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019487999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010424
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005308
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.493 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.721 +- 0.414 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.734 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.007886
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.748 +- 0.465 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.69 +- 0.465 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.05 all KL = 0.673 +- 0.465 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.05 all L1 = 0.719 +- 0.399 (in-sample avg dev_std = 0.120)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012444799999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.748 +- 0.465 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.691 +- 0.465 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all KL = 0.673 +- 0.465 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all L1 = 0.72 +- 0.398 (in-sample avg dev_std = 0.129)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020794
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.487
SUFF_SIMPLE for r=0.2 class 0.0 = 0.749 +- 0.464 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.691 +- 0.464 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all KL = 0.674 +- 0.464 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all L1 = 0.721 +- 0.398 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031668
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.469
SUFF_SIMPLE for r=0.4 class 0.0 = 0.812 +- 0.438 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.724 +- 0.438 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.4 all KL = 0.733 +- 0.438 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.4 all L1 = 0.768 +- 0.378 (in-sample avg dev_std = 0.051)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0472654
len(reference) = 4867
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.972 +- 0.241 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.912 +- 0.241 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.241 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.209 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008905999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.02 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.752 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.491 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.426 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014178000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.486
NEC for r=0.1 class 0.0 = 0.017 +- 0.488 (in-sample avg dev_std = 0.031)
NEC for r=0.1 class 1.0 = 0.792 +- 0.488 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.511 +- 0.488 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.446 +- 0.422 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.02224
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
NEC for r=0.2 class 0.0 = 0.021 +- 0.488 (in-sample avg dev_std = 0.041)
NEC for r=0.2 class 1.0 = 0.826 +- 0.488 (in-sample avg dev_std = 0.041)
NEC for r=0.2 all KL = 0.532 +- 0.488 (in-sample avg dev_std = 0.041)
NEC for r=0.2 all L1 = 0.467 +- 0.423 (in-sample avg dev_std = 0.041)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.028222
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
NEC for r=0.4 class 0.0 = 0.025 +- 0.487 (in-sample avg dev_std = 0.031)
NEC for r=0.4 class 1.0 = 0.846 +- 0.487 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all KL = 0.547 +- 0.487 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all L1 = 0.48 +- 0.422 (in-sample avg dev_std = 0.031)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.034212000000000006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
NEC for r=0.8 class 0.0 = 0.014 +- 0.485 (in-sample avg dev_std = 0.101)
NEC for r=0.8 class 1.0 = 0.854 +- 0.485 (in-sample avg dev_std = 0.101)
NEC for r=0.8 all KL = 0.551 +- 0.485 (in-sample avg dev_std = 0.101)
NEC for r=0.8 all L1 = 0.48 +- 0.421 (in-sample avg dev_std = 0.101)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0023972
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029088
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0019487999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010424
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005308
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.021 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.507 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.279 +- 0.414 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.266 +- 0.371 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.516
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.007886
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.505
NEC for r=0.05 class 0.0 = 0.04 +- 0.237 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.073 +- 0.237 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.066 +- 0.237 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.203 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.516
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.012444799999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.5
NEC for r=0.1 class 0.0 = 0.058 +- 0.274 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.093 +- 0.274 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.088 +- 0.274 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.075 +- 0.235 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.516
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020794
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.494
NEC for r=0.2 class 0.0 = 0.096 +- 0.338 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.142 +- 0.338 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.138 +- 0.338 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.119 +- 0.291 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.516
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031668
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.48
NEC for r=0.4 class 0.0 = 0.179 +- 0.416 (in-sample avg dev_std = 0.137)
NEC for r=0.4 class 1.0 = 0.213 +- 0.416 (in-sample avg dev_std = 0.137)
NEC for r=0.4 all KL = 0.232 +- 0.416 (in-sample avg dev_std = 0.137)
NEC for r=0.4 all L1 = 0.196 +- 0.354 (in-sample avg dev_std = 0.137)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.516
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0472654
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.479
NEC for r=0.8 class 0.0 = 0.176 +- 0.413 (in-sample avg dev_std = 0.160)
NEC for r=0.8 class 1.0 = 0.207 +- 0.413 (in-sample avg dev_std = 0.160)
NEC for r=0.8 all KL = 0.226 +- 0.413 (in-sample avg dev_std = 0.160)
NEC for r=0.8 all L1 = 0.191 +- 0.350 (in-sample avg dev_std = 0.160)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 23:10:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 11:10:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.9930
Train Loss: 0.0327
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0326
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0337
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0326
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0337

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.023
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.032
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.020
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008893999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.934 +- 0.475 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.14 +- 0.475 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.05 all KL = 0.436 +- 0.475 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.05 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.015)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013969999999999998
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.934 +- 0.475 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.14 +- 0.475 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.436 +- 0.475 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023264
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.444
SUFF_SIMPLE for r=0.2 class 0.0 = 0.93 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.14 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.434 +- 0.474 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.493 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032402
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.934 +- 0.475 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.14 +- 0.475 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.436 +- 0.475 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.494 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036660000000000005
len(reference) = 497
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.455
SUFF_SIMPLE for r=0.8 class 0.0 = 0.934 +- 0.476 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.156 +- 0.476 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.444 +- 0.476 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.502 +- 0.407 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026088
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030811999999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020392
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010912
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.000558
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.988 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.583 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.786 +- 0.363 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.784 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080208
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.74 +- 0.465 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.678 +- 0.465 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.05 all KL = 0.664 +- 0.465 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.05 all L1 = 0.71 +- 0.400 (in-sample avg dev_std = 0.121)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122058
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.741 +- 0.465 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.679 +- 0.465 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.1 all KL = 0.664 +- 0.465 (in-sample avg dev_std = 0.130)
SUFF_SIMPLE for r=0.1 all L1 = 0.711 +- 0.399 (in-sample avg dev_std = 0.130)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019941000000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.487
SUFF_SIMPLE for r=0.2 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.68 +- 0.464 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 all KL = 0.665 +- 0.464 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.2 all L1 = 0.712 +- 0.399 (in-sample avg dev_std = 0.125)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0306124
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.471
SUFF_SIMPLE for r=0.4 class 0.0 = 0.801 +- 0.441 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.711 +- 0.441 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.4 all KL = 0.72 +- 0.441 (in-sample avg dev_std = 0.056)
SUFF_SIMPLE for r=0.4 all L1 = 0.757 +- 0.381 (in-sample avg dev_std = 0.056)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.51
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0471452
len(reference) = 4871
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.478
SUFF_SIMPLE for r=0.8 class 0.0 = 0.962 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.897 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.92 +- 0.260 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.93 +- 0.226 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008893999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.065 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.772 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.513 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.457 +- 0.406 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013969999999999998
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.49
NEC for r=0.1 class 0.0 = 0.065 +- 0.477 (in-sample avg dev_std = 0.015)
NEC for r=0.1 class 1.0 = 0.797 +- 0.477 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all KL = 0.526 +- 0.477 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all L1 = 0.471 +- 0.409 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023264
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.462
NEC for r=0.2 class 0.0 = 0.075 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.832 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.553 +- 0.475 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.494 +- 0.407 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032402
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.449
NEC for r=0.4 class 0.0 = 0.075 +- 0.473 (in-sample avg dev_std = 0.064)
NEC for r=0.4 class 1.0 = 0.848 +- 0.473 (in-sample avg dev_std = 0.064)
NEC for r=0.4 all KL = 0.563 +- 0.473 (in-sample avg dev_std = 0.064)
NEC for r=0.4 all L1 = 0.503 +- 0.405 (in-sample avg dev_std = 0.064)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036660000000000005
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
NEC for r=0.8 class 0.0 = 0.07 +- 0.473 (in-sample avg dev_std = 0.100)
NEC for r=0.8 class 1.0 = 0.859 +- 0.473 (in-sample avg dev_std = 0.100)
NEC for r=0.8 all KL = 0.568 +- 0.473 (in-sample avg dev_std = 0.100)
NEC for r=0.8 all L1 = 0.507 +- 0.404 (in-sample avg dev_std = 0.100)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.698
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026088
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.698
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0030811999999999997
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.698
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020392
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.698
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010912
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.698
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.000558
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.012 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.417 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.214 +- 0.363 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.216 +- 0.336 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.517
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080208
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.508
NEC for r=0.05 class 0.0 = 0.044 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.076 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.07 +- 0.235 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.06 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.517
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122058
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.503
NEC for r=0.1 class 0.0 = 0.065 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.099 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.096 +- 0.278 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.082 +- 0.240 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.517
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019941000000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.495
NEC for r=0.2 class 0.0 = 0.106 +- 0.340 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.143 +- 0.340 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.145 +- 0.340 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.124 +- 0.292 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.517
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0306124
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.484
NEC for r=0.4 class 0.0 = 0.184 +- 0.416 (in-sample avg dev_std = 0.142)
NEC for r=0.4 class 1.0 = 0.216 +- 0.416 (in-sample avg dev_std = 0.142)
NEC for r=0.4 all KL = 0.237 +- 0.416 (in-sample avg dev_std = 0.142)
NEC for r=0.4 all L1 = 0.2 +- 0.352 (in-sample avg dev_std = 0.142)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.517
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0471452
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.479
NEC for r=0.8 class 0.0 = 0.184 +- 0.416 (in-sample avg dev_std = 0.165)
NEC for r=0.8 class 1.0 = 0.216 +- 0.416 (in-sample avg dev_std = 0.165)
NEC for r=0.8 all KL = 0.237 +- 0.416 (in-sample avg dev_std = 0.165)
NEC for r=0.8 all L1 = 0.2 +- 0.352 (in-sample avg dev_std = 0.165)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 23:23:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 11:23:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9858
Train Loss: 0.0357
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0390
ID Test ACCURACY: 0.9720
ID Test Loss: 0.0544
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0390
OOD Test ACCURACY: 0.9720
OOD Test Loss: 0.0544

[0m[1;37mINFO[0m: [1mChartInfo 0.9720 0.9720 0.9720 0.9720 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.015
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.048


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009027999999999998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.448
SUFF_SIMPLE for r=0.05 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.147 +- 0.480 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all KL = 0.443 +- 0.480 (in-sample avg dev_std = 0.003)
SUFF_SIMPLE for r=0.05 all L1 = 0.505 +- 0.414 (in-sample avg dev_std = 0.003)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013548
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022242
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03269799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.503 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036764
len(reference) = 499
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
SUFF_SIMPLE for r=0.8 class 0.0 = 0.95 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.144 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.44 +- 0.480 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.502 +- 0.414 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026286
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.003198
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021996000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006226000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.667 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.151 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.344 +- 0.441 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.407 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0096708
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.489
SUFF_SIMPLE for r=0.05 class 0.0 = 0.743 +- 0.463 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.698 +- 0.463 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all KL = 0.676 +- 0.463 (in-sample avg dev_std = 0.122)
SUFF_SIMPLE for r=0.05 all L1 = 0.721 +- 0.398 (in-sample avg dev_std = 0.122)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014605399999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.744 +- 0.464 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.697 +- 0.464 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all KL = 0.675 +- 0.464 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all L1 = 0.721 +- 0.397 (in-sample avg dev_std = 0.127)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022450599999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.745 +- 0.463 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.699 +- 0.463 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all KL = 0.676 +- 0.463 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all L1 = 0.723 +- 0.396 (in-sample avg dev_std = 0.129)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032692200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.469
SUFF_SIMPLE for r=0.4 class 0.0 = 0.808 +- 0.437 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.73 +- 0.437 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.4 all KL = 0.734 +- 0.437 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.4 all L1 = 0.77 +- 0.376 (in-sample avg dev_std = 0.055)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.504
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.048445
len(reference) = 4880
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.244 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.914 +- 0.244 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.932 +- 0.244 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.209 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009027999999999998
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.5
NEC for r=0.05 class 0.0 = 0.058 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.773 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.515 +- 0.480 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.454 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.013548
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.488
NEC for r=0.1 class 0.0 = 0.058 +- 0.482 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.796 +- 0.482 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.527 +- 0.482 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.467 +- 0.416 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022242
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.46
NEC for r=0.2 class 0.0 = 0.062 +- 0.481 (in-sample avg dev_std = 0.031)
NEC for r=0.2 class 1.0 = 0.825 +- 0.481 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all KL = 0.545 +- 0.481 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all L1 = 0.485 +- 0.416 (in-sample avg dev_std = 0.031)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03269799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.442
NEC for r=0.4 class 0.0 = 0.066 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.85 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.563 +- 0.479 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.5 +- 0.414 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036764
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.447
NEC for r=0.8 class 0.0 = 0.052 +- 0.479 (in-sample avg dev_std = 0.071)
NEC for r=0.8 class 1.0 = 0.856 +- 0.479 (in-sample avg dev_std = 0.071)
NEC for r=0.8 all KL = 0.561 +- 0.479 (in-sample avg dev_std = 0.071)
NEC for r=0.8 all L1 = 0.498 +- 0.413 (in-sample avg dev_std = 0.071)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.825
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0026286
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.825
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.003198
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.825
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021996000000000003
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.825
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0012124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.825
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006226000000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.333 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.849 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.656 +- 0.441 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.593 +- 0.373 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.507
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0096708
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.041 +- 0.227 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.063 +- 0.227 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.06 +- 0.227 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.052 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.507
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014605399999999998
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.061 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.084 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.084 +- 0.268 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.072 +- 0.230 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.507
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022450599999999998
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.49
NEC for r=0.2 class 0.0 = 0.097 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.13 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.131 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.113 +- 0.284 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.507
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.032692200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.481
NEC for r=0.4 class 0.0 = 0.178 +- 0.413 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.203 +- 0.413 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.226 +- 0.413 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.191 +- 0.349 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.507
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.048445
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.479
NEC for r=0.8 class 0.0 = 0.181 +- 0.412 (in-sample avg dev_std = 0.160)
NEC for r=0.8 class 1.0 = 0.2 +- 0.412 (in-sample avg dev_std = 0.160)
NEC for r=0.8 all KL = 0.225 +- 0.412 (in-sample avg dev_std = 0.160)
NEC for r=0.8 all L1 = 0.19 +- 0.349 (in-sample avg dev_std = 0.160)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 23:35:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 11:35:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0195
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0173
ID Test ACCURACY: 0.9940
ID Test Loss: 0.0285
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0173
OOD Test ACCURACY: 0.9940
OOD Test Loss: 0.0285

[0m[1;37mINFO[0m: [1mChartInfo 0.9940 0.9940 0.9940 0.9940 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.014
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.024
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.033
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.038
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.002
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.012
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.020
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008289999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.964 +- 0.485 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.05 all KL = 0.44 +- 0.485 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.05 all L1 = 0.506 +- 0.416 (in-sample avg dev_std = 0.031)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014301999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.965 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.507 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.965 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.507 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03254
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.965 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.138 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.507 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037756
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.454
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.152 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.447 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.512 +- 0.417 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.002432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029664
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020628
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010995999999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005606
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.839 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.921 +- 0.238 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.918 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081184
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.739 +- 0.471 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.665 +- 0.471 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.05 all KL = 0.653 +- 0.471 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.05 all L1 = 0.703 +- 0.404 (in-sample avg dev_std = 0.125)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122244
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.74 +- 0.471 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.666 +- 0.471 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all KL = 0.654 +- 0.471 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.1 all L1 = 0.703 +- 0.404 (in-sample avg dev_std = 0.127)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019827800000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.742 +- 0.470 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.668 +- 0.470 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all KL = 0.655 +- 0.470 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all L1 = 0.705 +- 0.403 (in-sample avg dev_std = 0.133)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.030766400000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.471
SUFF_SIMPLE for r=0.4 class 0.0 = 0.799 +- 0.448 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.7 +- 0.448 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.4 all KL = 0.711 +- 0.448 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.4 all L1 = 0.75 +- 0.387 (in-sample avg dev_std = 0.050)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.518
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0468454
len(reference) = 4870
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.479
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.893 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.918 +- 0.266 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.929 +- 0.231 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008289999999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.538
NEC for r=0.05 class 0.0 = 0.047 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.715 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.478 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.417 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.014301999999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.488
NEC for r=0.1 class 0.0 = 0.046 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.789 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.521 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.458 +- 0.419 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.023652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.452
NEC for r=0.2 class 0.0 = 0.047 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.844 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.555 +- 0.485 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.488 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.03254
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.444
NEC for r=0.4 class 0.0 = 0.05 +- 0.484 (in-sample avg dev_std = 0.064)
NEC for r=0.4 class 1.0 = 0.852 +- 0.484 (in-sample avg dev_std = 0.064)
NEC for r=0.4 all KL = 0.562 +- 0.484 (in-sample avg dev_std = 0.064)
NEC for r=0.4 all L1 = 0.494 +- 0.416 (in-sample avg dev_std = 0.064)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.037756
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.446
NEC for r=0.8 class 0.0 = 0.039 +- 0.483 (in-sample avg dev_std = 0.085)
NEC for r=0.8 class 1.0 = 0.861 +- 0.483 (in-sample avg dev_std = 0.085)
NEC for r=0.8 all KL = 0.564 +- 0.483 (in-sample avg dev_std = 0.085)
NEC for r=0.8 all L1 = 0.494 +- 0.415 (in-sample avg dev_std = 0.085)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.57
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.002432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.57
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0029664
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.57
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0020628
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.57
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0010995999999999998
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.57
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0005606
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.161 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.079 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.082 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081184
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.04 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.075 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.067 +- 0.238 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.057 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0122244
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.505
NEC for r=0.1 class 0.0 = 0.062 +- 0.279 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.096 +- 0.279 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.092 +- 0.279 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.079 +- 0.240 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.019827800000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.103 +- 0.347 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.151 +- 0.347 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.149 +- 0.347 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.127 +- 0.299 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.030766400000000003
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.484
NEC for r=0.4 class 0.0 = 0.181 +- 0.424 (in-sample avg dev_std = 0.140)
NEC for r=0.4 class 1.0 = 0.229 +- 0.424 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all KL = 0.246 +- 0.424 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all L1 = 0.205 +- 0.359 (in-sample avg dev_std = 0.140)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0468454
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.48
NEC for r=0.8 class 0.0 = 0.182 +- 0.425 (in-sample avg dev_std = 0.169)
NEC for r=0.8 class 1.0 = 0.231 +- 0.425 (in-sample avg dev_std = 0.169)
NEC for r=0.8 all KL = 0.246 +- 0.425 (in-sample avg dev_std = 0.169)
NEC for r=0.8 all L1 = 0.207 +- 0.359 (in-sample avg dev_std = 0.169)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Nov  7 23:48:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/07/2024 11:48:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 85 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 85...
[0m[1;37mINFO[0m: [1mCheckpoint 85: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0091
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0080
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0243
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0080
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.001
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.004
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.012
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.052
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.000
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.000
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.000
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.000
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.000
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.001
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.002
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.005
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.020
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.058


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.446
SUFF_SIMPLE for r=0.05 class 0.0 = 0.983 +- 0.491 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.137 +- 0.491 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.05 all KL = 0.445 +- 0.491 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.05 all L1 = 0.515 +- 0.422 (in-sample avg dev_std = 0.005)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001136
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.983 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.137 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.445 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.514 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0035059999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.444
SUFF_SIMPLE for r=0.2 class 0.0 = 0.979 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.137 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.443 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.513 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012364
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.444
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.137 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.443 +- 0.490 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.513 +- 0.422 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.051992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.46
SUFF_SIMPLE for r=0.8 class 0.0 = 0.98 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.161 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.457 +- 0.491 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.526 +- 0.423 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.520000000000001e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.878 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.210 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.938 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006754
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.744 +- 0.467 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.682 +- 0.467 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.05 all KL = 0.665 +- 0.467 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.05 all L1 = 0.714 +- 0.400 (in-sample avg dev_std = 0.137)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0015534
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.489
SUFF_SIMPLE for r=0.1 class 0.0 = 0.745 +- 0.466 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.683 +- 0.466 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 all KL = 0.666 +- 0.466 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 all L1 = 0.714 +- 0.400 (in-sample avg dev_std = 0.132)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0054122
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.491
SUFF_SIMPLE for r=0.2 class 0.0 = 0.746 +- 0.466 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.689 +- 0.466 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.2 all KL = 0.667 +- 0.466 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.2 all L1 = 0.718 +- 0.397 (in-sample avg dev_std = 0.153)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.019672199999999997
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.49
SUFF_SIMPLE for r=0.4 class 0.0 = 0.834 +- 0.410 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.778 +- 0.410 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.777 +- 0.410 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.806 +- 0.355 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.514
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057988
len(reference) = 4914
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.476
SUFF_SIMPLE for r=0.8 class 0.0 = 0.951 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.874 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.9 +- 0.293 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.913 +- 0.253 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.000412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.51
NEC for r=0.05 class 0.0 = 0.02 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.768 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.503 +- 0.490 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.434 +- 0.421 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.001136
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.48
NEC for r=0.1 class 0.0 = 0.021 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.806 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.523 +- 0.492 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.456 +- 0.423 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0035059999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.458
NEC for r=0.2 class 0.0 = 0.03 +- 0.491 (in-sample avg dev_std = 0.026)
NEC for r=0.2 class 1.0 = 0.837 +- 0.491 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all KL = 0.547 +- 0.491 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all L1 = 0.477 +- 0.422 (in-sample avg dev_std = 0.026)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.012364
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.444
NEC for r=0.4 class 0.0 = 0.041 +- 0.490 (in-sample avg dev_std = 0.031)
NEC for r=0.4 class 1.0 = 0.847 +- 0.490 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all KL = 0.558 +- 0.490 (in-sample avg dev_std = 0.031)
NEC for r=0.4 all L1 = 0.488 +- 0.422 (in-sample avg dev_std = 0.031)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.051992
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.445
NEC for r=0.8 class 0.0 = 0.023 +- 0.489 (in-sample avg dev_std = 0.097)
NEC for r=0.8 class 1.0 = 0.862 +- 0.489 (in-sample avg dev_std = 0.097)
NEC for r=0.8 all KL = 0.562 +- 0.489 (in-sample avg dev_std = 0.097)
NEC for r=0.8 all L1 = 0.488 +- 0.420 (in-sample avg dev_std = 0.097)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.553
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.553
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.553
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.553
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.553
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  8.520000000000001e-05
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.0 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.122 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.059 +- 0.210 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.062 +- 0.200 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.52
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0006754
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.516
NEC for r=0.05 class 0.0 = 0.042 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.066 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.062 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.054 +- 0.197 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.52
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0015534
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.511
NEC for r=0.1 class 0.0 = 0.065 +- 0.281 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.095 +- 0.281 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.094 +- 0.281 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.08 +- 0.241 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.52
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0054122
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.502
NEC for r=0.2 class 0.0 = 0.119 +- 0.358 (in-sample avg dev_std = 0.001)
NEC for r=0.2 class 1.0 = 0.154 +- 0.358 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all KL = 0.16 +- 0.358 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all L1 = 0.137 +- 0.309 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.52
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.019672199999999997
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.494
NEC for r=0.4 class 0.0 = 0.183 +- 0.414 (in-sample avg dev_std = 0.133)
NEC for r=0.4 class 1.0 = 0.204 +- 0.414 (in-sample avg dev_std = 0.133)
NEC for r=0.4 all KL = 0.228 +- 0.414 (in-sample avg dev_std = 0.133)
NEC for r=0.4 all L1 = 0.193 +- 0.352 (in-sample avg dev_std = 0.133)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.52
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.057988
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.474
NEC for r=0.8 class 0.0 = 0.176 +- 0.418 (in-sample avg dev_std = 0.154)
NEC for r=0.8 class 1.0 = 0.222 +- 0.418 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all KL = 0.234 +- 0.418 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all L1 = 0.199 +- 0.355 (in-sample avg dev_std = 0.154)
model_dirname= repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Fri Nov  8 00:00:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 11/08/2024 12:00:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9935
Train Loss: 0.0228
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0193
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0339
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0193
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0339

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.012
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.016
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.022
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.037
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.003
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.003
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.002
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.001
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.001
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.013
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.021
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.031
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.047


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012080000000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.445
SUFF_SIMPLE for r=0.05 class 0.0 = 0.972 +- 0.485 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.05 all KL = 0.448 +- 0.485 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.05 all L1 = 0.512 +- 0.417 (in-sample avg dev_std = 0.041)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.016174
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.446
SUFF_SIMPLE for r=0.1 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.1 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022316
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.446
SUFF_SIMPLE for r=0.2 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031120000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.446
SUFF_SIMPLE for r=0.4 class 0.0 = 0.974 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.142 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.449 +- 0.485 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.513 +- 0.417 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036548000000000004
len(reference) = 498
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.456
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.16 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.458 +- 0.486 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.521 +- 0.418 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0025759999999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031368000000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021654000000000005
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.001178
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006022
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.89 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.206 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008990999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.488
SUFF_SIMPLE for r=0.05 class 0.0 = 0.743 +- 0.464 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.689 +- 0.464 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all KL = 0.67 +- 0.464 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.05 all L1 = 0.717 +- 0.398 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0133226
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.488
SUFF_SIMPLE for r=0.1 class 0.0 = 0.743 +- 0.465 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.689 +- 0.465 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.1 all KL = 0.67 +- 0.465 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.1 all L1 = 0.717 +- 0.398 (in-sample avg dev_std = 0.124)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020676600000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.744 +- 0.464 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.691 +- 0.464 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all KL = 0.672 +- 0.464 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.2 all L1 = 0.718 +- 0.398 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0311536
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.47
SUFF_SIMPLE for r=0.4 class 0.0 = 0.806 +- 0.439 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.723 +- 0.439 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.4 all KL = 0.729 +- 0.439 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.4 all L1 = 0.765 +- 0.379 (in-sample avg dev_std = 0.057)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.508
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047249
len(reference) = 4881
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.477
SUFF_SIMPLE for r=0.8 class 0.0 = 0.967 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.904 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.925 +- 0.253 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.935 +- 0.219 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.012080000000000002
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.504
NEC for r=0.05 class 0.0 = 0.029 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.775 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.507 +- 0.484 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.442 +- 0.416 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.016174
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.482
NEC for r=0.1 class 0.0 = 0.026 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.803 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.517 +- 0.487 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.456 +- 0.419 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.022316
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.462
NEC for r=0.2 class 0.0 = 0.034 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.827 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.536 +- 0.486 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.473 +- 0.419 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.031120000000000002
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.444
NEC for r=0.4 class 0.0 = 0.038 +- 0.484 (in-sample avg dev_std = 0.046)
NEC for r=0.4 class 1.0 = 0.852 +- 0.484 (in-sample avg dev_std = 0.046)
NEC for r=0.4 all KL = 0.554 +- 0.484 (in-sample avg dev_std = 0.046)
NEC for r=0.4 all L1 = 0.489 +- 0.416 (in-sample avg dev_std = 0.046)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.036548000000000004
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.446
NEC for r=0.8 class 0.0 = 0.029 +- 0.484 (in-sample avg dev_std = 0.088)
NEC for r=0.8 class 1.0 = 0.857 +- 0.484 (in-sample avg dev_std = 0.088)
NEC for r=0.8 all KL = 0.555 +- 0.484 (in-sample avg dev_std = 0.088)
NEC for r=0.8 all L1 = 0.488 +- 0.416 (in-sample avg dev_std = 0.088)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.548
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0025759999999999997
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
NEC for r=0.05 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.548
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0031368000000000004
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.548
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0021654000000000005
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.548
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.001178
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.548
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0006022
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.11 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.055 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.056 +- 0.193 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.511
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008990999999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.04 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.065 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.061 +- 0.225 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.052 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.511
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0133226
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.5
NEC for r=0.1 class 0.0 = 0.062 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.09 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.088 +- 0.273 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.076 +- 0.235 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.511
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.020676600000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.492
NEC for r=0.2 class 0.0 = 0.1 +- 0.331 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.13 +- 0.331 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.132 +- 0.331 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.115 +- 0.285 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.511
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0311536
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.482
NEC for r=0.4 class 0.0 = 0.177 +- 0.414 (in-sample avg dev_std = 0.140)
NEC for r=0.4 class 1.0 = 0.211 +- 0.414 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all KL = 0.23 +- 0.414 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all L1 = 0.194 +- 0.350 (in-sample avg dev_std = 0.140)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.511
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.047249
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.479
NEC for r=0.8 class 0.0 = 0.181 +- 0.414 (in-sample avg dev_std = 0.165)
NEC for r=0.8 class 1.0 = 0.207 +- 0.414 (in-sample avg dev_std = 0.165)
NEC for r=0.8 all KL = 0.229 +- 0.414 (in-sample avg dev_std = 0.165)
NEC for r=0.8 all L1 = 0.194 +- 0.350 (in-sample avg dev_std = 0.165)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.454, 0.451, 0.452, 0.454, 0.457], 'all_L1': [0.52, 0.518, 0.518, 0.52, 0.523]}), defaultdict(<class 'list'>, {'all_KL': [0.431, 0.431, 0.431, 0.431, 0.439], 'all_L1': [0.497, 0.497, 0.497, 0.497, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.447, 0.447, 0.447, 0.447, 0.447], 'all_L1': [0.509, 0.509, 0.509, 0.509, 0.509]}), defaultdict(<class 'list'>, {'all_KL': [0.458, 0.458, 0.458, 0.458, 0.459], 'all_L1': [0.522, 0.522, 0.522, 0.522, 0.524]}), defaultdict(<class 'list'>, {'all_KL': [0.457, 0.456, 0.455, 0.457, 0.462], 'all_L1': [0.522, 0.522, 0.52, 0.522, 0.527]}), defaultdict(<class 'list'>, {'all_KL': [0.436, 0.436, 0.434, 0.436, 0.444], 'all_L1': [0.494, 0.494, 0.493, 0.494, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.443, 0.441, 0.441, 0.441, 0.44], 'all_L1': [0.505, 0.503, 0.503, 0.503, 0.502]}), defaultdict(<class 'list'>, {'all_KL': [0.44, 0.441, 0.441, 0.441, 0.447], 'all_L1': [0.506, 0.507, 0.507, 0.507, 0.512]}), defaultdict(<class 'list'>, {'all_KL': [0.445, 0.445, 0.443, 0.443, 0.457], 'all_L1': [0.515, 0.514, 0.513, 0.513, 0.526]}), defaultdict(<class 'list'>, {'all_KL': [0.448, 0.449, 0.449, 0.449, 0.458], 'all_L1': [0.512, 0.513, 0.513, 0.513, 0.521]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.488, 0.524, 0.54, 0.547, 0.551], 'all_L1': [0.425, 0.455, 0.473, 0.479, 0.481]}), defaultdict(<class 'list'>, {'all_KL': [0.522, 0.533, 0.564, 0.569, 0.571], 'all_L1': [0.457, 0.468, 0.496, 0.502, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.509, 0.525, 0.543, 0.55, 0.557], 'all_L1': [0.448, 0.465, 0.481, 0.488, 0.493]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.508, 0.526, 0.548, 0.542], 'all_L1': [0.429, 0.446, 0.463, 0.483, 0.477]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.511, 0.532, 0.547, 0.551], 'all_L1': [0.426, 0.446, 0.467, 0.48, 0.48]}), defaultdict(<class 'list'>, {'all_KL': [0.513, 0.526, 0.553, 0.563, 0.568], 'all_L1': [0.457, 0.471, 0.494, 0.503, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.515, 0.527, 0.545, 0.563, 0.561], 'all_L1': [0.454, 0.467, 0.485, 0.5, 0.498]}), defaultdict(<class 'list'>, {'all_KL': [0.478, 0.521, 0.555, 0.562, 0.564], 'all_L1': [0.417, 0.458, 0.488, 0.494, 0.494]}), defaultdict(<class 'list'>, {'all_KL': [0.503, 0.523, 0.547, 0.558, 0.562], 'all_L1': [0.434, 0.456, 0.477, 0.488, 0.488]}), defaultdict(<class 'list'>, {'all_KL': [0.507, 0.517, 0.536, 0.554, 0.555], 'all_L1': [0.442, 0.456, 0.473, 0.489, 0.488]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.582, 0.582, 0.582, 0.582, 0.582], 'all_L1': [0.615, 0.615, 0.615, 0.615, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.758, 0.758, 0.758, 0.758, 0.758], 'all_L1': [0.768, 0.768, 0.768, 0.768, 0.768]}), defaultdict(<class 'list'>, {'all_KL': [0.639, 0.639, 0.639, 0.639, 0.639], 'all_L1': [0.658, 0.658, 0.658, 0.658, 0.658]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.868, 0.868, 0.868, 0.868], 'all_L1': [0.867, 0.867, 0.867, 0.867, 0.867]}), defaultdict(<class 'list'>, {'all_KL': [0.721, 0.721, 0.721, 0.721, 0.721], 'all_L1': [0.734, 0.734, 0.734, 0.734, 0.734]}), defaultdict(<class 'list'>, {'all_KL': [0.786, 0.786, 0.786, 0.786, 0.786], 'all_L1': [0.784, 0.784, 0.784, 0.784, 0.784]}), defaultdict(<class 'list'>, {'all_KL': [0.344, 0.344, 0.344, 0.344, 0.344], 'all_L1': [0.407, 0.407, 0.407, 0.407, 0.407]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.921, 0.921, 0.921, 0.921], 'all_L1': [0.918, 0.918, 0.918, 0.918, 0.918]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.941, 0.941, 0.941, 0.941], 'all_L1': [0.938, 0.938, 0.938, 0.938, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.945, 0.945, 0.945, 0.945, 0.945], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.418, 0.418, 0.418, 0.418, 0.418], 'all_L1': [0.385, 0.385, 0.385, 0.385, 0.385]}), defaultdict(<class 'list'>, {'all_KL': [0.242, 0.242, 0.242, 0.242, 0.242], 'all_L1': [0.232, 0.232, 0.232, 0.232, 0.232]}), defaultdict(<class 'list'>, {'all_KL': [0.361, 0.361, 0.361, 0.361, 0.361], 'all_L1': [0.342, 0.342, 0.342, 0.342, 0.342]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.132, 0.132, 0.132, 0.132], 'all_L1': [0.133, 0.133, 0.133, 0.133, 0.133]}), defaultdict(<class 'list'>, {'all_KL': [0.279, 0.279, 0.279, 0.279, 0.279], 'all_L1': [0.266, 0.266, 0.266, 0.266, 0.266]}), defaultdict(<class 'list'>, {'all_KL': [0.214, 0.214, 0.214, 0.214, 0.214], 'all_L1': [0.216, 0.216, 0.216, 0.216, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.656, 0.656, 0.656, 0.656], 'all_L1': [0.593, 0.593, 0.593, 0.593, 0.593]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.079, 0.079, 0.079, 0.079], 'all_L1': [0.082, 0.082, 0.082, 0.082, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.059, 0.059, 0.059, 0.059, 0.059], 'all_L1': [0.062, 0.062, 0.062, 0.062, 0.062]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.055, 0.055, 0.055, 0.055], 'all_L1': [0.056, 0.056, 0.056, 0.056, 0.056]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.664, 0.665, 0.665, 0.718, 0.922], 'all_L1': [0.712, 0.712, 0.713, 0.757, 0.933]}), defaultdict(<class 'list'>, {'all_KL': [0.656, 0.656, 0.658, 0.763, 0.894], 'all_L1': [0.705, 0.705, 0.708, 0.794, 0.907]}), defaultdict(<class 'list'>, {'all_KL': [0.673, 0.674, 0.675, 0.727, 0.93], 'all_L1': [0.719, 0.72, 0.72, 0.765, 0.94]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.669, 0.67, 0.723, 0.927], 'all_L1': [0.715, 0.715, 0.717, 0.76, 0.936]}), defaultdict(<class 'list'>, {'all_KL': [0.673, 0.673, 0.674, 0.733, 0.934], 'all_L1': [0.719, 0.72, 0.721, 0.768, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.664, 0.664, 0.665, 0.72, 0.92], 'all_L1': [0.71, 0.711, 0.712, 0.757, 0.93]}), defaultdict(<class 'list'>, {'all_KL': [0.676, 0.675, 0.676, 0.734, 0.932], 'all_L1': [0.721, 0.721, 0.723, 0.77, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.653, 0.654, 0.655, 0.711, 0.918], 'all_L1': [0.703, 0.703, 0.705, 0.75, 0.929]}), defaultdict(<class 'list'>, {'all_KL': [0.665, 0.666, 0.667, 0.777, 0.9], 'all_L1': [0.714, 0.714, 0.718, 0.806, 0.913]}), defaultdict(<class 'list'>, {'all_KL': [0.67, 0.67, 0.672, 0.729, 0.925], 'all_L1': [0.717, 0.717, 0.718, 0.765, 0.935]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.069, 0.093, 0.144, 0.238, 0.238], 'all_L1': [0.058, 0.08, 0.123, 0.201, 0.199]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.096, 0.169, 0.245, 0.243], 'all_L1': [0.059, 0.081, 0.143, 0.204, 0.206]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.086, 0.134, 0.226, 0.225], 'all_L1': [0.053, 0.073, 0.115, 0.191, 0.189]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.086, 0.137, 0.23, 0.232], 'all_L1': [0.055, 0.075, 0.119, 0.194, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.066, 0.088, 0.138, 0.232, 0.226], 'all_L1': [0.056, 0.075, 0.119, 0.196, 0.191]}), defaultdict(<class 'list'>, {'all_KL': [0.07, 0.096, 0.145, 0.237, 0.237], 'all_L1': [0.06, 0.082, 0.124, 0.2, 0.2]}), defaultdict(<class 'list'>, {'all_KL': [0.06, 0.084, 0.131, 0.226, 0.225], 'all_L1': [0.052, 0.072, 0.113, 0.191, 0.19]}), defaultdict(<class 'list'>, {'all_KL': [0.067, 0.092, 0.149, 0.246, 0.246], 'all_L1': [0.057, 0.079, 0.127, 0.205, 0.207]}), defaultdict(<class 'list'>, {'all_KL': [0.062, 0.094, 0.16, 0.228, 0.234], 'all_L1': [0.054, 0.08, 0.137, 0.193, 0.199]}), defaultdict(<class 'list'>, {'all_KL': [0.061, 0.088, 0.132, 0.23, 0.229], 'all_L1': [0.052, 0.076, 0.115, 0.194, 0.194]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.510 +- 0.009, 0.510 +- 0.009, 0.509 +- 0.009, 0.510 +- 0.009, 0.515 +- 0.010
suff_simple class all_KL  =  0.446 +- 0.008, 0.445 +- 0.008, 0.445 +- 0.008, 0.446 +- 0.008, 0.451 +- 0.008
suff_simple_acc_int  =  0.446 +- 0.001, 0.446 +- 0.001, 0.445 +- 0.001, 0.446 +- 0.001, 0.453 +- 0.004
nec class all_L1  =  0.439 +- 0.014, 0.459 +- 0.008, 0.480 +- 0.011, 0.491 +- 0.008, 0.491 +- 0.010
nec class all_KL  =  0.502 +- 0.013, 0.521 +- 0.007, 0.544 +- 0.011, 0.556 +- 0.008, 0.558 +- 0.008
nec_acc_int  =  0.508 +- 0.012, 0.484 +- 0.005, 0.458 +- 0.003, 0.445 +- 0.003, 0.446 +- 0.001

Eval split val
suff_simple class all_L1  =  0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161, 0.763 +- 0.161
suff_simple class all_KL  =  0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180, 0.751 +- 0.180
suff_simple_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000
nec class all_L1  =  0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161, 0.237 +- 0.161
nec class all_KL  =  0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180, 0.250 +- 0.180
nec_acc_int  =  0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000, 0.496 +- 0.000

Eval split test
suff_simple class all_L1  =  0.713 +- 0.006, 0.714 +- 0.006, 0.716 +- 0.006, 0.769 +- 0.017, 0.931 +- 0.011
suff_simple class all_KL  =  0.666 +- 0.007, 0.667 +- 0.007, 0.668 +- 0.007, 0.734 +- 0.020, 0.920 +- 0.013
suff_simple_acc_int  =  0.488 +- 0.000, 0.488 +- 0.000, 0.488 +- 0.001, 0.473 +- 0.008, 0.477 +- 0.002
nec class all_L1  =  0.056 +- 0.003, 0.077 +- 0.003, 0.124 +- 0.009, 0.197 +- 0.005, 0.197 +- 0.006
nec class all_KL  =  0.065 +- 0.003, 0.090 +- 0.004, 0.144 +- 0.012, 0.234 +- 0.007, 0.233 +- 0.007
nec_acc_int  =  0.508 +- 0.004, 0.502 +- 0.006, 0.495 +- 0.005, 0.484 +- 0.005, 0.479 +- 0.002


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.475 +- 0.005, 0.484 +- 0.002, 0.495 +- 0.002, 0.500 +- 0.001, 0.503 +- 0.002
Faith. Armon (L1)= 		  =  0.472 +- 0.006, 0.483 +- 0.002, 0.494 +- 0.002, 0.500 +- 0.001, 0.503 +- 0.002
Faith. GMean (L1)= 	  =  0.473 +- 0.005, 0.484 +- 0.001, 0.494 +- 0.002, 0.500 +- 0.001, 0.503 +- 0.002
Faith. Aritm (KL)= 		  =  0.474 +- 0.005, 0.483 +- 0.002, 0.495 +- 0.002, 0.501 +- 0.001, 0.505 +- 0.003
Faith. Armon (KL)= 		  =  0.472 +- 0.005, 0.480 +- 0.003, 0.489 +- 0.002, 0.495 +- 0.003, 0.499 +- 0.003
Faith. GMean (KL)= 	  =  0.473 +- 0.005, 0.482 +- 0.002, 0.492 +- 0.002, 0.498 +- 0.002, 0.502 +- 0.003

Eval split val
Faith. Aritm (L1)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000
Faith. Armon (L1)= 		  =  0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140, 0.310 +- 0.140
Faith. GMean (L1)= 	  =  0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097, 0.381 +- 0.097
Faith. Aritm (KL)= 		  =  0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000, 0.500 +- 0.000
Faith. Armon (KL)= 		  =  0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142, 0.309 +- 0.142
Faith. GMean (KL)= 	  =  0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099, 0.381 +- 0.099

Eval split test
Faith. Aritm (L1)= 		  =  0.385 +- 0.002, 0.396 +- 0.002, 0.419 +- 0.004, 0.483 +- 0.008, 0.564 +- 0.004
Faith. Armon (L1)= 		  =  0.103 +- 0.005, 0.139 +- 0.005, 0.210 +- 0.013, 0.313 +- 0.006, 0.325 +- 0.008
Faith. GMean (L1)= 	  =  0.199 +- 0.004, 0.235 +- 0.004, 0.297 +- 0.010, 0.389 +- 0.006, 0.428 +- 0.005
Faith. Aritm (KL)= 		  =  0.366 +- 0.003, 0.378 +- 0.002, 0.406 +- 0.004, 0.484 +- 0.010, 0.577 +- 0.005
Faith. Armon (KL)= 		  =  0.118 +- 0.006, 0.159 +- 0.006, 0.236 +- 0.016, 0.354 +- 0.008, 0.372 +- 0.008
Faith. GMean (KL)= 	  =  0.208 +- 0.005, 0.245 +- 0.005, 0.310 +- 0.011, 0.414 +- 0.008, 0.463 +- 0.005
Computed for split load_split = id



Completed in  2:06:58.280400  for repr_GiSSTGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean/0.001lr_0.0wd/GiSST_no_param_True_0.1_0.01_0.01_0.01 TopoFeature/basis



DONE GiSST TopoFeature/basis/no_shift NEC_ALPHA 0.1 RANDOM
scripts/faithfulness.sh: line 114: syntax error near unexpected token `)'
