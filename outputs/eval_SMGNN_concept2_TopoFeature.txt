/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:52:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:52:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9905
Train Loss: 0.0380
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0331
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0436
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0331
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0436

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9905
Train Loss: 0.0380
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0331
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0436
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0331
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0436

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9900 0.9900[0mTrain ACCURACY: 0.9905 	Train Loss: 0.0380 	Train WIoU: 0.424 	
Id_val ACCURACY: 0.9900 	Id_val Loss: 0.0331 	Id_val WIoU: 0.433 	
Id_test ACCURACY: 0.9880 	Id_test Loss: 0.0436 	Id_test WIoU: 0.434 	
Val ACCURACY: 0.7034 	Val Loss: 2.2908 	Val WIoU: 0.119 	
Test ACCURACY: 0.7918 	Test Loss: 0.7658 	Test WIoU: 0.781 	

Concept relevance scores for this run:
 [[0.767993 0.232007]] 


Weight vector of global side channel:
W: [[0.3199865  0.5661345  0.01594766]] b:[-0.7748593]

Coeff rule on x1: x1 >= [2.4215376]


#D#Running with seed = 2
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2normnoneavgedgeattnmean
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/TopoFeature/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2',
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:52:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:52:58 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0012
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0012
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0012
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0012
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0012
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0012
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0012
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0012
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0012

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0012 	Train WIoU: 0.698 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0012 	Id_val WIoU: 0.706 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0012 	Id_test WIoU: 0.697 	
Val ACCURACY: 0.9690 	Val Loss: 0.1109 	Val WIoU: 0.495 	
Test ACCURACY: 0.9418 	Test Loss: 0.1766 	Test WIoU: 0.849 	

Concept relevance scores for this run:
 [[0.04725023 0.9527497 ]] 


Weight vector of global side channel:
W: [[ 1.0274161   0.42078406 -0.0013337 ]] b:[-1.1229388]

Coeff rule on x1: x1 >= [1.0929737]


#D#Running with seed = 3
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2normnoneavgedgeattnmean
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/TopoFeature/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2',
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:53:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:53:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0001 	Train WIoU: 0.958 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0001 	Id_val WIoU: 0.960 	
Id_test ACCURACY: 1.0000 	Id_test Loss: 0.0001 	Id_test WIoU: 0.961 	
Val ACCURACY: 0.9998 	Val Loss: 0.0011 	Val WIoU: 0.958 	
Test ACCURACY: 0.9804 	Test Loss: 0.1595 	Test WIoU: 0.932 	

Concept relevance scores for this run:
 [[0.15775475 0.8422453 ]] 


Weight vector of global side channel:
W: [[ 9.4684362e-01 -4.9743772e-01 -5.3058198e-04]] b:[-0.91599804]

Coeff rule on x1: x1 >= [0.9674227]


#D#Running with seed = 4
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2normnoneavgedgeattnmean
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/TopoFeature/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2',
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:53:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:53:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9317
Train Loss: 0.1500
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.1548
ID Test ACCURACY: 0.9340
ID Test Loss: 0.1438
OOD Validation ACCURACY: 0.9200
OOD Validation Loss: 0.1548
OOD Test ACCURACY: 0.9340
OOD Test Loss: 0.1438

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9317
Train Loss: 0.1500
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.1548
ID Test ACCURACY: 0.9340
ID Test Loss: 0.1438
OOD Validation ACCURACY: 0.9200
OOD Validation Loss: 0.1548
OOD Test ACCURACY: 0.9340
OOD Test Loss: 0.1438

[0m[1;37mINFO[0m: [1mChartInfo 0.9340 0.9340 0.9340 0.9340 0.9200 0.9200[0mTrain ACCURACY: 0.9317 	Train Loss: 0.1500 	Train WIoU: 0.477 	
Id_val ACCURACY: 0.9200 	Id_val Loss: 0.1548 	Id_val WIoU: 0.482 	
Id_test ACCURACY: 0.9340 	Id_test Loss: 0.1438 	Id_test WIoU: 0.465 	
Val ACCURACY: 0.7452 	Val Loss: 0.6930 	Val WIoU: 0.251 	
Test ACCURACY: 0.8632 	Test Loss: 0.4333 	Test WIoU: 0.699 	

Concept relevance scores for this run:
 [[0.9920978  0.00790215]] 


Weight vector of global side channel:
W: [[ 0.15184592  0.06537082 -0.01052559]] b:[0.23690626]

Coeff rule on x1: x1 >= [-1.5601754]


#D#Running with seed = 5
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2normnoneavgedgeattnmean
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/TopoFeature/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2',
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:53:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:53:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9918
Train Loss: 0.0443
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0458
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0468
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0458
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0468

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 96...
[0m[1;37mINFO[0m: [1mCheckpoint 96: 
-----------------------------------
Train ACCURACY: 0.9918
Train Loss: 0.0443
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0458
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0468
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0458
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0468

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9940 0.9940[0mTrain ACCURACY: 0.9918 	Train Loss: 0.0443 	Train WIoU: 0.459 	
Id_val ACCURACY: 0.9940 	Id_val Loss: 0.0458 	Id_val WIoU: 0.468 	
Id_test ACCURACY: 0.9920 	Id_test Loss: 0.0468 	Id_test WIoU: 0.462 	
Val ACCURACY: 0.7096 	Val Loss: 1.2916 	Val WIoU: 0.167 	
Test ACCURACY: 0.8758 	Test Loss: 0.3763 	Test WIoU: 0.750 	

Concept relevance scores for this run:
 [[0.98404354 0.01595651]] 


Weight vector of global side channel:
W: [[ 0.46035808  0.5182744  -0.00574171]] b:[-0.094871]

Coeff rule on x1: x1 >= [0.20608088]


#D#Running with seed = 6
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2normnoneavgedgeattnmean
595 6
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/TopoFeature/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 6,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2',
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 6,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:53:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:53:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.8865
Train Loss: 0.3352
ID Validation ACCURACY: 0.8760
ID Validation Loss: 0.3846
ID Test ACCURACY: 0.8800
ID Test Loss: 0.3331
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3846
OOD Test ACCURACY: 0.8800
OOD Test Loss: 0.3331

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.8865
Train Loss: 0.3352
ID Validation ACCURACY: 0.8760
ID Validation Loss: 0.3846
ID Test ACCURACY: 0.8800
ID Test Loss: 0.3331
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3846
OOD Test ACCURACY: 0.8800
OOD Test Loss: 0.3331

[0m[1;37mINFO[0m: [1mChartInfo 0.8800 0.8800 0.8800 0.8800 0.8760 0.8760[0mTrain ACCURACY: 0.8865 	Train Loss: 0.3352 	Train WIoU: 0.710 	
Id_val ACCURACY: 0.8760 	Id_val Loss: 0.3846 	Id_val WIoU: 0.730 	
Id_test ACCURACY: 0.8800 	Id_test Loss: 0.3331 	Id_test WIoU: 0.715 	
Val ACCURACY: 0.6934 	Val Loss: 4.2606 	Val WIoU: 0.377 	
Test ACCURACY: 0.7592 	Test Loss: 0.6340 	Test WIoU: 0.867 	

Concept relevance scores for this run:
 [[0.95326334 0.04673666]] 


Weight vector of global side channel:
W: [[ 0.49368656  0.27576166 -0.02011234]] b:[-0.11497013]

Coeff rule on x1: x1 >= [0.23288082]


#D#Running with seed = 7
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2normnoneavgedgeattnmean
692 7
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/TopoFeature/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 7,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2',
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 7,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:53:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:53:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ACCURACY: 0.8357
Train Loss: 0.4291
ID Validation ACCURACY: 0.8460
ID Validation Loss: 0.4509
ID Test ACCURACY: 0.8260
ID Test Loss: 0.4213
OOD Validation ACCURACY: 0.8460
OOD Validation Loss: 0.4509
OOD Test ACCURACY: 0.8260
OOD Test Loss: 0.4213

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ACCURACY: 0.8357
Train Loss: 0.4291
ID Validation ACCURACY: 0.8460
ID Validation Loss: 0.4509
ID Test ACCURACY: 0.8260
ID Test Loss: 0.4213
OOD Validation ACCURACY: 0.8460
OOD Validation Loss: 0.4509
OOD Test ACCURACY: 0.8260
OOD Test Loss: 0.4213

[0m[1;37mINFO[0m: [1mChartInfo 0.8260 0.8260 0.8260 0.8260 0.8460 0.8460[0mTrain ACCURACY: 0.8357 	Train Loss: 0.4291 	Train WIoU: 0.621 	
Id_val ACCURACY: 0.8460 	Id_val Loss: 0.4509 	Id_val WIoU: 0.637 	
Id_test ACCURACY: 0.8260 	Id_test Loss: 0.4213 	Id_test WIoU: 0.625 	
Val ACCURACY: 0.6578 	Val Loss: 1.1655 	Val WIoU: 0.272 	
Test ACCURACY: 0.7506 	Test Loss: 0.6002 	Test WIoU: 0.852 	

Concept relevance scores for this run:
 [[0.96258146 0.03741853]] 


Weight vector of global side channel:
W: [[ 0.19772984 -0.18850523  0.00430772]] b:[-0.66802984]

Coeff rule on x1: x1 >= [3.3784978]


#D#Running with seed = 8
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2normnoneavgedgeattnmean
789 8
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/TopoFeature/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 8,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2',
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 8,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:53:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:53:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9875
Train Loss: 0.0723
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0657
ID Test ACCURACY: 0.9840
ID Test Loss: 0.0721
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0657
OOD Test ACCURACY: 0.9840
OOD Test Loss: 0.0721

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9875
Train Loss: 0.0723
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0657
ID Test ACCURACY: 0.9840
ID Test Loss: 0.0721
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0657
OOD Test ACCURACY: 0.9840
OOD Test Loss: 0.0721

[0m[1;37mINFO[0m: [1mChartInfo 0.9840 0.9840 0.9840 0.9840 0.9920 0.9920[0mTrain ACCURACY: 0.9875 	Train Loss: 0.0723 	Train WIoU: 0.522 	
Id_val ACCURACY: 0.9920 	Id_val Loss: 0.0657 	Id_val WIoU: 0.507 	
Id_test ACCURACY: 0.9840 	Id_test Loss: 0.0721 	Id_test WIoU: 0.528 	
Val ACCURACY: 0.9540 	Val Loss: 0.1318 	Val WIoU: 0.360 	
Test ACCURACY: 0.7184 	Test Loss: 1.1367 	Test WIoU: 0.816 	

Concept relevance scores for this run:
 [[9.9959993e-01 4.0009487e-04]] 


Weight vector of global side channel:
W: [[ 0.38055468 -0.02909695 -0.02020123]] b:[0.14594524]

Coeff rule on x1: x1 >= [-0.38350663]


#D#Running with seed = 9
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2normnoneavgedgeattnmean
886 9
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/TopoFeature/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 9,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2',
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 9,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:53:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:53:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9257
Train Loss: 0.1640
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.1784
ID Test ACCURACY: 0.9220
ID Test Loss: 0.1725
OOD Validation ACCURACY: 0.9200
OOD Validation Loss: 0.1784
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.1725

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9257
Train Loss: 0.1640
ID Validation ACCURACY: 0.9200
ID Validation Loss: 0.1784
ID Test ACCURACY: 0.9220
ID Test Loss: 0.1725
OOD Validation ACCURACY: 0.9200
OOD Validation Loss: 0.1784
OOD Test ACCURACY: 0.9220
OOD Test Loss: 0.1725

[0m[1;37mINFO[0m: [1mChartInfo 0.9220 0.9220 0.9220 0.9220 0.9200 0.9200[0mTrain ACCURACY: 0.9257 	Train Loss: 0.1640 	Train WIoU: 0.741 	
Id_val ACCURACY: 0.9200 	Id_val Loss: 0.1784 	Id_val WIoU: 0.747 	
Id_test ACCURACY: 0.9220 	Id_test Loss: 0.1725 	Id_test WIoU: 0.738 	
Val ACCURACY: 0.6280 	Val Loss: 5.0437 	Val WIoU: 0.506 	
Test ACCURACY: 0.8328 	Test Loss: 0.6376 	Test WIoU: 0.864 	

Concept relevance scores for this run:
 [[0.9919982  0.00800178]] 


Weight vector of global side channel:
W: [[ 0.17229497  0.02559635 -0.01440228]] b:[0.41540506]

Coeff rule on x1: x1 >= [-2.411011]


#D#Running with seed = 10
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2normnoneavgedgeattnmean
983 10
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/TopoFeature/basis/no_shift/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 10,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2',
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 10,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9/10',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Sep 11 09:53:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/11/2024 09:53:34 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0043
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0043

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0004
ID Test ACCURACY: 0.9980
ID Test Loss: 0.0043
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0004
OOD Test ACCURACY: 0.9980
OOD Test Loss: 0.0043

[0m[1;37mINFO[0m: [1mChartInfo 0.9980 0.9980 0.9980 0.9980 1.0000 1.0000[0mTrain ACCURACY: 1.0000 	Train Loss: 0.0004 	Train WIoU: 0.696 	
Id_val ACCURACY: 1.0000 	Id_val Loss: 0.0004 	Id_val WIoU: 0.709 	
Id_test ACCURACY: 0.9980 	Id_test Loss: 0.0043 	Id_test WIoU: 0.701 	
Val ACCURACY: 0.7876 	Val Loss: 1.6091 	Val WIoU: 0.452 	
Test ACCURACY: 0.9796 	Test Loss: 0.2268 	Test WIoU: 0.878 	

Concept relevance scores for this run:
 [[0.02062013 0.9793799 ]] 


Weight vector of global side channel:
W: [[ 1.0793267  -0.20282446 -0.00118304]] b:[-1.1258298]

Coeff rule on x1: x1 >= [1.0430852]


Final accuracies: 
TRAIN      = 0.955 +- 0.055
ID_VAL     = 0.954 +- 0.055
ID_TEST    = 0.952 +- 0.057
VAL        = 0.785 +- 0.131
TEST       = 0.849 +- 0.091


Final accuracies (model with id_val acc above 0.9% - 8 runs): 
TRAIN      = 0.978 +- 0.029
ID_VAL     = 0.977 +- 0.033
ID_TEST    = 0.977 +- 0.029
VAL        = 0.812 +- 0.133
TEST       = 0.873 +- 0.086


Averaged channel relevance scores (model with id_val acc above 0.9% - 8 runs): 
[0.62016976 0.3798303 ] +- [0.42958325 0.42958325]


Final Test WIoUs (model with id_val acc above 0.9% - 8 runs):
TRAIN      = 0.622 +- 0.171
ID_VAL     = 0.626 +- 0.172
ID_TEST    = 0.623 +- 0.171
VAL        = 0.414 +- 0.247
TEST       = 0.821 +- 0.070


Global side channel coefficient wrt x1 (model with id_val acc above 0.9% - 8 runs):
[0.1720509] +- [1.4697884]


Final losses: 
TRAIN      = 0.1235 +- 0.1422
ID_VAL     = 0.1315 +- 0.1554
ID_TEST    = 0.1239 +- 0.1395
VAL        = 1.6598 +- 1.6558
TEST       = 0.5147 +- 0.2891
Diff id_val-test  = 0.3832 

Concept relevance scores:
 [[0.02062013 0.9793799 ]] 

/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The given 'InMemoryDataset' only references a subset of examples of the full dataset, but 'data' will contain information of the full dataset. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
