
[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Oct 22 17:45:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/22/2024 05:45:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/GOODTwitter_length_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9413
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0108
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0199
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0108
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0199

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9413
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0108
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0199
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0108
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0199

[0m[1;37mINFO[0m: [1mChartInfo 0.4531 0.4531 0.4531 0.4531 0.4765 0.4765[0mTrain ACCURACY: 0.4954 	Train Loss: 0.9413 	
Id_val ACCURACY: 0.4765 	Id_val Loss: 1.0108 	
Id_test ACCURACY: 0.4531 	Id_test Loss: 1.0199 	
Val ACCURACY: 0.5356 	Val Loss: 0.9903 	
Test ACCURACY: 0.4935 	Test Loss: 1.0169 	

Concept relevance scores for this run:
 [[0.00378236 0.816042   0.00873301 0.00943919 0.15344429 0.00855905]] 



#D#Running with seed = 2
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/GOODTwitter/length/covariate/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Oct 22 17:45:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/22/2024 05:45:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/GOODTwitter_length_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9786
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0298
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0406
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0298
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0406

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9786
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0298
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0406
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0298
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0406

[0m[1;37mINFO[0m: [1mChartInfo 0.4531 0.4531 0.4531 0.4531 0.4765 0.4765[0mTrain ACCURACY: 0.4954 	Train Loss: 0.9786 	
Id_val ACCURACY: 0.4765 	Id_val Loss: 1.0298 	
Id_test ACCURACY: 0.4531 	Id_test Loss: 1.0406 	
Val ACCURACY: 0.5356 	Val Loss: 1.0087 	
Test ACCURACY: 0.4935 	Test Loss: 1.0359 	

Concept relevance scores for this run:
 [[0.00378307 0.9645945  0.00633551 0.00939734 0.00784973 0.00803986]] 



#D#Running with seed = 3
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/GOODTwitter/length/covariate/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Oct 22 17:45:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/22/2024 05:45:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/GOODTwitter_length_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9139
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0069
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0243
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0069
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0243

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9139
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0069
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0243
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0069
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0243

[0m[1;37mINFO[0m: [1mChartInfo 0.4531 0.4531 0.4531 0.4531 0.4765 0.4765[0mTrain ACCURACY: 0.4954 	Train Loss: 0.9139 	
Id_val ACCURACY: 0.4765 	Id_val Loss: 1.0069 	
Id_test ACCURACY: 0.4531 	Id_test Loss: 1.0243 	
Val ACCURACY: 0.5356 	Val Loss: 0.9884 	
Test ACCURACY: 0.4935 	Test Loss: 1.0269 	

Concept relevance scores for this run:
 [[0.00309904 0.00783629 0.00862312 0.00345674 0.97505593 0.00192881]] 



#D#Running with seed = 4
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/GOODTwitter/length/covariate/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Oct 22 17:45:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/22/2024 05:45:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/GOODTwitter_length_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.8947
ID Validation ACCURACY: 0.4765
ID Validation Loss: 0.9959
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0179
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 0.9959
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0179

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.8947
ID Validation ACCURACY: 0.4765
ID Validation Loss: 0.9959
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0179
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 0.9959
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0179

[0m[1;37mINFO[0m: [1mChartInfo 0.4531 0.4531 0.4531 0.4531 0.4765 0.4765[0mTrain ACCURACY: 0.4954 	Train Loss: 0.8947 	
Id_val ACCURACY: 0.4765 	Id_val Loss: 0.9959 	
Id_test ACCURACY: 0.4531 	Id_test Loss: 1.0179 	
Val ACCURACY: 0.5356 	Val Loss: 0.9764 	
Test ACCURACY: 0.4935 	Test Loss: 1.0173 	

Concept relevance scores for this run:
 [[0.00171572 0.9848786  0.00166465 0.00177907 0.00745656 0.00250546]] 



#D#Running with seed = 5
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/GOODTwitter/length/covariate/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Oct 22 17:45:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/22/2024 05:45:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 21 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/GOODTwitter_length_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.7583
Train Loss: 0.4935
ID Validation ACCURACY: 0.5758
ID Validation Loss: 0.9221
ID Test ACCURACY: 0.5596
ID Test Loss: 0.9646
OOD Validation ACCURACY: 0.5758
OOD Validation Loss: 0.9221
OOD Test ACCURACY: 0.5596
OOD Test Loss: 0.9646

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.7583
Train Loss: 0.4935
ID Validation ACCURACY: 0.5758
ID Validation Loss: 0.9221
ID Test ACCURACY: 0.5596
ID Test Loss: 0.9646
OOD Validation ACCURACY: 0.5758
OOD Validation Loss: 0.9221
OOD Test ACCURACY: 0.5596
OOD Test Loss: 0.9646

[0m[1;37mINFO[0m: [1mChartInfo 0.5596 0.5596 0.5596 0.5596 0.5758 0.5758[0mTrain ACCURACY: 0.7583 	Train Loss: 0.4935 	
Id_val ACCURACY: 0.5758 	Id_val Loss: 0.9221 	
Id_test ACCURACY: 0.5596 	Id_test Loss: 0.9646 	
Val ACCURACY: 0.5602 	Val Loss: 0.9747 	
Test ACCURACY: 0.5202 	Test Loss: 1.0637 	

Concept relevance scores for this run:
 [[7.2181207e-04 2.8442201e-01 8.0341223e-04 5.0765043e-04 1.9572699e-01
  5.1781809e-01]] 



#D#Running with seed = 6
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
595 6
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/GOODTwitter/length/covariate/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 6,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 6,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Oct 22 17:45:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/22/2024 05:45:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/GOODTwitter_length_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9537
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0161
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0312
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0161
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0312

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9537
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0161
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0312
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0161
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0312

[0m[1;37mINFO[0m: [1mChartInfo 0.4531 0.4531 0.4531 0.4531 0.4765 0.4765[0mTrain ACCURACY: 0.4954 	Train Loss: 0.9537 	
Id_val ACCURACY: 0.4765 	Id_val Loss: 1.0161 	
Id_test ACCURACY: 0.4531 	Id_test Loss: 1.0312 	
Val ACCURACY: 0.5356 	Val Loss: 0.9912 	
Test ACCURACY: 0.4935 	Test Loss: 1.0261 	

Concept relevance scores for this run:
 [[0.12956716 0.07115224 0.01193602 0.01509685 0.7109072  0.0613405 ]] 



#D#Running with seed = 7
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
692 7
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/GOODTwitter/length/covariate/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 7,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 7,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Oct 22 17:45:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/22/2024 05:45:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/GOODTwitter_length_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9453
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0115
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0371
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0115
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0371

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9453
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0115
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0371
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0115
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0371

[0m[1;37mINFO[0m: [1mChartInfo 0.4531 0.4531 0.4531 0.4531 0.4765 0.4765[0mTrain ACCURACY: 0.4954 	Train Loss: 0.9453 	
Id_val ACCURACY: 0.4765 	Id_val Loss: 1.0115 	
Id_test ACCURACY: 0.4531 	Id_test Loss: 1.0371 	
Val ACCURACY: 0.5356 	Val Loss: 0.9875 	
Test ACCURACY: 0.4935 	Test Loss: 1.0196 	

Concept relevance scores for this run:
 [[0.00277921 0.90240943 0.00242565 0.00199178 0.08846476 0.0019291 ]] 



#D#Running with seed = 8
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
789 8
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/GOODTwitter/length/covariate/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 8,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 8,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Oct 22 17:45:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/22/2024 05:45:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 21 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/GOODTwitter_length_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.7575
Train Loss: 0.5490
ID Validation ACCURACY: 0.5921
ID Validation Loss: 0.8815
ID Test ACCURACY: 0.5921
ID Test Loss: 0.8976
OOD Validation ACCURACY: 0.5921
OOD Validation Loss: 0.8815
OOD Test ACCURACY: 0.5921
OOD Test Loss: 0.8976

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.7575
Train Loss: 0.5490
ID Validation ACCURACY: 0.5921
ID Validation Loss: 0.8815
ID Test ACCURACY: 0.5921
ID Test Loss: 0.8976
OOD Validation ACCURACY: 0.5921
OOD Validation Loss: 0.8815
OOD Test ACCURACY: 0.5921
OOD Test Loss: 0.8976

[0m[1;37mINFO[0m: [1mChartInfo 0.5921 0.5921 0.5921 0.5921 0.5921 0.5921[0mTrain ACCURACY: 0.7575 	Train Loss: 0.5490 	
Id_val ACCURACY: 0.5921 	Id_val Loss: 0.8815 	
Id_test ACCURACY: 0.5921 	Id_test Loss: 0.8976 	
Val ACCURACY: 0.5697 	Val Loss: 0.9353 	
Test ACCURACY: 0.5278 	Test Loss: 1.0084 	

Concept relevance scores for this run:
 [[0.0006584  0.01365454 0.46481302 0.00064727 0.5195509  0.00067579]] 



#D#Running with seed = 9
model_dirname= repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean
886 9
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/home/azzolin/sedignn/global_local_sedignn/configs/final_configs/GOODTwitter/length/covariate/SMGNN.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 9,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'global_side_channel': 'simple_concept2temperature',
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_expl_scores': 'default',
 'mitigation_expl_scores_topk': -1,
 'mitigation_readout': None,
 'mitigation_sampling': 'raw',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': None,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 9,
 'ratios': '',
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5/6/7/8/9',
 'splits': '',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'use_norm': 'none',
 'wandb': False}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Oct 22 17:45:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 10/22/2024 05:45:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/GOODTwitter_length_covariate/repr_SMGNNGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingrawgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9251
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0102
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0300
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0102
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0300

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.4954
Train Loss: 0.9251
ID Validation ACCURACY: 0.4765
ID Validation Loss: 1.0102
ID Test ACCURACY: 0.4531
ID Test Loss: 1.0300
OOD Validation ACCURACY: 0.4765
OOD Validation Loss: 1.0102
OOD Test ACCURACY: 0.4531
OOD Test Loss: 1.0300

[0m[1;37mINFO[0m: [1mChartInfo 0.4531 0.4531 0.4531 0.4531 0.4765 0.4765[0mTrain ACCURACY: 0.4954 	Train Loss: 0.9251 	
Id_val ACCURACY: 0.4765 	Id_val Loss: 1.0102 	
Id_test ACCURACY: 0.4531 	Id_test Loss: 1.0300 	
Val ACCURACY: 0.5356 	Val Loss: 0.9888 	
Test ACCURACY: 0.4935 	Test Loss: 1.0269 	

Concept relevance scores for this run:
 [[0.00452842 0.00342429 0.00404297 0.00427326 0.9590037  0.02472739]] 



Final accuracies: 
TRAIN      = 0.554 +- 0.109
ID_VAL     = 0.500 +- 0.045
ID_TEST    = 0.480 +- 0.052
VAL        = 0.542 +- 0.012
TEST       = 0.500 +- 0.013


Final accuracies (model with id_val acc above 0.0% - 9 runs): 
TRAIN      = 0.554 +- 0.109
ID_VAL     = 0.500 +- 0.045
ID_TEST    = 0.480 +- 0.052
VAL        = 0.542 +- 0.012
TEST       = 0.500 +- 0.013


Averaged channel relevance scores (model with id_val acc above 0.0% - 9 runs): 
[0.01673724 0.44982374 0.05659749 0.00517657 0.40194    0.0697249 ] +- [0.0399121  0.42763448 0.14436856 0.00473955 0.37439433 0.159481  ]


Final Test WIoUs (model with id_val acc above 0.0% - 9 runs):
TRAIN      = nan +- nan
ID_VAL     = nan +- nan
ID_TEST    = nan +- nan
VAL        = nan +- nan
TEST       = nan +- nan


Final losses: 
TRAIN      = 0.8439 +- 0.1744
ID_VAL     = 0.9872 +- 0.0474
ID_TEST    = 1.0070 +- 0.0441
VAL        = 0.9824 +- 0.0190
TEST       = 1.0268 +- 0.0150
Diff id_val-test  = 0.0397 
