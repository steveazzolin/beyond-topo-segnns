nohup: ignoring input
Time to compute metrics!
The PID of this script is: 719284
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 16:19:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 04:19:53 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 04:20:24 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 04:20:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 04:20:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:02 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:21:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ROC-AUC: 0.9747
Train Loss: 0.1592
ID Validation ROC-AUC: 0.9216
ID Validation Loss: 0.3096
ID Test ROC-AUC: 0.9242
ID Test Loss: 0.3130
OOD Validation ROC-AUC: 0.6625
OOD Validation Loss: 0.4639
OOD Test ROC-AUC: 0.7200
OOD Test Loss: 0.6879

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.2596
ID Validation ROC-AUC: 0.8990
ID Validation Loss: 0.2737
ID Test ROC-AUC: 0.9017
ID Test Loss: 0.2762
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2996
OOD Test ROC-AUC: 0.7346
OOD Test Loss: 0.4781

[0m[1;37mINFO[0m: [1mChartInfo 0.9242 0.7200 0.9017 0.7346 0.8990 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 04:21:22 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 04:21:28 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.763
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.721
SUFF++ for r=0.3 class 0.0 = 0.754 +- 0.125 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 class 1.0 = 0.824 +- 0.125 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 all KL = 0.89 +- 0.125 (in-sample avg dev_std = 0.255)
SUFF++ for r=0.3 all L1 = 0.816 +- 0.148 (in-sample avg dev_std = 0.255)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.859
SUFF++ for r=0.6 class 0.0 = 0.734 +- 0.111 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.6 class 1.0 = 0.937 +- 0.111 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.6 all KL = 0.943 +- 0.111 (in-sample avg dev_std = 0.165)
SUFF++ for r=0.6 all L1 = 0.913 +- 0.141 (in-sample avg dev_std = 0.165)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.905
SUFF++ for r=0.9 class 0.0 = 0.82 +- 0.054 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 class 1.0 = 0.975 +- 0.054 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all KL = 0.98 +- 0.054 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.9 all L1 = 0.957 +- 0.097 (in-sample avg dev_std = 0.110)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.632
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.606
SUFF++ for r=0.3 class 0.0 = 0.746 +- 0.132 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 class 1.0 = 0.779 +- 0.132 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all KL = 0.869 +- 0.132 (in-sample avg dev_std = 0.289)
SUFF++ for r=0.3 all L1 = 0.773 +- 0.144 (in-sample avg dev_std = 0.289)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.709
SUFF++ for r=0.6 class 0.0 = 0.753 +- 0.121 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 class 1.0 = 0.873 +- 0.121 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 all KL = 0.913 +- 0.121 (in-sample avg dev_std = 0.211)
SUFF++ for r=0.6 all L1 = 0.853 +- 0.165 (in-sample avg dev_std = 0.211)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.745
SUFF++ for r=0.9 class 0.0 = 0.85 +- 0.076 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.9 class 1.0 = 0.942 +- 0.076 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.9 all KL = 0.964 +- 0.076 (in-sample avg dev_std = 0.137)
SUFF++ for r=0.9 all L1 = 0.927 +- 0.119 (in-sample avg dev_std = 0.137)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.763
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.705
NEC for r=0.3 class 0.0 = 0.377 +- 0.199 (in-sample avg dev_std = 0.288)
NEC for r=0.3 class 1.0 = 0.257 +- 0.199 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all KL = 0.206 +- 0.199 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all L1 = 0.271 +- 0.189 (in-sample avg dev_std = 0.288)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.858
NEC for r=0.6 class 0.0 = 0.318 +- 0.131 (in-sample avg dev_std = 0.177)
NEC for r=0.6 class 1.0 = 0.074 +- 0.131 (in-sample avg dev_std = 0.177)
NEC for r=0.6 all KL = 0.076 +- 0.131 (in-sample avg dev_std = 0.177)
NEC for r=0.6 all L1 = 0.103 +- 0.156 (in-sample avg dev_std = 0.177)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.876
NEC for r=0.9 class 0.0 = 0.259 +- 0.103 (in-sample avg dev_std = 0.144)
NEC for r=0.9 class 1.0 = 0.036 +- 0.103 (in-sample avg dev_std = 0.144)
NEC for r=0.9 all KL = 0.04 +- 0.103 (in-sample avg dev_std = 0.144)
NEC for r=0.9 all L1 = 0.062 +- 0.133 (in-sample avg dev_std = 0.144)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.931
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.881
NEC for r=1.0 class 0.0 = 0.268 +- 0.104 (in-sample avg dev_std = 0.150)
NEC for r=1.0 class 1.0 = 0.033 +- 0.104 (in-sample avg dev_std = 0.150)
NEC for r=1.0 all KL = 0.039 +- 0.104 (in-sample avg dev_std = 0.150)
NEC for r=1.0 all L1 = 0.06 +- 0.133 (in-sample avg dev_std = 0.150)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.632
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.625
NEC for r=0.3 class 0.0 = 0.364 +- 0.203 (in-sample avg dev_std = 0.305)
NEC for r=0.3 class 1.0 = 0.322 +- 0.203 (in-sample avg dev_std = 0.305)
NEC for r=0.3 all KL = 0.23 +- 0.203 (in-sample avg dev_std = 0.305)
NEC for r=0.3 all L1 = 0.329 +- 0.189 (in-sample avg dev_std = 0.305)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.719
NEC for r=0.6 class 0.0 = 0.271 +- 0.143 (in-sample avg dev_std = 0.219)
NEC for r=0.6 class 1.0 = 0.149 +- 0.143 (in-sample avg dev_std = 0.219)
NEC for r=0.6 all KL = 0.112 +- 0.143 (in-sample avg dev_std = 0.219)
NEC for r=0.6 all L1 = 0.169 +- 0.180 (in-sample avg dev_std = 0.219)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.77
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.742
NEC for r=0.9 class 0.0 = 0.187 +- 0.098 (in-sample avg dev_std = 0.163)
NEC for r=0.9 class 1.0 = 0.076 +- 0.098 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all KL = 0.054 +- 0.098 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all L1 = 0.094 +- 0.143 (in-sample avg dev_std = 0.163)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.773
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.746
NEC for r=1.0 class 0.0 = 0.188 +- 0.104 (in-sample avg dev_std = 0.159)
NEC for r=1.0 class 1.0 = 0.075 +- 0.104 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all KL = 0.053 +- 0.104 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all L1 = 0.094 +- 0.149 (in-sample avg dev_std = 0.159)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 16:25:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 04:25:00 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 04:25:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 04:25:41 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 04:25:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9783
Train Loss: 0.1269
ID Validation ROC-AUC: 0.9244
ID Validation Loss: 0.2658
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.2679
OOD Validation ROC-AUC: 0.6593
OOD Validation Loss: 0.4783
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9086
Train Loss: 0.2436
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2566
ID Test ROC-AUC: 0.8988
ID Test Loss: 0.2585
OOD Validation ROC-AUC: 0.6869
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7309
OOD Test Loss: 0.4531

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7128 0.8988 0.7309 0.8959 0.6869[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 04:26:23 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 04:26:27 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.702
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 786
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.601
SUFF++ for r=0.3 class 0.0 = 0.77 +- 0.135 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 class 1.0 = 0.776 +- 0.135 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 all KL = 0.865 +- 0.135 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 all L1 = 0.776 +- 0.120 (in-sample avg dev_std = 0.271)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.822
SUFF++ for r=0.6 class 0.0 = 0.787 +- 0.123 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.6 class 1.0 = 0.894 +- 0.123 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.6 all KL = 0.92 +- 0.123 (in-sample avg dev_std = 0.178)
SUFF++ for r=0.6 all L1 = 0.881 +- 0.138 (in-sample avg dev_std = 0.178)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.921
SUFF++ for r=0.9 class 0.0 = 0.894 +- 0.034 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.9 class 1.0 = 0.983 +- 0.034 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.9 all KL = 0.991 +- 0.034 (in-sample avg dev_std = 0.087)
SUFF++ for r=0.9 all L1 = 0.973 +- 0.062 (in-sample avg dev_std = 0.087)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.599
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 783
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.574
SUFF++ for r=0.3 class 0.0 = 0.774 +- 0.116 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.3 class 1.0 = 0.776 +- 0.116 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.3 all KL = 0.884 +- 0.116 (in-sample avg dev_std = 0.260)
SUFF++ for r=0.3 all L1 = 0.776 +- 0.110 (in-sample avg dev_std = 0.260)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.685
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.662
SUFF++ for r=0.6 class 0.0 = 0.798 +- 0.121 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 class 1.0 = 0.849 +- 0.121 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 all KL = 0.909 +- 0.121 (in-sample avg dev_std = 0.208)
SUFF++ for r=0.6 all L1 = 0.84 +- 0.137 (in-sample avg dev_std = 0.208)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.749
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.744
SUFF++ for r=0.9 class 0.0 = 0.908 +- 0.050 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 class 1.0 = 0.953 +- 0.050 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all KL = 0.981 +- 0.050 (in-sample avg dev_std = 0.125)
SUFF++ for r=0.9 all L1 = 0.945 +- 0.084 (in-sample avg dev_std = 0.125)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.706
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.685
NEC for r=0.3 class 0.0 = 0.213 +- 0.099 (in-sample avg dev_std = 0.213)
NEC for r=0.3 class 1.0 = 0.183 +- 0.099 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all KL = 0.087 +- 0.099 (in-sample avg dev_std = 0.213)
NEC for r=0.3 all L1 = 0.187 +- 0.126 (in-sample avg dev_std = 0.213)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.842
NEC for r=0.6 class 0.0 = 0.224 +- 0.099 (in-sample avg dev_std = 0.181)
NEC for r=0.6 class 1.0 = 0.087 +- 0.099 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all KL = 0.058 +- 0.099 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all L1 = 0.103 +- 0.130 (in-sample avg dev_std = 0.181)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.894
NEC for r=0.9 class 0.0 = 0.281 +- 0.117 (in-sample avg dev_std = 0.170)
NEC for r=0.9 class 1.0 = 0.05 +- 0.117 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all KL = 0.053 +- 0.117 (in-sample avg dev_std = 0.170)
NEC for r=0.9 all L1 = 0.077 +- 0.137 (in-sample avg dev_std = 0.170)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.938
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.896
NEC for r=1.0 class 0.0 = 0.297 +- 0.120 (in-sample avg dev_std = 0.168)
NEC for r=1.0 class 1.0 = 0.045 +- 0.120 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all KL = 0.052 +- 0.120 (in-sample avg dev_std = 0.168)
NEC for r=1.0 all L1 = 0.075 +- 0.141 (in-sample avg dev_std = 0.168)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.604
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.599
NEC for r=0.3 class 0.0 = 0.211 +- 0.115 (in-sample avg dev_std = 0.230)
NEC for r=0.3 class 1.0 = 0.212 +- 0.115 (in-sample avg dev_std = 0.230)
NEC for r=0.3 all KL = 0.099 +- 0.115 (in-sample avg dev_std = 0.230)
NEC for r=0.3 all L1 = 0.212 +- 0.122 (in-sample avg dev_std = 0.230)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.685
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.666
NEC for r=0.6 class 0.0 = 0.2 +- 0.118 (in-sample avg dev_std = 0.218)
NEC for r=0.6 class 1.0 = 0.143 +- 0.118 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all KL = 0.083 +- 0.118 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all L1 = 0.153 +- 0.141 (in-sample avg dev_std = 0.218)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.749
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.723
NEC for r=0.9 class 0.0 = 0.24 +- 0.124 (in-sample avg dev_std = 0.203)
NEC for r=0.9 class 1.0 = 0.112 +- 0.124 (in-sample avg dev_std = 0.203)
NEC for r=0.9 all KL = 0.078 +- 0.124 (in-sample avg dev_std = 0.203)
NEC for r=0.9 all L1 = 0.133 +- 0.164 (in-sample avg dev_std = 0.203)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.753
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.729
NEC for r=1.0 class 0.0 = 0.234 +- 0.134 (in-sample avg dev_std = 0.205)
NEC for r=1.0 class 1.0 = 0.111 +- 0.134 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all KL = 0.082 +- 0.134 (in-sample avg dev_std = 0.205)
NEC for r=1.0 all L1 = 0.132 +- 0.170 (in-sample avg dev_std = 0.205)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 16:30:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 04:30:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 04:30:43 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 04:30:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:04 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:20 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:31:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9586
Train Loss: 0.1793
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2525
OOD Validation ROC-AUC: 0.6759
OOD Validation Loss: 0.3745
OOD Test ROC-AUC: 0.7109
OOD Test Loss: 0.5685

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ROC-AUC: 0.9479
Train Loss: 0.1985
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2618
ID Test ROC-AUC: 0.9197
ID Test Loss: 0.2606
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.3598
OOD Test ROC-AUC: 0.7250
OOD Test Loss: 0.5469

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7109 0.9197 0.7250 0.9155 0.6885[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 04:31:36 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 04:31:40 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.725
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.68
SUFF++ for r=0.3 class 0.0 = 0.776 +- 0.092 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 class 1.0 = 0.808 +- 0.092 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all KL = 0.913 +- 0.092 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.3 all L1 = 0.804 +- 0.119 (in-sample avg dev_std = 0.249)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.903
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.847
SUFF++ for r=0.6 class 0.0 = 0.721 +- 0.086 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.6 class 1.0 = 0.917 +- 0.086 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.6 all KL = 0.943 +- 0.086 (in-sample avg dev_std = 0.161)
SUFF++ for r=0.6 all L1 = 0.894 +- 0.134 (in-sample avg dev_std = 0.161)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.908
SUFF++ for r=0.9 class 0.0 = 0.8 +- 0.050 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 class 1.0 = 0.969 +- 0.050 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 all KL = 0.98 +- 0.050 (in-sample avg dev_std = 0.111)
SUFF++ for r=0.9 all L1 = 0.95 +- 0.100 (in-sample avg dev_std = 0.111)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.62
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.588
SUFF++ for r=0.3 class 0.0 = 0.782 +- 0.094 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 class 1.0 = 0.787 +- 0.094 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 all KL = 0.904 +- 0.094 (in-sample avg dev_std = 0.271)
SUFF++ for r=0.3 all L1 = 0.786 +- 0.112 (in-sample avg dev_std = 0.271)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.73
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.694
SUFF++ for r=0.6 class 0.0 = 0.757 +- 0.083 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 class 1.0 = 0.855 +- 0.083 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 all KL = 0.925 +- 0.083 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 all L1 = 0.839 +- 0.143 (in-sample avg dev_std = 0.195)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.752
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.724
SUFF++ for r=0.9 class 0.0 = 0.841 +- 0.054 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 class 1.0 = 0.932 +- 0.054 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all KL = 0.968 +- 0.054 (in-sample avg dev_std = 0.129)
SUFF++ for r=0.9 all L1 = 0.917 +- 0.112 (in-sample avg dev_std = 0.129)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.725
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.702
NEC for r=0.3 class 0.0 = 0.308 +- 0.157 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 1.0 = 0.289 +- 0.157 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all KL = 0.165 +- 0.157 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all L1 = 0.291 +- 0.154 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.903
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.857
NEC for r=0.6 class 0.0 = 0.284 +- 0.107 (in-sample avg dev_std = 0.161)
NEC for r=0.6 class 1.0 = 0.096 +- 0.107 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all KL = 0.072 +- 0.107 (in-sample avg dev_std = 0.161)
NEC for r=0.6 all L1 = 0.118 +- 0.139 (in-sample avg dev_std = 0.161)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.926
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.89
NEC for r=0.9 class 0.0 = 0.233 +- 0.080 (in-sample avg dev_std = 0.120)
NEC for r=0.9 class 1.0 = 0.042 +- 0.080 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all KL = 0.035 +- 0.080 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all L1 = 0.064 +- 0.113 (in-sample avg dev_std = 0.120)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.9
NEC for r=1.0 class 0.0 = 0.219 +- 0.070 (in-sample avg dev_std = 0.117)
NEC for r=1.0 class 1.0 = 0.035 +- 0.070 (in-sample avg dev_std = 0.117)
NEC for r=1.0 all KL = 0.03 +- 0.070 (in-sample avg dev_std = 0.117)
NEC for r=1.0 all L1 = 0.056 +- 0.107 (in-sample avg dev_std = 0.117)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.62
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.608
NEC for r=0.3 class 0.0 = 0.284 +- 0.156 (in-sample avg dev_std = 0.265)
NEC for r=0.3 class 1.0 = 0.304 +- 0.156 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all KL = 0.159 +- 0.156 (in-sample avg dev_std = 0.265)
NEC for r=0.3 all L1 = 0.301 +- 0.149 (in-sample avg dev_std = 0.265)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.73
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.703
NEC for r=0.6 class 0.0 = 0.238 +- 0.097 (in-sample avg dev_std = 0.191)
NEC for r=0.6 class 1.0 = 0.153 +- 0.097 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all KL = 0.081 +- 0.097 (in-sample avg dev_std = 0.191)
NEC for r=0.6 all L1 = 0.167 +- 0.142 (in-sample avg dev_std = 0.191)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.752
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.714
NEC for r=0.9 class 0.0 = 0.186 +- 0.074 (in-sample avg dev_std = 0.142)
NEC for r=0.9 class 1.0 = 0.088 +- 0.074 (in-sample avg dev_std = 0.142)
NEC for r=0.9 all KL = 0.048 +- 0.074 (in-sample avg dev_std = 0.142)
NEC for r=0.9 all L1 = 0.104 +- 0.123 (in-sample avg dev_std = 0.142)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.751
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.715
NEC for r=1.0 class 0.0 = 0.165 +- 0.072 (in-sample avg dev_std = 0.142)
NEC for r=1.0 class 1.0 = 0.08 +- 0.072 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all KL = 0.042 +- 0.072 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all L1 = 0.094 +- 0.121 (in-sample avg dev_std = 0.142)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 16:35:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 04:35:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 04:35:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 04:35:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 04:35:53 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:08 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:36:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:36:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9561
Train Loss: 0.1699
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2340
ID Test ROC-AUC: 0.9235
ID Test Loss: 0.2358
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3970
OOD Test ROC-AUC: 0.7067
OOD Test Loss: 0.5494

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9016
Train Loss: 0.2482
ID Validation ROC-AUC: 0.8949
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8953
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6908
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7285
OOD Test Loss: 0.4503

[0m[1;37mINFO[0m: [1mChartInfo 0.9235 0.7067 0.8953 0.7285 0.8949 0.6908[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 04:36:24 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 04:36:28 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.757
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.704
SUFF++ for r=0.3 class 0.0 = 0.804 +- 0.082 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 class 1.0 = 0.791 +- 0.082 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 all KL = 0.914 +- 0.082 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.3 all L1 = 0.792 +- 0.102 (in-sample avg dev_std = 0.252)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.843
SUFF++ for r=0.6 class 0.0 = 0.755 +- 0.082 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 class 1.0 = 0.899 +- 0.082 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 all KL = 0.941 +- 0.082 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 all L1 = 0.882 +- 0.128 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.898
SUFF++ for r=0.9 class 0.0 = 0.829 +- 0.052 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.9 class 1.0 = 0.963 +- 0.052 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.9 all KL = 0.977 +- 0.052 (in-sample avg dev_std = 0.122)
SUFF++ for r=0.9 all L1 = 0.948 +- 0.093 (in-sample avg dev_std = 0.122)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.582
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.581
SUFF++ for r=0.3 class 0.0 = 0.792 +- 0.091 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 class 1.0 = 0.774 +- 0.091 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all KL = 0.91 +- 0.091 (in-sample avg dev_std = 0.263)
SUFF++ for r=0.3 all L1 = 0.777 +- 0.105 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.692
SUFF++ for r=0.6 class 0.0 = 0.772 +- 0.084 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 1.0 = 0.838 +- 0.084 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all KL = 0.92 +- 0.084 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all L1 = 0.827 +- 0.138 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.733
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.726
SUFF++ for r=0.9 class 0.0 = 0.869 +- 0.062 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 class 1.0 = 0.924 +- 0.062 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all KL = 0.964 +- 0.062 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all L1 = 0.915 +- 0.105 (in-sample avg dev_std = 0.140)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.757
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.705
NEC for r=0.3 class 0.0 = 0.279 +- 0.143 (in-sample avg dev_std = 0.273)
NEC for r=0.3 class 1.0 = 0.306 +- 0.143 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all KL = 0.155 +- 0.143 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all L1 = 0.303 +- 0.138 (in-sample avg dev_std = 0.273)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.884
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.849
NEC for r=0.6 class 0.0 = 0.25 +- 0.125 (in-sample avg dev_std = 0.194)
NEC for r=0.6 class 1.0 = 0.13 +- 0.125 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all KL = 0.092 +- 0.125 (in-sample avg dev_std = 0.194)
NEC for r=0.6 all L1 = 0.144 +- 0.138 (in-sample avg dev_std = 0.194)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.911
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.88
NEC for r=0.9 class 0.0 = 0.234 +- 0.088 (in-sample avg dev_std = 0.138)
NEC for r=0.9 class 1.0 = 0.058 +- 0.088 (in-sample avg dev_std = 0.138)
NEC for r=0.9 all KL = 0.048 +- 0.088 (in-sample avg dev_std = 0.138)
NEC for r=0.9 all L1 = 0.078 +- 0.119 (in-sample avg dev_std = 0.138)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.92
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.88
NEC for r=1.0 class 0.0 = 0.221 +- 0.089 (in-sample avg dev_std = 0.139)
NEC for r=1.0 class 1.0 = 0.05 +- 0.089 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all KL = 0.042 +- 0.089 (in-sample avg dev_std = 0.139)
NEC for r=1.0 all L1 = 0.07 +- 0.114 (in-sample avg dev_std = 0.139)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.582
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.587
NEC for r=0.3 class 0.0 = 0.289 +- 0.130 (in-sample avg dev_std = 0.263)
NEC for r=0.3 class 1.0 = 0.3 +- 0.130 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all KL = 0.139 +- 0.130 (in-sample avg dev_std = 0.263)
NEC for r=0.3 all L1 = 0.299 +- 0.135 (in-sample avg dev_std = 0.263)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.714
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.691
NEC for r=0.6 class 0.0 = 0.262 +- 0.127 (in-sample avg dev_std = 0.232)
NEC for r=0.6 class 1.0 = 0.205 +- 0.127 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all KL = 0.119 +- 0.127 (in-sample avg dev_std = 0.232)
NEC for r=0.6 all L1 = 0.214 +- 0.148 (in-sample avg dev_std = 0.232)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.733
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.721
NEC for r=0.9 class 0.0 = 0.202 +- 0.108 (in-sample avg dev_std = 0.176)
NEC for r=0.9 class 1.0 = 0.119 +- 0.108 (in-sample avg dev_std = 0.176)
NEC for r=0.9 all KL = 0.075 +- 0.108 (in-sample avg dev_std = 0.176)
NEC for r=0.9 all L1 = 0.133 +- 0.136 (in-sample avg dev_std = 0.176)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.743
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.713
NEC for r=1.0 class 0.0 = 0.201 +- 0.105 (in-sample avg dev_std = 0.175)
NEC for r=1.0 class 1.0 = 0.106 +- 0.105 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all KL = 0.064 +- 0.105 (in-sample avg dev_std = 0.175)
NEC for r=1.0 all L1 = 0.122 +- 0.140 (in-sample avg dev_std = 0.175)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 16:40:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 04:40:03 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 04:40:33 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 04:40:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 04:40:54 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:10 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:25 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9604
Train Loss: 0.1577
ID Validation ROC-AUC: 0.9213
ID Validation Loss: 0.2276
ID Test ROC-AUC: 0.9231
ID Test Loss: 0.2288
OOD Validation ROC-AUC: 0.6638
OOD Validation Loss: 0.4052
OOD Test ROC-AUC: 0.7105
OOD Test Loss: 0.5421

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.8989
Train Loss: 0.2529
ID Validation ROC-AUC: 0.8912
ID Validation Loss: 0.2608
ID Test ROC-AUC: 0.8911
ID Test Loss: 0.2654
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.2898
OOD Test ROC-AUC: 0.7229
OOD Test Loss: 0.4564

[0m[1;37mINFO[0m: [1mChartInfo 0.9231 0.7105 0.8911 0.7229 0.8912 0.6866[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 04:41:26 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 04:41:30 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.661
SUFF++ for r=0.3 class 0.0 = 0.765 +- 0.111 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 class 1.0 = 0.74 +- 0.111 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 all KL = 0.868 +- 0.111 (in-sample avg dev_std = 0.311)
SUFF++ for r=0.3 all L1 = 0.743 +- 0.118 (in-sample avg dev_std = 0.311)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.826
SUFF++ for r=0.6 class 0.0 = 0.718 +- 0.121 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.6 class 1.0 = 0.872 +- 0.121 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.6 all KL = 0.911 +- 0.121 (in-sample avg dev_std = 0.216)
SUFF++ for r=0.6 all L1 = 0.855 +- 0.143 (in-sample avg dev_std = 0.216)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.916
SUFF++ for r=0.9 class 0.0 = 0.83 +- 0.059 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 class 1.0 = 0.961 +- 0.059 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all KL = 0.976 +- 0.059 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all L1 = 0.946 +- 0.094 (in-sample avg dev_std = 0.116)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.581
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.556
SUFF++ for r=0.3 class 0.0 = 0.743 +- 0.106 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 class 1.0 = 0.745 +- 0.106 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all KL = 0.875 +- 0.106 (in-sample avg dev_std = 0.316)
SUFF++ for r=0.3 all L1 = 0.744 +- 0.113 (in-sample avg dev_std = 0.316)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.698
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.662
SUFF++ for r=0.6 class 0.0 = 0.753 +- 0.108 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 class 1.0 = 0.803 +- 0.108 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all KL = 0.892 +- 0.108 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all L1 = 0.795 +- 0.144 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.717
SUFF++ for r=0.9 class 0.0 = 0.873 +- 0.068 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 class 1.0 = 0.916 +- 0.068 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all KL = 0.963 +- 0.068 (in-sample avg dev_std = 0.136)
SUFF++ for r=0.9 all L1 = 0.909 +- 0.110 (in-sample avg dev_std = 0.136)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.715
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.692
NEC for r=0.3 class 0.0 = 0.304 +- 0.188 (in-sample avg dev_std = 0.320)
NEC for r=0.3 class 1.0 = 0.364 +- 0.188 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all KL = 0.221 +- 0.188 (in-sample avg dev_std = 0.320)
NEC for r=0.3 all L1 = 0.357 +- 0.156 (in-sample avg dev_std = 0.320)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.891
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.845
NEC for r=0.6 class 0.0 = 0.268 +- 0.141 (in-sample avg dev_std = 0.214)
NEC for r=0.6 class 1.0 = 0.156 +- 0.141 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all KL = 0.113 +- 0.141 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all L1 = 0.169 +- 0.153 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.93
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.899
NEC for r=0.9 class 0.0 = 0.215 +- 0.103 (in-sample avg dev_std = 0.145)
NEC for r=0.9 class 1.0 = 0.065 +- 0.103 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all KL = 0.056 +- 0.103 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all L1 = 0.082 +- 0.115 (in-sample avg dev_std = 0.145)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.929
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.902
NEC for r=1.0 class 0.0 = 0.22 +- 0.098 (in-sample avg dev_std = 0.140)
NEC for r=1.0 class 1.0 = 0.055 +- 0.098 (in-sample avg dev_std = 0.140)
NEC for r=1.0 all KL = 0.048 +- 0.098 (in-sample avg dev_std = 0.140)
NEC for r=1.0 all L1 = 0.075 +- 0.113 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.581
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.574
NEC for r=0.3 class 0.0 = 0.321 +- 0.164 (in-sample avg dev_std = 0.306)
NEC for r=0.3 class 1.0 = 0.336 +- 0.164 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all KL = 0.187 +- 0.164 (in-sample avg dev_std = 0.306)
NEC for r=0.3 all L1 = 0.334 +- 0.148 (in-sample avg dev_std = 0.306)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.698
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.657
NEC for r=0.6 class 0.0 = 0.28 +- 0.141 (in-sample avg dev_std = 0.252)
NEC for r=0.6 class 1.0 = 0.224 +- 0.141 (in-sample avg dev_std = 0.252)
NEC for r=0.6 all KL = 0.135 +- 0.141 (in-sample avg dev_std = 0.252)
NEC for r=0.6 all L1 = 0.233 +- 0.151 (in-sample avg dev_std = 0.252)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.73
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.693
NEC for r=0.9 class 0.0 = 0.197 +- 0.122 (in-sample avg dev_std = 0.185)
NEC for r=0.9 class 1.0 = 0.134 +- 0.122 (in-sample avg dev_std = 0.185)
NEC for r=0.9 all KL = 0.083 +- 0.122 (in-sample avg dev_std = 0.185)
NEC for r=0.9 all L1 = 0.144 +- 0.134 (in-sample avg dev_std = 0.185)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.747
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.713
NEC for r=1.0 class 0.0 = 0.202 +- 0.116 (in-sample avg dev_std = 0.181)
NEC for r=1.0 class 1.0 = 0.121 +- 0.116 (in-sample avg dev_std = 0.181)
NEC for r=1.0 all KL = 0.073 +- 0.116 (in-sample avg dev_std = 0.181)
NEC for r=1.0 all L1 = 0.135 +- 0.144 (in-sample avg dev_std = 0.181)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.89, 0.943, 0.98, 1.0], 'all_L1': [0.816, 0.913, 0.957, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.865, 0.92, 0.991, 1.0], 'all_L1': [0.776, 0.881, 0.973, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.913, 0.943, 0.98, 1.0], 'all_L1': [0.804, 0.894, 0.95, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.914, 0.941, 0.977, 1.0], 'all_L1': [0.792, 0.882, 0.948, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.911, 0.976, 1.0], 'all_L1': [0.743, 0.855, 0.946, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.206, 0.076, 0.04, 0.039], 'all_L1': [0.271, 0.103, 0.062, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.087, 0.058, 0.053, 0.052], 'all_L1': [0.187, 0.103, 0.077, 0.075]}), defaultdict(<class 'list'>, {'all_KL': [0.165, 0.072, 0.035, 0.03], 'all_L1': [0.291, 0.118, 0.064, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.155, 0.092, 0.048, 0.042], 'all_L1': [0.303, 0.144, 0.078, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.221, 0.113, 0.056, 0.048], 'all_L1': [0.357, 0.169, 0.082, 0.075]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.869, 0.913, 0.964, 1.0], 'all_L1': [0.773, 0.853, 0.927, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.909, 0.981, 1.0], 'all_L1': [0.776, 0.84, 0.945, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.925, 0.968, 1.0], 'all_L1': [0.786, 0.839, 0.917, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.91, 0.92, 0.964, 1.0], 'all_L1': [0.777, 0.827, 0.915, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.875, 0.892, 0.963, 1.0], 'all_L1': [0.744, 0.795, 0.909, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.23, 0.112, 0.054, 0.053], 'all_L1': [0.329, 0.169, 0.094, 0.094]}), defaultdict(<class 'list'>, {'all_KL': [0.099, 0.083, 0.078, 0.082], 'all_L1': [0.212, 0.153, 0.133, 0.132]}), defaultdict(<class 'list'>, {'all_KL': [0.159, 0.081, 0.048, 0.042], 'all_L1': [0.301, 0.167, 0.104, 0.094]}), defaultdict(<class 'list'>, {'all_KL': [0.139, 0.119, 0.075, 0.064], 'all_L1': [0.299, 0.214, 0.133, 0.122]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.135, 0.083, 0.073], 'all_L1': [0.334, 0.233, 0.144, 0.135]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.786 +- 0.025, 0.885 +- 0.019, 0.955 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.890 +- 0.021, 0.932 +- 0.013, 0.981 +- 0.005, 1.000 +- 0.000
suff++_acc_int  =  0.673 +- 0.042, 0.839 +- 0.014, 0.910 +- 0.008
nec class all_L1  =  0.282 +- 0.055, 0.127 +- 0.026, 0.073 +- 0.008, 0.067 +- 0.008
nec class all_KL  =  0.167 +- 0.047, 0.082 +- 0.019, 0.046 +- 0.008, 0.042 +- 0.008
nec_acc_int  =  0.698 +- 0.008, 0.850 +- 0.006, 0.888 +- 0.009, 0.892 +- 0.009

Eval split test
suff++ class all_L1  =  0.771 +- 0.014, 0.831 +- 0.020, 0.923 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.888 +- 0.016, 0.912 +- 0.011, 0.968 +- 0.007, 1.000 +- 0.000
suff++_acc_int  =  0.581 +- 0.017, 0.684 +- 0.019, 0.731 +- 0.011
nec class all_L1  =  0.295 +- 0.044, 0.187 +- 0.031, 0.122 +- 0.019, 0.115 +- 0.018
nec class all_KL  =  0.163 +- 0.044, 0.106 +- 0.021, 0.068 +- 0.014, 0.063 +- 0.014
nec_acc_int  =  0.599 +- 0.018, 0.687 +- 0.023, 0.718 +- 0.016, 0.723 +- 0.013


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.534 +- 0.026, 0.506 +- 0.008, 0.514 +- 0.006, 0.534 +- 0.004
Faith. Armon (L1)= 		  =  0.411 +- 0.060, 0.222 +- 0.038, 0.135 +- 0.014, 0.126 +- 0.014
Faith. GMean (L1)= 	  =  0.468 +- 0.046, 0.334 +- 0.030, 0.263 +- 0.015, 0.259 +- 0.015
Faith. Aritm (KL)= 		  =  0.528 +- 0.027, 0.507 +- 0.009, 0.514 +- 0.005, 0.521 +- 0.004
Faith. Armon (KL)= 		  =  0.278 +- 0.068, 0.150 +- 0.031, 0.088 +- 0.014, 0.081 +- 0.014
Faith. GMean (KL)= 	  =  0.381 +- 0.058, 0.275 +- 0.031, 0.213 +- 0.018, 0.205 +- 0.019

Eval split test
Faith. Aritm (L1)= 		  =  0.533 +- 0.020, 0.509 +- 0.008, 0.522 +- 0.011, 0.558 +- 0.009
Faith. Armon (L1)= 		  =  0.425 +- 0.047, 0.304 +- 0.039, 0.214 +- 0.030, 0.206 +- 0.029
Faith. GMean (L1)= 	  =  0.475 +- 0.036, 0.393 +- 0.028, 0.334 +- 0.027, 0.339 +- 0.027
Faith. Aritm (KL)= 		  =  0.526 +- 0.019, 0.509 +- 0.008, 0.518 +- 0.008, 0.531 +- 0.007
Faith. Armon (KL)= 		  =  0.272 +- 0.062, 0.189 +- 0.034, 0.126 +- 0.024, 0.118 +- 0.025
Faith. GMean (KL)= 	  =  0.376 +- 0.050, 0.309 +- 0.030, 0.254 +- 0.027, 0.249 +- 0.029
Computed for split load_split = id



Completed in  0:25:20.703020  for LECIvGIN LBAPcore/assay



DONE LECI LBAPcore/assay
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 16:45:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 04:45:30 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 04:46:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 04:46:25 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 04:46:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 04:46:52 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:47:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9683
Train Loss: 0.1420
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2255
ID Test ROC-AUC: 0.9251
ID Test Loss: 0.2246
OOD Validation ROC-AUC: 0.6374
OOD Validation Loss: 0.4787
OOD Test ROC-AUC: 0.6853
OOD Test Loss: 0.5698

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ROC-AUC: 0.9140
Train Loss: 0.2226
ID Validation ROC-AUC: 0.9010
ID Validation Loss: 0.2385
ID Test ROC-AUC: 0.9039
ID Test Loss: 0.2385
OOD Validation ROC-AUC: 0.6822
OOD Validation Loss: 0.3129
OOD Test ROC-AUC: 0.7143
OOD Test Loss: 0.4523

[0m[1;37mINFO[0m: [1mChartInfo 0.9251 0.6853 0.9039 0.7143 0.9010 0.6822[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 04:47:09 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 04:47:14 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.727
SUFF++ for r=0.3 class 0.0 = 0.717 +- 0.296 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 class 1.0 = 0.892 +- 0.296 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 all KL = 0.75 +- 0.296 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.3 all L1 = 0.871 +- 0.171 (in-sample avg dev_std = 0.333)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.781
SUFF++ for r=0.6 class 0.0 = 0.768 +- 0.205 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 class 1.0 = 0.941 +- 0.205 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 all KL = 0.868 +- 0.205 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.6 all L1 = 0.921 +- 0.138 (in-sample avg dev_std = 0.209)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.863
SUFF++ for r=0.9 class 0.0 = 0.728 +- 0.132 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 class 1.0 = 0.944 +- 0.132 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 all KL = 0.941 +- 0.132 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.9 all L1 = 0.919 +- 0.137 (in-sample avg dev_std = 0.160)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.592
SUFF++ for r=0.3 class 0.0 = 0.759 +- 0.290 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.3 class 1.0 = 0.82 +- 0.290 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.3 all KL = 0.711 +- 0.290 (in-sample avg dev_std = 0.374)
SUFF++ for r=0.3 all L1 = 0.81 +- 0.202 (in-sample avg dev_std = 0.374)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.682
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.659
SUFF++ for r=0.6 class 0.0 = 0.829 +- 0.216 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.6 class 1.0 = 0.892 +- 0.216 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.6 all KL = 0.834 +- 0.216 (in-sample avg dev_std = 0.252)
SUFF++ for r=0.6 all L1 = 0.881 +- 0.158 (in-sample avg dev_std = 0.252)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.724
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.673
SUFF++ for r=0.9 class 0.0 = 0.77 +- 0.138 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 class 1.0 = 0.879 +- 0.138 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all KL = 0.918 +- 0.138 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.9 all L1 = 0.861 +- 0.160 (in-sample avg dev_std = 0.203)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.734
NEC for r=0.3 class 0.0 = 0.358 +- 0.314 (in-sample avg dev_std = 0.311)
NEC for r=0.3 class 1.0 = 0.113 +- 0.314 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all KL = 0.236 +- 0.314 (in-sample avg dev_std = 0.311)
NEC for r=0.3 all L1 = 0.142 +- 0.206 (in-sample avg dev_std = 0.311)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.849
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.803
NEC for r=0.6 class 0.0 = 0.277 +- 0.222 (in-sample avg dev_std = 0.226)
NEC for r=0.6 class 1.0 = 0.064 +- 0.222 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all KL = 0.144 +- 0.222 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all L1 = 0.089 +- 0.150 (in-sample avg dev_std = 0.226)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.906
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.82
NEC for r=0.9 class 0.0 = 0.385 +- 0.170 (in-sample avg dev_std = 0.208)
NEC for r=0.9 class 1.0 = 0.085 +- 0.170 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all KL = 0.113 +- 0.170 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all L1 = 0.12 +- 0.170 (in-sample avg dev_std = 0.208)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.827
NEC for r=1.0 class 0.0 = 0.381 +- 0.157 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 1.0 = 0.093 +- 0.157 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all KL = 0.108 +- 0.157 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all L1 = 0.127 +- 0.166 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.602
NEC for r=0.3 class 0.0 = 0.258 +- 0.309 (in-sample avg dev_std = 0.335)
NEC for r=0.3 class 1.0 = 0.189 +- 0.309 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all KL = 0.287 +- 0.309 (in-sample avg dev_std = 0.335)
NEC for r=0.3 all L1 = 0.2 +- 0.229 (in-sample avg dev_std = 0.335)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.682
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.65
NEC for r=0.6 class 0.0 = 0.203 +- 0.237 (in-sample avg dev_std = 0.268)
NEC for r=0.6 class 1.0 = 0.124 +- 0.237 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all KL = 0.193 +- 0.237 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all L1 = 0.137 +- 0.172 (in-sample avg dev_std = 0.268)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.724
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.673
NEC for r=0.9 class 0.0 = 0.301 +- 0.172 (in-sample avg dev_std = 0.261)
NEC for r=0.9 class 1.0 = 0.174 +- 0.172 (in-sample avg dev_std = 0.261)
NEC for r=0.9 all KL = 0.152 +- 0.172 (in-sample avg dev_std = 0.261)
NEC for r=0.9 all L1 = 0.195 +- 0.177 (in-sample avg dev_std = 0.261)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.736
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.671
NEC for r=1.0 class 0.0 = 0.332 +- 0.171 (in-sample avg dev_std = 0.289)
NEC for r=1.0 class 1.0 = 0.194 +- 0.171 (in-sample avg dev_std = 0.289)
NEC for r=1.0 all KL = 0.155 +- 0.171 (in-sample avg dev_std = 0.289)
NEC for r=1.0 all L1 = 0.217 +- 0.183 (in-sample avg dev_std = 0.289)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 16:50:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 04:50:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 04:51:10 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 04:51:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 04:51:31 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 04:51:46 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9686
Train Loss: 0.1412
ID Validation ROC-AUC: 0.9211
ID Validation Loss: 0.2263
ID Test ROC-AUC: 0.9251
ID Test Loss: 0.2237
OOD Validation ROC-AUC: 0.6449
OOD Validation Loss: 0.4664
OOD Test ROC-AUC: 0.6906
OOD Test Loss: 0.5564

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9194
Train Loss: 0.2142
ID Validation ROC-AUC: 0.9010
ID Validation Loss: 0.2357
ID Test ROC-AUC: 0.9053
ID Test Loss: 0.2328
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.3224
OOD Test ROC-AUC: 0.7183
OOD Test Loss: 0.4429

[0m[1;37mINFO[0m: [1mChartInfo 0.9251 0.6906 0.9053 0.7183 0.9010 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 04:52:02 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 04:52:06 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.769
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.719
SUFF++ for r=0.3 class 0.0 = 0.682 +- 0.298 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 class 1.0 = 0.871 +- 0.298 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 all KL = 0.726 +- 0.298 (in-sample avg dev_std = 0.351)
SUFF++ for r=0.3 all L1 = 0.849 +- 0.188 (in-sample avg dev_std = 0.351)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.805
SUFF++ for r=0.6 class 0.0 = 0.734 +- 0.235 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.6 class 1.0 = 0.937 +- 0.235 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.6 all KL = 0.835 +- 0.235 (in-sample avg dev_std = 0.240)
SUFF++ for r=0.6 all L1 = 0.913 +- 0.131 (in-sample avg dev_std = 0.240)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.857
SUFF++ for r=0.9 class 0.0 = 0.688 +- 0.170 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 class 1.0 = 0.932 +- 0.170 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 all KL = 0.913 +- 0.170 (in-sample avg dev_std = 0.179)
SUFF++ for r=0.9 all L1 = 0.903 +- 0.149 (in-sample avg dev_std = 0.179)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.591
SUFF++ for r=0.3 class 0.0 = 0.731 +- 0.291 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 class 1.0 = 0.795 +- 0.291 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all KL = 0.688 +- 0.291 (in-sample avg dev_std = 0.409)
SUFF++ for r=0.3 all L1 = 0.785 +- 0.213 (in-sample avg dev_std = 0.409)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.661
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.628
SUFF++ for r=0.6 class 0.0 = 0.808 +- 0.230 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 class 1.0 = 0.888 +- 0.230 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 all KL = 0.814 +- 0.230 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.6 all L1 = 0.875 +- 0.152 (in-sample avg dev_std = 0.274)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.712
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.693
SUFF++ for r=0.9 class 0.0 = 0.748 +- 0.172 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.9 class 1.0 = 0.858 +- 0.172 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.9 all KL = 0.882 +- 0.172 (in-sample avg dev_std = 0.220)
SUFF++ for r=0.9 all L1 = 0.839 +- 0.165 (in-sample avg dev_std = 0.220)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.769
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.737
NEC for r=0.3 class 0.0 = 0.348 +- 0.303 (in-sample avg dev_std = 0.274)
NEC for r=0.3 class 1.0 = 0.117 +- 0.303 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all KL = 0.224 +- 0.303 (in-sample avg dev_std = 0.274)
NEC for r=0.3 all L1 = 0.144 +- 0.218 (in-sample avg dev_std = 0.274)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.86
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.824
NEC for r=0.6 class 0.0 = 0.285 +- 0.228 (in-sample avg dev_std = 0.222)
NEC for r=0.6 class 1.0 = 0.057 +- 0.228 (in-sample avg dev_std = 0.222)
NEC for r=0.6 all KL = 0.141 +- 0.228 (in-sample avg dev_std = 0.222)
NEC for r=0.6 all L1 = 0.084 +- 0.143 (in-sample avg dev_std = 0.222)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.908
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.848
NEC for r=0.9 class 0.0 = 0.373 +- 0.175 (in-sample avg dev_std = 0.221)
NEC for r=0.9 class 1.0 = 0.086 +- 0.175 (in-sample avg dev_std = 0.221)
NEC for r=0.9 all KL = 0.123 +- 0.175 (in-sample avg dev_std = 0.221)
NEC for r=0.9 all L1 = 0.12 +- 0.158 (in-sample avg dev_std = 0.221)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.837
NEC for r=1.0 class 0.0 = 0.398 +- 0.176 (in-sample avg dev_std = 0.238)
NEC for r=1.0 class 1.0 = 0.103 +- 0.176 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all KL = 0.131 +- 0.176 (in-sample avg dev_std = 0.238)
NEC for r=1.0 all L1 = 0.137 +- 0.168 (in-sample avg dev_std = 0.238)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.597
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.579
NEC for r=0.3 class 0.0 = 0.28 +- 0.318 (in-sample avg dev_std = 0.336)
NEC for r=0.3 class 1.0 = 0.206 +- 0.318 (in-sample avg dev_std = 0.336)
NEC for r=0.3 all KL = 0.298 +- 0.318 (in-sample avg dev_std = 0.336)
NEC for r=0.3 all L1 = 0.219 +- 0.247 (in-sample avg dev_std = 0.336)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.661
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.643
NEC for r=0.6 class 0.0 = 0.198 +- 0.234 (in-sample avg dev_std = 0.265)
NEC for r=0.6 class 1.0 = 0.118 +- 0.234 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all KL = 0.18 +- 0.234 (in-sample avg dev_std = 0.265)
NEC for r=0.6 all L1 = 0.132 +- 0.167 (in-sample avg dev_std = 0.265)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.712
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.66
NEC for r=0.9 class 0.0 = 0.288 +- 0.178 (in-sample avg dev_std = 0.267)
NEC for r=0.9 class 1.0 = 0.176 +- 0.178 (in-sample avg dev_std = 0.267)
NEC for r=0.9 all KL = 0.162 +- 0.178 (in-sample avg dev_std = 0.267)
NEC for r=0.9 all L1 = 0.194 +- 0.177 (in-sample avg dev_std = 0.267)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.734
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.667
NEC for r=1.0 class 0.0 = 0.315 +- 0.162 (in-sample avg dev_std = 0.281)
NEC for r=1.0 class 1.0 = 0.198 +- 0.162 (in-sample avg dev_std = 0.281)
NEC for r=1.0 all KL = 0.152 +- 0.162 (in-sample avg dev_std = 0.281)
NEC for r=1.0 all L1 = 0.218 +- 0.178 (in-sample avg dev_std = 0.281)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 16:55:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 04:55:25 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 04:55:57 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:07 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:18 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:34 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 04:56:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ROC-AUC: 0.9700
Train Loss: 0.1384
ID Validation ROC-AUC: 0.9239
ID Validation Loss: 0.2236
ID Test ROC-AUC: 0.9258
ID Test Loss: 0.2238
OOD Validation ROC-AUC: 0.6361
OOD Validation Loss: 0.4564
OOD Test ROC-AUC: 0.6863
OOD Test Loss: 0.5633

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9076
Train Loss: 0.2268
ID Validation ROC-AUC: 0.8921
ID Validation Loss: 0.2443
ID Test ROC-AUC: 0.8980
ID Test Loss: 0.2413
OOD Validation ROC-AUC: 0.6868
OOD Validation Loss: 0.3111
OOD Test ROC-AUC: 0.7174
OOD Test Loss: 0.4442

[0m[1;37mINFO[0m: [1mChartInfo 0.9258 0.6863 0.8980 0.7174 0.8921 0.6868[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 04:56:50 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 04:56:54 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.768
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.731
SUFF++ for r=0.3 class 0.0 = 0.767 +- 0.279 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 class 1.0 = 0.919 +- 0.279 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 all KL = 0.785 +- 0.279 (in-sample avg dev_std = 0.290)
SUFF++ for r=0.3 all L1 = 0.902 +- 0.149 (in-sample avg dev_std = 0.290)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.778
SUFF++ for r=0.6 class 0.0 = 0.78 +- 0.193 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 class 1.0 = 0.951 +- 0.193 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 all KL = 0.874 +- 0.193 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.6 all L1 = 0.931 +- 0.119 (in-sample avg dev_std = 0.206)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.917
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.856
SUFF++ for r=0.9 class 0.0 = 0.722 +- 0.143 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 class 1.0 = 0.944 +- 0.143 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all KL = 0.93 +- 0.143 (in-sample avg dev_std = 0.164)
SUFF++ for r=0.9 all L1 = 0.918 +- 0.136 (in-sample avg dev_std = 0.164)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.63
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.615
SUFF++ for r=0.3 class 0.0 = 0.785 +- 0.289 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 class 1.0 = 0.862 +- 0.289 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 all KL = 0.733 +- 0.289 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.3 all L1 = 0.849 +- 0.174 (in-sample avg dev_std = 0.350)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.649
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.639
SUFF++ for r=0.6 class 0.0 = 0.837 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 class 1.0 = 0.905 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all KL = 0.837 +- 0.218 (in-sample avg dev_std = 0.243)
SUFF++ for r=0.6 all L1 = 0.893 +- 0.149 (in-sample avg dev_std = 0.243)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.726
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.684
SUFF++ for r=0.9 class 0.0 = 0.77 +- 0.144 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 class 1.0 = 0.878 +- 0.144 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all KL = 0.909 +- 0.144 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all L1 = 0.86 +- 0.164 (in-sample avg dev_std = 0.200)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.768
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.727
NEC for r=0.3 class 0.0 = 0.276 +- 0.275 (in-sample avg dev_std = 0.243)
NEC for r=0.3 class 1.0 = 0.068 +- 0.275 (in-sample avg dev_std = 0.243)
NEC for r=0.3 all KL = 0.17 +- 0.275 (in-sample avg dev_std = 0.243)
NEC for r=0.3 all L1 = 0.092 +- 0.169 (in-sample avg dev_std = 0.243)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.85
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.798
NEC for r=0.6 class 0.0 = 0.245 +- 0.209 (in-sample avg dev_std = 0.204)
NEC for r=0.6 class 1.0 = 0.053 +- 0.209 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all KL = 0.13 +- 0.209 (in-sample avg dev_std = 0.204)
NEC for r=0.6 all L1 = 0.076 +- 0.137 (in-sample avg dev_std = 0.204)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.917
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.833
NEC for r=0.9 class 0.0 = 0.361 +- 0.155 (in-sample avg dev_std = 0.201)
NEC for r=0.9 class 1.0 = 0.074 +- 0.155 (in-sample avg dev_std = 0.201)
NEC for r=0.9 all KL = 0.108 +- 0.155 (in-sample avg dev_std = 0.201)
NEC for r=0.9 all L1 = 0.107 +- 0.155 (in-sample avg dev_std = 0.201)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.822
NEC for r=1.0 class 0.0 = 0.377 +- 0.149 (in-sample avg dev_std = 0.214)
NEC for r=1.0 class 1.0 = 0.087 +- 0.149 (in-sample avg dev_std = 0.214)
NEC for r=1.0 all KL = 0.103 +- 0.149 (in-sample avg dev_std = 0.214)
NEC for r=1.0 all L1 = 0.121 +- 0.164 (in-sample avg dev_std = 0.214)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.63
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.59
NEC for r=0.3 class 0.0 = 0.236 +- 0.314 (in-sample avg dev_std = 0.313)
NEC for r=0.3 class 1.0 = 0.139 +- 0.314 (in-sample avg dev_std = 0.313)
NEC for r=0.3 all KL = 0.263 +- 0.314 (in-sample avg dev_std = 0.313)
NEC for r=0.3 all L1 = 0.155 +- 0.200 (in-sample avg dev_std = 0.313)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.649
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.632
NEC for r=0.6 class 0.0 = 0.192 +- 0.238 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 1.0 = 0.107 +- 0.238 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all KL = 0.185 +- 0.238 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all L1 = 0.121 +- 0.163 (in-sample avg dev_std = 0.258)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.726
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.667
NEC for r=0.9 class 0.0 = 0.289 +- 0.164 (in-sample avg dev_std = 0.250)
NEC for r=0.9 class 1.0 = 0.161 +- 0.164 (in-sample avg dev_std = 0.250)
NEC for r=0.9 all KL = 0.146 +- 0.164 (in-sample avg dev_std = 0.250)
NEC for r=0.9 all L1 = 0.183 +- 0.177 (in-sample avg dev_std = 0.250)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.729
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.665
NEC for r=1.0 class 0.0 = 0.33 +- 0.168 (in-sample avg dev_std = 0.271)
NEC for r=1.0 class 1.0 = 0.192 +- 0.168 (in-sample avg dev_std = 0.271)
NEC for r=1.0 all KL = 0.148 +- 0.168 (in-sample avg dev_std = 0.271)
NEC for r=1.0 all L1 = 0.215 +- 0.191 (in-sample avg dev_std = 0.271)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:00:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:00:13 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:00:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:00:56 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:23 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:39 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:39 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ROC-AUC: 0.9701
Train Loss: 0.1379
ID Validation ROC-AUC: 0.9219
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9249
ID Test Loss: 0.2294
OOD Validation ROC-AUC: 0.6427
OOD Validation Loss: 0.4806
OOD Test ROC-AUC: 0.6915
OOD Test Loss: 0.5778

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 58...
[0m[1;37mINFO[0m: [1mCheckpoint 58: 
-----------------------------------
Train ROC-AUC: 0.9368
Train Loss: 0.1927
ID Validation ROC-AUC: 0.9098
ID Validation Loss: 0.2281
ID Test ROC-AUC: 0.9159
ID Test Loss: 0.2220
OOD Validation ROC-AUC: 0.6858
OOD Validation Loss: 0.3482
OOD Test ROC-AUC: 0.7149
OOD Test Loss: 0.4585

[0m[1;37mINFO[0m: [1mChartInfo 0.9249 0.6915 0.9159 0.7149 0.9098 0.6858[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:01:40 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:01:44 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.749
SUFF++ for r=0.3 class 0.0 = 0.747 +- 0.247 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.3 class 1.0 = 0.926 +- 0.247 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.3 all KL = 0.825 +- 0.247 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.3 all L1 = 0.905 +- 0.150 (in-sample avg dev_std = 0.258)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.808
SUFF++ for r=0.6 class 0.0 = 0.763 +- 0.179 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 class 1.0 = 0.961 +- 0.179 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 all KL = 0.909 +- 0.179 (in-sample avg dev_std = 0.180)
SUFF++ for r=0.6 all L1 = 0.938 +- 0.128 (in-sample avg dev_std = 0.180)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.912
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.855
SUFF++ for r=0.9 class 0.0 = 0.723 +- 0.138 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 class 1.0 = 0.949 +- 0.138 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all KL = 0.937 +- 0.138 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.9 all L1 = 0.923 +- 0.139 (in-sample avg dev_std = 0.174)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.59
SUFF++ for r=0.3 class 0.0 = 0.807 +- 0.256 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 class 1.0 = 0.866 +- 0.256 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all KL = 0.778 +- 0.256 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.3 all L1 = 0.856 +- 0.168 (in-sample avg dev_std = 0.324)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.674
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.653
SUFF++ for r=0.6 class 0.0 = 0.84 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 class 1.0 = 0.915 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 all KL = 0.887 +- 0.178 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 all L1 = 0.903 +- 0.146 (in-sample avg dev_std = 0.201)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.721
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.677
SUFF++ for r=0.9 class 0.0 = 0.772 +- 0.149 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 class 1.0 = 0.879 +- 0.149 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 all KL = 0.911 +- 0.149 (in-sample avg dev_std = 0.209)
SUFF++ for r=0.9 all L1 = 0.861 +- 0.161 (in-sample avg dev_std = 0.209)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.809
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.742
NEC for r=0.3 class 0.0 = 0.317 +- 0.268 (in-sample avg dev_std = 0.240)
NEC for r=0.3 class 1.0 = 0.079 +- 0.268 (in-sample avg dev_std = 0.240)
NEC for r=0.3 all KL = 0.176 +- 0.268 (in-sample avg dev_std = 0.240)
NEC for r=0.3 all L1 = 0.107 +- 0.183 (in-sample avg dev_std = 0.240)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.88
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.815
NEC for r=0.6 class 0.0 = 0.275 +- 0.197 (in-sample avg dev_std = 0.187)
NEC for r=0.6 class 1.0 = 0.049 +- 0.197 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all KL = 0.116 +- 0.197 (in-sample avg dev_std = 0.187)
NEC for r=0.6 all L1 = 0.075 +- 0.140 (in-sample avg dev_std = 0.187)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.912
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.823
NEC for r=0.9 class 0.0 = 0.379 +- 0.171 (in-sample avg dev_std = 0.197)
NEC for r=0.9 class 1.0 = 0.073 +- 0.171 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all KL = 0.111 +- 0.171 (in-sample avg dev_std = 0.197)
NEC for r=0.9 all L1 = 0.108 +- 0.164 (in-sample avg dev_std = 0.197)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.831
NEC for r=1.0 class 0.0 = 0.398 +- 0.172 (in-sample avg dev_std = 0.225)
NEC for r=1.0 class 1.0 = 0.083 +- 0.172 (in-sample avg dev_std = 0.225)
NEC for r=1.0 all KL = 0.108 +- 0.172 (in-sample avg dev_std = 0.225)
NEC for r=1.0 all L1 = 0.119 +- 0.173 (in-sample avg dev_std = 0.225)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.629
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.61
NEC for r=0.3 class 0.0 = 0.246 +- 0.293 (in-sample avg dev_std = 0.309)
NEC for r=0.3 class 1.0 = 0.151 +- 0.293 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all KL = 0.245 +- 0.293 (in-sample avg dev_std = 0.309)
NEC for r=0.3 all L1 = 0.167 +- 0.205 (in-sample avg dev_std = 0.309)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.674
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.656
NEC for r=0.6 class 0.0 = 0.211 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=0.6 class 1.0 = 0.104 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=0.6 all KL = 0.152 +- 0.202 (in-sample avg dev_std = 0.228)
NEC for r=0.6 all L1 = 0.122 +- 0.167 (in-sample avg dev_std = 0.228)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.721
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.674
NEC for r=0.9 class 0.0 = 0.272 +- 0.160 (in-sample avg dev_std = 0.245)
NEC for r=0.9 class 1.0 = 0.151 +- 0.160 (in-sample avg dev_std = 0.245)
NEC for r=0.9 all KL = 0.131 +- 0.160 (in-sample avg dev_std = 0.245)
NEC for r=0.9 all L1 = 0.171 +- 0.174 (in-sample avg dev_std = 0.245)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.741
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.667
NEC for r=1.0 class 0.0 = 0.318 +- 0.174 (in-sample avg dev_std = 0.273)
NEC for r=1.0 class 1.0 = 0.179 +- 0.174 (in-sample avg dev_std = 0.273)
NEC for r=1.0 all KL = 0.145 +- 0.174 (in-sample avg dev_std = 0.273)
NEC for r=1.0 all L1 = 0.202 +- 0.193 (in-sample avg dev_std = 0.273)
model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:05:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:05:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:05:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:03 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:13 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ROC-AUC: 0.9611
Train Loss: 0.1567
ID Validation ROC-AUC: 0.9233
ID Validation Loss: 0.2180
ID Test ROC-AUC: 0.9240
ID Test Loss: 0.2206
OOD Validation ROC-AUC: 0.6334
OOD Validation Loss: 0.4667
OOD Test ROC-AUC: 0.6879
OOD Test Loss: 0.5492

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9251
Train Loss: 0.2093
ID Validation ROC-AUC: 0.9033
ID Validation Loss: 0.2367
ID Test ROC-AUC: 0.9102
ID Test Loss: 0.2300
OOD Validation ROC-AUC: 0.6806
OOD Validation Loss: 0.3241
OOD Test ROC-AUC: 0.7074
OOD Test Loss: 0.4616

[0m[1;37mINFO[0m: [1mChartInfo 0.9240 0.6879 0.9102 0.7074 0.9033 0.6806[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:06:45 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:06:49 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.811
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.73
SUFF++ for r=0.3 class 0.0 = 0.645 +- 0.288 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 class 1.0 = 0.838 +- 0.288 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all KL = 0.68 +- 0.288 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.3 all L1 = 0.816 +- 0.178 (in-sample avg dev_std = 0.390)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.875
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.796
SUFF++ for r=0.6 class 0.0 = 0.727 +- 0.213 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 class 1.0 = 0.914 +- 0.213 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all KL = 0.826 +- 0.213 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all L1 = 0.892 +- 0.140 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.87
SUFF++ for r=0.9 class 0.0 = 0.731 +- 0.157 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 class 1.0 = 0.921 +- 0.157 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all KL = 0.915 +- 0.157 (in-sample avg dev_std = 0.185)
SUFF++ for r=0.9 all L1 = 0.899 +- 0.147 (in-sample avg dev_std = 0.185)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.579
SUFF++ for r=0.3 class 0.0 = 0.725 +- 0.273 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 class 1.0 = 0.764 +- 0.273 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all KL = 0.65 +- 0.273 (in-sample avg dev_std = 0.426)
SUFF++ for r=0.3 all L1 = 0.757 +- 0.187 (in-sample avg dev_std = 0.426)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.657
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.605
SUFF++ for r=0.6 class 0.0 = 0.818 +- 0.200 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 1.0 = 0.863 +- 0.200 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all KL = 0.817 +- 0.200 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all L1 = 0.856 +- 0.151 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.701
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.648
SUFF++ for r=0.9 class 0.0 = 0.765 +- 0.139 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 class 1.0 = 0.863 +- 0.139 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all KL = 0.903 +- 0.139 (in-sample avg dev_std = 0.200)
SUFF++ for r=0.9 all L1 = 0.847 +- 0.155 (in-sample avg dev_std = 0.200)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.811
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.76
NEC for r=0.3 class 0.0 = 0.375 +- 0.272 (in-sample avg dev_std = 0.281)
NEC for r=0.3 class 1.0 = 0.116 +- 0.272 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all KL = 0.203 +- 0.272 (in-sample avg dev_std = 0.281)
NEC for r=0.3 all L1 = 0.146 +- 0.207 (in-sample avg dev_std = 0.281)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.875
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.814
NEC for r=0.6 class 0.0 = 0.312 +- 0.207 (in-sample avg dev_std = 0.221)
NEC for r=0.6 class 1.0 = 0.078 +- 0.207 (in-sample avg dev_std = 0.221)
NEC for r=0.6 all KL = 0.145 +- 0.207 (in-sample avg dev_std = 0.221)
NEC for r=0.6 all L1 = 0.105 +- 0.158 (in-sample avg dev_std = 0.221)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.845
NEC for r=0.9 class 0.0 = 0.357 +- 0.151 (in-sample avg dev_std = 0.208)
NEC for r=0.9 class 1.0 = 0.094 +- 0.151 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all KL = 0.115 +- 0.151 (in-sample avg dev_std = 0.208)
NEC for r=0.9 all L1 = 0.125 +- 0.156 (in-sample avg dev_std = 0.208)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.933
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.841
NEC for r=1.0 class 0.0 = 0.358 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=1.0 class 1.0 = 0.104 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all KL = 0.108 +- 0.144 (in-sample avg dev_std = 0.228)
NEC for r=1.0 all L1 = 0.133 +- 0.156 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.622
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.604
NEC for r=0.3 class 0.0 = 0.279 +- 0.288 (in-sample avg dev_std = 0.318)
NEC for r=0.3 class 1.0 = 0.201 +- 0.288 (in-sample avg dev_std = 0.318)
NEC for r=0.3 all KL = 0.266 +- 0.288 (in-sample avg dev_std = 0.318)
NEC for r=0.3 all L1 = 0.214 +- 0.228 (in-sample avg dev_std = 0.318)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.657
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.649
NEC for r=0.6 class 0.0 = 0.234 +- 0.205 (in-sample avg dev_std = 0.266)
NEC for r=0.6 class 1.0 = 0.137 +- 0.205 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all KL = 0.181 +- 0.205 (in-sample avg dev_std = 0.266)
NEC for r=0.6 all L1 = 0.153 +- 0.170 (in-sample avg dev_std = 0.266)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.701
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.654
NEC for r=0.9 class 0.0 = 0.298 +- 0.164 (in-sample avg dev_std = 0.256)
NEC for r=0.9 class 1.0 = 0.176 +- 0.164 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all KL = 0.144 +- 0.164 (in-sample avg dev_std = 0.256)
NEC for r=0.9 all L1 = 0.196 +- 0.172 (in-sample avg dev_std = 0.256)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.719
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.663
NEC for r=1.0 class 0.0 = 0.306 +- 0.153 (in-sample avg dev_std = 0.267)
NEC for r=1.0 class 1.0 = 0.193 +- 0.153 (in-sample avg dev_std = 0.267)
NEC for r=1.0 all KL = 0.136 +- 0.153 (in-sample avg dev_std = 0.267)
NEC for r=1.0 all L1 = 0.212 +- 0.173 (in-sample avg dev_std = 0.267)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.75, 0.868, 0.941, 1.0], 'all_L1': [0.871, 0.921, 0.919, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.726, 0.835, 0.913, 1.0], 'all_L1': [0.849, 0.913, 0.903, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.785, 0.874, 0.93, 1.0], 'all_L1': [0.902, 0.931, 0.918, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.825, 0.909, 0.937, 1.0], 'all_L1': [0.905, 0.938, 0.923, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.826, 0.915, 1.0], 'all_L1': [0.816, 0.892, 0.899, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.236, 0.144, 0.113, 0.108], 'all_L1': [0.142, 0.089, 0.12, 0.127]}), defaultdict(<class 'list'>, {'all_KL': [0.224, 0.141, 0.123, 0.131], 'all_L1': [0.144, 0.084, 0.12, 0.137]}), defaultdict(<class 'list'>, {'all_KL': [0.17, 0.13, 0.108, 0.103], 'all_L1': [0.092, 0.076, 0.107, 0.121]}), defaultdict(<class 'list'>, {'all_KL': [0.176, 0.116, 0.111, 0.108], 'all_L1': [0.107, 0.075, 0.108, 0.119]}), defaultdict(<class 'list'>, {'all_KL': [0.203, 0.145, 0.115, 0.108], 'all_L1': [0.146, 0.105, 0.125, 0.133]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.711, 0.834, 0.918, 1.0], 'all_L1': [0.81, 0.881, 0.861, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.688, 0.814, 0.882, 1.0], 'all_L1': [0.785, 0.875, 0.839, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.733, 0.837, 0.909, 1.0], 'all_L1': [0.849, 0.893, 0.86, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.778, 0.887, 0.911, 1.0], 'all_L1': [0.856, 0.903, 0.861, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.65, 0.817, 0.903, 1.0], 'all_L1': [0.757, 0.856, 0.847, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.287, 0.193, 0.152, 0.155], 'all_L1': [0.2, 0.137, 0.195, 0.217]}), defaultdict(<class 'list'>, {'all_KL': [0.298, 0.18, 0.162, 0.152], 'all_L1': [0.219, 0.132, 0.194, 0.218]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.185, 0.146, 0.148], 'all_L1': [0.155, 0.121, 0.183, 0.215]}), defaultdict(<class 'list'>, {'all_KL': [0.245, 0.152, 0.131, 0.145], 'all_L1': [0.167, 0.122, 0.171, 0.202]}), defaultdict(<class 'list'>, {'all_KL': [0.266, 0.181, 0.144, 0.136], 'all_L1': [0.214, 0.153, 0.196, 0.212]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.869 +- 0.033, 0.919 +- 0.016, 0.912 +- 0.010, 1.000 +- 0.000
suff++ class all_KL  =  0.753 +- 0.050, 0.862 +- 0.030, 0.927 +- 0.011, 1.000 +- 0.000
suff++_acc_int  =  0.731 +- 0.010, 0.794 +- 0.012, 0.860 +- 0.006
nec class all_L1  =  0.126 +- 0.022, 0.086 +- 0.011, 0.116 +- 0.007, 0.127 +- 0.007
nec class all_KL  =  0.202 +- 0.026, 0.135 +- 0.011, 0.114 +- 0.005, 0.112 +- 0.010
nec_acc_int  =  0.740 +- 0.011, 0.811 +- 0.009, 0.834 +- 0.011, 0.832 +- 0.007

Eval split test
suff++ class all_L1  =  0.811 +- 0.038, 0.882 +- 0.016, 0.854 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.712 +- 0.043, 0.838 +- 0.026, 0.905 +- 0.012, 1.000 +- 0.000
suff++_acc_int  =  0.593 +- 0.012, 0.637 +- 0.019, 0.675 +- 0.015
nec class all_L1  =  0.191 +- 0.026, 0.133 +- 0.012, 0.188 +- 0.010, 0.213 +- 0.006
nec class all_KL  =  0.272 +- 0.019, 0.178 +- 0.014, 0.147 +- 0.010, 0.147 +- 0.007
nec_acc_int  =  0.597 +- 0.011, 0.646 +- 0.008, 0.665 +- 0.008, 0.667 +- 0.003


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.497 +- 0.009, 0.502 +- 0.003, 0.514 +- 0.003, 0.564 +- 0.003
Faith. Armon (L1)= 		  =  0.219 +- 0.034, 0.157 +- 0.018, 0.206 +- 0.011, 0.226 +- 0.011
Faith. GMean (L1)= 	  =  0.329 +- 0.025, 0.280 +- 0.015, 0.325 +- 0.009, 0.357 +- 0.010
Faith. Aritm (KL)= 		  =  0.478 +- 0.020, 0.499 +- 0.010, 0.521 +- 0.004, 0.556 +- 0.005
Faith. Armon (KL)= 		  =  0.317 +- 0.030, 0.233 +- 0.016, 0.203 +- 0.008, 0.201 +- 0.016
Faith. GMean (KL)= 	  =  0.388 +- 0.021, 0.341 +- 0.010, 0.325 +- 0.006, 0.334 +- 0.014

Eval split test
Faith. Aritm (L1)= 		  =  0.501 +- 0.009, 0.507 +- 0.003, 0.521 +- 0.004, 0.606 +- 0.003
Faith. Armon (L1)= 		  =  0.308 +- 0.031, 0.231 +- 0.017, 0.308 +- 0.013, 0.351 +- 0.008
Faith. GMean (L1)= 	  =  0.392 +- 0.019, 0.342 +- 0.012, 0.400 +- 0.009, 0.461 +- 0.006
Faith. Aritm (KL)= 		  =  0.492 +- 0.018, 0.508 +- 0.009, 0.526 +- 0.005, 0.574 +- 0.003
Faith. Armon (KL)= 		  =  0.392 +- 0.017, 0.293 +- 0.018, 0.253 +- 0.015, 0.257 +- 0.010
Faith. GMean (KL)= 	  =  0.439 +- 0.013, 0.386 +- 0.011, 0.364 +- 0.011, 0.384 +- 0.009
Computed for split load_split = id



Completed in  0:24:51.707775  for LECIGIN LBAPcore/assay



DONE LECI LBAPcore/assay LA
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:10:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:10:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:05 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:41 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:11:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ROC-AUC: 0.9727
Train Loss: 0.1378
ID Validation ROC-AUC: 0.9248
ID Validation Loss: 0.2674
ID Test ROC-AUC: 0.9280
ID Test Loss: 0.2650
OOD Validation ROC-AUC: 0.6550
OOD Validation Loss: 0.4948
OOD Test ROC-AUC: 0.7073
OOD Test Loss: 0.6679

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 56...
[0m[1;37mINFO[0m: [1mCheckpoint 56: 
-----------------------------------
Train ROC-AUC: 0.9313
Train Loss: 0.2369
ID Validation ROC-AUC: 0.9115
ID Validation Loss: 0.2655
ID Test ROC-AUC: 0.9145
ID Test Loss: 0.2678
OOD Validation ROC-AUC: 0.7016
OOD Validation Loss: 0.3203
OOD Test ROC-AUC: 0.7225
OOD Test Loss: 0.5195

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.7073 0.9145 0.7225 0.9115 0.7016[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:12:02 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:12:07 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.756
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.71
SUFF++ for r=0.3 class 0.0 = 0.653 +- 0.193 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.3 class 1.0 = 0.762 +- 0.193 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.3 all KL = 0.798 +- 0.193 (in-sample avg dev_std = 0.380)
SUFF++ for r=0.3 all L1 = 0.749 +- 0.184 (in-sample avg dev_std = 0.380)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.852
SUFF++ for r=0.6 class 0.0 = 0.667 +- 0.140 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 class 1.0 = 0.924 +- 0.140 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all KL = 0.922 +- 0.140 (in-sample avg dev_std = 0.214)
SUFF++ for r=0.6 all L1 = 0.894 +- 0.166 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.905
SUFF++ for r=0.9 class 0.0 = 0.746 +- 0.096 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 class 1.0 = 0.965 +- 0.096 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all KL = 0.964 +- 0.096 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all L1 = 0.939 +- 0.131 (in-sample avg dev_std = 0.140)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.612
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.595
SUFF++ for r=0.3 class 0.0 = 0.675 +- 0.186 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 class 1.0 = 0.715 +- 0.186 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all KL = 0.77 +- 0.186 (in-sample avg dev_std = 0.411)
SUFF++ for r=0.3 all L1 = 0.709 +- 0.170 (in-sample avg dev_std = 0.411)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.679
SUFF++ for r=0.6 class 0.0 = 0.744 +- 0.152 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 class 1.0 = 0.863 +- 0.152 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all KL = 0.891 +- 0.152 (in-sample avg dev_std = 0.253)
SUFF++ for r=0.6 all L1 = 0.843 +- 0.183 (in-sample avg dev_std = 0.253)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.728
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.694
SUFF++ for r=0.9 class 0.0 = 0.797 +- 0.122 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 class 1.0 = 0.911 +- 0.122 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 all KL = 0.937 +- 0.122 (in-sample avg dev_std = 0.173)
SUFF++ for r=0.9 all L1 = 0.892 +- 0.163 (in-sample avg dev_std = 0.173)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.756
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.717
NEC for r=0.3 class 0.0 = 0.372 +- 0.252 (in-sample avg dev_std = 0.384)
NEC for r=0.3 class 1.0 = 0.319 +- 0.252 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all KL = 0.298 +- 0.252 (in-sample avg dev_std = 0.384)
NEC for r=0.3 all L1 = 0.325 +- 0.212 (in-sample avg dev_std = 0.384)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.856
NEC for r=0.6 class 0.0 = 0.351 +- 0.171 (in-sample avg dev_std = 0.209)
NEC for r=0.6 class 1.0 = 0.091 +- 0.171 (in-sample avg dev_std = 0.209)
NEC for r=0.6 all KL = 0.103 +- 0.171 (in-sample avg dev_std = 0.209)
NEC for r=0.6 all L1 = 0.121 +- 0.179 (in-sample avg dev_std = 0.209)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.928
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.886
NEC for r=0.9 class 0.0 = 0.288 +- 0.126 (in-sample avg dev_std = 0.165)
NEC for r=0.9 class 1.0 = 0.048 +- 0.126 (in-sample avg dev_std = 0.165)
NEC for r=0.9 all KL = 0.053 +- 0.126 (in-sample avg dev_std = 0.165)
NEC for r=0.9 all L1 = 0.076 +- 0.151 (in-sample avg dev_std = 0.165)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.93
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.887
NEC for r=1.0 class 0.0 = 0.294 +- 0.124 (in-sample avg dev_std = 0.180)
NEC for r=1.0 class 1.0 = 0.045 +- 0.124 (in-sample avg dev_std = 0.180)
NEC for r=1.0 all KL = 0.051 +- 0.124 (in-sample avg dev_std = 0.180)
NEC for r=1.0 all L1 = 0.074 +- 0.148 (in-sample avg dev_std = 0.180)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.612
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.612
NEC for r=0.3 class 0.0 = 0.389 +- 0.255 (in-sample avg dev_std = 0.410)
NEC for r=0.3 class 1.0 = 0.37 +- 0.255 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all KL = 0.32 +- 0.255 (in-sample avg dev_std = 0.410)
NEC for r=0.3 all L1 = 0.373 +- 0.199 (in-sample avg dev_std = 0.410)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.685
NEC for r=0.6 class 0.0 = 0.271 +- 0.188 (in-sample avg dev_std = 0.264)
NEC for r=0.6 class 1.0 = 0.173 +- 0.188 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all KL = 0.153 +- 0.188 (in-sample avg dev_std = 0.264)
NEC for r=0.6 all L1 = 0.189 +- 0.197 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.728
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.712
NEC for r=0.9 class 0.0 = 0.232 +- 0.135 (in-sample avg dev_std = 0.195)
NEC for r=0.9 class 1.0 = 0.104 +- 0.135 (in-sample avg dev_std = 0.195)
NEC for r=0.9 all KL = 0.083 +- 0.135 (in-sample avg dev_std = 0.195)
NEC for r=0.9 all L1 = 0.126 +- 0.169 (in-sample avg dev_std = 0.195)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.739
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.728
NEC for r=1.0 class 0.0 = 0.225 +- 0.133 (in-sample avg dev_std = 0.195)
NEC for r=1.0 class 1.0 = 0.107 +- 0.133 (in-sample avg dev_std = 0.195)
NEC for r=1.0 all KL = 0.078 +- 0.133 (in-sample avg dev_std = 0.195)
NEC for r=1.0 all L1 = 0.126 +- 0.170 (in-sample avg dev_std = 0.195)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:15:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:15:25 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:15:56 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:06 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:16 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:32 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:16:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9651
Train Loss: 0.1565
ID Validation ROC-AUC: 0.9232
ID Validation Loss: 0.2486
ID Test ROC-AUC: 0.9247
ID Test Loss: 0.2522
OOD Validation ROC-AUC: 0.6738
OOD Validation Loss: 0.4349
OOD Test ROC-AUC: 0.7050
OOD Test Loss: 0.6209

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9095
Train Loss: 0.2555
ID Validation ROC-AUC: 0.8966
ID Validation Loss: 0.2709
ID Test ROC-AUC: 0.8993
ID Test Loss: 0.2732
OOD Validation ROC-AUC: 0.6989
OOD Validation Loss: 0.3054
OOD Test ROC-AUC: 0.7302
OOD Test Loss: 0.4911

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.7050 0.8993 0.7302 0.8966 0.6989[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:16:50 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:16:54 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.756
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.673
SUFF++ for r=0.3 class 0.0 = 0.694 +- 0.148 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 class 1.0 = 0.745 +- 0.148 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 all KL = 0.824 +- 0.148 (in-sample avg dev_std = 0.327)
SUFF++ for r=0.3 all L1 = 0.739 +- 0.133 (in-sample avg dev_std = 0.327)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.883
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.813
SUFF++ for r=0.6 class 0.0 = 0.689 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 class 1.0 = 0.891 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 all KL = 0.901 +- 0.137 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.6 all L1 = 0.867 +- 0.161 (in-sample avg dev_std = 0.217)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.894
SUFF++ for r=0.9 class 0.0 = 0.8 +- 0.091 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 class 1.0 = 0.96 +- 0.091 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all KL = 0.966 +- 0.091 (in-sample avg dev_std = 0.121)
SUFF++ for r=0.9 all L1 = 0.942 +- 0.112 (in-sample avg dev_std = 0.121)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.571
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.558
SUFF++ for r=0.3 class 0.0 = 0.717 +- 0.130 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.3 class 1.0 = 0.717 +- 0.130 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.3 all KL = 0.829 +- 0.130 (in-sample avg dev_std = 0.341)
SUFF++ for r=0.3 all L1 = 0.717 +- 0.125 (in-sample avg dev_std = 0.341)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.687
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.665
SUFF++ for r=0.6 class 0.0 = 0.731 +- 0.137 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 class 1.0 = 0.811 +- 0.137 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all KL = 0.868 +- 0.137 (in-sample avg dev_std = 0.264)
SUFF++ for r=0.6 all L1 = 0.798 +- 0.169 (in-sample avg dev_std = 0.264)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.71
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.687
SUFF++ for r=0.9 class 0.0 = 0.853 +- 0.102 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.9 class 1.0 = 0.915 +- 0.102 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.9 all KL = 0.947 +- 0.102 (in-sample avg dev_std = 0.147)
SUFF++ for r=0.9 all L1 = 0.904 +- 0.130 (in-sample avg dev_std = 0.147)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.756
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.661
NEC for r=0.3 class 0.0 = 0.313 +- 0.208 (in-sample avg dev_std = 0.328)
NEC for r=0.3 class 1.0 = 0.321 +- 0.208 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all KL = 0.241 +- 0.208 (in-sample avg dev_std = 0.328)
NEC for r=0.3 all L1 = 0.32 +- 0.151 (in-sample avg dev_std = 0.328)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.883
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.821
NEC for r=0.6 class 0.0 = 0.277 +- 0.179 (in-sample avg dev_std = 0.226)
NEC for r=0.6 class 1.0 = 0.136 +- 0.179 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all KL = 0.132 +- 0.179 (in-sample avg dev_std = 0.226)
NEC for r=0.6 all L1 = 0.152 +- 0.166 (in-sample avg dev_std = 0.226)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.88
NEC for r=0.9 class 0.0 = 0.23 +- 0.106 (in-sample avg dev_std = 0.145)
NEC for r=0.9 class 1.0 = 0.053 +- 0.106 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all KL = 0.054 +- 0.106 (in-sample avg dev_std = 0.145)
NEC for r=0.9 all L1 = 0.074 +- 0.124 (in-sample avg dev_std = 0.145)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.919
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.888
NEC for r=1.0 class 0.0 = 0.237 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=1.0 class 1.0 = 0.05 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=1.0 all KL = 0.045 +- 0.102 (in-sample avg dev_std = 0.145)
NEC for r=1.0 all L1 = 0.072 +- 0.128 (in-sample avg dev_std = 0.145)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.571
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.585
NEC for r=0.3 class 0.0 = 0.343 +- 0.191 (in-sample avg dev_std = 0.316)
NEC for r=0.3 class 1.0 = 0.336 +- 0.191 (in-sample avg dev_std = 0.316)
NEC for r=0.3 all KL = 0.219 +- 0.191 (in-sample avg dev_std = 0.316)
NEC for r=0.3 all L1 = 0.337 +- 0.149 (in-sample avg dev_std = 0.316)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.687
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.665
NEC for r=0.6 class 0.0 = 0.26 +- 0.161 (in-sample avg dev_std = 0.262)
NEC for r=0.6 class 1.0 = 0.207 +- 0.161 (in-sample avg dev_std = 0.262)
NEC for r=0.6 all KL = 0.149 +- 0.161 (in-sample avg dev_std = 0.262)
NEC for r=0.6 all L1 = 0.216 +- 0.164 (in-sample avg dev_std = 0.262)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.71
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.696
NEC for r=0.9 class 0.0 = 0.186 +- 0.124 (in-sample avg dev_std = 0.194)
NEC for r=0.9 class 1.0 = 0.115 +- 0.124 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all KL = 0.086 +- 0.124 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all L1 = 0.127 +- 0.147 (in-sample avg dev_std = 0.194)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.723
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.707
NEC for r=1.0 class 0.0 = 0.195 +- 0.106 (in-sample avg dev_std = 0.179)
NEC for r=1.0 class 1.0 = 0.102 +- 0.106 (in-sample avg dev_std = 0.179)
NEC for r=1.0 all KL = 0.068 +- 0.106 (in-sample avg dev_std = 0.179)
NEC for r=1.0 all L1 = 0.117 +- 0.143 (in-sample avg dev_std = 0.179)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:20:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:20:18 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:20:49 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:20:59 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:10 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:26 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:21:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9599
Train Loss: 0.1725
ID Validation ROC-AUC: 0.9219
ID Validation Loss: 0.2486
ID Test ROC-AUC: 0.9238
ID Test Loss: 0.2502
OOD Validation ROC-AUC: 0.6637
OOD Validation Loss: 0.3933
OOD Test ROC-AUC: 0.7126
OOD Test Loss: 0.5743

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9060
Train Loss: 0.2554
ID Validation ROC-AUC: 0.8940
ID Validation Loss: 0.2686
ID Test ROC-AUC: 0.8978
ID Test Loss: 0.2703
OOD Validation ROC-AUC: 0.6978
OOD Validation Loss: 0.2989
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.4799

[0m[1;37mINFO[0m: [1mChartInfo 0.9238 0.7126 0.8978 0.7280 0.8940 0.6978[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:21:43 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:21:47 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.722
SUFF++ for r=0.3 class 0.0 = 0.714 +- 0.119 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.3 class 1.0 = 0.803 +- 0.119 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.3 all KL = 0.881 +- 0.119 (in-sample avg dev_std = 0.274)
SUFF++ for r=0.3 all L1 = 0.793 +- 0.146 (in-sample avg dev_std = 0.274)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.856
SUFF++ for r=0.6 class 0.0 = 0.728 +- 0.093 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.6 class 1.0 = 0.929 +- 0.093 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.6 all KL = 0.944 +- 0.093 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.6 all L1 = 0.906 +- 0.135 (in-sample avg dev_std = 0.160)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.903
SUFF++ for r=0.9 class 0.0 = 0.793 +- 0.061 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 class 1.0 = 0.968 +- 0.061 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 all KL = 0.976 +- 0.061 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.9 all L1 = 0.948 +- 0.104 (in-sample avg dev_std = 0.099)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.648
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.607
SUFF++ for r=0.3 class 0.0 = 0.73 +- 0.110 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.3 class 1.0 = 0.762 +- 0.110 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.3 all KL = 0.87 +- 0.110 (in-sample avg dev_std = 0.295)
SUFF++ for r=0.3 all L1 = 0.757 +- 0.138 (in-sample avg dev_std = 0.295)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.703
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.687
SUFF++ for r=0.6 class 0.0 = 0.767 +- 0.090 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 class 1.0 = 0.867 +- 0.090 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 all KL = 0.924 +- 0.090 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.6 all L1 = 0.85 +- 0.150 (in-sample avg dev_std = 0.201)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.737
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.716
SUFF++ for r=0.9 class 0.0 = 0.84 +- 0.076 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.9 class 1.0 = 0.923 +- 0.076 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.9 all KL = 0.96 +- 0.076 (in-sample avg dev_std = 0.133)
SUFF++ for r=0.9 all L1 = 0.909 +- 0.121 (in-sample avg dev_std = 0.133)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.772
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.741
NEC for r=0.3 class 0.0 = 0.348 +- 0.185 (in-sample avg dev_std = 0.288)
NEC for r=0.3 class 1.0 = 0.275 +- 0.185 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all KL = 0.199 +- 0.185 (in-sample avg dev_std = 0.288)
NEC for r=0.3 all L1 = 0.283 +- 0.176 (in-sample avg dev_std = 0.288)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.898
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.851
NEC for r=0.6 class 0.0 = 0.281 +- 0.118 (in-sample avg dev_std = 0.159)
NEC for r=0.6 class 1.0 = 0.085 +- 0.118 (in-sample avg dev_std = 0.159)
NEC for r=0.6 all KL = 0.073 +- 0.118 (in-sample avg dev_std = 0.159)
NEC for r=0.6 all L1 = 0.108 +- 0.142 (in-sample avg dev_std = 0.159)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.892
NEC for r=0.9 class 0.0 = 0.224 +- 0.081 (in-sample avg dev_std = 0.120)
NEC for r=0.9 class 1.0 = 0.043 +- 0.081 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all KL = 0.037 +- 0.081 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all L1 = 0.064 +- 0.115 (in-sample avg dev_std = 0.120)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.926
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.894
NEC for r=1.0 class 0.0 = 0.229 +- 0.079 (in-sample avg dev_std = 0.124)
NEC for r=1.0 class 1.0 = 0.037 +- 0.079 (in-sample avg dev_std = 0.124)
NEC for r=1.0 all KL = 0.032 +- 0.079 (in-sample avg dev_std = 0.124)
NEC for r=1.0 all L1 = 0.06 +- 0.113 (in-sample avg dev_std = 0.124)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.648
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.609
NEC for r=0.3 class 0.0 = 0.326 +- 0.169 (in-sample avg dev_std = 0.296)
NEC for r=0.3 class 1.0 = 0.31 +- 0.169 (in-sample avg dev_std = 0.296)
NEC for r=0.3 all KL = 0.195 +- 0.169 (in-sample avg dev_std = 0.296)
NEC for r=0.3 all L1 = 0.313 +- 0.167 (in-sample avg dev_std = 0.296)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.703
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.695
NEC for r=0.6 class 0.0 = 0.266 +- 0.123 (in-sample avg dev_std = 0.213)
NEC for r=0.6 class 1.0 = 0.158 +- 0.123 (in-sample avg dev_std = 0.213)
NEC for r=0.6 all KL = 0.104 +- 0.123 (in-sample avg dev_std = 0.213)
NEC for r=0.6 all L1 = 0.176 +- 0.165 (in-sample avg dev_std = 0.213)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.737
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.711
NEC for r=0.9 class 0.0 = 0.183 +- 0.083 (in-sample avg dev_std = 0.151)
NEC for r=0.9 class 1.0 = 0.096 +- 0.083 (in-sample avg dev_std = 0.151)
NEC for r=0.9 all KL = 0.056 +- 0.083 (in-sample avg dev_std = 0.151)
NEC for r=0.9 all L1 = 0.11 +- 0.129 (in-sample avg dev_std = 0.151)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.747
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.717
NEC for r=1.0 class 0.0 = 0.181 +- 0.078 (in-sample avg dev_std = 0.142)
NEC for r=1.0 class 1.0 = 0.087 +- 0.078 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all KL = 0.047 +- 0.078 (in-sample avg dev_std = 0.142)
NEC for r=1.0 all L1 = 0.103 +- 0.130 (in-sample avg dev_std = 0.142)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:25:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:25:11 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:25:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:25:51 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:02 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:18 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:33 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:26:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ROC-AUC: 0.9683
Train Loss: 0.1544
ID Validation ROC-AUC: 0.9248
ID Validation Loss: 0.2444
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2478
OOD Validation ROC-AUC: 0.6793
OOD Validation Loss: 0.3957
OOD Test ROC-AUC: 0.7158
OOD Test Loss: 0.5602

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ROC-AUC: 0.9510
Train Loss: 0.1952
ID Validation ROC-AUC: 0.9178
ID Validation Loss: 0.2653
ID Test ROC-AUC: 0.9200
ID Test Loss: 0.2655
OOD Validation ROC-AUC: 0.6963
OOD Validation Loss: 0.3695
OOD Test ROC-AUC: 0.7235
OOD Test Loss: 0.5689

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7158 0.9200 0.7235 0.9178 0.6963[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:26:35 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:26:39 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.781
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.725
SUFF++ for r=0.3 class 0.0 = 0.726 +- 0.115 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.3 class 1.0 = 0.804 +- 0.115 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.3 all KL = 0.883 +- 0.115 (in-sample avg dev_std = 0.269)
SUFF++ for r=0.3 all L1 = 0.795 +- 0.141 (in-sample avg dev_std = 0.269)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.858
SUFF++ for r=0.6 class 0.0 = 0.705 +- 0.107 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 class 1.0 = 0.927 +- 0.107 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 all KL = 0.936 +- 0.107 (in-sample avg dev_std = 0.174)
SUFF++ for r=0.6 all L1 = 0.901 +- 0.143 (in-sample avg dev_std = 0.174)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.903
SUFF++ for r=0.9 class 0.0 = 0.826 +- 0.070 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 class 1.0 = 0.969 +- 0.070 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all KL = 0.977 +- 0.070 (in-sample avg dev_std = 0.102)
SUFF++ for r=0.9 all L1 = 0.952 +- 0.100 (in-sample avg dev_std = 0.102)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.62
SUFF++ for r=0.3 class 0.0 = 0.748 +- 0.107 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 class 1.0 = 0.764 +- 0.107 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 all KL = 0.878 +- 0.107 (in-sample avg dev_std = 0.282)
SUFF++ for r=0.3 all L1 = 0.761 +- 0.135 (in-sample avg dev_std = 0.282)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.737
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.705
SUFF++ for r=0.6 class 0.0 = 0.753 +- 0.114 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.6 class 1.0 = 0.856 +- 0.114 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.6 all KL = 0.907 +- 0.114 (in-sample avg dev_std = 0.221)
SUFF++ for r=0.6 all L1 = 0.839 +- 0.162 (in-sample avg dev_std = 0.221)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.743
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.728
SUFF++ for r=0.9 class 0.0 = 0.846 +- 0.082 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 class 1.0 = 0.924 +- 0.082 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 all KL = 0.959 +- 0.082 (in-sample avg dev_std = 0.141)
SUFF++ for r=0.9 all L1 = 0.911 +- 0.124 (in-sample avg dev_std = 0.141)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.781
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.747
NEC for r=0.3 class 0.0 = 0.331 +- 0.172 (in-sample avg dev_std = 0.260)
NEC for r=0.3 class 1.0 = 0.261 +- 0.172 (in-sample avg dev_std = 0.260)
NEC for r=0.3 all KL = 0.18 +- 0.172 (in-sample avg dev_std = 0.260)
NEC for r=0.3 all L1 = 0.269 +- 0.171 (in-sample avg dev_std = 0.260)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.911
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.865
NEC for r=0.6 class 0.0 = 0.293 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.6 class 1.0 = 0.085 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all KL = 0.08 +- 0.127 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all L1 = 0.109 +- 0.146 (in-sample avg dev_std = 0.171)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.923
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.894
NEC for r=0.9 class 0.0 = 0.256 +- 0.106 (in-sample avg dev_std = 0.140)
NEC for r=0.9 class 1.0 = 0.043 +- 0.106 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all KL = 0.044 +- 0.106 (in-sample avg dev_std = 0.140)
NEC for r=0.9 all L1 = 0.068 +- 0.126 (in-sample avg dev_std = 0.140)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.888
NEC for r=1.0 class 0.0 = 0.245 +- 0.097 (in-sample avg dev_std = 0.143)
NEC for r=1.0 class 1.0 = 0.043 +- 0.097 (in-sample avg dev_std = 0.143)
NEC for r=1.0 all KL = 0.04 +- 0.097 (in-sample avg dev_std = 0.143)
NEC for r=1.0 all L1 = 0.067 +- 0.126 (in-sample avg dev_std = 0.143)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.628
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.64
NEC for r=0.3 class 0.0 = 0.324 +- 0.165 (in-sample avg dev_std = 0.273)
NEC for r=0.3 class 1.0 = 0.299 +- 0.165 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all KL = 0.181 +- 0.165 (in-sample avg dev_std = 0.273)
NEC for r=0.3 all L1 = 0.304 +- 0.164 (in-sample avg dev_std = 0.273)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.737
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.706
NEC for r=0.6 class 0.0 = 0.265 +- 0.151 (in-sample avg dev_std = 0.236)
NEC for r=0.6 class 1.0 = 0.179 +- 0.151 (in-sample avg dev_std = 0.236)
NEC for r=0.6 all KL = 0.131 +- 0.151 (in-sample avg dev_std = 0.236)
NEC for r=0.6 all L1 = 0.193 +- 0.171 (in-sample avg dev_std = 0.236)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.743
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.731
NEC for r=0.9 class 0.0 = 0.19 +- 0.100 (in-sample avg dev_std = 0.167)
NEC for r=0.9 class 1.0 = 0.098 +- 0.100 (in-sample avg dev_std = 0.167)
NEC for r=0.9 all KL = 0.065 +- 0.100 (in-sample avg dev_std = 0.167)
NEC for r=0.9 all L1 = 0.114 +- 0.140 (in-sample avg dev_std = 0.167)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.753
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.723
NEC for r=1.0 class 0.0 = 0.212 +- 0.104 (in-sample avg dev_std = 0.174)
NEC for r=1.0 class 1.0 = 0.099 +- 0.104 (in-sample avg dev_std = 0.174)
NEC for r=1.0 all KL = 0.064 +- 0.104 (in-sample avg dev_std = 0.174)
NEC for r=1.0 all L1 = 0.118 +- 0.145 (in-sample avg dev_std = 0.174)
model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:30:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:30:05 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:30:35 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:30:45 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:30:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:12 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:31:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:31:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9712
Train Loss: 0.1682
ID Validation ROC-AUC: 0.9235
ID Validation Loss: 0.3171
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.3191
OOD Validation ROC-AUC: 0.6651
OOD Validation Loss: 0.5310
OOD Test ROC-AUC: 0.7146
OOD Test Loss: 0.7641

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.9105
Train Loss: 0.2495
ID Validation ROC-AUC: 0.8984
ID Validation Loss: 0.2622
ID Test ROC-AUC: 0.9001
ID Test Loss: 0.2660
OOD Validation ROC-AUC: 0.7015
OOD Validation Loss: 0.2936
OOD Test ROC-AUC: 0.7252
OOD Test Loss: 0.4753

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7146 0.9001 0.7252 0.8984 0.7015[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:31:30 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:31:34 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.733
SUFF++ for r=0.3 class 0.0 = 0.66 +- 0.165 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.3 class 1.0 = 0.766 +- 0.165 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.3 all KL = 0.812 +- 0.165 (in-sample avg dev_std = 0.353)
SUFF++ for r=0.3 all L1 = 0.754 +- 0.170 (in-sample avg dev_std = 0.353)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.859
SUFF++ for r=0.6 class 0.0 = 0.696 +- 0.140 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.6 class 1.0 = 0.935 +- 0.140 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.6 all KL = 0.927 +- 0.140 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.6 all L1 = 0.908 +- 0.157 (in-sample avg dev_std = 0.203)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.9
SUFF++ for r=0.9 class 0.0 = 0.8 +- 0.085 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 class 1.0 = 0.973 +- 0.085 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all KL = 0.973 +- 0.085 (in-sample avg dev_std = 0.123)
SUFF++ for r=0.9 all L1 = 0.953 +- 0.113 (in-sample avg dev_std = 0.123)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.627
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.604
SUFF++ for r=0.3 class 0.0 = 0.675 +- 0.191 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 class 1.0 = 0.723 +- 0.191 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 all KL = 0.778 +- 0.191 (in-sample avg dev_std = 0.392)
SUFF++ for r=0.3 all L1 = 0.715 +- 0.169 (in-sample avg dev_std = 0.392)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.689
SUFF++ for r=0.6 class 0.0 = 0.769 +- 0.154 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 class 1.0 = 0.882 +- 0.154 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all KL = 0.897 +- 0.154 (in-sample avg dev_std = 0.246)
SUFF++ for r=0.6 all L1 = 0.863 +- 0.174 (in-sample avg dev_std = 0.246)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.74
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.723
SUFF++ for r=0.9 class 0.0 = 0.858 +- 0.115 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 class 1.0 = 0.938 +- 0.115 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 all KL = 0.956 +- 0.115 (in-sample avg dev_std = 0.146)
SUFF++ for r=0.9 all L1 = 0.925 +- 0.139 (in-sample avg dev_std = 0.146)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.795
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.693
NEC for r=0.3 class 0.0 = 0.41 +- 0.240 (in-sample avg dev_std = 0.394)
NEC for r=0.3 class 1.0 = 0.335 +- 0.240 (in-sample avg dev_std = 0.394)
NEC for r=0.3 all KL = 0.313 +- 0.240 (in-sample avg dev_std = 0.394)
NEC for r=0.3 all L1 = 0.344 +- 0.194 (in-sample avg dev_std = 0.394)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.856
NEC for r=0.6 class 0.0 = 0.319 +- 0.187 (in-sample avg dev_std = 0.214)
NEC for r=0.6 class 1.0 = 0.088 +- 0.187 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all KL = 0.113 +- 0.187 (in-sample avg dev_std = 0.214)
NEC for r=0.6 all L1 = 0.115 +- 0.171 (in-sample avg dev_std = 0.214)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.927
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.897
NEC for r=0.9 class 0.0 = 0.251 +- 0.125 (in-sample avg dev_std = 0.163)
NEC for r=0.9 class 1.0 = 0.039 +- 0.125 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all KL = 0.05 +- 0.125 (in-sample avg dev_std = 0.163)
NEC for r=0.9 all L1 = 0.064 +- 0.135 (in-sample avg dev_std = 0.163)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.927
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.896
NEC for r=1.0 class 0.0 = 0.258 +- 0.110 (in-sample avg dev_std = 0.159)
NEC for r=1.0 class 1.0 = 0.039 +- 0.110 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all KL = 0.044 +- 0.110 (in-sample avg dev_std = 0.159)
NEC for r=1.0 all L1 = 0.064 +- 0.136 (in-sample avg dev_std = 0.159)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.627
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.58
NEC for r=0.3 class 0.0 = 0.393 +- 0.253 (in-sample avg dev_std = 0.414)
NEC for r=0.3 class 1.0 = 0.376 +- 0.253 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all KL = 0.333 +- 0.253 (in-sample avg dev_std = 0.414)
NEC for r=0.3 all L1 = 0.378 +- 0.189 (in-sample avg dev_std = 0.414)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.709
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.671
NEC for r=0.6 class 0.0 = 0.268 +- 0.198 (in-sample avg dev_std = 0.278)
NEC for r=0.6 class 1.0 = 0.165 +- 0.198 (in-sample avg dev_std = 0.278)
NEC for r=0.6 all KL = 0.163 +- 0.198 (in-sample avg dev_std = 0.278)
NEC for r=0.6 all L1 = 0.182 +- 0.193 (in-sample avg dev_std = 0.278)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.74
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.703
NEC for r=0.9 class 0.0 = 0.188 +- 0.143 (in-sample avg dev_std = 0.179)
NEC for r=0.9 class 1.0 = 0.085 +- 0.143 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all KL = 0.074 +- 0.143 (in-sample avg dev_std = 0.179)
NEC for r=0.9 all L1 = 0.102 +- 0.164 (in-sample avg dev_std = 0.179)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.747
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.719
NEC for r=1.0 class 0.0 = 0.199 +- 0.139 (in-sample avg dev_std = 0.188)
NEC for r=1.0 class 1.0 = 0.085 +- 0.139 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all KL = 0.071 +- 0.139 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all L1 = 0.104 +- 0.167 (in-sample avg dev_std = 0.188)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.798, 0.922, 0.964, 1.0], 'all_L1': [0.749, 0.894, 0.939, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.824, 0.901, 0.966, 1.0], 'all_L1': [0.739, 0.867, 0.942, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.944, 0.976, 1.0], 'all_L1': [0.793, 0.906, 0.948, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.883, 0.936, 0.977, 1.0], 'all_L1': [0.795, 0.901, 0.952, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.812, 0.927, 0.973, 1.0], 'all_L1': [0.754, 0.908, 0.953, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.298, 0.103, 0.053, 0.051], 'all_L1': [0.325, 0.121, 0.076, 0.074]}), defaultdict(<class 'list'>, {'all_KL': [0.241, 0.132, 0.054, 0.045], 'all_L1': [0.32, 0.152, 0.074, 0.072]}), defaultdict(<class 'list'>, {'all_KL': [0.199, 0.073, 0.037, 0.032], 'all_L1': [0.283, 0.108, 0.064, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.18, 0.08, 0.044, 0.04], 'all_L1': [0.269, 0.109, 0.068, 0.067]}), defaultdict(<class 'list'>, {'all_KL': [0.313, 0.113, 0.05, 0.044], 'all_L1': [0.344, 0.115, 0.064, 0.064]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.77, 0.891, 0.937, 1.0], 'all_L1': [0.709, 0.843, 0.892, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.829, 0.868, 0.947, 1.0], 'all_L1': [0.717, 0.798, 0.904, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.87, 0.924, 0.96, 1.0], 'all_L1': [0.757, 0.85, 0.909, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.878, 0.907, 0.959, 1.0], 'all_L1': [0.761, 0.839, 0.911, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.778, 0.897, 0.956, 1.0], 'all_L1': [0.715, 0.863, 0.925, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.32, 0.153, 0.083, 0.078], 'all_L1': [0.373, 0.189, 0.126, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.219, 0.149, 0.086, 0.068], 'all_L1': [0.337, 0.216, 0.127, 0.117]}), defaultdict(<class 'list'>, {'all_KL': [0.195, 0.104, 0.056, 0.047], 'all_L1': [0.313, 0.176, 0.11, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.181, 0.131, 0.065, 0.064], 'all_L1': [0.304, 0.193, 0.114, 0.118]}), defaultdict(<class 'list'>, {'all_KL': [0.333, 0.163, 0.074, 0.071], 'all_L1': [0.378, 0.182, 0.102, 0.104]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.766 +- 0.023, 0.895 +- 0.015, 0.947 +- 0.005, 1.000 +- 0.000
suff++ class all_KL  =  0.840 +- 0.036, 0.926 +- 0.015, 0.971 +- 0.005, 1.000 +- 0.000
suff++_acc_int  =  0.713 +- 0.021, 0.847 +- 0.017, 0.901 +- 0.004
nec class all_L1  =  0.308 +- 0.028, 0.121 +- 0.016, 0.069 +- 0.005, 0.067 +- 0.005
nec class all_KL  =  0.246 +- 0.053, 0.100 +- 0.022, 0.048 +- 0.006, 0.042 +- 0.006
nec_acc_int  =  0.712 +- 0.032, 0.850 +- 0.015, 0.890 +- 0.006, 0.891 +- 0.003

Eval split test
suff++ class all_L1  =  0.732 +- 0.022, 0.839 +- 0.022, 0.908 +- 0.011, 1.000 +- 0.000
suff++ class all_KL  =  0.825 +- 0.045, 0.897 +- 0.018, 0.952 +- 0.009, 1.000 +- 0.000
suff++_acc_int  =  0.597 +- 0.021, 0.685 +- 0.013, 0.710 +- 0.016
nec class all_L1  =  0.341 +- 0.030, 0.191 +- 0.014, 0.116 +- 0.010, 0.114 +- 0.009
nec class all_KL  =  0.250 +- 0.064, 0.140 +- 0.021, 0.073 +- 0.011, 0.066 +- 0.010
nec_acc_int  =  0.605 +- 0.022, 0.684 +- 0.015, 0.711 +- 0.012, 0.719 +- 0.007


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.537 +- 0.007, 0.508 +- 0.002, 0.508 +- 0.001, 0.534 +- 0.003
Faith. Armon (L1)= 		  =  0.438 +- 0.025, 0.213 +- 0.024, 0.129 +- 0.009, 0.126 +- 0.009
Faith. GMean (L1)= 	  =  0.485 +- 0.016, 0.328 +- 0.018, 0.256 +- 0.009, 0.259 +- 0.010
Faith. Aritm (KL)= 		  =  0.543 +- 0.011, 0.513 +- 0.005, 0.509 +- 0.002, 0.521 +- 0.003
Faith. Armon (KL)= 		  =  0.376 +- 0.059, 0.180 +- 0.035, 0.091 +- 0.012, 0.081 +- 0.012
Faith. GMean (KL)= 	  =  0.451 +- 0.040, 0.303 +- 0.031, 0.214 +- 0.014, 0.205 +- 0.016

Eval split test
Faith. Aritm (L1)= 		  =  0.536 +- 0.007, 0.515 +- 0.005, 0.512 +- 0.002, 0.557 +- 0.004
Faith. Armon (L1)= 		  =  0.464 +- 0.024, 0.311 +- 0.016, 0.205 +- 0.015, 0.204 +- 0.014
Faith. GMean (L1)= 	  =  0.499 +- 0.015, 0.400 +- 0.009, 0.324 +- 0.012, 0.337 +- 0.013
Faith. Aritm (KL)= 		  =  0.537 +- 0.011, 0.519 +- 0.007, 0.512 +- 0.003, 0.533 +- 0.005
Faith. Armon (KL)= 		  =  0.377 +- 0.069, 0.241 +- 0.031, 0.135 +- 0.019, 0.123 +- 0.018
Faith. GMean (KL)= 	  =  0.448 +- 0.045, 0.353 +- 0.025, 0.262 +- 0.020, 0.255 +- 0.021
Computed for split load_split = id



Completed in  0:24:26.237942  for LECIvGIN LBAPcore/assay



DONE LECI LBAPcore/assay ER
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:35:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:35:13 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:35:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:35:56 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:24 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:36:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9769
Train Loss: 0.1241
ID Validation ROC-AUC: 0.9251
ID Validation Loss: 0.2646
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2693
OOD Validation ROC-AUC: 0.6274
OOD Validation Loss: 0.5719
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.7027

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8627
Train Loss: 0.3460
ID Validation ROC-AUC: 0.8591
ID Validation Loss: 0.3495
ID Test ROC-AUC: 0.8621
ID Test Loss: 0.3525
OOD Validation ROC-AUC: 0.7045
OOD Validation Loss: 0.2921
OOD Test ROC-AUC: 0.7135
OOD Test Loss: 0.5263

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7014 0.8621 0.7135 0.8591 0.7045[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:36:41 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:36:47 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.83
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.72
SUFF++ for r=0.3 class 0.0 = 0.632 +- 0.166 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 class 1.0 = 0.696 +- 0.166 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 all KL = 0.779 +- 0.166 (in-sample avg dev_std = 0.396)
SUFF++ for r=0.3 all L1 = 0.689 +- 0.139 (in-sample avg dev_std = 0.396)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.812
SUFF++ for r=0.6 class 0.0 = 0.666 +- 0.211 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 class 1.0 = 0.869 +- 0.211 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 all KL = 0.842 +- 0.211 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.6 all L1 = 0.846 +- 0.180 (in-sample avg dev_std = 0.345)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.876
SUFF++ for r=0.9 class 0.0 = 0.762 +- 0.197 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 class 1.0 = 0.93 +- 0.197 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all KL = 0.912 +- 0.197 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.9 all L1 = 0.911 +- 0.154 (in-sample avg dev_std = 0.237)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.661
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.62
SUFF++ for r=0.3 class 0.0 = 0.664 +- 0.162 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 class 1.0 = 0.684 +- 0.162 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 all KL = 0.774 +- 0.162 (in-sample avg dev_std = 0.420)
SUFF++ for r=0.3 all L1 = 0.681 +- 0.133 (in-sample avg dev_std = 0.420)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.662
SUFF++ for r=0.6 class 0.0 = 0.714 +- 0.204 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 class 1.0 = 0.796 +- 0.204 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 all KL = 0.801 +- 0.204 (in-sample avg dev_std = 0.390)
SUFF++ for r=0.6 all L1 = 0.782 +- 0.186 (in-sample avg dev_std = 0.390)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.734
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.698
SUFF++ for r=0.9 class 0.0 = 0.784 +- 0.185 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 class 1.0 = 0.879 +- 0.185 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all KL = 0.891 +- 0.185 (in-sample avg dev_std = 0.258)
SUFF++ for r=0.9 all L1 = 0.863 +- 0.169 (in-sample avg dev_std = 0.258)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.83
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.72
NEC for r=0.3 class 0.0 = 0.384 +- 0.194 (in-sample avg dev_std = 0.330)
NEC for r=0.3 class 1.0 = 0.297 +- 0.194 (in-sample avg dev_std = 0.330)
NEC for r=0.3 all KL = 0.206 +- 0.194 (in-sample avg dev_std = 0.330)
NEC for r=0.3 all L1 = 0.307 +- 0.165 (in-sample avg dev_std = 0.330)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.897
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.839
NEC for r=0.6 class 0.0 = 0.352 +- 0.208 (in-sample avg dev_std = 0.304)
NEC for r=0.6 class 1.0 = 0.125 +- 0.208 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all KL = 0.144 +- 0.208 (in-sample avg dev_std = 0.304)
NEC for r=0.6 all L1 = 0.151 +- 0.186 (in-sample avg dev_std = 0.304)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.875
NEC for r=0.9 class 0.0 = 0.287 +- 0.205 (in-sample avg dev_std = 0.258)
NEC for r=0.9 class 1.0 = 0.083 +- 0.205 (in-sample avg dev_std = 0.258)
NEC for r=0.9 all KL = 0.115 +- 0.205 (in-sample avg dev_std = 0.258)
NEC for r=0.9 all L1 = 0.107 +- 0.165 (in-sample avg dev_std = 0.258)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.922
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.874
NEC for r=1.0 class 0.0 = 0.3 +- 0.201 (in-sample avg dev_std = 0.251)
NEC for r=1.0 class 1.0 = 0.078 +- 0.201 (in-sample avg dev_std = 0.251)
NEC for r=1.0 all KL = 0.109 +- 0.201 (in-sample avg dev_std = 0.251)
NEC for r=1.0 all L1 = 0.104 +- 0.165 (in-sample avg dev_std = 0.251)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.661
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.64
NEC for r=0.3 class 0.0 = 0.386 +- 0.212 (in-sample avg dev_std = 0.358)
NEC for r=0.3 class 1.0 = 0.333 +- 0.212 (in-sample avg dev_std = 0.358)
NEC for r=0.3 all KL = 0.24 +- 0.212 (in-sample avg dev_std = 0.358)
NEC for r=0.3 all L1 = 0.342 +- 0.179 (in-sample avg dev_std = 0.358)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.72
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.686
NEC for r=0.6 class 0.0 = 0.32 +- 0.230 (in-sample avg dev_std = 0.358)
NEC for r=0.6 class 1.0 = 0.22 +- 0.230 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all KL = 0.21 +- 0.230 (in-sample avg dev_std = 0.358)
NEC for r=0.6 all L1 = 0.237 +- 0.204 (in-sample avg dev_std = 0.358)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.734
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.701
NEC for r=0.9 class 0.0 = 0.257 +- 0.222 (in-sample avg dev_std = 0.303)
NEC for r=0.9 class 1.0 = 0.161 +- 0.222 (in-sample avg dev_std = 0.303)
NEC for r=0.9 all KL = 0.164 +- 0.222 (in-sample avg dev_std = 0.303)
NEC for r=0.9 all L1 = 0.177 +- 0.186 (in-sample avg dev_std = 0.303)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.74
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.713
NEC for r=1.0 class 0.0 = 0.259 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=1.0 class 1.0 = 0.149 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=1.0 all KL = 0.149 +- 0.213 (in-sample avg dev_std = 0.293)
NEC for r=1.0 all L1 = 0.167 +- 0.182 (in-sample avg dev_std = 0.293)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:40:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:40:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:40:34 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:40:45 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:40:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:12 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ROC-AUC: 0.9559
Train Loss: 0.1818
ID Validation ROC-AUC: 0.9207
ID Validation Loss: 0.2309
ID Test ROC-AUC: 0.9188
ID Test Loss: 0.2372
OOD Validation ROC-AUC: 0.6575
OOD Validation Loss: 0.3564
OOD Test ROC-AUC: 0.7045
OOD Test Loss: 0.5081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ROC-AUC: 0.8717
Train Loss: 0.3292
ID Validation ROC-AUC: 0.8694
ID Validation Loss: 0.3314
ID Test ROC-AUC: 0.8710
ID Test Loss: 0.3354
OOD Validation ROC-AUC: 0.7102
OOD Validation Loss: 0.2911
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.5120

[0m[1;37mINFO[0m: [1mChartInfo 0.9188 0.7045 0.8710 0.7280 0.8694 0.7102[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:41:28 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:41:33 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.853
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.775
SUFF++ for r=0.3 class 0.0 = 0.761 +- 0.069 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.3 class 1.0 = 0.874 +- 0.069 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.3 all KL = 0.942 +- 0.069 (in-sample avg dev_std = 0.177)
SUFF++ for r=0.3 all L1 = 0.86 +- 0.100 (in-sample avg dev_std = 0.177)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.901
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.844
SUFF++ for r=0.6 class 0.0 = 0.764 +- 0.093 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.6 class 1.0 = 0.92 +- 0.093 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.6 all KL = 0.939 +- 0.093 (in-sample avg dev_std = 0.168)
SUFF++ for r=0.6 all L1 = 0.902 +- 0.118 (in-sample avg dev_std = 0.168)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.875
SUFF++ for r=0.9 class 0.0 = 0.827 +- 0.104 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 class 1.0 = 0.95 +- 0.104 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all KL = 0.959 +- 0.104 (in-sample avg dev_std = 0.116)
SUFF++ for r=0.9 all L1 = 0.935 +- 0.099 (in-sample avg dev_std = 0.116)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.718
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.654
SUFF++ for r=0.3 class 0.0 = 0.781 +- 0.071 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.3 class 1.0 = 0.843 +- 0.071 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.3 all KL = 0.935 +- 0.071 (in-sample avg dev_std = 0.191)
SUFF++ for r=0.3 all L1 = 0.833 +- 0.100 (in-sample avg dev_std = 0.191)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.728
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.686
SUFF++ for r=0.6 class 0.0 = 0.797 +- 0.093 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.6 class 1.0 = 0.869 +- 0.093 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.6 all KL = 0.922 +- 0.093 (in-sample avg dev_std = 0.196)
SUFF++ for r=0.6 all L1 = 0.857 +- 0.120 (in-sample avg dev_std = 0.196)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.737
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.716
SUFF++ for r=0.9 class 0.0 = 0.854 +- 0.094 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 class 1.0 = 0.911 +- 0.094 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all KL = 0.95 +- 0.094 (in-sample avg dev_std = 0.140)
SUFF++ for r=0.9 all L1 = 0.902 +- 0.109 (in-sample avg dev_std = 0.140)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.853
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.784
NEC for r=0.3 class 0.0 = 0.23 +- 0.088 (in-sample avg dev_std = 0.158)
NEC for r=0.3 class 1.0 = 0.146 +- 0.088 (in-sample avg dev_std = 0.158)
NEC for r=0.3 all KL = 0.068 +- 0.088 (in-sample avg dev_std = 0.158)
NEC for r=0.3 all L1 = 0.155 +- 0.112 (in-sample avg dev_std = 0.158)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.901
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.865
NEC for r=0.6 class 0.0 = 0.215 +- 0.102 (in-sample avg dev_std = 0.152)
NEC for r=0.6 class 1.0 = 0.081 +- 0.102 (in-sample avg dev_std = 0.152)
NEC for r=0.6 all KL = 0.06 +- 0.102 (in-sample avg dev_std = 0.152)
NEC for r=0.6 all L1 = 0.097 +- 0.114 (in-sample avg dev_std = 0.152)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.921
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.887
NEC for r=0.9 class 0.0 = 0.166 +- 0.113 (in-sample avg dev_std = 0.132)
NEC for r=0.9 class 1.0 = 0.057 +- 0.113 (in-sample avg dev_std = 0.132)
NEC for r=0.9 all KL = 0.048 +- 0.113 (in-sample avg dev_std = 0.132)
NEC for r=0.9 all L1 = 0.069 +- 0.103 (in-sample avg dev_std = 0.132)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.922
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.891
NEC for r=1.0 class 0.0 = 0.153 +- 0.100 (in-sample avg dev_std = 0.120)
NEC for r=1.0 class 1.0 = 0.051 +- 0.100 (in-sample avg dev_std = 0.120)
NEC for r=1.0 all KL = 0.042 +- 0.100 (in-sample avg dev_std = 0.120)
NEC for r=1.0 all L1 = 0.063 +- 0.093 (in-sample avg dev_std = 0.120)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.717
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.648
NEC for r=0.3 class 0.0 = 0.224 +- 0.096 (in-sample avg dev_std = 0.172)
NEC for r=0.3 class 1.0 = 0.18 +- 0.096 (in-sample avg dev_std = 0.172)
NEC for r=0.3 all KL = 0.078 +- 0.096 (in-sample avg dev_std = 0.172)
NEC for r=0.3 all L1 = 0.187 +- 0.117 (in-sample avg dev_std = 0.172)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.728
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.706
NEC for r=0.6 class 0.0 = 0.198 +- 0.117 (in-sample avg dev_std = 0.185)
NEC for r=0.6 class 1.0 = 0.136 +- 0.117 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all KL = 0.081 +- 0.117 (in-sample avg dev_std = 0.185)
NEC for r=0.6 all L1 = 0.146 +- 0.129 (in-sample avg dev_std = 0.185)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.737
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.72
NEC for r=0.9 class 0.0 = 0.156 +- 0.106 (in-sample avg dev_std = 0.158)
NEC for r=0.9 class 1.0 = 0.099 +- 0.106 (in-sample avg dev_std = 0.158)
NEC for r=0.9 all KL = 0.06 +- 0.106 (in-sample avg dev_std = 0.158)
NEC for r=0.9 all L1 = 0.108 +- 0.111 (in-sample avg dev_std = 0.158)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.748
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.726
NEC for r=1.0 class 0.0 = 0.15 +- 0.090 (in-sample avg dev_std = 0.144)
NEC for r=1.0 class 1.0 = 0.09 +- 0.090 (in-sample avg dev_std = 0.144)
NEC for r=1.0 all KL = 0.051 +- 0.090 (in-sample avg dev_std = 0.144)
NEC for r=1.0 all L1 = 0.1 +- 0.105 (in-sample avg dev_std = 0.144)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:44:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:44:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:45:20 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:45:32 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:45:43 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:00 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:17 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:17 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:17 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9718
Train Loss: 0.1502
ID Validation ROC-AUC: 0.9222
ID Validation Loss: 0.2869
ID Test ROC-AUC: 0.9201
ID Test Loss: 0.2932
OOD Validation ROC-AUC: 0.6430
OOD Validation Loss: 0.5048
OOD Test ROC-AUC: 0.7020
OOD Test Loss: 0.7112

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ROC-AUC: 0.8089
Train Loss: 0.4646
ID Validation ROC-AUC: 0.8084
ID Validation Loss: 0.4676
ID Test ROC-AUC: 0.8095
ID Test Loss: 0.4731
OOD Validation ROC-AUC: 0.6927
OOD Validation Loss: 0.3283
OOD Test ROC-AUC: 0.6938
OOD Test Loss: 0.4537

[0m[1;37mINFO[0m: [1mChartInfo 0.9201 0.7020 0.8095 0.6938 0.8084 0.6927[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:46:18 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:46:22 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.8
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.695
SUFF++ for r=0.3 class 0.0 = 0.608 +- 0.148 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 class 1.0 = 0.738 +- 0.148 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 all KL = 0.814 +- 0.148 (in-sample avg dev_std = 0.344)
SUFF++ for r=0.3 all L1 = 0.723 +- 0.149 (in-sample avg dev_std = 0.344)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.873
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.792
SUFF++ for r=0.6 class 0.0 = 0.653 +- 0.155 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.6 class 1.0 = 0.901 +- 0.155 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.6 all KL = 0.896 +- 0.155 (in-sample avg dev_std = 0.249)
SUFF++ for r=0.6 all L1 = 0.872 +- 0.170 (in-sample avg dev_std = 0.249)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.881
SUFF++ for r=0.9 class 0.0 = 0.764 +- 0.134 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 class 1.0 = 0.954 +- 0.134 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 all KL = 0.947 +- 0.134 (in-sample avg dev_std = 0.171)
SUFF++ for r=0.9 all L1 = 0.932 +- 0.133 (in-sample avg dev_std = 0.171)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.616
SUFF++ for r=0.3 class 0.0 = 0.645 +- 0.161 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 class 1.0 = 0.7 +- 0.161 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 all KL = 0.793 +- 0.161 (in-sample avg dev_std = 0.377)
SUFF++ for r=0.3 all L1 = 0.691 +- 0.146 (in-sample avg dev_std = 0.377)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.725
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.66
SUFF++ for r=0.6 class 0.0 = 0.691 +- 0.174 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.6 class 1.0 = 0.831 +- 0.174 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.6 all KL = 0.849 +- 0.174 (in-sample avg dev_std = 0.309)
SUFF++ for r=0.6 all L1 = 0.808 +- 0.185 (in-sample avg dev_std = 0.309)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.747
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.712
SUFF++ for r=0.9 class 0.0 = 0.771 +- 0.155 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 class 1.0 = 0.903 +- 0.155 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 all KL = 0.914 +- 0.155 (in-sample avg dev_std = 0.218)
SUFF++ for r=0.9 all L1 = 0.881 +- 0.165 (in-sample avg dev_std = 0.218)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.8
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.722
NEC for r=0.3 class 0.0 = 0.411 +- 0.169 (in-sample avg dev_std = 0.278)
NEC for r=0.3 class 1.0 = 0.262 +- 0.169 (in-sample avg dev_std = 0.278)
NEC for r=0.3 all KL = 0.177 +- 0.169 (in-sample avg dev_std = 0.278)
NEC for r=0.3 all L1 = 0.279 +- 0.161 (in-sample avg dev_std = 0.278)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.873
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.851
NEC for r=0.6 class 0.0 = 0.339 +- 0.162 (in-sample avg dev_std = 0.218)
NEC for r=0.6 class 1.0 = 0.095 +- 0.162 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all KL = 0.093 +- 0.162 (in-sample avg dev_std = 0.218)
NEC for r=0.6 all L1 = 0.124 +- 0.172 (in-sample avg dev_std = 0.218)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.925
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.892
NEC for r=0.9 class 0.0 = 0.263 +- 0.160 (in-sample avg dev_std = 0.198)
NEC for r=0.9 class 1.0 = 0.058 +- 0.160 (in-sample avg dev_std = 0.198)
NEC for r=0.9 all KL = 0.07 +- 0.160 (in-sample avg dev_std = 0.198)
NEC for r=0.9 all L1 = 0.082 +- 0.148 (in-sample avg dev_std = 0.198)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.928
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.894
NEC for r=1.0 class 0.0 = 0.261 +- 0.146 (in-sample avg dev_std = 0.187)
NEC for r=1.0 class 1.0 = 0.053 +- 0.146 (in-sample avg dev_std = 0.187)
NEC for r=1.0 all KL = 0.063 +- 0.146 (in-sample avg dev_std = 0.187)
NEC for r=1.0 all L1 = 0.077 +- 0.144 (in-sample avg dev_std = 0.187)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.668
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.636
NEC for r=0.3 class 0.0 = 0.373 +- 0.191 (in-sample avg dev_std = 0.312)
NEC for r=0.3 class 1.0 = 0.304 +- 0.191 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all KL = 0.201 +- 0.191 (in-sample avg dev_std = 0.312)
NEC for r=0.3 all L1 = 0.315 +- 0.168 (in-sample avg dev_std = 0.312)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.725
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.699
NEC for r=0.6 class 0.0 = 0.294 +- 0.182 (in-sample avg dev_std = 0.267)
NEC for r=0.6 class 1.0 = 0.164 +- 0.182 (in-sample avg dev_std = 0.267)
NEC for r=0.6 all KL = 0.136 +- 0.182 (in-sample avg dev_std = 0.267)
NEC for r=0.6 all L1 = 0.185 +- 0.185 (in-sample avg dev_std = 0.267)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.747
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.718
NEC for r=0.9 class 0.0 = 0.24 +- 0.165 (in-sample avg dev_std = 0.234)
NEC for r=0.9 class 1.0 = 0.114 +- 0.165 (in-sample avg dev_std = 0.234)
NEC for r=0.9 all KL = 0.101 +- 0.165 (in-sample avg dev_std = 0.234)
NEC for r=0.9 all L1 = 0.135 +- 0.176 (in-sample avg dev_std = 0.234)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.749
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.721
NEC for r=1.0 class 0.0 = 0.232 +- 0.163 (in-sample avg dev_std = 0.221)
NEC for r=1.0 class 1.0 = 0.102 +- 0.163 (in-sample avg dev_std = 0.221)
NEC for r=1.0 all KL = 0.095 +- 0.163 (in-sample avg dev_std = 0.221)
NEC for r=1.0 all L1 = 0.124 +- 0.167 (in-sample avg dev_std = 0.221)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:49:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:49:38 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:50:09 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:50:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:50:29 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:50:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ROC-AUC: 0.9605
Train Loss: 0.1572
ID Validation ROC-AUC: 0.9210
ID Validation Loss: 0.2207
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2229
OOD Validation ROC-AUC: 0.6437
OOD Validation Loss: 0.4343
OOD Test ROC-AUC: 0.7008
OOD Test Loss: 0.5543

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8643
Train Loss: 0.3237
ID Validation ROC-AUC: 0.8622
ID Validation Loss: 0.3271
ID Test ROC-AUC: 0.8643
ID Test Loss: 0.3301
OOD Validation ROC-AUC: 0.7009
OOD Validation Loss: 0.2819
OOD Test ROC-AUC: 0.7289
OOD Test Loss: 0.4908

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.7008 0.8643 0.7289 0.8622 0.7009[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:51:01 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:51:05 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.854
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.765
SUFF++ for r=0.3 class 0.0 = 0.717 +- 0.115 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 class 1.0 = 0.852 +- 0.115 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 all KL = 0.887 +- 0.115 (in-sample avg dev_std = 0.235)
SUFF++ for r=0.3 all L1 = 0.836 +- 0.137 (in-sample avg dev_std = 0.235)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.904
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.819
SUFF++ for r=0.6 class 0.0 = 0.726 +- 0.097 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.6 class 1.0 = 0.919 +- 0.097 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.6 all KL = 0.928 +- 0.097 (in-sample avg dev_std = 0.176)
SUFF++ for r=0.6 all L1 = 0.897 +- 0.127 (in-sample avg dev_std = 0.176)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.862
SUFF++ for r=0.9 class 0.0 = 0.779 +- 0.126 (in-sample avg dev_std = 0.157)
SUFF++ for r=0.9 class 1.0 = 0.932 +- 0.126 (in-sample avg dev_std = 0.157)
SUFF++ for r=0.9 all KL = 0.94 +- 0.126 (in-sample avg dev_std = 0.157)
SUFF++ for r=0.9 all L1 = 0.914 +- 0.131 (in-sample avg dev_std = 0.157)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.665
SUFF++ for r=0.3 class 0.0 = 0.729 +- 0.112 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 class 1.0 = 0.79 +- 0.112 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 all KL = 0.871 +- 0.112 (in-sample avg dev_std = 0.272)
SUFF++ for r=0.3 all L1 = 0.78 +- 0.141 (in-sample avg dev_std = 0.272)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.722
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.685
SUFF++ for r=0.6 class 0.0 = 0.766 +- 0.100 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.6 class 1.0 = 0.859 +- 0.100 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.6 all KL = 0.911 +- 0.100 (in-sample avg dev_std = 0.210)
SUFF++ for r=0.6 all L1 = 0.844 +- 0.141 (in-sample avg dev_std = 0.210)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.746
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.71
SUFF++ for r=0.9 class 0.0 = 0.81 +- 0.111 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 class 1.0 = 0.88 +- 0.111 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all KL = 0.929 +- 0.111 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.9 all L1 = 0.869 +- 0.137 (in-sample avg dev_std = 0.182)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.854
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.788
NEC for r=0.3 class 0.0 = 0.326 +- 0.140 (in-sample avg dev_std = 0.197)
NEC for r=0.3 class 1.0 = 0.157 +- 0.140 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all KL = 0.12 +- 0.140 (in-sample avg dev_std = 0.197)
NEC for r=0.3 all L1 = 0.177 +- 0.160 (in-sample avg dev_std = 0.197)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.867
NEC for r=0.6 class 0.0 = 0.273 +- 0.113 (in-sample avg dev_std = 0.157)
NEC for r=0.6 class 1.0 = 0.077 +- 0.113 (in-sample avg dev_std = 0.157)
NEC for r=0.6 all KL = 0.066 +- 0.113 (in-sample avg dev_std = 0.157)
NEC for r=0.6 all L1 = 0.1 +- 0.132 (in-sample avg dev_std = 0.157)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.916
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.886
NEC for r=0.9 class 0.0 = 0.24 +- 0.119 (in-sample avg dev_std = 0.172)
NEC for r=0.9 class 1.0 = 0.074 +- 0.119 (in-sample avg dev_std = 0.172)
NEC for r=0.9 all KL = 0.066 +- 0.119 (in-sample avg dev_std = 0.172)
NEC for r=0.9 all L1 = 0.093 +- 0.132 (in-sample avg dev_std = 0.172)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.925
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.891
NEC for r=1.0 class 0.0 = 0.236 +- 0.107 (in-sample avg dev_std = 0.167)
NEC for r=1.0 class 1.0 = 0.064 +- 0.107 (in-sample avg dev_std = 0.167)
NEC for r=1.0 all KL = 0.061 +- 0.107 (in-sample avg dev_std = 0.167)
NEC for r=1.0 all L1 = 0.084 +- 0.120 (in-sample avg dev_std = 0.167)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.713
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.67
NEC for r=0.3 class 0.0 = 0.306 +- 0.150 (in-sample avg dev_std = 0.233)
NEC for r=0.3 class 1.0 = 0.235 +- 0.150 (in-sample avg dev_std = 0.233)
NEC for r=0.3 all KL = 0.149 +- 0.150 (in-sample avg dev_std = 0.233)
NEC for r=0.3 all L1 = 0.246 +- 0.169 (in-sample avg dev_std = 0.233)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.722
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.699
NEC for r=0.6 class 0.0 = 0.257 +- 0.116 (in-sample avg dev_std = 0.196)
NEC for r=0.6 class 1.0 = 0.148 +- 0.116 (in-sample avg dev_std = 0.196)
NEC for r=0.6 all KL = 0.095 +- 0.116 (in-sample avg dev_std = 0.196)
NEC for r=0.6 all L1 = 0.166 +- 0.151 (in-sample avg dev_std = 0.196)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.746
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.718
NEC for r=0.9 class 0.0 = 0.215 +- 0.120 (in-sample avg dev_std = 0.207)
NEC for r=0.9 class 1.0 = 0.136 +- 0.120 (in-sample avg dev_std = 0.207)
NEC for r=0.9 all KL = 0.086 +- 0.120 (in-sample avg dev_std = 0.207)
NEC for r=0.9 all L1 = 0.149 +- 0.145 (in-sample avg dev_std = 0.207)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.753
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.722
NEC for r=1.0 class 0.0 = 0.204 +- 0.120 (in-sample avg dev_std = 0.206)
NEC for r=1.0 class 1.0 = 0.128 +- 0.120 (in-sample avg dev_std = 0.206)
NEC for r=1.0 all KL = 0.08 +- 0.120 (in-sample avg dev_std = 0.206)
NEC for r=1.0 all L1 = 0.141 +- 0.142 (in-sample avg dev_std = 0.206)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:54:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:54:17 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:54:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:54:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:24 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9755
Train Loss: 0.1331
ID Validation ROC-AUC: 0.9228
ID Validation Loss: 0.2627
ID Test ROC-AUC: 0.9230
ID Test Loss: 0.2676
OOD Validation ROC-AUC: 0.6330
OOD Validation Loss: 0.4920
OOD Test ROC-AUC: 0.6956
OOD Test Loss: 0.6669

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8416
Train Loss: 0.7193
ID Validation ROC-AUC: 0.8417
ID Validation Loss: 0.7258
ID Test ROC-AUC: 0.8407
ID Test Loss: 0.7339
OOD Validation ROC-AUC: 0.7030
OOD Validation Loss: 0.4109
OOD Test ROC-AUC: 0.7172
OOD Test Loss: 0.4958

[0m[1;37mINFO[0m: [1mChartInfo 0.9230 0.6956 0.8407 0.7172 0.8417 0.7030[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 05:55:39 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 05:55:44 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.785
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.676
SUFF++ for r=0.3 class 0.0 = 0.617 +- 0.140 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 class 1.0 = 0.686 +- 0.140 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 all KL = 0.803 +- 0.140 (in-sample avg dev_std = 0.362)
SUFF++ for r=0.3 all L1 = 0.678 +- 0.126 (in-sample avg dev_std = 0.362)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.871
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.777
SUFF++ for r=0.6 class 0.0 = 0.655 +- 0.160 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 class 1.0 = 0.884 +- 0.160 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all KL = 0.884 +- 0.160 (in-sample avg dev_std = 0.267)
SUFF++ for r=0.6 all L1 = 0.858 +- 0.174 (in-sample avg dev_std = 0.267)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.922
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.879
SUFF++ for r=0.9 class 0.0 = 0.742 +- 0.139 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 class 1.0 = 0.946 +- 0.139 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 all KL = 0.939 +- 0.139 (in-sample avg dev_std = 0.184)
SUFF++ for r=0.9 all L1 = 0.923 +- 0.142 (in-sample avg dev_std = 0.184)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.658
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.609
SUFF++ for r=0.3 class 0.0 = 0.651 +- 0.148 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 class 1.0 = 0.683 +- 0.148 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 all KL = 0.802 +- 0.148 (in-sample avg dev_std = 0.369)
SUFF++ for r=0.3 all L1 = 0.677 +- 0.125 (in-sample avg dev_std = 0.369)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.657
SUFF++ for r=0.6 class 0.0 = 0.714 +- 0.168 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.6 class 1.0 = 0.824 +- 0.168 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.6 all KL = 0.852 +- 0.168 (in-sample avg dev_std = 0.318)
SUFF++ for r=0.6 all L1 = 0.806 +- 0.185 (in-sample avg dev_std = 0.318)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.719
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.688
SUFF++ for r=0.9 class 0.0 = 0.813 +- 0.155 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 class 1.0 = 0.896 +- 0.155 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all KL = 0.919 +- 0.155 (in-sample avg dev_std = 0.222)
SUFF++ for r=0.9 all L1 = 0.882 +- 0.164 (in-sample avg dev_std = 0.222)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.784
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.702
NEC for r=0.3 class 0.0 = 0.379 +- 0.155 (in-sample avg dev_std = 0.284)
NEC for r=0.3 class 1.0 = 0.29 +- 0.155 (in-sample avg dev_std = 0.284)
NEC for r=0.3 all KL = 0.167 +- 0.155 (in-sample avg dev_std = 0.284)
NEC for r=0.3 all L1 = 0.3 +- 0.142 (in-sample avg dev_std = 0.284)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.871
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.84
NEC for r=0.6 class 0.0 = 0.343 +- 0.162 (in-sample avg dev_std = 0.227)
NEC for r=0.6 class 1.0 = 0.109 +- 0.162 (in-sample avg dev_std = 0.227)
NEC for r=0.6 all KL = 0.105 +- 0.162 (in-sample avg dev_std = 0.227)
NEC for r=0.6 all L1 = 0.136 +- 0.170 (in-sample avg dev_std = 0.227)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.922
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.876
NEC for r=0.9 class 0.0 = 0.286 +- 0.162 (in-sample avg dev_std = 0.205)
NEC for r=0.9 class 1.0 = 0.066 +- 0.162 (in-sample avg dev_std = 0.205)
NEC for r=0.9 all KL = 0.08 +- 0.162 (in-sample avg dev_std = 0.205)
NEC for r=0.9 all L1 = 0.092 +- 0.154 (in-sample avg dev_std = 0.205)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.923
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.885
NEC for r=1.0 class 0.0 = 0.251 +- 0.148 (in-sample avg dev_std = 0.188)
NEC for r=1.0 class 1.0 = 0.058 +- 0.148 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all KL = 0.069 +- 0.148 (in-sample avg dev_std = 0.188)
NEC for r=1.0 all L1 = 0.081 +- 0.139 (in-sample avg dev_std = 0.188)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.659
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.607
NEC for r=0.3 class 0.0 = 0.356 +- 0.185 (in-sample avg dev_std = 0.307)
NEC for r=0.3 class 1.0 = 0.328 +- 0.185 (in-sample avg dev_std = 0.307)
NEC for r=0.3 all KL = 0.201 +- 0.185 (in-sample avg dev_std = 0.307)
NEC for r=0.3 all L1 = 0.333 +- 0.155 (in-sample avg dev_std = 0.307)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.715
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.671
NEC for r=0.6 class 0.0 = 0.312 +- 0.190 (in-sample avg dev_std = 0.280)
NEC for r=0.6 class 1.0 = 0.187 +- 0.190 (in-sample avg dev_std = 0.280)
NEC for r=0.6 all KL = 0.158 +- 0.190 (in-sample avg dev_std = 0.280)
NEC for r=0.6 all L1 = 0.207 +- 0.199 (in-sample avg dev_std = 0.280)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.719
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.693
NEC for r=0.9 class 0.0 = 0.23 +- 0.180 (in-sample avg dev_std = 0.252)
NEC for r=0.9 class 1.0 = 0.136 +- 0.180 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all KL = 0.118 +- 0.180 (in-sample avg dev_std = 0.252)
NEC for r=0.9 all L1 = 0.152 +- 0.182 (in-sample avg dev_std = 0.252)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.727
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.693
NEC for r=1.0 class 0.0 = 0.216 +- 0.167 (in-sample avg dev_std = 0.236)
NEC for r=1.0 class 1.0 = 0.124 +- 0.167 (in-sample avg dev_std = 0.236)
NEC for r=1.0 all KL = 0.103 +- 0.167 (in-sample avg dev_std = 0.236)
NEC for r=1.0 all L1 = 0.139 +- 0.175 (in-sample avg dev_std = 0.236)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.779, 0.842, 0.912, 1.0], 'all_L1': [0.689, 0.846, 0.911, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.942, 0.939, 0.959, 1.0], 'all_L1': [0.86, 0.902, 0.935, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.814, 0.896, 0.947, 1.0], 'all_L1': [0.723, 0.872, 0.932, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.887, 0.928, 0.94, 1.0], 'all_L1': [0.836, 0.897, 0.914, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.803, 0.884, 0.939, 1.0], 'all_L1': [0.678, 0.858, 0.923, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.206, 0.144, 0.115, 0.109], 'all_L1': [0.307, 0.151, 0.107, 0.104]}), defaultdict(<class 'list'>, {'all_KL': [0.068, 0.06, 0.048, 0.042], 'all_L1': [0.155, 0.097, 0.069, 0.063]}), defaultdict(<class 'list'>, {'all_KL': [0.177, 0.093, 0.07, 0.063], 'all_L1': [0.279, 0.124, 0.082, 0.077]}), defaultdict(<class 'list'>, {'all_KL': [0.12, 0.066, 0.066, 0.061], 'all_L1': [0.177, 0.1, 0.093, 0.084]}), defaultdict(<class 'list'>, {'all_KL': [0.167, 0.105, 0.08, 0.069], 'all_L1': [0.3, 0.136, 0.092, 0.081]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.774, 0.801, 0.891, 1.0], 'all_L1': [0.681, 0.782, 0.863, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.935, 0.922, 0.95, 1.0], 'all_L1': [0.833, 0.857, 0.902, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.793, 0.849, 0.914, 1.0], 'all_L1': [0.691, 0.808, 0.881, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.871, 0.911, 0.929, 1.0], 'all_L1': [0.78, 0.844, 0.869, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.802, 0.852, 0.919, 1.0], 'all_L1': [0.677, 0.806, 0.882, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.24, 0.21, 0.164, 0.149], 'all_L1': [0.342, 0.237, 0.177, 0.167]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.081, 0.06, 0.051], 'all_L1': [0.187, 0.146, 0.108, 0.1]}), defaultdict(<class 'list'>, {'all_KL': [0.201, 0.136, 0.101, 0.095], 'all_L1': [0.315, 0.185, 0.135, 0.124]}), defaultdict(<class 'list'>, {'all_KL': [0.149, 0.095, 0.086, 0.08], 'all_L1': [0.246, 0.166, 0.149, 0.141]}), defaultdict(<class 'list'>, {'all_KL': [0.201, 0.158, 0.118, 0.103], 'all_L1': [0.333, 0.207, 0.152, 0.139]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.757 +- 0.076, 0.875 +- 0.022, 0.923 +- 0.009, 1.000 +- 0.000
suff++ class all_KL  =  0.845 +- 0.060, 0.898 +- 0.034, 0.939 +- 0.015, 1.000 +- 0.000
suff++_acc_int  =  0.726 +- 0.039, 0.809 +- 0.023, 0.875 +- 0.007
nec class all_L1  =  0.244 +- 0.064, 0.122 +- 0.021, 0.089 +- 0.013, 0.082 +- 0.013
nec class all_KL  =  0.148 +- 0.048, 0.094 +- 0.030, 0.076 +- 0.022, 0.069 +- 0.022
nec_acc_int  =  0.743 +- 0.036, 0.852 +- 0.012, 0.883 +- 0.007, 0.887 +- 0.007

Eval split test
suff++ class all_L1  =  0.732 +- 0.063, 0.819 +- 0.027, 0.879 +- 0.013, 1.000 +- 0.000
suff++ class all_KL  =  0.835 +- 0.060, 0.867 +- 0.044, 0.921 +- 0.019, 1.000 +- 0.000
suff++_acc_int  =  0.633 +- 0.023, 0.670 +- 0.013, 0.705 +- 0.011
nec class all_L1  =  0.285 +- 0.059, 0.188 +- 0.032, 0.144 +- 0.023, 0.134 +- 0.022
nec class all_KL  =  0.174 +- 0.056, 0.136 +- 0.046, 0.106 +- 0.035, 0.096 +- 0.032
nec_acc_int  =  0.640 +- 0.020, 0.692 +- 0.012, 0.710 +- 0.011, 0.715 +- 0.012


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.500 +- 0.007, 0.498 +- 0.001, 0.506 +- 0.003, 0.541 +- 0.007
Faith. Armon (L1)= 		  =  0.360 +- 0.068, 0.213 +- 0.031, 0.161 +- 0.021, 0.151 +- 0.023
Faith. GMean (L1)= 	  =  0.422 +- 0.039, 0.325 +- 0.024, 0.285 +- 0.019, 0.285 +- 0.023
Faith. Aritm (KL)= 		  =  0.496 +- 0.007, 0.496 +- 0.002, 0.508 +- 0.004, 0.534 +- 0.011
Faith. Armon (KL)= 		  =  0.246 +- 0.070, 0.168 +- 0.048, 0.139 +- 0.037, 0.128 +- 0.038
Faith. GMean (KL)= 	  =  0.345 +- 0.052, 0.285 +- 0.040, 0.264 +- 0.036, 0.259 +- 0.041

Eval split test
Faith. Aritm (L1)= 		  =  0.508 +- 0.004, 0.504 +- 0.004, 0.512 +- 0.006, 0.567 +- 0.011
Faith. Armon (L1)= 		  =  0.403 +- 0.056, 0.304 +- 0.040, 0.247 +- 0.033, 0.236 +- 0.034
Faith. GMean (L1)= 	  =  0.451 +- 0.032, 0.391 +- 0.027, 0.355 +- 0.026, 0.365 +- 0.030
Faith. Aritm (KL)= 		  =  0.504 +- 0.005, 0.502 +- 0.005, 0.513 +- 0.009, 0.548 +- 0.016
Faith. Armon (KL)= 		  =  0.281 +- 0.077, 0.231 +- 0.066, 0.188 +- 0.055, 0.173 +- 0.053
Faith. GMean (KL)= 	  =  0.372 +- 0.056, 0.337 +- 0.049, 0.307 +- 0.048, 0.305 +- 0.052
Computed for split load_split = id



Completed in  0:23:43.735800  for GSATvGIN LBAPcore/assay



DONE GSAT LBAPcore/assay
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 17:59:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 05:59:09 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 05:59:39 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 05:59:49 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 05:59:59 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:00:15 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:00:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ROC-AUC: 0.9575
Train Loss: 0.1735
ID Validation ROC-AUC: 0.9126
ID Validation Loss: 0.2431
ID Test ROC-AUC: 0.9180
ID Test Loss: 0.2370
OOD Validation ROC-AUC: 0.6443
OOD Validation Loss: 0.5116
OOD Test ROC-AUC: 0.6826
OOD Test Loss: 0.6087

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ROC-AUC: 0.9308
Train Loss: 0.2188
ID Validation ROC-AUC: 0.9073
ID Validation Loss: 0.2593
ID Test ROC-AUC: 0.9108
ID Test Loss: 0.2562
OOD Validation ROC-AUC: 0.6898
OOD Validation Loss: 0.3322
OOD Test ROC-AUC: 0.7117
OOD Test Loss: 0.5314

[0m[1;37mINFO[0m: [1mChartInfo 0.9180 0.6826 0.9108 0.7117 0.9073 0.6898[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:00:31 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:00:36 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.805
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.711
SUFF++ for r=0.3 class 0.0 = 0.611 +- 0.243 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.3 class 1.0 = 0.845 +- 0.243 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.3 all KL = 0.782 +- 0.243 (in-sample avg dev_std = 0.373)
SUFF++ for r=0.3 all L1 = 0.817 +- 0.186 (in-sample avg dev_std = 0.373)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.873
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.782
SUFF++ for r=0.6 class 0.0 = 0.617 +- 0.207 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 class 1.0 = 0.844 +- 0.207 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 all KL = 0.811 +- 0.207 (in-sample avg dev_std = 0.350)
SUFF++ for r=0.6 all L1 = 0.817 +- 0.175 (in-sample avg dev_std = 0.350)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.898
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.821
SUFF++ for r=0.9 class 0.0 = 0.714 +- 0.187 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 class 1.0 = 0.873 +- 0.187 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all KL = 0.881 +- 0.187 (in-sample avg dev_std = 0.265)
SUFF++ for r=0.9 all L1 = 0.854 +- 0.165 (in-sample avg dev_std = 0.265)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.607
SUFF++ for r=0.3 class 0.0 = 0.649 +- 0.241 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 class 1.0 = 0.764 +- 0.241 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 all KL = 0.719 +- 0.241 (in-sample avg dev_std = 0.417)
SUFF++ for r=0.3 all L1 = 0.745 +- 0.199 (in-sample avg dev_std = 0.417)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.685
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.638
SUFF++ for r=0.6 class 0.0 = 0.645 +- 0.200 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 class 1.0 = 0.761 +- 0.200 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all KL = 0.781 +- 0.200 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all L1 = 0.742 +- 0.184 (in-sample avg dev_std = 0.387)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.682
SUFF++ for r=0.9 class 0.0 = 0.725 +- 0.165 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.9 class 1.0 = 0.815 +- 0.165 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.9 all KL = 0.876 +- 0.165 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.9 all L1 = 0.8 +- 0.168 (in-sample avg dev_std = 0.285)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.805
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.756
NEC for r=0.3 class 0.0 = 0.44 +- 0.278 (in-sample avg dev_std = 0.359)
NEC for r=0.3 class 1.0 = 0.182 +- 0.278 (in-sample avg dev_std = 0.359)
NEC for r=0.3 all KL = 0.256 +- 0.278 (in-sample avg dev_std = 0.359)
NEC for r=0.3 all L1 = 0.212 +- 0.215 (in-sample avg dev_std = 0.359)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.874
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.785
NEC for r=0.6 class 0.0 = 0.408 +- 0.221 (in-sample avg dev_std = 0.331)
NEC for r=0.6 class 1.0 = 0.175 +- 0.221 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all KL = 0.201 +- 0.221 (in-sample avg dev_std = 0.331)
NEC for r=0.6 all L1 = 0.202 +- 0.194 (in-sample avg dev_std = 0.331)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.898
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.824
NEC for r=0.9 class 0.0 = 0.354 +- 0.189 (in-sample avg dev_std = 0.310)
NEC for r=0.9 class 1.0 = 0.167 +- 0.189 (in-sample avg dev_std = 0.310)
NEC for r=0.9 all KL = 0.168 +- 0.189 (in-sample avg dev_std = 0.310)
NEC for r=0.9 all L1 = 0.188 +- 0.167 (in-sample avg dev_std = 0.310)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.907
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.838
NEC for r=1.0 class 0.0 = 0.327 +- 0.178 (in-sample avg dev_std = 0.292)
NEC for r=1.0 class 1.0 = 0.147 +- 0.178 (in-sample avg dev_std = 0.292)
NEC for r=1.0 all KL = 0.148 +- 0.178 (in-sample avg dev_std = 0.292)
NEC for r=1.0 all L1 = 0.168 +- 0.160 (in-sample avg dev_std = 0.292)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.646
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.643
NEC for r=0.3 class 0.0 = 0.405 +- 0.281 (in-sample avg dev_std = 0.391)
NEC for r=0.3 class 1.0 = 0.262 +- 0.281 (in-sample avg dev_std = 0.391)
NEC for r=0.3 all KL = 0.309 +- 0.281 (in-sample avg dev_std = 0.391)
NEC for r=0.3 all L1 = 0.285 +- 0.233 (in-sample avg dev_std = 0.391)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.685
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.652
NEC for r=0.6 class 0.0 = 0.419 +- 0.232 (in-sample avg dev_std = 0.395)
NEC for r=0.6 class 1.0 = 0.271 +- 0.232 (in-sample avg dev_std = 0.395)
NEC for r=0.6 all KL = 0.265 +- 0.232 (in-sample avg dev_std = 0.395)
NEC for r=0.6 all L1 = 0.295 +- 0.200 (in-sample avg dev_std = 0.395)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.72
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.687
NEC for r=0.9 class 0.0 = 0.349 +- 0.173 (in-sample avg dev_std = 0.333)
NEC for r=0.9 class 1.0 = 0.238 +- 0.173 (in-sample avg dev_std = 0.333)
NEC for r=0.9 all KL = 0.184 +- 0.173 (in-sample avg dev_std = 0.333)
NEC for r=0.9 all L1 = 0.256 +- 0.173 (in-sample avg dev_std = 0.333)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.718
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.681
NEC for r=1.0 class 0.0 = 0.324 +- 0.177 (in-sample avg dev_std = 0.329)
NEC for r=1.0 class 1.0 = 0.228 +- 0.177 (in-sample avg dev_std = 0.329)
NEC for r=1.0 all KL = 0.175 +- 0.177 (in-sample avg dev_std = 0.329)
NEC for r=1.0 all L1 = 0.244 +- 0.173 (in-sample avg dev_std = 0.329)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:03:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:03:44 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:04:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:04:24 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:04:34 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:04:49 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 187...
[0m[1;37mINFO[0m: [1mCheckpoint 187: 
-----------------------------------
Train ROC-AUC: 0.9581
Train Loss: 0.1675
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2388
ID Test ROC-AUC: 0.9181
ID Test Loss: 0.2360
OOD Validation ROC-AUC: 0.6422
OOD Validation Loss: 0.5090
OOD Test ROC-AUC: 0.6891
OOD Test Loss: 0.6078

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9226
Train Loss: 0.2146
ID Validation ROC-AUC: 0.8997
ID Validation Loss: 0.2460
ID Test ROC-AUC: 0.9051
ID Test Loss: 0.2424
OOD Validation ROC-AUC: 0.6819
OOD Validation Loss: 0.3340
OOD Test ROC-AUC: 0.6983
OOD Test Loss: 0.4973

[0m[1;37mINFO[0m: [1mChartInfo 0.9181 0.6891 0.9051 0.6983 0.8997 0.6819[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:05:05 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:05:09 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.804
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.707
SUFF++ for r=0.3 class 0.0 = 0.624 +- 0.255 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 class 1.0 = 0.852 +- 0.255 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 all KL = 0.772 +- 0.255 (in-sample avg dev_std = 0.376)
SUFF++ for r=0.3 all L1 = 0.825 +- 0.188 (in-sample avg dev_std = 0.376)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.883
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.769
SUFF++ for r=0.6 class 0.0 = 0.585 +- 0.226 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 class 1.0 = 0.844 +- 0.226 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 all KL = 0.804 +- 0.226 (in-sample avg dev_std = 0.359)
SUFF++ for r=0.6 all L1 = 0.814 +- 0.187 (in-sample avg dev_std = 0.359)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.817
SUFF++ for r=0.9 class 0.0 = 0.686 +- 0.229 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 class 1.0 = 0.865 +- 0.229 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all KL = 0.855 +- 0.229 (in-sample avg dev_std = 0.308)
SUFF++ for r=0.9 all L1 = 0.844 +- 0.184 (in-sample avg dev_std = 0.308)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.645
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.605
SUFF++ for r=0.3 class 0.0 = 0.675 +- 0.257 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 class 1.0 = 0.765 +- 0.257 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 all KL = 0.708 +- 0.257 (in-sample avg dev_std = 0.439)
SUFF++ for r=0.3 all L1 = 0.75 +- 0.203 (in-sample avg dev_std = 0.439)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.686
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.636
SUFF++ for r=0.6 class 0.0 = 0.671 +- 0.212 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 class 1.0 = 0.768 +- 0.212 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all KL = 0.783 +- 0.212 (in-sample avg dev_std = 0.384)
SUFF++ for r=0.6 all L1 = 0.752 +- 0.191 (in-sample avg dev_std = 0.384)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.711
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.687
SUFF++ for r=0.9 class 0.0 = 0.745 +- 0.187 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.9 class 1.0 = 0.825 +- 0.187 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.9 all KL = 0.872 +- 0.187 (in-sample avg dev_std = 0.292)
SUFF++ for r=0.9 all L1 = 0.812 +- 0.175 (in-sample avg dev_std = 0.292)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.804
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.73
NEC for r=0.3 class 0.0 = 0.459 +- 0.280 (in-sample avg dev_std = 0.358)
NEC for r=0.3 class 1.0 = 0.163 +- 0.280 (in-sample avg dev_std = 0.358)
NEC for r=0.3 all KL = 0.248 +- 0.280 (in-sample avg dev_std = 0.358)
NEC for r=0.3 all L1 = 0.198 +- 0.219 (in-sample avg dev_std = 0.358)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.882
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.814
NEC for r=0.6 class 0.0 = 0.418 +- 0.239 (in-sample avg dev_std = 0.365)
NEC for r=0.6 class 1.0 = 0.178 +- 0.239 (in-sample avg dev_std = 0.365)
NEC for r=0.6 all KL = 0.217 +- 0.239 (in-sample avg dev_std = 0.365)
NEC for r=0.6 all L1 = 0.206 +- 0.197 (in-sample avg dev_std = 0.365)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.905
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.822
NEC for r=0.9 class 0.0 = 0.381 +- 0.219 (in-sample avg dev_std = 0.336)
NEC for r=0.9 class 1.0 = 0.162 +- 0.219 (in-sample avg dev_std = 0.336)
NEC for r=0.9 all KL = 0.19 +- 0.219 (in-sample avg dev_std = 0.336)
NEC for r=0.9 all L1 = 0.187 +- 0.177 (in-sample avg dev_std = 0.336)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.911
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.842
NEC for r=1.0 class 0.0 = 0.346 +- 0.214 (in-sample avg dev_std = 0.321)
NEC for r=1.0 class 1.0 = 0.148 +- 0.214 (in-sample avg dev_std = 0.321)
NEC for r=1.0 all KL = 0.173 +- 0.214 (in-sample avg dev_std = 0.321)
NEC for r=1.0 all L1 = 0.171 +- 0.172 (in-sample avg dev_std = 0.321)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.644
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.644
NEC for r=0.3 class 0.0 = 0.393 +- 0.287 (in-sample avg dev_std = 0.413)
NEC for r=0.3 class 1.0 = 0.256 +- 0.287 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all KL = 0.32 +- 0.287 (in-sample avg dev_std = 0.413)
NEC for r=0.3 all L1 = 0.279 +- 0.232 (in-sample avg dev_std = 0.413)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.686
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.656
NEC for r=0.6 class 0.0 = 0.401 +- 0.237 (in-sample avg dev_std = 0.405)
NEC for r=0.6 class 1.0 = 0.271 +- 0.237 (in-sample avg dev_std = 0.405)
NEC for r=0.6 all KL = 0.273 +- 0.237 (in-sample avg dev_std = 0.405)
NEC for r=0.6 all L1 = 0.293 +- 0.207 (in-sample avg dev_std = 0.405)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.711
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.684
NEC for r=0.9 class 0.0 = 0.343 +- 0.204 (in-sample avg dev_std = 0.376)
NEC for r=0.9 class 1.0 = 0.245 +- 0.204 (in-sample avg dev_std = 0.376)
NEC for r=0.9 all KL = 0.214 +- 0.204 (in-sample avg dev_std = 0.376)
NEC for r=0.9 all L1 = 0.261 +- 0.181 (in-sample avg dev_std = 0.376)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.718
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.684
NEC for r=1.0 class 0.0 = 0.337 +- 0.200 (in-sample avg dev_std = 0.358)
NEC for r=1.0 class 1.0 = 0.225 +- 0.200 (in-sample avg dev_std = 0.358)
NEC for r=1.0 all KL = 0.195 +- 0.200 (in-sample avg dev_std = 0.358)
NEC for r=1.0 all L1 = 0.244 +- 0.177 (in-sample avg dev_std = 0.358)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:08:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:08:16 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:08:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:08:57 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:23 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9565
Train Loss: 0.1673
ID Validation ROC-AUC: 0.9166
ID Validation Loss: 0.2335
ID Test ROC-AUC: 0.9184
ID Test Loss: 0.2312
OOD Validation ROC-AUC: 0.6443
OOD Validation Loss: 0.4868
OOD Test ROC-AUC: 0.6885
OOD Test Loss: 0.5753

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ROC-AUC: 0.8916
Train Loss: 0.2426
ID Validation ROC-AUC: 0.8768
ID Validation Loss: 0.2559
ID Test ROC-AUC: 0.8832
ID Test Loss: 0.2531
OOD Validation ROC-AUC: 0.6829
OOD Validation Loss: 0.2941
OOD Test ROC-AUC: 0.6934
OOD Test Loss: 0.4478

[0m[1;37mINFO[0m: [1mChartInfo 0.9184 0.6885 0.8832 0.6934 0.8768 0.6829[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:09:38 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:09:43 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.866
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.761
SUFF++ for r=0.3 class 0.0 = 0.596 +- 0.274 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.3 class 1.0 = 0.82 +- 0.274 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.3 all KL = 0.704 +- 0.274 (in-sample avg dev_std = 0.434)
SUFF++ for r=0.3 all L1 = 0.794 +- 0.183 (in-sample avg dev_std = 0.434)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.821
SUFF++ for r=0.6 class 0.0 = 0.644 +- 0.262 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 class 1.0 = 0.82 +- 0.262 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all KL = 0.738 +- 0.262 (in-sample avg dev_std = 0.419)
SUFF++ for r=0.6 all L1 = 0.799 +- 0.178 (in-sample avg dev_std = 0.419)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.83
SUFF++ for r=0.9 class 0.0 = 0.724 +- 0.248 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.9 class 1.0 = 0.842 +- 0.248 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.9 all KL = 0.826 +- 0.248 (in-sample avg dev_std = 0.325)
SUFF++ for r=0.9 all L1 = 0.829 +- 0.181 (in-sample avg dev_std = 0.325)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.638
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.619
SUFF++ for r=0.3 class 0.0 = 0.645 +- 0.266 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 class 1.0 = 0.733 +- 0.266 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 all KL = 0.663 +- 0.266 (in-sample avg dev_std = 0.486)
SUFF++ for r=0.3 all L1 = 0.718 +- 0.197 (in-sample avg dev_std = 0.486)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.651
SUFF++ for r=0.6 class 0.0 = 0.675 +- 0.243 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 class 1.0 = 0.748 +- 0.243 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all KL = 0.73 +- 0.243 (in-sample avg dev_std = 0.449)
SUFF++ for r=0.6 all L1 = 0.736 +- 0.177 (in-sample avg dev_std = 0.449)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.706
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.661
SUFF++ for r=0.9 class 0.0 = 0.742 +- 0.203 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 class 1.0 = 0.809 +- 0.203 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all KL = 0.855 +- 0.203 (in-sample avg dev_std = 0.305)
SUFF++ for r=0.9 all L1 = 0.798 +- 0.172 (in-sample avg dev_std = 0.305)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.866
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.799
NEC for r=0.3 class 0.0 = 0.466 +- 0.310 (in-sample avg dev_std = 0.412)
NEC for r=0.3 class 1.0 = 0.205 +- 0.310 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all KL = 0.313 +- 0.310 (in-sample avg dev_std = 0.412)
NEC for r=0.3 all L1 = 0.235 +- 0.227 (in-sample avg dev_std = 0.412)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.908
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.837
NEC for r=0.6 class 0.0 = 0.399 +- 0.287 (in-sample avg dev_std = 0.414)
NEC for r=0.6 class 1.0 = 0.205 +- 0.287 (in-sample avg dev_std = 0.414)
NEC for r=0.6 all KL = 0.287 +- 0.287 (in-sample avg dev_std = 0.414)
NEC for r=0.6 all L1 = 0.228 +- 0.205 (in-sample avg dev_std = 0.414)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.902
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.831
NEC for r=0.9 class 0.0 = 0.349 +- 0.239 (in-sample avg dev_std = 0.383)
NEC for r=0.9 class 1.0 = 0.203 +- 0.239 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all KL = 0.239 +- 0.239 (in-sample avg dev_std = 0.383)
NEC for r=0.9 all L1 = 0.22 +- 0.177 (in-sample avg dev_std = 0.383)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.914
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.845
NEC for r=1.0 class 0.0 = 0.316 +- 0.232 (in-sample avg dev_std = 0.363)
NEC for r=1.0 class 1.0 = 0.187 +- 0.232 (in-sample avg dev_std = 0.363)
NEC for r=1.0 all KL = 0.221 +- 0.232 (in-sample avg dev_std = 0.363)
NEC for r=1.0 all L1 = 0.202 +- 0.172 (in-sample avg dev_std = 0.363)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.638
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.651
NEC for r=0.3 class 0.0 = 0.428 +- 0.307 (in-sample avg dev_std = 0.464)
NEC for r=0.3 class 1.0 = 0.309 +- 0.307 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all KL = 0.387 +- 0.307 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all L1 = 0.328 +- 0.238 (in-sample avg dev_std = 0.464)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.688
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.667
NEC for r=0.6 class 0.0 = 0.4 +- 0.254 (in-sample avg dev_std = 0.439)
NEC for r=0.6 class 1.0 = 0.287 +- 0.254 (in-sample avg dev_std = 0.439)
NEC for r=0.6 all KL = 0.314 +- 0.254 (in-sample avg dev_std = 0.439)
NEC for r=0.6 all L1 = 0.306 +- 0.200 (in-sample avg dev_std = 0.439)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.706
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.669
NEC for r=0.9 class 0.0 = 0.338 +- 0.216 (in-sample avg dev_std = 0.375)
NEC for r=0.9 class 1.0 = 0.267 +- 0.216 (in-sample avg dev_std = 0.375)
NEC for r=0.9 all KL = 0.234 +- 0.216 (in-sample avg dev_std = 0.375)
NEC for r=0.9 all L1 = 0.278 +- 0.174 (in-sample avg dev_std = 0.375)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.709
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.677
NEC for r=1.0 class 0.0 = 0.318 +- 0.214 (in-sample avg dev_std = 0.360)
NEC for r=1.0 class 1.0 = 0.241 +- 0.214 (in-sample avg dev_std = 0.360)
NEC for r=1.0 all KL = 0.211 +- 0.214 (in-sample avg dev_std = 0.360)
NEC for r=1.0 all L1 = 0.254 +- 0.171 (in-sample avg dev_std = 0.360)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:12:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:12:51 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:13:21 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:13:31 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:13:41 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:13:57 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ROC-AUC: 0.9582
Train Loss: 0.1732
ID Validation ROC-AUC: 0.9167
ID Validation Loss: 0.2422
ID Test ROC-AUC: 0.9192
ID Test Loss: 0.2373
OOD Validation ROC-AUC: 0.6602
OOD Validation Loss: 0.5268
OOD Test ROC-AUC: 0.6848
OOD Test Loss: 0.6351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.8939
Train Loss: 0.2644
ID Validation ROC-AUC: 0.8796
ID Validation Loss: 0.2781
ID Test ROC-AUC: 0.8853
ID Test Loss: 0.2732
OOD Validation ROC-AUC: 0.6941
OOD Validation Loss: 0.3916
OOD Test ROC-AUC: 0.6881
OOD Test Loss: 0.4866

[0m[1;37mINFO[0m: [1mChartInfo 0.9192 0.6848 0.8853 0.6881 0.8796 0.6941[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:14:12 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:14:16 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.814
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.704
SUFF++ for r=0.3 class 0.0 = 0.609 +- 0.274 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.3 class 1.0 = 0.793 +- 0.274 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.3 all KL = 0.684 +- 0.274 (in-sample avg dev_std = 0.468)
SUFF++ for r=0.3 all L1 = 0.772 +- 0.190 (in-sample avg dev_std = 0.468)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.906
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.791
SUFF++ for r=0.6 class 0.0 = 0.632 +- 0.253 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 class 1.0 = 0.806 +- 0.253 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all KL = 0.738 +- 0.253 (in-sample avg dev_std = 0.437)
SUFF++ for r=0.6 all L1 = 0.786 +- 0.184 (in-sample avg dev_std = 0.437)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.836
SUFF++ for r=0.9 class 0.0 = 0.711 +- 0.233 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 class 1.0 = 0.845 +- 0.233 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 all KL = 0.838 +- 0.233 (in-sample avg dev_std = 0.323)
SUFF++ for r=0.9 all L1 = 0.829 +- 0.182 (in-sample avg dev_std = 0.323)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.687
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.622
SUFF++ for r=0.3 class 0.0 = 0.619 +- 0.264 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 class 1.0 = 0.726 +- 0.264 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all KL = 0.658 +- 0.264 (in-sample avg dev_std = 0.498)
SUFF++ for r=0.3 all L1 = 0.708 +- 0.199 (in-sample avg dev_std = 0.498)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.645
SUFF++ for r=0.6 class 0.0 = 0.634 +- 0.233 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 class 1.0 = 0.726 +- 0.233 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all KL = 0.714 +- 0.233 (in-sample avg dev_std = 0.465)
SUFF++ for r=0.6 all L1 = 0.71 +- 0.183 (in-sample avg dev_std = 0.465)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.716
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.667
SUFF++ for r=0.9 class 0.0 = 0.717 +- 0.212 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 class 1.0 = 0.78 +- 0.212 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 all KL = 0.829 +- 0.212 (in-sample avg dev_std = 0.345)
SUFF++ for r=0.9 all L1 = 0.77 +- 0.192 (in-sample avg dev_std = 0.345)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.814
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.771
NEC for r=0.3 class 0.0 = 0.435 +- 0.310 (in-sample avg dev_std = 0.421)
NEC for r=0.3 class 1.0 = 0.21 +- 0.310 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all KL = 0.303 +- 0.310 (in-sample avg dev_std = 0.421)
NEC for r=0.3 all L1 = 0.236 +- 0.226 (in-sample avg dev_std = 0.421)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.906
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.821
NEC for r=0.6 class 0.0 = 0.391 +- 0.267 (in-sample avg dev_std = 0.424)
NEC for r=0.6 class 1.0 = 0.214 +- 0.267 (in-sample avg dev_std = 0.424)
NEC for r=0.6 all KL = 0.28 +- 0.267 (in-sample avg dev_std = 0.424)
NEC for r=0.6 all L1 = 0.235 +- 0.203 (in-sample avg dev_std = 0.424)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.92
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.835
NEC for r=0.9 class 0.0 = 0.312 +- 0.238 (in-sample avg dev_std = 0.396)
NEC for r=0.9 class 1.0 = 0.214 +- 0.238 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all KL = 0.24 +- 0.238 (in-sample avg dev_std = 0.396)
NEC for r=0.9 all L1 = 0.226 +- 0.178 (in-sample avg dev_std = 0.396)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.924
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.847
NEC for r=1.0 class 0.0 = 0.302 +- 0.234 (in-sample avg dev_std = 0.382)
NEC for r=1.0 class 1.0 = 0.195 +- 0.234 (in-sample avg dev_std = 0.382)
NEC for r=1.0 all KL = 0.225 +- 0.234 (in-sample avg dev_std = 0.382)
NEC for r=1.0 all L1 = 0.207 +- 0.172 (in-sample avg dev_std = 0.382)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.687
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.633
NEC for r=0.3 class 0.0 = 0.473 +- 0.308 (in-sample avg dev_std = 0.476)
NEC for r=0.3 class 1.0 = 0.317 +- 0.308 (in-sample avg dev_std = 0.476)
NEC for r=0.3 all KL = 0.396 +- 0.308 (in-sample avg dev_std = 0.476)
NEC for r=0.3 all L1 = 0.343 +- 0.239 (in-sample avg dev_std = 0.476)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.658
NEC for r=0.6 class 0.0 = 0.42 +- 0.259 (in-sample avg dev_std = 0.452)
NEC for r=0.6 class 1.0 = 0.31 +- 0.259 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all KL = 0.325 +- 0.259 (in-sample avg dev_std = 0.452)
NEC for r=0.6 all L1 = 0.329 +- 0.212 (in-sample avg dev_std = 0.452)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.716
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.684
NEC for r=0.9 class 0.0 = 0.366 +- 0.220 (in-sample avg dev_std = 0.413)
NEC for r=0.9 class 1.0 = 0.287 +- 0.220 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all KL = 0.254 +- 0.220 (in-sample avg dev_std = 0.413)
NEC for r=0.9 all L1 = 0.3 +- 0.183 (in-sample avg dev_std = 0.413)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.721
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.676
NEC for r=1.0 class 0.0 = 0.347 +- 0.210 (in-sample avg dev_std = 0.394)
NEC for r=1.0 class 1.0 = 0.264 +- 0.210 (in-sample avg dev_std = 0.394)
NEC for r=1.0 all KL = 0.231 +- 0.210 (in-sample avg dev_std = 0.394)
NEC for r=1.0 all L1 = 0.277 +- 0.178 (in-sample avg dev_std = 0.394)
model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:17:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:17:25 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:17:55 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:15 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:30 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:18:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ROC-AUC: 0.9582
Train Loss: 0.1714
ID Validation ROC-AUC: 0.9187
ID Validation Loss: 0.2342
ID Test ROC-AUC: 0.9179
ID Test Loss: 0.2354
OOD Validation ROC-AUC: 0.6444
OOD Validation Loss: 0.5164
OOD Test ROC-AUC: 0.6886
OOD Test Loss: 0.5929

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ROC-AUC: 0.9287
Train Loss: 0.2120
ID Validation ROC-AUC: 0.9078
ID Validation Loss: 0.2413
ID Test ROC-AUC: 0.9121
ID Test Loss: 0.2387
OOD Validation ROC-AUC: 0.6847
OOD Validation Loss: 0.3180
OOD Test ROC-AUC: 0.7131
OOD Test Loss: 0.4739

[0m[1;37mINFO[0m: [1mChartInfo 0.9179 0.6886 0.9121 0.7131 0.9078 0.6847[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:18:46 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:18:50 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.872
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.737
SUFF++ for r=0.3 class 0.0 = 0.611 +- 0.258 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 class 1.0 = 0.781 +- 0.258 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all KL = 0.688 +- 0.258 (in-sample avg dev_std = 0.454)
SUFF++ for r=0.3 all L1 = 0.761 +- 0.179 (in-sample avg dev_std = 0.454)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.912
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.812
SUFF++ for r=0.6 class 0.0 = 0.659 +- 0.249 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 class 1.0 = 0.799 +- 0.249 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 all KL = 0.739 +- 0.249 (in-sample avg dev_std = 0.424)
SUFF++ for r=0.6 all L1 = 0.783 +- 0.172 (in-sample avg dev_std = 0.424)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.837
SUFF++ for r=0.9 class 0.0 = 0.761 +- 0.235 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 class 1.0 = 0.832 +- 0.235 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all KL = 0.831 +- 0.235 (in-sample avg dev_std = 0.324)
SUFF++ for r=0.9 all L1 = 0.823 +- 0.175 (in-sample avg dev_std = 0.324)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.67
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.605
SUFF++ for r=0.3 class 0.0 = 0.634 +- 0.249 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 class 1.0 = 0.717 +- 0.249 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 all KL = 0.669 +- 0.249 (in-sample avg dev_std = 0.475)
SUFF++ for r=0.3 all L1 = 0.703 +- 0.180 (in-sample avg dev_std = 0.475)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.661
SUFF++ for r=0.6 class 0.0 = 0.653 +- 0.233 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 class 1.0 = 0.728 +- 0.233 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all KL = 0.723 +- 0.233 (in-sample avg dev_std = 0.446)
SUFF++ for r=0.6 all L1 = 0.715 +- 0.172 (in-sample avg dev_std = 0.446)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.725
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.681
SUFF++ for r=0.9 class 0.0 = 0.741 +- 0.209 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 class 1.0 = 0.787 +- 0.209 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 all KL = 0.838 +- 0.209 (in-sample avg dev_std = 0.321)
SUFF++ for r=0.9 all L1 = 0.779 +- 0.172 (in-sample avg dev_std = 0.321)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.872
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.773
NEC for r=0.3 class 0.0 = 0.459 +- 0.288 (in-sample avg dev_std = 0.411)
NEC for r=0.3 class 1.0 = 0.234 +- 0.288 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all KL = 0.325 +- 0.288 (in-sample avg dev_std = 0.411)
NEC for r=0.3 all L1 = 0.26 +- 0.215 (in-sample avg dev_std = 0.411)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.912
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.81
NEC for r=0.6 class 0.0 = 0.37 +- 0.255 (in-sample avg dev_std = 0.399)
NEC for r=0.6 class 1.0 = 0.22 +- 0.255 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all KL = 0.276 +- 0.255 (in-sample avg dev_std = 0.399)
NEC for r=0.6 all L1 = 0.238 +- 0.191 (in-sample avg dev_std = 0.399)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.915
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.832
NEC for r=0.9 class 0.0 = 0.318 +- 0.221 (in-sample avg dev_std = 0.371)
NEC for r=0.9 class 1.0 = 0.211 +- 0.221 (in-sample avg dev_std = 0.371)
NEC for r=0.9 all KL = 0.23 +- 0.221 (in-sample avg dev_std = 0.371)
NEC for r=0.9 all L1 = 0.223 +- 0.166 (in-sample avg dev_std = 0.371)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.916
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.829
NEC for r=1.0 class 0.0 = 0.314 +- 0.231 (in-sample avg dev_std = 0.361)
NEC for r=1.0 class 1.0 = 0.201 +- 0.231 (in-sample avg dev_std = 0.361)
NEC for r=1.0 all KL = 0.221 +- 0.231 (in-sample avg dev_std = 0.361)
NEC for r=1.0 all L1 = 0.214 +- 0.170 (in-sample avg dev_std = 0.361)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.67
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.634
NEC for r=0.3 class 0.0 = 0.447 +- 0.290 (in-sample avg dev_std = 0.464)
NEC for r=0.3 class 1.0 = 0.33 +- 0.290 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all KL = 0.388 +- 0.290 (in-sample avg dev_std = 0.464)
NEC for r=0.3 all L1 = 0.35 +- 0.215 (in-sample avg dev_std = 0.464)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.729
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.658
NEC for r=0.6 class 0.0 = 0.407 +- 0.255 (in-sample avg dev_std = 0.443)
NEC for r=0.6 class 1.0 = 0.324 +- 0.255 (in-sample avg dev_std = 0.443)
NEC for r=0.6 all KL = 0.332 +- 0.255 (in-sample avg dev_std = 0.443)
NEC for r=0.6 all L1 = 0.338 +- 0.192 (in-sample avg dev_std = 0.443)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.725
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.666
NEC for r=0.9 class 0.0 = 0.346 +- 0.210 (in-sample avg dev_std = 0.382)
NEC for r=0.9 class 1.0 = 0.28 +- 0.210 (in-sample avg dev_std = 0.382)
NEC for r=0.9 all KL = 0.239 +- 0.210 (in-sample avg dev_std = 0.382)
NEC for r=0.9 all L1 = 0.291 +- 0.171 (in-sample avg dev_std = 0.382)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.732
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.676
NEC for r=1.0 class 0.0 = 0.316 +- 0.205 (in-sample avg dev_std = 0.377)
NEC for r=1.0 class 1.0 = 0.264 +- 0.205 (in-sample avg dev_std = 0.377)
NEC for r=1.0 all KL = 0.221 +- 0.205 (in-sample avg dev_std = 0.377)
NEC for r=1.0 all L1 = 0.273 +- 0.166 (in-sample avg dev_std = 0.377)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.782, 0.811, 0.881, 1.0], 'all_L1': [0.817, 0.817, 0.854, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.772, 0.804, 0.855, 1.0], 'all_L1': [0.825, 0.814, 0.844, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.704, 0.738, 0.826, 1.0], 'all_L1': [0.794, 0.799, 0.829, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.684, 0.738, 0.838, 1.0], 'all_L1': [0.772, 0.786, 0.829, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.688, 0.739, 0.831, 1.0], 'all_L1': [0.761, 0.783, 0.823, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.256, 0.201, 0.168, 0.148], 'all_L1': [0.212, 0.202, 0.188, 0.168]}), defaultdict(<class 'list'>, {'all_KL': [0.248, 0.217, 0.19, 0.173], 'all_L1': [0.198, 0.206, 0.187, 0.171]}), defaultdict(<class 'list'>, {'all_KL': [0.313, 0.287, 0.239, 0.221], 'all_L1': [0.235, 0.228, 0.22, 0.202]}), defaultdict(<class 'list'>, {'all_KL': [0.303, 0.28, 0.24, 0.225], 'all_L1': [0.236, 0.235, 0.226, 0.207]}), defaultdict(<class 'list'>, {'all_KL': [0.325, 0.276, 0.23, 0.221], 'all_L1': [0.26, 0.238, 0.223, 0.214]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.719, 0.781, 0.876, 1.0], 'all_L1': [0.745, 0.742, 0.8, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.708, 0.783, 0.872, 1.0], 'all_L1': [0.75, 0.752, 0.812, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.663, 0.73, 0.855, 1.0], 'all_L1': [0.718, 0.736, 0.798, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.658, 0.714, 0.829, 1.0], 'all_L1': [0.708, 0.71, 0.77, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.669, 0.723, 0.838, 1.0], 'all_L1': [0.703, 0.715, 0.779, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.309, 0.265, 0.184, 0.175], 'all_L1': [0.285, 0.295, 0.256, 0.244]}), defaultdict(<class 'list'>, {'all_KL': [0.32, 0.273, 0.214, 0.195], 'all_L1': [0.279, 0.293, 0.261, 0.244]}), defaultdict(<class 'list'>, {'all_KL': [0.387, 0.314, 0.234, 0.211], 'all_L1': [0.328, 0.306, 0.278, 0.254]}), defaultdict(<class 'list'>, {'all_KL': [0.396, 0.325, 0.254, 0.231], 'all_L1': [0.343, 0.329, 0.3, 0.277]}), defaultdict(<class 'list'>, {'all_KL': [0.388, 0.332, 0.239, 0.221], 'all_L1': [0.35, 0.338, 0.291, 0.273]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.794 +- 0.025, 0.800 +- 0.014, 0.836 +- 0.011, 1.000 +- 0.000
suff++ class all_KL  =  0.726 +- 0.042, 0.766 +- 0.034, 0.846 +- 0.020, 1.000 +- 0.000
suff++_acc_int  =  0.724 +- 0.022, 0.795 +- 0.019, 0.828 +- 0.008
nec class all_L1  =  0.228 +- 0.021, 0.222 +- 0.015, 0.209 +- 0.017, 0.192 +- 0.019
nec class all_KL  =  0.289 +- 0.031, 0.252 +- 0.036, 0.213 +- 0.029, 0.198 +- 0.031
nec_acc_int  =  0.766 +- 0.023, 0.813 +- 0.017, 0.829 +- 0.005, 0.840 +- 0.006

Eval split test
suff++ class all_L1  =  0.725 +- 0.019, 0.731 +- 0.016, 0.792 +- 0.015, 1.000 +- 0.000
suff++ class all_KL  =  0.683 +- 0.025, 0.746 +- 0.030, 0.854 +- 0.018, 1.000 +- 0.000
suff++_acc_int  =  0.612 +- 0.007, 0.646 +- 0.009, 0.676 +- 0.010
nec class all_L1  =  0.317 +- 0.030, 0.312 +- 0.018, 0.277 +- 0.017, 0.258 +- 0.014
nec class all_KL  =  0.360 +- 0.037, 0.302 +- 0.028, 0.225 +- 0.024, 0.207 +- 0.020
nec_acc_int  =  0.641 +- 0.007, 0.658 +- 0.005, 0.678 +- 0.009, 0.679 +- 0.003


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.511 +- 0.004, 0.511 +- 0.001, 0.522 +- 0.004, 0.596 +- 0.010
Faith. Armon (L1)= 		  =  0.354 +- 0.023, 0.347 +- 0.017, 0.334 +- 0.022, 0.322 +- 0.027
Faith. GMean (L1)= 	  =  0.425 +- 0.014, 0.421 +- 0.011, 0.417 +- 0.015, 0.438 +- 0.022
Faith. Aritm (KL)= 		  =  0.508 +- 0.008, 0.509 +- 0.002, 0.530 +- 0.006, 0.599 +- 0.016
Faith. Armon (KL)= 		  =  0.411 +- 0.026, 0.377 +- 0.037, 0.339 +- 0.036, 0.329 +- 0.044
Faith. GMean (KL)= 	  =  0.457 +- 0.013, 0.438 +- 0.023, 0.424 +- 0.025, 0.443 +- 0.036

Eval split test
Faith. Aritm (L1)= 		  =  0.521 +- 0.005, 0.522 +- 0.003, 0.534 +- 0.003, 0.629 +- 0.007
Faith. Armon (L1)= 		  =  0.440 +- 0.025, 0.437 +- 0.015, 0.410 +- 0.017, 0.410 +- 0.018
Faith. GMean (L1)= 	  =  0.478 +- 0.016, 0.477 +- 0.009, 0.468 +- 0.010, 0.508 +- 0.014
Faith. Aritm (KL)= 		  =  0.522 +- 0.006, 0.524 +- 0.003, 0.539 +- 0.005, 0.603 +- 0.010
Faith. Armon (KL)= 		  =  0.469 +- 0.027, 0.428 +- 0.024, 0.355 +- 0.029, 0.342 +- 0.027
Faith. GMean (KL)= 	  =  0.495 +- 0.017, 0.474 +- 0.013, 0.437 +- 0.020, 0.454 +- 0.022
Computed for split load_split = id



Completed in  0:22:50.531357  for GSATGIN LBAPcore/assay



DONE GSAT LBAPcore/assay LA
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:22:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:22:12 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:22:43 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:22:53 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:03 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:19 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:23:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 185...
[0m[1;37mINFO[0m: [1mCheckpoint 185: 
-----------------------------------
Train ROC-AUC: 0.9790
Train Loss: 0.1210
ID Validation ROC-AUC: 0.9202
ID Validation Loss: 0.2663
ID Test ROC-AUC: 0.9191
ID Test Loss: 0.2695
OOD Validation ROC-AUC: 0.6372
OOD Validation Loss: 0.5165
OOD Test ROC-AUC: 0.6873
OOD Test Loss: 0.6912

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ROC-AUC: 0.8266
Train Loss: 0.7015
ID Validation ROC-AUC: 0.8256
ID Validation Loss: 0.7089
ID Test ROC-AUC: 0.8216
ID Test Loss: 0.7167
OOD Validation ROC-AUC: 0.7019
OOD Validation Loss: 0.4065
OOD Test ROC-AUC: 0.7079
OOD Test Loss: 0.4708

[0m[1;37mINFO[0m: [1mChartInfo 0.9191 0.6873 0.8216 0.7079 0.8256 0.7019[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:23:36 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:23:41 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.779
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.728
SUFF++ for r=0.3 class 0.0 = 0.778 +- 0.083 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.3 class 1.0 = 0.911 +- 0.083 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.3 all KL = 0.946 +- 0.083 (in-sample avg dev_std = 0.160)
SUFF++ for r=0.3 all L1 = 0.896 +- 0.128 (in-sample avg dev_std = 0.160)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.812
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.785
SUFF++ for r=0.6 class 0.0 = 0.815 +- 0.063 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.6 class 1.0 = 0.949 +- 0.063 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.6 all KL = 0.971 +- 0.063 (in-sample avg dev_std = 0.119)
SUFF++ for r=0.6 all L1 = 0.933 +- 0.115 (in-sample avg dev_std = 0.119)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.808
SUFF++ for r=0.9 class 0.0 = 0.881 +- 0.045 (in-sample avg dev_std = 0.081)
SUFF++ for r=0.9 class 1.0 = 0.964 +- 0.045 (in-sample avg dev_std = 0.081)
SUFF++ for r=0.9 all KL = 0.984 +- 0.045 (in-sample avg dev_std = 0.081)
SUFF++ for r=0.9 all L1 = 0.954 +- 0.088 (in-sample avg dev_std = 0.081)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.667
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.635
SUFF++ for r=0.3 class 0.0 = 0.787 +- 0.106 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.3 class 1.0 = 0.864 +- 0.106 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.3 all KL = 0.919 +- 0.106 (in-sample avg dev_std = 0.217)
SUFF++ for r=0.3 all L1 = 0.851 +- 0.157 (in-sample avg dev_std = 0.217)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.672
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.666
SUFF++ for r=0.6 class 0.0 = 0.836 +- 0.088 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.6 class 1.0 = 0.899 +- 0.088 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.6 all KL = 0.946 +- 0.088 (in-sample avg dev_std = 0.169)
SUFF++ for r=0.6 all L1 = 0.889 +- 0.148 (in-sample avg dev_std = 0.169)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.683
SUFF++ for r=0.9 class 0.0 = 0.879 +- 0.062 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 class 1.0 = 0.933 +- 0.062 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all KL = 0.972 +- 0.062 (in-sample avg dev_std = 0.117)
SUFF++ for r=0.9 all L1 = 0.924 +- 0.113 (in-sample avg dev_std = 0.117)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.779
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.743
NEC for r=0.3 class 0.0 = 0.248 +- 0.102 (in-sample avg dev_std = 0.153)
NEC for r=0.3 class 1.0 = 0.109 +- 0.102 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all KL = 0.072 +- 0.102 (in-sample avg dev_std = 0.153)
NEC for r=0.3 all L1 = 0.125 +- 0.140 (in-sample avg dev_std = 0.153)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.812
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.798
NEC for r=0.6 class 0.0 = 0.178 +- 0.071 (in-sample avg dev_std = 0.128)
NEC for r=0.6 class 1.0 = 0.057 +- 0.071 (in-sample avg dev_std = 0.128)
NEC for r=0.6 all KL = 0.034 +- 0.071 (in-sample avg dev_std = 0.128)
NEC for r=0.6 all L1 = 0.071 +- 0.113 (in-sample avg dev_std = 0.128)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.83
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.811
NEC for r=0.9 class 0.0 = 0.123 +- 0.047 (in-sample avg dev_std = 0.089)
NEC for r=0.9 class 1.0 = 0.036 +- 0.047 (in-sample avg dev_std = 0.089)
NEC for r=0.9 all KL = 0.017 +- 0.047 (in-sample avg dev_std = 0.089)
NEC for r=0.9 all L1 = 0.047 +- 0.084 (in-sample avg dev_std = 0.089)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.827
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.812
NEC for r=1.0 class 0.0 = 0.12 +- 0.043 (in-sample avg dev_std = 0.083)
NEC for r=1.0 class 1.0 = 0.031 +- 0.043 (in-sample avg dev_std = 0.083)
NEC for r=1.0 all KL = 0.014 +- 0.043 (in-sample avg dev_std = 0.083)
NEC for r=1.0 all L1 = 0.041 +- 0.078 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.667
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.644
NEC for r=0.3 class 0.0 = 0.237 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 class 1.0 = 0.169 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 all KL = 0.108 +- 0.141 (in-sample avg dev_std = 0.205)
NEC for r=0.3 all L1 = 0.18 +- 0.179 (in-sample avg dev_std = 0.205)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.672
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.672
NEC for r=0.6 class 0.0 = 0.171 +- 0.105 (in-sample avg dev_std = 0.170)
NEC for r=0.6 class 1.0 = 0.11 +- 0.105 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all KL = 0.063 +- 0.105 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all L1 = 0.12 +- 0.154 (in-sample avg dev_std = 0.170)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.689
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.683
NEC for r=0.9 class 0.0 = 0.12 +- 0.066 (in-sample avg dev_std = 0.120)
NEC for r=0.9 class 1.0 = 0.074 +- 0.066 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all KL = 0.032 +- 0.066 (in-sample avg dev_std = 0.120)
NEC for r=0.9 all L1 = 0.082 +- 0.116 (in-sample avg dev_std = 0.120)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.694
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.689
NEC for r=1.0 class 0.0 = 0.109 +- 0.058 (in-sample avg dev_std = 0.107)
NEC for r=1.0 class 1.0 = 0.065 +- 0.058 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all KL = 0.027 +- 0.058 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all L1 = 0.072 +- 0.107 (in-sample avg dev_std = 0.107)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:26:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:26:51 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:27:22 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:27:32 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:27:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:27:58 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:28:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9730
Train Loss: 0.1349
ID Validation ROC-AUC: 0.9206
ID Validation Loss: 0.2729
ID Test ROC-AUC: 0.9183
ID Test Loss: 0.2776
OOD Validation ROC-AUC: 0.6535
OOD Validation Loss: 0.5572
OOD Test ROC-AUC: 0.7044
OOD Test Loss: 0.7172

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ROC-AUC: 0.8666
Train Loss: 0.3770
ID Validation ROC-AUC: 0.8640
ID Validation Loss: 0.3811
ID Test ROC-AUC: 0.8657
ID Test Loss: 0.3851
OOD Validation ROC-AUC: 0.6952
OOD Validation Loss: 0.3144
OOD Test ROC-AUC: 0.7141
OOD Test Loss: 0.5763

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.7044 0.8657 0.7141 0.8640 0.6952[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:28:15 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:28:19 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.718
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.624
SUFF++ for r=0.3 class 0.0 = 0.756 +- 0.088 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.3 class 1.0 = 0.845 +- 0.088 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.3 all KL = 0.911 +- 0.088 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.3 all L1 = 0.834 +- 0.134 (in-sample avg dev_std = 0.182)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.698
SUFF++ for r=0.6 class 0.0 = 0.914 +- 0.062 (in-sample avg dev_std = 0.081)
SUFF++ for r=0.6 class 1.0 = 0.976 +- 0.062 (in-sample avg dev_std = 0.081)
SUFF++ for r=0.6 all KL = 0.979 +- 0.062 (in-sample avg dev_std = 0.081)
SUFF++ for r=0.6 all L1 = 0.969 +- 0.084 (in-sample avg dev_std = 0.081)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.8
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.777
SUFF++ for r=0.9 class 0.0 = 0.965 +- 0.021 (in-sample avg dev_std = 0.030)
SUFF++ for r=0.9 class 1.0 = 0.993 +- 0.021 (in-sample avg dev_std = 0.030)
SUFF++ for r=0.9 all KL = 0.996 +- 0.021 (in-sample avg dev_std = 0.030)
SUFF++ for r=0.9 all L1 = 0.99 +- 0.043 (in-sample avg dev_std = 0.030)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.562
SUFF++ for r=0.3 class 0.0 = 0.758 +- 0.089 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.3 class 1.0 = 0.812 +- 0.089 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.3 all KL = 0.896 +- 0.089 (in-sample avg dev_std = 0.201)
SUFF++ for r=0.3 all L1 = 0.803 +- 0.129 (in-sample avg dev_std = 0.201)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.628
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.603
SUFF++ for r=0.6 class 0.0 = 0.919 +- 0.067 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.6 class 1.0 = 0.962 +- 0.067 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.6 all KL = 0.972 +- 0.067 (in-sample avg dev_std = 0.099)
SUFF++ for r=0.6 all L1 = 0.955 +- 0.100 (in-sample avg dev_std = 0.099)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.661
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.643
SUFF++ for r=0.9 class 0.0 = 0.968 +- 0.042 (in-sample avg dev_std = 0.052)
SUFF++ for r=0.9 class 1.0 = 0.987 +- 0.042 (in-sample avg dev_std = 0.052)
SUFF++ for r=0.9 all KL = 0.992 +- 0.042 (in-sample avg dev_std = 0.052)
SUFF++ for r=0.9 all L1 = 0.984 +- 0.058 (in-sample avg dev_std = 0.052)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.718
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.688
NEC for r=0.3 class 0.0 = 0.207 +- 0.094 (in-sample avg dev_std = 0.162)
NEC for r=0.3 class 1.0 = 0.152 +- 0.094 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all KL = 0.083 +- 0.094 (in-sample avg dev_std = 0.162)
NEC for r=0.3 all L1 = 0.158 +- 0.125 (in-sample avg dev_std = 0.162)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.755
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.772
NEC for r=0.6 class 0.0 = 0.083 +- 0.060 (in-sample avg dev_std = 0.084)
NEC for r=0.6 class 1.0 = 0.025 +- 0.060 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all KL = 0.021 +- 0.060 (in-sample avg dev_std = 0.084)
NEC for r=0.6 all L1 = 0.031 +- 0.078 (in-sample avg dev_std = 0.084)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.8
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.802
NEC for r=0.9 class 0.0 = 0.04 +- 0.038 (in-sample avg dev_std = 0.051)
NEC for r=0.9 class 1.0 = 0.01 +- 0.038 (in-sample avg dev_std = 0.051)
NEC for r=0.9 all KL = 0.008 +- 0.038 (in-sample avg dev_std = 0.051)
NEC for r=0.9 all L1 = 0.014 +- 0.055 (in-sample avg dev_std = 0.051)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.804
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.805
NEC for r=1.0 class 0.0 = 0.035 +- 0.025 (in-sample avg dev_std = 0.044)
NEC for r=1.0 class 1.0 = 0.008 +- 0.025 (in-sample avg dev_std = 0.044)
NEC for r=1.0 all KL = 0.005 +- 0.025 (in-sample avg dev_std = 0.044)
NEC for r=1.0 all L1 = 0.011 +- 0.045 (in-sample avg dev_std = 0.044)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.608
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.623
NEC for r=0.3 class 0.0 = 0.203 +- 0.096 (in-sample avg dev_std = 0.164)
NEC for r=0.3 class 1.0 = 0.172 +- 0.096 (in-sample avg dev_std = 0.164)
NEC for r=0.3 all KL = 0.086 +- 0.096 (in-sample avg dev_std = 0.164)
NEC for r=0.3 all L1 = 0.177 +- 0.124 (in-sample avg dev_std = 0.164)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.628
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.647
NEC for r=0.6 class 0.0 = 0.08 +- 0.075 (in-sample avg dev_std = 0.096)
NEC for r=0.6 class 1.0 = 0.04 +- 0.075 (in-sample avg dev_std = 0.096)
NEC for r=0.6 all KL = 0.03 +- 0.075 (in-sample avg dev_std = 0.096)
NEC for r=0.6 all L1 = 0.047 +- 0.096 (in-sample avg dev_std = 0.096)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.661
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.651
NEC for r=0.9 class 0.0 = 0.041 +- 0.043 (in-sample avg dev_std = 0.063)
NEC for r=0.9 class 1.0 = 0.016 +- 0.043 (in-sample avg dev_std = 0.063)
NEC for r=0.9 all KL = 0.012 +- 0.043 (in-sample avg dev_std = 0.063)
NEC for r=0.9 all L1 = 0.02 +- 0.061 (in-sample avg dev_std = 0.063)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.649
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.659
NEC for r=1.0 class 0.0 = 0.044 +- 0.037 (in-sample avg dev_std = 0.056)
NEC for r=1.0 class 1.0 = 0.014 +- 0.037 (in-sample avg dev_std = 0.056)
NEC for r=1.0 all KL = 0.01 +- 0.037 (in-sample avg dev_std = 0.056)
NEC for r=1.0 all L1 = 0.019 +- 0.060 (in-sample avg dev_std = 0.056)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:31:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:31:30 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:01 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:11 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:32:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ROC-AUC: 0.9708
Train Loss: 0.1435
ID Validation ROC-AUC: 0.9211
ID Validation Loss: 0.2689
ID Test ROC-AUC: 0.9165
ID Test Loss: 0.2816
OOD Validation ROC-AUC: 0.6552
OOD Validation Loss: 0.4851
OOD Test ROC-AUC: 0.6967
OOD Test Loss: 0.6916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8500
Train Loss: 0.3423
ID Validation ROC-AUC: 0.8488
ID Validation Loss: 0.3452
ID Test ROC-AUC: 0.8482
ID Test Loss: 0.3500
OOD Validation ROC-AUC: 0.7007
OOD Validation Loss: 0.2847
OOD Test ROC-AUC: 0.7132
OOD Test Loss: 0.5090

[0m[1;37mINFO[0m: [1mChartInfo 0.9165 0.6967 0.8482 0.7132 0.8488 0.7007[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:32:54 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:32:58 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.712
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.654
SUFF++ for r=0.3 class 0.0 = 0.769 +- 0.074 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.3 class 1.0 = 0.847 +- 0.074 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.3 all KL = 0.925 +- 0.074 (in-sample avg dev_std = 0.182)
SUFF++ for r=0.3 all L1 = 0.838 +- 0.110 (in-sample avg dev_std = 0.182)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.79
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.752
SUFF++ for r=0.6 class 0.0 = 0.797 +- 0.080 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 class 1.0 = 0.918 +- 0.080 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 all KL = 0.949 +- 0.080 (in-sample avg dev_std = 0.155)
SUFF++ for r=0.6 all L1 = 0.904 +- 0.126 (in-sample avg dev_std = 0.155)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.8
SUFF++ for r=0.9 class 0.0 = 0.86 +- 0.052 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 class 1.0 = 0.948 +- 0.052 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 all KL = 0.974 +- 0.052 (in-sample avg dev_std = 0.104)
SUFF++ for r=0.9 all L1 = 0.938 +- 0.092 (in-sample avg dev_std = 0.104)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.583
SUFF++ for r=0.3 class 0.0 = 0.789 +- 0.086 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.3 class 1.0 = 0.82 +- 0.086 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.3 all KL = 0.917 +- 0.086 (in-sample avg dev_std = 0.206)
SUFF++ for r=0.3 all L1 = 0.815 +- 0.119 (in-sample avg dev_std = 0.206)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.683
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.664
SUFF++ for r=0.6 class 0.0 = 0.811 +- 0.096 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 class 1.0 = 0.872 +- 0.096 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 all KL = 0.929 +- 0.096 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 all L1 = 0.862 +- 0.133 (in-sample avg dev_std = 0.195)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.697
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.684
SUFF++ for r=0.9 class 0.0 = 0.867 +- 0.080 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 class 1.0 = 0.91 +- 0.080 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 all KL = 0.958 +- 0.080 (in-sample avg dev_std = 0.148)
SUFF++ for r=0.9 all L1 = 0.903 +- 0.115 (in-sample avg dev_std = 0.148)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.712
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.694
NEC for r=0.3 class 0.0 = 0.227 +- 0.082 (in-sample avg dev_std = 0.159)
NEC for r=0.3 class 1.0 = 0.148 +- 0.082 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all KL = 0.069 +- 0.082 (in-sample avg dev_std = 0.159)
NEC for r=0.3 all L1 = 0.157 +- 0.117 (in-sample avg dev_std = 0.159)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.79
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.778
NEC for r=0.6 class 0.0 = 0.192 +- 0.085 (in-sample avg dev_std = 0.141)
NEC for r=0.6 class 1.0 = 0.076 +- 0.085 (in-sample avg dev_std = 0.141)
NEC for r=0.6 all KL = 0.044 +- 0.085 (in-sample avg dev_std = 0.141)
NEC for r=0.6 all L1 = 0.089 +- 0.122 (in-sample avg dev_std = 0.141)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.825
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.815
NEC for r=0.9 class 0.0 = 0.151 +- 0.058 (in-sample avg dev_std = 0.116)
NEC for r=0.9 class 1.0 = 0.052 +- 0.058 (in-sample avg dev_std = 0.116)
NEC for r=0.9 all KL = 0.027 +- 0.058 (in-sample avg dev_std = 0.116)
NEC for r=0.9 all L1 = 0.064 +- 0.097 (in-sample avg dev_std = 0.116)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.829
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.818
NEC for r=1.0 class 0.0 = 0.139 +- 0.045 (in-sample avg dev_std = 0.107)
NEC for r=1.0 class 1.0 = 0.049 +- 0.045 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all KL = 0.024 +- 0.045 (in-sample avg dev_std = 0.107)
NEC for r=1.0 all L1 = 0.059 +- 0.086 (in-sample avg dev_std = 0.107)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.603
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.617
NEC for r=0.3 class 0.0 = 0.226 +- 0.105 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 1.0 = 0.184 +- 0.105 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all KL = 0.085 +- 0.105 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all L1 = 0.191 +- 0.137 (in-sample avg dev_std = 0.178)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.683
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.683
NEC for r=0.6 class 0.0 = 0.169 +- 0.115 (in-sample avg dev_std = 0.175)
NEC for r=0.6 class 1.0 = 0.125 +- 0.115 (in-sample avg dev_std = 0.175)
NEC for r=0.6 all KL = 0.065 +- 0.115 (in-sample avg dev_std = 0.175)
NEC for r=0.6 all L1 = 0.132 +- 0.140 (in-sample avg dev_std = 0.175)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.697
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.696
NEC for r=0.9 class 0.0 = 0.132 +- 0.098 (in-sample avg dev_std = 0.159)
NEC for r=0.9 class 1.0 = 0.099 +- 0.098 (in-sample avg dev_std = 0.159)
NEC for r=0.9 all KL = 0.05 +- 0.098 (in-sample avg dev_std = 0.159)
NEC for r=0.9 all L1 = 0.105 +- 0.126 (in-sample avg dev_std = 0.159)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.702
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.697
NEC for r=1.0 class 0.0 = 0.137 +- 0.084 (in-sample avg dev_std = 0.150)
NEC for r=1.0 class 1.0 = 0.089 +- 0.084 (in-sample avg dev_std = 0.150)
NEC for r=1.0 all KL = 0.043 +- 0.084 (in-sample avg dev_std = 0.150)
NEC for r=1.0 all L1 = 0.097 +- 0.119 (in-sample avg dev_std = 0.150)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:36:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:36:06 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:36:37 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:36:47 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:36:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:13 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:37:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ROC-AUC: 0.9711
Train Loss: 0.1374
ID Validation ROC-AUC: 0.9175
ID Validation Loss: 0.2514
ID Test ROC-AUC: 0.9200
ID Test Loss: 0.2482
OOD Validation ROC-AUC: 0.6432
OOD Validation Loss: 0.4802
OOD Test ROC-AUC: 0.6930
OOD Test Loss: 0.6345

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ROC-AUC: 0.8717
Train Loss: 0.3270
ID Validation ROC-AUC: 0.8702
ID Validation Loss: 0.3310
ID Test ROC-AUC: 0.8707
ID Test Loss: 0.3340
OOD Validation ROC-AUC: 0.6958
OOD Validation Loss: 0.3030
OOD Test ROC-AUC: 0.7249
OOD Test Loss: 0.5231

[0m[1;37mINFO[0m: [1mChartInfo 0.9200 0.6930 0.8707 0.7249 0.8702 0.6958[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:37:29 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:37:33 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.717
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.674
SUFF++ for r=0.3 class 0.0 = 0.792 +- 0.075 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.3 class 1.0 = 0.85 +- 0.075 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.3 all KL = 0.931 +- 0.075 (in-sample avg dev_std = 0.199)
SUFF++ for r=0.3 all L1 = 0.843 +- 0.109 (in-sample avg dev_std = 0.199)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.799
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.763
SUFF++ for r=0.6 class 0.0 = 0.8 +- 0.080 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 class 1.0 = 0.908 +- 0.080 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 all KL = 0.947 +- 0.080 (in-sample avg dev_std = 0.163)
SUFF++ for r=0.6 all L1 = 0.895 +- 0.117 (in-sample avg dev_std = 0.163)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.807
SUFF++ for r=0.9 class 0.0 = 0.855 +- 0.074 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 class 1.0 = 0.941 +- 0.074 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 all KL = 0.962 +- 0.074 (in-sample avg dev_std = 0.134)
SUFF++ for r=0.9 all L1 = 0.931 +- 0.099 (in-sample avg dev_std = 0.134)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.564
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.555
SUFF++ for r=0.3 class 0.0 = 0.815 +- 0.073 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.3 class 1.0 = 0.824 +- 0.073 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.3 all KL = 0.93 +- 0.073 (in-sample avg dev_std = 0.203)
SUFF++ for r=0.3 all L1 = 0.823 +- 0.110 (in-sample avg dev_std = 0.203)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.646
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.634
SUFF++ for r=0.6 class 0.0 = 0.823 +- 0.081 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 class 1.0 = 0.858 +- 0.081 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 all KL = 0.932 +- 0.081 (in-sample avg dev_std = 0.195)
SUFF++ for r=0.6 all L1 = 0.853 +- 0.125 (in-sample avg dev_std = 0.195)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.7
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.682
SUFF++ for r=0.9 class 0.0 = 0.871 +- 0.066 (in-sample avg dev_std = 0.138)
SUFF++ for r=0.9 class 1.0 = 0.909 +- 0.066 (in-sample avg dev_std = 0.138)
SUFF++ for r=0.9 all KL = 0.96 +- 0.066 (in-sample avg dev_std = 0.138)
SUFF++ for r=0.9 all L1 = 0.903 +- 0.108 (in-sample avg dev_std = 0.138)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.718
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.696
NEC for r=0.3 class 0.0 = 0.199 +- 0.092 (in-sample avg dev_std = 0.178)
NEC for r=0.3 class 1.0 = 0.163 +- 0.092 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all KL = 0.074 +- 0.092 (in-sample avg dev_std = 0.178)
NEC for r=0.3 all L1 = 0.167 +- 0.128 (in-sample avg dev_std = 0.178)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.799
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.809
NEC for r=0.6 class 0.0 = 0.176 +- 0.078 (in-sample avg dev_std = 0.137)
NEC for r=0.6 class 1.0 = 0.084 +- 0.078 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all KL = 0.043 +- 0.078 (in-sample avg dev_std = 0.137)
NEC for r=0.6 all L1 = 0.095 +- 0.113 (in-sample avg dev_std = 0.137)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.834
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.836
NEC for r=0.9 class 0.0 = 0.143 +- 0.054 (in-sample avg dev_std = 0.107)
NEC for r=0.9 class 1.0 = 0.047 +- 0.054 (in-sample avg dev_std = 0.107)
NEC for r=0.9 all KL = 0.024 +- 0.054 (in-sample avg dev_std = 0.107)
NEC for r=0.9 all L1 = 0.059 +- 0.088 (in-sample avg dev_std = 0.107)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.838
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.836
NEC for r=1.0 class 0.0 = 0.125 +- 0.045 (in-sample avg dev_std = 0.093)
NEC for r=1.0 class 1.0 = 0.038 +- 0.045 (in-sample avg dev_std = 0.093)
NEC for r=1.0 all KL = 0.018 +- 0.045 (in-sample avg dev_std = 0.093)
NEC for r=1.0 all L1 = 0.048 +- 0.079 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.564
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.582
NEC for r=0.3 class 0.0 = 0.207 +- 0.098 (in-sample avg dev_std = 0.194)
NEC for r=0.3 class 1.0 = 0.193 +- 0.098 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all KL = 0.084 +- 0.098 (in-sample avg dev_std = 0.194)
NEC for r=0.3 all L1 = 0.196 +- 0.135 (in-sample avg dev_std = 0.194)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.647
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.643
NEC for r=0.6 class 0.0 = 0.168 +- 0.087 (in-sample avg dev_std = 0.166)
NEC for r=0.6 class 1.0 = 0.132 +- 0.087 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all KL = 0.058 +- 0.087 (in-sample avg dev_std = 0.166)
NEC for r=0.6 all L1 = 0.138 +- 0.129 (in-sample avg dev_std = 0.166)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.7
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.694
NEC for r=0.9 class 0.0 = 0.14 +- 0.075 (in-sample avg dev_std = 0.134)
NEC for r=0.9 class 1.0 = 0.09 +- 0.075 (in-sample avg dev_std = 0.134)
NEC for r=0.9 all KL = 0.039 +- 0.075 (in-sample avg dev_std = 0.134)
NEC for r=0.9 all L1 = 0.098 +- 0.115 (in-sample avg dev_std = 0.134)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.708
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.702
NEC for r=1.0 class 0.0 = 0.126 +- 0.062 (in-sample avg dev_std = 0.122)
NEC for r=1.0 class 1.0 = 0.074 +- 0.062 (in-sample avg dev_std = 0.122)
NEC for r=1.0 all KL = 0.031 +- 0.062 (in-sample avg dev_std = 0.122)
NEC for r=1.0 all L1 = 0.083 +- 0.104 (in-sample avg dev_std = 0.122)
model_dirname= repr_GSATvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:40:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:40:42 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:41:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:41:23 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:41:33 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:41:49 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:42:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ROC-AUC: 0.9717
Train Loss: 0.1380
ID Validation ROC-AUC: 0.9197
ID Validation Loss: 0.2550
ID Test ROC-AUC: 0.9210
ID Test Loss: 0.2563
OOD Validation ROC-AUC: 0.6324
OOD Validation Loss: 0.4871
OOD Test ROC-AUC: 0.6937
OOD Test Loss: 0.6380

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8312
Train Loss: 1.4697
ID Validation ROC-AUC: 0.8322
ID Validation Loss: 1.4867
ID Test ROC-AUC: 0.8295
ID Test Loss: 1.4988
OOD Validation ROC-AUC: 0.6988
OOD Validation Loss: 0.6555
OOD Test ROC-AUC: 0.7116
OOD Test Loss: 0.5724

[0m[1;37mINFO[0m: [1mChartInfo 0.9210 0.6937 0.8295 0.7116 0.8322 0.6988[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:42:05 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:42:09 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.3 = nan
WIoU for r=0.3 = nan
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=0.9 = nan
WIoU for r=0.9 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.636
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.618
SUFF++ for r=0.3 class 0.0 = 0.743 +- 0.096 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 class 1.0 = 0.755 +- 0.096 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 all KL = 0.889 +- 0.096 (in-sample avg dev_std = 0.294)
SUFF++ for r=0.3 all L1 = 0.754 +- 0.105 (in-sample avg dev_std = 0.294)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.68
SUFF++ for r=0.6 class 0.0 = 0.769 +- 0.125 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 class 1.0 = 0.794 +- 0.125 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 all KL = 0.884 +- 0.125 (in-sample avg dev_std = 0.298)
SUFF++ for r=0.6 all L1 = 0.791 +- 0.135 (in-sample avg dev_std = 0.298)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.734
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.711
SUFF++ for r=0.9 class 0.0 = 0.865 +- 0.094 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.9 class 1.0 = 0.847 +- 0.094 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.9 all KL = 0.943 +- 0.094 (in-sample avg dev_std = 0.198)
SUFF++ for r=0.9 all L1 = 0.85 +- 0.118 (in-sample avg dev_std = 0.198)


ratio=1.0



Zero intervened samples, skipping weight=1.0



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.535
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.522
SUFF++ for r=0.3 class 0.0 = 0.775 +- 0.090 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.3 class 1.0 = 0.768 +- 0.090 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.3 all KL = 0.9 +- 0.090 (in-sample avg dev_std = 0.285)
SUFF++ for r=0.3 all L1 = 0.769 +- 0.106 (in-sample avg dev_std = 0.285)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.576
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.563
SUFF++ for r=0.6 class 0.0 = 0.782 +- 0.104 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.6 class 1.0 = 0.788 +- 0.104 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.6 all KL = 0.898 +- 0.104 (in-sample avg dev_std = 0.281)
SUFF++ for r=0.6 all L1 = 0.787 +- 0.126 (in-sample avg dev_std = 0.281)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.585
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.586
SUFF++ for r=0.9 class 0.0 = 0.864 +- 0.100 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 class 1.0 = 0.843 +- 0.100 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all KL = 0.944 +- 0.100 (in-sample avg dev_std = 0.197)
SUFF++ for r=0.9 all L1 = 0.846 +- 0.119 (in-sample avg dev_std = 0.197)


ratio=1.0



Zero intervened samples, skipping weight=1.0


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.636
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.307 +- 0.005
Model ROC-AUC over intervened graphs for r=0.3 =  0.634
NEC for r=0.3 class 0.0 = 0.228 +- 0.132 (in-sample avg dev_std = 0.245)
NEC for r=0.3 class 1.0 = 0.254 +- 0.132 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all KL = 0.112 +- 0.132 (in-sample avg dev_std = 0.245)
NEC for r=0.3 all L1 = 0.251 +- 0.144 (in-sample avg dev_std = 0.245)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.706
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.693
NEC for r=0.6 class 0.0 = 0.206 +- 0.150 (in-sample avg dev_std = 0.269)
NEC for r=0.6 class 1.0 = 0.212 +- 0.150 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all KL = 0.119 +- 0.150 (in-sample avg dev_std = 0.269)
NEC for r=0.6 all L1 = 0.212 +- 0.162 (in-sample avg dev_std = 0.269)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.734
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.735
NEC for r=0.9 class 0.0 = 0.154 +- 0.093 (in-sample avg dev_std = 0.204)
NEC for r=0.9 class 1.0 = 0.155 +- 0.093 (in-sample avg dev_std = 0.204)
NEC for r=0.9 all KL = 0.06 +- 0.093 (in-sample avg dev_std = 0.204)
NEC for r=0.9 all L1 = 0.155 +- 0.123 (in-sample avg dev_std = 0.204)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.739
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.735
NEC for r=1.0 class 0.0 = 0.14 +- 0.081 (in-sample avg dev_std = 0.179)
NEC for r=1.0 class 1.0 = 0.133 +- 0.081 (in-sample avg dev_std = 0.179)
NEC for r=1.0 all KL = 0.046 +- 0.081 (in-sample avg dev_std = 0.179)
NEC for r=1.0 all L1 = 0.134 +- 0.113 (in-sample avg dev_std = 0.179)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.3


Computing with masking

Model ROC-AUC of binarized graphs for r=0.3 =  0.535
Model XAI F1 of binarized graphs for r=0.3 =  nan
Model XAI WIoU of binarized graphs for r=0.3 =  nan
len(reference) = 800
Effective ratio: 0.308 +- 0.006
Model ROC-AUC over intervened graphs for r=0.3 =  0.548
NEC for r=0.3 class 0.0 = 0.239 +- 0.135 (in-sample avg dev_std = 0.232)
NEC for r=0.3 class 1.0 = 0.243 +- 0.135 (in-sample avg dev_std = 0.232)
NEC for r=0.3 all KL = 0.107 +- 0.135 (in-sample avg dev_std = 0.232)
NEC for r=0.3 all L1 = 0.242 +- 0.152 (in-sample avg dev_std = 0.232)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.576
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.561
NEC for r=0.6 class 0.0 = 0.211 +- 0.144 (in-sample avg dev_std = 0.247)
NEC for r=0.6 class 1.0 = 0.217 +- 0.144 (in-sample avg dev_std = 0.247)
NEC for r=0.6 all KL = 0.108 +- 0.144 (in-sample avg dev_std = 0.247)
NEC for r=0.6 all L1 = 0.216 +- 0.158 (in-sample avg dev_std = 0.247)


ratio=0.9


Computing with masking

Model ROC-AUC of binarized graphs for r=0.9 =  0.585
Model XAI F1 of binarized graphs for r=0.9 =  nan
Model XAI WIoU of binarized graphs for r=0.9 =  nan
len(reference) = 800
Effective ratio: 0.907 +- 0.005
Model ROC-AUC over intervened graphs for r=0.9 =  0.584
NEC for r=0.9 class 0.0 = 0.159 +- 0.104 (in-sample avg dev_std = 0.194)
NEC for r=0.9 class 1.0 = 0.168 +- 0.104 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all KL = 0.062 +- 0.104 (in-sample avg dev_std = 0.194)
NEC for r=0.9 all L1 = 0.166 +- 0.131 (in-sample avg dev_std = 0.194)


ratio=1.0


Computing with masking

Model ROC-AUC of binarized graphs for r=1.0 =  0.594
Model XAI F1 of binarized graphs for r=1.0 =  nan
Model XAI WIoU of binarized graphs for r=1.0 =  nan
len(reference) = 800
Effective ratio: 1.000 +- 0.000
Model ROC-AUC over intervened graphs for r=1.0 =  0.588
NEC for r=1.0 class 0.0 = 0.137 +- 0.090 (in-sample avg dev_std = 0.177)
NEC for r=1.0 class 1.0 = 0.151 +- 0.090 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all KL = 0.05 +- 0.090 (in-sample avg dev_std = 0.177)
NEC for r=1.0 all L1 = 0.149 +- 0.119 (in-sample avg dev_std = 0.177)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.946, 0.971, 0.984, 1.0], 'all_L1': [0.896, 0.933, 0.954, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.979, 0.996, 1.0], 'all_L1': [0.834, 0.969, 0.99, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.925, 0.949, 0.974, 1.0], 'all_L1': [0.838, 0.904, 0.938, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.931, 0.947, 0.962, 1.0], 'all_L1': [0.843, 0.895, 0.931, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.889, 0.884, 0.943, 1.0], 'all_L1': [0.754, 0.791, 0.85, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.072, 0.034, 0.017, 0.014], 'all_L1': [0.125, 0.071, 0.047, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.083, 0.021, 0.008, 0.005], 'all_L1': [0.158, 0.031, 0.014, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.044, 0.027, 0.024], 'all_L1': [0.157, 0.089, 0.064, 0.059]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.043, 0.024, 0.018], 'all_L1': [0.167, 0.095, 0.059, 0.048]}), defaultdict(<class 'list'>, {'all_KL': [0.112, 0.119, 0.06, 0.046], 'all_L1': [0.251, 0.212, 0.155, 0.134]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.919, 0.946, 0.972, 1.0], 'all_L1': [0.851, 0.889, 0.924, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.896, 0.972, 0.992, 1.0], 'all_L1': [0.803, 0.955, 0.984, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.917, 0.929, 0.958, 1.0], 'all_L1': [0.815, 0.862, 0.903, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.93, 0.932, 0.96, 1.0], 'all_L1': [0.823, 0.853, 0.903, 1.0], 0.0: [1.0], 1.0: [1.0]}), defaultdict(<class 'list'>, {'all_KL': [0.9, 0.898, 0.944, 1.0], 'all_L1': [0.769, 0.787, 0.846, 1.0], 0.0: [1.0], 1.0: [1.0]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.108, 0.063, 0.032, 0.027], 'all_L1': [0.18, 0.12, 0.082, 0.072]}), defaultdict(<class 'list'>, {'all_KL': [0.086, 0.03, 0.012, 0.01], 'all_L1': [0.177, 0.047, 0.02, 0.019]}), defaultdict(<class 'list'>, {'all_KL': [0.085, 0.065, 0.05, 0.043], 'all_L1': [0.191, 0.132, 0.105, 0.097]}), defaultdict(<class 'list'>, {'all_KL': [0.084, 0.058, 0.039, 0.031], 'all_L1': [0.196, 0.138, 0.098, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.107, 0.108, 0.062, 0.05], 'all_L1': [0.242, 0.216, 0.166, 0.149]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.833 +- 0.045, 0.898 +- 0.060, 0.933 +- 0.046, 1.000 +- 0.000
suff++ class all_KL  =  0.920 +- 0.019, 0.946 +- 0.033, 0.972 +- 0.018, 1.000 +- 0.000
suff++_acc_int  =  0.660 +- 0.040, 0.736 +- 0.040, 0.780 +- 0.036
nec class all_L1  =  0.172 +- 0.042, 0.100 +- 0.060, 0.068 +- 0.047, 0.059 +- 0.041
nec class all_KL  =  0.082 +- 0.016, 0.052 +- 0.034, 0.027 +- 0.018, 0.021 +- 0.014
nec_acc_int  =  0.691 +- 0.035, 0.770 +- 0.041, 0.800 +- 0.034, 0.801 +- 0.035

Eval split test
suff++ class all_L1  =  0.812 +- 0.027, 0.869 +- 0.054, 0.912 +- 0.044, 1.000 +- 0.000
suff++ class all_KL  =  0.912 +- 0.013, 0.935 +- 0.024, 0.965 +- 0.016, 1.000 +- 0.000
suff++_acc_int  =  0.571 +- 0.038, 0.626 +- 0.039, 0.655 +- 0.038
nec class all_L1  =  0.197 +- 0.023, 0.131 +- 0.054, 0.094 +- 0.047, 0.084 +- 0.042
nec class all_KL  =  0.094 +- 0.011, 0.065 +- 0.025, 0.039 +- 0.017, 0.032 +- 0.014
nec_acc_int  =  0.603 +- 0.034, 0.641 +- 0.043, 0.662 +- 0.042, 0.667 +- 0.042


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.502 +- 0.005, 0.499 +- 0.003, 0.500 +- 0.003, 0.529 +- 0.020
Faith. Armon (L1)= 		  =  0.281 +- 0.052, 0.172 +- 0.090, 0.122 +- 0.077, 0.108 +- 0.071
Faith. GMean (L1)= 	  =  0.374 +- 0.033, 0.283 +- 0.076, 0.234 +- 0.078, 0.227 +- 0.084
Faith. Aritm (KL)= 		  =  0.501 +- 0.004, 0.499 +- 0.003, 0.499 +- 0.003, 0.511 +- 0.007
Faith. Armon (KL)= 		  =  0.150 +- 0.026, 0.097 +- 0.059, 0.052 +- 0.033, 0.042 +- 0.026
Faith. GMean (KL)= 	  =  0.273 +- 0.022, 0.211 +- 0.061, 0.154 +- 0.049, 0.139 +- 0.047

Eval split test
Faith. Aritm (L1)= 		  =  0.505 +- 0.008, 0.500 +- 0.003, 0.503 +- 0.002, 0.542 +- 0.021
Faith. Armon (L1)= 		  =  0.316 +- 0.028, 0.221 +- 0.080, 0.166 +- 0.077, 0.152 +- 0.072
Faith. GMean (L1)= 	  =  0.399 +- 0.018, 0.326 +- 0.065, 0.279 +- 0.077, 0.278 +- 0.081
Faith. Aritm (KL)= 		  =  0.503 +- 0.007, 0.500 +- 0.004, 0.502 +- 0.001, 0.516 +- 0.007
Faith. Armon (KL)= 		  =  0.170 +- 0.018, 0.120 +- 0.043, 0.074 +- 0.031, 0.062 +- 0.026
Faith. GMean (KL)= 	  =  0.292 +- 0.017, 0.241 +- 0.045, 0.188 +- 0.045, 0.174 +- 0.043
Computed for split load_split = id



Completed in  0:23:09.133248  for GSATvGIN LBAPcore/assay



DONE GSAT LBAPcore/assay ER
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:45:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:45:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:09 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:29 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:44 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:46:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 23...
[0m[1;37mINFO[0m: [1mCheckpoint 23: 
-----------------------------------
Train ROC-AUC: 0.9686
Train Loss: 0.1597
ID Validation ROC-AUC: 0.9236
ID Validation Loss: 0.2366
ID Test ROC-AUC: 0.9233
ID Test Loss: 0.2412
OOD Validation ROC-AUC: 0.6572
OOD Validation Loss: 0.3846
OOD Test ROC-AUC: 0.6967
OOD Test Loss: 0.5574

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ROC-AUC: 0.8713
Train Loss: 0.2869
ID Validation ROC-AUC: 0.8665
ID Validation Loss: 0.2911
ID Test ROC-AUC: 0.8695
ID Test Loss: 0.2927
OOD Validation ROC-AUC: 0.6861
OOD Validation Loss: 0.2792
OOD Test ROC-AUC: 0.7034
OOD Test Loss: 0.4207

[0m[1;37mINFO[0m: [1mChartInfo 0.9233 0.6967 0.8695 0.7034 0.8665 0.6861[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:47:00 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:47:10 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.707
SUFF++ for r=0.6 class 0.0 = 0.65 +- 0.272 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.6 class 1.0 = 0.801 +- 0.272 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.6 all KL = 0.675 +- 0.272 (in-sample avg dev_std = 0.333)
SUFF++ for r=0.6 all L1 = 0.783 +- 0.162 (in-sample avg dev_std = 0.333)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.622
SUFF++ for r=0.6 class 0.0 = 0.665 +- 0.242 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 class 1.0 = 0.735 +- 0.242 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 all KL = 0.704 +- 0.242 (in-sample avg dev_std = 0.337)
SUFF++ for r=0.6 all L1 = 0.724 +- 0.157 (in-sample avg dev_std = 0.337)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.867
NEC for r=0.6 class 0.0 = 0.213 +- 0.265 (in-sample avg dev_std = 0.231)
NEC for r=0.6 class 1.0 = 0.162 +- 0.265 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all KL = 0.233 +- 0.265 (in-sample avg dev_std = 0.231)
NEC for r=0.6 all L1 = 0.168 +- 0.161 (in-sample avg dev_std = 0.231)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.74
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.709
NEC for r=0.6 class 0.0 = 0.274 +- 0.246 (in-sample avg dev_std = 0.219)
NEC for r=0.6 class 1.0 = 0.233 +- 0.246 (in-sample avg dev_std = 0.219)
NEC for r=0.6 all KL = 0.236 +- 0.246 (in-sample avg dev_std = 0.219)
NEC for r=0.6 all L1 = 0.24 +- 0.172 (in-sample avg dev_std = 0.219)
model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:48:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:48:12 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:48:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:48:52 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:02 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:18 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ROC-AUC: 0.9829
Train Loss: 0.1261
ID Validation ROC-AUC: 0.9196
ID Validation Loss: 0.2917
ID Test ROC-AUC: 0.9170
ID Test Loss: 0.3056
OOD Validation ROC-AUC: 0.6433
OOD Validation Loss: 0.4965
OOD Test ROC-AUC: 0.6785
OOD Test Loss: 0.7235

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8825
Train Loss: 0.2710
ID Validation ROC-AUC: 0.8746
ID Validation Loss: 0.2831
ID Test ROC-AUC: 0.8768
ID Test Loss: 0.2841
OOD Validation ROC-AUC: 0.6840
OOD Validation Loss: 0.3139
OOD Test ROC-AUC: 0.7101
OOD Test Loss: 0.4991

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.6785 0.8768 0.7101 0.8746 0.6840[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:49:33 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:49:42 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.916
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.717
SUFF++ for r=0.6 class 0.0 = 0.632 +- 0.320 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 class 1.0 = 0.791 +- 0.320 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all KL = 0.578 +- 0.320 (in-sample avg dev_std = 0.387)
SUFF++ for r=0.6 all L1 = 0.773 +- 0.177 (in-sample avg dev_std = 0.387)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.705
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.584
SUFF++ for r=0.6 class 0.0 = 0.639 +- 0.292 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 class 1.0 = 0.712 +- 0.292 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all KL = 0.599 +- 0.292 (in-sample avg dev_std = 0.410)
SUFF++ for r=0.6 all L1 = 0.7 +- 0.178 (in-sample avg dev_std = 0.410)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.916
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.872
NEC for r=0.6 class 0.0 = 0.277 +- 0.277 (in-sample avg dev_std = 0.258)
NEC for r=0.6 class 1.0 = 0.12 +- 0.277 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all KL = 0.213 +- 0.277 (in-sample avg dev_std = 0.258)
NEC for r=0.6 all L1 = 0.139 +- 0.164 (in-sample avg dev_std = 0.258)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.705
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.674
NEC for r=0.6 class 0.0 = 0.284 +- 0.260 (in-sample avg dev_std = 0.285)
NEC for r=0.6 class 1.0 = 0.204 +- 0.260 (in-sample avg dev_std = 0.285)
NEC for r=0.6 all KL = 0.245 +- 0.260 (in-sample avg dev_std = 0.285)
NEC for r=0.6 all L1 = 0.218 +- 0.181 (in-sample avg dev_std = 0.285)
model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:50:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:50:44 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:51:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:51:24 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:51:34 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:51:49 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.9540
Train Loss: 0.1749
ID Validation ROC-AUC: 0.9236
ID Validation Loss: 0.2164
ID Test ROC-AUC: 0.9206
ID Test Loss: 0.2244
OOD Validation ROC-AUC: 0.6596
OOD Validation Loss: 0.3480
OOD Test ROC-AUC: 0.6987
OOD Test Loss: 0.4931

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8972
Train Loss: 0.2438
ID Validation ROC-AUC: 0.8845
ID Validation Loss: 0.2539
ID Test ROC-AUC: 0.8865
ID Test Loss: 0.2549
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2839
OOD Test ROC-AUC: 0.7162
OOD Test Loss: 0.4332

[0m[1;37mINFO[0m: [1mChartInfo 0.9206 0.6987 0.8865 0.7162 0.8845 0.6935[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:52:05 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:52:13 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.753
SUFF++ for r=0.6 class 0.0 = 0.705 +- 0.220 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 class 1.0 = 0.801 +- 0.220 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 all KL = 0.735 +- 0.220 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 all L1 = 0.79 +- 0.136 (in-sample avg dev_std = 0.301)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.736
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.628
SUFF++ for r=0.6 class 0.0 = 0.708 +- 0.203 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 class 1.0 = 0.747 +- 0.203 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 all KL = 0.765 +- 0.203 (in-sample avg dev_std = 0.301)
SUFF++ for r=0.6 all L1 = 0.741 +- 0.137 (in-sample avg dev_std = 0.301)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.94
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.879
NEC for r=0.6 class 0.0 = 0.172 +- 0.195 (in-sample avg dev_std = 0.208)
NEC for r=0.6 class 1.0 = 0.132 +- 0.195 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all KL = 0.155 +- 0.195 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all L1 = 0.137 +- 0.122 (in-sample avg dev_std = 0.208)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.736
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.707
NEC for r=0.6 class 0.0 = 0.214 +- 0.166 (in-sample avg dev_std = 0.199)
NEC for r=0.6 class 1.0 = 0.18 +- 0.166 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all KL = 0.141 +- 0.166 (in-sample avg dev_std = 0.199)
NEC for r=0.6 all L1 = 0.186 +- 0.130 (in-sample avg dev_std = 0.199)
model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:53:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:53:16 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:53:47 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:53:56 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:22 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 31...
[0m[1;37mINFO[0m: [1mCheckpoint 31: 
-----------------------------------
Train ROC-AUC: 0.9785
Train Loss: 0.1297
ID Validation ROC-AUC: 0.9231
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9232
ID Test Loss: 0.2591
OOD Validation ROC-AUC: 0.6355
OOD Validation Loss: 0.4365
OOD Test ROC-AUC: 0.6820
OOD Test Loss: 0.6119

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ROC-AUC: 0.9090
Train Loss: 0.2539
ID Validation ROC-AUC: 0.8928
ID Validation Loss: 0.2745
ID Test ROC-AUC: 0.8905
ID Test Loss: 0.2822
OOD Validation ROC-AUC: 0.6800
OOD Validation Loss: 0.3263
OOD Test ROC-AUC: 0.7103
OOD Test Loss: 0.5223

[0m[1;37mINFO[0m: [1mChartInfo 0.9232 0.6820 0.8905 0.7103 0.8928 0.6800[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:54:37 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:54:46 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.938
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.696
SUFF++ for r=0.6 class 0.0 = 0.602 +- 0.323 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 class 1.0 = 0.713 +- 0.323 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all KL = 0.509 +- 0.323 (in-sample avg dev_std = 0.458)
SUFF++ for r=0.6 all L1 = 0.7 +- 0.180 (in-sample avg dev_std = 0.458)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.575
SUFF++ for r=0.6 class 0.0 = 0.612 +- 0.283 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.6 class 1.0 = 0.646 +- 0.283 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.6 all KL = 0.567 +- 0.283 (in-sample avg dev_std = 0.453)
SUFF++ for r=0.6 all L1 = 0.64 +- 0.165 (in-sample avg dev_std = 0.453)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.938
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.863
NEC for r=0.6 class 0.0 = 0.295 +- 0.270 (in-sample avg dev_std = 0.277)
NEC for r=0.6 class 1.0 = 0.149 +- 0.270 (in-sample avg dev_std = 0.277)
NEC for r=0.6 all KL = 0.242 +- 0.270 (in-sample avg dev_std = 0.277)
NEC for r=0.6 all L1 = 0.166 +- 0.165 (in-sample avg dev_std = 0.277)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.707
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.671
NEC for r=0.6 class 0.0 = 0.299 +- 0.243 (in-sample avg dev_std = 0.268)
NEC for r=0.6 class 1.0 = 0.231 +- 0.243 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all KL = 0.238 +- 0.243 (in-sample avg dev_std = 0.268)
NEC for r=0.6 all L1 = 0.242 +- 0.181 (in-sample avg dev_std = 0.268)
model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:55:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:55:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:56:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:56:28 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:56:38 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:56:53 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9685
Train Loss: 0.1653
ID Validation ROC-AUC: 0.9224
ID Validation Loss: 0.2315
ID Test ROC-AUC: 0.9196
ID Test Loss: 0.2391
OOD Validation ROC-AUC: 0.6434
OOD Validation Loss: 0.3691
OOD Test ROC-AUC: 0.6778
OOD Test Loss: 0.5284

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8955
Train Loss: 0.2439
ID Validation ROC-AUC: 0.8855
ID Validation Loss: 0.2541
ID Test ROC-AUC: 0.8869
ID Test Loss: 0.2554
OOD Validation ROC-AUC: 0.6944
OOD Validation Loss: 0.2933
OOD Test ROC-AUC: 0.7180
OOD Test Loss: 0.4561

[0m[1;37mINFO[0m: [1mChartInfo 0.9196 0.6778 0.8869 0.7180 0.8855 0.6944[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 06:57:08 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 06:57:17 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.664
SUFF++ for r=0.6 class 0.0 = 0.701 +- 0.273 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 class 1.0 = 0.741 +- 0.273 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 all KL = 0.599 +- 0.273 (in-sample avg dev_std = 0.336)
SUFF++ for r=0.6 all L1 = 0.736 +- 0.129 (in-sample avg dev_std = 0.336)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.561
SUFF++ for r=0.6 class 0.0 = 0.713 +- 0.248 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.6 class 1.0 = 0.713 +- 0.248 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.6 all KL = 0.699 +- 0.248 (in-sample avg dev_std = 0.306)
SUFF++ for r=0.6 all L1 = 0.713 +- 0.125 (in-sample avg dev_std = 0.306)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.931
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.858
NEC for r=0.6 class 0.0 = 0.201 +- 0.210 (in-sample avg dev_std = 0.181)
NEC for r=0.6 class 1.0 = 0.139 +- 0.210 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all KL = 0.176 +- 0.210 (in-sample avg dev_std = 0.181)
NEC for r=0.6 all L1 = 0.146 +- 0.137 (in-sample avg dev_std = 0.181)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.71
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.671
NEC for r=0.6 class 0.0 = 0.247 +- 0.199 (in-sample avg dev_std = 0.171)
NEC for r=0.6 class 1.0 = 0.207 +- 0.199 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all KL = 0.179 +- 0.199 (in-sample avg dev_std = 0.171)
NEC for r=0.6 all L1 = 0.214 +- 0.151 (in-sample avg dev_std = 0.171)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.675], 'all_L1': [0.783]}), defaultdict(<class 'list'>, {'all_KL': [0.578], 'all_L1': [0.773]}), defaultdict(<class 'list'>, {'all_KL': [0.735], 'all_L1': [0.79]}), defaultdict(<class 'list'>, {'all_KL': [0.509], 'all_L1': [0.7]}), defaultdict(<class 'list'>, {'all_KL': [0.599], 'all_L1': [0.736]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.233], 'all_L1': [0.168]}), defaultdict(<class 'list'>, {'all_KL': [0.213], 'all_L1': [0.139]}), defaultdict(<class 'list'>, {'all_KL': [0.155], 'all_L1': [0.137]}), defaultdict(<class 'list'>, {'all_KL': [0.242], 'all_L1': [0.166]}), defaultdict(<class 'list'>, {'all_KL': [0.176], 'all_L1': [0.146]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.704], 'all_L1': [0.724]}), defaultdict(<class 'list'>, {'all_KL': [0.599], 'all_L1': [0.7]}), defaultdict(<class 'list'>, {'all_KL': [0.765], 'all_L1': [0.741]}), defaultdict(<class 'list'>, {'all_KL': [0.567], 'all_L1': [0.64]}), defaultdict(<class 'list'>, {'all_KL': [0.699], 'all_L1': [0.713]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.236], 'all_L1': [0.24]}), defaultdict(<class 'list'>, {'all_KL': [0.245], 'all_L1': [0.218]}), defaultdict(<class 'list'>, {'all_KL': [0.141], 'all_L1': [0.186]}), defaultdict(<class 'list'>, {'all_KL': [0.238], 'all_L1': [0.242]}), defaultdict(<class 'list'>, {'all_KL': [0.179], 'all_L1': [0.214]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.756 +- 0.034
suff++ class all_KL  =  0.619 +- 0.078
suff++_acc_int  =  0.707 +- 0.029
nec class all_L1  =  0.151 +- 0.013
nec class all_KL  =  0.204 +- 0.033
nec_acc_int  =  0.868 +- 0.007

Eval split test
suff++ class all_L1  =  0.704 +- 0.035
suff++ class all_KL  =  0.667 +- 0.073
suff++_acc_int  =  0.594 +- 0.026
nec class all_L1  =  0.220 +- 0.020
nec class all_KL  =  0.208 +- 0.041
nec_acc_int  =  0.686 +- 0.018


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.454 +- 0.015
Faith. Armon (L1)= 		  =  0.252 +- 0.018
Faith. GMean (L1)= 	  =  0.338 +- 0.013
Faith. Aritm (KL)= 		  =  0.411 +- 0.032
Faith. Armon (KL)= 		  =  0.303 +- 0.034
Faith. GMean (KL)= 	  =  0.352 +- 0.024

Eval split test
Faith. Aritm (L1)= 		  =  0.462 +- 0.013
Faith. Armon (L1)= 		  =  0.334 +- 0.022
Faith. GMean (L1)= 	  =  0.393 +- 0.015
Faith. Aritm (KL)= 		  =  0.437 +- 0.024
Faith. Armon (KL)= 		  =  0.312 +- 0.044
Faith. GMean (KL)= 	  =  0.368 +- 0.027
Computed for split load_split = id



Completed in  0:12:42.824477  for CIGAvGIN LBAPcore/assay



DONE CIGA LBAPcore/assay
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 18:58:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 06:58:39 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 06:59:09 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 06:59:19 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 06:59:30 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 06:59:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:00:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ROC-AUC: 0.9644
Train Loss: 0.3162
ID Validation ROC-AUC: 0.9159
ID Validation Loss: 0.4976
ID Test ROC-AUC: 0.9149
ID Test Loss: 0.5133
OOD Validation ROC-AUC: 0.6062
OOD Validation Loss: 0.7427
OOD Test ROC-AUC: 0.6845
OOD Test Loss: 1.0938

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ROC-AUC: 0.9089
Train Loss: 0.3173
ID Validation ROC-AUC: 0.8910
ID Validation Loss: 0.3404
ID Test ROC-AUC: 0.8888
ID Test Loss: 0.3479
OOD Validation ROC-AUC: 0.6543
OOD Validation Loss: 0.3422
OOD Test ROC-AUC: 0.6990
OOD Test Loss: 0.5882

[0m[1;37mINFO[0m: [1mChartInfo 0.9149 0.6845 0.8888 0.6990 0.8910 0.6543[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:00:02 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:00:11 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.754
SUFF++ for r=0.6 class 0.0 = 0.78 +- 0.145 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.6 class 1.0 = 0.975 +- 0.145 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.6 all KL = 0.943 +- 0.145 (in-sample avg dev_std = 0.096)
SUFF++ for r=0.6 all L1 = 0.952 +- 0.131 (in-sample avg dev_std = 0.096)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.722
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.607
SUFF++ for r=0.6 class 0.0 = 0.889 +- 0.151 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 class 1.0 = 0.952 +- 0.151 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all KL = 0.939 +- 0.151 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all L1 = 0.942 +- 0.138 (in-sample avg dev_std = 0.108)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.926
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.871
NEC for r=0.6 class 0.0 = 0.261 +- 0.161 (in-sample avg dev_std = 0.170)
NEC for r=0.6 class 1.0 = 0.039 +- 0.161 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all KL = 0.088 +- 0.161 (in-sample avg dev_std = 0.170)
NEC for r=0.6 all L1 = 0.065 +- 0.127 (in-sample avg dev_std = 0.170)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.722
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.686
NEC for r=0.6 class 0.0 = 0.171 +- 0.186 (in-sample avg dev_std = 0.208)
NEC for r=0.6 class 1.0 = 0.088 +- 0.186 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all KL = 0.134 +- 0.186 (in-sample avg dev_std = 0.208)
NEC for r=0.6 all L1 = 0.102 +- 0.141 (in-sample avg dev_std = 0.208)
model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 19:01:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 07:01:15 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 07:01:45 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 07:01:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:05 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:20 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ROC-AUC: 0.9658
Train Loss: 0.1509
ID Validation ROC-AUC: 0.9099
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.9129
ID Test Loss: 0.2578
OOD Validation ROC-AUC: 0.6398
OOD Validation Loss: 0.4377
OOD Test ROC-AUC: 0.6781
OOD Test Loss: 0.5882

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ROC-AUC: 0.9221
Train Loss: 0.2152
ID Validation ROC-AUC: 0.8909
ID Validation Loss: 0.2509
ID Test ROC-AUC: 0.8972
ID Test Loss: 0.2480
OOD Validation ROC-AUC: 0.6624
OOD Validation Loss: 0.3222
OOD Test ROC-AUC: 0.7061
OOD Test Loss: 0.4680

[0m[1;37mINFO[0m: [1mChartInfo 0.9129 0.6781 0.8972 0.7061 0.8909 0.6624[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:02:36 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:02:44 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.735
SUFF++ for r=0.6 class 0.0 = 0.588 +- 0.195 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 class 1.0 = 0.905 +- 0.195 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 all KL = 0.861 +- 0.195 (in-sample avg dev_std = 0.230)
SUFF++ for r=0.6 all L1 = 0.868 +- 0.186 (in-sample avg dev_std = 0.230)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.702
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.618
SUFF++ for r=0.6 class 0.0 = 0.7 +- 0.184 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 class 1.0 = 0.827 +- 0.184 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 all KL = 0.848 +- 0.184 (in-sample avg dev_std = 0.244)
SUFF++ for r=0.6 all L1 = 0.806 +- 0.197 (in-sample avg dev_std = 0.244)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.905
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.744
NEC for r=0.6 class 0.0 = 0.392 +- 0.212 (in-sample avg dev_std = 0.276)
NEC for r=0.6 class 1.0 = 0.13 +- 0.212 (in-sample avg dev_std = 0.276)
NEC for r=0.6 all KL = 0.188 +- 0.212 (in-sample avg dev_std = 0.276)
NEC for r=0.6 all L1 = 0.16 +- 0.175 (in-sample avg dev_std = 0.276)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.702
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.616
NEC for r=0.6 class 0.0 = 0.314 +- 0.180 (in-sample avg dev_std = 0.295)
NEC for r=0.6 class 1.0 = 0.212 +- 0.180 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all KL = 0.195 +- 0.180 (in-sample avg dev_std = 0.295)
NEC for r=0.6 all L1 = 0.229 +- 0.174 (in-sample avg dev_std = 0.295)
model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 19:03:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 07:03:48 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 07:04:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 07:04:28 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 07:04:39 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 07:04:54 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.9373
Train Loss: 0.1953
ID Validation ROC-AUC: 0.9097
ID Validation Loss: 0.2289
ID Test ROC-AUC: 0.9081
ID Test Loss: 0.2333
OOD Validation ROC-AUC: 0.6243
OOD Validation Loss: 0.3584
OOD Test ROC-AUC: 0.6758
OOD Test Loss: 0.4758

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ROC-AUC: 0.9088
Train Loss: 0.2311
ID Validation ROC-AUC: 0.8849
ID Validation Loss: 0.2505
ID Test ROC-AUC: 0.8879
ID Test Loss: 0.2510
OOD Validation ROC-AUC: 0.6619
OOD Validation Loss: 0.3260
OOD Test ROC-AUC: 0.6983
OOD Test Loss: 0.4346

[0m[1;37mINFO[0m: [1mChartInfo 0.9081 0.6758 0.8879 0.6983 0.8849 0.6619[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:05:10 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:05:18 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.909
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.772
SUFF++ for r=0.6 class 0.0 = 0.658 +- 0.129 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 class 1.0 = 0.843 +- 0.129 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all KL = 0.865 +- 0.129 (in-sample avg dev_std = 0.228)
SUFF++ for r=0.6 all L1 = 0.821 +- 0.138 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.703
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.627
SUFF++ for r=0.6 class 0.0 = 0.73 +- 0.111 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.6 class 1.0 = 0.796 +- 0.111 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.6 all KL = 0.875 +- 0.111 (in-sample avg dev_std = 0.237)
SUFF++ for r=0.6 all L1 = 0.785 +- 0.122 (in-sample avg dev_std = 0.237)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.909
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.832
NEC for r=0.6 class 0.0 = 0.326 +- 0.141 (in-sample avg dev_std = 0.217)
NEC for r=0.6 class 1.0 = 0.165 +- 0.141 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all KL = 0.139 +- 0.141 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all L1 = 0.183 +- 0.135 (in-sample avg dev_std = 0.217)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.703
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.655
NEC for r=0.6 class 0.0 = 0.266 +- 0.124 (in-sample avg dev_std = 0.217)
NEC for r=0.6 class 1.0 = 0.205 +- 0.124 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all KL = 0.124 +- 0.124 (in-sample avg dev_std = 0.217)
NEC for r=0.6 all L1 = 0.216 +- 0.123 (in-sample avg dev_std = 0.217)
model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 19:06:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 07:06:22 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 07:06:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:02 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:12 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:28 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ROC-AUC: 0.9662
Train Loss: 0.1724
ID Validation ROC-AUC: 0.9138
ID Validation Loss: 0.3123
ID Test ROC-AUC: 0.9111
ID Test Loss: 0.3263
OOD Validation ROC-AUC: 0.5895
OOD Validation Loss: 0.6025
OOD Test ROC-AUC: 0.6681
OOD Test Loss: 0.7747

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 15...
[0m[1;37mINFO[0m: [1mCheckpoint 15: 
-----------------------------------
Train ROC-AUC: 0.9269
Train Loss: 0.2093
ID Validation ROC-AUC: 0.8991
ID Validation Loss: 0.2421
ID Test ROC-AUC: 0.9021
ID Test Loss: 0.2424
OOD Validation ROC-AUC: 0.6642
OOD Validation Loss: 0.3339
OOD Test ROC-AUC: 0.6850
OOD Test Loss: 0.4826

[0m[1;37mINFO[0m: [1mChartInfo 0.9111 0.6681 0.9021 0.6850 0.8991 0.6642[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:07:43 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:07:52 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.919
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.793
SUFF++ for r=0.6 class 0.0 = 0.621 +- 0.222 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.6 class 1.0 = 0.918 +- 0.222 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.6 all KL = 0.846 +- 0.222 (in-sample avg dev_std = 0.266)
SUFF++ for r=0.6 all L1 = 0.884 +- 0.182 (in-sample avg dev_std = 0.266)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.597
SUFF++ for r=0.6 class 0.0 = 0.724 +- 0.220 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.6 class 1.0 = 0.844 +- 0.220 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.6 all KL = 0.826 +- 0.220 (in-sample avg dev_std = 0.287)
SUFF++ for r=0.6 all L1 = 0.824 +- 0.207 (in-sample avg dev_std = 0.287)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.919
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.793
NEC for r=0.6 class 0.0 = 0.434 +- 0.259 (in-sample avg dev_std = 0.319)
NEC for r=0.6 class 1.0 = 0.135 +- 0.259 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all KL = 0.256 +- 0.259 (in-sample avg dev_std = 0.319)
NEC for r=0.6 all L1 = 0.17 +- 0.193 (in-sample avg dev_std = 0.319)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.711
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.649
NEC for r=0.6 class 0.0 = 0.367 +- 0.251 (in-sample avg dev_std = 0.385)
NEC for r=0.6 class 1.0 = 0.233 +- 0.251 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all KL = 0.298 +- 0.251 (in-sample avg dev_std = 0.385)
NEC for r=0.6 all L1 = 0.256 +- 0.200 (in-sample avg dev_std = 0.385)
model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 19:08:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 07:08:56 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 07:09:26 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 07:09:36 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 07:09:47 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ROC-AUC: 0.9661
Train Loss: 0.1473
ID Validation ROC-AUC: 0.9133
ID Validation Loss: 0.2363
ID Test ROC-AUC: 0.9109
ID Test Loss: 0.2418
OOD Validation ROC-AUC: 0.6302
OOD Validation Loss: 0.4522
OOD Test ROC-AUC: 0.6797
OOD Test Loss: 0.5703

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ROC-AUC: 0.9108
Train Loss: 0.2361
ID Validation ROC-AUC: 0.8892
ID Validation Loss: 0.2523
ID Test ROC-AUC: 0.8864
ID Test Loss: 0.2555
OOD Validation ROC-AUC: 0.6513
OOD Validation Loss: 0.3289
OOD Test ROC-AUC: 0.7073
OOD Test Loss: 0.4218

[0m[1;37mINFO[0m: [1mChartInfo 0.9109 0.6797 0.8864 0.7073 0.8892 0.6513[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:10:18 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:10:27 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.915
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.711
SUFF++ for r=0.6 class 0.0 = 0.571 +- 0.250 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 class 1.0 = 0.79 +- 0.250 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 all KL = 0.698 +- 0.250 (in-sample avg dev_std = 0.412)
SUFF++ for r=0.6 all L1 = 0.764 +- 0.181 (in-sample avg dev_std = 0.412)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.719
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.611
SUFF++ for r=0.6 class 0.0 = 0.644 +- 0.223 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 class 1.0 = 0.717 +- 0.223 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all KL = 0.721 +- 0.223 (in-sample avg dev_std = 0.422)
SUFF++ for r=0.6 all L1 = 0.705 +- 0.173 (in-sample avg dev_std = 0.422)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.915
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.793
NEC for r=0.6 class 0.0 = 0.375 +- 0.274 (in-sample avg dev_std = 0.402)
NEC for r=0.6 class 1.0 = 0.207 +- 0.274 (in-sample avg dev_std = 0.402)
NEC for r=0.6 all KL = 0.284 +- 0.274 (in-sample avg dev_std = 0.402)
NEC for r=0.6 all L1 = 0.226 +- 0.183 (in-sample avg dev_std = 0.402)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.719
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.641
NEC for r=0.6 class 0.0 = 0.34 +- 0.238 (in-sample avg dev_std = 0.420)
NEC for r=0.6 class 1.0 = 0.287 +- 0.238 (in-sample avg dev_std = 0.420)
NEC for r=0.6 all KL = 0.273 +- 0.238 (in-sample avg dev_std = 0.420)
NEC for r=0.6 all L1 = 0.296 +- 0.172 (in-sample avg dev_std = 0.420)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.943], 'all_L1': [0.952]}), defaultdict(<class 'list'>, {'all_KL': [0.861], 'all_L1': [0.868]}), defaultdict(<class 'list'>, {'all_KL': [0.865], 'all_L1': [0.821]}), defaultdict(<class 'list'>, {'all_KL': [0.846], 'all_L1': [0.884]}), defaultdict(<class 'list'>, {'all_KL': [0.698], 'all_L1': [0.764]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.088], 'all_L1': [0.065]}), defaultdict(<class 'list'>, {'all_KL': [0.188], 'all_L1': [0.16]}), defaultdict(<class 'list'>, {'all_KL': [0.139], 'all_L1': [0.183]}), defaultdict(<class 'list'>, {'all_KL': [0.256], 'all_L1': [0.17]}), defaultdict(<class 'list'>, {'all_KL': [0.284], 'all_L1': [0.226]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.939], 'all_L1': [0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.848], 'all_L1': [0.806]}), defaultdict(<class 'list'>, {'all_KL': [0.875], 'all_L1': [0.785]}), defaultdict(<class 'list'>, {'all_KL': [0.826], 'all_L1': [0.824]}), defaultdict(<class 'list'>, {'all_KL': [0.721], 'all_L1': [0.705]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.134], 'all_L1': [0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.195], 'all_L1': [0.229]}), defaultdict(<class 'list'>, {'all_KL': [0.124], 'all_L1': [0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.298], 'all_L1': [0.256]}), defaultdict(<class 'list'>, {'all_KL': [0.273], 'all_L1': [0.296]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.858 +- 0.063
suff++ class all_KL  =  0.843 +- 0.080
suff++_acc_int  =  0.753 +- 0.028
nec class all_L1  =  0.161 +- 0.053
nec class all_KL  =  0.191 +- 0.072
nec_acc_int  =  0.807 +- 0.043

Eval split test
suff++ class all_L1  =  0.812 +- 0.076
suff++ class all_KL  =  0.842 +- 0.071
suff++_acc_int  =  0.612 +- 0.010
nec class all_L1  =  0.220 +- 0.065
nec class all_KL  =  0.205 +- 0.071
nec_acc_int  =  0.649 +- 0.022


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.509 +- 0.011
Faith. Armon (L1)= 		  =  0.265 +- 0.076
Faith. GMean (L1)= 	  =  0.362 +- 0.059
Faith. Aritm (KL)= 		  =  0.517 +- 0.021
Faith. Armon (KL)= 		  =  0.301 +- 0.092
Faith. GMean (KL)= 	  =  0.390 +- 0.065

Eval split test
Faith. Aritm (L1)= 		  =  0.516 +- 0.015
Faith. Armon (L1)= 		  =  0.337 +- 0.081
Faith. GMean (L1)= 	  =  0.413 +- 0.055
Faith. Aritm (KL)= 		  =  0.523 +- 0.024
Faith. Armon (KL)= 		  =  0.321 +- 0.087
Faith. GMean (KL)= 	  =  0.406 +- 0.060
Computed for split load_split = id



Completed in  0:12:54.433292  for CIGAGIN LBAPcore/assay



DONE CIGA LBAPcore/assay LA
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 19:11:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 07:11:53 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 07:12:23 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 07:12:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 07:12:43 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 07:12:58 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:13:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ROC-AUC: 0.9925
Train Loss: 0.0975
ID Validation ROC-AUC: 0.9178
ID Validation Loss: 0.3060
ID Test ROC-AUC: 0.9170
ID Test Loss: 0.3147
OOD Validation ROC-AUC: 0.6215
OOD Validation Loss: 0.5097
OOD Test ROC-AUC: 0.6702
OOD Test Loss: 0.7230

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 8...
[0m[1;37mINFO[0m: [1mCheckpoint 8: 
-----------------------------------
Train ROC-AUC: 0.8878
Train Loss: 0.2467
ID Validation ROC-AUC: 0.8703
ID Validation Loss: 0.2604
ID Test ROC-AUC: 0.8722
ID Test Loss: 0.2607
OOD Validation ROC-AUC: 0.6813
OOD Validation Loss: 0.3373
OOD Test ROC-AUC: 0.6909
OOD Test Loss: 0.4560

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.6702 0.8722 0.6909 0.8703 0.6813[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:13:14 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:13:23 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.805
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.74
SUFF++ for r=0.6 class 0.0 = 0.981 +- 0.010 (in-sample avg dev_std = 0.015)
SUFF++ for r=0.6 class 1.0 = 0.995 +- 0.010 (in-sample avg dev_std = 0.015)
SUFF++ for r=0.6 all KL = 0.997 +- 0.010 (in-sample avg dev_std = 0.015)
SUFF++ for r=0.6 all L1 = 0.994 +- 0.024 (in-sample avg dev_std = 0.015)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.666
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.639
SUFF++ for r=0.6 class 0.0 = 0.973 +- 0.019 (in-sample avg dev_std = 0.022)
SUFF++ for r=0.6 class 1.0 = 0.992 +- 0.019 (in-sample avg dev_std = 0.022)
SUFF++ for r=0.6 all KL = 0.995 +- 0.019 (in-sample avg dev_std = 0.022)
SUFF++ for r=0.6 all L1 = 0.989 +- 0.037 (in-sample avg dev_std = 0.022)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.805
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.786
NEC for r=0.6 class 0.0 = 0.015 +- 0.005 (in-sample avg dev_std = 0.007)
NEC for r=0.6 class 1.0 = 0.003 +- 0.005 (in-sample avg dev_std = 0.007)
NEC for r=0.6 all KL = 0.001 +- 0.005 (in-sample avg dev_std = 0.007)
NEC for r=0.6 all L1 = 0.004 +- 0.019 (in-sample avg dev_std = 0.007)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.666
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.667
NEC for r=0.6 class 0.0 = 0.019 +- 0.006 (in-sample avg dev_std = 0.011)
NEC for r=0.6 class 1.0 = 0.004 +- 0.006 (in-sample avg dev_std = 0.011)
NEC for r=0.6 all KL = 0.001 +- 0.006 (in-sample avg dev_std = 0.011)
NEC for r=0.6 all L1 = 0.007 +- 0.024 (in-sample avg dev_std = 0.011)
model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 19:14:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 07:14:26 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 07:14:55 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:15 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:30 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:15:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 71...
[0m[1;37mINFO[0m: [1mCheckpoint 71: 
-----------------------------------
Train ROC-AUC: 0.9942
Train Loss: 0.0721
ID Validation ROC-AUC: 0.9179
ID Validation Loss: 0.2928
ID Test ROC-AUC: 0.9171
ID Test Loss: 0.2997
OOD Validation ROC-AUC: 0.6280
OOD Validation Loss: 0.5802
OOD Test ROC-AUC: 0.6756
OOD Test Loss: 0.7411

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ROC-AUC: 0.8761
Train Loss: 0.2569
ID Validation ROC-AUC: 0.8739
ID Validation Loss: 0.2600
ID Test ROC-AUC: 0.8719
ID Test Loss: 0.2637
OOD Validation ROC-AUC: 0.6912
OOD Validation Loss: 0.2846
OOD Test ROC-AUC: 0.7078
OOD Test Loss: 0.4249

[0m[1;37mINFO[0m: [1mChartInfo 0.9171 0.6756 0.8719 0.7078 0.8739 0.6912[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:15:46 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:15:54 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.78
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.735
SUFF++ for r=0.6 class 0.0 = 0.978 +- 0.006 (in-sample avg dev_std = 0.012)
SUFF++ for r=0.6 class 1.0 = 0.991 +- 0.006 (in-sample avg dev_std = 0.012)
SUFF++ for r=0.6 all KL = 0.998 +- 0.006 (in-sample avg dev_std = 0.012)
SUFF++ for r=0.6 all L1 = 0.99 +- 0.017 (in-sample avg dev_std = 0.012)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.655
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.618
SUFF++ for r=0.6 class 0.0 = 0.977 +- 0.007 (in-sample avg dev_std = 0.015)
SUFF++ for r=0.6 class 1.0 = 0.988 +- 0.007 (in-sample avg dev_std = 0.015)
SUFF++ for r=0.6 all KL = 0.998 +- 0.007 (in-sample avg dev_std = 0.015)
SUFF++ for r=0.6 all L1 = 0.986 +- 0.023 (in-sample avg dev_std = 0.015)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.78
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.768
NEC for r=0.6 class 0.0 = 0.013 +- 0.002 (in-sample avg dev_std = 0.006)
NEC for r=0.6 class 1.0 = 0.005 +- 0.002 (in-sample avg dev_std = 0.006)
NEC for r=0.6 all KL = 0.001 +- 0.002 (in-sample avg dev_std = 0.006)
NEC for r=0.6 all L1 = 0.006 +- 0.011 (in-sample avg dev_std = 0.006)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.655
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.654
NEC for r=0.6 class 0.0 = 0.014 +- 0.004 (in-sample avg dev_std = 0.008)
NEC for r=0.6 class 1.0 = 0.008 +- 0.004 (in-sample avg dev_std = 0.008)
NEC for r=0.6 all KL = 0.001 +- 0.004 (in-sample avg dev_std = 0.008)
NEC for r=0.6 all L1 = 0.009 +- 0.017 (in-sample avg dev_std = 0.008)
model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 19:16:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 07:16:58 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 07:17:27 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 07:17:38 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 07:17:48 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:03 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ROC-AUC: 0.9750
Train Loss: 0.1417
ID Validation ROC-AUC: 0.9182
ID Validation Loss: 0.2388
ID Test ROC-AUC: 0.9183
ID Test Loss: 0.2437
OOD Validation ROC-AUC: 0.6336
OOD Validation Loss: 0.4159
OOD Test ROC-AUC: 0.6692
OOD Test Loss: 0.5811

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 3...
[0m[1;37mINFO[0m: [1mCheckpoint 3: 
-----------------------------------
Train ROC-AUC: 0.8791
Train Loss: 0.2903
ID Validation ROC-AUC: 0.8687
ID Validation Loss: 0.2995
ID Test ROC-AUC: 0.8711
ID Test Loss: 0.2998
OOD Validation ROC-AUC: 0.6926
OOD Validation Loss: 0.2862
OOD Test ROC-AUC: 0.7124
OOD Test Loss: 0.4811

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.6692 0.8711 0.7124 0.8687 0.6926[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:18:18 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:18:27 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.767
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.68
SUFF++ for r=0.6 class 0.0 = 0.851 +- 0.026 (in-sample avg dev_std = 0.067)
SUFF++ for r=0.6 class 1.0 = 0.917 +- 0.026 (in-sample avg dev_std = 0.067)
SUFF++ for r=0.6 all KL = 0.975 +- 0.026 (in-sample avg dev_std = 0.067)
SUFF++ for r=0.6 all L1 = 0.909 +- 0.072 (in-sample avg dev_std = 0.067)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.652
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.608
SUFF++ for r=0.6 class 0.0 = 0.863 +- 0.028 (in-sample avg dev_std = 0.079)
SUFF++ for r=0.6 class 1.0 = 0.896 +- 0.028 (in-sample avg dev_std = 0.079)
SUFF++ for r=0.6 all KL = 0.97 +- 0.028 (in-sample avg dev_std = 0.079)
SUFF++ for r=0.6 all L1 = 0.891 +- 0.079 (in-sample avg dev_std = 0.079)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.767
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.73
NEC for r=0.6 class 0.0 = 0.11 +- 0.012 (in-sample avg dev_std = 0.030)
NEC for r=0.6 class 1.0 = 0.053 +- 0.012 (in-sample avg dev_std = 0.030)
NEC for r=0.6 all KL = 0.01 +- 0.012 (in-sample avg dev_std = 0.030)
NEC for r=0.6 all L1 = 0.06 +- 0.056 (in-sample avg dev_std = 0.030)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.652
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.639
NEC for r=0.6 class 0.0 = 0.108 +- 0.014 (in-sample avg dev_std = 0.034)
NEC for r=0.6 class 1.0 = 0.072 +- 0.014 (in-sample avg dev_std = 0.034)
NEC for r=0.6 all KL = 0.013 +- 0.014 (in-sample avg dev_std = 0.034)
NEC for r=0.6 all L1 = 0.078 +- 0.065 (in-sample avg dev_std = 0.034)
model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 19:19:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 07:19:30 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:00 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:10 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:20 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:35 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ROC-AUC: 0.9750
Train Loss: 0.1492
ID Validation ROC-AUC: 0.9191
ID Validation Loss: 0.2545
ID Test ROC-AUC: 0.9158
ID Test Loss: 0.2649
OOD Validation ROC-AUC: 0.6267
OOD Validation Loss: 0.4135
OOD Test ROC-AUC: 0.6863
OOD Test Loss: 0.5801

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ROC-AUC: 0.9012
Train Loss: 0.2347
ID Validation ROC-AUC: 0.8845
ID Validation Loss: 0.2520
ID Test ROC-AUC: 0.8857
ID Test Loss: 0.2551
OOD Validation ROC-AUC: 0.6780
OOD Validation Loss: 0.3280
OOD Test ROC-AUC: 0.7060
OOD Test Loss: 0.4756

[0m[1;37mINFO[0m: [1mChartInfo 0.9158 0.6863 0.8857 0.7060 0.8845 0.6780[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:20:50 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:20:59 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.502
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.541
SUFF++ for r=0.6 class 0.0 = 0.875 +- 0.029 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.6 class 1.0 = 0.895 +- 0.029 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.6 all KL = 0.969 +- 0.029 (in-sample avg dev_std = 0.110)
SUFF++ for r=0.6 all L1 = 0.893 +- 0.041 (in-sample avg dev_std = 0.110)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.512
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.524
SUFF++ for r=0.6 class 0.0 = 0.883 +- 0.029 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 class 1.0 = 0.892 +- 0.029 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all KL = 0.969 +- 0.029 (in-sample avg dev_std = 0.108)
SUFF++ for r=0.6 all L1 = 0.891 +- 0.043 (in-sample avg dev_std = 0.108)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.502
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.511
NEC for r=0.6 class 0.0 = 0.073 +- 0.007 (in-sample avg dev_std = 0.033)
NEC for r=0.6 class 1.0 = 0.071 +- 0.007 (in-sample avg dev_std = 0.033)
NEC for r=0.6 all KL = 0.01 +- 0.007 (in-sample avg dev_std = 0.033)
NEC for r=0.6 all L1 = 0.072 +- 0.022 (in-sample avg dev_std = 0.033)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.512
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.526
NEC for r=0.6 class 0.0 = 0.076 +- 0.007 (in-sample avg dev_std = 0.035)
NEC for r=0.6 class 1.0 = 0.072 +- 0.007 (in-sample avg dev_std = 0.035)
NEC for r=0.6 all KL = 0.01 +- 0.007 (in-sample avg dev_std = 0.035)
NEC for r=0.6 all L1 = 0.072 +- 0.024 (in-sample avg dev_std = 0.035)
model_dirname= repr_CIGAvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatmitig_readoutweightedavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Sep 22 19:22:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 09/22/2024 07:22:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/22/2024 07:22:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/22/2024 07:22:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/22/2024 07:22:52 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:07 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 68], node_perm=[31])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  weighted
[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mInit CIGAvGIN
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mInit Backbone:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mCreating vGINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mInit CLF:  3
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 09/22/2024 07:23:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 38...
[0m[1;37mINFO[0m: [1mCheckpoint 38: 
-----------------------------------
Train ROC-AUC: 0.9770
Train Loss: 0.1340
ID Validation ROC-AUC: 0.9225
ID Validation Loss: 0.2679
ID Test ROC-AUC: 0.9232
ID Test Loss: 0.2743
OOD Validation ROC-AUC: 0.6385
OOD Validation Loss: 0.5014
OOD Test ROC-AUC: 0.6848
OOD Test Loss: 0.6911

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ROC-AUC: 0.8995
Train Loss: 0.2412
ID Validation ROC-AUC: 0.8839
ID Validation Loss: 0.2545
ID Test ROC-AUC: 0.8857
ID Test Loss: 0.2576
OOD Validation ROC-AUC: 0.6922
OOD Validation Loss: 0.2925
OOD Test ROC-AUC: 0.7003
OOD Test Loss: 0.4517

[0m[1;37mINFO[0m: [1mChartInfo 0.9232 0.6848 0.8857 0.7003 0.8839 0.6922[0mLBAPcore(11314)
Data example from id_val: Data(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 66], node_perm=[30])
Label distribution from id_val: (tensor([0., 1.]), tensor([1318, 9996]))
[1;34mDEBUG[0m: 09/22/2024 07:23:23 PM : [1mUnbalanced warning for LBAPcore (id_val)
[0m/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan
LBAPcore(19032)
Data example from test: Data(x=[28, 39], edge_index=[2, 64], edge_attr=[64, 10], y=[1, 1], env_id=[1], ori_edge_index=[2, 64], node_perm=[28])
Label distribution from test: (tensor([0., 1.]), tensor([ 3168, 15864]))
[1;34mDEBUG[0m: 09/22/2024 07:23:31 PM : [1mUnbalanced warning for LBAPcore (test)
[0mF1 for r=0.6 = nan
WIoU for r=0.6 = nan
F1 for r=1.0 = nan
WIoU for r=1.0 = nan


Evaluating SUFF++ for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF++ over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.587
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.559
SUFF++ for r=0.6 class 0.0 = 0.881 +- 0.038 (in-sample avg dev_std = 0.078)
SUFF++ for r=0.6 class 1.0 = 0.899 +- 0.038 (in-sample avg dev_std = 0.078)
SUFF++ for r=0.6 all KL = 0.97 +- 0.038 (in-sample avg dev_std = 0.078)
SUFF++ for r=0.6 all L1 = 0.897 +- 0.079 (in-sample avg dev_std = 0.078)



--------------------------------------------------


#D#Computing SUFF++ over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.531
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.529
SUFF++ for r=0.6 class 0.0 = 0.889 +- 0.032 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.6 class 1.0 = 0.895 +- 0.032 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.6 all KL = 0.97 +- 0.032 (in-sample avg dev_std = 0.085)
SUFF++ for r=0.6 all L1 = 0.894 +- 0.072 (in-sample avg dev_std = 0.085)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.587
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.607 +- 0.005
Model ROC-AUC over intervened graphs for r=0.6 =  0.644
NEC for r=0.6 class 0.0 = 0.067 +- 0.021 (in-sample avg dev_std = 0.045)
NEC for r=0.6 class 1.0 = 0.069 +- 0.021 (in-sample avg dev_std = 0.045)
NEC for r=0.6 all KL = 0.013 +- 0.021 (in-sample avg dev_std = 0.045)
NEC for r=0.6 all L1 = 0.069 +- 0.063 (in-sample avg dev_std = 0.045)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=False)


ratio=0.6


Computing with masking

Model ROC-AUC of binarized graphs for r=0.6 =  0.531
Model XAI F1 of binarized graphs for r=0.6 =  nan
Model XAI WIoU of binarized graphs for r=0.6 =  nan
len(reference) = 800
Effective ratio: 0.608 +- 0.006
Model ROC-AUC over intervened graphs for r=0.6 =  0.581
NEC for r=0.6 class 0.0 = 0.064 +- 0.016 (in-sample avg dev_std = 0.042)
NEC for r=0.6 class 1.0 = 0.068 +- 0.016 (in-sample avg dev_std = 0.042)
NEC for r=0.6 all KL = 0.012 +- 0.016 (in-sample avg dev_std = 0.042)
NEC for r=0.6 all L1 = 0.068 +- 0.055 (in-sample avg dev_std = 0.042)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.997], 'all_L1': [0.994]}), defaultdict(<class 'list'>, {'all_KL': [0.998], 'all_L1': [0.99]}), defaultdict(<class 'list'>, {'all_KL': [0.975], 'all_L1': [0.909]}), defaultdict(<class 'list'>, {'all_KL': [0.969], 'all_L1': [0.893]}), defaultdict(<class 'list'>, {'all_KL': [0.97], 'all_L1': [0.897]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.001], 'all_L1': [0.004]}), defaultdict(<class 'list'>, {'all_KL': [0.001], 'all_L1': [0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.01], 'all_L1': [0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.01], 'all_L1': [0.072]}), defaultdict(<class 'list'>, {'all_KL': [0.013], 'all_L1': [0.069]})]

Eval split test
suff++ = [defaultdict(<class 'list'>, {'all_KL': [0.995], 'all_L1': [0.989]}), defaultdict(<class 'list'>, {'all_KL': [0.998], 'all_L1': [0.986]}), defaultdict(<class 'list'>, {'all_KL': [0.97], 'all_L1': [0.891]}), defaultdict(<class 'list'>, {'all_KL': [0.969], 'all_L1': [0.891]}), defaultdict(<class 'list'>, {'all_KL': [0.97], 'all_L1': [0.894]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.001], 'all_L1': [0.007]}), defaultdict(<class 'list'>, {'all_KL': [0.001], 'all_L1': [0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.013], 'all_L1': [0.078]}), defaultdict(<class 'list'>, {'all_KL': [0.01], 'all_L1': [0.072]}), defaultdict(<class 'list'>, {'all_KL': [0.012], 'all_L1': [0.068]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff++ class all_L1  =  0.937 +- 0.046
suff++ class all_KL  =  0.982 +- 0.013
suff++_acc_int  =  0.651 +- 0.085
nec class all_L1  =  0.042 +- 0.031
nec class all_KL  =  0.007 +- 0.005
nec_acc_int  =  0.688 +- 0.101

Eval split test
suff++ class all_L1  =  0.930 +- 0.047
suff++ class all_KL  =  0.980 +- 0.013
suff++_acc_int  =  0.584 +- 0.048
nec class all_L1  =  0.047 +- 0.032
nec class all_KL  =  0.007 +- 0.005
nec_acc_int  =  0.614 +- 0.053


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.489 +- 0.007
Faith. Armon (L1)= 		  =  0.079 +- 0.057
Faith. GMean (L1)= 	  =  0.175 +- 0.086
Faith. Aritm (KL)= 		  =  0.494 +- 0.004
Faith. Armon (KL)= 		  =  0.014 +- 0.010
Faith. GMean (KL)= 	  =  0.075 +- 0.035

Eval split test
Faith. Aritm (L1)= 		  =  0.488 +- 0.008
Faith. Armon (L1)= 		  =  0.087 +- 0.058
Faith. GMean (L1)= 	  =  0.188 +- 0.081
Faith. Aritm (KL)= 		  =  0.494 +- 0.004
Faith. Armon (KL)= 		  =  0.015 +- 0.010
Faith. GMean (KL)= 	  =  0.076 +- 0.037
Computed for split load_split = id



Completed in  0:12:43.468882  for CIGAvGIN LBAPcore/assay



DONE CIGA LBAPcore/assay ER
DONE all :)
