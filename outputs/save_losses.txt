nohup: ignoring input
Time to train models!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:43:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:43:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.4334
ID Test ACCURACY: 0.9151
ID Test Loss: 0.4930
OOD Validation ACCURACY: 0.8823
OOD Validation Loss: 0.6328
OOD Test ACCURACY: 0.8311
OOD Test Loss: 1.1309

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9172
ID Validation Loss: 0.4056
ID Test ACCURACY: 0.9130
ID Test Loss: 0.4650
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.6111
OOD Test ACCURACY: 0.8308
OOD Test Loss: 1.1121

[0m[1;37mINFO[0m: [1mChartInfo 0.9151 0.8311 0.9130 0.8308 0.9172 0.8837[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9210Id_val Loss: 0.4334
Val ACCURACY: 0.8823Val Loss: 0.6328
Test ACCURACY: 0.8311Test Loss: 1.1309
[1;34mDEBUG[0m: 04/04/2024 01:44:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9210
ID Validation Loss: 0.4334
ID Test ACCURACY: 0.9151
ID Test Loss: 0.4930
OOD Validation ACCURACY: 0.8823
OOD Validation Loss: 0.6328
OOD Test ACCURACY: 0.8311
OOD Test Loss: 1.1309

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 162...
[0m[1;37mINFO[0m: [1mCheckpoint 162: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9172
ID Validation Loss: 0.4056
ID Test ACCURACY: 0.9130
ID Test Loss: 0.4650
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.6111
OOD Test ACCURACY: 0.8308
OOD Test Loss: 1.1121

[0m[1;37mINFO[0m: [1mChartInfo 0.9151 0.8311 0.9130 0.8308 0.9172 0.8837[0mTrain ACCURACY: 0.9999Train Loss: 0.0004
Id_val ACCURACY: 0.9172Id_val Loss: 0.4056
Val ACCURACY: 0.8837Val Loss: 0.6111
Test ACCURACY: 0.8308Test Loss: 1.1121
Printing obtained and stored scores: 0.8307604345340195 !=? 0.8307604345340195


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:44:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:44:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9219
ID Validation Loss: 0.4149
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4712
OOD Validation ACCURACY: 0.8844
OOD Validation Loss: 0.6335
OOD Test ACCURACY: 0.8226
OOD Test Loss: 1.5522

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9206
ID Validation Loss: 0.4566
ID Test ACCURACY: 0.9164
ID Test Loss: 0.5199
OOD Validation ACCURACY: 0.8857
OOD Validation Loss: 0.7013
OOD Test ACCURACY: 0.8256
OOD Test Loss: 1.5657

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.8226 0.9164 0.8256 0.9206 0.8857[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9999Train Loss: 0.0004
Id_val ACCURACY: 0.9219Id_val Loss: 0.4149
Val ACCURACY: 0.8844Val Loss: 0.6335
Test ACCURACY: 0.8226Test Loss: 1.5522
[1;34mDEBUG[0m: 04/04/2024 01:45:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9999
Train Loss: 0.0004
ID Validation ACCURACY: 0.9219
ID Validation Loss: 0.4149
ID Test ACCURACY: 0.9153
ID Test Loss: 0.4712
OOD Validation ACCURACY: 0.8844
OOD Validation Loss: 0.6335
OOD Test ACCURACY: 0.8226
OOD Test Loss: 1.5522

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9206
ID Validation Loss: 0.4566
ID Test ACCURACY: 0.9164
ID Test Loss: 0.5199
OOD Validation ACCURACY: 0.8857
OOD Validation Loss: 0.7013
OOD Test ACCURACY: 0.8256
OOD Test Loss: 1.5657

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.8226 0.9164 0.8256 0.9206 0.8857[0mTrain ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9206Id_val Loss: 0.4566
Val ACCURACY: 0.8857Val Loss: 0.7013
Test ACCURACY: 0.8256Test Loss: 1.5657
Printing obtained and stored scores: 0.825557461406518 !=? 0.825557461406518


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:45:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:45:52 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:45:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9217
ID Validation Loss: 0.4089
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4793
OOD Validation ACCURACY: 0.8800
OOD Validation Loss: 0.6717
OOD Test ACCURACY: 0.8278
OOD Test Loss: 1.4934

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0032
ID Validation ACCURACY: 0.9189
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9128
ID Test Loss: 0.3801
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.5452
OOD Test ACCURACY: 0.8331
OOD Test Loss: 1.2119

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.8278 0.9128 0.8331 0.9189 0.8837[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9217Id_val Loss: 0.4089
Val ACCURACY: 0.8800Val Loss: 0.6717
Test ACCURACY: 0.8278Test Loss: 1.4934
[1;34mDEBUG[0m: 04/04/2024 01:46:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 176...
[0m[1;37mINFO[0m: [1mCheckpoint 176: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9217
ID Validation Loss: 0.4089
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4793
OOD Validation ACCURACY: 0.8800
OOD Validation Loss: 0.6717
OOD Test ACCURACY: 0.8278
OOD Test Loss: 1.4934

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0032
ID Validation ACCURACY: 0.9189
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9128
ID Test Loss: 0.3801
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.5452
OOD Test ACCURACY: 0.8331
OOD Test Loss: 1.2119

[0m[1;37mINFO[0m: [1mChartInfo 0.9170 0.8278 0.9128 0.8331 0.9189 0.8837[0mTrain ACCURACY: 0.9996Train Loss: 0.0032
Id_val ACCURACY: 0.9189Id_val Loss: 0.3261
Val ACCURACY: 0.8837Val Loss: 0.5452
Test ACCURACY: 0.8331Test Loss: 1.2119
Printing obtained and stored scores: 0.8331046312178387 !=? 0.8331046312178387


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:46:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:46:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9225
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.9176
ID Test Loss: 0.4755
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.6167
OOD Test ACCURACY: 0.8206
OOD Test Loss: 1.3282

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9204
ID Validation Loss: 0.4402
ID Test ACCURACY: 0.9183
ID Test Loss: 0.5109
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6529
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.3708

[0m[1;37mINFO[0m: [1mChartInfo 0.9176 0.8206 0.9183 0.8255 0.9204 0.8846[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9225Id_val Loss: 0.4107
Val ACCURACY: 0.8817Val Loss: 0.6167
Test ACCURACY: 0.8206Test Loss: 1.3282
[1;34mDEBUG[0m: 04/04/2024 01:47:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 180...
[0m[1;37mINFO[0m: [1mCheckpoint 180: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9225
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.9176
ID Test Loss: 0.4755
OOD Validation ACCURACY: 0.8817
OOD Validation Loss: 0.6167
OOD Test ACCURACY: 0.8206
OOD Test Loss: 1.3282

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9204
ID Validation Loss: 0.4402
ID Test ACCURACY: 0.9183
ID Test Loss: 0.5109
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6529
OOD Test ACCURACY: 0.8255
OOD Test Loss: 1.3708

[0m[1;37mINFO[0m: [1mChartInfo 0.9176 0.8206 0.9183 0.8255 0.9204 0.8846[0mTrain ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9204Id_val Loss: 0.4402
Val ACCURACY: 0.8846Val Loss: 0.6529
Test ACCURACY: 0.8255Test Loss: 1.3708
Printing obtained and stored scores: 0.8255002858776443 !=? 0.8255002858776443


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:47:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:47:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.4313
ID Test ACCURACY: 0.9178
ID Test Loss: 0.4948
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.6848
OOD Test ACCURACY: 0.8338
OOD Test Loss: 1.5415

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9178
ID Validation Loss: 0.4301
ID Test ACCURACY: 0.9166
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8847
OOD Validation Loss: 0.6580
OOD Test ACCURACY: 0.8312
OOD Test Loss: 1.4830

[0m[1;37mINFO[0m: [1mChartInfo 0.9178 0.8338 0.9166 0.8312 0.9178 0.8847[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9208Id_val Loss: 0.4313
Val ACCURACY: 0.8829Val Loss: 0.6848
Test ACCURACY: 0.8338Test Loss: 1.5415
[1;34mDEBUG[0m: 04/04/2024 01:48:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 175...
[0m[1;37mINFO[0m: [1mCheckpoint 175: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9208
ID Validation Loss: 0.4313
ID Test ACCURACY: 0.9178
ID Test Loss: 0.4948
OOD Validation ACCURACY: 0.8829
OOD Validation Loss: 0.6848
OOD Test ACCURACY: 0.8338
OOD Test Loss: 1.5415

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.9178
ID Validation Loss: 0.4301
ID Test ACCURACY: 0.9166
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8847
OOD Validation Loss: 0.6580
OOD Test ACCURACY: 0.8312
OOD Test Loss: 1.4830

[0m[1;37mINFO[0m: [1mChartInfo 0.9178 0.8338 0.9166 0.8312 0.9178 0.8847[0mTrain ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.9178Id_val Loss: 0.4301
Val ACCURACY: 0.8847Val Loss: 0.6580
Test ACCURACY: 0.8312Test Loss: 1.4830
Printing obtained and stored scores: 0.8312178387650085 !=? 0.8312178387650085


Final accuracies: 
TRAIN      = 1.000 +- 0.000
ID_VAL     = 0.922 +- 0.001
VAL        = 0.882 +- 0.001
TEST       = 0.827 +- 0.005
OOD_TRAIN  = 1.000 +- 0.000
OOD_ID_VAL = 0.919 +- 0.001
OOD_VAL    = 0.884 +- 0.001
OOD_TEST   = 0.829 +- 0.003

Final losses: 
TRAIN      = 0.0003 +- 0.0001
ID_VAL     = 0.4198 +- 0.0104
VAL        = 0.6479 +- 0.0258
TEST       = 1.4092 +- 0.1607
OOD_TRAIN  = 0.0008 +- 0.0012
OOD_ID_VAL = 0.4117 +- 0.0459
OOD_VAL    = 0.6337 +- 0.0527
OOD_TEST   = 1.3487 +- 0.1675
Diff id_val-test  = 0.9894 
Diff id_val-test ood_ = 0.9370 

DONE TRAIN LECI GOODSST2/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:48:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:00 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:00 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:49:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8762
ID Validation Loss: 0.4772
ID Test ACCURACY: 0.8732
ID Test Loss: 0.5405
OOD Validation ACCURACY: 0.8785
OOD Validation Loss: 0.6693
OOD Test ACCURACY: 0.8286
OOD Test Loss: 1.1668

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0752
ID Validation ACCURACY: 0.8738
ID Validation Loss: 0.4331
ID Test ACCURACY: 0.8747
ID Test Loss: 0.4825
OOD Validation ACCURACY: 0.8831
OOD Validation Loss: 0.5611
OOD Test ACCURACY: 0.8341
OOD Test Loss: 0.9574

[0m[1;37mINFO[0m: [1mChartInfo 0.8732 0.8286 0.8747 0.8341 0.8738 0.8831[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9489Train Loss: 0.0751
Id_val ACCURACY: 0.8762Id_val Loss: 0.4772
Val ACCURACY: 0.8785Val Loss: 0.6693
Test ACCURACY: 0.8286Test Loss: 1.1668
[1;34mDEBUG[0m: 04/04/2024 01:49:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 171...
[0m[1;37mINFO[0m: [1mCheckpoint 171: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8762
ID Validation Loss: 0.4772
ID Test ACCURACY: 0.8732
ID Test Loss: 0.5405
OOD Validation ACCURACY: 0.8785
OOD Validation Loss: 0.6693
OOD Test ACCURACY: 0.8286
OOD Test Loss: 1.1668

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 155...
[0m[1;37mINFO[0m: [1mCheckpoint 155: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0752
ID Validation ACCURACY: 0.8738
ID Validation Loss: 0.4331
ID Test ACCURACY: 0.8747
ID Test Loss: 0.4825
OOD Validation ACCURACY: 0.8831
OOD Validation Loss: 0.5611
OOD Test ACCURACY: 0.8341
OOD Test Loss: 0.9574

[0m[1;37mINFO[0m: [1mChartInfo 0.8732 0.8286 0.8747 0.8341 0.8738 0.8831[0mTrain ACCURACY: 0.9489Train Loss: 0.0752
Id_val ACCURACY: 0.8738Id_val Loss: 0.4331
Val ACCURACY: 0.8831Val Loss: 0.5611
Test ACCURACY: 0.8341Test Loss: 0.9574
Printing obtained and stored scores: 0.8341337907375643 !=? 0.8341337907375643


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:49:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8810
ID Validation Loss: 0.5004
ID Test ACCURACY: 0.8753
ID Test Loss: 0.5729
OOD Validation ACCURACY: 0.8835
OOD Validation Loss: 0.6764
OOD Test ACCURACY: 0.8298
OOD Test Loss: 1.2856

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8795
ID Validation Loss: 0.4785
ID Test ACCURACY: 0.8753
ID Test Loss: 0.5475
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6262
OOD Test ACCURACY: 0.8300
OOD Test Loss: 1.0355

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8298 0.8753 0.8300 0.8795 0.8846[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9489Train Loss: 0.0750
Id_val ACCURACY: 0.8810Id_val Loss: 0.5004
Val ACCURACY: 0.8835Val Loss: 0.6764
Test ACCURACY: 0.8298Test Loss: 1.2856
[1;34mDEBUG[0m: 04/04/2024 01:50:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8810
ID Validation Loss: 0.5004
ID Test ACCURACY: 0.8753
ID Test Loss: 0.5729
OOD Validation ACCURACY: 0.8835
OOD Validation Loss: 0.6764
OOD Test ACCURACY: 0.8298
OOD Test Loss: 1.2856

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8795
ID Validation Loss: 0.4785
ID Test ACCURACY: 0.8753
ID Test Loss: 0.5475
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6262
OOD Test ACCURACY: 0.8300
OOD Test Loss: 1.0355

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8298 0.8753 0.8300 0.8795 0.8846[0mTrain ACCURACY: 0.9489Train Loss: 0.0751
Id_val ACCURACY: 0.8795Id_val Loss: 0.4785
Val ACCURACY: 0.8846Val Loss: 0.6262
Test ACCURACY: 0.8300Test Loss: 1.0355
Printing obtained and stored scores: 0.830017152658662 !=? 0.830017152658662


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:50:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:50:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 159...
[0m[1;37mINFO[0m: [1mCheckpoint 159: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0752
ID Validation ACCURACY: 0.8796
ID Validation Loss: 0.4389
ID Test ACCURACY: 0.8757
ID Test Loss: 0.4942
OOD Validation ACCURACY: 0.8781
OOD Validation Loss: 0.5616
OOD Test ACCURACY: 0.8223
OOD Test Loss: 0.8763

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0772
ID Validation ACCURACY: 0.8764
ID Validation Loss: 0.3801
ID Test ACCURACY: 0.8732
ID Test Loss: 0.4337
OOD Validation ACCURACY: 0.8807
OOD Validation Loss: 0.4866
OOD Test ACCURACY: 0.8229
OOD Test Loss: 0.8869

[0m[1;37mINFO[0m: [1mChartInfo 0.8757 0.8223 0.8732 0.8229 0.8764 0.8807[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9489Train Loss: 0.0752
Id_val ACCURACY: 0.8796Id_val Loss: 0.4389
Val ACCURACY: 0.8781Val Loss: 0.5616
Test ACCURACY: 0.8223Test Loss: 0.8763
[1;34mDEBUG[0m: 04/04/2024 01:51:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 159...
[0m[1;37mINFO[0m: [1mCheckpoint 159: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0752
ID Validation ACCURACY: 0.8796
ID Validation Loss: 0.4389
ID Test ACCURACY: 0.8757
ID Test Loss: 0.4942
OOD Validation ACCURACY: 0.8781
OOD Validation Loss: 0.5616
OOD Test ACCURACY: 0.8223
OOD Test Loss: 0.8763

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0772
ID Validation ACCURACY: 0.8764
ID Validation Loss: 0.3801
ID Test ACCURACY: 0.8732
ID Test Loss: 0.4337
OOD Validation ACCURACY: 0.8807
OOD Validation Loss: 0.4866
OOD Test ACCURACY: 0.8229
OOD Test Loss: 0.8869

[0m[1;37mINFO[0m: [1mChartInfo 0.8757 0.8223 0.8732 0.8229 0.8764 0.8807[0mTrain ACCURACY: 0.9488Train Loss: 0.0772
Id_val ACCURACY: 0.8764Id_val Loss: 0.3801
Val ACCURACY: 0.8807Val Loss: 0.4866
Test ACCURACY: 0.8229Test Loss: 0.8869
Printing obtained and stored scores: 0.8228702115494568 !=? 0.8228702115494568


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:51:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:51:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0758
ID Validation ACCURACY: 0.8795
ID Validation Loss: 0.3939
ID Test ACCURACY: 0.8734
ID Test Loss: 0.4467
OOD Validation ACCURACY: 0.8811
OOD Validation Loss: 0.5654
OOD Test ACCURACY: 0.8098
OOD Test Loss: 1.1500

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8776
ID Validation Loss: 0.4561
ID Test ACCURACY: 0.8779
ID Test Loss: 0.5161
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6825
OOD Test ACCURACY: 0.8120
OOD Test Loss: 1.3717

[0m[1;37mINFO[0m: [1mChartInfo 0.8734 0.8098 0.8779 0.8120 0.8776 0.8846[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9489Train Loss: 0.0758
Id_val ACCURACY: 0.8795Id_val Loss: 0.3939
Val ACCURACY: 0.8811Val Loss: 0.5654
Test ACCURACY: 0.8098Test Loss: 1.1500
[1;34mDEBUG[0m: 04/04/2024 01:52:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 142...
[0m[1;37mINFO[0m: [1mCheckpoint 142: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0758
ID Validation ACCURACY: 0.8795
ID Validation Loss: 0.3939
ID Test ACCURACY: 0.8734
ID Test Loss: 0.4467
OOD Validation ACCURACY: 0.8811
OOD Validation Loss: 0.5654
OOD Test ACCURACY: 0.8098
OOD Test Loss: 1.1500

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 193...
[0m[1;37mINFO[0m: [1mCheckpoint 193: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0751
ID Validation ACCURACY: 0.8776
ID Validation Loss: 0.4561
ID Test ACCURACY: 0.8779
ID Test Loss: 0.5161
OOD Validation ACCURACY: 0.8846
OOD Validation Loss: 0.6825
OOD Test ACCURACY: 0.8120
OOD Test Loss: 1.3717

[0m[1;37mINFO[0m: [1mChartInfo 0.8734 0.8098 0.8779 0.8120 0.8776 0.8846[0mTrain ACCURACY: 0.9489Train Loss: 0.0751
Id_val ACCURACY: 0.8776Id_val Loss: 0.4561
Val ACCURACY: 0.8846Val Loss: 0.6825
Test ACCURACY: 0.8120Test Loss: 1.3717
Printing obtained and stored scores: 0.8120068610634649 !=? 0.8120068610634649


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:52:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:52 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:52 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:52 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:52:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8781
ID Validation Loss: 0.5140
ID Test ACCURACY: 0.8742
ID Test Loss: 0.5848
OOD Validation ACCURACY: 0.8821
OOD Validation Loss: 0.6982
OOD Test ACCURACY: 0.8264
OOD Test Loss: 1.2184

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8755
ID Validation Loss: 0.4966
ID Test ACCURACY: 0.8761
ID Test Loss: 0.5645
OOD Validation ACCURACY: 0.8860
OOD Validation Loss: 0.6638
OOD Test ACCURACY: 0.8338
OOD Test Loss: 1.0510

[0m[1;37mINFO[0m: [1mChartInfo 0.8742 0.8264 0.8761 0.8338 0.8755 0.8860[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9489Train Loss: 0.0750
Id_val ACCURACY: 0.8781Id_val Loss: 0.5140
Val ACCURACY: 0.8821Val Loss: 0.6982
Test ACCURACY: 0.8264Test Loss: 1.2184
[1;34mDEBUG[0m: 04/04/2024 01:53:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8781
ID Validation Loss: 0.5140
ID Test ACCURACY: 0.8742
ID Test Loss: 0.5848
OOD Validation ACCURACY: 0.8821
OOD Validation Loss: 0.6982
OOD Test ACCURACY: 0.8264
OOD Test Loss: 1.2184

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0750
ID Validation ACCURACY: 0.8755
ID Validation Loss: 0.4966
ID Test ACCURACY: 0.8761
ID Test Loss: 0.5645
OOD Validation ACCURACY: 0.8860
OOD Validation Loss: 0.6638
OOD Test ACCURACY: 0.8338
OOD Test Loss: 1.0510

[0m[1;37mINFO[0m: [1mChartInfo 0.8742 0.8264 0.8761 0.8338 0.8755 0.8860[0mTrain ACCURACY: 0.9489Train Loss: 0.0750
Id_val ACCURACY: 0.8755Id_val Loss: 0.4966
Val ACCURACY: 0.8860Val Loss: 0.6638
Test ACCURACY: 0.8338Test Loss: 1.0510
Printing obtained and stored scores: 0.8338479130931961 !=? 0.8338479130931961


Final accuracies: 
TRAIN      = 0.949 +- 0.000
ID_VAL     = 0.879 +- 0.002
VAL        = 0.881 +- 0.002
TEST       = 0.823 +- 0.007
OOD_TRAIN  = 0.949 +- 0.000
OOD_ID_VAL = 0.877 +- 0.002
OOD_VAL    = 0.884 +- 0.002
OOD_TEST   = 0.827 +- 0.008

Final losses: 
TRAIN      = 0.0752 +- 0.0003
ID_VAL     = 0.4649 +- 0.0437
VAL        = 0.6342 +- 0.0585
TEST       = 1.1394 +- 0.1398
OOD_TRAIN  = 0.0755 +- 0.0008
OOD_ID_VAL = 0.4489 +- 0.0405
OOD_VAL    = 0.6040 +- 0.0719
OOD_TEST   = 1.0605 +- 0.1663
Diff id_val-test  = 0.6746 
Diff id_val-test ood_ = 0.6116 

DONE TRAIN LECI GOODSST2/length mitigation_readout

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:54:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ACCURACY: 0.9819
Train Loss: 0.0593
ID Validation ACCURACY: 0.6877
ID Validation Loss: 1.6620
ID Test ACCURACY: 0.6462
ID Test Loss: 1.7034
OOD Validation ACCURACY: 0.5798
OOD Validation Loss: 2.5076
OOD Test ACCURACY: 0.5333
OOD Test Loss: 3.8144

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ACCURACY: 0.7409
Train Loss: 0.6367
ID Validation ACCURACY: 0.6643
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.6841
ID Test Loss: 0.7824
OOD Validation ACCURACY: 0.6213
OOD Validation Loss: 0.9502
OOD Test ACCURACY: 0.5765
OOD Test Loss: 1.1552

[0m[1;37mINFO[0m: [1mChartInfo 0.6462 0.5333 0.6841 0.5765 0.6643 0.6213[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9819Train Loss: 0.0593
Id_val ACCURACY: 0.6877Id_val Loss: 1.6621
Val ACCURACY: 0.5798Val Loss: 2.5075
Test ACCURACY: 0.5333Test Loss: 3.8142
[1;34mDEBUG[0m: 04/04/2024 01:54:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 35...
[0m[1;37mINFO[0m: [1mCheckpoint 35: 
-----------------------------------
Train ACCURACY: 0.9819
Train Loss: 0.0593
ID Validation ACCURACY: 0.6877
ID Validation Loss: 1.6620
ID Test ACCURACY: 0.6462
ID Test Loss: 1.7034
OOD Validation ACCURACY: 0.5798
OOD Validation Loss: 2.5076
OOD Test ACCURACY: 0.5333
OOD Test Loss: 3.8144

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 7...
[0m[1;37mINFO[0m: [1mCheckpoint 7: 
-----------------------------------
Train ACCURACY: 0.7409
Train Loss: 0.6367
ID Validation ACCURACY: 0.6643
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.6841
ID Test Loss: 0.7824
OOD Validation ACCURACY: 0.6213
OOD Validation Loss: 0.9502
OOD Test ACCURACY: 0.5765
OOD Test Loss: 1.1552

[0m[1;37mINFO[0m: [1mChartInfo 0.6462 0.5333 0.6841 0.5765 0.6643 0.6213[0mTrain ACCURACY: 0.7409Train Loss: 0.6367
Id_val ACCURACY: 0.6643Id_val Loss: 0.8007
Val ACCURACY: 0.6213Val Loss: 0.9502
Test ACCURACY: 0.5772Test Loss: 1.1553
Printing obtained and stored scores: 0.577213452299245 !=? 0.5765271105010296


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:54:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ACCURACY: 0.9873
Train Loss: 0.0557
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.2333
ID Test ACCURACY: 0.6751
ID Test Loss: 1.2914
OOD Validation ACCURACY: 0.6235
OOD Validation Loss: 1.5984
OOD Test ACCURACY: 0.5710
OOD Test Loss: 2.1738

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 10...
[0m[1;37mINFO[0m: [1mCheckpoint 10: 
-----------------------------------
Train ACCURACY: 0.8039
Train Loss: 0.4968
ID Validation ACCURACY: 0.6949
ID Validation Loss: 0.7512
ID Test ACCURACY: 0.6931
ID Test Loss: 0.7845
OOD Validation ACCURACY: 0.6476
OOD Validation Loss: 0.9328
OOD Test ACCURACY: 0.5779
OOD Test Loss: 1.2430

[0m[1;37mINFO[0m: [1mChartInfo 0.6751 0.5710 0.6931 0.5779 0.6949 0.6476[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9873Train Loss: 0.0557
Id_val ACCURACY: 0.7040Id_val Loss: 1.2333
Val ACCURACY: 0.6235Val Loss: 1.5984
Test ACCURACY: 0.5710Test Loss: 2.1738
[1;34mDEBUG[0m: 04/04/2024 01:54:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 32...
[0m[1;37mINFO[0m: [1mCheckpoint 32: 
-----------------------------------
Train ACCURACY: 0.9873
Train Loss: 0.0557
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.2333
ID Test ACCURACY: 0.6751
ID Test Loss: 1.2914
OOD Validation ACCURACY: 0.6235
OOD Validation Loss: 1.5984
OOD Test ACCURACY: 0.5710
OOD Test Loss: 2.1738

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 10...
[0m[1;37mINFO[0m: [1mCheckpoint 10: 
-----------------------------------
Train ACCURACY: 0.8039
Train Loss: 0.4968
ID Validation ACCURACY: 0.6949
ID Validation Loss: 0.7512
ID Test ACCURACY: 0.6931
ID Test Loss: 0.7845
OOD Validation ACCURACY: 0.6476
OOD Validation Loss: 0.9328
OOD Test ACCURACY: 0.5779
OOD Test Loss: 1.2430

[0m[1;37mINFO[0m: [1mChartInfo 0.6751 0.5710 0.6931 0.5779 0.6949 0.6476[0mTrain ACCURACY: 0.8039Train Loss: 0.4968
Id_val ACCURACY: 0.6949Id_val Loss: 0.7512
Val ACCURACY: 0.6476Val Loss: 0.9327
Test ACCURACY: 0.5779Test Loss: 1.2427
Printing obtained and stored scores: 0.5778997940974605 !=? 0.5778997940974605


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:54:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9622
Train Loss: 0.1169
ID Validation ACCURACY: 0.7058
ID Validation Loss: 1.0059
ID Test ACCURACY: 0.6588
ID Test Loss: 1.1823
OOD Validation ACCURACY: 0.6319
OOD Validation Loss: 1.4492
OOD Test ACCURACY: 0.5635
OOD Test Loss: 2.1363

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8077
Train Loss: 0.4721
ID Validation ACCURACY: 0.7004
ID Validation Loss: 0.7735
ID Test ACCURACY: 0.6895
ID Test Loss: 0.8005
OOD Validation ACCURACY: 0.6420
OOD Validation Loss: 0.9580
OOD Test ACCURACY: 0.5964
OOD Test Loss: 1.2456

[0m[1;37mINFO[0m: [1mChartInfo 0.6588 0.5635 0.6895 0.5964 0.7004 0.6420[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9618Train Loss: 0.1169
Id_val ACCURACY: 0.7058Id_val Loss: 1.0058
Val ACCURACY: 0.6319Val Loss: 1.4491
Test ACCURACY: 0.5635Test Loss: 2.1363
[1;34mDEBUG[0m: 04/04/2024 01:54:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9622
Train Loss: 0.1169
ID Validation ACCURACY: 0.7058
ID Validation Loss: 1.0059
ID Test ACCURACY: 0.6588
ID Test Loss: 1.1823
OOD Validation ACCURACY: 0.6319
OOD Validation Loss: 1.4492
OOD Test ACCURACY: 0.5635
OOD Test Loss: 2.1363

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8077
Train Loss: 0.4721
ID Validation ACCURACY: 0.7004
ID Validation Loss: 0.7735
ID Test ACCURACY: 0.6895
ID Test Loss: 0.8005
OOD Validation ACCURACY: 0.6420
OOD Validation Loss: 0.9580
OOD Test ACCURACY: 0.5964
OOD Test Loss: 1.2456

[0m[1;37mINFO[0m: [1mChartInfo 0.6588 0.5635 0.6895 0.5964 0.7004 0.6420[0mTrain ACCURACY: 0.8077Train Loss: 0.4721
Id_val ACCURACY: 0.7004Id_val Loss: 0.7735
Val ACCURACY: 0.6420Val Loss: 0.9580
Test ACCURACY: 0.5964Test Loss: 1.2456
Printing obtained and stored scores: 0.5964310226492794 !=? 0.5964310226492794


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:54:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.7076
ID Validation Loss: 2.3068
ID Test ACCURACY: 0.6697
ID Test Loss: 2.5476
OOD Validation ACCURACY: 0.6118
OOD Validation Loss: 2.8631
OOD Test ACCURACY: 0.5559
OOD Test Loss: 3.9096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ACCURACY: 0.7730
Train Loss: 0.5461
ID Validation ACCURACY: 0.6877
ID Validation Loss: 0.7610
ID Test ACCURACY: 0.6841
ID Test Loss: 0.7794
OOD Validation ACCURACY: 0.6431
OOD Validation Loss: 0.8959
OOD Test ACCURACY: 0.5944
OOD Test Loss: 1.0740

[0m[1;37mINFO[0m: [1mChartInfo 0.6697 0.5559 0.6841 0.5944 0.6877 0.6431[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0001
Id_val ACCURACY: 0.7076Id_val Loss: 2.3068
Val ACCURACY: 0.6118Val Loss: 2.8632
Test ACCURACY: 0.5559Test Loss: 3.9097
[1;34mDEBUG[0m: 04/04/2024 01:54:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 0.7076
ID Validation Loss: 2.3068
ID Test ACCURACY: 0.6697
ID Test Loss: 2.5476
OOD Validation ACCURACY: 0.6118
OOD Validation Loss: 2.8631
OOD Test ACCURACY: 0.5559
OOD Test Loss: 3.9096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ACCURACY: 0.7730
Train Loss: 0.5461
ID Validation ACCURACY: 0.6877
ID Validation Loss: 0.7610
ID Test ACCURACY: 0.6841
ID Test Loss: 0.7794
OOD Validation ACCURACY: 0.6431
OOD Validation Loss: 0.8959
OOD Test ACCURACY: 0.5944
OOD Test Loss: 1.0740

[0m[1;37mINFO[0m: [1mChartInfo 0.6697 0.5559 0.6841 0.5944 0.6877 0.6431[0mTrain ACCURACY: 0.7730Train Loss: 0.5461
Id_val ACCURACY: 0.6877Id_val Loss: 0.7610
Val ACCURACY: 0.6431Val Loss: 0.8959
Test ACCURACY: 0.5944Test Loss: 1.0741
Printing obtained and stored scores: 0.5943719972546329 !=? 0.5943719972546329


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:54:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:54:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0094
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.7565
ID Test ACCURACY: 0.6643
ID Test Loss: 2.0819
OOD Validation ACCURACY: 0.6084
OOD Validation Loss: 2.4105
OOD Test ACCURACY: 0.5450
OOD Test Loss: 3.1833

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9317
Train Loss: 0.2018
ID Validation ACCURACY: 0.6859
ID Validation Loss: 0.9593
ID Test ACCURACY: 0.6769
ID Test Loss: 1.0846
OOD Validation ACCURACY: 0.6476
OOD Validation Loss: 1.2904
OOD Test ACCURACY: 0.6026
OOD Test Loss: 1.8131

[0m[1;37mINFO[0m: [1mChartInfo 0.6643 0.5450 0.6769 0.6026 0.6859 0.6476[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9988Train Loss: 0.0094
Id_val ACCURACY: 0.7040Id_val Loss: 1.7565
Val ACCURACY: 0.6084Val Loss: 2.4106
Test ACCURACY: 0.5450Test Loss: 3.1836
[1;34mDEBUG[0m: 04/04/2024 01:54:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.9988
Train Loss: 0.0094
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.7565
ID Test ACCURACY: 0.6643
ID Test Loss: 2.0819
OOD Validation ACCURACY: 0.6084
OOD Validation Loss: 2.4105
OOD Test ACCURACY: 0.5450
OOD Test Loss: 3.1833

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9317
Train Loss: 0.2018
ID Validation ACCURACY: 0.6859
ID Validation Loss: 0.9593
ID Test ACCURACY: 0.6769
ID Test Loss: 1.0846
OOD Validation ACCURACY: 0.6476
OOD Validation Loss: 1.2904
OOD Test ACCURACY: 0.6026
OOD Test Loss: 1.8131

[0m[1;37mINFO[0m: [1mChartInfo 0.6643 0.5450 0.6769 0.6026 0.6859 0.6476[0mTrain ACCURACY: 0.9313Train Loss: 0.2018
Id_val ACCURACY: 0.6859Id_val Loss: 0.9593
Val ACCURACY: 0.6482Val Loss: 1.2904
Test ACCURACY: 0.6033Test Loss: 1.8132
Printing obtained and stored scores: 0.6032944406314344 !=? 0.602608098833219


Final accuracies: 
TRAIN      = 0.986 +- 0.014
ID_VAL     = 0.702 +- 0.007
VAL        = 0.611 +- 0.018
TEST       = 0.554 +- 0.013
OOD_TRAIN  = 0.811 +- 0.065
OOD_ID_VAL = 0.687 +- 0.012
OOD_VAL    = 0.640 +- 0.010
OOD_TEST   = 0.590 +- 0.010

Final losses: 
TRAIN      = 0.0483 +- 0.0418
ID_VAL     = 1.5929 +- 0.4506
VAL        = 2.1658 +- 0.5475
TEST       = 3.0435 +- 0.7672
OOD_TRAIN  = 0.4707 +- 0.1458
OOD_ID_VAL = 0.8091 +- 0.0769
OOD_VAL    = 1.0054 +- 0.1441
OOD_TEST   = 1.3062 +- 0.2613
Diff id_val-test  = 1.4506 
Diff id_val-test ood_ = 0.4970 

DONE TRAIN LECI GOODTwitter/length

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:55:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0019
ID Validation ACCURACY: 0.6913
ID Validation Loss: 2.0131
ID Test ACCURACY: 0.6787
ID Test Loss: 2.1331
OOD Validation ACCURACY: 0.5972
OOD Validation Loss: 2.8178
OOD Test ACCURACY: 0.5566
OOD Test Loss: 3.9666

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.9004
Train Loss: 0.2795
ID Validation ACCURACY: 0.6625
ID Validation Loss: 0.9229
ID Test ACCURACY: 0.6931
ID Test Loss: 0.9534
OOD Validation ACCURACY: 0.6235
OOD Validation Loss: 1.2698
OOD Test ACCURACY: 0.5704
OOD Test Loss: 1.9723

[0m[1;37mINFO[0m: [1mChartInfo 0.6787 0.5566 0.6931 0.5704 0.6625 0.6235[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9996Train Loss: 0.0019
Id_val ACCURACY: 0.6913Id_val Loss: 2.0131
Val ACCURACY: 0.5972Val Loss: 2.8178
Test ACCURACY: 0.5566Test Loss: 3.9666
[1;34mDEBUG[0m: 04/04/2024 01:55:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0019
ID Validation ACCURACY: 0.6913
ID Validation Loss: 2.0131
ID Test ACCURACY: 0.6787
ID Test Loss: 2.1331
OOD Validation ACCURACY: 0.5972
OOD Validation Loss: 2.8178
OOD Test ACCURACY: 0.5566
OOD Test Loss: 3.9666

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.9004
Train Loss: 0.2795
ID Validation ACCURACY: 0.6625
ID Validation Loss: 0.9229
ID Test ACCURACY: 0.6931
ID Test Loss: 0.9534
OOD Validation ACCURACY: 0.6235
OOD Validation Loss: 1.2698
OOD Test ACCURACY: 0.5704
OOD Test Loss: 1.9723

[0m[1;37mINFO[0m: [1mChartInfo 0.6787 0.5566 0.6931 0.5704 0.6625 0.6235[0mTrain ACCURACY: 0.9004Train Loss: 0.2795
Id_val ACCURACY: 0.6625Id_val Loss: 0.9229
Val ACCURACY: 0.6235Val Loss: 1.2698
Test ACCURACY: 0.5704Test Loss: 1.9723
Printing obtained and stored scores: 0.5703500343170899 !=? 0.5703500343170899


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:55:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:27 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9201
Train Loss: 0.2250
ID Validation ACCURACY: 0.6949
ID Validation Loss: 1.0071
ID Test ACCURACY: 0.6841
ID Test Loss: 1.0211
OOD Validation ACCURACY: 0.6297
OOD Validation Loss: 1.2650
OOD Test ACCURACY: 0.5916
OOD Test Loss: 1.6996

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ACCURACY: 0.7459
Train Loss: 0.5974
ID Validation ACCURACY: 0.6805
ID Validation Loss: 0.7660
ID Test ACCURACY: 0.6895
ID Test Loss: 0.7495
OOD Validation ACCURACY: 0.6403
OOD Validation Loss: 0.8572
OOD Test ACCURACY: 0.6095
OOD Test Loss: 1.0455

[0m[1;37mINFO[0m: [1mChartInfo 0.6841 0.5916 0.6895 0.6095 0.6805 0.6403[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9201Train Loss: 0.2250
Id_val ACCURACY: 0.6949Id_val Loss: 1.0071
Val ACCURACY: 0.6297Val Loss: 1.2650
Test ACCURACY: 0.5916Test Loss: 1.6996
[1;34mDEBUG[0m: 04/04/2024 01:55:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9201
Train Loss: 0.2250
ID Validation ACCURACY: 0.6949
ID Validation Loss: 1.0071
ID Test ACCURACY: 0.6841
ID Test Loss: 1.0211
OOD Validation ACCURACY: 0.6297
OOD Validation Loss: 1.2650
OOD Test ACCURACY: 0.5916
OOD Test Loss: 1.6996

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 6...
[0m[1;37mINFO[0m: [1mCheckpoint 6: 
-----------------------------------
Train ACCURACY: 0.7459
Train Loss: 0.5974
ID Validation ACCURACY: 0.6805
ID Validation Loss: 0.7660
ID Test ACCURACY: 0.6895
ID Test Loss: 0.7495
OOD Validation ACCURACY: 0.6403
OOD Validation Loss: 0.8572
OOD Test ACCURACY: 0.6095
OOD Test Loss: 1.0455

[0m[1;37mINFO[0m: [1mChartInfo 0.6841 0.5916 0.6895 0.6095 0.6805 0.6403[0mTrain ACCURACY: 0.7459Train Loss: 0.5974
Id_val ACCURACY: 0.6805Id_val Loss: 0.7660
Val ACCURACY: 0.6403Val Loss: 0.8572
Test ACCURACY: 0.6095Test Loss: 1.0455
Printing obtained and stored scores: 0.609471516815374 !=? 0.609471516815374


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:55:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 18...
[0m[1;37mINFO[0m: [1mCheckpoint 18: 
-----------------------------------
Train ACCURACY: 0.9139
Train Loss: 0.2503
ID Validation ACCURACY: 0.7076
ID Validation Loss: 0.8689
ID Test ACCURACY: 0.6895
ID Test Loss: 0.9759
OOD Validation ACCURACY: 0.6409
OOD Validation Loss: 1.2142
OOD Test ACCURACY: 0.5854
OOD Test Loss: 1.6093

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9382
Train Loss: 0.1587
ID Validation ACCURACY: 0.6968
ID Validation Loss: 1.0487
ID Test ACCURACY: 0.6661
ID Test Loss: 1.2152
OOD Validation ACCURACY: 0.6521
OOD Validation Loss: 1.4007
OOD Test ACCURACY: 0.5909
OOD Test Loss: 1.8758

[0m[1;37mINFO[0m: [1mChartInfo 0.6895 0.5854 0.6661 0.5909 0.6968 0.6521[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9139Train Loss: 0.2503
Id_val ACCURACY: 0.7076Id_val Loss: 0.8689
Val ACCURACY: 0.6409Val Loss: 1.2142
Test ACCURACY: 0.5854Test Loss: 1.6093
[1;34mDEBUG[0m: 04/04/2024 01:55:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 18...
[0m[1;37mINFO[0m: [1mCheckpoint 18: 
-----------------------------------
Train ACCURACY: 0.9139
Train Loss: 0.2503
ID Validation ACCURACY: 0.7076
ID Validation Loss: 0.8689
ID Test ACCURACY: 0.6895
ID Test Loss: 0.9759
OOD Validation ACCURACY: 0.6409
OOD Validation Loss: 1.2142
OOD Test ACCURACY: 0.5854
OOD Test Loss: 1.6093

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9382
Train Loss: 0.1587
ID Validation ACCURACY: 0.6968
ID Validation Loss: 1.0487
ID Test ACCURACY: 0.6661
ID Test Loss: 1.2152
OOD Validation ACCURACY: 0.6521
OOD Validation Loss: 1.4007
OOD Test ACCURACY: 0.5909
OOD Test Loss: 1.8758

[0m[1;37mINFO[0m: [1mChartInfo 0.6895 0.5854 0.6661 0.5909 0.6968 0.6521[0mTrain ACCURACY: 0.9382Train Loss: 0.1587
Id_val ACCURACY: 0.6968Id_val Loss: 1.0487
Val ACCURACY: 0.6521Val Loss: 1.4007
Test ACCURACY: 0.5909Test Loss: 1.8758
Printing obtained and stored scores: 0.5909402882635553 !=? 0.5909402882635553


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:55:46 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9764
Train Loss: 0.0983
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.0781
ID Test ACCURACY: 0.6841
ID Test Loss: 1.1423
OOD Validation ACCURACY: 0.6151
OOD Validation Loss: 1.3992
OOD Test ACCURACY: 0.5724
OOD Test Loss: 1.9331

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ACCURACY: 0.7807
Train Loss: 0.5276
ID Validation ACCURACY: 0.6859
ID Validation Loss: 0.7585
ID Test ACCURACY: 0.6787
ID Test Loss: 0.7813
OOD Validation ACCURACY: 0.6415
OOD Validation Loss: 0.8864
OOD Test ACCURACY: 0.5964
OOD Test Loss: 1.0649

[0m[1;37mINFO[0m: [1mChartInfo 0.6841 0.5724 0.6787 0.5964 0.6859 0.6415[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9764Train Loss: 0.0983
Id_val ACCURACY: 0.7040Id_val Loss: 1.0781
Val ACCURACY: 0.6151Val Loss: 1.3992
Test ACCURACY: 0.5724Test Loss: 1.9331
[1;34mDEBUG[0m: 04/04/2024 01:55:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9764
Train Loss: 0.0983
ID Validation ACCURACY: 0.7040
ID Validation Loss: 1.0781
ID Test ACCURACY: 0.6841
ID Test Loss: 1.1423
OOD Validation ACCURACY: 0.6151
OOD Validation Loss: 1.3992
OOD Test ACCURACY: 0.5724
OOD Test Loss: 1.9331

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 9...
[0m[1;37mINFO[0m: [1mCheckpoint 9: 
-----------------------------------
Train ACCURACY: 0.7807
Train Loss: 0.5276
ID Validation ACCURACY: 0.6859
ID Validation Loss: 0.7585
ID Test ACCURACY: 0.6787
ID Test Loss: 0.7813
OOD Validation ACCURACY: 0.6415
OOD Validation Loss: 0.8864
OOD Test ACCURACY: 0.5964
OOD Test Loss: 1.0649

[0m[1;37mINFO[0m: [1mChartInfo 0.6841 0.5724 0.6787 0.5964 0.6859 0.6415[0mTrain ACCURACY: 0.7807Train Loss: 0.5276
Id_val ACCURACY: 0.6859Id_val Loss: 0.7585
Val ACCURACY: 0.6415Val Loss: 0.8864
Test ACCURACY: 0.5964Test Loss: 1.0649
Printing obtained and stored scores: 0.5964310226492794 !=? 0.5964310226492794


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:55:58 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:55:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9347
Train Loss: 0.2081
ID Validation ACCURACY: 0.6968
ID Validation Loss: 0.9057
ID Test ACCURACY: 0.6787
ID Test Loss: 1.0057
OOD Validation ACCURACY: 0.6308
OOD Validation Loss: 1.1621
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.6111

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8336
Train Loss: 0.4248
ID Validation ACCURACY: 0.6841
ID Validation Loss: 0.7984
ID Test ACCURACY: 0.6787
ID Test Loss: 0.8109
OOD Validation ACCURACY: 0.6459
OOD Validation Loss: 0.9402
OOD Test ACCURACY: 0.5978
OOD Test Loss: 1.1689

[0m[1;37mINFO[0m: [1mChartInfo 0.6787 0.5683 0.6787 0.5978 0.6841 0.6459[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9347Train Loss: 0.2081
Id_val ACCURACY: 0.6968Id_val Loss: 0.9057
Val ACCURACY: 0.6308Val Loss: 1.1621
Test ACCURACY: 0.5683Test Loss: 1.6111
[1;34mDEBUG[0m: 04/04/2024 01:56:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9347
Train Loss: 0.2081
ID Validation ACCURACY: 0.6968
ID Validation Loss: 0.9057
ID Test ACCURACY: 0.6787
ID Test Loss: 1.0057
OOD Validation ACCURACY: 0.6308
OOD Validation Loss: 1.1621
OOD Test ACCURACY: 0.5683
OOD Test Loss: 1.6111

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8336
Train Loss: 0.4248
ID Validation ACCURACY: 0.6841
ID Validation Loss: 0.7984
ID Test ACCURACY: 0.6787
ID Test Loss: 0.8109
OOD Validation ACCURACY: 0.6459
OOD Validation Loss: 0.9402
OOD Test ACCURACY: 0.5978
OOD Test Loss: 1.1689

[0m[1;37mINFO[0m: [1mChartInfo 0.6787 0.5683 0.6787 0.5978 0.6841 0.6459[0mTrain ACCURACY: 0.8336Train Loss: 0.4248
Id_val ACCURACY: 0.6841Id_val Loss: 0.7984
Val ACCURACY: 0.6459Val Loss: 0.9402
Test ACCURACY: 0.5978Test Loss: 1.1689
Printing obtained and stored scores: 0.5978037062457103 !=? 0.5978037062457103


Final accuracies: 
TRAIN      = 0.949 +- 0.033
ID_VAL     = 0.699 +- 0.006
VAL        = 0.623 +- 0.015
TEST       = 0.575 +- 0.012
OOD_TRAIN  = 0.840 +- 0.072
OOD_ID_VAL = 0.682 +- 0.011
OOD_VAL    = 0.641 +- 0.010
OOD_TEST   = 0.593 +- 0.013

Final losses: 
TRAIN      = 0.1567 +- 0.0932
ID_VAL     = 1.1746 +- 0.4257
VAL        = 1.5717 +- 0.6280
TEST       = 2.1639 +- 0.9090
OOD_TRAIN  = 0.3976 +- 0.1604
OOD_ID_VAL = 0.8589 +- 0.1118
OOD_VAL    = 1.0709 +- 0.2214
OOD_TEST   = 1.4255 +- 0.4104
Diff id_val-test  = 0.9894 
Diff id_val-test ood_ = 0.5666 

DONE TRAIN LECI GOODTwitter/length mitigation_readout

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:56:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:56:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9716
Train Loss: 0.0653
ID Validation ROC-AUC: 0.8412
ID Validation Loss: 0.1394
ID Test ROC-AUC: 0.7964
ID Test Loss: 0.1371
OOD Validation ROC-AUC: 0.7570
OOD Validation Loss: 0.1376
OOD Test ROC-AUC: 0.7331
OOD Test Loss: 0.0930

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ROC-AUC: 0.8810
Train Loss: 0.1019
ID Validation ROC-AUC: 0.8118
ID Validation Loss: 0.1338
ID Test ROC-AUC: 0.8103
ID Test Loss: 0.1133
OOD Validation ROC-AUC: 0.7797
OOD Validation Loss: 0.1199
OOD Test ROC-AUC: 0.7043
OOD Test Loss: 0.0856

[0m[1;37mINFO[0m: [1mChartInfo 0.7964 0.7331 0.8103 0.7043 0.8118 0.7797[0mTrain ROC-AUC: 0.9716Train Loss: 0.0653
Id_val ROC-AUC: 0.8412Id_val Loss: 0.1394
Val ROC-AUC: 0.7569Val Loss: 0.1376
Test ROC-AUC: 0.7331Test Loss: 0.0930
[1;34mDEBUG[0m: 04/04/2024 01:56:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9716
Train Loss: 0.0653
ID Validation ROC-AUC: 0.8412
ID Validation Loss: 0.1394
ID Test ROC-AUC: 0.7964
ID Test Loss: 0.1371
OOD Validation ROC-AUC: 0.7570
OOD Validation Loss: 0.1376
OOD Test ROC-AUC: 0.7331
OOD Test Loss: 0.0930

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ROC-AUC: 0.8810
Train Loss: 0.1019
ID Validation ROC-AUC: 0.8118
ID Validation Loss: 0.1338
ID Test ROC-AUC: 0.8103
ID Test Loss: 0.1133
OOD Validation ROC-AUC: 0.7797
OOD Validation Loss: 0.1199
OOD Test ROC-AUC: 0.7043
OOD Test Loss: 0.0856

[0m[1;37mINFO[0m: [1mChartInfo 0.7964 0.7331 0.8103 0.7043 0.8118 0.7797[0mTrain ROC-AUC: 0.8810Train Loss: 0.1019
Id_val ROC-AUC: 0.8118Id_val Loss: 0.1338
Val ROC-AUC: 0.7797Val Loss: 0.1199
Test ROC-AUC: 0.7043Test Loss: 0.0856
Printing obtained and stored scores: 0.7043291118284909 !=? 0.704329111828491


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:57:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:57:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ROC-AUC: 0.9881
Train Loss: 0.0502
ID Validation ROC-AUC: 0.8421
ID Validation Loss: 0.1583
ID Test ROC-AUC: 0.7976
ID Test Loss: 0.1471
OOD Validation ROC-AUC: 0.7386
OOD Validation Loss: 0.1672
OOD Test ROC-AUC: 0.7071
OOD Test Loss: 0.1073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.0938
ID Validation ROC-AUC: 0.8079
ID Validation Loss: 0.1347
ID Test ROC-AUC: 0.7889
ID Test Loss: 0.1161
OOD Validation ROC-AUC: 0.7802
OOD Validation Loss: 0.1159
OOD Test ROC-AUC: 0.6996
OOD Test Loss: 0.0890

[0m[1;37mINFO[0m: [1mChartInfo 0.7976 0.7071 0.7889 0.6996 0.8079 0.7802[0mTrain ROC-AUC: 0.9881Train Loss: 0.0502
Id_val ROC-AUC: 0.8421Id_val Loss: 0.1583
Val ROC-AUC: 0.7386Val Loss: 0.1672
Test ROC-AUC: 0.7071Test Loss: 0.1073
[1;34mDEBUG[0m: 04/04/2024 01:57:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ROC-AUC: 0.9881
Train Loss: 0.0502
ID Validation ROC-AUC: 0.8421
ID Validation Loss: 0.1583
ID Test ROC-AUC: 0.7976
ID Test Loss: 0.1471
OOD Validation ROC-AUC: 0.7386
OOD Validation Loss: 0.1672
OOD Test ROC-AUC: 0.7071
OOD Test Loss: 0.1073

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.0938
ID Validation ROC-AUC: 0.8079
ID Validation Loss: 0.1347
ID Test ROC-AUC: 0.7889
ID Test Loss: 0.1161
OOD Validation ROC-AUC: 0.7802
OOD Validation Loss: 0.1159
OOD Test ROC-AUC: 0.6996
OOD Test Loss: 0.0890

[0m[1;37mINFO[0m: [1mChartInfo 0.7976 0.7071 0.7889 0.6996 0.8079 0.7802[0mTrain ROC-AUC: 0.9117Train Loss: 0.0938
Id_val ROC-AUC: 0.8079Id_val Loss: 0.1347
Val ROC-AUC: 0.7802Val Loss: 0.1159
Test ROC-AUC: 0.6996Test Loss: 0.0890
Printing obtained and stored scores: 0.6995680391922425 !=? 0.6995864335488539


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:58:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ROC-AUC: 0.9869
Train Loss: 0.0538
ID Validation ROC-AUC: 0.8431
ID Validation Loss: 0.1490
ID Test ROC-AUC: 0.8115
ID Test Loss: 0.1338
OOD Validation ROC-AUC: 0.7762
OOD Validation Loss: 0.1394
OOD Test ROC-AUC: 0.7383
OOD Test Loss: 0.0997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ROC-AUC: 0.9764
Train Loss: 0.0628
ID Validation ROC-AUC: 0.8350
ID Validation Loss: 0.1429
ID Test ROC-AUC: 0.8089
ID Test Loss: 0.1287
OOD Validation ROC-AUC: 0.7881
OOD Validation Loss: 0.1266
OOD Test ROC-AUC: 0.7471
OOD Test Loss: 0.0945

[0m[1;37mINFO[0m: [1mChartInfo 0.8115 0.7383 0.8089 0.7471 0.8350 0.7881[0mTrain ROC-AUC: 0.9869Train Loss: 0.0538
Id_val ROC-AUC: 0.8431Id_val Loss: 0.1490
Val ROC-AUC: 0.7762Val Loss: 0.1394
Test ROC-AUC: 0.7383Test Loss: 0.0997
[1;34mDEBUG[0m: 04/04/2024 01:58:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ROC-AUC: 0.9869
Train Loss: 0.0538
ID Validation ROC-AUC: 0.8431
ID Validation Loss: 0.1490
ID Test ROC-AUC: 0.8115
ID Test Loss: 0.1338
OOD Validation ROC-AUC: 0.7762
OOD Validation Loss: 0.1394
OOD Test ROC-AUC: 0.7383
OOD Test Loss: 0.0997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ROC-AUC: 0.9764
Train Loss: 0.0628
ID Validation ROC-AUC: 0.8350
ID Validation Loss: 0.1429
ID Test ROC-AUC: 0.8089
ID Test Loss: 0.1287
OOD Validation ROC-AUC: 0.7881
OOD Validation Loss: 0.1266
OOD Test ROC-AUC: 0.7471
OOD Test Loss: 0.0945

[0m[1;37mINFO[0m: [1mChartInfo 0.8115 0.7383 0.8089 0.7471 0.8350 0.7881[0mTrain ROC-AUC: 0.9764Train Loss: 0.0628
Id_val ROC-AUC: 0.8350Id_val Loss: 0.1429
Val ROC-AUC: 0.7881Val Loss: 0.1266
Test ROC-AUC: 0.7471Test Loss: 0.0945
Printing obtained and stored scores: 0.7471051881282823 !=? 0.7471143853065879


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:58:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:58:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ROC-AUC: 0.9788
Train Loss: 0.0657
ID Validation ROC-AUC: 0.8378
ID Validation Loss: 0.1396
ID Test ROC-AUC: 0.8109
ID Test Loss: 0.1227
OOD Validation ROC-AUC: 0.7665
OOD Validation Loss: 0.1310
OOD Test ROC-AUC: 0.7331
OOD Test Loss: 0.0936

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ROC-AUC: 0.9723
Train Loss: 0.0782
ID Validation ROC-AUC: 0.8167
ID Validation Loss: 0.1530
ID Test ROC-AUC: 0.8037
ID Test Loss: 0.1332
OOD Validation ROC-AUC: 0.7875
OOD Validation Loss: 0.1295
OOD Test ROC-AUC: 0.6782
OOD Test Loss: 0.1101

[0m[1;37mINFO[0m: [1mChartInfo 0.8109 0.7331 0.8037 0.6782 0.8167 0.7875[0mTrain ROC-AUC: 0.9788Train Loss: 0.0657
Id_val ROC-AUC: 0.8378Id_val Loss: 0.1396
Val ROC-AUC: 0.7665Val Loss: 0.1310
Test ROC-AUC: 0.7331Test Loss: 0.0936
[1;34mDEBUG[0m: 04/04/2024 01:59:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ROC-AUC: 0.9788
Train Loss: 0.0657
ID Validation ROC-AUC: 0.8378
ID Validation Loss: 0.1396
ID Test ROC-AUC: 0.8109
ID Test Loss: 0.1227
OOD Validation ROC-AUC: 0.7665
OOD Validation Loss: 0.1310
OOD Test ROC-AUC: 0.7331
OOD Test Loss: 0.0936

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ROC-AUC: 0.9723
Train Loss: 0.0782
ID Validation ROC-AUC: 0.8167
ID Validation Loss: 0.1530
ID Test ROC-AUC: 0.8037
ID Test Loss: 0.1332
OOD Validation ROC-AUC: 0.7875
OOD Validation Loss: 0.1295
OOD Test ROC-AUC: 0.6782
OOD Test Loss: 0.1101

[0m[1;37mINFO[0m: [1mChartInfo 0.8109 0.7331 0.8037 0.6782 0.8167 0.7875[0mTrain ROC-AUC: 0.9723Train Loss: 0.0782
Id_val ROC-AUC: 0.8167Id_val Loss: 0.1530
Val ROC-AUC: 0.7875Val Loss: 0.1295
Test ROC-AUC: 0.6782Test Loss: 0.1101
Printing obtained and stored scores: 0.6782459141535377 !=? 0.6782397827013339


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 13:59:41 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:41 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:41 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 01:59:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ROC-AUC: 0.9928
Train Loss: 0.0421
ID Validation ROC-AUC: 0.8460
ID Validation Loss: 0.1580
ID Test ROC-AUC: 0.8091
ID Test Loss: 0.1489
OOD Validation ROC-AUC: 0.7496
OOD Validation Loss: 0.1650
OOD Test ROC-AUC: 0.7077
OOD Test Loss: 0.1190

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ROC-AUC: 0.9781
Train Loss: 0.0600
ID Validation ROC-AUC: 0.8358
ID Validation Loss: 0.1409
ID Test ROC-AUC: 0.8118
ID Test Loss: 0.1303
OOD Validation ROC-AUC: 0.7903
OOD Validation Loss: 0.1230
OOD Test ROC-AUC: 0.7362
OOD Test Loss: 0.0936

[0m[1;37mINFO[0m: [1mChartInfo 0.8091 0.7077 0.8118 0.7362 0.8358 0.7903[0mTrain ROC-AUC: 0.9928Train Loss: 0.0421
Id_val ROC-AUC: 0.8460Id_val Loss: 0.1580
Val ROC-AUC: 0.7495Val Loss: 0.1650
Test ROC-AUC: 0.7078Test Loss: 0.1190
[1;34mDEBUG[0m: 04/04/2024 02:00:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ROC-AUC: 0.9928
Train Loss: 0.0421
ID Validation ROC-AUC: 0.8460
ID Validation Loss: 0.1580
ID Test ROC-AUC: 0.8091
ID Test Loss: 0.1489
OOD Validation ROC-AUC: 0.7496
OOD Validation Loss: 0.1650
OOD Test ROC-AUC: 0.7077
OOD Test Loss: 0.1190

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ROC-AUC: 0.9781
Train Loss: 0.0600
ID Validation ROC-AUC: 0.8358
ID Validation Loss: 0.1409
ID Test ROC-AUC: 0.8118
ID Test Loss: 0.1303
OOD Validation ROC-AUC: 0.7903
OOD Validation Loss: 0.1230
OOD Test ROC-AUC: 0.7362
OOD Test Loss: 0.0936

[0m[1;37mINFO[0m: [1mChartInfo 0.8091 0.7077 0.8118 0.7362 0.8358 0.7903[0mTrain ROC-AUC: 0.9781Train Loss: 0.0600
Id_val ROC-AUC: 0.8358Id_val Loss: 0.1409
Val ROC-AUC: 0.7903Val Loss: 0.1230
Test ROC-AUC: 0.7362Test Loss: 0.0936
Printing obtained and stored scores: 0.7362034661099308 !=? 0.7361881374794212


Final accuracies: 
TRAIN      = 0.984 +- 0.008
ID_VAL     = 0.842 +- 0.003
VAL        = 0.758 +- 0.013
TEST       = 0.724 +- 0.014
OOD_TRAIN  = 0.944 +- 0.040
OOD_ID_VAL = 0.821 +- 0.012
OOD_VAL    = 0.785 +- 0.004
OOD_TEST   = 0.713 +- 0.025

Final losses: 
TRAIN      = 0.0554 +- 0.0090
ID_VAL     = 0.1489 +- 0.0083
VAL        = 0.1480 +- 0.0150
TEST       = 0.1025 +- 0.0097
OOD_TRAIN  = 0.0794 +- 0.0165
OOD_ID_VAL = 0.1411 +- 0.0069
OOD_VAL    = 0.1230 +- 0.0048
OOD_TEST   = 0.0946 +- 0.0084
Diff id_val-test  = 0.0464 
Diff id_val-test ood_ = 0.0465 

DONE TRAIN LECI GOODHIV/scaffold

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 14:00:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:00:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ROC-AUC: 0.9923
Train Loss: 0.0410
ID Validation ROC-AUC: 0.8459
ID Validation Loss: 0.1578
ID Test ROC-AUC: 0.8062
ID Test Loss: 0.1517
OOD Validation ROC-AUC: 0.7360
OOD Validation Loss: 0.1621
OOD Test ROC-AUC: 0.6792
OOD Test Loss: 0.1219

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 53...
[0m[1;37mINFO[0m: [1mCheckpoint 53: 
-----------------------------------
Train ROC-AUC: 0.9014
Train Loss: 0.0989
ID Validation ROC-AUC: 0.8203
ID Validation Loss: 0.1281
ID Test ROC-AUC: 0.8137
ID Test Loss: 0.1121
OOD Validation ROC-AUC: 0.7751
OOD Validation Loss: 0.1065
OOD Test ROC-AUC: 0.7337
OOD Test Loss: 0.0844

[0m[1;37mINFO[0m: [1mChartInfo 0.8062 0.6792 0.8137 0.7337 0.8203 0.7751[0mTrain ROC-AUC: 0.9923Train Loss: 0.0410
Id_val ROC-AUC: 0.8459Id_val Loss: 0.1578
Val ROC-AUC: 0.7360Val Loss: 0.1621
Test ROC-AUC: 0.6792Test Loss: 0.1219
[1;34mDEBUG[0m: 04/04/2024 02:01:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 173...
[0m[1;37mINFO[0m: [1mCheckpoint 173: 
-----------------------------------
Train ROC-AUC: 0.9923
Train Loss: 0.0410
ID Validation ROC-AUC: 0.8459
ID Validation Loss: 0.1578
ID Test ROC-AUC: 0.8062
ID Test Loss: 0.1517
OOD Validation ROC-AUC: 0.7360
OOD Validation Loss: 0.1621
OOD Test ROC-AUC: 0.6792
OOD Test Loss: 0.1219

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 53...
[0m[1;37mINFO[0m: [1mCheckpoint 53: 
-----------------------------------
Train ROC-AUC: 0.9014
Train Loss: 0.0989
ID Validation ROC-AUC: 0.8203
ID Validation Loss: 0.1281
ID Test ROC-AUC: 0.8137
ID Test Loss: 0.1121
OOD Validation ROC-AUC: 0.7751
OOD Validation Loss: 0.1065
OOD Test ROC-AUC: 0.7337
OOD Test Loss: 0.0844

[0m[1;37mINFO[0m: [1mChartInfo 0.8062 0.6792 0.8137 0.7337 0.8203 0.7751[0mTrain ROC-AUC: 0.9014Train Loss: 0.0989
Id_val ROC-AUC: 0.8203Id_val Loss: 0.1281
Val ROC-AUC: 0.7751Val Loss: 0.1065
Test ROC-AUC: 0.7337Test Loss: 0.0844
Printing obtained and stored scores: 0.7337079650629853 !=? 0.7337079650629853


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 14:01:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:01:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ROC-AUC: 0.9710
Train Loss: 0.0713
ID Validation ROC-AUC: 0.8526
ID Validation Loss: 0.1392
ID Test ROC-AUC: 0.7996
ID Test Loss: 0.1358
OOD Validation ROC-AUC: 0.7613
OOD Validation Loss: 0.1391
OOD Test ROC-AUC: 0.7520
OOD Test Loss: 0.0942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ROC-AUC: 0.9037
Train Loss: 0.0960
ID Validation ROC-AUC: 0.8175
ID Validation Loss: 0.1281
ID Test ROC-AUC: 0.8267
ID Test Loss: 0.1115
OOD Validation ROC-AUC: 0.7871
OOD Validation Loss: 0.1090
OOD Test ROC-AUC: 0.7157
OOD Test Loss: 0.0855

[0m[1;37mINFO[0m: [1mChartInfo 0.7996 0.7520 0.8267 0.7157 0.8175 0.7871[0mTrain ROC-AUC: 0.9710Train Loss: 0.0713
Id_val ROC-AUC: 0.8526Id_val Loss: 0.1392
Val ROC-AUC: 0.7613Val Loss: 0.1391
Test ROC-AUC: 0.7520Test Loss: 0.0942
[1;34mDEBUG[0m: 04/04/2024 02:02:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ROC-AUC: 0.9710
Train Loss: 0.0713
ID Validation ROC-AUC: 0.8526
ID Validation Loss: 0.1392
ID Test ROC-AUC: 0.7996
ID Test Loss: 0.1358
OOD Validation ROC-AUC: 0.7613
OOD Validation Loss: 0.1391
OOD Test ROC-AUC: 0.7520
OOD Test Loss: 0.0942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ROC-AUC: 0.9037
Train Loss: 0.0960
ID Validation ROC-AUC: 0.8175
ID Validation Loss: 0.1281
ID Test ROC-AUC: 0.8267
ID Test Loss: 0.1115
OOD Validation ROC-AUC: 0.7871
OOD Validation Loss: 0.1090
OOD Test ROC-AUC: 0.7157
OOD Test Loss: 0.0855

[0m[1;37mINFO[0m: [1mChartInfo 0.7996 0.7520 0.8267 0.7157 0.8175 0.7871[0mTrain ROC-AUC: 0.9037Train Loss: 0.0960
Id_val ROC-AUC: 0.8175Id_val Loss: 0.1281
Val ROC-AUC: 0.7871Val Loss: 0.1090
Test ROC-AUC: 0.7157Test Loss: 0.0855
Printing obtained and stored scores: 0.715696824214331 !=? 0.7156968242143311


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 14:02:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:02:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ROC-AUC: 0.9701
Train Loss: 0.0706
ID Validation ROC-AUC: 0.8330
ID Validation Loss: 0.1409
ID Test ROC-AUC: 0.8429
ID Test Loss: 0.1165
OOD Validation ROC-AUC: 0.7600
OOD Validation Loss: 0.1232
OOD Test ROC-AUC: 0.7059
OOD Test Loss: 0.0934

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 101...
[0m[1;37mINFO[0m: [1mCheckpoint 101: 
-----------------------------------
Train ROC-AUC: 0.9417
Train Loss: 0.0879
ID Validation ROC-AUC: 0.8157
ID Validation Loss: 0.1418
ID Test ROC-AUC: 0.7987
ID Test Loss: 0.1294
OOD Validation ROC-AUC: 0.7798
OOD Validation Loss: 0.1255
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.0943

[0m[1;37mINFO[0m: [1mChartInfo 0.8429 0.7059 0.7987 0.7014 0.8157 0.7798[0mTrain ROC-AUC: 0.9701Train Loss: 0.0706
Id_val ROC-AUC: 0.8330Id_val Loss: 0.1409
Val ROC-AUC: 0.7600Val Loss: 0.1232
Test ROC-AUC: 0.7059Test Loss: 0.0934
[1;34mDEBUG[0m: 04/04/2024 02:02:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ROC-AUC: 0.9701
Train Loss: 0.0706
ID Validation ROC-AUC: 0.8330
ID Validation Loss: 0.1409
ID Test ROC-AUC: 0.8429
ID Test Loss: 0.1165
OOD Validation ROC-AUC: 0.7600
OOD Validation Loss: 0.1232
OOD Test ROC-AUC: 0.7059
OOD Test Loss: 0.0934

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 101...
[0m[1;37mINFO[0m: [1mCheckpoint 101: 
-----------------------------------
Train ROC-AUC: 0.9417
Train Loss: 0.0879
ID Validation ROC-AUC: 0.8157
ID Validation Loss: 0.1418
ID Test ROC-AUC: 0.7987
ID Test Loss: 0.1294
OOD Validation ROC-AUC: 0.7798
OOD Validation Loss: 0.1255
OOD Test ROC-AUC: 0.7014
OOD Test Loss: 0.0943

[0m[1;37mINFO[0m: [1mChartInfo 0.8429 0.7059 0.7987 0.7014 0.8157 0.7798[0mTrain ROC-AUC: 0.9417Train Loss: 0.0879
Id_val ROC-AUC: 0.8157Id_val Loss: 0.1418
Val ROC-AUC: 0.7798Val Loss: 0.1255
Test ROC-AUC: 0.7014Test Loss: 0.0943
Printing obtained and stored scores: 0.7013890804967703 !=? 0.7013890804967703


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 14:03:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:03:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ROC-AUC: 0.9793
Train Loss: 0.0613
ID Validation ROC-AUC: 0.8456
ID Validation Loss: 0.1501
ID Test ROC-AUC: 0.8055
ID Test Loss: 0.1348
OOD Validation ROC-AUC: 0.7453
OOD Validation Loss: 0.1579
OOD Test ROC-AUC: 0.7238
OOD Test Loss: 0.1098

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ROC-AUC: 0.9652
Train Loss: 0.0835
ID Validation ROC-AUC: 0.8234
ID Validation Loss: 0.1556
ID Test ROC-AUC: 0.8100
ID Test Loss: 0.1307
OOD Validation ROC-AUC: 0.7813
OOD Validation Loss: 0.1347
OOD Test ROC-AUC: 0.7610
OOD Test Loss: 0.0941

[0m[1;37mINFO[0m: [1mChartInfo 0.8055 0.7238 0.8100 0.7610 0.8234 0.7813[0mTrain ROC-AUC: 0.9793Train Loss: 0.0613
Id_val ROC-AUC: 0.8456Id_val Loss: 0.1501
Val ROC-AUC: 0.7453Val Loss: 0.1579
Test ROC-AUC: 0.7238Test Loss: 0.1098
[1;34mDEBUG[0m: 04/04/2024 02:03:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ROC-AUC: 0.9793
Train Loss: 0.0613
ID Validation ROC-AUC: 0.8456
ID Validation Loss: 0.1501
ID Test ROC-AUC: 0.8055
ID Test Loss: 0.1348
OOD Validation ROC-AUC: 0.7453
OOD Validation Loss: 0.1579
OOD Test ROC-AUC: 0.7238
OOD Test Loss: 0.1098

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ROC-AUC: 0.9652
Train Loss: 0.0835
ID Validation ROC-AUC: 0.8234
ID Validation Loss: 0.1556
ID Test ROC-AUC: 0.8100
ID Test Loss: 0.1307
OOD Validation ROC-AUC: 0.7813
OOD Validation Loss: 0.1347
OOD Test ROC-AUC: 0.7610
OOD Test Loss: 0.0941

[0m[1;37mINFO[0m: [1mChartInfo 0.8055 0.7238 0.8100 0.7610 0.8234 0.7813[0mTrain ROC-AUC: 0.9652Train Loss: 0.0835
Id_val ROC-AUC: 0.8234Id_val Loss: 0.1556
Val ROC-AUC: 0.7813Val Loss: 0.1347
Test ROC-AUC: 0.7610Test Loss: 0.0941
Printing obtained and stored scores: 0.7609714672871697 !=? 0.7609714672871696


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 14:04:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:04:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ROC-AUC: 0.9746
Train Loss: 0.0672
ID Validation ROC-AUC: 0.8419
ID Validation Loss: 0.1412
ID Test ROC-AUC: 0.8028
ID Test Loss: 0.1301
OOD Validation ROC-AUC: 0.7447
OOD Validation Loss: 0.1352
OOD Test ROC-AUC: 0.7243
OOD Test Loss: 0.0925

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ROC-AUC: 0.9905
Train Loss: 0.0444
ID Validation ROC-AUC: 0.8359
ID Validation Loss: 0.1532
ID Test ROC-AUC: 0.7955
ID Test Loss: 0.1437
OOD Validation ROC-AUC: 0.7701
OOD Validation Loss: 0.1443
OOD Test ROC-AUC: 0.7345
OOD Test Loss: 0.1002

[0m[1;37mINFO[0m: [1mChartInfo 0.8028 0.7243 0.7955 0.7345 0.8359 0.7701[0mTrain ROC-AUC: 0.9746Train Loss: 0.0672
Id_val ROC-AUC: 0.8419Id_val Loss: 0.1412
Val ROC-AUC: 0.7447Val Loss: 0.1352
Test ROC-AUC: 0.7243Test Loss: 0.0925
[1;34mDEBUG[0m: 04/04/2024 02:04:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 140...
[0m[1;37mINFO[0m: [1mCheckpoint 140: 
-----------------------------------
Train ROC-AUC: 0.9746
Train Loss: 0.0672
ID Validation ROC-AUC: 0.8419
ID Validation Loss: 0.1412
ID Test ROC-AUC: 0.8028
ID Test Loss: 0.1301
OOD Validation ROC-AUC: 0.7447
OOD Validation Loss: 0.1352
OOD Test ROC-AUC: 0.7243
OOD Test Loss: 0.0925

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ROC-AUC: 0.9905
Train Loss: 0.0444
ID Validation ROC-AUC: 0.8359
ID Validation Loss: 0.1532
ID Test ROC-AUC: 0.7955
ID Test Loss: 0.1437
OOD Validation ROC-AUC: 0.7701
OOD Validation Loss: 0.1443
OOD Test ROC-AUC: 0.7345
OOD Test Loss: 0.1002

[0m[1;37mINFO[0m: [1mChartInfo 0.8028 0.7243 0.7955 0.7345 0.8359 0.7701[0mTrain ROC-AUC: 0.9905Train Loss: 0.0444
Id_val ROC-AUC: 0.8359Id_val Loss: 0.1532
Val ROC-AUC: 0.7701Val Loss: 0.1443
Test ROC-AUC: 0.7345Test Loss: 0.1002
Printing obtained and stored scores: 0.734535711110498 !=? 0.734535711110498


Final accuracies: 
TRAIN      = 0.977 +- 0.008
ID_VAL     = 0.844 +- 0.006
VAL        = 0.749 +- 0.010
TEST       = 0.717 +- 0.024
OOD_TRAIN  = 0.940 +- 0.035
OOD_ID_VAL = 0.823 +- 0.007
OOD_VAL    = 0.779 +- 0.006
OOD_TEST   = 0.729 +- 0.020

Final losses: 
TRAIN      = 0.0623 +- 0.0112
ID_VAL     = 0.1458 +- 0.0071
VAL        = 0.1435 +- 0.0145
TEST       = 0.1024 +- 0.0117
OOD_TRAIN  = 0.0821 +- 0.0197
OOD_ID_VAL = 0.1413 +- 0.0118
OOD_VAL    = 0.1240 +- 0.0146
OOD_TEST   = 0.0917 +- 0.0060
Diff id_val-test  = 0.0435 
Diff id_val-test ood_ = 0.0496 

DONE TRAIN LECI GOODHIV/scaffold mitigation_readout

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 14:05:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 02:05:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0m[1;31mERROR[0m: 04/04/2024 02:05:57 PM - utils.py - line 52 : [1mCUDA out of memory. Tried to allocate 3.18 GiB. GPU 0 has a total capacty of 11.77 GiB of which 1.92 GiB is free. Including non-PyTorch memory, this process has 9.85 GiB memory in use. Of the allocated memory 6.54 GiB is allocated by PyTorch, and 2.41 GiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting max_split_size_mb to avoid fragmentation.  See documentation for Memory Management and PYTORCH_CUDA_ALLOC_CONF
[0m
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 562, in goodtg
    print(f'#E#{e}')
Time to train models!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:07:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:07:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mTrain ACCURACY: 0.9482Train Loss: 0.1793
Id_val ACCURACY: 0.9473Id_val Loss: 0.1843
Val ACCURACY: 0.8476Val Loss: 0.5640
Test ACCURACY: 0.3371Test Loss: 4.7760
[1;34mDEBUG[0m: 04/04/2024 04:08:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 186...
[0m[1;37mINFO[0m: [1mCheckpoint 186: 
-----------------------------------
Train ACCURACY: 0.9879
Train Loss: 0.0408
ID Validation ACCURACY: 0.8967
ID Validation Loss: 0.3836
ID Test ACCURACY: 0.8910
ID Test Loss: 0.3737
OOD Validation ACCURACY: 0.8210
OOD Validation Loss: 0.7581
OOD Test ACCURACY: 0.3357
OOD Test Loss: 4.8493

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ACCURACY: 0.9669
Train Loss: 0.1038
ID Validation ACCURACY: 0.8889
ID Validation Loss: 0.3636
ID Test ACCURACY: 0.8920
ID Test Loss: 0.3454
OOD Validation ACCURACY: 0.8796
OOD Validation Loss: 0.3944
OOD Test ACCURACY: 0.5937
OOD Test Loss: 1.5026

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.3357 0.8920 0.5937 0.8889 0.8796[0mTrain ACCURACY: 0.9352Train Loss: 0.2060
Id_val ACCURACY: 0.9366Id_val Loss: 0.2025
Val ACCURACY: 0.9149Val Loss: 0.2532
Test ACCURACY: 0.5936Test Loss: 1.4535
Printing obtained and stored scores: 0.5935714285714285 !=? 0.5937142857142857


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:09:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:09:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mTrain ACCURACY: 0.9571Train Loss: 0.1586
Id_val ACCURACY: 0.9556Id_val Loss: 0.1634
Val ACCURACY: 0.8843Val Loss: 0.3953
Test ACCURACY: 0.3989Test Loss: 3.1366
[1;34mDEBUG[0m: 04/04/2024 04:10:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9954
Train Loss: 0.0235
ID Validation ACCURACY: 0.9044
ID Validation Loss: 0.3485
ID Test ACCURACY: 0.8980
ID Test Loss: 0.3777
OOD Validation ACCURACY: 0.8489
OOD Validation Loss: 0.5902
OOD Test ACCURACY: 0.4007
OOD Test Loss: 3.1852

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9265
Train Loss: 0.2243
ID Validation ACCURACY: 0.8853
ID Validation Loss: 0.3617
ID Test ACCURACY: 0.8787
ID Test Loss: 0.3669
OOD Validation ACCURACY: 0.8706
OOD Validation Loss: 0.3979
OOD Test ACCURACY: 0.4916
OOD Test Loss: 2.4039

[0m[1;37mINFO[0m: [1mChartInfo 0.8980 0.4007 0.8787 0.4916 0.8853 0.8706[0mTrain ACCURACY: 0.9085Train Loss: 0.2788
Id_val ACCURACY: 0.9093Id_val Loss: 0.2773
Val ACCURACY: 0.8923Val Loss: 0.3217
Test ACCURACY: 0.4726Test Loss: 2.3978
Printing obtained and stored scores: 0.4725714285714286 !=? 0.49157142857142855


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:11:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:11:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mTrain ACCURACY: 0.9571Train Loss: 0.1700
Id_val ACCURACY: 0.9577Id_val Loss: 0.1681
Val ACCURACY: 0.7750Val Loss: 0.9732
Test ACCURACY: 0.2174Test Loss: 15.1381
[1;34mDEBUG[0m: 04/04/2024 04:12:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9962
Train Loss: 0.0184
ID Validation ACCURACY: 0.8971
ID Validation Loss: 0.4034
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3939
OOD Validation ACCURACY: 0.7454
OOD Validation Loss: 1.2265
OOD Test ACCURACY: 0.2080
OOD Test Loss: 15.1594

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 121...
[0m[1;37mINFO[0m: [1mCheckpoint 121: 
-----------------------------------
Train ACCURACY: 0.9543
Train Loss: 0.1370
ID Validation ACCURACY: 0.8837
ID Validation Loss: 0.3612
ID Test ACCURACY: 0.8867
ID Test Loss: 0.3557
OOD Validation ACCURACY: 0.8760
OOD Validation Loss: 0.3949
OOD Test ACCURACY: 0.6457
OOD Test Loss: 1.3561

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.2080 0.8867 0.6457 0.8837 0.8760[0mTrain ACCURACY: 0.9270Train Loss: 0.2278
Id_val ACCURACY: 0.9263Id_val Loss: 0.2212
Val ACCURACY: 0.9051Val Loss: 0.2741
Test ACCURACY: 0.6479Test Loss: 1.2710
Printing obtained and stored scores: 0.6478571428571429 !=? 0.6457142857142857


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:13:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:13:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mTrain ACCURACY: 0.9551Train Loss: 0.1747
Id_val ACCURACY: 0.9569Id_val Loss: 0.1716
Val ACCURACY: 0.8394Val Loss: 0.6675
Test ACCURACY: 0.1794Test Loss: 30.9420
[1;34mDEBUG[0m: 04/04/2024 04:14:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 199...
[0m[1;37mINFO[0m: [1mCheckpoint 199: 
-----------------------------------
Train ACCURACY: 0.9953
Train Loss: 0.0210
ID Validation ACCURACY: 0.8947
ID Validation Loss: 0.4144
ID Test ACCURACY: 0.8940
ID Test Loss: 0.4075
OOD Validation ACCURACY: 0.8159
OOD Validation Loss: 0.9172
OOD Test ACCURACY: 0.1800
OOD Test Loss: 30.3619

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 128...
[0m[1;37mINFO[0m: [1mCheckpoint 128: 
-----------------------------------
Train ACCURACY: 0.9521
Train Loss: 0.1419
ID Validation ACCURACY: 0.8747
ID Validation Loss: 0.3859
ID Test ACCURACY: 0.8801
ID Test Loss: 0.3806
OOD Validation ACCURACY: 0.8700
OOD Validation Loss: 0.4310
OOD Test ACCURACY: 0.7046
OOD Test Loss: 1.0001

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1800 0.8801 0.7046 0.8747 0.8700[0mTrain ACCURACY: 0.9219Train Loss: 0.2409
Id_val ACCURACY: 0.9229Id_val Loss: 0.2391
Val ACCURACY: 0.9000Val Loss: 0.2980
Test ACCURACY: 0.7159Test Loss: 0.9330
Printing obtained and stored scores: 0.7158571428571429 !=? 0.7045714285714286


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:15:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:15:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mTrain ACCURACY: 0.9574Train Loss: 0.1668
Id_val ACCURACY: 0.9586Id_val Loss: 0.1679
Val ACCURACY: 0.7136Val Loss: 1.4846
Test ACCURACY: 0.1467Test Loss: 76.6868
[1;34mDEBUG[0m: 04/04/2024 04:16:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 177...
[0m[1;37mINFO[0m: [1mCheckpoint 177: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0148
ID Validation ACCURACY: 0.8996
ID Validation Loss: 0.3885
ID Test ACCURACY: 0.8940
ID Test Loss: 0.3976
OOD Validation ACCURACY: 0.6997
OOD Validation Loss: 1.7319
OOD Test ACCURACY: 0.1520
OOD Test Loss: 75.5642

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9054
Train Loss: 0.2814
ID Validation ACCURACY: 0.8654
ID Validation Loss: 0.4107
ID Test ACCURACY: 0.8644
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8570
OOD Validation Loss: 0.4363
OOD Test ACCURACY: 0.7327
OOD Test Loss: 0.9882

[0m[1;37mINFO[0m: [1mChartInfo 0.8940 0.1520 0.8644 0.7327 0.8654 0.8570[0mTrain ACCURACY: 0.8884Train Loss: 0.3334
Id_val ACCURACY: 0.8910Id_val Loss: 0.3313
Val ACCURACY: 0.8824Val Loss: 0.3540
Test ACCURACY: 0.7416Test Loss: 0.9203
Printing obtained and stored scores: 0.7415714285714285 !=? 0.7327142857142858


Final accuracies: 
TRAIN      = 0.955 +- 0.003
ID_VAL     = 0.955 +- 0.004
VAL        = 0.812 +- 0.060
TEST       = 0.256 +- 0.096
OOD_TRAIN  = 0.916 +- 0.016
OOD_ID_VAL = 0.917 +- 0.016
OOD_VAL    = 0.899 +- 0.011
OOD_TEST   = 0.634 +- 0.096

Final losses: 
TRAIN      = 0.1699 +- 0.0071
ID_VAL     = 0.1710 +- 0.0071
VAL        = 0.8169 +- 0.3832
TEST       = 26.1359 +- 27.1465
OOD_TRAIN  = 0.2574 +- 0.0448
OOD_ID_VAL = 0.2543 +- 0.0457
OOD_VAL    = 0.3002 +- 0.0353
OOD_TEST   = 1.3951 +- 0.5410
Diff id_val-test  = 25.9649 
Diff id_val-test ood_ = 1.1408 


[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:18:24 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:18:26 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9982
Train Loss: 0.0116
ID Validation ACCURACY: 0.9041
ID Validation Loss: 0.3838
ID Test ACCURACY: 0.9016
ID Test Loss: 0.4021
OOD Validation ACCURACY: 0.8686
OOD Validation Loss: 0.5562
OOD Test ACCURACY: 0.5691
OOD Test Loss: 5.0866

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9945
Train Loss: 0.0234
ID Validation ACCURACY: 0.9013
ID Validation Loss: 0.3604
ID Test ACCURACY: 0.9033
ID Test Loss: 0.3697
OOD Validation ACCURACY: 0.8911
OOD Validation Loss: 0.4327
OOD Test ACCURACY: 0.7119
OOD Test Loss: 1.6593

[0m[1;37mINFO[0m: [1mChartInfo 0.9016 0.5691 0.9033 0.7119 0.9013 0.8911[0mTrain ACCURACY: 0.9604Train Loss: 0.1637
Id_val ACCURACY: 0.9600Id_val Loss: 0.1633
Val ACCURACY: 0.9237Val Loss: 0.2687
Test ACCURACY: 0.5789Test Loss: 5.1704
[1;34mDEBUG[0m: 04/04/2024 04:19:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9982
Train Loss: 0.0116
ID Validation ACCURACY: 0.9041
ID Validation Loss: 0.3838
ID Test ACCURACY: 0.9016
ID Test Loss: 0.4021
OOD Validation ACCURACY: 0.8686
OOD Validation Loss: 0.5562
OOD Test ACCURACY: 0.5691
OOD Test Loss: 5.0866

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 143...
[0m[1;37mINFO[0m: [1mCheckpoint 143: 
-----------------------------------
Train ACCURACY: 0.9945
Train Loss: 0.0234
ID Validation ACCURACY: 0.9013
ID Validation Loss: 0.3604
ID Test ACCURACY: 0.9033
ID Test Loss: 0.3697
OOD Validation ACCURACY: 0.8911
OOD Validation Loss: 0.4327
OOD Test ACCURACY: 0.7119
OOD Test Loss: 1.6593

[0m[1;37mINFO[0m: [1mChartInfo 0.9016 0.5691 0.9033 0.7119 0.9013 0.8911[0mTrain ACCURACY: 0.9581Train Loss: 0.1594
Id_val ACCURACY: 0.9554Id_val Loss: 0.1660
Val ACCURACY: 0.9390Val Loss: 0.2067
Test ACCURACY: 0.7159Test Loss: 1.5471
Printing obtained and stored scores: 0.7158571428571429 !=? 0.7118571428571429


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:20:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:20:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ACCURACY: 0.9895
Train Loss: 0.0368
ID Validation ACCURACY: 0.8991
ID Validation Loss: 0.3644
ID Test ACCURACY: 0.8936
ID Test Loss: 0.3839
OOD Validation ACCURACY: 0.8770
OOD Validation Loss: 0.4499
OOD Test ACCURACY: 0.4940
OOD Test Loss: 2.9614

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 161...
[0m[1;37mINFO[0m: [1mCheckpoint 161: 
-----------------------------------
Train ACCURACY: 0.9911
Train Loss: 0.0328
ID Validation ACCURACY: 0.8986
ID Validation Loss: 0.3696
ID Test ACCURACY: 0.8951
ID Test Loss: 0.3805
OOD Validation ACCURACY: 0.8856
OOD Validation Loss: 0.4241
OOD Test ACCURACY: 0.5491
OOD Test Loss: 2.5001

[0m[1;37mINFO[0m: [1mChartInfo 0.8936 0.4940 0.8951 0.5491 0.8986 0.8856[0mTrain ACCURACY: 0.9519Train Loss: 0.1738
Id_val ACCURACY: 0.9536Id_val Loss: 0.1701
Val ACCURACY: 0.9219Val Loss: 0.2508
Test ACCURACY: 0.5001Test Loss: 2.9243
[1;34mDEBUG[0m: 04/04/2024 04:21:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ACCURACY: 0.9895
Train Loss: 0.0368
ID Validation ACCURACY: 0.8991
ID Validation Loss: 0.3644
ID Test ACCURACY: 0.8936
ID Test Loss: 0.3839
OOD Validation ACCURACY: 0.8770
OOD Validation Loss: 0.4499
OOD Test ACCURACY: 0.4940
OOD Test Loss: 2.9614

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 161...
[0m[1;37mINFO[0m: [1mCheckpoint 161: 
-----------------------------------
Train ACCURACY: 0.9911
Train Loss: 0.0328
ID Validation ACCURACY: 0.8986
ID Validation Loss: 0.3696
ID Test ACCURACY: 0.8951
ID Test Loss: 0.3805
OOD Validation ACCURACY: 0.8856
OOD Validation Loss: 0.4241
OOD Test ACCURACY: 0.5491
OOD Test Loss: 2.5001

[0m[1;37mINFO[0m: [1mChartInfo 0.8936 0.4940 0.8951 0.5491 0.8986 0.8856[0mTrain ACCURACY: 0.9531Train Loss: 0.1718
Id_val ACCURACY: 0.9524Id_val Loss: 0.1748
Val ACCURACY: 0.9336Val Loss: 0.2184
Test ACCURACY: 0.5589Test Loss: 2.4336
Printing obtained and stored scores: 0.5588571428571428 !=? 0.5491428571428572


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:22:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:22:21 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:22:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0122
ID Validation ACCURACY: 0.9020
ID Validation Loss: 0.4048
ID Test ACCURACY: 0.8964
ID Test Loss: 0.4180
OOD Validation ACCURACY: 0.8684
OOD Validation Loss: 0.5222
OOD Test ACCURACY: 0.3916
OOD Test Loss: 6.8162

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.0990
ID Validation ACCURACY: 0.8980
ID Validation Loss: 0.3369
ID Test ACCURACY: 0.8956
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.8854
OOD Validation Loss: 0.3793
OOD Test ACCURACY: 0.7431
OOD Test Loss: 1.0135

[0m[1;37mINFO[0m: [1mChartInfo 0.8964 0.3916 0.8956 0.7431 0.8980 0.8854[0mTrain ACCURACY: 0.9596Train Loss: 0.1671
Id_val ACCURACY: 0.9561Id_val Loss: 0.1796
Val ACCURACY: 0.9243Val Loss: 0.2734
Test ACCURACY: 0.3953Test Loss: 6.7761
[1;34mDEBUG[0m: 04/04/2024 04:23:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 189...
[0m[1;37mINFO[0m: [1mCheckpoint 189: 
-----------------------------------
Train ACCURACY: 0.9977
Train Loss: 0.0122
ID Validation ACCURACY: 0.9020
ID Validation Loss: 0.4048
ID Test ACCURACY: 0.8964
ID Test Loss: 0.4180
OOD Validation ACCURACY: 0.8684
OOD Validation Loss: 0.5222
OOD Test ACCURACY: 0.3916
OOD Test Loss: 6.8162

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.0990
ID Validation ACCURACY: 0.8980
ID Validation Loss: 0.3369
ID Test ACCURACY: 0.8956
ID Test Loss: 0.3387
OOD Validation ACCURACY: 0.8854
OOD Validation Loss: 0.3793
OOD Test ACCURACY: 0.7431
OOD Test Loss: 1.0135

[0m[1;37mINFO[0m: [1mChartInfo 0.8964 0.3916 0.8956 0.7431 0.8980 0.8854[0mTrain ACCURACY: 0.9385Train Loss: 0.1948
Id_val ACCURACY: 0.9369Id_val Loss: 0.2016
Val ACCURACY: 0.9216Val Loss: 0.2395
Test ACCURACY: 0.7561Test Loss: 0.9538
Printing obtained and stored scores: 0.7561428571428571 !=? 0.7431428571428571


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:24:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:18 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:24:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9970
Train Loss: 0.0158
ID Validation ACCURACY: 0.9020
ID Validation Loss: 0.3897
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4044
OOD Validation ACCURACY: 0.8734
OOD Validation Loss: 0.5272
OOD Test ACCURACY: 0.6619
OOD Test Loss: 1.9791

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.9799
Train Loss: 0.0665
ID Validation ACCURACY: 0.8979
ID Validation Loss: 0.3461
ID Test ACCURACY: 0.8966
ID Test Loss: 0.3492
OOD Validation ACCURACY: 0.8897
OOD Validation Loss: 0.3708
OOD Test ACCURACY: 0.7326
OOD Test Loss: 1.0225

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6619 0.8966 0.7326 0.8979 0.8897[0mTrain ACCURACY: 0.9579Train Loss: 0.1690
Id_val ACCURACY: 0.9573Id_val Loss: 0.1768
Val ACCURACY: 0.9280Val Loss: 0.2499
Test ACCURACY: 0.6757Test Loss: 1.7876
[1;34mDEBUG[0m: 04/04/2024 04:25:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 181...
[0m[1;37mINFO[0m: [1mCheckpoint 181: 
-----------------------------------
Train ACCURACY: 0.9970
Train Loss: 0.0158
ID Validation ACCURACY: 0.9020
ID Validation Loss: 0.3897
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4044
OOD Validation ACCURACY: 0.8734
OOD Validation Loss: 0.5272
OOD Test ACCURACY: 0.6619
OOD Test Loss: 1.9791

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 118...
[0m[1;37mINFO[0m: [1mCheckpoint 118: 
-----------------------------------
Train ACCURACY: 0.9799
Train Loss: 0.0665
ID Validation ACCURACY: 0.8979
ID Validation Loss: 0.3461
ID Test ACCURACY: 0.8966
ID Test Loss: 0.3492
OOD Validation ACCURACY: 0.8897
OOD Validation Loss: 0.3708
OOD Test ACCURACY: 0.7326
OOD Test Loss: 1.0225

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6619 0.8966 0.7326 0.8979 0.8897[0mTrain ACCURACY: 0.9454Train Loss: 0.1798
Id_val ACCURACY: 0.9466Id_val Loss: 0.1836
Val ACCURACY: 0.9291Val Loss: 0.2190
Test ACCURACY: 0.7524Test Loss: 0.9353
Printing obtained and stored scores: 0.7524285714285714 !=? 0.7325714285714285


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODCMNIST/color/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:26:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODCMNIST
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mDataset: {'train': GOODCMNIST(42000), 'id_val': GOODCMNIST(7000), 'id_test': GOODCMNIST(7000), 'val': GOODCMNIST(7000), 'test': GOODCMNIST(7000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1m Data(x=[75, 3], edge_index=[2, 1309], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1309], node_perm=[75])
[0mData(x=[75, 3], edge_index=[2, 1496], y=[1], pos=[75, 2], color=[1], env_id=[1], ori_edge_index=[2, 1496], node_perm=[75])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:26:15 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:26:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0231
ID Validation ACCURACY: 0.9024
ID Validation Loss: 0.3659
ID Test ACCURACY: 0.8969
ID Test Loss: 0.3748
OOD Validation ACCURACY: 0.8824
OOD Validation Loss: 0.4311
OOD Test ACCURACY: 0.7293
OOD Test Loss: 1.2294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9895
Train Loss: 0.0364
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.3635
ID Test ACCURACY: 0.9014
ID Test Loss: 0.3583
OOD Validation ACCURACY: 0.8921
OOD Validation Loss: 0.4134
OOD Test ACCURACY: 0.7336
OOD Test Loss: 1.4819

[0m[1;37mINFO[0m: [1mChartInfo 0.8969 0.7293 0.9014 0.7336 0.8990 0.8921[0mTrain ACCURACY: 0.9578Train Loss: 0.1585
Id_val ACCURACY: 0.9577Id_val Loss: 0.1639
Val ACCURACY: 0.9349Val Loss: 0.2100
Test ACCURACY: 0.7433Test Loss: 1.1651
[1;34mDEBUG[0m: 04/04/2024 04:27:14 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 158...
[0m[1;37mINFO[0m: [1mCheckpoint 158: 
-----------------------------------
Train ACCURACY: 0.9950
Train Loss: 0.0231
ID Validation ACCURACY: 0.9024
ID Validation Loss: 0.3659
ID Test ACCURACY: 0.8969
ID Test Loss: 0.3748
OOD Validation ACCURACY: 0.8824
OOD Validation Loss: 0.4311
OOD Test ACCURACY: 0.7293
OOD Test Loss: 1.2294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9895
Train Loss: 0.0364
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.3635
ID Test ACCURACY: 0.9014
ID Test Loss: 0.3583
OOD Validation ACCURACY: 0.8921
OOD Validation Loss: 0.4134
OOD Test ACCURACY: 0.7336
OOD Test Loss: 1.4819

[0m[1;37mINFO[0m: [1mChartInfo 0.8969 0.7293 0.9014 0.7336 0.8990 0.8921[0mTrain ACCURACY: 0.9536Train Loss: 0.1665
Id_val ACCURACY: 0.9526Id_val Loss: 0.1715
Val ACCURACY: 0.9320Val Loss: 0.2160
Test ACCURACY: 0.7529Test Loss: 1.3120
Printing obtained and stored scores: 0.7528571428571429 !=? 0.7335714285714285


Final accuracies: 
TRAIN      = 0.958 +- 0.003
ID_VAL     = 0.957 +- 0.002
VAL        = 0.927 +- 0.005
TEST       = 0.579 +- 0.124
OOD_TRAIN  = 0.950 +- 0.007
OOD_ID_VAL = 0.949 +- 0.007
OOD_VAL    = 0.931 +- 0.006
OOD_TEST   = 0.707 +- 0.076

Final losses: 
TRAIN      = 0.1664 +- 0.0051
ID_VAL     = 0.1708 +- 0.0066
VAL        = 0.2505 +- 0.0224
TEST       = 3.5647 +- 2.1079
OOD_TRAIN  = 0.1745 +- 0.0121
OOD_ID_VAL = 0.1795 +- 0.0124
OOD_VAL    = 0.2199 +- 0.0107
OOD_TEST   = 1.4363 +- 0.5488
Diff id_val-test  = 3.3940 
Diff id_val-test ood_ = 1.2568 

DONE TRAIN LECI GOODCMNIST/color mitigation_readout

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:28:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:28:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ROC-AUC: 0.9747
Train Loss: 0.1592
ID Validation ROC-AUC: 0.9216
ID Validation Loss: 0.3096
ID Test ROC-AUC: 0.9242
ID Test Loss: 0.3130
OOD Validation ROC-AUC: 0.6625
OOD Validation Loss: 0.4639
OOD Test ROC-AUC: 0.7200
OOD Test Loss: 0.6879

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.2596
ID Validation ROC-AUC: 0.8990
ID Validation Loss: 0.2737
ID Test ROC-AUC: 0.9017
ID Test Loss: 0.2762
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2996
OOD Test ROC-AUC: 0.7346
OOD Test Loss: 0.4781

[0m[1;37mINFO[0m: [1mChartInfo 0.9242 0.7200 0.9017 0.7346 0.8990 0.6935[0mTrain ROC-AUC: 0.9747Train Loss: 0.1592
Id_val ROC-AUC: 0.9216Id_val Loss: 0.3096
Val ROC-AUC: 0.6625Val Loss: 0.4639
Test ROC-AUC: 0.7200Test Loss: 0.6879
[1;34mDEBUG[0m: 04/04/2024 04:29:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 174...
[0m[1;37mINFO[0m: [1mCheckpoint 174: 
-----------------------------------
Train ROC-AUC: 0.9747
Train Loss: 0.1592
ID Validation ROC-AUC: 0.9216
ID Validation Loss: 0.3096
ID Test ROC-AUC: 0.9242
ID Test Loss: 0.3130
OOD Validation ROC-AUC: 0.6625
OOD Validation Loss: 0.4639
OOD Test ROC-AUC: 0.7200
OOD Test Loss: 0.6879

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ROC-AUC: 0.9117
Train Loss: 0.2596
ID Validation ROC-AUC: 0.8990
ID Validation Loss: 0.2737
ID Test ROC-AUC: 0.9017
ID Test Loss: 0.2762
OOD Validation ROC-AUC: 0.6935
OOD Validation Loss: 0.2996
OOD Test ROC-AUC: 0.7346
OOD Test Loss: 0.4781

[0m[1;37mINFO[0m: [1mChartInfo 0.9242 0.7200 0.9017 0.7346 0.8990 0.6935[0mTrain ROC-AUC: 0.9117Train Loss: 0.2596
Id_val ROC-AUC: 0.8990Id_val Loss: 0.2737
Val ROC-AUC: 0.6935Val Loss: 0.2996
Test ROC-AUC: 0.7346Test Loss: 0.4781
Printing obtained and stored scores: 0.7346368134827855 !=? 0.7346379377008867


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:29:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:29:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9783
Train Loss: 0.1269
ID Validation ROC-AUC: 0.9244
ID Validation Loss: 0.2658
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.2679
OOD Validation ROC-AUC: 0.6593
OOD Validation Loss: 0.4783
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9086
Train Loss: 0.2436
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2566
ID Test ROC-AUC: 0.8988
ID Test Loss: 0.2585
OOD Validation ROC-AUC: 0.6869
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7309
OOD Test Loss: 0.4531

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7128 0.8988 0.7309 0.8959 0.6869[0mTrain ROC-AUC: 0.9783Train Loss: 0.1269
Id_val ROC-AUC: 0.9244Id_val Loss: 0.2658
Val ROC-AUC: 0.6593Val Loss: 0.4783
Test ROC-AUC: 0.7128Test Loss: 0.6262
[1;34mDEBUG[0m: 04/04/2024 04:30:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 167...
[0m[1;37mINFO[0m: [1mCheckpoint 167: 
-----------------------------------
Train ROC-AUC: 0.9783
Train Loss: 0.1269
ID Validation ROC-AUC: 0.9244
ID Validation Loss: 0.2658
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.2679
OOD Validation ROC-AUC: 0.6593
OOD Validation Loss: 0.4783
OOD Test ROC-AUC: 0.7128
OOD Test Loss: 0.6262

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9086
Train Loss: 0.2436
ID Validation ROC-AUC: 0.8959
ID Validation Loss: 0.2566
ID Test ROC-AUC: 0.8988
ID Test Loss: 0.2585
OOD Validation ROC-AUC: 0.6869
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7309
OOD Test Loss: 0.4531

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7128 0.8988 0.7309 0.8959 0.6869[0mTrain ROC-AUC: 0.9086Train Loss: 0.2436
Id_val ROC-AUC: 0.8959Id_val Loss: 0.2566
Val ROC-AUC: 0.6869Val Loss: 0.2916
Test ROC-AUC: 0.7309Test Loss: 0.4530
Printing obtained and stored scores: 0.7308920230895694 !=? 0.7308940427026187


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:31:09 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:10 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:31:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9586
Train Loss: 0.1793
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2525
OOD Validation ROC-AUC: 0.6759
OOD Validation Loss: 0.3745
OOD Test ROC-AUC: 0.7109
OOD Test Loss: 0.5685

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ROC-AUC: 0.9479
Train Loss: 0.1985
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2618
ID Test ROC-AUC: 0.9197
ID Test Loss: 0.2606
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.3598
OOD Test ROC-AUC: 0.7250
OOD Test Loss: 0.5469

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7109 0.9197 0.7250 0.9155 0.6885[0mTrain ROC-AUC: 0.9586Train Loss: 0.1793
Id_val ROC-AUC: 0.9217Id_val Loss: 0.2533
Val ROC-AUC: 0.6759Val Loss: 0.3745
Test ROC-AUC: 0.7109Test Loss: 0.5685
[1;34mDEBUG[0m: 04/04/2024 04:31:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9586
Train Loss: 0.1793
ID Validation ROC-AUC: 0.9217
ID Validation Loss: 0.2533
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2525
OOD Validation ROC-AUC: 0.6759
OOD Validation Loss: 0.3745
OOD Test ROC-AUC: 0.7109
OOD Test Loss: 0.5685

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ROC-AUC: 0.9479
Train Loss: 0.1985
ID Validation ROC-AUC: 0.9155
ID Validation Loss: 0.2618
ID Test ROC-AUC: 0.9197
ID Test Loss: 0.2606
OOD Validation ROC-AUC: 0.6885
OOD Validation Loss: 0.3598
OOD Test ROC-AUC: 0.7250
OOD Test Loss: 0.5469

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7109 0.9197 0.7250 0.9155 0.6885[0mTrain ROC-AUC: 0.9479Train Loss: 0.1985
Id_val ROC-AUC: 0.9155Id_val Loss: 0.2618
Val ROC-AUC: 0.6885Val Loss: 0.3598
Test ROC-AUC: 0.7250Test Loss: 0.5469
Printing obtained and stored scores: 0.724963662883245 !=? 0.7249648965385065


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:32:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:32:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9561
Train Loss: 0.1699
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2340
ID Test ROC-AUC: 0.9235
ID Test Loss: 0.2358
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3970
OOD Test ROC-AUC: 0.7067
OOD Test Loss: 0.5494

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9016
Train Loss: 0.2482
ID Validation ROC-AUC: 0.8949
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8953
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6908
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7285
OOD Test Loss: 0.4503

[0m[1;37mINFO[0m: [1mChartInfo 0.9235 0.7067 0.8953 0.7285 0.8949 0.6908[0mTrain ROC-AUC: 0.9561Train Loss: 0.1699
Id_val ROC-AUC: 0.9223Id_val Loss: 0.2340
Val ROC-AUC: 0.6576Val Loss: 0.3970
Test ROC-AUC: 0.7067Test Loss: 0.5494
[1;34mDEBUG[0m: 04/04/2024 04:33:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 107...
[0m[1;37mINFO[0m: [1mCheckpoint 107: 
-----------------------------------
Train ROC-AUC: 0.9561
Train Loss: 0.1699
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2340
ID Test ROC-AUC: 0.9235
ID Test Loss: 0.2358
OOD Validation ROC-AUC: 0.6576
OOD Validation Loss: 0.3970
OOD Test ROC-AUC: 0.7067
OOD Test Loss: 0.5494

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ROC-AUC: 0.9016
Train Loss: 0.2482
ID Validation ROC-AUC: 0.8949
ID Validation Loss: 0.2557
ID Test ROC-AUC: 0.8953
ID Test Loss: 0.2587
OOD Validation ROC-AUC: 0.6908
OOD Validation Loss: 0.2916
OOD Test ROC-AUC: 0.7285
OOD Test Loss: 0.4503

[0m[1;37mINFO[0m: [1mChartInfo 0.9235 0.7067 0.8953 0.7285 0.8949 0.6908[0mTrain ROC-AUC: 0.9016Train Loss: 0.2482
Id_val ROC-AUC: 0.8949Id_val Loss: 0.2557
Val ROC-AUC: 0.6908Val Loss: 0.2916
Test ROC-AUC: 0.7285Test Loss: 0.4503
Printing obtained and stored scores: 0.7284745960137176 !=? 0.7284727853261562


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': None,
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:33:36 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:33:37 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9604
Train Loss: 0.1577
ID Validation ROC-AUC: 0.9213
ID Validation Loss: 0.2276
ID Test ROC-AUC: 0.9231
ID Test Loss: 0.2288
OOD Validation ROC-AUC: 0.6638
OOD Validation Loss: 0.4052
OOD Test ROC-AUC: 0.7105
OOD Test Loss: 0.5421

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.8989
Train Loss: 0.2529
ID Validation ROC-AUC: 0.8912
ID Validation Loss: 0.2608
ID Test ROC-AUC: 0.8911
ID Test Loss: 0.2654
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.2898
OOD Test ROC-AUC: 0.7229
OOD Test Loss: 0.4564

[0m[1;37mINFO[0m: [1mChartInfo 0.9231 0.7105 0.8911 0.7229 0.8912 0.6866[0mTrain ROC-AUC: 0.9604Train Loss: 0.1577
Id_val ROC-AUC: 0.9213Id_val Loss: 0.2276
Val ROC-AUC: 0.6638Val Loss: 0.4052
Test ROC-AUC: 0.7105Test Loss: 0.5421
[1;34mDEBUG[0m: 04/04/2024 04:34:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 117...
[0m[1;37mINFO[0m: [1mCheckpoint 117: 
-----------------------------------
Train ROC-AUC: 0.9604
Train Loss: 0.1577
ID Validation ROC-AUC: 0.9213
ID Validation Loss: 0.2276
ID Test ROC-AUC: 0.9231
ID Test Loss: 0.2288
OOD Validation ROC-AUC: 0.6638
OOD Validation Loss: 0.4052
OOD Test ROC-AUC: 0.7105
OOD Test Loss: 0.5421

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ROC-AUC: 0.8989
Train Loss: 0.2529
ID Validation ROC-AUC: 0.8912
ID Validation Loss: 0.2608
ID Test ROC-AUC: 0.8911
ID Test Loss: 0.2654
OOD Validation ROC-AUC: 0.6866
OOD Validation Loss: 0.2898
OOD Test ROC-AUC: 0.7229
OOD Test Loss: 0.4564

[0m[1;37mINFO[0m: [1mChartInfo 0.9231 0.7105 0.8911 0.7229 0.8912 0.6866[0mTrain ROC-AUC: 0.8989Train Loss: 0.2529
Id_val ROC-AUC: 0.8912Id_val Loss: 0.2608
Val ROC-AUC: 0.6866Val Loss: 0.2898
Test ROC-AUC: 0.7229Test Loss: 0.4564
Printing obtained and stored scores: 0.7228640612185904 !=? 0.7228638323954368


Final accuracies: 
TRAIN      = 0.966 +- 0.009
ID_VAL     = 0.922 +- 0.001
VAL        = 0.664 +- 0.006
TEST       = 0.712 +- 0.004
OOD_TRAIN  = 0.914 +- 0.018
OOD_ID_VAL = 0.899 +- 0.008
OOD_VAL    = 0.689 +- 0.003
OOD_TEST   = 0.728 +- 0.004

Final losses: 
TRAIN      = 0.1586 +- 0.0177
ID_VAL     = 0.2580 +- 0.0291
VAL        = 0.4238 +- 0.0402
TEST       = 0.5948 +- 0.0551
OOD_TRAIN  = 0.2406 +- 0.0217
OOD_ID_VAL = 0.2617 +- 0.0064
OOD_VAL    = 0.3065 +- 0.0269
OOD_TEST   = 0.4769 +- 0.0363
Diff id_val-test  = 0.3368 
Diff id_val-test ood_ = 0.2152 


[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:35:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:35:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ROC-AUC: 0.9727
Train Loss: 0.1378
ID Validation ROC-AUC: 0.9248
ID Validation Loss: 0.2674
ID Test ROC-AUC: 0.9280
ID Test Loss: 0.2650
OOD Validation ROC-AUC: 0.6550
OOD Validation Loss: 0.4948
OOD Test ROC-AUC: 0.7073
OOD Test Loss: 0.6679

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 56...
[0m[1;37mINFO[0m: [1mCheckpoint 56: 
-----------------------------------
Train ROC-AUC: 0.9313
Train Loss: 0.2369
ID Validation ROC-AUC: 0.9115
ID Validation Loss: 0.2655
ID Test ROC-AUC: 0.9145
ID Test Loss: 0.2678
OOD Validation ROC-AUC: 0.7016
OOD Validation Loss: 0.3203
OOD Test ROC-AUC: 0.7225
OOD Test Loss: 0.5195

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.7073 0.9145 0.7225 0.9115 0.7016[0mTrain ROC-AUC: 0.9727Train Loss: 0.1378
Id_val ROC-AUC: 0.9248Id_val Loss: 0.2674
Val ROC-AUC: 0.6550Val Loss: 0.4948
Test ROC-AUC: 0.7073Test Loss: 0.6679
[1;34mDEBUG[0m: 04/04/2024 04:35:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 154...
[0m[1;37mINFO[0m: [1mCheckpoint 154: 
-----------------------------------
Train ROC-AUC: 0.9727
Train Loss: 0.1378
ID Validation ROC-AUC: 0.9248
ID Validation Loss: 0.2674
ID Test ROC-AUC: 0.9280
ID Test Loss: 0.2650
OOD Validation ROC-AUC: 0.6550
OOD Validation Loss: 0.4948
OOD Test ROC-AUC: 0.7073
OOD Test Loss: 0.6679

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 56...
[0m[1;37mINFO[0m: [1mCheckpoint 56: 
-----------------------------------
Train ROC-AUC: 0.9313
Train Loss: 0.2369
ID Validation ROC-AUC: 0.9115
ID Validation Loss: 0.2655
ID Test ROC-AUC: 0.9145
ID Test Loss: 0.2678
OOD Validation ROC-AUC: 0.7016
OOD Validation Loss: 0.3203
OOD Test ROC-AUC: 0.7225
OOD Test Loss: 0.5195

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.7073 0.9145 0.7225 0.9115 0.7016[0mTrain ROC-AUC: 0.9313Train Loss: 0.2369
Id_val ROC-AUC: 0.9115Id_val Loss: 0.2655
Val ROC-AUC: 0.7016Val Loss: 0.3203
Test ROC-AUC: 0.7225Test Loss: 0.5195
Printing obtained and stored scores: 0.7224723856218513 !=? 0.7224723856218513


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:36:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:36:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9651
Train Loss: 0.1565
ID Validation ROC-AUC: 0.9232
ID Validation Loss: 0.2486
ID Test ROC-AUC: 0.9247
ID Test Loss: 0.2522
OOD Validation ROC-AUC: 0.6738
OOD Validation Loss: 0.4349
OOD Test ROC-AUC: 0.7050
OOD Test Loss: 0.6209

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9095
Train Loss: 0.2555
ID Validation ROC-AUC: 0.8966
ID Validation Loss: 0.2709
ID Test ROC-AUC: 0.8993
ID Test Loss: 0.2732
OOD Validation ROC-AUC: 0.6989
OOD Validation Loss: 0.3054
OOD Test ROC-AUC: 0.7302
OOD Test Loss: 0.4911

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.7050 0.8993 0.7302 0.8966 0.6989[0mTrain ROC-AUC: 0.9651Train Loss: 0.1565
Id_val ROC-AUC: 0.9232Id_val Loss: 0.2486
Val ROC-AUC: 0.6738Val Loss: 0.4349
Test ROC-AUC: 0.7050Test Loss: 0.6209
[1;34mDEBUG[0m: 04/04/2024 04:36:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9651
Train Loss: 0.1565
ID Validation ROC-AUC: 0.9232
ID Validation Loss: 0.2486
ID Test ROC-AUC: 0.9247
ID Test Loss: 0.2522
OOD Validation ROC-AUC: 0.6738
OOD Validation Loss: 0.4349
OOD Test ROC-AUC: 0.7050
OOD Test Loss: 0.6209

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ROC-AUC: 0.9095
Train Loss: 0.2555
ID Validation ROC-AUC: 0.8966
ID Validation Loss: 0.2709
ID Test ROC-AUC: 0.8993
ID Test Loss: 0.2732
OOD Validation ROC-AUC: 0.6989
OOD Validation Loss: 0.3054
OOD Test ROC-AUC: 0.7302
OOD Test Loss: 0.4911

[0m[1;37mINFO[0m: [1mChartInfo 0.9247 0.7050 0.8993 0.7302 0.8966 0.6989[0mTrain ROC-AUC: 0.9095Train Loss: 0.2555
Id_val ROC-AUC: 0.8966Id_val Loss: 0.2709
Val ROC-AUC: 0.6989Val Loss: 0.3054
Test ROC-AUC: 0.7302Test Loss: 0.4911
Printing obtained and stored scores: 0.7302419663573455 !=? 0.7302419663573455


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:37:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:30 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:37:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9599
Train Loss: 0.1725
ID Validation ROC-AUC: 0.9219
ID Validation Loss: 0.2486
ID Test ROC-AUC: 0.9238
ID Test Loss: 0.2502
OOD Validation ROC-AUC: 0.6637
OOD Validation Loss: 0.3933
OOD Test ROC-AUC: 0.7126
OOD Test Loss: 0.5743

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9060
Train Loss: 0.2554
ID Validation ROC-AUC: 0.8940
ID Validation Loss: 0.2686
ID Test ROC-AUC: 0.8978
ID Test Loss: 0.2703
OOD Validation ROC-AUC: 0.6978
OOD Validation Loss: 0.2989
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.4799

[0m[1;37mINFO[0m: [1mChartInfo 0.9238 0.7126 0.8978 0.7280 0.8940 0.6978[0mTrain ROC-AUC: 0.9599Train Loss: 0.1725
Id_val ROC-AUC: 0.9219Id_val Loss: 0.2486
Val ROC-AUC: 0.6637Val Loss: 0.3933
Test ROC-AUC: 0.7126Test Loss: 0.5743
[1;34mDEBUG[0m: 04/04/2024 04:38:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ROC-AUC: 0.9599
Train Loss: 0.1725
ID Validation ROC-AUC: 0.9219
ID Validation Loss: 0.2486
ID Test ROC-AUC: 0.9238
ID Test Loss: 0.2502
OOD Validation ROC-AUC: 0.6637
OOD Validation Loss: 0.3933
OOD Test ROC-AUC: 0.7126
OOD Test Loss: 0.5743

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9060
Train Loss: 0.2554
ID Validation ROC-AUC: 0.8940
ID Validation Loss: 0.2686
ID Test ROC-AUC: 0.8978
ID Test Loss: 0.2703
OOD Validation ROC-AUC: 0.6978
OOD Validation Loss: 0.2989
OOD Test ROC-AUC: 0.7280
OOD Test Loss: 0.4799

[0m[1;37mINFO[0m: [1mChartInfo 0.9238 0.7126 0.8978 0.7280 0.8940 0.6978[0mTrain ROC-AUC: 0.9060Train Loss: 0.2554
Id_val ROC-AUC: 0.8940Id_val Loss: 0.2686
Val ROC-AUC: 0.6978Val Loss: 0.2989
Test ROC-AUC: 0.7280Test Loss: 0.4799
Printing obtained and stored scores: 0.7280447069503659 !=? 0.7280447069503659


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:38:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:38:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ROC-AUC: 0.9683
Train Loss: 0.1544
ID Validation ROC-AUC: 0.9248
ID Validation Loss: 0.2444
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2478
OOD Validation ROC-AUC: 0.6793
OOD Validation Loss: 0.3957
OOD Test ROC-AUC: 0.7158
OOD Test Loss: 0.5602

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ROC-AUC: 0.9510
Train Loss: 0.1952
ID Validation ROC-AUC: 0.9178
ID Validation Loss: 0.2653
ID Test ROC-AUC: 0.9200
ID Test Loss: 0.2655
OOD Validation ROC-AUC: 0.6963
OOD Validation Loss: 0.3695
OOD Test ROC-AUC: 0.7235
OOD Test Loss: 0.5689

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7158 0.9200 0.7235 0.9178 0.6963[0mTrain ROC-AUC: 0.9683Train Loss: 0.1544
Id_val ROC-AUC: 0.9248Id_val Loss: 0.2444
Val ROC-AUC: 0.6793Val Loss: 0.3957
Test ROC-AUC: 0.7158Test Loss: 0.5602
[1;34mDEBUG[0m: 04/04/2024 04:39:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ROC-AUC: 0.9683
Train Loss: 0.1544
ID Validation ROC-AUC: 0.9248
ID Validation Loss: 0.2444
ID Test ROC-AUC: 0.9244
ID Test Loss: 0.2478
OOD Validation ROC-AUC: 0.6793
OOD Validation Loss: 0.3957
OOD Test ROC-AUC: 0.7158
OOD Test Loss: 0.5602

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ROC-AUC: 0.9510
Train Loss: 0.1952
ID Validation ROC-AUC: 0.9178
ID Validation Loss: 0.2653
ID Test ROC-AUC: 0.9200
ID Test Loss: 0.2655
OOD Validation ROC-AUC: 0.6963
OOD Validation Loss: 0.3695
OOD Test ROC-AUC: 0.7235
OOD Test Loss: 0.5689

[0m[1;37mINFO[0m: [1mChartInfo 0.9244 0.7158 0.9200 0.7235 0.9178 0.6963[0mTrain ROC-AUC: 0.9510Train Loss: 0.1952
Id_val ROC-AUC: 0.9178Id_val Loss: 0.2653
Val ROC-AUC: 0.6963Val Loss: 0.3695
Test ROC-AUC: 0.7235Test Loss: 0.5689
Printing obtained and stored scores: 0.7234922902117494 !=? 0.7234922902117494


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 0,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 16:39:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0mLECIvGIN
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mUsing the fixed _explain_ functionality
[0mmitigation_virtual in vGINMolEncoder =  None
[1;34mDEBUG[0m: 04/04/2024 04:39:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9712
Train Loss: 0.1682
ID Validation ROC-AUC: 0.9235
ID Validation Loss: 0.3171
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.3191
OOD Validation ROC-AUC: 0.6651
OOD Validation Loss: 0.5310
OOD Test ROC-AUC: 0.7146
OOD Test Loss: 0.7641

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.9105
Train Loss: 0.2495
ID Validation ROC-AUC: 0.8984
ID Validation Loss: 0.2622
ID Test ROC-AUC: 0.9001
ID Test Loss: 0.2660
OOD Validation ROC-AUC: 0.7015
OOD Validation Loss: 0.2936
OOD Test ROC-AUC: 0.7252
OOD Test Loss: 0.4753

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7146 0.9001 0.7252 0.8984 0.7015[0mTrain ROC-AUC: 0.9712Train Loss: 0.1682
Id_val ROC-AUC: 0.9235Id_val Loss: 0.3171
Val ROC-AUC: 0.6651Val Loss: 0.5310
Test ROC-AUC: 0.7146Test Loss: 0.7641
[1;34mDEBUG[0m: 04/04/2024 04:40:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ROC-AUC: 0.9712
Train Loss: 0.1682
ID Validation ROC-AUC: 0.9235
ID Validation Loss: 0.3171
ID Test ROC-AUC: 0.9267
ID Test Loss: 0.3191
OOD Validation ROC-AUC: 0.6651
OOD Validation Loss: 0.5310
OOD Test ROC-AUC: 0.7146
OOD Test Loss: 0.7641

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.9105
Train Loss: 0.2495
ID Validation ROC-AUC: 0.8984
ID Validation Loss: 0.2622
ID Test ROC-AUC: 0.9001
ID Test Loss: 0.2660
OOD Validation ROC-AUC: 0.7015
OOD Validation Loss: 0.2936
OOD Test ROC-AUC: 0.7252
OOD Test Loss: 0.4753

[0m[1;37mINFO[0m: [1mChartInfo 0.9267 0.7146 0.9001 0.7252 0.8984 0.7015[0mTrain ROC-AUC: 0.9105Train Loss: 0.2495
Id_val ROC-AUC: 0.8984Id_val Loss: 0.2622
Val ROC-AUC: 0.7015Val Loss: 0.2936
Test ROC-AUC: 0.7252Test Loss: 0.4753
Printing obtained and stored scores: 0.7251846762029015 !=? 0.7251846762029015


Final accuracies: 
TRAIN      = 0.967 +- 0.005
ID_VAL     = 0.924 +- 0.001
VAL        = 0.667 +- 0.008
TEST       = 0.711 +- 0.004
OOD_TRAIN  = 0.922 +- 0.017
OOD_ID_VAL = 0.904 +- 0.009
OOD_VAL    = 0.699 +- 0.002
OOD_TEST   = 0.726 +- 0.003

Final losses: 
TRAIN      = 0.1579 +- 0.0121
ID_VAL     = 0.2652 +- 0.0272
VAL        = 0.4499 +- 0.0547
TEST       = 0.6375 +- 0.0737
OOD_TRAIN  = 0.2385 +- 0.0227
OOD_ID_VAL = 0.2665 +- 0.0030
OOD_VAL    = 0.3175 +- 0.0275
OOD_TEST   = 0.5069 +- 0.0346
Diff id_val-test  = 0.3723 
Diff id_val-test ood_ = 0.2404 

DONE TRAIN LECI LBAPcore/assay mitigation_readout
DONE all :)
Time to train models!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:28:01 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:28:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.8463
Train Loss: 1.1020
ID Validation ACCURACY: 0.8423
ID Validation Loss: 1.1790
ID Test ACCURACY: 0.8420
ID Test Loss: 1.1213
OOD Validation ACCURACY: 0.7010
OOD Validation Loss: 2.2727
OOD Test ACCURACY: 0.4420
OOD Test Loss: 29.6514

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.7648
Train Loss: 1.9593
ID Validation ACCURACY: 0.7713
ID Validation Loss: 1.9715
ID Test ACCURACY: 0.7650
ID Test Loss: 1.9576
OOD Validation ACCURACY: 0.7660
OOD Validation Loss: 2.8067
OOD Test ACCURACY: 0.4487
OOD Test Loss: 47.1520

[0m[1;37mINFO[0m: [1mChartInfo 0.8420 0.4420 0.7650 0.4487 0.7713 0.7660[0m[1;31mERROR[0m: 04/04/2024 09:28:07 PM - utils.py - line 87 : [1mTraceback (most recent call last):
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/bin/goodtg", line 33, in <module>
    sys.exit(load_entry_point('graph-ood', 'console_scripts', 'goodtg')())
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 565, in goodtg
    raise e
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 559, in goodtg
    main()
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/main.py", line 535, in main
    sa = pipeline.evaluate(s, compute_suff=False)
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/utils/_contextlib.py", line 115, in decorate_context
    return func(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/kernel/pipelines/basic_pipeline.py", line 1306, in evaluate
    model_output = self.model(data=data, edge_weight=None, ood_algorithm=self.ood_algorithm)
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/networks/models/LECIGNN.py", line 110, in forward
    node_repr = self.sub_gnn.get_node_repr(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/networks/models/GINs.py", line 110, in get_node_repr
    node_repr = self.encoder.get_node_repr(x, edge_index, batch, batch_size, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/networks/models/GINs.py", line 207, in get_node_repr
    post_conv = batch_norm(conv(layer_feat[-1], edge_index, return_attn_distrib=kwargs.get('return_attn', False)))
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/networks/models/GINs.py", line 244, in forward
    out = self.mlp((1 + self.eps) * x + self.propagate(edge_index, x=x, return_attn_distrib=return_attn_distrib))
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/container.py", line 215, in forward
    input = module(input)
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1518, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1527, in _call_impl
    return forward_call(*args, **kwargs)
  File "/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch/nn/modules/linear.py", line 114, in forward
    return F.linear(input, self.weight, self.bias)
RuntimeError: CUDA error: CUBLAS_STATUS_NOT_INITIALIZED when calling `cublasCreate(handle)`
[0mTime to train models!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:29:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.8463
Train Loss: 1.1020
ID Validation ACCURACY: 0.8423
ID Validation Loss: 1.1790
ID Test ACCURACY: 0.8420
ID Test Loss: 1.1213
OOD Validation ACCURACY: 0.7010
OOD Validation Loss: 2.2727
OOD Test ACCURACY: 0.4420
OOD Test Loss: 29.6514

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.7648
Train Loss: 1.9593
ID Validation ACCURACY: 0.7713
ID Validation Loss: 1.9715
ID Test ACCURACY: 0.7650
ID Test Loss: 1.9576
OOD Validation ACCURACY: 0.7660
OOD Validation Loss: 2.8067
OOD Test ACCURACY: 0.4487
OOD Test Loss: 47.1520

[0m[1;37mINFO[0m: [1mChartInfo 0.8420 0.4420 0.7650 0.4487 0.7713 0.7660[0mTrain ACCURACY: 0.8463Train Loss: 1.1020
Id_val ACCURACY: 0.8423Id_val Loss: 1.1790
Val ACCURACY: 0.7010Val Loss: 2.2727
Test ACCURACY: 0.4420Test Loss: 29.6514
[1;34mDEBUG[0m: 04/04/2024 09:29:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ACCURACY: 0.8463
Train Loss: 1.1020
ID Validation ACCURACY: 0.8423
ID Validation Loss: 1.1790
ID Test ACCURACY: 0.8420
ID Test Loss: 1.1213
OOD Validation ACCURACY: 0.7010
OOD Validation Loss: 2.2727
OOD Test ACCURACY: 0.4420
OOD Test Loss: 29.6514

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.7648
Train Loss: 1.9593
ID Validation ACCURACY: 0.7713
ID Validation Loss: 1.9715
ID Test ACCURACY: 0.7650
ID Test Loss: 1.9576
OOD Validation ACCURACY: 0.7660
OOD Validation Loss: 2.8067
OOD Test ACCURACY: 0.4487
OOD Test Loss: 47.1520

[0m[1;37mINFO[0m: [1mChartInfo 0.8420 0.4420 0.7650 0.4487 0.7713 0.7660[0mTrain ACCURACY: 0.7648Train Loss: 1.9593
Id_val ACCURACY: 0.7713Id_val Loss: 1.9715
Val ACCURACY: 0.7660Val Loss: 2.8067
Test ACCURACY: 0.4487Test Loss: 47.1520
Printing obtained and stored scores: 0.44866666666666666 !=? 0.44866666666666666


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:29:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:29:42 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.8488
Train Loss: 0.6647
ID Validation ACCURACY: 0.8513
ID Validation Loss: 0.6612
ID Test ACCURACY: 0.8523
ID Test Loss: 0.6811
OOD Validation ACCURACY: 0.7573
OOD Validation Loss: 0.8117
OOD Test ACCURACY: 0.4603
OOD Test Loss: 36.3700

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 0.8077
Train Loss: 1.1102
ID Validation ACCURACY: 0.8107
ID Validation Loss: 1.1224
ID Test ACCURACY: 0.8117
ID Test Loss: 1.1218
OOD Validation ACCURACY: 0.7623
OOD Validation Loss: 1.9531
OOD Test ACCURACY: 0.4657
OOD Test Loss: 14.0254

[0m[1;37mINFO[0m: [1mChartInfo 0.8523 0.4603 0.8117 0.4657 0.8107 0.7623[0mTrain ACCURACY: 0.8488Train Loss: 0.6647
Id_val ACCURACY: 0.8513Id_val Loss: 0.6612
Val ACCURACY: 0.7573Val Loss: 0.8117
Test ACCURACY: 0.4603Test Loss: 36.3700
[1;34mDEBUG[0m: 04/04/2024 09:29:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 197...
[0m[1;37mINFO[0m: [1mCheckpoint 197: 
-----------------------------------
Train ACCURACY: 0.8488
Train Loss: 0.6647
ID Validation ACCURACY: 0.8513
ID Validation Loss: 0.6612
ID Test ACCURACY: 0.8523
ID Test Loss: 0.6811
OOD Validation ACCURACY: 0.7573
OOD Validation Loss: 0.8117
OOD Test ACCURACY: 0.4603
OOD Test Loss: 36.3700

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ACCURACY: 0.8077
Train Loss: 1.1102
ID Validation ACCURACY: 0.8107
ID Validation Loss: 1.1224
ID Test ACCURACY: 0.8117
ID Test Loss: 1.1218
OOD Validation ACCURACY: 0.7623
OOD Validation Loss: 1.9531
OOD Test ACCURACY: 0.4657
OOD Test Loss: 14.0254

[0m[1;37mINFO[0m: [1mChartInfo 0.8523 0.4603 0.8117 0.4657 0.8107 0.7623[0mTrain ACCURACY: 0.8077Train Loss: 1.1102
Id_val ACCURACY: 0.8107Id_val Loss: 1.1224
Val ACCURACY: 0.7623Val Loss: 1.9531
Test ACCURACY: 0.4657Test Loss: 14.0254
Printing obtained and stored scores: 0.4656666666666667 !=? 0.4656666666666667


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:30:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ACCURACY: 0.8451
Train Loss: 1.1313
ID Validation ACCURACY: 0.8440
ID Validation Loss: 1.2202
ID Test ACCURACY: 0.8493
ID Test Loss: 1.1324
OOD Validation ACCURACY: 0.6803
OOD Validation Loss: 2.2552
OOD Test ACCURACY: 0.3967
OOD Test Loss: 11.0341

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ACCURACY: 0.8407
Train Loss: 1.4113
ID Validation ACCURACY: 0.8367
ID Validation Loss: 1.5167
ID Test ACCURACY: 0.8423
ID Test Loss: 1.4177
OOD Validation ACCURACY: 0.7787
OOD Validation Loss: 2.6046
OOD Test ACCURACY: 0.5260
OOD Test Loss: 23.0879

[0m[1;37mINFO[0m: [1mChartInfo 0.8493 0.3967 0.8423 0.5260 0.8367 0.7787[0mTrain ACCURACY: 0.8451Train Loss: 1.1313
Id_val ACCURACY: 0.8440Id_val Loss: 1.2202
Val ACCURACY: 0.6803Val Loss: 2.2552
Test ACCURACY: 0.3967Test Loss: 11.0341
[1;34mDEBUG[0m: 04/04/2024 09:30:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ACCURACY: 0.8451
Train Loss: 1.1313
ID Validation ACCURACY: 0.8440
ID Validation Loss: 1.2202
ID Test ACCURACY: 0.8493
ID Test Loss: 1.1324
OOD Validation ACCURACY: 0.6803
OOD Validation Loss: 2.2552
OOD Test ACCURACY: 0.3967
OOD Test Loss: 11.0341

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 153...
[0m[1;37mINFO[0m: [1mCheckpoint 153: 
-----------------------------------
Train ACCURACY: 0.8407
Train Loss: 1.4113
ID Validation ACCURACY: 0.8367
ID Validation Loss: 1.5167
ID Test ACCURACY: 0.8423
ID Test Loss: 1.4177
OOD Validation ACCURACY: 0.7787
OOD Validation Loss: 2.6046
OOD Test ACCURACY: 0.5260
OOD Test Loss: 23.0879

[0m[1;37mINFO[0m: [1mChartInfo 0.8493 0.3967 0.8423 0.5260 0.8367 0.7787[0mTrain ACCURACY: 0.8407Train Loss: 1.4113
Id_val ACCURACY: 0.8367Id_val Loss: 1.5167
Val ACCURACY: 0.7787Val Loss: 2.6046
Test ACCURACY: 0.5260Test Loss: 23.0879
Printing obtained and stored scores: 0.526 !=? 0.526


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:30:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 1.0422
ID Validation ACCURACY: 0.8540
ID Validation Loss: 1.1024
ID Test ACCURACY: 0.8597
ID Test Loss: 1.0383
OOD Validation ACCURACY: 0.7680
OOD Validation Loss: 1.7833
OOD Test ACCURACY: 0.5127
OOD Test Loss: 9.6497

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.8496
Train Loss: 1.4479
ID Validation ACCURACY: 0.8463
ID Validation Loss: 1.5386
ID Test ACCURACY: 0.8530
ID Test Loss: 1.4616
OOD Validation ACCURACY: 0.7897
OOD Validation Loss: 2.2782
OOD Test ACCURACY: 0.7403
OOD Test Loss: 2.6999

[0m[1;37mINFO[0m: [1mChartInfo 0.8597 0.5127 0.8530 0.7403 0.8463 0.7897[0mTrain ACCURACY: 0.8559Train Loss: 1.0422
Id_val ACCURACY: 0.8540Id_val Loss: 1.1024
Val ACCURACY: 0.7680Val Loss: 1.7833
Test ACCURACY: 0.5127Test Loss: 9.6497
[1;34mDEBUG[0m: 04/04/2024 09:30:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 1.0422
ID Validation ACCURACY: 0.8540
ID Validation Loss: 1.1024
ID Test ACCURACY: 0.8597
ID Test Loss: 1.0383
OOD Validation ACCURACY: 0.7680
OOD Validation Loss: 1.7833
OOD Test ACCURACY: 0.5127
OOD Test Loss: 9.6497

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.8496
Train Loss: 1.4479
ID Validation ACCURACY: 0.8463
ID Validation Loss: 1.5386
ID Test ACCURACY: 0.8530
ID Test Loss: 1.4616
OOD Validation ACCURACY: 0.7897
OOD Validation Loss: 2.2782
OOD Test ACCURACY: 0.7403
OOD Test Loss: 2.6999

[0m[1;37mINFO[0m: [1mChartInfo 0.8597 0.5127 0.8530 0.7403 0.8463 0.7897[0mTrain ACCURACY: 0.8496Train Loss: 1.4479
Id_val ACCURACY: 0.8463Id_val Loss: 1.5386
Val ACCURACY: 0.7897Val Loss: 2.2782
Test ACCURACY: 0.7403Test Loss: 2.6999
Printing obtained and stored scores: 0.7403333333333333 !=? 0.7403333333333333


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODMotif/size/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:30:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:30:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.8622
Train Loss: 0.5930
ID Validation ACCURACY: 0.8623
ID Validation Loss: 0.6078
ID Test ACCURACY: 0.8680
ID Test Loss: 0.5747
OOD Validation ACCURACY: 0.6987
OOD Validation Loss: 1.4644
OOD Test ACCURACY: 0.4423
OOD Test Loss: 5.0745

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.8443
Train Loss: 1.6280
ID Validation ACCURACY: 0.8413
ID Validation Loss: 1.7419
ID Test ACCURACY: 0.8470
ID Test Loss: 1.6402
OOD Validation ACCURACY: 0.7760
OOD Validation Loss: 2.8512
OOD Test ACCURACY: 0.4507
OOD Test Loss: 15.0767

[0m[1;37mINFO[0m: [1mChartInfo 0.8680 0.4423 0.8470 0.4507 0.8413 0.7760[0mTrain ACCURACY: 0.8622Train Loss: 0.5930
Id_val ACCURACY: 0.8623Id_val Loss: 0.6078
Val ACCURACY: 0.6987Val Loss: 1.4644
Test ACCURACY: 0.4423Test Loss: 5.0745
[1;34mDEBUG[0m: 04/04/2024 09:31:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.8622
Train Loss: 0.5930
ID Validation ACCURACY: 0.8623
ID Validation Loss: 0.6078
ID Test ACCURACY: 0.8680
ID Test Loss: 0.5747
OOD Validation ACCURACY: 0.6987
OOD Validation Loss: 1.4644
OOD Test ACCURACY: 0.4423
OOD Test Loss: 5.0745

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.8443
Train Loss: 1.6280
ID Validation ACCURACY: 0.8413
ID Validation Loss: 1.7419
ID Test ACCURACY: 0.8470
ID Test Loss: 1.6402
OOD Validation ACCURACY: 0.7760
OOD Validation Loss: 2.8512
OOD Test ACCURACY: 0.4507
OOD Test Loss: 15.0767

[0m[1;37mINFO[0m: [1mChartInfo 0.8680 0.4423 0.8470 0.4507 0.8413 0.7760[0mTrain ACCURACY: 0.8443Train Loss: 1.6280
Id_val ACCURACY: 0.8413Id_val Loss: 1.7419
Val ACCURACY: 0.7760Val Loss: 2.8512
Test ACCURACY: 0.4507Test Loss: 15.0767
Printing obtained and stored scores: 0.45066666666666666 !=? 0.45066666666666666


Final accuracies: 
TRAIN      = 0.852 +- 0.006
ID_VAL     = 0.851 +- 0.007
VAL        = 0.721 +- 0.035
TEST       = 0.451 +- 0.037
OOD_TRAIN  = 0.821 +- 0.032
OOD_ID_VAL = 0.821 +- 0.028
OOD_VAL    = 0.775 +- 0.010
OOD_TEST   = 0.526 +- 0.111

Final losses: 
TRAIN      = 0.9066 +- 0.2298
ID_VAL     = 0.9541 +- 0.2642
VAL        = 1.7175 +- 0.5452
TEST       = 18.3560 +- 12.3118
OOD_TRAIN  = 1.5113 +- 0.2790
OOD_ID_VAL = 1.5782 +- 0.2809
OOD_VAL    = 2.4988 +- 0.3396
OOD_TEST   = 20.4084 +- 14.8671
Diff id_val-test  = 17.4018 
Diff id_val-test ood_ = 18.8302 

DONE TRAIN LECI GOODMotif/size mitigation_readout NOV

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:31:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:31:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0753
ID Validation ACCURACY: 0.8740
ID Validation Loss: 0.4453
ID Test ACCURACY: 0.8755
ID Test Loss: 0.4776
OOD Validation ACCURACY: 0.8658
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.8021
OOD Test Loss: 1.0198

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0773
ID Validation ACCURACY: 0.8712
ID Validation Loss: 0.4130
ID Test ACCURACY: 0.8710
ID Test Loss: 0.4510
OOD Validation ACCURACY: 0.8764
OOD Validation Loss: 0.4649
OOD Test ACCURACY: 0.8236
OOD Test Loss: 0.6150

[0m[1;37mINFO[0m: [1mChartInfo 0.8755 0.8021 0.8710 0.8236 0.8712 0.8764[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9489Train Loss: 0.0753
Id_val ACCURACY: 0.8740Id_val Loss: 0.4453
Val ACCURACY: 0.8658Val Loss: 0.6208
Test ACCURACY: 0.8021Test Loss: 1.0198
[1;34mDEBUG[0m: 04/04/2024 09:32:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 198...
[0m[1;37mINFO[0m: [1mCheckpoint 198: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0753
ID Validation ACCURACY: 0.8740
ID Validation Loss: 0.4453
ID Test ACCURACY: 0.8755
ID Test Loss: 0.4776
OOD Validation ACCURACY: 0.8658
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.8021
OOD Test Loss: 1.0198

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9487
Train Loss: 0.0773
ID Validation ACCURACY: 0.8712
ID Validation Loss: 0.4130
ID Test ACCURACY: 0.8710
ID Test Loss: 0.4510
OOD Validation ACCURACY: 0.8764
OOD Validation Loss: 0.4649
OOD Test ACCURACY: 0.8236
OOD Test Loss: 0.6150

[0m[1;37mINFO[0m: [1mChartInfo 0.8755 0.8021 0.8710 0.8236 0.8712 0.8764[0mTrain ACCURACY: 0.9487Train Loss: 0.0773
Id_val ACCURACY: 0.8712Id_val Loss: 0.4130
Val ACCURACY: 0.8764Val Loss: 0.4649
Test ACCURACY: 0.8236Test Loss: 0.6150
Printing obtained and stored scores: 0.8236134934248142 !=? 0.8236134934248142


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:32:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:32:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ACCURACY: 0.9486
Train Loss: 0.0790
ID Validation ACCURACY: 0.8738
ID Validation Loss: 0.3830
ID Test ACCURACY: 0.8717
ID Test Loss: 0.4081
OOD Validation ACCURACY: 0.8658
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.7973
OOD Test Loss: 0.6481

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 170...
[0m[1;37mINFO[0m: [1mCheckpoint 170: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0757
ID Validation ACCURACY: 0.8721
ID Validation Loss: 0.4192
ID Test ACCURACY: 0.8742
ID Test Loss: 0.4672
OOD Validation ACCURACY: 0.8775
OOD Validation Loss: 0.5183
OOD Test ACCURACY: 0.8232
OOD Test Loss: 0.6658

[0m[1;37mINFO[0m: [1mChartInfo 0.8717 0.7973 0.8742 0.8232 0.8721 0.8775[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9486Train Loss: 0.0790
Id_val ACCURACY: 0.8738Id_val Loss: 0.3830
Val ACCURACY: 0.8658Val Loss: 0.4487
Test ACCURACY: 0.7973Test Loss: 0.6481
[1;34mDEBUG[0m: 04/04/2024 09:32:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 134...
[0m[1;37mINFO[0m: [1mCheckpoint 134: 
-----------------------------------
Train ACCURACY: 0.9486
Train Loss: 0.0790
ID Validation ACCURACY: 0.8738
ID Validation Loss: 0.3830
ID Test ACCURACY: 0.8717
ID Test Loss: 0.4081
OOD Validation ACCURACY: 0.8658
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.7973
OOD Test Loss: 0.6481

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 170...
[0m[1;37mINFO[0m: [1mCheckpoint 170: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0757
ID Validation ACCURACY: 0.8721
ID Validation Loss: 0.4192
ID Test ACCURACY: 0.8742
ID Test Loss: 0.4672
OOD Validation ACCURACY: 0.8775
OOD Validation Loss: 0.5183
OOD Test ACCURACY: 0.8232
OOD Test Loss: 0.6658

[0m[1;37mINFO[0m: [1mChartInfo 0.8717 0.7973 0.8742 0.8232 0.8721 0.8775[0mTrain ACCURACY: 0.9489Train Loss: 0.0757
Id_val ACCURACY: 0.8721Id_val Loss: 0.4192
Val ACCURACY: 0.8775Val Loss: 0.5183
Test ACCURACY: 0.8232Test Loss: 0.6658
Printing obtained and stored scores: 0.8232132647226987 !=? 0.8232132647226987


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:33:14 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:33:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0756
ID Validation ACCURACY: 0.8740
ID Validation Loss: 0.4382
ID Test ACCURACY: 0.8738
ID Test Loss: 0.4677
OOD Validation ACCURACY: 0.8718
OOD Validation Loss: 0.4872
OOD Test ACCURACY: 0.8149
OOD Test Loss: 0.6598

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0757
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4442
ID Test ACCURACY: 0.8719
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.8765
OOD Validation Loss: 0.4672
OOD Test ACCURACY: 0.8158
OOD Test Loss: 0.6738

[0m[1;37mINFO[0m: [1mChartInfo 0.8738 0.8149 0.8719 0.8158 0.8710 0.8765[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9489Train Loss: 0.0756
Id_val ACCURACY: 0.8740Id_val Loss: 0.4382
Val ACCURACY: 0.8718Val Loss: 0.4872
Test ACCURACY: 0.8149Test Loss: 0.6598
[1;34mDEBUG[0m: 04/04/2024 09:33:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 190...
[0m[1;37mINFO[0m: [1mCheckpoint 190: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0756
ID Validation ACCURACY: 0.8740
ID Validation Loss: 0.4382
ID Test ACCURACY: 0.8738
ID Test Loss: 0.4677
OOD Validation ACCURACY: 0.8718
OOD Validation Loss: 0.4872
OOD Test ACCURACY: 0.8149
OOD Test Loss: 0.6598

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 166...
[0m[1;37mINFO[0m: [1mCheckpoint 166: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0757
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4442
ID Test ACCURACY: 0.8719
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.8765
OOD Validation Loss: 0.4672
OOD Test ACCURACY: 0.8158
OOD Test Loss: 0.6738

[0m[1;37mINFO[0m: [1mChartInfo 0.8738 0.8149 0.8719 0.8158 0.8710 0.8765[0mTrain ACCURACY: 0.9489Train Loss: 0.0757
Id_val ACCURACY: 0.8710Id_val Loss: 0.4442
Val ACCURACY: 0.8765Val Loss: 0.4672
Test ACCURACY: 0.8158Test Loss: 0.6738
Printing obtained and stored scores: 0.8157804459691252 !=? 0.8157804459691252


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:34:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0756
ID Validation ACCURACY: 0.8762
ID Validation Loss: 0.4472
ID Test ACCURACY: 0.8732
ID Test Loss: 0.4938
OOD Validation ACCURACY: 0.8712
OOD Validation Loss: 0.5940
OOD Test ACCURACY: 0.8058
OOD Test Loss: 0.9128

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0806
ID Validation ACCURACY: 0.8681
ID Validation Loss: 0.3631
ID Test ACCURACY: 0.8700
ID Test Loss: 0.4004
OOD Validation ACCURACY: 0.8754
OOD Validation Loss: 0.4044
OOD Test ACCURACY: 0.8270
OOD Test Loss: 0.4741

[0m[1;37mINFO[0m: [1mChartInfo 0.8732 0.8058 0.8700 0.8270 0.8681 0.8754[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9489Train Loss: 0.0756
Id_val ACCURACY: 0.8762Id_val Loss: 0.4472
Val ACCURACY: 0.8712Val Loss: 0.5940
Test ACCURACY: 0.8058Test Loss: 0.9128
[1;34mDEBUG[0m: 04/04/2024 09:34:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 178...
[0m[1;37mINFO[0m: [1mCheckpoint 178: 
-----------------------------------
Train ACCURACY: 0.9489
Train Loss: 0.0756
ID Validation ACCURACY: 0.8762
ID Validation Loss: 0.4472
ID Test ACCURACY: 0.8732
ID Test Loss: 0.4938
OOD Validation ACCURACY: 0.8712
OOD Validation Loss: 0.5940
OOD Test ACCURACY: 0.8058
OOD Test Loss: 0.9128

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ACCURACY: 0.9484
Train Loss: 0.0806
ID Validation ACCURACY: 0.8681
ID Validation Loss: 0.3631
ID Test ACCURACY: 0.8700
ID Test Loss: 0.4004
OOD Validation ACCURACY: 0.8754
OOD Validation Loss: 0.4044
OOD Test ACCURACY: 0.8270
OOD Test Loss: 0.4741

[0m[1;37mINFO[0m: [1mChartInfo 0.8732 0.8058 0.8700 0.8270 0.8681 0.8754[0mTrain ACCURACY: 0.9484Train Loss: 0.0806
Id_val ACCURACY: 0.8681Id_val Loss: 0.3631
Val ACCURACY: 0.8754Val Loss: 0.4044
Test ACCURACY: 0.8270Test Loss: 0.4741
Printing obtained and stored scores: 0.8270440251572327 !=? 0.8270440251572327


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODSST2/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:34:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODSST2
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mDataset: {'train': GOODSST2(24744), 'id_val': GOODSST2(5301), 'id_test': GOODSST2(5301), 'val': GOODSST2(17206), 'test': GOODSST2(17490), 'task': 'Binary classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1m Data(x=[6, 768], edge_index=[2, 10], y=[1, 1], idx=[1], sentence_tokens=[6], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[3, 768], edge_index=[2, 4], y=[1, 1], idx=[1], sentence_tokens=[3], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.01
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:34:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0753
ID Validation ACCURACY: 0.8779
ID Validation Loss: 0.4397
ID Test ACCURACY: 0.8742
ID Test Loss: 0.4983
OOD Validation ACCURACY: 0.8653
OOD Validation Loss: 0.6308
OOD Test ACCURACY: 0.7735
OOD Test Loss: 1.1209

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9478
Train Loss: 0.0810
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.3551
ID Test ACCURACY: 0.8725
ID Test Loss: 0.3847
OOD Validation ACCURACY: 0.8742
OOD Validation Loss: 0.4291
OOD Test ACCURACY: 0.8115
OOD Test Loss: 0.6072

[0m[1;37mINFO[0m: [1mChartInfo 0.8742 0.7735 0.8725 0.8115 0.8710 0.8742[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9488Train Loss: 0.0753
Id_val ACCURACY: 0.8779Id_val Loss: 0.4397
Val ACCURACY: 0.8653Val Loss: 0.6308
Test ACCURACY: 0.7735Test Loss: 1.1209
[1;34mDEBUG[0m: 04/04/2024 09:35:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 196...
[0m[1;37mINFO[0m: [1mCheckpoint 196: 
-----------------------------------
Train ACCURACY: 0.9488
Train Loss: 0.0753
ID Validation ACCURACY: 0.8779
ID Validation Loss: 0.4397
ID Test ACCURACY: 0.8742
ID Test Loss: 0.4983
OOD Validation ACCURACY: 0.8653
OOD Validation Loss: 0.6308
OOD Test ACCURACY: 0.7735
OOD Test Loss: 1.1209

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9478
Train Loss: 0.0810
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.3551
ID Test ACCURACY: 0.8725
ID Test Loss: 0.3847
OOD Validation ACCURACY: 0.8742
OOD Validation Loss: 0.4291
OOD Test ACCURACY: 0.8115
OOD Test Loss: 0.6072

[0m[1;37mINFO[0m: [1mChartInfo 0.8742 0.7735 0.8725 0.8115 0.8710 0.8742[0mTrain ACCURACY: 0.9478Train Loss: 0.0810
Id_val ACCURACY: 0.8710Id_val Loss: 0.3551
Val ACCURACY: 0.8742Val Loss: 0.4291
Test ACCURACY: 0.8115Test Loss: 0.6072
Printing obtained and stored scores: 0.8115494568324757 !=? 0.8115494568324757


Final accuracies: 
TRAIN      = 0.949 +- 0.000
ID_VAL     = 0.875 +- 0.002
VAL        = 0.868 +- 0.003
TEST       = 0.799 +- 0.014
OOD_TRAIN  = 0.949 +- 0.000
OOD_ID_VAL = 0.871 +- 0.001
OOD_VAL    = 0.876 +- 0.001
OOD_TEST   = 0.820 +- 0.006

Final losses: 
TRAIN      = 0.0762 +- 0.0015
ID_VAL     = 0.4307 +- 0.0241
VAL        = 0.5563 +- 0.0741
TEST       = 0.8723 +- 0.1900
OOD_TRAIN  = 0.0781 +- 0.0023
OOD_ID_VAL = 0.3989 +- 0.0342
OOD_VAL    = 0.4568 +- 0.0387
OOD_TEST   = 0.6072 +- 0.0716
Diff id_val-test  = 0.4416 
Diff id_val-test ood_ = 0.2083 

DONE TRAIN LECI GOODSST2/length mitigation_readout NOV

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:35:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.6841
ID Validation Loss: 2.3526
ID Test ACCURACY: 0.6661
ID Test Loss: 2.4244
OOD Validation ACCURACY: 0.5787
OOD Validation Loss: 3.0465
OOD Test ACCURACY: 0.5127
OOD Test Loss: 3.8394

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0007
ID Validation ACCURACY: 0.6787
ID Validation Loss: 2.0720
ID Test ACCURACY: 0.6679
ID Test Loss: 2.1436
OOD Validation ACCURACY: 0.5933
OOD Validation Loss: 2.5935
OOD Test ACCURACY: 0.5360
OOD Test Loss: 3.3575

[0m[1;37mINFO[0m: [1mChartInfo 0.6661 0.5127 0.6679 0.5360 0.6787 0.5933[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0003
Id_val ACCURACY: 0.6841Id_val Loss: 2.3526
Val ACCURACY: 0.5787Val Loss: 3.0465
Test ACCURACY: 0.5127Test Loss: 3.8394
[1;34mDEBUG[0m: 04/04/2024 09:36:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0003
ID Validation ACCURACY: 0.6841
ID Validation Loss: 2.3526
ID Test ACCURACY: 0.6661
ID Test Loss: 2.4244
OOD Validation ACCURACY: 0.5787
OOD Validation Loss: 3.0465
OOD Test ACCURACY: 0.5127
OOD Test Loss: 3.8394

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0007
ID Validation ACCURACY: 0.6787
ID Validation Loss: 2.0720
ID Test ACCURACY: 0.6679
ID Test Loss: 2.1436
OOD Validation ACCURACY: 0.5933
OOD Validation Loss: 2.5935
OOD Test ACCURACY: 0.5360
OOD Test Loss: 3.3575

[0m[1;37mINFO[0m: [1mChartInfo 0.6661 0.5127 0.6679 0.5360 0.6787 0.5933[0mTrain ACCURACY: 0.9996Train Loss: 0.0007
Id_val ACCURACY: 0.6787Id_val Loss: 2.0720
Val ACCURACY: 0.5933Val Loss: 2.5935
Test ACCURACY: 0.5360Test Loss: 3.3575
Printing obtained and stored scores: 0.5360329444063143 !=? 0.5360329444063143


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:36:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0011
ID Validation ACCURACY: 0.6877
ID Validation Loss: 2.4241
ID Test ACCURACY: 0.6625
ID Test Loss: 2.5814
OOD Validation ACCURACY: 0.5961
OOD Validation Loss: 2.7151
OOD Test ACCURACY: 0.5504
OOD Test Loss: 3.0246

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0011
ID Validation ACCURACY: 0.6877
ID Validation Loss: 2.4241
ID Test ACCURACY: 0.6625
ID Test Loss: 2.5814
OOD Validation ACCURACY: 0.5961
OOD Validation Loss: 2.7151
OOD Test ACCURACY: 0.5504
OOD Test Loss: 3.0246

[0m[1;37mINFO[0m: [1mChartInfo 0.6625 0.5504 0.6625 0.5504 0.6877 0.5961[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9996Train Loss: 0.0011
Id_val ACCURACY: 0.6877Id_val Loss: 2.4241
Val ACCURACY: 0.5961Val Loss: 2.7151
Test ACCURACY: 0.5504Test Loss: 3.0246
[1;34mDEBUG[0m: 04/04/2024 09:36:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0011
ID Validation ACCURACY: 0.6877
ID Validation Loss: 2.4241
ID Test ACCURACY: 0.6625
ID Test Loss: 2.5814
OOD Validation ACCURACY: 0.5961
OOD Validation Loss: 2.7151
OOD Test ACCURACY: 0.5504
OOD Test Loss: 3.0246

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9996
Train Loss: 0.0011
ID Validation ACCURACY: 0.6877
ID Validation Loss: 2.4241
ID Test ACCURACY: 0.6625
ID Test Loss: 2.5814
OOD Validation ACCURACY: 0.5961
OOD Validation Loss: 2.7151
OOD Test ACCURACY: 0.5504
OOD Test Loss: 3.0246

[0m[1;37mINFO[0m: [1mChartInfo 0.6625 0.5504 0.6625 0.5504 0.6877 0.5961[0mTrain ACCURACY: 0.9996Train Loss: 0.0011
Id_val ACCURACY: 0.6877Id_val Loss: 2.4241
Val ACCURACY: 0.5961Val Loss: 2.7151
Test ACCURACY: 0.5504Test Loss: 3.0246
Printing obtained and stored scores: 0.55044612216884 !=? 0.55044612216884


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:36:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.8351
Train Loss: 0.4211
ID Validation ACCURACY: 0.6913
ID Validation Loss: 0.8989
ID Test ACCURACY: 0.6588
ID Test Loss: 0.9232
OOD Validation ACCURACY: 0.5854
OOD Validation Loss: 1.1634
OOD Test ACCURACY: 0.5333
OOD Test Loss: 1.4787

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 31...
[0m[1;37mINFO[0m: [1mCheckpoint 31: 
-----------------------------------
Train ACCURACY: 0.9714
Train Loss: 0.0952
ID Validation ACCURACY: 0.6787
ID Validation Loss: 1.2560
ID Test ACCURACY: 0.6661
ID Test Loss: 1.3452
OOD Validation ACCURACY: 0.6230
OOD Validation Loss: 1.3988
OOD Test ACCURACY: 0.5772
OOD Test Loss: 1.6979

[0m[1;37mINFO[0m: [1mChartInfo 0.6588 0.5333 0.6661 0.5772 0.6787 0.6230[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.8351Train Loss: 0.4211
Id_val ACCURACY: 0.6913Id_val Loss: 0.8989
Val ACCURACY: 0.5854Val Loss: 1.1634
Test ACCURACY: 0.5333Test Loss: 1.4787
[1;34mDEBUG[0m: 04/04/2024 09:36:25 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 13...
[0m[1;37mINFO[0m: [1mCheckpoint 13: 
-----------------------------------
Train ACCURACY: 0.8351
Train Loss: 0.4211
ID Validation ACCURACY: 0.6913
ID Validation Loss: 0.8989
ID Test ACCURACY: 0.6588
ID Test Loss: 0.9232
OOD Validation ACCURACY: 0.5854
OOD Validation Loss: 1.1634
OOD Test ACCURACY: 0.5333
OOD Test Loss: 1.4787

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 31...
[0m[1;37mINFO[0m: [1mCheckpoint 31: 
-----------------------------------
Train ACCURACY: 0.9714
Train Loss: 0.0952
ID Validation ACCURACY: 0.6787
ID Validation Loss: 1.2560
ID Test ACCURACY: 0.6661
ID Test Loss: 1.3452
OOD Validation ACCURACY: 0.6230
OOD Validation Loss: 1.3988
OOD Test ACCURACY: 0.5772
OOD Test Loss: 1.6979

[0m[1;37mINFO[0m: [1mChartInfo 0.6588 0.5333 0.6661 0.5772 0.6787 0.6230[0mTrain ACCURACY: 0.9714Train Loss: 0.0952
Id_val ACCURACY: 0.6787Id_val Loss: 1.2560
Val ACCURACY: 0.6230Val Loss: 1.3988
Test ACCURACY: 0.5772Test Loss: 1.6979
Printing obtained and stored scores: 0.577213452299245 !=? 0.577213452299245


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:36:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.6913
ID Validation Loss: 2.6159
ID Test ACCURACY: 0.6552
ID Test Loss: 2.8401
OOD Validation ACCURACY: 0.5339
OOD Validation Loss: 3.6593
OOD Test ACCURACY: 0.4859
OOD Test Loss: 4.7035

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 101...
[0m[1;37mINFO[0m: [1mCheckpoint 101: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6841
ID Validation Loss: 2.1613
ID Test ACCURACY: 0.6661
ID Test Loss: 2.5227
OOD Validation ACCURACY: 0.6067
OOD Validation Loss: 2.7200
OOD Test ACCURACY: 0.5347
OOD Test Loss: 3.3238

[0m[1;37mINFO[0m: [1mChartInfo 0.6552 0.4859 0.6661 0.5347 0.6841 0.6067[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 1.0000Train Loss: 0.0002
Id_val ACCURACY: 0.6913Id_val Loss: 2.6159
Val ACCURACY: 0.5339Val Loss: 3.6593
Test ACCURACY: 0.4859Test Loss: 4.7035
[1;34mDEBUG[0m: 04/04/2024 09:36:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 188...
[0m[1;37mINFO[0m: [1mCheckpoint 188: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 0.6913
ID Validation Loss: 2.6159
ID Test ACCURACY: 0.6552
ID Test Loss: 2.8401
OOD Validation ACCURACY: 0.5339
OOD Validation Loss: 3.6593
OOD Test ACCURACY: 0.4859
OOD Test Loss: 4.7035

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 101...
[0m[1;37mINFO[0m: [1mCheckpoint 101: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0004
ID Validation ACCURACY: 0.6841
ID Validation Loss: 2.1613
ID Test ACCURACY: 0.6661
ID Test Loss: 2.5227
OOD Validation ACCURACY: 0.6067
OOD Validation Loss: 2.7200
OOD Test ACCURACY: 0.5347
OOD Test Loss: 3.3238

[0m[1;37mINFO[0m: [1mChartInfo 0.6552 0.4859 0.6661 0.5347 0.6841 0.6067[0mTrain ACCURACY: 1.0000Train Loss: 0.0004
Id_val ACCURACY: 0.6841Id_val Loss: 2.1613
Val ACCURACY: 0.6067Val Loss: 2.7200
Test ACCURACY: 0.5347Test Loss: 3.3238
Printing obtained and stored scores: 0.5346602608098833 !=? 0.5346602608098833


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODTwitter/length/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:36:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODTwitter
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mDataset: {'train': GOODTwitter(2590), 'id_val': GOODTwitter(554), 'id_test': GOODTwitter(554), 'val': GOODTwitter(1785), 'test': GOODTwitter(1457), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1m Data(x=[7, 768], edge_index=[2, 12], y=[1], idx=[1], sentence_tokens=[7], length=[1], domain_id=[1], env_id=[1])
[0mData(x=[10, 768], edge_index=[2, 18], y=[1], idx=[1], sentence_tokens=[10], length=[1], domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0.001
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 04/04/2024 09:36:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.9992
Train Loss: 0.0030
ID Validation ACCURACY: 0.6733
ID Validation Loss: 2.0931
ID Test ACCURACY: 0.6390
ID Test Loss: 2.2076
OOD Validation ACCURACY: 0.5602
OOD Validation Loss: 2.5590
OOD Test ACCURACY: 0.5271
OOD Test Loss: 3.0609

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 0.6534
ID Validation Loss: 2.4001
ID Test ACCURACY: 0.6643
ID Test Loss: 2.6073
OOD Validation ACCURACY: 0.5905
OOD Validation Loss: 2.6837
OOD Test ACCURACY: 0.5484
OOD Test Loss: 3.1298

[0m[1;37mINFO[0m: [1mChartInfo 0.6390 0.5271 0.6643 0.5484 0.6534 0.5905[0m/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. The data of the dataset is already cached, so any modifications to `data` will not be reflected when accessing its elements. Clearing the cache now by removing all elements in `dataset._data_list`. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
/mnt/cimec-storage6/users/steve.azzolin/venv/leci/lib/python3.8/site-packages/torch_geometric/data/in_memory_dataset.py:284: UserWarning: It is not recommended to directly access the internal storage format `data` of an 'InMemoryDataset'. If you are absolutely certain what you are doing, access the internal storage via `InMemoryDataset._data` instead to suppress this warning. Alternatively, you can access stacked individual attributes of every graph via `dataset.{attr_name}`.
  warnings.warn(msg)
Train ACCURACY: 0.9992Train Loss: 0.0030
Id_val ACCURACY: 0.6733Id_val Loss: 2.0931
Val ACCURACY: 0.5602Val Loss: 2.5590
Test ACCURACY: 0.5271Test Loss: 3.0609
[1;34mDEBUG[0m: 04/04/2024 09:36:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.9992
Train Loss: 0.0030
ID Validation ACCURACY: 0.6733
ID Validation Loss: 2.0931
ID Test ACCURACY: 0.6390
ID Test Loss: 2.2076
OOD Validation ACCURACY: 0.5602
OOD Validation Loss: 2.5590
OOD Test ACCURACY: 0.5271
OOD Test Loss: 3.0609

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 0.6534
ID Validation Loss: 2.4001
ID Test ACCURACY: 0.6643
ID Test Loss: 2.6073
OOD Validation ACCURACY: 0.5905
OOD Validation Loss: 2.6837
OOD Test ACCURACY: 0.5484
OOD Test Loss: 3.1298

[0m[1;37mINFO[0m: [1mChartInfo 0.6390 0.5271 0.6643 0.5484 0.6534 0.5905[0mTrain ACCURACY: 1.0000Train Loss: 0.0008
Id_val ACCURACY: 0.6534Id_val Loss: 2.4001
Val ACCURACY: 0.5905Val Loss: 2.6837
Test ACCURACY: 0.5484Test Loss: 3.1298
Printing obtained and stored scores: 0.5483870967741935 !=? 0.5483870967741935


Final accuracies: 
TRAIN      = 0.967 +- 0.066
ID_VAL     = 0.686 +- 0.007
VAL        = 0.571 +- 0.022
TEST       = 0.522 +- 0.022
OOD_TRAIN  = 0.994 +- 0.011
OOD_ID_VAL = 0.677 +- 0.012
OOD_VAL    = 0.602 +- 0.012
OOD_TEST   = 0.549 +- 0.015

Final losses: 
TRAIN      = 0.0851 +- 0.1680
ID_VAL     = 2.0769 +- 0.6124
VAL        = 2.6286 +- 0.8242
TEST       = 3.2214 +- 1.0658
OOD_TRAIN  = 0.0196 +- 0.0378
OOD_ID_VAL = 2.0627 +- 0.4255
OOD_VAL    = 2.4222 +- 0.5137
OOD_TEST   = 2.9067 +- 0.6168
Diff id_val-test  = 1.1445 
Diff id_val-test ood_ = 0.8440 

DONE TRAIN LECI GOODTwitter/length mitigation_readout NOV

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:37:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ROC-AUC: 0.9416
Train Loss: 0.0822
ID Validation ROC-AUC: 0.8443
ID Validation Loss: 0.1221
ID Test ROC-AUC: 0.8149
ID Test Loss: 0.1109
OOD Validation ROC-AUC: 0.7561
OOD Validation Loss: 0.1325
OOD Test ROC-AUC: 0.6641
OOD Test Loss: 0.1030

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ROC-AUC: 0.9639
Train Loss: 0.0702
ID Validation ROC-AUC: 0.8340
ID Validation Loss: 0.1326
ID Test ROC-AUC: 0.8263
ID Test Loss: 0.1192
OOD Validation ROC-AUC: 0.7928
OOD Validation Loss: 0.1596
OOD Test ROC-AUC: 0.6910
OOD Test Loss: 0.1175

[0m[1;37mINFO[0m: [1mChartInfo 0.8149 0.6641 0.8263 0.6910 0.8340 0.7928[0mTrain ROC-AUC: 0.9416Train Loss: 0.0822
Id_val ROC-AUC: 0.8443Id_val Loss: 0.1221
Val ROC-AUC: 0.7561Val Loss: 0.1325
Test ROC-AUC: 0.6641Test Loss: 0.1030
[1;34mDEBUG[0m: 04/04/2024 09:37:29 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ROC-AUC: 0.9416
Train Loss: 0.0822
ID Validation ROC-AUC: 0.8443
ID Validation Loss: 0.1221
ID Test ROC-AUC: 0.8149
ID Test Loss: 0.1109
OOD Validation ROC-AUC: 0.7561
OOD Validation Loss: 0.1325
OOD Test ROC-AUC: 0.6641
OOD Test Loss: 0.1030

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 191...
[0m[1;37mINFO[0m: [1mCheckpoint 191: 
-----------------------------------
Train ROC-AUC: 0.9639
Train Loss: 0.0702
ID Validation ROC-AUC: 0.8340
ID Validation Loss: 0.1326
ID Test ROC-AUC: 0.8263
ID Test Loss: 0.1192
OOD Validation ROC-AUC: 0.7928
OOD Validation Loss: 0.1596
OOD Test ROC-AUC: 0.6910
OOD Test Loss: 0.1175

[0m[1;37mINFO[0m: [1mChartInfo 0.8149 0.6641 0.8263 0.6910 0.8340 0.7928[0mTrain ROC-AUC: 0.9639Train Loss: 0.0702
Id_val ROC-AUC: 0.8340Id_val Loss: 0.1326
Val ROC-AUC: 0.7928Val Loss: 0.1596
Test ROC-AUC: 0.6910Test Loss: 0.1175
Printing obtained and stored scores: 0.6910207948201491 !=? 0.6910207948201491


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:37:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:37:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ROC-AUC: 0.9192
Train Loss: 0.0912
ID Validation ROC-AUC: 0.8427
ID Validation Loss: 0.1234
ID Test ROC-AUC: 0.8136
ID Test Loss: 0.1140
OOD Validation ROC-AUC: 0.7595
OOD Validation Loss: 0.1319
OOD Test ROC-AUC: 0.6400
OOD Test Loss: 0.1036

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 104...
[0m[1;37mINFO[0m: [1mCheckpoint 104: 
-----------------------------------
Train ROC-AUC: 0.9173
Train Loss: 0.0921
ID Validation ROC-AUC: 0.8199
ID Validation Loss: 0.1332
ID Test ROC-AUC: 0.8013
ID Test Loss: 0.1193
OOD Validation ROC-AUC: 0.7875
OOD Validation Loss: 0.1431
OOD Test ROC-AUC: 0.7031
OOD Test Loss: 0.1191

[0m[1;37mINFO[0m: [1mChartInfo 0.8136 0.6400 0.8013 0.7031 0.8199 0.7875[0mTrain ROC-AUC: 0.9192Train Loss: 0.0912
Id_val ROC-AUC: 0.8427Id_val Loss: 0.1234
Val ROC-AUC: 0.7595Val Loss: 0.1319
Test ROC-AUC: 0.6400Test Loss: 0.1036
[1;34mDEBUG[0m: 04/04/2024 09:38:11 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 103...
[0m[1;37mINFO[0m: [1mCheckpoint 103: 
-----------------------------------
Train ROC-AUC: 0.9192
Train Loss: 0.0912
ID Validation ROC-AUC: 0.8427
ID Validation Loss: 0.1234
ID Test ROC-AUC: 0.8136
ID Test Loss: 0.1140
OOD Validation ROC-AUC: 0.7595
OOD Validation Loss: 0.1319
OOD Test ROC-AUC: 0.6400
OOD Test Loss: 0.1036

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 104...
[0m[1;37mINFO[0m: [1mCheckpoint 104: 
-----------------------------------
Train ROC-AUC: 0.9173
Train Loss: 0.0921
ID Validation ROC-AUC: 0.8199
ID Validation Loss: 0.1332
ID Test ROC-AUC: 0.8013
ID Test Loss: 0.1193
OOD Validation ROC-AUC: 0.7875
OOD Validation Loss: 0.1431
OOD Test ROC-AUC: 0.7031
OOD Test Loss: 0.1191

[0m[1;37mINFO[0m: [1mChartInfo 0.8136 0.6400 0.8013 0.7031 0.8199 0.7875[0mTrain ROC-AUC: 0.9173Train Loss: 0.0921
Id_val ROC-AUC: 0.8199Id_val Loss: 0.1332
Val ROC-AUC: 0.7875Val Loss: 0.1431
Test ROC-AUC: 0.7031Test Loss: 0.1191
Printing obtained and stored scores: 0.7030721641267125 !=? 0.7030721641267125


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:38:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:38:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ROC-AUC: 0.8985
Train Loss: 0.0998
ID Validation ROC-AUC: 0.8423
ID Validation Loss: 0.1224
ID Test ROC-AUC: 0.8331
ID Test Loss: 0.1102
OOD Validation ROC-AUC: 0.7496
OOD Validation Loss: 0.1475
OOD Test ROC-AUC: 0.6750
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9430
Train Loss: 0.0808
ID Validation ROC-AUC: 0.8277
ID Validation Loss: 0.1313
ID Test ROC-AUC: 0.8207
ID Test Loss: 0.1163
OOD Validation ROC-AUC: 0.7811
OOD Validation Loss: 0.1344
OOD Test ROC-AUC: 0.6713
OOD Test Loss: 0.1072

[0m[1;37mINFO[0m: [1mChartInfo 0.8331 0.6750 0.8207 0.6713 0.8277 0.7811[0mTrain ROC-AUC: 0.8985Train Loss: 0.0998
Id_val ROC-AUC: 0.8423Id_val Loss: 0.1224
Val ROC-AUC: 0.7496Val Loss: 0.1475
Test ROC-AUC: 0.6750Test Loss: 0.1081
[1;34mDEBUG[0m: 04/04/2024 09:38:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ROC-AUC: 0.8985
Train Loss: 0.0998
ID Validation ROC-AUC: 0.8423
ID Validation Loss: 0.1224
ID Test ROC-AUC: 0.8331
ID Test Loss: 0.1102
OOD Validation ROC-AUC: 0.7496
OOD Validation Loss: 0.1475
OOD Test ROC-AUC: 0.6750
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 145...
[0m[1;37mINFO[0m: [1mCheckpoint 145: 
-----------------------------------
Train ROC-AUC: 0.9430
Train Loss: 0.0808
ID Validation ROC-AUC: 0.8277
ID Validation Loss: 0.1313
ID Test ROC-AUC: 0.8207
ID Test Loss: 0.1163
OOD Validation ROC-AUC: 0.7811
OOD Validation Loss: 0.1344
OOD Test ROC-AUC: 0.6713
OOD Test Loss: 0.1072

[0m[1;37mINFO[0m: [1mChartInfo 0.8331 0.6750 0.8207 0.6713 0.8277 0.7811[0mTrain ROC-AUC: 0.9430Train Loss: 0.0808
Id_val ROC-AUC: 0.8277Id_val Loss: 0.1313
Val ROC-AUC: 0.7811Val Loss: 0.1344
Test ROC-AUC: 0.6713Test Loss: 0.1072
Printing obtained and stored scores: 0.6713480304242658 !=? 0.6713480304242659


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:39:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ROC-AUC: 0.9310
Train Loss: 0.0890
ID Validation ROC-AUC: 0.8393
ID Validation Loss: 0.1297
ID Test ROC-AUC: 0.8417
ID Test Loss: 0.1149
OOD Validation ROC-AUC: 0.7697
OOD Validation Loss: 0.1635
OOD Test ROC-AUC: 0.7057
OOD Test Loss: 0.1118

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ROC-AUC: 0.8842
Train Loss: 0.1020
ID Validation ROC-AUC: 0.8202
ID Validation Loss: 0.1281
ID Test ROC-AUC: 0.8290
ID Test Loss: 0.1078
OOD Validation ROC-AUC: 0.7797
OOD Validation Loss: 0.1342
OOD Test ROC-AUC: 0.6695
OOD Test Loss: 0.1019

[0m[1;37mINFO[0m: [1mChartInfo 0.8417 0.7057 0.8290 0.6695 0.8202 0.7797[0mTrain ROC-AUC: 0.9310Train Loss: 0.0890
Id_val ROC-AUC: 0.8393Id_val Loss: 0.1297
Val ROC-AUC: 0.7697Val Loss: 0.1635
Test ROC-AUC: 0.7057Test Loss: 0.1118
[1;34mDEBUG[0m: 04/04/2024 09:39:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 114...
[0m[1;37mINFO[0m: [1mCheckpoint 114: 
-----------------------------------
Train ROC-AUC: 0.9310
Train Loss: 0.0890
ID Validation ROC-AUC: 0.8393
ID Validation Loss: 0.1297
ID Test ROC-AUC: 0.8417
ID Test Loss: 0.1149
OOD Validation ROC-AUC: 0.7697
OOD Validation Loss: 0.1635
OOD Test ROC-AUC: 0.7057
OOD Test Loss: 0.1118

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 57...
[0m[1;37mINFO[0m: [1mCheckpoint 57: 
-----------------------------------
Train ROC-AUC: 0.8842
Train Loss: 0.1020
ID Validation ROC-AUC: 0.8202
ID Validation Loss: 0.1281
ID Test ROC-AUC: 0.8290
ID Test Loss: 0.1078
OOD Validation ROC-AUC: 0.7797
OOD Validation Loss: 0.1342
OOD Test ROC-AUC: 0.6695
OOD Test Loss: 0.1019

[0m[1;37mINFO[0m: [1mChartInfo 0.8417 0.7057 0.8290 0.6695 0.8202 0.7797[0mTrain ROC-AUC: 0.8842Train Loss: 0.1020
Id_val ROC-AUC: 0.8202Id_val Loss: 0.1281
Val ROC-AUC: 0.7797Val Loss: 0.1342
Test ROC-AUC: 0.6695Test Loss: 0.1019
Printing obtained and stored scores: 0.6695423177502475 !=? 0.6695423177502475


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/GOODHIV/scaffold/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:39:53 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODHIV
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mDataset: {'train': GOODHIV(24682), 'id_val': GOODHIV(4112), 'id_test': GOODHIV(4112), 'val': GOODHIV(4113), 'test': GOODHIV(4108), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1m Data(x=[21, 9], edge_index=[2, 46], edge_attr=[46, 3], y=[1, 1], smiles='CC1CCCN2C(=O)CN(Cc3ccccc3)CC(=O)N12', idx=[1], scaffold='O=C1CN(Cc2ccccc2)CC(=O)N2CCCCN12', domain_id=[1], env_id=[1])
[0mData(x=[14, 9], edge_index=[2, 30], edge_attr=[30, 3], y=[1, 1], smiles='O=C1CSc2cc([N+](=O)[O-])ccc2N1', idx=[1], scaffold='O=C1CSc2ccccc2N1', domain_id=[1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:53 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:39:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:54 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:54 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:39:54 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ROC-AUC: 0.9400
Train Loss: 0.0845
ID Validation ROC-AUC: 0.8290
ID Validation Loss: 0.1313
ID Test ROC-AUC: 0.8187
ID Test Loss: 0.1183
OOD Validation ROC-AUC: 0.7802
OOD Validation Loss: 0.1479
OOD Test ROC-AUC: 0.6673
OOD Test Loss: 0.1109

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ROC-AUC: 0.9386
Train Loss: 0.0816
ID Validation ROC-AUC: 0.8162
ID Validation Loss: 0.1295
ID Test ROC-AUC: 0.8191
ID Test Loss: 0.1110
OOD Validation ROC-AUC: 0.8014
OOD Validation Loss: 0.1369
OOD Test ROC-AUC: 0.7259
OOD Test Loss: 0.1010

[0m[1;37mINFO[0m: [1mChartInfo 0.8187 0.6673 0.8191 0.7259 0.8162 0.8014[0mTrain ROC-AUC: 0.9400Train Loss: 0.0845
Id_val ROC-AUC: 0.8290Id_val Loss: 0.1313
Val ROC-AUC: 0.7802Val Loss: 0.1479
Test ROC-AUC: 0.6673Test Loss: 0.1109
[1;34mDEBUG[0m: 04/04/2024 09:40:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 139...
[0m[1;37mINFO[0m: [1mCheckpoint 139: 
-----------------------------------
Train ROC-AUC: 0.9400
Train Loss: 0.0845
ID Validation ROC-AUC: 0.8290
ID Validation Loss: 0.1313
ID Test ROC-AUC: 0.8187
ID Test Loss: 0.1183
OOD Validation ROC-AUC: 0.7802
OOD Validation Loss: 0.1479
OOD Test ROC-AUC: 0.6673
OOD Test Loss: 0.1109

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ROC-AUC: 0.9386
Train Loss: 0.0816
ID Validation ROC-AUC: 0.8162
ID Validation Loss: 0.1295
ID Test ROC-AUC: 0.8191
ID Test Loss: 0.1110
OOD Validation ROC-AUC: 0.8014
OOD Validation Loss: 0.1369
OOD Test ROC-AUC: 0.7259
OOD Test Loss: 0.1010

[0m[1;37mINFO[0m: [1mChartInfo 0.8187 0.6673 0.8191 0.7259 0.8162 0.8014[0mTrain ROC-AUC: 0.9386Train Loss: 0.0816
Id_val ROC-AUC: 0.8162Id_val Loss: 0.1295
Val ROC-AUC: 0.8014Val Loss: 0.1369
Test ROC-AUC: 0.7259Test Loss: 0.1010
Printing obtained and stored scores: 0.7258535747899211 !=? 0.7258535747899211


Final accuracies: 
TRAIN      = 0.926 +- 0.016
ID_VAL     = 0.840 +- 0.005
VAL        = 0.763 +- 0.011
TEST       = 0.670 +- 0.021
OOD_TRAIN  = 0.929 +- 0.027
OOD_ID_VAL = 0.824 +- 0.006
OOD_VAL    = 0.789 +- 0.008
OOD_TEST   = 0.692 +- 0.021

Final losses: 
TRAIN      = 0.0893 +- 0.0061
ID_VAL     = 0.1258 +- 0.0039
VAL        = 0.1447 +- 0.0117
TEST       = 0.1075 +- 0.0036
OOD_TRAIN  = 0.0853 +- 0.0108
OOD_ID_VAL = 0.1309 +- 0.0019
OOD_VAL    = 0.1416 +- 0.0095
OOD_TEST   = 0.1093 +- 0.0077
Diff id_val-test  = 0.0183 
Diff id_val-test ood_ = 0.0216 

DONE TRAIN LECI GOODHIV/scaffold mitigation_readout NOV

Time to train models!

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:45:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:45:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ROC-AUC: 0.9674
Train Loss: 0.1437
ID Validation ROC-AUC: 0.9224
ID Validation Loss: 0.2258
ID Test ROC-AUC: 0.9259
ID Test Loss: 0.2232
OOD Validation ROC-AUC: 0.6322
OOD Validation Loss: 0.4606
OOD Test ROC-AUC: 0.6750
OOD Test Loss: 0.5675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ROC-AUC: 0.9398
Train Loss: 0.1920
ID Validation ROC-AUC: 0.9137
ID Validation Loss: 0.2275
ID Test ROC-AUC: 0.9166
ID Test Loss: 0.2257
OOD Validation ROC-AUC: 0.6872
OOD Validation Loss: 0.3270
OOD Test ROC-AUC: 0.7063
OOD Test Loss: 0.4663

[0m[1;37mINFO[0m: [1mChartInfo 0.9259 0.6750 0.9166 0.7063 0.9137 0.6872[0mTrain ROC-AUC: 0.9674Train Loss: 0.1437
Id_val ROC-AUC: 0.9224Id_val Loss: 0.2258
Val ROC-AUC: 0.6322Val Loss: 0.4606
Test ROC-AUC: 0.6750Test Loss: 0.5675
[1;34mDEBUG[0m: 04/04/2024 09:45:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 163...
[0m[1;37mINFO[0m: [1mCheckpoint 163: 
-----------------------------------
Train ROC-AUC: 0.9674
Train Loss: 0.1437
ID Validation ROC-AUC: 0.9224
ID Validation Loss: 0.2258
ID Test ROC-AUC: 0.9259
ID Test Loss: 0.2232
OOD Validation ROC-AUC: 0.6322
OOD Validation Loss: 0.4606
OOD Test ROC-AUC: 0.6750
OOD Test Loss: 0.5675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ROC-AUC: 0.9398
Train Loss: 0.1920
ID Validation ROC-AUC: 0.9137
ID Validation Loss: 0.2275
ID Test ROC-AUC: 0.9166
ID Test Loss: 0.2257
OOD Validation ROC-AUC: 0.6872
OOD Validation Loss: 0.3270
OOD Test ROC-AUC: 0.7063
OOD Test Loss: 0.4663

[0m[1;37mINFO[0m: [1mChartInfo 0.9259 0.6750 0.9166 0.7063 0.9137 0.6872[0mTrain ROC-AUC: 0.9398Train Loss: 0.1920
Id_val ROC-AUC: 0.9137Id_val Loss: 0.2275
Val ROC-AUC: 0.6872Val Loss: 0.3270
Test ROC-AUC: 0.7063Test Loss: 0.4663
Printing obtained and stored scores: 0.7062533806133702 !=? 0.7062533607157047


#D#Running with seed = 2
207 2
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 2,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 2,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:46:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:46:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9703
Train Loss: 0.1385
ID Validation ROC-AUC: 0.9237
ID Validation Loss: 0.2240
ID Test ROC-AUC: 0.9256
ID Test Loss: 0.2229
OOD Validation ROC-AUC: 0.6390
OOD Validation Loss: 0.4760
OOD Test ROC-AUC: 0.6819
OOD Test Loss: 0.5774

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ROC-AUC: 0.9215
Train Loss: 0.2166
ID Validation ROC-AUC: 0.9037
ID Validation Loss: 0.2382
ID Test ROC-AUC: 0.9054
ID Test Loss: 0.2399
OOD Validation ROC-AUC: 0.6847
OOD Validation Loss: 0.3087
OOD Test ROC-AUC: 0.6983
OOD Test Loss: 0.4684

[0m[1;37mINFO[0m: [1mChartInfo 0.9256 0.6819 0.9054 0.6983 0.9037 0.6847[0mTrain ROC-AUC: 0.9703Train Loss: 0.1385
Id_val ROC-AUC: 0.9237Id_val Loss: 0.2240
Val ROC-AUC: 0.6390Val Loss: 0.4760
Test ROC-AUC: 0.6819Test Loss: 0.5774
[1;34mDEBUG[0m: 04/04/2024 09:46:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 172...
[0m[1;37mINFO[0m: [1mCheckpoint 172: 
-----------------------------------
Train ROC-AUC: 0.9703
Train Loss: 0.1385
ID Validation ROC-AUC: 0.9237
ID Validation Loss: 0.2240
ID Test ROC-AUC: 0.9256
ID Test Loss: 0.2229
OOD Validation ROC-AUC: 0.6390
OOD Validation Loss: 0.4760
OOD Test ROC-AUC: 0.6819
OOD Test Loss: 0.5774

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ROC-AUC: 0.9215
Train Loss: 0.2166
ID Validation ROC-AUC: 0.9037
ID Validation Loss: 0.2382
ID Test ROC-AUC: 0.9054
ID Test Loss: 0.2399
OOD Validation ROC-AUC: 0.6847
OOD Validation Loss: 0.3087
OOD Test ROC-AUC: 0.6983
OOD Test Loss: 0.4684

[0m[1;37mINFO[0m: [1mChartInfo 0.9256 0.6819 0.9054 0.6983 0.9037 0.6847[0mTrain ROC-AUC: 0.9215Train Loss: 0.2166
Id_val ROC-AUC: 0.9037Id_val Loss: 0.2382
Val ROC-AUC: 0.6847Val Loss: 0.3087
Test ROC-AUC: 0.6983Test Loss: 0.4684
Printing obtained and stored scores: 0.6983331248057989 !=? 0.698333114856966


#D#Running with seed = 3
304 3
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 3,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 3,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:47:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:47:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 157...
[0m[1;37mINFO[0m: [1mCheckpoint 157: 
-----------------------------------
Train ROC-AUC: 0.9670
Train Loss: 0.1451
ID Validation ROC-AUC: 0.9221
ID Validation Loss: 0.2229
ID Test ROC-AUC: 0.9256
ID Test Loss: 0.2194
OOD Validation ROC-AUC: 0.6379
OOD Validation Loss: 0.4638
OOD Test ROC-AUC: 0.6811
OOD Test Loss: 0.5560

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9097
Train Loss: 0.2297
ID Validation ROC-AUC: 0.8947
ID Validation Loss: 0.2501
ID Test ROC-AUC: 0.8991
ID Test Loss: 0.2464
OOD Validation ROC-AUC: 0.6952
OOD Validation Loss: 0.3129
OOD Test ROC-AUC: 0.7189
OOD Test Loss: 0.4594

[0m[1;37mINFO[0m: [1mChartInfo 0.9256 0.6811 0.8991 0.7189 0.8947 0.6952[0mTrain ROC-AUC: 0.9670Train Loss: 0.1451
Id_val ROC-AUC: 0.9221Id_val Loss: 0.2229
Val ROC-AUC: 0.6379Val Loss: 0.4638
Test ROC-AUC: 0.6811Test Loss: 0.5560
[1;34mDEBUG[0m: 04/04/2024 09:48:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 157...
[0m[1;37mINFO[0m: [1mCheckpoint 157: 
-----------------------------------
Train ROC-AUC: 0.9670
Train Loss: 0.1451
ID Validation ROC-AUC: 0.9221
ID Validation Loss: 0.2229
ID Test ROC-AUC: 0.9256
ID Test Loss: 0.2194
OOD Validation ROC-AUC: 0.6379
OOD Validation Loss: 0.4638
OOD Test ROC-AUC: 0.6811
OOD Test Loss: 0.5560

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ROC-AUC: 0.9097
Train Loss: 0.2297
ID Validation ROC-AUC: 0.8947
ID Validation Loss: 0.2501
ID Test ROC-AUC: 0.8991
ID Test Loss: 0.2464
OOD Validation ROC-AUC: 0.6952
OOD Validation Loss: 0.3129
OOD Test ROC-AUC: 0.7189
OOD Test Loss: 0.4594

[0m[1;37mINFO[0m: [1mChartInfo 0.9256 0.6811 0.8991 0.7189 0.8947 0.6952[0mTrain ROC-AUC: 0.9097Train Loss: 0.2297
Id_val ROC-AUC: 0.8947Id_val Loss: 0.2501
Val ROC-AUC: 0.6952Val Loss: 0.3129
Test ROC-AUC: 0.7189Test Loss: 0.4594
Printing obtained and stored scores: 0.718886378599408 !=? 0.7188863785994081


#D#Running with seed = 4
401 4
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 4,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 4,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:48:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:48:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ROC-AUC: 0.9558
Train Loss: 0.1649
ID Validation ROC-AUC: 0.9234
ID Validation Loss: 0.2148
ID Test ROC-AUC: 0.9248
ID Test Loss: 0.2146
OOD Validation ROC-AUC: 0.6513
OOD Validation Loss: 0.3945
OOD Test ROC-AUC: 0.7020
OOD Test Loss: 0.4924

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 45...
[0m[1;37mINFO[0m: [1mCheckpoint 45: 
-----------------------------------
Train ROC-AUC: 0.9314
Train Loss: 0.2021
ID Validation ROC-AUC: 0.9108
ID Validation Loss: 0.2294
ID Test ROC-AUC: 0.9133
ID Test Loss: 0.2283
OOD Validation ROC-AUC: 0.6886
OOD Validation Loss: 0.3193
OOD Test ROC-AUC: 0.6950
OOD Test Loss: 0.4740

[0m[1;37mINFO[0m: [1mChartInfo 0.9248 0.7020 0.9133 0.6950 0.9108 0.6886[0mTrain ROC-AUC: 0.9558Train Loss: 0.1649
Id_val ROC-AUC: 0.9234Id_val Loss: 0.2148
Val ROC-AUC: 0.6513Val Loss: 0.3945
Test ROC-AUC: 0.7020Test Loss: 0.4924
[1;34mDEBUG[0m: 04/04/2024 09:49:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 126...
[0m[1;37mINFO[0m: [1mCheckpoint 126: 
-----------------------------------
Train ROC-AUC: 0.9558
Train Loss: 0.1649
ID Validation ROC-AUC: 0.9234
ID Validation Loss: 0.2148
ID Test ROC-AUC: 0.9248
ID Test Loss: 0.2146
OOD Validation ROC-AUC: 0.6513
OOD Validation Loss: 0.3945
OOD Test ROC-AUC: 0.7020
OOD Test Loss: 0.4924

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 45...
[0m[1;37mINFO[0m: [1mCheckpoint 45: 
-----------------------------------
Train ROC-AUC: 0.9314
Train Loss: 0.2021
ID Validation ROC-AUC: 0.9108
ID Validation Loss: 0.2294
ID Test ROC-AUC: 0.9133
ID Test Loss: 0.2283
OOD Validation ROC-AUC: 0.6886
OOD Validation Loss: 0.3193
OOD Test ROC-AUC: 0.6950
OOD Test Loss: 0.4740

[0m[1;37mINFO[0m: [1mChartInfo 0.9248 0.7020 0.9133 0.6950 0.9108 0.6886[0mTrain ROC-AUC: 0.9314Train Loss: 0.2021
Id_val ROC-AUC: 0.9108Id_val Loss: 0.2294
Val ROC-AUC: 0.6886Val Loss: 0.3193
Test ROC-AUC: 0.6950Test Loss: 0.4740
Printing obtained and stored scores: 0.6949985745312428 !=? 0.6949986143265738


#D#Running with seed = 5
498 5
{'acc_givenR': False,
 'argv': None,
 'average_edge_attn': 'mean',
 'ckpt_dir': None,
 'ckpt_root': None,
 'clean_save': None,
 'config_path': '/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/configs/final_configs/LBAPcore/assay/covariate/LECI.yaml',
 'dataset': DatasetArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'debias': False,
 'device': None,
 'exp_round': 5,
 'expval_budget': None,
 'feat_int_alpha': None,
 'fidelity_alpha_2': None,
 'gpu_idx': 1,
 'id_test_ckpt': None,
 'intervention_distrib': 'model_dependent',
 'log_file': None,
 'log_id': '',
 'log_path': None,
 'mask': False,
 'metric': None,
 'metrics': '',
 'mitigation_backbone': None,
 'mitigation_readout': 'weighted',
 'mitigation_sampling': 'feat',
 'mitigation_virtual': None,
 'model': ModelArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'nec_alpha_1': None,
 'nec_marg_alpha': True,
 'nec_number_samples': 'prop_G_dataset',
 'num_workers': 2,
 'numsamples_budget': None,
 'ood': OODArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True),
 'other_saved': None,
 'pipeline': None,
 'process_args_manual': <bound method CommonArgs.process_args_manual of CommonArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)>,
 'pytest': None,
 'random_expl': False,
 'random_seed': 5,
 'samplingtype': 'deconfounded',
 'save_metrics': False,
 'save_tag': None,
 'seeds': '1/2/3/4/5',
 'task': 'test',
 'tensorboard_logdir': None,
 'test_ckpt': None,
 'train': TrainArgs(prog='goodtg', usage=None, description=None, formatter_class=<class 'argparse.HelpFormatter'>, conflict_handler='error', add_help=True)}

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Apr  4 21:49:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset LBAPcore
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mDataset: {'train': LBAPcore(34179), 'id_val': LBAPcore(11314), 'id_test': LBAPcore(11683), 'val': LBAPcore(19028), 'test': LBAPcore(19032), 'task': 'Binary classification', 'metric': 'ROC-AUC'}
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1m Data(x=[31, 39], edge_index=[2, 68], edge_attr=[68, 10], y=[1, 1], env_id=[1])
[0mData(x=[30, 39], edge_index=[2, 66], edge_attr=[66, 10], y=[1, 1], env_id=[1])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing the fixed _explain_ functionality
[0mUsing feature sampling := feat
self.EF = 0.1
mitigation_readout =  None
[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mInit GINFeatExtractor
[0mmitigation_readout =  weighted
[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing no mitigation None
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 04/04/2024 09:49:58 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ROC-AUC: 0.9670
Train Loss: 0.1446
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2230
ID Test ROC-AUC: 0.9261
ID Test Loss: 0.2205
OOD Validation ROC-AUC: 0.6425
OOD Validation Loss: 0.4414
OOD Test ROC-AUC: 0.6814
OOD Test Loss: 0.5599

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.9175
Train Loss: 0.2196
ID Validation ROC-AUC: 0.9030
ID Validation Loss: 0.2374
ID Test ROC-AUC: 0.9067
ID Test Loss: 0.2357
OOD Validation ROC-AUC: 0.6862
OOD Validation Loss: 0.3125
OOD Test ROC-AUC: 0.7171
OOD Test Loss: 0.4512

[0m[1;37mINFO[0m: [1mChartInfo 0.9261 0.6814 0.9067 0.7171 0.9030 0.6862[0mTrain ROC-AUC: 0.9670Train Loss: 0.1446
Id_val ROC-AUC: 0.9223Id_val Loss: 0.2230
Val ROC-AUC: 0.6425Val Loss: 0.4414
Test ROC-AUC: 0.6814Test Loss: 0.5599
[1;34mDEBUG[0m: 04/04/2024 09:50:33 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ROC-AUC: 0.9670
Train Loss: 0.1446
ID Validation ROC-AUC: 0.9223
ID Validation Loss: 0.2230
ID Test ROC-AUC: 0.9261
ID Test Loss: 0.2205
OOD Validation ROC-AUC: 0.6425
OOD Validation Loss: 0.4414
OOD Test ROC-AUC: 0.6814
OOD Test Loss: 0.5599

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ROC-AUC: 0.9175
Train Loss: 0.2196
ID Validation ROC-AUC: 0.9030
ID Validation Loss: 0.2374
ID Test ROC-AUC: 0.9067
ID Test Loss: 0.2357
OOD Validation ROC-AUC: 0.6862
OOD Validation Loss: 0.3125
OOD Test ROC-AUC: 0.7171
OOD Test Loss: 0.4512

[0m[1;37mINFO[0m: [1mChartInfo 0.9261 0.6814 0.9067 0.7171 0.9030 0.6862[0mTrain ROC-AUC: 0.9175Train Loss: 0.2196
Id_val ROC-AUC: 0.9030Id_val Loss: 0.2374
Val ROC-AUC: 0.6862Val Loss: 0.3125
Test ROC-AUC: 0.7171Test Loss: 0.4512
Printing obtained and stored scores: 0.7170924150258255 !=? 0.7170923752304946


Final accuracies: 
TRAIN      = 0.965 +- 0.005
ID_VAL     = 0.923 +- 0.001
VAL        = 0.641 +- 0.006
TEST       = 0.684 +- 0.009
OOD_TRAIN  = 0.924 +- 0.011
OOD_ID_VAL = 0.905 +- 0.007
OOD_VAL    = 0.688 +- 0.004
OOD_TEST   = 0.707 +- 0.010

Final losses: 
TRAIN      = 0.1474 +- 0.0091
ID_VAL     = 0.2221 +- 0.0038
VAL        = 0.4472 +- 0.0286
TEST       = 0.5506 +- 0.0300
OOD_TRAIN  = 0.2120 +- 0.0133
OOD_ID_VAL = 0.2365 +- 0.0080
OOD_VAL    = 0.3161 +- 0.0064
OOD_TEST   = 0.4639 +- 0.0078
Diff id_val-test  = 0.3285 
Diff id_val-test ood_ = 0.2273 

DONE TRAIN LECI LBAPcore/assay mitigation_readout NOV
DONE all :)
