nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 634429
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:13:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:13 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:26 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:28 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:30 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:32 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:13:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.658
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.745
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.684
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.781
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.264
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.400


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.700724
Plausibility completed in  0:00:05.227837
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7579, device='cuda:1')  +-  tensor(0.2606, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6031, device='cuda:1')  +-  tensor(0.2754, device='cuda:1') (0.087)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7579, device='cuda:1')  +-  tensor(0.2606, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6758, device='cuda:1')  +-  tensor(0.1509, device='cuda:1') (0.095)
Original Stability MCC for r=0.3 = 0.996 +- 0.026
Intervened Stability MCC for r=0.3 = 0.557 +- 0.341
Original Stability F1 for r=0.3 = 0.997 +- 0.018
Intervened Stability F1 for r=0.3 = 0.751 +- 0.181
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.511950
Plausibility completed in  0:00:05.372791
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7579, device='cuda:1')  +-  tensor(0.2606, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5814, device='cuda:1')  +-  tensor(0.2716, device='cuda:1') (0.059)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7579, device='cuda:1')  +-  tensor(0.2606, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8857, device='cuda:1')  +-  tensor(0.1064, device='cuda:1') (0.048)
Original Stability MCC for r=0.6 = 0.993 +- 0.034
Intervened Stability MCC for r=0.6 = 0.412 +- 0.377
Original Stability F1 for r=0.6 = 0.997 +- 0.013
Intervened Stability F1 for r=0.6 = 0.862 +- 0.092
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.497800
Plausibility completed in  0:00:05.212539
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7914, device='cuda:1')  +-  tensor(0.2524, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6302, device='cuda:1')  +-  tensor(0.2674, device='cuda:1') (0.090)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7914, device='cuda:1')  +-  tensor(0.2524, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6865, device='cuda:1')  +-  tensor(0.1504, device='cuda:1') (0.096)
Original Stability MCC for r=0.3 = 0.992 +- 0.038
Intervened Stability MCC for r=0.3 = 0.561 +- 0.342
Original Stability F1 for r=0.3 = 0.995 +- 0.026
Intervened Stability F1 for r=0.3 = 0.754 +- 0.178
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.658339
Plausibility completed in  0:00:05.197130
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7914, device='cuda:1')  +-  tensor(0.2524, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6010, device='cuda:1')  +-  tensor(0.2639, device='cuda:1') (0.063)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7914, device='cuda:1')  +-  tensor(0.2524, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8937, device='cuda:1')  +-  tensor(0.1021, device='cuda:1') (0.047)
Original Stability MCC for r=0.6 = 0.994 +- 0.032
Intervened Stability MCC for r=0.6 = 0.433 +- 0.392
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.867 +- 0.093
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.484481
Plausibility completed in  0:00:05.297961
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4467, device='cuda:1')  +-  tensor(0.1362, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.1472, device='cuda:1') (0.057)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4467, device='cuda:1')  +-  tensor(0.1362, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6086, device='cuda:1')  +-  tensor(0.0803, device='cuda:1') (0.048)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.765 +- 0.250
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.891 +- 0.119
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.495150
Plausibility completed in  0:00:05.162491
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4467, device='cuda:1')  +-  tensor(0.1362, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4971, device='cuda:1')  +-  tensor(0.1522, device='cuda:1') (0.037)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4467, device='cuda:1')  +-  tensor(0.1362, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9065, device='cuda:1')  +-  tensor(0.0611, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.588 +- 0.302
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.926 +- 0.057
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:14:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:29 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:41 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:43 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:45 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:47 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:14:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.633
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.744
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.649
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.774
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.282
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.431


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.518704
Plausibility completed in  0:00:05.198241
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7474, device='cuda:1')  +-  tensor(0.2538, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6018, device='cuda:1')  +-  tensor(0.2863, device='cuda:1') (0.097)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7474, device='cuda:1')  +-  tensor(0.2538, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6659, device='cuda:1')  +-  tensor(0.1638, device='cuda:1') (0.101)
Original Stability MCC for r=0.3 = 0.993 +- 0.032
Intervened Stability MCC for r=0.3 = 0.555 +- 0.351
Original Stability F1 for r=0.3 = 0.995 +- 0.022
Intervened Stability F1 for r=0.3 = 0.740 +- 0.201
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.656601
Plausibility completed in  0:00:05.201327
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7474, device='cuda:1')  +-  tensor(0.2538, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5768, device='cuda:1')  +-  tensor(0.2749, device='cuda:1') (0.083)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7474, device='cuda:1')  +-  tensor(0.2538, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8848, device='cuda:1')  +-  tensor(0.1088, device='cuda:1') (0.053)
Original Stability MCC for r=0.6 = 0.992 +- 0.035
Intervened Stability MCC for r=0.6 = 0.503 +- 0.389
Original Stability F1 for r=0.6 = 0.997 +- 0.013
Intervened Stability F1 for r=0.6 = 0.862 +- 0.110
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.635335
Plausibility completed in  0:00:05.191098
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7789, device='cuda:1')  +-  tensor(0.2445, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6311, device='cuda:1')  +-  tensor(0.2793, device='cuda:1') (0.096)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7789, device='cuda:1')  +-  tensor(0.2445, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6820, device='cuda:1')  +-  tensor(0.1635, device='cuda:1') (0.101)
Original Stability MCC for r=0.3 = 0.992 +- 0.042
Intervened Stability MCC for r=0.3 = 0.572 +- 0.359
Original Stability F1 for r=0.3 = 0.994 +- 0.028
Intervened Stability F1 for r=0.3 = 0.752 +- 0.202
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.665310
Plausibility completed in  0:00:05.193343
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7789, device='cuda:1')  +-  tensor(0.2445, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5984, device='cuda:1')  +-  tensor(0.2716, device='cuda:1') (0.085)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7789, device='cuda:1')  +-  tensor(0.2445, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8911, device='cuda:1')  +-  tensor(0.1046, device='cuda:1') (0.053)
Original Stability MCC for r=0.6 = 0.994 +- 0.031
Intervened Stability MCC for r=0.6 = 0.518 +- 0.391
Original Stability F1 for r=0.6 = 0.998 +- 0.011
Intervened Stability F1 for r=0.6 = 0.869 +- 0.107
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.485450
Plausibility completed in  0:00:05.315358
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4670, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5058, device='cuda:1')  +-  tensor(0.1656, device='cuda:1') (0.061)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4670, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6049, device='cuda:1')  +-  tensor(0.0798, device='cuda:1') (0.051)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.678 +- 0.303
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.840 +- 0.156
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.488571
Plausibility completed in  0:00:05.143309
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4670, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4931, device='cuda:1')  +-  tensor(0.1589, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4670, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8388, device='cuda:1')  +-  tensor(0.0768, device='cuda:1') (0.043)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.549 +- 0.315
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.890 +- 0.083
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:15:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:15:42 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:15:55 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:15:57 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:15:59 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:00 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.707
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.784
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.726
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.810
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.413
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.587


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.513197
Plausibility completed in  0:00:05.188500
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7845, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6230, device='cuda:1')  +-  tensor(0.2878, device='cuda:1') (0.086)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7845, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6653, device='cuda:1')  +-  tensor(0.1627, device='cuda:1') (0.100)
Original Stability MCC for r=0.3 = 0.984 +- 0.053
Intervened Stability MCC for r=0.3 = 0.502 +- 0.342
Original Stability F1 for r=0.3 = 0.989 +- 0.036
Intervened Stability F1 for r=0.3 = 0.702 +- 0.198
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.662970
Plausibility completed in  0:00:05.181315
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7845, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6111, device='cuda:1')  +-  tensor(0.2828, device='cuda:1') (0.082)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7845, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8751, device='cuda:1')  +-  tensor(0.1178, device='cuda:1') (0.053)
Original Stability MCC for r=0.6 = 0.980 +- 0.059
Intervened Stability MCC for r=0.6 = 0.411 +- 0.425
Original Stability F1 for r=0.6 = 0.992 +- 0.022
Intervened Stability F1 for r=0.6 = 0.822 +- 0.135
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.644961
Plausibility completed in  0:00:05.171789
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8096, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6550, device='cuda:1')  +-  tensor(0.2786, device='cuda:1') (0.084)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8096, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6797, device='cuda:1')  +-  tensor(0.1597, device='cuda:1') (0.098)
Original Stability MCC for r=0.3 = 0.982 +- 0.060
Intervened Stability MCC for r=0.3 = 0.529 +- 0.325
Original Stability F1 for r=0.3 = 0.988 +- 0.041
Intervened Stability F1 for r=0.3 = 0.719 +- 0.187
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.510848
Plausibility completed in  0:00:05.338385
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8096, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6432, device='cuda:1')  +-  tensor(0.2776, device='cuda:1') (0.083)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8096, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8894, device='cuda:1')  +-  tensor(0.1142, device='cuda:1') (0.051)
Original Stability MCC for r=0.6 = 0.983 +- 0.059
Intervened Stability MCC for r=0.6 = 0.435 +- 0.431
Original Stability F1 for r=0.6 = 0.994 +- 0.022
Intervened Stability F1 for r=0.6 = 0.832 +- 0.136
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.488624
Plausibility completed in  0:00:05.129618
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6120, device='cuda:1')  +-  tensor(0.2337, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7168, device='cuda:1')  +-  tensor(0.2121, device='cuda:1') (0.092)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6120, device='cuda:1')  +-  tensor(0.2337, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7256, device='cuda:1')  +-  tensor(0.1261, device='cuda:1') (0.095)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.630 +- 0.287
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.786 +- 0.169
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.648367
Plausibility completed in  0:00:05.135510
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6123, device='cuda:1')  +-  tensor(0.2336, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7126, device='cuda:1')  +-  tensor(0.2222, device='cuda:1') (0.073)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6123, device='cuda:1')  +-  tensor(0.2336, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9471, device='cuda:1')  +-  tensor(0.0687, device='cuda:1') (0.036)
Original Stability MCC for r=0.6 = 0.988 +- 0.054
Intervened Stability MCC for r=0.6 = 0.572 +- 0.224
Original Stability F1 for r=0.6 = 0.996 +- 0.020
Intervened Stability F1 for r=0.6 = 0.867 +- 0.070
Intervened samples: 799
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:16:56 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:16:56 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:08 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:10 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:12 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:14 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:17:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.726
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.824
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.752
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.853
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.414
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.552


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.681794
Plausibility completed in  0:00:05.186038
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8168, device='cuda:1')  +-  tensor(0.2307, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6221, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.114)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8168, device='cuda:1')  +-  tensor(0.2307, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6721, device='cuda:1')  +-  tensor(0.1648, device='cuda:1') (0.123)
Original Stability MCC for r=0.3 = 0.985 +- 0.057
Intervened Stability MCC for r=0.3 = 0.551 +- 0.387
Original Stability F1 for r=0.3 = 0.990 +- 0.038
Intervened Stability F1 for r=0.3 = 0.733 +- 0.216
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.513903
Plausibility completed in  0:00:05.346726
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8168, device='cuda:1')  +-  tensor(0.2307, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6169, device='cuda:1')  +-  tensor(0.2533, device='cuda:1') (0.104)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8168, device='cuda:1')  +-  tensor(0.2307, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8787, device='cuda:1')  +-  tensor(0.1069, device='cuda:1') (0.063)
Original Stability MCC for r=0.6 = 0.987 +- 0.049
Intervened Stability MCC for r=0.6 = 0.472 +- 0.409
Original Stability F1 for r=0.6 = 0.995 +- 0.018
Intervened Stability F1 for r=0.6 = 0.848 +- 0.118
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.501896
Plausibility completed in  0:00:05.164849
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8463, device='cuda:1')  +-  tensor(0.2198, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6481, device='cuda:1')  +-  tensor(0.2532, device='cuda:1') (0.117)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8463, device='cuda:1')  +-  tensor(0.2198, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6833, device='cuda:1')  +-  tensor(0.1588, device='cuda:1') (0.126)
Original Stability MCC for r=0.3 = 0.987 +- 0.054
Intervened Stability MCC for r=0.3 = 0.575 +- 0.377
Original Stability F1 for r=0.3 = 0.991 +- 0.036
Intervened Stability F1 for r=0.3 = 0.747 +- 0.213
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.667425
Plausibility completed in  0:00:05.166054
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8463, device='cuda:1')  +-  tensor(0.2198, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6368, device='cuda:1')  +-  tensor(0.2431, device='cuda:1') (0.106)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8463, device='cuda:1')  +-  tensor(0.2198, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8880, device='cuda:1')  +-  tensor(0.1020, device='cuda:1') (0.066)
Original Stability MCC for r=0.6 = 0.991 +- 0.044
Intervened Stability MCC for r=0.6 = 0.492 +- 0.408
Original Stability F1 for r=0.6 = 0.997 +- 0.016
Intervened Stability F1 for r=0.6 = 0.857 +- 0.114
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.492413
Plausibility completed in  0:00:05.269976
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5093, device='cuda:1')  +-  tensor(0.1827, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5365, device='cuda:1')  +-  tensor(0.1612, device='cuda:1') (0.074)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5093, device='cuda:1')  +-  tensor(0.1827, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5713, device='cuda:1')  +-  tensor(0.1029, device='cuda:1') (0.088)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.600 +- 0.317
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.774 +- 0.181
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.500723
Plausibility completed in  0:00:05.142387
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5093, device='cuda:1')  +-  tensor(0.1827, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5163, device='cuda:1')  +-  tensor(0.1407, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5093, device='cuda:1')  +-  tensor(0.1827, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8181, device='cuda:1')  +-  tensor(0.0612, device='cuda:1') (0.073)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.486 +- 0.345
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.846 +- 0.102
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:18:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:21 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:23 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:25 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:27 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:18:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.704
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.800
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.719
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.827
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.420
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.510


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.520738
Plausibility completed in  0:00:05.363208
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7968, device='cuda:1')  +-  tensor(0.2450, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6206, device='cuda:1')  +-  tensor(0.2712, device='cuda:1') (0.101)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7968, device='cuda:1')  +-  tensor(0.2450, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6878, device='cuda:1')  +-  tensor(0.1526, device='cuda:1') (0.124)
Original Stability MCC for r=0.3 = 0.991 +- 0.037
Intervened Stability MCC for r=0.3 = 0.572 +- 0.326
Original Stability F1 for r=0.3 = 0.994 +- 0.025
Intervened Stability F1 for r=0.3 = 0.745 +- 0.183
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.512595
Plausibility completed in  0:00:05.168220
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7968, device='cuda:1')  +-  tensor(0.2450, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6068, device='cuda:1')  +-  tensor(0.2746, device='cuda:1') (0.092)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7968, device='cuda:1')  +-  tensor(0.2450, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8865, device='cuda:1')  +-  tensor(0.1096, device='cuda:1') (0.059)
Original Stability MCC for r=0.6 = 0.988 +- 0.060
Intervened Stability MCC for r=0.6 = 0.416 +- 0.394
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.835 +- 0.108
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.640268
Plausibility completed in  0:00:05.154683
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8245, device='cuda:1')  +-  tensor(0.2361, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6461, device='cuda:1')  +-  tensor(0.2623, device='cuda:1') (0.099)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8245, device='cuda:1')  +-  tensor(0.2361, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6997, device='cuda:1')  +-  tensor(0.1470, device='cuda:1') (0.124)
Original Stability MCC for r=0.3 = 0.990 +- 0.035
Intervened Stability MCC for r=0.3 = 0.593 +- 0.315
Original Stability F1 for r=0.3 = 0.993 +- 0.024
Intervened Stability F1 for r=0.3 = 0.757 +- 0.177
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.672628
Plausibility completed in  0:00:05.156133
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8245, device='cuda:1')  +-  tensor(0.2361, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6369, device='cuda:1')  +-  tensor(0.2671, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8245, device='cuda:1')  +-  tensor(0.2361, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8983, device='cuda:1')  +-  tensor(0.1002, device='cuda:1') (0.061)
Original Stability MCC for r=0.6 = 0.984 +- 0.069
Intervened Stability MCC for r=0.6 = 0.416 +- 0.398
Original Stability F1 for r=0.6 = 0.995 +- 0.024
Intervened Stability F1 for r=0.6 = 0.838 +- 0.107
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.491179
Plausibility completed in  0:00:05.116790
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4955, device='cuda:1')  +-  tensor(0.1599, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5688, device='cuda:1')  +-  tensor(0.1682, device='cuda:1') (0.072)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4955, device='cuda:1')  +-  tensor(0.1599, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6128, device='cuda:1')  +-  tensor(0.0895, device='cuda:1') (0.075)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.623 +- 0.319
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.786 +- 0.187
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.647394
Plausibility completed in  0:00:05.118905
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4957, device='cuda:1')  +-  tensor(0.1599, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5572, device='cuda:1')  +-  tensor(0.1646, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4957, device='cuda:1')  +-  tensor(0.1599, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8406, device='cuda:1')  +-  tensor(0.0700, device='cuda:1') (0.060)
Original Stability MCC for r=0.6 = 0.993 +- 0.047
Intervened Stability MCC for r=0.6 = 0.509 +- 0.277
Original Stability F1 for r=0.6 = 0.997 +- 0.017
Intervened Stability F1 for r=0.6 = 0.848 +- 0.088
Intervened samples: 799


DONE GOODMotif - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.78067299 0.78067299] +- [0.02533602 0.02533602] (mean across ratios: 0.781)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.61411313 0.59859494] +- [0.00957236 0.01632117] (mean across ratios: 0.606)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.80701897 0.97792647] +- [0.02220636 0.0057535 ] (mean across ratios: 0.892)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.6733778  0.88217419] +- [0.00820885 0.00447395] (mean across ratios: 0.778)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99309586 0.99549141] +- [0.00309729 0.00171517] (mean across ratios: 0.994)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.7339476  0.84571303] +- [0.01726618 0.01560355] (mean across ratios: 0.790)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98987764 0.9879546 ] +- [0.00456422 0.00463368] (mean across ratios: 0.989)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.54730172 0.44284613] +- [0.02383122 0.03788425] (mean across ratios: 0.495)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.81013876 0.81013876] +- [0.02386519 0.02386519] (mean across ratios: 0.810)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.64213077 0.62325768] +- [0.00980021 0.0193843 ] (mean across ratios: 0.633)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.81035951 0.98126022] +- [0.02342881 0.00539821] (mean across ratios: 0.896)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.68621708 0.89208695] +- [0.00707529 0.00363318] (mean across ratios: 0.789)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.99224477 0.99603548] +- [0.00267602 0.00170447] (mean across ratios: 0.994)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.74587983 0.85251492] +- [0.0138393  0.01523301] (mean across ratios: 0.799)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.98861322 0.98921337] +- [0.00393715 0.00480333] (mean across ratios: 0.989)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.56596754 0.45890405] +- [0.0210633  0.03910536] (mean across ratios: 0.512)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.50611098 0.50622525] +- [0.05723039 0.05735136] (mean across ratios: 0.506)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.56680129 0.55526103] +- [0.07853997 0.08189318] (mean across ratios: 0.561)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.4480575  0.80942398] +- [0.08425713 0.08341694] (mean across ratios: 0.629)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.62464151 0.87022406] +- [0.05258596 0.04860529] (mean across ratios: 0.747)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99857125] +- [0.         0.00174872] (mean across ratios: 0.999)
(id) (test) STABILITY_F1_PERTURBED: 	[0.81542938 0.87534571] +- [0.04397354 0.03003699] (mean across ratios: 0.845)

(id) (test) STABILITY_MCC_ORIGINAL: 	[1.         0.99610308] +- [0.         0.00472944] (mean across ratios: 0.998)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.6593691  0.54100823] +- [0.05869928 0.03808231] (mean across ratios: 0.600)

Overall time of execution:  0:06:09.421800
DONE LECI GOODMotif/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:19:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:19:40 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:19:53 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:19:55 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:19:57 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:19:59 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.658
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.745
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.684
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.781
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.264
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.400


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.781190
Plausibility completed in  0:00:05.259921
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7579, device='cuda:1')  +-  tensor(0.2606, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5657, device='cuda:1')  +-  tensor(0.2706, device='cuda:1') (0.091)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7579, device='cuda:1')  +-  tensor(0.2606, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6303, device='cuda:1')  +-  tensor(0.1466, device='cuda:1') (0.092)
Original Stability MCC for r=0.3 = 0.996 +- 0.026
Intervened Stability MCC for r=0.3 = 0.449 +- 0.384
Original Stability F1 for r=0.3 = 0.998 +- 0.017
Intervened Stability F1 for r=0.3 = 0.713 +- 0.197
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.737150
Plausibility completed in  0:00:05.253683
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7579, device='cuda:1')  +-  tensor(0.2606, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5513, device='cuda:1')  +-  tensor(0.2900, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7579, device='cuda:1')  +-  tensor(0.2606, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8901, device='cuda:1')  +-  tensor(0.1083, device='cuda:1') (0.033)
Original Stability MCC for r=0.6 = 0.992 +- 0.040
Intervened Stability MCC for r=0.6 = 0.245 +- 0.366
Original Stability F1 for r=0.6 = 0.997 +- 0.015
Intervened Stability F1 for r=0.6 = 0.880 +- 0.094
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.576161
Plausibility completed in  0:00:05.388529
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7914, device='cuda:1')  +-  tensor(0.2524, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5879, device='cuda:1')  +-  tensor(0.2627, device='cuda:1') (0.096)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7914, device='cuda:1')  +-  tensor(0.2524, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6393, device='cuda:1')  +-  tensor(0.1473, device='cuda:1') (0.095)
Original Stability MCC for r=0.3 = 0.994 +- 0.033
Intervened Stability MCC for r=0.3 = 0.463 +- 0.392
Original Stability F1 for r=0.3 = 0.996 +- 0.022
Intervened Stability F1 for r=0.3 = 0.724 +- 0.195
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.570170
Plausibility completed in  0:00:05.241608
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7914, device='cuda:1')  +-  tensor(0.2524, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5703, device='cuda:1')  +-  tensor(0.2802, device='cuda:1') (0.045)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7914, device='cuda:1')  +-  tensor(0.2524, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8991, device='cuda:1')  +-  tensor(0.1057, device='cuda:1') (0.032)
Original Stability MCC for r=0.6 = 0.995 +- 0.026
Intervened Stability MCC for r=0.6 = 0.269 +- 0.381
Original Stability F1 for r=0.6 = 0.998 +- 0.010
Intervened Stability F1 for r=0.6 = 0.891 +- 0.093
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.697666
Plausibility completed in  0:00:05.182524
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4467, device='cuda:1')  +-  tensor(0.1362, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5998, device='cuda:1')  +-  tensor(0.1585, device='cuda:1') (0.073)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4467, device='cuda:1')  +-  tensor(0.1362, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6461, device='cuda:1')  +-  tensor(0.1176, device='cuda:1') (0.051)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.503 +- 0.376
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.797 +- 0.161
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.710462
Plausibility completed in  0:00:05.186508
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4467, device='cuda:1')  +-  tensor(0.1362, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5433, device='cuda:1')  +-  tensor(0.1548, device='cuda:1') (0.013)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4467, device='cuda:1')  +-  tensor(0.1362, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9439, device='cuda:1')  +-  tensor(0.0707, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.124 +- 0.303
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.904 +- 0.052
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:20:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:20:55 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:07 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:09 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:11 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:13 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:21:15 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.633
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.744
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.649
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.774
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.282
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.431


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.748673
Plausibility completed in  0:00:05.260431
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7474, device='cuda:1')  +-  tensor(0.2538, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5803, device='cuda:1')  +-  tensor(0.3036, device='cuda:1') (0.092)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7474, device='cuda:1')  +-  tensor(0.2538, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6437, device='cuda:1')  +-  tensor(0.1765, device='cuda:1') (0.091)
Original Stability MCC for r=0.3 = 0.990 +- 0.038
Intervened Stability MCC for r=0.3 = 0.492 +- 0.414
Original Stability F1 for r=0.3 = 0.993 +- 0.026
Intervened Stability F1 for r=0.3 = 0.724 +- 0.222
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.749313
Plausibility completed in  0:00:05.256163
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7474, device='cuda:1')  +-  tensor(0.2538, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5319, device='cuda:1')  +-  tensor(0.3033, device='cuda:1') (0.063)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7474, device='cuda:1')  +-  tensor(0.2538, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8848, device='cuda:1')  +-  tensor(0.1142, device='cuda:1') (0.043)
Original Stability MCC for r=0.6 = 0.994 +- 0.031
Intervened Stability MCC for r=0.6 = 0.233 +- 0.394
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.868 +- 0.111
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.583254
Plausibility completed in  0:00:05.399869
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7789, device='cuda:1')  +-  tensor(0.2445, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6026, device='cuda:1')  +-  tensor(0.2999, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7789, device='cuda:1')  +-  tensor(0.2445, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6547, device='cuda:1')  +-  tensor(0.1743, device='cuda:1') (0.092)
Original Stability MCC for r=0.3 = 0.994 +- 0.029
Intervened Stability MCC for r=0.3 = 0.494 +- 0.434
Original Stability F1 for r=0.3 = 0.996 +- 0.019
Intervened Stability F1 for r=0.3 = 0.727 +- 0.227
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.589265
Plausibility completed in  0:00:05.244326
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7789, device='cuda:1')  +-  tensor(0.2445, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5551, device='cuda:1')  +-  tensor(0.3067, device='cuda:1') (0.062)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7789, device='cuda:1')  +-  tensor(0.2445, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8924, device='cuda:1')  +-  tensor(0.1087, device='cuda:1') (0.042)
Original Stability MCC for r=0.6 = 0.995 +- 0.027
Intervened Stability MCC for r=0.6 = 0.221 +- 0.389
Original Stability F1 for r=0.6 = 0.998 +- 0.010
Intervened Stability F1 for r=0.6 = 0.873 +- 0.104
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.704283
Plausibility completed in  0:00:05.203666
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4670, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6118, device='cuda:1')  +-  tensor(0.2177, device='cuda:1') (0.068)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4670, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6621, device='cuda:1')  +-  tensor(0.1178, device='cuda:1') (0.046)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.344 +- 0.389
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.708 +- 0.180
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.742279
Plausibility completed in  0:00:05.215016
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4670, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5679, device='cuda:1')  +-  tensor(0.2149, device='cuda:1') (0.041)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4670, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8940, device='cuda:1')  +-  tensor(0.0838, device='cuda:1') (0.023)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.218 +- 0.400
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.869 +- 0.079
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:22:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:20 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:22 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:24 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:22:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.707
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.784
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.726
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.810
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.413
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.587


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.741879
Plausibility completed in  0:00:05.234681
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7845, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5948, device='cuda:1')  +-  tensor(0.3184, device='cuda:1') (0.061)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7845, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6209, device='cuda:1')  +-  tensor(0.1869, device='cuda:1') (0.068)
Original Stability MCC for r=0.3 = 0.985 +- 0.052
Intervened Stability MCC for r=0.3 = 0.408 +- 0.396
Original Stability F1 for r=0.3 = 0.990 +- 0.035
Intervened Stability F1 for r=0.3 = 0.677 +- 0.213
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.735130
Plausibility completed in  0:00:05.231086
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7845, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5835, device='cuda:1')  +-  tensor(0.3237, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7845, device='cuda:1')  +-  tensor(0.2238, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8507, device='cuda:1')  +-  tensor(0.1464, device='cuda:1') (0.044)
Original Stability MCC for r=0.6 = 0.978 +- 0.064
Intervened Stability MCC for r=0.6 = 0.181 +- 0.402
Original Stability F1 for r=0.6 = 0.992 +- 0.024
Intervened Stability F1 for r=0.6 = 0.841 +- 0.138
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.576179
Plausibility completed in  0:00:05.353232
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8096, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6216, device='cuda:1')  +-  tensor(0.3171, device='cuda:1') (0.058)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8096, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6355, device='cuda:1')  +-  tensor(0.1858, device='cuda:1') (0.068)
Original Stability MCC for r=0.3 = 0.987 +- 0.052
Intervened Stability MCC for r=0.3 = 0.420 +- 0.401
Original Stability F1 for r=0.3 = 0.991 +- 0.035
Intervened Stability F1 for r=0.3 = 0.689 +- 0.211
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.579094
Plausibility completed in  0:00:05.230613
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8096, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6088, device='cuda:1')  +-  tensor(0.3234, device='cuda:1') (0.058)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8096, device='cuda:1')  +-  tensor(0.2121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8631, device='cuda:1')  +-  tensor(0.1459, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.983 +- 0.057
Intervened Stability MCC for r=0.6 = 0.201 +- 0.415
Original Stability F1 for r=0.6 = 0.994 +- 0.021
Intervened Stability F1 for r=0.6 = 0.852 +- 0.136
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.697873
Plausibility completed in  0:00:05.166030
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6120, device='cuda:1')  +-  tensor(0.2337, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.8588, device='cuda:1')  +-  tensor(0.1577, device='cuda:1') (0.087)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6120, device='cuda:1')  +-  tensor(0.2337, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6728, device='cuda:1')  +-  tensor(0.1944, device='cuda:1') (0.077)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.312 +- 0.384
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.641 +- 0.207
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.713672
Plausibility completed in  0:00:05.169059
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6123, device='cuda:1')  +-  tensor(0.2336, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8300, device='cuda:1')  +-  tensor(0.1928, device='cuda:1') (0.067)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6123, device='cuda:1')  +-  tensor(0.2336, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9302, device='cuda:1')  +-  tensor(0.0988, device='cuda:1') (0.026)
Original Stability MCC for r=0.6 = 0.988 +- 0.054
Intervened Stability MCC for r=0.6 = 0.190 +- 0.352
Original Stability F1 for r=0.6 = 0.995 +- 0.020
Intervened Stability F1 for r=0.6 = 0.851 +- 0.078
Intervened samples: 799
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:23:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:21 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:35 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:39 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:23:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.726
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.824
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.752
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.853
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.414
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.552


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.750407
Plausibility completed in  0:00:05.213839
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8168, device='cuda:1')  +-  tensor(0.2307, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5811, device='cuda:1')  +-  tensor(0.2642, device='cuda:1') (0.112)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8168, device='cuda:1')  +-  tensor(0.2307, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6305, device='cuda:1')  +-  tensor(0.1519, device='cuda:1') (0.115)
Original Stability MCC for r=0.3 = 0.986 +- 0.052
Intervened Stability MCC for r=0.3 = 0.508 +- 0.406
Original Stability F1 for r=0.3 = 0.991 +- 0.035
Intervened Stability F1 for r=0.3 = 0.729 +- 0.222
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.739638
Plausibility completed in  0:00:05.204145
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8168, device='cuda:1')  +-  tensor(0.2307, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5564, device='cuda:1')  +-  tensor(0.2732, device='cuda:1') (0.078)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8168, device='cuda:1')  +-  tensor(0.2307, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8920, device='cuda:1')  +-  tensor(0.1128, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.987 +- 0.048
Intervened Stability MCC for r=0.6 = 0.262 +- 0.410
Original Stability F1 for r=0.6 = 0.995 +- 0.018
Intervened Stability F1 for r=0.6 = 0.872 +- 0.120
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.581945
Plausibility completed in  0:00:05.336684
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8463, device='cuda:1')  +-  tensor(0.2198, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5967, device='cuda:1')  +-  tensor(0.2548, device='cuda:1') (0.114)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8463, device='cuda:1')  +-  tensor(0.2198, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6324, device='cuda:1')  +-  tensor(0.1444, device='cuda:1') (0.117)
Original Stability MCC for r=0.3 = 0.984 +- 0.061
Intervened Stability MCC for r=0.3 = 0.516 +- 0.412
Original Stability F1 for r=0.3 = 0.989 +- 0.041
Intervened Stability F1 for r=0.3 = 0.735 +- 0.221
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.586790
Plausibility completed in  0:00:05.207172
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8463, device='cuda:1')  +-  tensor(0.2198, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5657, device='cuda:1')  +-  tensor(0.2684, device='cuda:1') (0.076)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8463, device='cuda:1')  +-  tensor(0.2198, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8970, device='cuda:1')  +-  tensor(0.1095, device='cuda:1') (0.040)
Original Stability MCC for r=0.6 = 0.991 +- 0.044
Intervened Stability MCC for r=0.6 = 0.261 +- 0.413
Original Stability F1 for r=0.6 = 0.997 +- 0.016
Intervened Stability F1 for r=0.6 = 0.878 +- 0.116
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.702435
Plausibility completed in  0:00:05.140049
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5093, device='cuda:1')  +-  tensor(0.1827, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6098, device='cuda:1')  +-  tensor(0.1861, device='cuda:1') (0.093)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5093, device='cuda:1')  +-  tensor(0.1827, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5935, device='cuda:1')  +-  tensor(0.1239, device='cuda:1') (0.088)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.293 +- 0.374
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.642 +- 0.192
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.721323
Plausibility completed in  0:00:05.163487
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5093, device='cuda:1')  +-  tensor(0.1827, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5823, device='cuda:1')  +-  tensor(0.1771, device='cuda:1') (0.058)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5093, device='cuda:1')  +-  tensor(0.1827, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8707, device='cuda:1')  +-  tensor(0.0889, device='cuda:1') (0.043)
Original Stability MCC for r=0.6 = 0.999 +- 0.020
Intervened Stability MCC for r=0.6 = 0.204 +- 0.388
Original Stability F1 for r=0.6 = 1.000 +- 0.007
Intervened Stability F1 for r=0.6 = 0.854 +- 0.090
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:24:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:34 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:47 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:51 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:24:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.704
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.800
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.719
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.827
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.420
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.510


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.761097
Plausibility completed in  0:00:05.202838
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7968, device='cuda:1')  +-  tensor(0.2450, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5959, device='cuda:1')  +-  tensor(0.2980, device='cuda:1') (0.083)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7968, device='cuda:1')  +-  tensor(0.2450, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6534, device='cuda:1')  +-  tensor(0.1629, device='cuda:1') (0.095)
Original Stability MCC for r=0.3 = 0.992 +- 0.033
Intervened Stability MCC for r=0.3 = 0.498 +- 0.367
Original Stability F1 for r=0.3 = 0.994 +- 0.023
Intervened Stability F1 for r=0.3 = 0.725 +- 0.191
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.743773
Plausibility completed in  0:00:05.196432
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7968, device='cuda:1')  +-  tensor(0.2450, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5677, device='cuda:1')  +-  tensor(0.3085, device='cuda:1') (0.063)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7968, device='cuda:1')  +-  tensor(0.2450, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8888, device='cuda:1')  +-  tensor(0.1119, device='cuda:1') (0.044)
Original Stability MCC for r=0.6 = 0.984 +- 0.066
Intervened Stability MCC for r=0.6 = 0.226 +- 0.365
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.868 +- 0.110
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.575468
Plausibility completed in  0:00:05.330811
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8245, device='cuda:1')  +-  tensor(0.2361, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6212, device='cuda:1')  +-  tensor(0.2921, device='cuda:1') (0.082)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8245, device='cuda:1')  +-  tensor(0.2361, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6685, device='cuda:1')  +-  tensor(0.1633, device='cuda:1') (0.096)
Original Stability MCC for r=0.3 = 0.990 +- 0.038
Intervened Stability MCC for r=0.3 = 0.512 +- 0.360
Original Stability F1 for r=0.3 = 0.993 +- 0.025
Intervened Stability F1 for r=0.3 = 0.736 +- 0.186
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.588129
Plausibility completed in  0:00:05.202805
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8245, device='cuda:1')  +-  tensor(0.2361, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5983, device='cuda:1')  +-  tensor(0.3030, device='cuda:1') (0.059)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8245, device='cuda:1')  +-  tensor(0.2361, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8999, device='cuda:1')  +-  tensor(0.1075, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.986 +- 0.062
Intervened Stability MCC for r=0.6 = 0.223 +- 0.363
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.876 +- 0.107
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.699897
Plausibility completed in  0:00:05.140107
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4955, device='cuda:1')  +-  tensor(0.1599, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6713, device='cuda:1')  +-  tensor(0.1774, device='cuda:1') (0.091)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4955, device='cuda:1')  +-  tensor(0.1599, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6599, device='cuda:1')  +-  tensor(0.1221, device='cuda:1') (0.087)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.314 +- 0.382
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.646 +- 0.199
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.719098
Plausibility completed in  0:00:05.150347
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4957, device='cuda:1')  +-  tensor(0.1599, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6602, device='cuda:1')  +-  tensor(0.2107, device='cuda:1') (0.073)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4957, device='cuda:1')  +-  tensor(0.1599, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8876, device='cuda:1')  +-  tensor(0.1047, device='cuda:1') (0.048)
Original Stability MCC for r=0.6 = 0.993 +- 0.046
Intervened Stability MCC for r=0.6 = 0.115 +- 0.359
Original Stability F1 for r=0.6 = 0.998 +- 0.016
Intervened Stability F1 for r=0.6 = 0.837 +- 0.089
Intervened samples: 799


DONE GOODMotif - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.78067299 0.78067299] +- [0.02533602 0.02533602] (mean across ratios: 0.781)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.58356203 0.55815954] +- [0.01105022 0.01714513] (mean across ratios: 0.571)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.80701897 0.97792647] +- [0.02220636 0.0057535 ] (mean across ratios: 0.892)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.63575262 0.88125908] +- [0.01141025 0.01546911] (mean across ratios: 0.759)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99315027 0.99516219] +- [0.00278956 0.00203623] (mean across ratios: 0.994)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.71345506 0.8657335 ] +- [0.0191458 0.0130296] (mean across ratios: 0.790)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98994235 0.98709632] +- [0.0041108  0.00553257] (mean across ratios: 0.989)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.47096568 0.22971191] +- [0.03739386 0.02701257] (mean across ratios: 0.350)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.81013876 0.81013876] +- [0.02386519 0.02386519] (mean across ratios: 0.810)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.60600389 0.5796342 ] +- [0.01342425 0.02041329] (mean across ratios: 0.593)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.81035951 0.98126022] +- [0.02342881 0.00539821] (mean across ratios: 0.896)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.64605834 0.89029256] +- [0.01357312 0.01384654] (mean across ratios: 0.768)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.9931038  0.99630858] +- [0.00278384 0.00178094] (mean across ratios: 0.995)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.72223308 0.87413586] +- [0.0173876  0.01247438] (mean across ratios: 0.798)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.98985518 0.99000256] +- [0.00410601 0.004925  ] (mean across ratios: 0.990)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.48104303 0.23489744] +- [0.03578263 0.02576054] (mean across ratios: 0.358)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.50611098 0.50622525] +- [0.05723039 0.05735136] (mean across ratios: 0.506)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.67030023 0.63676803] +- [0.09755148 0.1042443 ] (mean across ratios: 0.654)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.4480575  0.80942398] +- [0.08425713 0.08341694] (mean across ratios: 0.629)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.64688808 0.90527477] +- [0.0280236  0.02736724] (mean across ratios: 0.776)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99999934 0.99854013] +- [0.        0.0017519] (mean across ratios: 0.999)
(id) (test) STABILITY_F1_PERTURBED: 	[0.68660488 0.86312443] +- [0.06040043 0.0230586 ] (mean across ratios: 0.775)

(id) (test) STABILITY_MCC_ORIGINAL: 	[1.         0.99597689] +- [0.        0.0047473] (mean across ratios: 0.998)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.35313081 0.17019503] +- [0.07682637 0.04240605] (mean across ratios: 0.262)

Overall time of execution:  0:06:08.343075
DONE LECI GOODMotif/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:26:08 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:08 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:20 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:22 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:24 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:26:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.682
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.732
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.717
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.767
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.145
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.359


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.706877
Plausibility completed in  0:00:05.116652
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7344, device='cuda:1')  +-  tensor(0.2732, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5790, device='cuda:1')  +-  tensor(0.2832, device='cuda:1') (0.106)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7344, device='cuda:1')  +-  tensor(0.2732, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7038, device='cuda:1')  +-  tensor(0.1273, device='cuda:1') (0.114)
Original Stability MCC for r=0.3 = 0.942 +- 0.146
Intervened Stability MCC for r=0.3 = 0.601 +- 0.336
Original Stability F1 for r=0.3 = 0.964 +- 0.089
Intervened Stability F1 for r=0.3 = 0.757 +- 0.188
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.518511
Plausibility completed in  0:00:05.277122
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7344, device='cuda:1')  +-  tensor(0.2732, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5714, device='cuda:1')  +-  tensor(0.2884, device='cuda:1') (0.082)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7344, device='cuda:1')  +-  tensor(0.2732, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9493, device='cuda:1')  +-  tensor(0.0704, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.974 +- 0.082
Intervened Stability MCC for r=0.6 = 0.589 +- 0.335
Original Stability F1 for r=0.6 = 0.991 +- 0.030
Intervened Stability F1 for r=0.6 = 0.886 +- 0.090
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.503039
Plausibility completed in  0:00:05.102872
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7701, device='cuda:1')  +-  tensor(0.2525, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6022, device='cuda:1')  +-  tensor(0.2767, device='cuda:1') (0.107)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7701, device='cuda:1')  +-  tensor(0.2525, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7075, device='cuda:1')  +-  tensor(0.1307, device='cuda:1') (0.118)
Original Stability MCC for r=0.3 = 0.939 +- 0.148
Intervened Stability MCC for r=0.3 = 0.615 +- 0.333
Original Stability F1 for r=0.3 = 0.962 +- 0.090
Intervened Stability F1 for r=0.3 = 0.765 +- 0.187
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.657250
Plausibility completed in  0:00:05.093711
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7701, device='cuda:1')  +-  tensor(0.2525, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5969, device='cuda:1')  +-  tensor(0.2811, device='cuda:1') (0.085)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7701, device='cuda:1')  +-  tensor(0.2525, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9543, device='cuda:1')  +-  tensor(0.0668, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 0.976 +- 0.078
Intervened Stability MCC for r=0.6 = 0.595 +- 0.332
Original Stability F1 for r=0.6 = 0.992 +- 0.028
Intervened Stability F1 for r=0.6 = 0.890 +- 0.087
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.626438
Plausibility completed in  0:00:05.076117
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4286, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4986, device='cuda:1')  +-  tensor(0.1970, device='cuda:1') (0.056)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4286, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4836, device='cuda:1')  +-  tensor(0.1057, device='cuda:1') (0.043)
Original Stability MCC for r=0.3 = 0.708 +- 0.315
Intervened Stability MCC for r=0.3 = 0.477 +- 0.287
Original Stability F1 for r=0.3 = 0.821 +- 0.186
Intervened Stability F1 for r=0.3 = 0.688 +- 0.162
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.483328
Plausibility completed in  0:00:05.227230
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4290, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4819, device='cuda:1')  +-  tensor(0.1940, device='cuda:1') (0.040)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4290, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8474, device='cuda:1')  +-  tensor(0.1084, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.919 +- 0.169
Intervened Stability MCC for r=0.6 = 0.596 +- 0.257
Original Stability F1 for r=0.6 = 0.973 +- 0.054
Intervened Stability F1 for r=0.6 = 0.878 +- 0.074
Intervened samples: 798
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:27:22 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:22 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:34 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:36 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:38 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:40 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:27:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.639
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.665
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.724
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.154
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.405


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.692793
Plausibility completed in  0:00:05.190476
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6968, device='cuda:1')  +-  tensor(0.2670, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5983, device='cuda:1')  +-  tensor(0.2849, device='cuda:1') (0.093)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6968, device='cuda:1')  +-  tensor(0.2670, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7359, device='cuda:1')  +-  tensor(0.1431, device='cuda:1') (0.111)
Original Stability MCC for r=0.3 = 0.932 +- 0.140
Intervened Stability MCC for r=0.3 = 0.606 +- 0.333
Original Stability F1 for r=0.3 = 0.956 +- 0.086
Intervened Stability F1 for r=0.3 = 0.762 +- 0.180
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.532526
Plausibility completed in  0:00:05.183782
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6968, device='cuda:1')  +-  tensor(0.2670, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5795, device='cuda:1')  +-  tensor(0.2835, device='cuda:1') (0.088)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6968, device='cuda:1')  +-  tensor(0.2670, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9467, device='cuda:1')  +-  tensor(0.0798, device='cuda:1') (0.037)
Original Stability MCC for r=0.6 = 0.980 +- 0.074
Intervened Stability MCC for r=0.6 = 0.638 +- 0.338
Original Stability F1 for r=0.6 = 0.993 +- 0.026
Intervened Stability F1 for r=0.6 = 0.901 +- 0.089
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.656619
Plausibility completed in  0:00:05.157741
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2560, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6260, device='cuda:1')  +-  tensor(0.2782, device='cuda:1') (0.092)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2560, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7447, device='cuda:1')  +-  tensor(0.1446, device='cuda:1') (0.111)
Original Stability MCC for r=0.3 = 0.932 +- 0.134
Intervened Stability MCC for r=0.3 = 0.627 +- 0.323
Original Stability F1 for r=0.3 = 0.955 +- 0.085
Intervened Stability F1 for r=0.3 = 0.773 +- 0.177
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.669398
Plausibility completed in  0:00:05.156647
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2560, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6064, device='cuda:1')  +-  tensor(0.2744, device='cuda:1') (0.093)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2560, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9533, device='cuda:1')  +-  tensor(0.0758, device='cuda:1') (0.033)
Original Stability MCC for r=0.6 = 0.981 +- 0.063
Intervened Stability MCC for r=0.6 = 0.667 +- 0.334
Original Stability F1 for r=0.6 = 0.993 +- 0.023
Intervened Stability F1 for r=0.6 = 0.910 +- 0.086
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.515077
Plausibility completed in  0:00:05.275811
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4723, device='cuda:1')  +-  tensor(0.2016, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5597, device='cuda:1')  +-  tensor(0.2183, device='cuda:1') (0.071)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4723, device='cuda:1')  +-  tensor(0.2016, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5132, device='cuda:1')  +-  tensor(0.1200, device='cuda:1') (0.059)
Original Stability MCC for r=0.3 = 0.834 +- 0.245
Intervened Stability MCC for r=0.3 = 0.519 +- 0.288
Original Stability F1 for r=0.3 = 0.898 +- 0.144
Intervened Stability F1 for r=0.3 = 0.709 +- 0.165
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.507864
Plausibility completed in  0:00:05.112235
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4728, device='cuda:1')  +-  tensor(0.2016, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5458, device='cuda:1')  +-  tensor(0.2254, device='cuda:1') (0.055)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4728, device='cuda:1')  +-  tensor(0.2016, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8947, device='cuda:1')  +-  tensor(0.1037, device='cuda:1') (0.028)
Original Stability MCC for r=0.6 = 0.939 +- 0.145
Intervened Stability MCC for r=0.6 = 0.597 +- 0.261
Original Stability F1 for r=0.6 = 0.980 +- 0.047
Intervened Stability F1 for r=0.6 = 0.877 +- 0.076
Intervened samples: 798
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:28:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:34 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:46 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:50 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:52 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:28:54 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.561
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.559
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.579
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.425


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.671846
Plausibility completed in  0:00:05.112383
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5716, device='cuda:1')  +-  tensor(0.2181, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5361, device='cuda:1')  +-  tensor(0.2921, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5716, device='cuda:1')  +-  tensor(0.2181, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6062, device='cuda:1')  +-  tensor(0.1335, device='cuda:1') (0.082)
Original Stability MCC for r=0.3 = 0.980 +- 0.065
Intervened Stability MCC for r=0.3 = 0.556 +- 0.407
Original Stability F1 for r=0.3 = 0.986 +- 0.043
Intervened Stability F1 for r=0.3 = 0.729 +- 0.226
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.514350
Plausibility completed in  0:00:05.273156
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5716, device='cuda:1')  +-  tensor(0.2181, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5146, device='cuda:1')  +-  tensor(0.2820, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5716, device='cuda:1')  +-  tensor(0.2181, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9080, device='cuda:1')  +-  tensor(0.1013, device='cuda:1') (0.033)
Original Stability MCC for r=0.6 = 0.982 +- 0.067
Intervened Stability MCC for r=0.6 = 0.576 +- 0.413
Original Stability F1 for r=0.6 = 0.993 +- 0.023
Intervened Stability F1 for r=0.6 = 0.887 +- 0.110
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.506278
Plausibility completed in  0:00:05.091447
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.2199, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5664, device='cuda:1')  +-  tensor(0.2939, device='cuda:1') (0.061)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.2199, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6152, device='cuda:1')  +-  tensor(0.1354, device='cuda:1') (0.080)
Original Stability MCC for r=0.3 = 0.968 +- 0.096
Intervened Stability MCC for r=0.3 = 0.562 +- 0.389
Original Stability F1 for r=0.3 = 0.978 +- 0.063
Intervened Stability F1 for r=0.3 = 0.733 +- 0.217
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.662816
Plausibility completed in  0:00:05.087480
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.2199, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5441, device='cuda:1')  +-  tensor(0.2826, device='cuda:1') (0.054)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.2199, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9170, device='cuda:1')  +-  tensor(0.1008, device='cuda:1') (0.031)
Original Stability MCC for r=0.6 = 0.979 +- 0.071
Intervened Stability MCC for r=0.6 = 0.605 +- 0.413
Original Stability F1 for r=0.6 = 0.993 +- 0.025
Intervened Stability F1 for r=0.6 = 0.894 +- 0.111
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.493275
Plausibility completed in  0:00:05.212727
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4722, device='cuda:1')  +-  tensor(0.1648, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5605, device='cuda:1')  +-  tensor(0.1877, device='cuda:1') (0.052)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4722, device='cuda:1')  +-  tensor(0.1648, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4862, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.059)
Original Stability MCC for r=0.3 = 0.987 +- 0.067
Intervened Stability MCC for r=0.3 = 0.623 +- 0.264
Original Stability F1 for r=0.3 = 0.991 +- 0.043
Intervened Stability F1 for r=0.3 = 0.766 +- 0.160
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.499947
Plausibility completed in  0:00:05.085587
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4724, device='cuda:1')  +-  tensor(0.1648, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5453, device='cuda:1')  +-  tensor(0.1933, device='cuda:1') (0.033)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4724, device='cuda:1')  +-  tensor(0.1648, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8533, device='cuda:1')  +-  tensor(0.0958, device='cuda:1') (0.050)
Original Stability MCC for r=0.6 = 0.985 +- 0.068
Intervened Stability MCC for r=0.6 = 0.573 +- 0.302
Original Stability F1 for r=0.6 = 0.995 +- 0.024
Intervened Stability F1 for r=0.6 = 0.872 +- 0.085
Intervened samples: 799
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:29:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:29:45 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:29:58 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:00 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:02 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:04 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.538
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.539
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.555
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.565
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.413


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.510551
Plausibility completed in  0:00:05.426032
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5387, device='cuda:1')  +-  tensor(0.2580, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5171, device='cuda:1')  +-  tensor(0.3014, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5387, device='cuda:1')  +-  tensor(0.2580, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5628, device='cuda:1')  +-  tensor(0.1100, device='cuda:1') (0.060)
Original Stability MCC for r=0.3 = 0.985 +- 0.050
Intervened Stability MCC for r=0.3 = 0.542 +- 0.357
Original Stability F1 for r=0.3 = 0.990 +- 0.034
Intervened Stability F1 for r=0.3 = 0.719 +- 0.200
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.517282
Plausibility completed in  0:00:05.081888
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5387, device='cuda:1')  +-  tensor(0.2580, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4973, device='cuda:1')  +-  tensor(0.2844, device='cuda:1') (0.045)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5387, device='cuda:1')  +-  tensor(0.2580, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9118, device='cuda:1')  +-  tensor(0.1004, device='cuda:1') (0.030)
Original Stability MCC for r=0.6 = 0.974 +- 0.083
Intervened Stability MCC for r=0.6 = 0.635 +- 0.365
Original Stability F1 for r=0.6 = 0.991 +- 0.029
Intervened Stability F1 for r=0.6 = 0.899 +- 0.099
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.635093
Plausibility completed in  0:00:05.075234
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5642, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5461, device='cuda:1')  +-  tensor(0.3021, device='cuda:1') (0.053)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5642, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5722, device='cuda:1')  +-  tensor(0.1080, device='cuda:1') (0.062)
Original Stability MCC for r=0.3 = 0.980 +- 0.061
Intervened Stability MCC for r=0.3 = 0.554 +- 0.364
Original Stability F1 for r=0.3 = 0.987 +- 0.041
Intervened Stability F1 for r=0.3 = 0.727 +- 0.203
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.657579
Plausibility completed in  0:00:05.258163
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5642, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5276, device='cuda:1')  +-  tensor(0.2868, device='cuda:1') (0.046)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5642, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9214, device='cuda:1')  +-  tensor(0.0987, device='cuda:1') (0.030)
Original Stability MCC for r=0.6 = 0.979 +- 0.073
Intervened Stability MCC for r=0.6 = 0.653 +- 0.363
Original Stability F1 for r=0.6 = 0.992 +- 0.026
Intervened Stability F1 for r=0.6 = 0.905 +- 0.097
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.630010
Plausibility completed in  0:00:05.072063
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4763, device='cuda:1')  +-  tensor(0.1572, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5709, device='cuda:1')  +-  tensor(0.1909, device='cuda:1') (0.055)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4763, device='cuda:1')  +-  tensor(0.1572, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4748, device='cuda:1')  +-  tensor(0.0931, device='cuda:1') (0.051)
Original Stability MCC for r=0.3 = 0.980 +- 0.084
Intervened Stability MCC for r=0.3 = 0.591 +- 0.282
Original Stability F1 for r=0.3 = 0.987 +- 0.054
Intervened Stability F1 for r=0.3 = 0.745 +- 0.174
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.496825
Plausibility completed in  0:00:05.225339
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4767, device='cuda:1')  +-  tensor(0.1572, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5525, device='cuda:1')  +-  tensor(0.1978, device='cuda:1') (0.041)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4767, device='cuda:1')  +-  tensor(0.1572, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8665, device='cuda:1')  +-  tensor(0.0994, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 0.972 +- 0.085
Intervened Stability MCC for r=0.6 = 0.605 +- 0.251
Original Stability F1 for r=0.6 = 0.990 +- 0.031
Intervened Stability F1 for r=0.6 = 0.878 +- 0.074
Intervened samples: 798
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:30:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:30:57 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:10 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:12 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:14 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:15 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:31:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.680
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.755
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.162
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.375


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.667665
Plausibility completed in  0:00:05.120094
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5889, device='cuda:1')  +-  tensor(0.2816, device='cuda:1') (0.100)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7281, device='cuda:1')  +-  tensor(0.1306, device='cuda:1') (0.111)
Original Stability MCC for r=0.3 = 0.947 +- 0.147
Intervened Stability MCC for r=0.3 = 0.634 +- 0.322
Original Stability F1 for r=0.3 = 0.967 +- 0.089
Intervened Stability F1 for r=0.3 = 0.778 +- 0.177
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.516741
Plausibility completed in  0:00:05.261069
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5802, device='cuda:1')  +-  tensor(0.2781, device='cuda:1') (0.083)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9470, device='cuda:1')  +-  tensor(0.0724, device='cuda:1') (0.037)
Original Stability MCC for r=0.6 = 0.990 +- 0.052
Intervened Stability MCC for r=0.6 = 0.571 +- 0.382
Original Stability F1 for r=0.6 = 0.996 +- 0.019
Intervened Stability F1 for r=0.6 = 0.884 +- 0.098
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.508741
Plausibility completed in  0:00:05.087689
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7631, device='cuda:1')  +-  tensor(0.2578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6198, device='cuda:1')  +-  tensor(0.2683, device='cuda:1') (0.107)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7631, device='cuda:1')  +-  tensor(0.2578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7284, device='cuda:1')  +-  tensor(0.1328, device='cuda:1') (0.111)
Original Stability MCC for r=0.3 = 0.945 +- 0.136
Intervened Stability MCC for r=0.3 = 0.644 +- 0.324
Original Stability F1 for r=0.3 = 0.966 +- 0.081
Intervened Stability F1 for r=0.3 = 0.785 +- 0.177
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.663449
Plausibility completed in  0:00:05.094666
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7631, device='cuda:1')  +-  tensor(0.2578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6063, device='cuda:1')  +-  tensor(0.2692, device='cuda:1') (0.083)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7631, device='cuda:1')  +-  tensor(0.2578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9544, device='cuda:1')  +-  tensor(0.0671, device='cuda:1') (0.035)
Original Stability MCC for r=0.6 = 0.991 +- 0.050
Intervened Stability MCC for r=0.6 = 0.603 +- 0.378
Original Stability F1 for r=0.6 = 0.997 +- 0.018
Intervened Stability F1 for r=0.6 = 0.895 +- 0.096
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.635874
Plausibility completed in  0:00:05.063352
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4255, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4946, device='cuda:1')  +-  tensor(0.1934, device='cuda:1') (0.056)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4255, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4836, device='cuda:1')  +-  tensor(0.1001, device='cuda:1') (0.046)
Original Stability MCC for r=0.3 = 0.715 +- 0.317
Intervened Stability MCC for r=0.3 = 0.493 +- 0.295
Original Stability F1 for r=0.3 = 0.826 +- 0.185
Intervened Stability F1 for r=0.3 = 0.699 +- 0.166
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.502966
Plausibility completed in  0:00:05.222614
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4258, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4820, device='cuda:1')  +-  tensor(0.1920, device='cuda:1') (0.042)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4258, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8404, device='cuda:1')  +-  tensor(0.1051, device='cuda:1') (0.031)
Original Stability MCC for r=0.6 = 0.923 +- 0.160
Intervened Stability MCC for r=0.6 = 0.604 +- 0.252
Original Stability F1 for r=0.6 = 0.975 +- 0.051
Intervened Stability F1 for r=0.6 = 0.880 +- 0.072
Intervened samples: 798


DONE GOODMotif - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.65452249 0.65452249] +- [0.08289188 0.08289188] (mean across ratios: 0.655)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.56387932 0.54861423] +- [0.03160296 0.03538707] (mean across ratios: 0.556)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.77016699 0.98024747] +- [0.11053216 0.01115768] (mean across ratios: 0.875)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.66736207 0.93256853] +- [0.06983338 0.01857512] (mean across ratios: 0.800)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.97253002 0.99275185] +- [0.01327675 0.00205449] (mean across ratios: 0.983)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.74899019 0.8913347 ] +- [0.02163868 0.00689459] (mean across ratios: 0.820)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.95727773 0.97994939] +- [0.02117627 0.005717  ] (mean across ratios: 0.969)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.58774072 0.601735  ] +- [0.03386258 0.02902771] (mean across ratios: 0.595)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.68318448 0.68318448] +- [0.08789931 0.08789931] (mean across ratios: 0.683)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.59209988 0.576246  ] +- [0.03095188 0.03359082] (mean across ratios: 0.584)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.76921575 0.98286724] +- [0.10998992 0.01057232] (mean across ratios: 0.876)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.67359124 0.94007928] +- [0.067684   0.01712263] (mean across ratios: 0.807)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.96960369 0.99328226] +- [0.01137316 0.00187042] (mean across ratios: 0.981)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.75669006 0.89877077] +- [0.0227344  0.00741366] (mean across ratios: 0.828)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.95291706 0.98150318] +- [0.01811672 0.00514605] (mean across ratios: 0.967)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.60041807 0.62451446] +- [0.03609706 0.02946498] (mean across ratios: 0.612)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.45497299 0.4553588 ] +- [0.02286769 0.02286639] (mean across ratios: 0.455)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.53688329 0.5214964 ] +- [0.03312687 0.03236721] (mean across ratios: 0.529)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.45943124 0.84613253] +- [0.0277267  0.02923042] (mean across ratios: 0.653)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.48827474 0.86044174] +- [0.01304284 0.01915218] (mean across ratios: 0.674)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.90464592 0.98254713] +- [0.07410779 0.00831175] (mean across ratios: 0.944)
(id) (test) STABILITY_F1_PERTURBED: 	[0.72127802 0.87695135] +- [0.02942483 0.00283045] (mean across ratios: 0.799)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.84456201 0.94744098] +- [0.12169618 0.02631671] (mean across ratios: 0.896)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.54060326 0.5948935 ] +- [0.05676588 0.01159442] (mean across ratios: 0.568)

Overall time of execution:  0:06:02.862491
DONE CIGA GOODMotif/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:32:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:28 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:41 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:43 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:45 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:47 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:32:48 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 41...
[0m[1;37mINFO[0m: [1mCheckpoint 41: 
-----------------------------------
Train ACCURACY: 0.8871
Train Loss: 0.4970
ID Validation ACCURACY: 0.8797
ID Validation Loss: 0.5295
ID Test ACCURACY: 0.8927
ID Test Loss: 0.4823
OOD Validation ACCURACY: 0.4747
OOD Validation Loss: 1.8881
OOD Test ACCURACY: 0.3857
OOD Test Loss: 3.2832

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 2...
[0m[1;37mINFO[0m: [1mCheckpoint 2: 
-----------------------------------
Train ACCURACY: 0.7347
Train Loss: 0.7778
ID Validation ACCURACY: 0.7300
ID Validation Loss: 0.8197
ID Test ACCURACY: 0.7497
ID Test Loss: 0.7641
OOD Validation ACCURACY: 0.9027
OOD Validation Loss: 0.4950
OOD Test ACCURACY: 0.3873
OOD Test Loss: 6.8454

[0m[1;37mINFO[0m: [1mChartInfo 0.8927 0.3857 0.7497 0.3873 0.7300 0.9027[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.682
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.732
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.718
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.767
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.145
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.359


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.702873
Plausibility completed in  0:00:05.151281
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7344, device='cuda:1')  +-  tensor(0.2732, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5634, device='cuda:1')  +-  tensor(0.3242, device='cuda:1') (0.082)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7344, device='cuda:1')  +-  tensor(0.2732, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6471, device='cuda:1')  +-  tensor(0.1501, device='cuda:1') (0.091)
Original Stability MCC for r=0.3 = 0.942 +- 0.147
Intervened Stability MCC for r=0.3 = 0.455 +- 0.374
Original Stability F1 for r=0.3 = 0.963 +- 0.090
Intervened Stability F1 for r=0.3 = 0.696 +- 0.196
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.511925
Plausibility completed in  0:00:05.309158
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7344, device='cuda:1')  +-  tensor(0.2732, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5384, device='cuda:1')  +-  tensor(0.3225, device='cuda:1') (0.050)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7344, device='cuda:1')  +-  tensor(0.2732, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9249, device='cuda:1')  +-  tensor(0.0783, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.977 +- 0.078
Intervened Stability MCC for r=0.6 = 0.314 +- 0.382
Original Stability F1 for r=0.6 = 0.992 +- 0.027
Intervened Stability F1 for r=0.6 = 0.883 +- 0.095
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.498533
Plausibility completed in  0:00:05.137453
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7701, device='cuda:1')  +-  tensor(0.2525, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.3276, device='cuda:1') (0.078)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7701, device='cuda:1')  +-  tensor(0.2525, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6573, device='cuda:1')  +-  tensor(0.1547, device='cuda:1') (0.091)
Original Stability MCC for r=0.3 = 0.939 +- 0.148
Intervened Stability MCC for r=0.3 = 0.474 +- 0.378
Original Stability F1 for r=0.3 = 0.961 +- 0.090
Intervened Stability F1 for r=0.3 = 0.706 +- 0.198
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.652442
Plausibility completed in  0:00:05.129227
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7701, device='cuda:1')  +-  tensor(0.2525, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5637, device='cuda:1')  +-  tensor(0.3221, device='cuda:1') (0.046)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7701, device='cuda:1')  +-  tensor(0.2525, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9335, device='cuda:1')  +-  tensor(0.0771, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 0.979 +- 0.076
Intervened Stability MCC for r=0.6 = 0.316 +- 0.390
Original Stability F1 for r=0.6 = 0.993 +- 0.027
Intervened Stability F1 for r=0.6 = 0.892 +- 0.094
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.620579
Plausibility completed in  0:00:05.119126
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4286, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6307, device='cuda:1')  +-  tensor(0.2146, device='cuda:1') (0.063)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4286, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4842, device='cuda:1')  +-  tensor(0.1172, device='cuda:1') (0.051)
Original Stability MCC for r=0.3 = 0.708 +- 0.315
Intervened Stability MCC for r=0.3 = 0.166 +- 0.335
Original Stability F1 for r=0.3 = 0.821 +- 0.186
Intervened Stability F1 for r=0.3 = 0.545 +- 0.185
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.488936
Plausibility completed in  0:00:05.258836
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4290, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5782, device='cuda:1')  +-  tensor(0.2348, device='cuda:1') (0.023)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4290, device='cuda:1')  +-  tensor(0.1703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8681, device='cuda:1')  +-  tensor(0.1113, device='cuda:1') (0.014)
Original Stability MCC for r=0.6 = 0.918 +- 0.169
Intervened Stability MCC for r=0.6 = 0.272 +- 0.382
Original Stability F1 for r=0.6 = 0.973 +- 0.054
Intervened Stability F1 for r=0.6 = 0.843 +- 0.084
Intervened samples: 798
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:33:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:33:42 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:33:55 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:33:57 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:33:59 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:01 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.9131
Train Loss: 0.4912
ID Validation ACCURACY: 0.9110
ID Validation Loss: 0.5286
ID Test ACCURACY: 0.9127
ID Test Loss: 0.5019
OOD Validation ACCURACY: 0.5887
OOD Validation Loss: 4.5675
OOD Test ACCURACY: 0.3957
OOD Test Loss: 6.2688

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 1...
[0m[1;37mINFO[0m: [1mCheckpoint 1: 
-----------------------------------
Train ACCURACY: 0.5313
Train Loss: 2.0616
ID Validation ACCURACY: 0.5323
ID Validation Loss: 2.1256
ID Test ACCURACY: 0.5313
ID Test Loss: 2.0766
OOD Validation ACCURACY: 0.8873
OOD Validation Loss: 0.6722
OOD Test ACCURACY: 0.3303
OOD Test Loss: 13.4125

[0m[1;37mINFO[0m: [1mChartInfo 0.9127 0.3957 0.5313 0.3303 0.5323 0.8873[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.638
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.693
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.663
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.724
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.154
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.403


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.678643
Plausibility completed in  0:00:05.166930
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6968, device='cuda:1')  +-  tensor(0.2670, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5819, device='cuda:1')  +-  tensor(0.3163, device='cuda:1') (0.083)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6968, device='cuda:1')  +-  tensor(0.2670, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6696, device='cuda:1')  +-  tensor(0.1557, device='cuda:1') (0.102)
Original Stability MCC for r=0.3 = 0.931 +- 0.139
Intervened Stability MCC for r=0.3 = 0.460 +- 0.370
Original Stability F1 for r=0.3 = 0.955 +- 0.086
Intervened Stability F1 for r=0.3 = 0.700 +- 0.187
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.514140
Plausibility completed in  0:00:05.159654
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6968, device='cuda:1')  +-  tensor(0.2670, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5451, device='cuda:1')  +-  tensor(0.3092, device='cuda:1') (0.057)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6968, device='cuda:1')  +-  tensor(0.2670, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9221, device='cuda:1')  +-  tensor(0.0962, device='cuda:1') (0.036)
Original Stability MCC for r=0.6 = 0.980 +- 0.071
Intervened Stability MCC for r=0.6 = 0.367 +- 0.414
Original Stability F1 for r=0.6 = 0.993 +- 0.025
Intervened Stability F1 for r=0.6 = 0.901 +- 0.096
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.633655
Plausibility completed in  0:00:05.127571
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2560, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6111, device='cuda:1')  +-  tensor(0.3138, device='cuda:1') (0.080)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2560, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6762, device='cuda:1')  +-  tensor(0.1603, device='cuda:1') (0.099)
Original Stability MCC for r=0.3 = 0.938 +- 0.130
Intervened Stability MCC for r=0.3 = 0.476 +- 0.362
Original Stability F1 for r=0.3 = 0.960 +- 0.082
Intervened Stability F1 for r=0.3 = 0.709 +- 0.184
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.651717
Plausibility completed in  0:00:05.131321
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2560, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5707, device='cuda:1')  +-  tensor(0.3081, device='cuda:1') (0.054)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7277, device='cuda:1')  +-  tensor(0.2560, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9293, device='cuda:1')  +-  tensor(0.0952, device='cuda:1') (0.034)
Original Stability MCC for r=0.6 = 0.980 +- 0.066
Intervened Stability MCC for r=0.6 = 0.368 +- 0.424
Original Stability F1 for r=0.6 = 0.993 +- 0.024
Intervened Stability F1 for r=0.6 = 0.909 +- 0.095
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.489441
Plausibility completed in  0:00:05.262807
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4723, device='cuda:1')  +-  tensor(0.2016, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7116, device='cuda:1')  +-  tensor(0.2071, device='cuda:1') (0.084)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4723, device='cuda:1')  +-  tensor(0.2016, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4544, device='cuda:1')  +-  tensor(0.1474, device='cuda:1') (0.081)
Original Stability MCC for r=0.3 = 0.842 +- 0.243
Intervened Stability MCC for r=0.3 = 0.150 +- 0.320
Original Stability F1 for r=0.3 = 0.903 +- 0.143
Intervened Stability F1 for r=0.3 = 0.532 +- 0.180
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.496337
Plausibility completed in  0:00:05.116217
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4728, device='cuda:1')  +-  tensor(0.2016, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6508, device='cuda:1')  +-  tensor(0.2504, device='cuda:1') (0.036)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4728, device='cuda:1')  +-  tensor(0.2016, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8784, device='cuda:1')  +-  tensor(0.1316, device='cuda:1') (0.020)
Original Stability MCC for r=0.6 = 0.941 +- 0.143
Intervened Stability MCC for r=0.6 = 0.244 +- 0.389
Original Stability F1 for r=0.6 = 0.981 +- 0.046
Intervened Stability F1 for r=0.6 = 0.839 +- 0.087
Intervened samples: 798
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:34:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:34:54 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:07 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:09 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:11 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:13 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:35:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.8891
Train Loss: 0.4932
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.5131
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4878
OOD Validation ACCURACY: 0.6437
OOD Validation Loss: 0.9073
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.4450

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 76...
[0m[1;37mINFO[0m: [1mCheckpoint 76: 
-----------------------------------
Train ACCURACY: 0.8338
Train Loss: 0.5768
ID Validation ACCURACY: 0.8263
ID Validation Loss: 0.6099
ID Test ACCURACY: 0.8387
ID Test Loss: 0.5514
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.4917
OOD Test ACCURACY: 0.3573
OOD Test Loss: 5.6284

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.3573 0.8387 0.3573 0.8263 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.561
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.559
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.579
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.197
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.424


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.684840
Plausibility completed in  0:00:05.136432
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5716, device='cuda:1')  +-  tensor(0.2181, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5530, device='cuda:1')  +-  tensor(0.3269, device='cuda:1') (0.045)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5716, device='cuda:1')  +-  tensor(0.2181, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5869, device='cuda:1')  +-  tensor(0.1530, device='cuda:1') (0.059)
Original Stability MCC for r=0.3 = 0.977 +- 0.072
Intervened Stability MCC for r=0.3 = 0.427 +- 0.429
Original Stability F1 for r=0.3 = 0.984 +- 0.047
Intervened Stability F1 for r=0.3 = 0.677 +- 0.221
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.519671
Plausibility completed in  0:00:05.291790
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5716, device='cuda:1')  +-  tensor(0.2181, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5242, device='cuda:1')  +-  tensor(0.3186, device='cuda:1') (0.028)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5716, device='cuda:1')  +-  tensor(0.2181, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9100, device='cuda:1')  +-  tensor(0.0994, device='cuda:1') (0.026)
Original Stability MCC for r=0.6 = 0.985 +- 0.056
Intervened Stability MCC for r=0.6 = 0.353 +- 0.426
Original Stability F1 for r=0.6 = 0.995 +- 0.020
Intervened Stability F1 for r=0.6 = 0.898 +- 0.102
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.505477
Plausibility completed in  0:00:05.121520
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.2199, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5839, device='cuda:1')  +-  tensor(0.3288, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.2199, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5965, device='cuda:1')  +-  tensor(0.1540, device='cuda:1') (0.059)
Original Stability MCC for r=0.3 = 0.965 +- 0.099
Intervened Stability MCC for r=0.3 = 0.442 +- 0.438
Original Stability F1 for r=0.3 = 0.976 +- 0.065
Intervened Stability F1 for r=0.3 = 0.688 +- 0.225
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.664330
Plausibility completed in  0:00:05.114832
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.2199, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5526, device='cuda:1')  +-  tensor(0.3217, device='cuda:1') (0.026)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.2199, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9172, device='cuda:1')  +-  tensor(0.1009, device='cuda:1') (0.024)
Original Stability MCC for r=0.6 = 0.979 +- 0.067
Intervened Stability MCC for r=0.6 = 0.363 +- 0.434
Original Stability F1 for r=0.6 = 0.992 +- 0.024
Intervened Stability F1 for r=0.6 = 0.909 +- 0.101
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.495203
Plausibility completed in  0:00:05.243125
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4722, device='cuda:1')  +-  tensor(0.1648, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7160, device='cuda:1')  +-  tensor(0.1927, device='cuda:1') (0.063)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4722, device='cuda:1')  +-  tensor(0.1648, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4483, device='cuda:1')  +-  tensor(0.1261, device='cuda:1') (0.054)
Original Stability MCC for r=0.3 = 0.987 +- 0.066
Intervened Stability MCC for r=0.3 = 0.240 +- 0.328
Original Stability F1 for r=0.3 = 0.992 +- 0.042
Intervened Stability F1 for r=0.3 = 0.576 +- 0.184
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.501522
Plausibility completed in  0:00:05.113370
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4724, device='cuda:1')  +-  tensor(0.1648, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6610, device='cuda:1')  +-  tensor(0.2119, device='cuda:1') (0.031)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4724, device='cuda:1')  +-  tensor(0.1648, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8199, device='cuda:1')  +-  tensor(0.1024, device='cuda:1') (0.031)
Original Stability MCC for r=0.6 = 0.984 +- 0.068
Intervened Stability MCC for r=0.6 = 0.175 +- 0.359
Original Stability F1 for r=0.6 = 0.994 +- 0.024
Intervened Stability F1 for r=0.6 = 0.829 +- 0.074
Intervened samples: 799
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:36:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:07 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:20 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:22 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:24 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:26 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:36:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.8896
Train Loss: 0.4598
ID Validation ACCURACY: 0.8830
ID Validation Loss: 0.4805
ID Test ACCURACY: 0.8977
ID Test Loss: 0.4487
OOD Validation ACCURACY: 0.6967
OOD Validation Loss: 0.9930
OOD Test ACCURACY: 0.3650
OOD Test Loss: 3.7864

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.8446
Train Loss: 0.5273
ID Validation ACCURACY: 0.8417
ID Validation Loss: 0.5506
ID Test ACCURACY: 0.8483
ID Test Loss: 0.5201
OOD Validation ACCURACY: 0.9307
OOD Validation Loss: 0.5280
OOD Test ACCURACY: 0.5647
OOD Test Loss: 1.8408

[0m[1;37mINFO[0m: [1mChartInfo 0.8977 0.3650 0.8483 0.5647 0.8417 0.9307[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.538
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.539
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.556
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.565
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.184
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.412


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.520689
Plausibility completed in  0:00:05.301103
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5387, device='cuda:1')  +-  tensor(0.2580, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5378, device='cuda:1')  +-  tensor(0.3267, device='cuda:1') (0.042)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5387, device='cuda:1')  +-  tensor(0.2580, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5521, device='cuda:1')  +-  tensor(0.1248, device='cuda:1') (0.053)
Original Stability MCC for r=0.3 = 0.983 +- 0.052
Intervened Stability MCC for r=0.3 = 0.397 +- 0.386
Original Stability F1 for r=0.3 = 0.989 +- 0.035
Intervened Stability F1 for r=0.3 = 0.661 +- 0.200
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.510422
Plausibility completed in  0:00:05.106017
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5387, device='cuda:1')  +-  tensor(0.2580, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5164, device='cuda:1')  +-  tensor(0.3163, device='cuda:1') (0.028)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5387, device='cuda:1')  +-  tensor(0.2580, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9094, device='cuda:1')  +-  tensor(0.1008, device='cuda:1') (0.026)
Original Stability MCC for r=0.6 = 0.974 +- 0.085
Intervened Stability MCC for r=0.6 = 0.369 +- 0.422
Original Stability F1 for r=0.6 = 0.991 +- 0.030
Intervened Stability F1 for r=0.6 = 0.900 +- 0.101
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.638715
Plausibility completed in  0:00:05.108113
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5642, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5675, device='cuda:1')  +-  tensor(0.3301, device='cuda:1') (0.042)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5642, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5600, device='cuda:1')  +-  tensor(0.1252, device='cuda:1') (0.052)
Original Stability MCC for r=0.3 = 0.981 +- 0.059
Intervened Stability MCC for r=0.3 = 0.402 +- 0.412
Original Stability F1 for r=0.3 = 0.987 +- 0.040
Intervened Stability F1 for r=0.3 = 0.666 +- 0.211
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.659554
Plausibility completed in  0:00:05.109987
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5642, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5446, device='cuda:1')  +-  tensor(0.3197, device='cuda:1') (0.026)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5642, device='cuda:1')  +-  tensor(0.2636, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9164, device='cuda:1')  +-  tensor(0.1021, device='cuda:1') (0.025)
Original Stability MCC for r=0.6 = 0.981 +- 0.066
Intervened Stability MCC for r=0.6 = 0.372 +- 0.440
Original Stability F1 for r=0.6 = 0.993 +- 0.024
Intervened Stability F1 for r=0.6 = 0.906 +- 0.101
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.633140
Plausibility completed in  0:00:05.099880
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4763, device='cuda:1')  +-  tensor(0.1572, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7322, device='cuda:1')  +-  tensor(0.1887, device='cuda:1') (0.073)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4763, device='cuda:1')  +-  tensor(0.1572, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4322, device='cuda:1')  +-  tensor(0.1351, device='cuda:1') (0.062)
Original Stability MCC for r=0.3 = 0.978 +- 0.085
Intervened Stability MCC for r=0.3 = 0.169 +- 0.354
Original Stability F1 for r=0.3 = 0.986 +- 0.055
Intervened Stability F1 for r=0.3 = 0.536 +- 0.199
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.503228
Plausibility completed in  0:00:05.253954
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4767, device='cuda:1')  +-  tensor(0.1572, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6669, device='cuda:1')  +-  tensor(0.2206, device='cuda:1') (0.039)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4767, device='cuda:1')  +-  tensor(0.1572, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8561, device='cuda:1')  +-  tensor(0.1229, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 0.970 +- 0.090
Intervened Stability MCC for r=0.6 = 0.232 +- 0.363
Original Stability F1 for r=0.6 = 0.989 +- 0.032
Intervened Stability F1 for r=0.6 = 0.838 +- 0.078
Intervened samples: 798
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:37:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:20 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:35 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:37 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:39 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:37:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 42...
[0m[1;37mINFO[0m: [1mCheckpoint 42: 
-----------------------------------
Train ACCURACY: 0.8929
Train Loss: 0.4635
ID Validation ACCURACY: 0.8873
ID Validation Loss: 0.4962
ID Test ACCURACY: 0.8990
ID Test Loss: 0.4417
OOD Validation ACCURACY: 0.4727
OOD Validation Loss: 1.7073
OOD Test ACCURACY: 0.4150
OOD Test Loss: 3.0166

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 0...
[0m[1;37mINFO[0m: [1mCheckpoint 0: 
-----------------------------------
Train ACCURACY: 0.7313
Train Loss: 0.7642
ID Validation ACCURACY: 0.7220
ID Validation Loss: 0.8006
ID Test ACCURACY: 0.7480
ID Test Loss: 0.7468
OOD Validation ACCURACY: 0.9300
OOD Validation Loss: 0.4686
OOD Test ACCURACY: 0.3573
OOD Test Loss: 7.4038

[0m[1;37mINFO[0m: [1mChartInfo 0.8990 0.4150 0.7480 0.3573 0.7220 0.9300[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.680
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.721
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.755
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.162
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.375


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.675050
Plausibility completed in  0:00:05.124787
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5702, device='cuda:1')  +-  tensor(0.3230, device='cuda:1') (0.076)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6693, device='cuda:1')  +-  tensor(0.1522, device='cuda:1') (0.086)
Original Stability MCC for r=0.3 = 0.947 +- 0.147
Intervened Stability MCC for r=0.3 = 0.512 +- 0.374
Original Stability F1 for r=0.3 = 0.967 +- 0.090
Intervened Stability F1 for r=0.3 = 0.728 +- 0.190
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.514029
Plausibility completed in  0:00:05.281431
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5452, device='cuda:1')  +-  tensor(0.3111, device='cuda:1') (0.049)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7312, device='cuda:1')  +-  tensor(0.2742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9274, device='cuda:1')  +-  tensor(0.0772, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 0.991 +- 0.046
Intervened Stability MCC for r=0.6 = 0.294 +- 0.404
Original Stability F1 for r=0.6 = 0.997 +- 0.017
Intervened Stability F1 for r=0.6 = 0.879 +- 0.097
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.504687
Plausibility completed in  0:00:05.098716
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7631, device='cuda:1')  +-  tensor(0.2578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6026, device='cuda:1')  +-  tensor(0.3186, device='cuda:1') (0.077)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7631, device='cuda:1')  +-  tensor(0.2578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6793, device='cuda:1')  +-  tensor(0.1516, device='cuda:1') (0.088)
Original Stability MCC for r=0.3 = 0.950 +- 0.133
Intervened Stability MCC for r=0.3 = 0.522 +- 0.380
Original Stability F1 for r=0.3 = 0.969 +- 0.078
Intervened Stability F1 for r=0.3 = 0.734 +- 0.194
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.661785
Plausibility completed in  0:00:05.106237
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7631, device='cuda:1')  +-  tensor(0.2578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5707, device='cuda:1')  +-  tensor(0.3096, device='cuda:1') (0.048)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7631, device='cuda:1')  +-  tensor(0.2578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9337, device='cuda:1')  +-  tensor(0.0767, device='cuda:1') (0.036)
Original Stability MCC for r=0.6 = 0.990 +- 0.053
Intervened Stability MCC for r=0.6 = 0.288 +- 0.406
Original Stability F1 for r=0.6 = 0.996 +- 0.019
Intervened Stability F1 for r=0.6 = 0.888 +- 0.094
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.629466
Plausibility completed in  0:00:05.090130
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4255, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6298, device='cuda:1')  +-  tensor(0.2160, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4255, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4851, device='cuda:1')  +-  tensor(0.1084, device='cuda:1') (0.055)
Original Stability MCC for r=0.3 = 0.714 +- 0.316
Intervened Stability MCC for r=0.3 = 0.178 +- 0.339
Original Stability F1 for r=0.3 = 0.825 +- 0.185
Intervened Stability F1 for r=0.3 = 0.552 +- 0.185
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.494833
Plausibility completed in  0:00:05.246535
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4258, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5837, device='cuda:1')  +-  tensor(0.2252, device='cuda:1') (0.025)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4258, device='cuda:1')  +-  tensor(0.1674, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8585, device='cuda:1')  +-  tensor(0.1110, device='cuda:1') (0.020)
Original Stability MCC for r=0.6 = 0.924 +- 0.160
Intervened Stability MCC for r=0.6 = 0.241 +- 0.394
Original Stability F1 for r=0.6 = 0.975 +- 0.051
Intervened Stability F1 for r=0.6 = 0.838 +- 0.088
Intervened samples: 798


DONE GOODMotif - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.65452223 0.65452249] +- [0.08289175 0.08289188] (mean across ratios: 0.655)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.56128069 0.53384894] +- [0.01501758 0.01160758] (mean across ratios: 0.548)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.77016699 0.98024747] +- [0.11053216 0.01115768] (mean across ratios: 0.875)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.62502369 0.91876003] +- [0.04734376 0.00760767] (mean across ratios: 0.772)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.97164381 0.99327878] +- [0.01286048 0.00213594] (mean across ratios: 0.982)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.69246151 0.89207227] +- [0.02248669 0.00938442] (mean across ratios: 0.792)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.95593797 0.98145692] +- [0.02054471 0.00598413] (mean across ratios: 0.969)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.45027581 0.33923857] +- [0.0383287  0.02983381] (mean across ratios: 0.395)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.68318448 0.68318448] +- [0.08789931 0.08789931] (mean across ratios: 0.683)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.59115758 0.56045077] +- [0.01510787 0.01032614] (mean across ratios: 0.576)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.76921575 0.98286724] +- [0.10998992 0.01057232] (mean across ratios: 0.876)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.63383549 0.92602975] +- [0.04743954 0.00771042] (mean across ratios: 0.780)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.9707804  0.99341443] +- [0.01018157 0.0014154 ] (mean across ratios: 0.982)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.7005968  0.90066183] +- [0.02277583 0.00913906] (mean across ratios: 0.801)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.95470475 0.98188963] +- [0.01637809 0.00387371] (mean across ratios: 0.968)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.46315318 0.34156755] +- [0.04001578 0.03374501] (mean across ratios: 0.402)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.45497299 0.4553588 ] +- [0.02286769 0.02286639] (mean across ratios: 0.455)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.68407412 0.62810355] +- [0.0444572 0.0388977] (mean across ratios: 0.656)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.45943124 0.84613253] +- [0.0277267  0.02923042] (mean across ratios: 0.653)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.46083368 0.85622228] +- [0.02075339 0.0197985 ] (mean across ratios: 0.659)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.90546569 0.98258637] +- [0.07398235 0.00820283] (mean across ratios: 0.944)
(id) (test) STABILITY_F1_PERTURBED: 	[0.54787908 0.83748149] +- [0.01556591 0.00441862] (mean across ratios: 0.693)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.84593973 0.94742962] +- [0.12144942 0.02592696] (mean across ratios: 0.897)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.18054371 0.2329182 ] +- [0.03111252 0.03173354] (mean across ratios: 0.207)

Overall time of execution:  0:06:06.597083
DONE CIGA GOODMotif/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:38:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:52 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:52 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:52 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:38:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:52 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:38:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.665
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.746
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.680
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.753
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.908
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.958


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.620067
Plausibility completed in  0:00:05.457535
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7406, device='cuda:1')  +-  tensor(0.2520, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6434, device='cuda:1')  +-  tensor(0.2818, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7406, device='cuda:1')  +-  tensor(0.2520, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6706, device='cuda:1')  +-  tensor(0.1642, device='cuda:1') (0.098)
Original Stability MCC for r=0.3 = 0.982 +- 0.065
Intervened Stability MCC for r=0.3 = 0.542 +- 0.386
Original Stability F1 for r=0.3 = 0.988 +- 0.044
Intervened Stability F1 for r=0.3 = 0.719 +- 0.227
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.538362
Plausibility completed in  0:00:05.281424
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7406, device='cuda:1')  +-  tensor(0.2520, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6333, device='cuda:1')  +-  tensor(0.2989, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7406, device='cuda:1')  +-  tensor(0.2520, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8999, device='cuda:1')  +-  tensor(0.1107, device='cuda:1') (0.043)
Original Stability MCC for r=0.6 = 0.985 +- 0.064
Intervened Stability MCC for r=0.6 = 0.462 +- 0.412
Original Stability F1 for r=0.6 = 0.994 +- 0.022
Intervened Stability F1 for r=0.6 = 0.846 +- 0.115
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.664081
Plausibility completed in  0:00:05.432727
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7469, device='cuda:1')  +-  tensor(0.2501, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6488, device='cuda:1')  +-  tensor(0.2759, device='cuda:1') (0.096)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7469, device='cuda:1')  +-  tensor(0.2501, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6791, device='cuda:1')  +-  tensor(0.1684, device='cuda:1') (0.097)
Original Stability MCC for r=0.3 = 0.983 +- 0.060
Intervened Stability MCC for r=0.3 = 0.549 +- 0.375
Original Stability F1 for r=0.3 = 0.989 +- 0.041
Intervened Stability F1 for r=0.3 = 0.724 +- 0.220
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.538019
Plausibility completed in  0:00:05.272200
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7469, device='cuda:1')  +-  tensor(0.2501, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6353, device='cuda:1')  +-  tensor(0.2931, device='cuda:1') (0.064)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7469, device='cuda:1')  +-  tensor(0.2501, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9025, device='cuda:1')  +-  tensor(0.1100, device='cuda:1') (0.044)
Original Stability MCC for r=0.6 = 0.983 +- 0.070
Intervened Stability MCC for r=0.6 = 0.494 +- 0.416
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.853 +- 0.119
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.670702
Plausibility completed in  0:00:05.275778
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9557, device='cuda:1')  +-  tensor(0.0932, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.8276, device='cuda:1')  +-  tensor(0.1670, device='cuda:1') (0.068)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9557, device='cuda:1')  +-  tensor(0.0932, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.8358, device='cuda:1')  +-  tensor(0.1898, device='cuda:1') (0.053)
Original Stability MCC for r=0.3 = 0.986 +- 0.059
Intervened Stability MCC for r=0.3 = 0.706 +- 0.304
Original Stability F1 for r=0.3 = 0.990 +- 0.041
Intervened Stability F1 for r=0.3 = 0.812 +- 0.187
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.696670
Plausibility completed in  0:00:05.285739
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9557, device='cuda:1')  +-  tensor(0.0932, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8242, device='cuda:1')  +-  tensor(0.1702, device='cuda:1') (0.058)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9557, device='cuda:1')  +-  tensor(0.0932, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9298, device='cuda:1')  +-  tensor(0.0909, device='cuda:1') (0.032)
Original Stability MCC for r=0.6 = 0.965 +- 0.078
Intervened Stability MCC for r=0.6 = 0.440 +- 0.312
Original Stability F1 for r=0.6 = 0.987 +- 0.030
Intervened Stability F1 for r=0.6 = 0.827 +- 0.083
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:39:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:39:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.706
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.774
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.724
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.786
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.842
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.846


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.697877
Plausibility completed in  0:00:05.287298
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7713, device='cuda:1')  +-  tensor(0.2401, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6688, device='cuda:1')  +-  tensor(0.3053, device='cuda:1') (0.077)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7713, device='cuda:1')  +-  tensor(0.2401, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6830, device='cuda:1')  +-  tensor(0.1690, device='cuda:1') (0.092)
Original Stability MCC for r=0.3 = 0.985 +- 0.054
Intervened Stability MCC for r=0.3 = 0.497 +- 0.424
Original Stability F1 for r=0.3 = 0.990 +- 0.037
Intervened Stability F1 for r=0.3 = 0.687 +- 0.256
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.538911
Plausibility completed in  0:00:05.274694
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7713, device='cuda:1')  +-  tensor(0.2401, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6481, device='cuda:1')  +-  tensor(0.2989, device='cuda:1') (0.075)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7713, device='cuda:1')  +-  tensor(0.2401, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9034, device='cuda:1')  +-  tensor(0.1173, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 0.989 +- 0.045
Intervened Stability MCC for r=0.6 = 0.610 +- 0.421
Original Stability F1 for r=0.6 = 0.996 +- 0.017
Intervened Stability F1 for r=0.6 = 0.878 +- 0.132
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.666102
Plausibility completed in  0:00:05.267777
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7848, device='cuda:1')  +-  tensor(0.2387, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6762, device='cuda:1')  +-  tensor(0.3010, device='cuda:1') (0.077)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7848, device='cuda:1')  +-  tensor(0.2387, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6934, device='cuda:1')  +-  tensor(0.1701, device='cuda:1') (0.093)
Original Stability MCC for r=0.3 = 0.985 +- 0.052
Intervened Stability MCC for r=0.3 = 0.505 +- 0.416
Original Stability F1 for r=0.3 = 0.990 +- 0.035
Intervened Stability F1 for r=0.3 = 0.692 +- 0.251
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.684088
Plausibility completed in  0:00:05.258665
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7848, device='cuda:1')  +-  tensor(0.2387, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6516, device='cuda:1')  +-  tensor(0.2954, device='cuda:1') (0.075)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7848, device='cuda:1')  +-  tensor(0.2387, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9071, device='cuda:1')  +-  tensor(0.1183, device='cuda:1') (0.035)
Original Stability MCC for r=0.6 = 0.993 +- 0.036
Intervened Stability MCC for r=0.6 = 0.644 +- 0.418
Original Stability F1 for r=0.6 = 0.997 +- 0.014
Intervened Stability F1 for r=0.6 = 0.887 +- 0.133
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.677926
Plausibility completed in  0:00:05.272052
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7883, device='cuda:1')  +-  tensor(0.2411, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7579, device='cuda:1')  +-  tensor(0.2056, device='cuda:1') (0.101)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7883, device='cuda:1')  +-  tensor(0.2411, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7679, device='cuda:1')  +-  tensor(0.2376, device='cuda:1') (0.078)
Original Stability MCC for r=0.3 = 0.988 +- 0.045
Intervened Stability MCC for r=0.3 = 0.341 +- 0.491
Original Stability F1 for r=0.3 = 0.992 +- 0.031
Intervened Stability F1 for r=0.3 = 0.606 +- 0.283
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.696304
Plausibility completed in  0:00:05.274152
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7883, device='cuda:1')  +-  tensor(0.2411, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7723, device='cuda:1')  +-  tensor(0.2321, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7883, device='cuda:1')  +-  tensor(0.2411, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9023, device='cuda:1')  +-  tensor(0.1157, device='cuda:1') (0.025)
Original Stability MCC for r=0.6 = 0.973 +- 0.078
Intervened Stability MCC for r=0.6 = 0.398 +- 0.405
Original Stability F1 for r=0.6 = 0.990 +- 0.030
Intervened Stability F1 for r=0.6 = 0.873 +- 0.116
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:40:45 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:40:45 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.597
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.691
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.596
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.689
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.880
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.750


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.704865
Plausibility completed in  0:00:05.321797
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7029, device='cuda:1')  +-  tensor(0.2250, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6158, device='cuda:1')  +-  tensor(0.2818, device='cuda:1') (0.087)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7029, device='cuda:1')  +-  tensor(0.2250, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6348, device='cuda:1')  +-  tensor(0.1616, device='cuda:1') (0.090)
Original Stability MCC for r=0.3 = 0.993 +- 0.037
Intervened Stability MCC for r=0.3 = 0.410 +- 0.422
Original Stability F1 for r=0.3 = 0.995 +- 0.025
Intervened Stability F1 for r=0.3 = 0.645 +- 0.239
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.761057
Plausibility completed in  0:00:05.346105
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7029, device='cuda:1')  +-  tensor(0.2250, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5946, device='cuda:1')  +-  tensor(0.2816, device='cuda:1') (0.081)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7029, device='cuda:1')  +-  tensor(0.2250, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8525, device='cuda:1')  +-  tensor(0.1230, device='cuda:1') (0.057)
Original Stability MCC for r=0.6 = 0.986 +- 0.059
Intervened Stability MCC for r=0.6 = 0.231 +- 0.380
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.793 +- 0.111
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.523925
Plausibility completed in  0:00:05.251625
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7003, device='cuda:1')  +-  tensor(0.2288, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6082, device='cuda:1')  +-  tensor(0.2769, device='cuda:1') (0.088)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7003, device='cuda:1')  +-  tensor(0.2288, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6308, device='cuda:1')  +-  tensor(0.1562, device='cuda:1') (0.092)
Original Stability MCC for r=0.3 = 0.993 +- 0.035
Intervened Stability MCC for r=0.3 = 0.405 +- 0.413
Original Stability F1 for r=0.3 = 0.995 +- 0.024
Intervened Stability F1 for r=0.3 = 0.640 +- 0.236
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.686151
Plausibility completed in  0:00:05.243092
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7003, device='cuda:1')  +-  tensor(0.2288, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5914, device='cuda:1')  +-  tensor(0.2801, device='cuda:1') (0.082)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7003, device='cuda:1')  +-  tensor(0.2288, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8514, device='cuda:1')  +-  tensor(0.1220, device='cuda:1') (0.059)
Original Stability MCC for r=0.6 = 0.989 +- 0.048
Intervened Stability MCC for r=0.6 = 0.230 +- 0.383
Original Stability F1 for r=0.6 = 0.996 +- 0.017
Intervened Stability F1 for r=0.6 = 0.792 +- 0.110
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.672321
Plausibility completed in  0:00:05.254825
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6909, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6484, device='cuda:1')  +-  tensor(0.1797, device='cuda:1') (0.089)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6909, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6976, device='cuda:1')  +-  tensor(0.2024, device='cuda:1') (0.093)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.312 +- 0.466
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.587 +- 0.275
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.696663
Plausibility completed in  0:00:05.258749
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6909, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6610, device='cuda:1')  +-  tensor(0.2168, device='cuda:1') (0.056)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6909, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8561, device='cuda:1')  +-  tensor(0.1001, device='cuda:1') (0.054)
Original Stability MCC for r=0.6 = 1.000 +- 0.010
Intervened Stability MCC for r=0.6 = 0.322 +- 0.390
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.871 +- 0.106
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:41:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:41:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.849
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.907
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.849
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.908
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.847
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.845


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.682224
Plausibility completed in  0:00:05.264572
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9099, device='cuda:1')  +-  tensor(0.1905, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6752, device='cuda:1')  +-  tensor(0.2559, device='cuda:1') (0.142)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9099, device='cuda:1')  +-  tensor(0.1905, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6837, device='cuda:1')  +-  tensor(0.1702, device='cuda:1') (0.143)
Original Stability MCC for r=0.3 = 0.981 +- 0.077
Intervened Stability MCC for r=0.3 = 0.496 +- 0.378
Original Stability F1 for r=0.3 = 0.987 +- 0.051
Intervened Stability F1 for r=0.3 = 0.686 +- 0.227
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.672348
Plausibility completed in  0:00:05.197186
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9088, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6831, device='cuda:1')  +-  tensor(0.2965, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9088, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8733, device='cuda:1')  +-  tensor(0.1721, device='cuda:1') (0.066)
Original Stability MCC for r=0.6 = 0.982 +- 0.070
Intervened Stability MCC for r=0.6 = 0.301 +- 0.436
Original Stability F1 for r=0.6 = 0.993 +- 0.026
Intervened Stability F1 for r=0.6 = 0.808 +- 0.120
Intervened samples: 790


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.526944
Plausibility completed in  0:00:05.401488
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9111, device='cuda:1')  +-  tensor(0.1800, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6719, device='cuda:1')  +-  tensor(0.2527, device='cuda:1') (0.145)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9111, device='cuda:1')  +-  tensor(0.1800, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6877, device='cuda:1')  +-  tensor(0.1655, device='cuda:1') (0.143)
Original Stability MCC for r=0.3 = 0.979 +- 0.077
Intervened Stability MCC for r=0.3 = 0.484 +- 0.371
Original Stability F1 for r=0.3 = 0.986 +- 0.052
Intervened Stability F1 for r=0.3 = 0.679 +- 0.221
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.513187
Plausibility completed in  0:00:05.194042
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9099, device='cuda:1')  +-  tensor(0.1810, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6888, device='cuda:1')  +-  tensor(0.2905, device='cuda:1') (0.100)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9099, device='cuda:1')  +-  tensor(0.1810, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8767, device='cuda:1')  +-  tensor(0.1701, device='cuda:1') (0.067)
Original Stability MCC for r=0.6 = 0.983 +- 0.067
Intervened Stability MCC for r=0.6 = 0.294 +- 0.438
Original Stability F1 for r=0.6 = 0.994 +- 0.025
Intervened Stability F1 for r=0.6 = 0.806 +- 0.121
Intervened samples: 789


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.672653
Plausibility completed in  0:00:05.251054
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8451, device='cuda:1')  +-  tensor(0.2433, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6294, device='cuda:1')  +-  tensor(0.2130, device='cuda:1') (0.170)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8451, device='cuda:1')  +-  tensor(0.2433, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7962, device='cuda:1')  +-  tensor(0.2073, device='cuda:1') (0.121)
Original Stability MCC for r=0.3 = 0.997 +- 0.020
Intervened Stability MCC for r=0.3 = 0.719 +- 0.374
Original Stability F1 for r=0.3 = 0.998 +- 0.014
Intervened Stability F1 for r=0.3 = 0.822 +- 0.232
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.700698
Plausibility completed in  0:00:05.256793
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8451, device='cuda:1')  +-  tensor(0.2433, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5744, device='cuda:1')  +-  tensor(0.2437, device='cuda:1') (0.120)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8451, device='cuda:1')  +-  tensor(0.2433, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9160, device='cuda:1')  +-  tensor(0.1009, device='cuda:1') (0.046)
Original Stability MCC for r=0.6 = 0.992 +- 0.045
Intervened Stability MCC for r=0.6 = 0.385 +- 0.365
Original Stability F1 for r=0.6 = 0.997 +- 0.018
Intervened Stability F1 for r=0.6 = 0.847 +- 0.101
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:42:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:35 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:35 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:42:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:35 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:42:36 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.661
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.653
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.714
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.900
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.849


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.693084
Plausibility completed in  0:00:05.244541
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7193, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6582, device='cuda:1')  +-  tensor(0.2650, device='cuda:1') (0.109)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7193, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6860, device='cuda:1')  +-  tensor(0.1465, device='cuda:1') (0.115)
Original Stability MCC for r=0.3 = 0.987 +- 0.051
Intervened Stability MCC for r=0.3 = 0.549 +- 0.359
Original Stability F1 for r=0.3 = 0.991 +- 0.035
Intervened Stability F1 for r=0.3 = 0.721 +- 0.210
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.702022
Plausibility completed in  0:00:05.238600
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7193, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6437, device='cuda:1')  +-  tensor(0.2775, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7193, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8721, device='cuda:1')  +-  tensor(0.1076, device='cuda:1') (0.070)
Original Stability MCC for r=0.6 = 0.983 +- 0.066
Intervened Stability MCC for r=0.6 = 0.363 +- 0.403
Original Stability F1 for r=0.6 = 0.994 +- 0.025
Intervened Stability F1 for r=0.6 = 0.816 +- 0.115
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.536169
Plausibility completed in  0:00:05.228112
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7069, device='cuda:1')  +-  tensor(0.2472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6482, device='cuda:1')  +-  tensor(0.2603, device='cuda:1') (0.110)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7069, device='cuda:1')  +-  tensor(0.2472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6870, device='cuda:1')  +-  tensor(0.1440, device='cuda:1') (0.118)
Original Stability MCC for r=0.3 = 0.984 +- 0.064
Intervened Stability MCC for r=0.3 = 0.550 +- 0.355
Original Stability F1 for r=0.3 = 0.989 +- 0.044
Intervened Stability F1 for r=0.3 = 0.721 +- 0.207
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.690023
Plausibility completed in  0:00:05.232840
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7069, device='cuda:1')  +-  tensor(0.2472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6408, device='cuda:1')  +-  tensor(0.2782, device='cuda:1') (0.092)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7069, device='cuda:1')  +-  tensor(0.2472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8782, device='cuda:1')  +-  tensor(0.1074, device='cuda:1') (0.068)
Original Stability MCC for r=0.6 = 0.986 +- 0.060
Intervened Stability MCC for r=0.6 = 0.367 +- 0.408
Original Stability F1 for r=0.6 = 0.995 +- 0.022
Intervened Stability F1 for r=0.6 = 0.817 +- 0.117
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.684197
Plausibility completed in  0:00:05.237157
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8275, device='cuda:1')  +-  tensor(0.1853, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.8016, device='cuda:1')  +-  tensor(0.1315, device='cuda:1') (0.121)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8275, device='cuda:1')  +-  tensor(0.1853, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.8414, device='cuda:1')  +-  tensor(0.1314, device='cuda:1') (0.107)
Original Stability MCC for r=0.3 = 0.997 +- 0.022
Intervened Stability MCC for r=0.3 = 0.678 +- 0.266
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.793 +- 0.168
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.546896
Plausibility completed in  0:00:05.413286
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8275, device='cuda:1')  +-  tensor(0.1853, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7338, device='cuda:1')  +-  tensor(0.1684, device='cuda:1') (0.111)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8275, device='cuda:1')  +-  tensor(0.1853, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9385, device='cuda:1')  +-  tensor(0.0631, device='cuda:1') (0.057)
Original Stability MCC for r=0.6 = 0.990 +- 0.042
Intervened Stability MCC for r=0.6 = 0.362 +- 0.397
Original Stability F1 for r=0.6 = 0.996 +- 0.016
Intervened Stability F1 for r=0.6 = 0.842 +- 0.104
Intervened samples: 800


DONE GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.76880897 0.76858095] +- [0.0741797  0.07374604] (mean across ratios: 0.769)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.65228564 0.64056724] +- [0.02116312 0.02843972] (mean across ratios: 0.646)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.80992396 0.98357816] +- [0.05652441 0.00682744] (mean across ratios: 0.897)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.67161497 0.88023317] +- [0.01917837 0.01902705] (mean across ratios: 0.776)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99025977 0.99447885] +- [0.00288021 0.00088496] (mean across ratios: 0.992)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.69153483 0.82813338] +- [0.02750059 0.030408  ] (mean across ratios: 0.760)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98567539 0.98505858] +- [0.00429615 0.0023911 ] (mean across ratios: 0.985)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.49864017 0.39319167] +- [0.04952364 0.1323051 ] (mean across ratios: 0.446)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.77001898 0.76977112] +- [0.0768029  0.07634782] (mean across ratios: 0.770)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.6506552 0.6415517] +- [0.02413476 0.03126532] (mean across ratios: 0.646)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.81425823 0.98499086] +- [0.05392117 0.00631582] (mean across ratios: 0.900)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.67558662 0.88320457] +- [0.02285374 0.02012326] (mean across ratios: 0.779)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.98964901 0.99519083] +- [0.00298191 0.00129049] (mean across ratios: 0.992)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.69101815 0.83104404] +- [0.0307079  0.03458122] (mean across ratios: 0.761)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.98482352 0.98696183] +- [0.00440775 0.00361819] (mean across ratios: 0.986)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.49869342 0.40587192] +- [0.05345836 0.14799882] (mean across ratios: 0.452)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.82151073 0.82151073] +- [0.08572846 0.08572846] (mean across ratios: 0.822)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.73297832 0.71312264] +- [0.08020663 0.08745386] (mean across ratios: 0.723)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.82092077 0.95336848] +- [0.07252763 0.04534107] (mean across ratios: 0.887)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.78776537 0.90851877] +- [0.05250299 0.02895678] (mean across ratios: 0.848)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99550298 0.99377792] +- [0.00387616 0.00491092] (mean across ratios: 0.995)
(id) (test) STABILITY_F1_PERTURBED: 	[0.72430781 0.85214876] +- [0.10481428 0.01777346] (mean across ratios: 0.788)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99348603 0.98378336] +- [0.00560412 0.01279588] (mean across ratios: 0.989)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.55110633 0.38134783] +- [0.18403336 0.03890477] (mean across ratios: 0.466)

Overall time of execution:  0:04:40.518134
DONE LECI GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:43:49 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:43:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.665
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.746
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.680
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.753
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.908
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.958


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.572534
Plausibility completed in  0:00:05.334807
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7406, device='cuda:1')  +-  tensor(0.2520, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6421, device='cuda:1')  +-  tensor(0.3041, device='cuda:1') (0.076)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7406, device='cuda:1')  +-  tensor(0.2520, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6618, device='cuda:1')  +-  tensor(0.1768, device='cuda:1') (0.080)
Original Stability MCC for r=0.3 = 0.986 +- 0.055
Intervened Stability MCC for r=0.3 = 0.442 +- 0.441
Original Stability F1 for r=0.3 = 0.991 +- 0.037
Intervened Stability F1 for r=0.3 = 0.683 +- 0.240
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.693514
Plausibility completed in  0:00:05.143382
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7406, device='cuda:1')  +-  tensor(0.2520, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5884, device='cuda:1')  +-  tensor(0.3173, device='cuda:1') (0.044)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7406, device='cuda:1')  +-  tensor(0.2520, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9030, device='cuda:1')  +-  tensor(0.1099, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 0.986 +- 0.064
Intervened Stability MCC for r=0.6 = 0.326 +- 0.409
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.893 +- 0.116
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.661823
Plausibility completed in  0:00:05.300727
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7469, device='cuda:1')  +-  tensor(0.2501, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6381, device='cuda:1')  +-  tensor(0.3003, device='cuda:1') (0.081)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7469, device='cuda:1')  +-  tensor(0.2501, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6650, device='cuda:1')  +-  tensor(0.1725, device='cuda:1') (0.083)
Original Stability MCC for r=0.3 = 0.982 +- 0.068
Intervened Stability MCC for r=0.3 = 0.446 +- 0.434
Original Stability F1 for r=0.3 = 0.988 +- 0.046
Intervened Stability F1 for r=0.3 = 0.684 +- 0.235
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.532987
Plausibility completed in  0:00:05.153348
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7469, device='cuda:1')  +-  tensor(0.2501, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5789, device='cuda:1')  +-  tensor(0.3097, device='cuda:1') (0.047)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7469, device='cuda:1')  +-  tensor(0.2501, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9055, device='cuda:1')  +-  tensor(0.1102, device='cuda:1') (0.028)
Original Stability MCC for r=0.6 = 0.984 +- 0.067
Intervened Stability MCC for r=0.6 = 0.353 +- 0.422
Original Stability F1 for r=0.6 = 0.994 +- 0.022
Intervened Stability F1 for r=0.6 = 0.893 +- 0.116
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.674245
Plausibility completed in  0:00:05.140153
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9557, device='cuda:1')  +-  tensor(0.0932, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.8253, device='cuda:1')  +-  tensor(0.0942, device='cuda:1') (0.135)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9557, device='cuda:1')  +-  tensor(0.0932, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.8673, device='cuda:1')  +-  tensor(0.1252, device='cuda:1') (0.103)
Original Stability MCC for r=0.3 = 0.987 +- 0.057
Intervened Stability MCC for r=0.3 = 0.689 +- 0.302
Original Stability F1 for r=0.3 = 0.991 +- 0.039
Intervened Stability F1 for r=0.3 = 0.823 +- 0.157
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.692758
Plausibility completed in  0:00:05.142957
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9557, device='cuda:1')  +-  tensor(0.0932, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7682, device='cuda:1')  +-  tensor(0.1169, device='cuda:1') (0.106)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9557, device='cuda:1')  +-  tensor(0.0932, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9827, device='cuda:1')  +-  tensor(0.0229, device='cuda:1') (0.017)
Original Stability MCC for r=0.6 = 0.962 +- 0.082
Intervened Stability MCC for r=0.6 = 0.261 +- 0.354
Original Stability F1 for r=0.6 = 0.985 +- 0.032
Intervened Stability F1 for r=0.6 = 0.861 +- 0.084
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:44:44 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:44:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.706
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.774
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.724
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.786
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.842
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.846


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.697539
Plausibility completed in  0:00:05.149886
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7713, device='cuda:1')  +-  tensor(0.2401, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6299, device='cuda:1')  +-  tensor(0.3155, device='cuda:1') (0.070)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7713, device='cuda:1')  +-  tensor(0.2401, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6327, device='cuda:1')  +-  tensor(0.1664, device='cuda:1') (0.083)
Original Stability MCC for r=0.3 = 0.987 +- 0.052
Intervened Stability MCC for r=0.3 = 0.368 +- 0.462
Original Stability F1 for r=0.3 = 0.991 +- 0.035
Intervened Stability F1 for r=0.3 = 0.635 +- 0.264
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.537632
Plausibility completed in  0:00:05.148317
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7713, device='cuda:1')  +-  tensor(0.2401, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6003, device='cuda:1')  +-  tensor(0.3191, device='cuda:1') (0.054)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7713, device='cuda:1')  +-  tensor(0.2401, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9007, device='cuda:1')  +-  tensor(0.1112, device='cuda:1') (0.037)
Original Stability MCC for r=0.6 = 0.989 +- 0.044
Intervened Stability MCC for r=0.6 = 0.370 +- 0.450
Original Stability F1 for r=0.6 = 0.996 +- 0.016
Intervened Stability F1 for r=0.6 = 0.889 +- 0.122
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.660778
Plausibility completed in  0:00:05.123890
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7848, device='cuda:1')  +-  tensor(0.2387, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6230, device='cuda:1')  +-  tensor(0.3111, device='cuda:1') (0.072)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7848, device='cuda:1')  +-  tensor(0.2387, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6351, device='cuda:1')  +-  tensor(0.1666, device='cuda:1') (0.084)
Original Stability MCC for r=0.3 = 0.988 +- 0.045
Intervened Stability MCC for r=0.3 = 0.381 +- 0.457
Original Stability F1 for r=0.3 = 0.992 +- 0.031
Intervened Stability F1 for r=0.3 = 0.641 +- 0.259
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.687909
Plausibility completed in  0:00:05.133092
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7848, device='cuda:1')  +-  tensor(0.2387, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5911, device='cuda:1')  +-  tensor(0.3120, device='cuda:1') (0.056)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7848, device='cuda:1')  +-  tensor(0.2387, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9037, device='cuda:1')  +-  tensor(0.1133, device='cuda:1') (0.034)
Original Stability MCC for r=0.6 = 0.994 +- 0.034
Intervened Stability MCC for r=0.6 = 0.405 +- 0.458
Original Stability F1 for r=0.6 = 0.998 +- 0.013
Intervened Stability F1 for r=0.6 = 0.893 +- 0.122
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.675732
Plausibility completed in  0:00:05.125987
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7883, device='cuda:1')  +-  tensor(0.2411, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.8177, device='cuda:1')  +-  tensor(0.1014, device='cuda:1') (0.135)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7883, device='cuda:1')  +-  tensor(0.2411, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7888, device='cuda:1')  +-  tensor(0.1156, device='cuda:1') (0.125)
Original Stability MCC for r=0.3 = 0.989 +- 0.041
Intervened Stability MCC for r=0.3 = 0.363 +- 0.293
Original Stability F1 for r=0.3 = 0.992 +- 0.029
Intervened Stability F1 for r=0.3 = 0.647 +- 0.165
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.698780
Plausibility completed in  0:00:05.136787
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7883, device='cuda:1')  +-  tensor(0.2411, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8631, device='cuda:1')  +-  tensor(0.1312, device='cuda:1') (0.069)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7883, device='cuda:1')  +-  tensor(0.2411, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9835, device='cuda:1')  +-  tensor(0.0269, device='cuda:1') (0.017)
Original Stability MCC for r=0.6 = 0.972 +- 0.078
Intervened Stability MCC for r=0.6 = 0.025 +- 0.197
Original Stability F1 for r=0.6 = 0.989 +- 0.030
Intervened Stability F1 for r=0.6 = 0.976 +- 0.035
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:45:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:45:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.597
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.690
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.596
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.689
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.880
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.750


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.694615
Plausibility completed in  0:00:05.139305
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7029, device='cuda:1')  +-  tensor(0.2250, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6262, device='cuda:1')  +-  tensor(0.3099, device='cuda:1') (0.066)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7029, device='cuda:1')  +-  tensor(0.2250, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6227, device='cuda:1')  +-  tensor(0.1869, device='cuda:1') (0.069)
Original Stability MCC for r=0.3 = 0.992 +- 0.040
Intervened Stability MCC for r=0.3 = 0.313 +- 0.443
Original Stability F1 for r=0.3 = 0.995 +- 0.027
Intervened Stability F1 for r=0.3 = 0.609 +- 0.246
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.691447
Plausibility completed in  0:00:05.127849
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7029, device='cuda:1')  +-  tensor(0.2250, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6170, device='cuda:1')  +-  tensor(0.3168, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7029, device='cuda:1')  +-  tensor(0.2250, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8756, device='cuda:1')  +-  tensor(0.1212, device='cuda:1') (0.040)
Original Stability MCC for r=0.6 = 0.989 +- 0.052
Intervened Stability MCC for r=0.6 = 0.111 +- 0.287
Original Stability F1 for r=0.6 = 0.996 +- 0.018
Intervened Stability F1 for r=0.6 = 0.848 +- 0.112
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.527041
Plausibility completed in  0:00:05.111936
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7003, device='cuda:1')  +-  tensor(0.2288, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6220, device='cuda:1')  +-  tensor(0.3046, device='cuda:1') (0.069)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7003, device='cuda:1')  +-  tensor(0.2288, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6218, device='cuda:1')  +-  tensor(0.1843, device='cuda:1') (0.071)
Original Stability MCC for r=0.3 = 0.993 +- 0.034
Intervened Stability MCC for r=0.3 = 0.329 +- 0.436
Original Stability F1 for r=0.3 = 0.995 +- 0.023
Intervened Stability F1 for r=0.3 = 0.615 +- 0.243
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.684070
Plausibility completed in  0:00:05.108867
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7003, device='cuda:1')  +-  tensor(0.2288, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6128, device='cuda:1')  +-  tensor(0.3157, device='cuda:1') (0.055)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7003, device='cuda:1')  +-  tensor(0.2288, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8769, device='cuda:1')  +-  tensor(0.1191, device='cuda:1') (0.040)
Original Stability MCC for r=0.6 = 0.986 +- 0.060
Intervened Stability MCC for r=0.6 = 0.123 +- 0.302
Original Stability F1 for r=0.6 = 0.995 +- 0.022
Intervened Stability F1 for r=0.6 = 0.845 +- 0.109
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.667426
Plausibility completed in  0:00:05.106899
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6909, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7390, device='cuda:1')  +-  tensor(0.1167, device='cuda:1') (0.137)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6909, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7622, device='cuda:1')  +-  tensor(0.0879, device='cuda:1') (0.133)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.460 +- 0.371
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.705 +- 0.199
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.694278
Plausibility completed in  0:00:05.112019
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6909, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8613, device='cuda:1')  +-  tensor(0.1745, device='cuda:1') (0.030)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6909, device='cuda:1')  +-  tensor(0.2704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9821, device='cuda:1')  +-  tensor(0.0446, device='cuda:1') (0.008)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.014 +- 0.203
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.967 +- 0.056
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:46:32 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:46:32 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.849
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.907
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.849
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.908
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.847
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.845


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.691030
Plausibility completed in  0:00:05.146116
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9099, device='cuda:1')  +-  tensor(0.1905, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6223, device='cuda:1')  +-  tensor(0.3012, device='cuda:1') (0.115)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9099, device='cuda:1')  +-  tensor(0.1905, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6231, device='cuda:1')  +-  tensor(0.1702, device='cuda:1') (0.115)
Original Stability MCC for r=0.3 = 0.982 +- 0.070
Intervened Stability MCC for r=0.3 = 0.390 +- 0.426
Original Stability F1 for r=0.3 = 0.988 +- 0.048
Intervened Stability F1 for r=0.3 = 0.643 +- 0.244
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.678234
Plausibility completed in  0:00:05.081339
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9088, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6383, device='cuda:1')  +-  tensor(0.3205, device='cuda:1') (0.077)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9088, device='cuda:1')  +-  tensor(0.1914, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8717, device='cuda:1')  +-  tensor(0.1756, device='cuda:1') (0.052)
Original Stability MCC for r=0.6 = 0.985 +- 0.058
Intervened Stability MCC for r=0.6 = 0.074 +- 0.312
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.850 +- 0.125
Intervened samples: 790


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.537077
Plausibility completed in  0:00:05.278227
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9111, device='cuda:1')  +-  tensor(0.1800, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6145, device='cuda:1')  +-  tensor(0.3002, device='cuda:1') (0.116)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.9111, device='cuda:1')  +-  tensor(0.1800, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6236, device='cuda:1')  +-  tensor(0.1683, device='cuda:1') (0.117)
Original Stability MCC for r=0.3 = 0.977 +- 0.081
Intervened Stability MCC for r=0.3 = 0.375 +- 0.420
Original Stability F1 for r=0.3 = 0.984 +- 0.055
Intervened Stability F1 for r=0.3 = 0.634 +- 0.239
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.517497
Plausibility completed in  0:00:05.079397
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9099, device='cuda:1')  +-  tensor(0.1810, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6417, device='cuda:1')  +-  tensor(0.3222, device='cuda:1') (0.083)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.9099, device='cuda:1')  +-  tensor(0.1810, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8716, device='cuda:1')  +-  tensor(0.1757, device='cuda:1') (0.053)
Original Stability MCC for r=0.6 = 0.985 +- 0.058
Intervened Stability MCC for r=0.6 = 0.059 +- 0.304
Original Stability F1 for r=0.6 = 0.995 +- 0.021
Intervened Stability F1 for r=0.6 = 0.845 +- 0.121
Intervened samples: 789


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.680456
Plausibility completed in  0:00:05.122069
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8451, device='cuda:1')  +-  tensor(0.2433, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6201, device='cuda:1')  +-  tensor(0.2203, device='cuda:1') (0.164)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8451, device='cuda:1')  +-  tensor(0.2433, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.8060, device='cuda:1')  +-  tensor(0.1580, device='cuda:1') (0.125)
Original Stability MCC for r=0.3 = 0.997 +- 0.018
Intervened Stability MCC for r=0.3 = 0.667 +- 0.389
Original Stability F1 for r=0.3 = 0.998 +- 0.013
Intervened Stability F1 for r=0.3 = 0.815 +- 0.201
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.706141
Plausibility completed in  0:00:05.131135
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8451, device='cuda:1')  +-  tensor(0.2433, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6036, device='cuda:1')  +-  tensor(0.2028, device='cuda:1') (0.110)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8451, device='cuda:1')  +-  tensor(0.2433, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9320, device='cuda:1')  +-  tensor(0.0539, device='cuda:1') (0.052)
Original Stability MCC for r=0.6 = 0.992 +- 0.044
Intervened Stability MCC for r=0.6 = -0.068 +- 0.168
Original Stability F1 for r=0.6 = 0.997 +- 0.017
Intervened Stability F1 for r=0.6 = 0.871 +- 0.078
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:47:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:47:25 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.661
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.726
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.652
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.714
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.900
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.849


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.693999
Plausibility completed in  0:00:05.117612
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7193, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6288, device='cuda:1')  +-  tensor(0.2868, device='cuda:1') (0.100)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7193, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6404, device='cuda:1')  +-  tensor(0.1540, device='cuda:1') (0.096)
Original Stability MCC for r=0.3 = 0.983 +- 0.063
Intervened Stability MCC for r=0.3 = 0.421 +- 0.435
Original Stability F1 for r=0.3 = 0.988 +- 0.043
Intervened Stability F1 for r=0.3 = 0.674 +- 0.223
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.704528
Plausibility completed in  0:00:05.118641
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7193, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6212, device='cuda:1')  +-  tensor(0.3014, device='cuda:1') (0.063)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7193, device='cuda:1')  +-  tensor(0.2455, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8795, device='cuda:1')  +-  tensor(0.1211, device='cuda:1') (0.046)
Original Stability MCC for r=0.6 = 0.985 +- 0.062
Intervened Stability MCC for r=0.6 = 0.119 +- 0.297
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.848 +- 0.115
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.532062
Plausibility completed in  0:00:05.094411
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7069, device='cuda:1')  +-  tensor(0.2472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6245, device='cuda:1')  +-  tensor(0.2853, device='cuda:1') (0.101)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7069, device='cuda:1')  +-  tensor(0.2472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6467, device='cuda:1')  +-  tensor(0.1550, device='cuda:1') (0.099)
Original Stability MCC for r=0.3 = 0.979 +- 0.076
Intervened Stability MCC for r=0.3 = 0.435 +- 0.431
Original Stability F1 for r=0.3 = 0.986 +- 0.052
Intervened Stability F1 for r=0.3 = 0.680 +- 0.220
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.695748
Plausibility completed in  0:00:05.104150
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7069, device='cuda:1')  +-  tensor(0.2472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6082, device='cuda:1')  +-  tensor(0.2970, device='cuda:1') (0.066)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7069, device='cuda:1')  +-  tensor(0.2472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8843, device='cuda:1')  +-  tensor(0.1195, device='cuda:1') (0.048)
Original Stability MCC for r=0.6 = 0.984 +- 0.063
Intervened Stability MCC for r=0.6 = 0.137 +- 0.313
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.849 +- 0.113
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.682875
Plausibility completed in  0:00:05.099168
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8275, device='cuda:1')  +-  tensor(0.1853, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6985, device='cuda:1')  +-  tensor(0.1197, device='cuda:1') (0.131)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.8275, device='cuda:1')  +-  tensor(0.1853, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7668, device='cuda:1')  +-  tensor(0.1212, device='cuda:1') (0.123)
Original Stability MCC for r=0.3 = 0.998 +- 0.015
Intervened Stability MCC for r=0.3 = 0.503 +- 0.358
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.717 +- 0.190
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.539062
Plausibility completed in  0:00:05.267833
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8275, device='cuda:1')  +-  tensor(0.1853, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6314, device='cuda:1')  +-  tensor(0.1282, device='cuda:1') (0.038)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.8275, device='cuda:1')  +-  tensor(0.1853, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9681, device='cuda:1')  +-  tensor(0.0535, device='cuda:1') (0.022)
Original Stability MCC for r=0.6 = 0.988 +- 0.045
Intervened Stability MCC for r=0.6 = 0.036 +- 0.213
Original Stability F1 for r=0.6 = 0.996 +- 0.017
Intervened Stability F1 for r=0.6 = 0.878 +- 0.080
Intervened samples: 800


DONE GOODMotif2 - LECIGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.76880897 0.76858095] +- [0.0741797  0.07374604] (mean across ratios: 0.769)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.62986773 0.61305904] +- [0.00665314 0.01726289] (mean across ratios: 0.621)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.80992396 0.98357816] +- [0.05652441 0.00682744] (mean across ratios: 0.897)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.63614093 0.88611184] +- [0.01442103 0.01310849] (mean across ratios: 0.761)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99050788 0.99520364] +- [0.00239985 0.00066698] (mean across ratios: 0.993)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.6487487 0.8656757] +- [0.0269722  0.02098075] (mean across ratios: 0.757)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98610523 0.98690602] +- [0.00350106 0.00186457] (mean across ratios: 0.987)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.38698273 0.1999548 ] +- [0.04457965 0.12250455] (mean across ratios: 0.293)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.77001898 0.76977112] +- [0.0768029  0.07634782] (mean across ratios: 0.770)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.62442044 0.60654937] +- [0.0076451  0.02135818] (mean across ratios: 0.615)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.81425823 0.98499086] +- [0.05392117 0.00631582] (mean across ratios: 0.900)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.63842381 0.88840039] +- [0.01602147 0.01385048] (mean across ratios: 0.763)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.98896816 0.99513794] +- [0.00394515 0.00127654] (mean across ratios: 0.992)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.6508917  0.86496357] +- [0.02694362 0.02298381] (mean across ratios: 0.758)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.98385681 0.98675644] +- [0.00578301 0.00354967] (mean across ratios: 0.985)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.3934017  0.21554392] +- [0.042732   0.13728534] (mean across ratios: 0.304)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.82151073 0.82151073] +- [0.08572846 0.08572846] (mean across ratios: 0.822)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.74011022 0.74550412] +- [0.07669637 0.11035954] (mean across ratios: 0.743)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.82092077 0.95336848] +- [0.07252763 0.04534107] (mean across ratios: 0.887)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.79820195 0.96967298] +- [0.03797767 0.01968435] (mean across ratios: 0.884)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99597938 0.99336485] +- [0.00372133 0.0053561 ] (mean across ratios: 0.995)
(id) (test) STABILITY_F1_PERTURBED: 	[0.74159552 0.91052238] +- [0.06754524 0.05015578] (mean across ratios: 0.826)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99418116 0.98270806] +- [0.00537833 0.0139477 ] (mean across ratios: 0.988)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.53627189 0.05372704] +- [0.12425845 0.11004868] (mean across ratios: 0.295)

Overall time of execution:  0:04:30.283581
DONE LECI GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:48:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:48:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.606
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.629
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.601
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.628
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.106
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.229


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.586745
Plausibility completed in  0:00:05.534860
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6114, device='cuda:1')  +-  tensor(0.2839, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5140, device='cuda:1')  +-  tensor(0.2716, device='cuda:1') (0.093)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6114, device='cuda:1')  +-  tensor(0.2839, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5344, device='cuda:1')  +-  tensor(0.1073, device='cuda:1') (0.106)
Original Stability MCC for r=0.3 = 0.886 +- 0.197
Intervened Stability MCC for r=0.3 = 0.376 +- 0.419
Original Stability F1 for r=0.3 = 0.925 +- 0.124
Intervened Stability F1 for r=0.3 = 0.617 +- 0.249
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.524320
Plausibility completed in  0:00:05.257999
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6116, device='cuda:1')  +-  tensor(0.2866, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4800, device='cuda:1')  +-  tensor(0.2546, device='cuda:1') (0.068)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6116, device='cuda:1')  +-  tensor(0.2866, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8663, device='cuda:1')  +-  tensor(0.1617, device='cuda:1') (0.042)
Original Stability MCC for r=0.6 = 0.957 +- 0.095
Intervened Stability MCC for r=0.6 = 0.525 +- 0.390
Original Stability F1 for r=0.6 = 0.984 +- 0.035
Intervened Stability F1 for r=0.6 = 0.862 +- 0.111
Intervened samples: 785


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.675269
Plausibility completed in  0:00:05.349209
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6092, device='cuda:1')  +-  tensor(0.2811, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5048, device='cuda:1')  +-  tensor(0.2690, device='cuda:1') (0.094)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6092, device='cuda:1')  +-  tensor(0.2811, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5434, device='cuda:1')  +-  tensor(0.1118, device='cuda:1') (0.107)
Original Stability MCC for r=0.3 = 0.887 +- 0.198
Intervened Stability MCC for r=0.3 = 0.374 +- 0.420
Original Stability F1 for r=0.3 = 0.926 +- 0.124
Intervened Stability F1 for r=0.3 = 0.615 +- 0.250
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.676096
Plausibility completed in  0:00:05.265752
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6093, device='cuda:1')  +-  tensor(0.2832, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4762, device='cuda:1')  +-  tensor(0.2521, device='cuda:1') (0.069)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6093, device='cuda:1')  +-  tensor(0.2832, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8735, device='cuda:1')  +-  tensor(0.1535, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.960 +- 0.089
Intervened Stability MCC for r=0.6 = 0.532 +- 0.386
Original Stability F1 for r=0.6 = 0.985 +- 0.033
Intervened Stability F1 for r=0.6 = 0.865 +- 0.109
Intervened samples: 788


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.546714
Plausibility completed in  0:00:05.484056
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2556, device='cuda:1')  +-  tensor(0.1261, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3196, device='cuda:1')  +-  tensor(0.1768, device='cuda:1') (0.062)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2556, device='cuda:1')  +-  tensor(0.1261, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4086, device='cuda:1')  +-  tensor(0.0566, device='cuda:1') (0.040)
Original Stability MCC for r=0.3 = 0.494 +- 0.244
Intervened Stability MCC for r=0.3 = 0.369 +- 0.300
Original Stability F1 for r=0.3 = 0.678 +- 0.141
Intervened Stability F1 for r=0.3 = 0.613 +- 0.172
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.554924
Plausibility completed in  0:00:05.355021
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2556, device='cuda:1')  +-  tensor(0.1261, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3012, device='cuda:1')  +-  tensor(0.1510, device='cuda:1') (0.040)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2556, device='cuda:1')  +-  tensor(0.1261, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7211, device='cuda:1')  +-  tensor(0.0543, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.661 +- 0.439
Intervened Stability MCC for r=0.6 = 0.446 +- 0.381
Original Stability F1 for r=0.6 = 0.876 +- 0.159
Intervened Stability F1 for r=0.6 = 0.831 +- 0.111
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:49:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:49:35 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.519
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.470
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.502
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.266
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.306


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.544938
Plausibility completed in  0:00:05.501069
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5178, device='cuda:1')  +-  tensor(0.2652, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5120, device='cuda:1')  +-  tensor(0.2745, device='cuda:1') (0.062)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5178, device='cuda:1')  +-  tensor(0.2652, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6547, device='cuda:1')  +-  tensor(0.1349, device='cuda:1') (0.075)
Original Stability MCC for r=0.3 = 0.972 +- 0.075
Intervened Stability MCC for r=0.3 = 0.623 +- 0.312
Original Stability F1 for r=0.3 = 0.981 +- 0.051
Intervened Stability F1 for r=0.3 = 0.767 +- 0.179
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.547971
Plausibility completed in  0:00:05.334809
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5178, device='cuda:1')  +-  tensor(0.2652, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5087, device='cuda:1')  +-  tensor(0.2731, device='cuda:1') (0.033)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5178, device='cuda:1')  +-  tensor(0.2652, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9355, device='cuda:1')  +-  tensor(0.0866, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.978 +- 0.078
Intervened Stability MCC for r=0.6 = 0.594 +- 0.374
Original Stability F1 for r=0.6 = 0.992 +- 0.028
Intervened Stability F1 for r=0.6 = 0.892 +- 0.099
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.674384
Plausibility completed in  0:00:05.324739
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4998, device='cuda:1')  +-  tensor(0.2504, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4980, device='cuda:1')  +-  tensor(0.2709, device='cuda:1') (0.059)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4998, device='cuda:1')  +-  tensor(0.2504, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6458, device='cuda:1')  +-  tensor(0.1273, device='cuda:1') (0.074)
Original Stability MCC for r=0.3 = 0.975 +- 0.073
Intervened Stability MCC for r=0.3 = 0.630 +- 0.313
Original Stability F1 for r=0.3 = 0.983 +- 0.050
Intervened Stability F1 for r=0.3 = 0.770 +- 0.180
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.701698
Plausibility completed in  0:00:05.318432
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4998, device='cuda:1')  +-  tensor(0.2504, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4918, device='cuda:1')  +-  tensor(0.2597, device='cuda:1') (0.033)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4998, device='cuda:1')  +-  tensor(0.2504, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9375, device='cuda:1')  +-  tensor(0.0852, device='cuda:1') (0.028)
Original Stability MCC for r=0.6 = 0.974 +- 0.090
Intervened Stability MCC for r=0.6 = 0.610 +- 0.371
Original Stability F1 for r=0.6 = 0.990 +- 0.031
Intervened Stability F1 for r=0.6 = 0.896 +- 0.098
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.688511
Plausibility completed in  0:00:05.331008
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.0965, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3435, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.050)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.0965, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5570, device='cuda:1')  +-  tensor(0.0819, device='cuda:1') (0.073)
Original Stability MCC for r=0.3 = 0.953 +- 0.152
Intervened Stability MCC for r=0.3 = 0.632 +- 0.289
Original Stability F1 for r=0.3 = 0.969 +- 0.101
Intervened Stability F1 for r=0.3 = 0.770 +- 0.174
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.555318
Plausibility completed in  0:00:05.490796
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.0965, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3221, device='cuda:1')  +-  tensor(0.1091, device='cuda:1') (0.030)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.0965, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9100, device='cuda:1')  +-  tensor(0.0749, device='cuda:1') (0.039)
Original Stability MCC for r=0.6 = 0.990 +- 0.033
Intervened Stability MCC for r=0.6 = 0.680 +- 0.227
Original Stability F1 for r=0.6 = 0.996 +- 0.013
Intervened Stability F1 for r=0.6 = 0.902 +- 0.065
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:50:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:50:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.697
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.693
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.135
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.217


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.713624
Plausibility completed in  0:00:05.352599
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7362, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6009, device='cuda:1')  +-  tensor(0.2747, device='cuda:1') (0.115)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7362, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6956, device='cuda:1')  +-  tensor(0.1354, device='cuda:1') (0.124)
Original Stability MCC for r=0.3 = 0.945 +- 0.153
Intervened Stability MCC for r=0.3 = 0.534 +- 0.395
Original Stability F1 for r=0.3 = 0.964 +- 0.098
Intervened Stability F1 for r=0.3 = 0.717 +- 0.224
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.553764
Plausibility completed in  0:00:05.503698
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7362, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5774, device='cuda:1')  +-  tensor(0.2705, device='cuda:1') (0.095)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7362, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9123, device='cuda:1')  +-  tensor(0.0996, device='cuda:1') (0.052)
Original Stability MCC for r=0.6 = 0.985 +- 0.057
Intervened Stability MCC for r=0.6 = 0.558 +- 0.364
Original Stability F1 for r=0.6 = 0.994 +- 0.021
Intervened Stability F1 for r=0.6 = 0.875 +- 0.101
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.541984
Plausibility completed in  0:00:05.324094
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7350, device='cuda:1')  +-  tensor(0.2757, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5929, device='cuda:1')  +-  tensor(0.2733, device='cuda:1') (0.122)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7350, device='cuda:1')  +-  tensor(0.2757, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6940, device='cuda:1')  +-  tensor(0.1347, device='cuda:1') (0.128)
Original Stability MCC for r=0.3 = 0.946 +- 0.155
Intervened Stability MCC for r=0.3 = 0.529 +- 0.394
Original Stability F1 for r=0.3 = 0.965 +- 0.099
Intervened Stability F1 for r=0.3 = 0.713 +- 0.223
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.706543
Plausibility completed in  0:00:05.327238
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7350, device='cuda:1')  +-  tensor(0.2757, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5696, device='cuda:1')  +-  tensor(0.2680, device='cuda:1') (0.098)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7350, device='cuda:1')  +-  tensor(0.2757, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9136, device='cuda:1')  +-  tensor(0.0970, device='cuda:1') (0.055)
Original Stability MCC for r=0.6 = 0.986 +- 0.055
Intervened Stability MCC for r=0.6 = 0.576 +- 0.360
Original Stability F1 for r=0.6 = 0.995 +- 0.020
Intervened Stability F1 for r=0.6 = 0.879 +- 0.101
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.687676
Plausibility completed in  0:00:05.337947
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2287, device='cuda:1')  +-  tensor(0.1176, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3505, device='cuda:1')  +-  tensor(0.2098, device='cuda:1') (0.080)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2287, device='cuda:1')  +-  tensor(0.1176, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3907, device='cuda:1')  +-  tensor(0.0781, device='cuda:1') (0.075)
Original Stability MCC for r=0.3 = 0.503 +- 0.413
Intervened Stability MCC for r=0.3 = 0.229 +- 0.376
Original Stability F1 for r=0.3 = 0.676 +- 0.261
Intervened Stability F1 for r=0.3 = 0.523 +- 0.224
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.553635
Plausibility completed in  0:00:05.489579
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2287, device='cuda:1')  +-  tensor(0.1176, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3417, device='cuda:1')  +-  tensor(0.2041, device='cuda:1') (0.072)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2287, device='cuda:1')  +-  tensor(0.1176, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7246, device='cuda:1')  +-  tensor(0.0723, device='cuda:1') (0.059)
Original Stability MCC for r=0.6 = 0.626 +- 0.426
Intervened Stability MCC for r=0.6 = 0.225 +- 0.357
Original Stability F1 for r=0.6 = 0.870 +- 0.149
Intervened Stability F1 for r=0.6 = 0.757 +- 0.109
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:51:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:51:27 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.492
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.525
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.469
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.510
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.171
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.288


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.705348
Plausibility completed in  0:00:05.344750
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5166, device='cuda:1')  +-  tensor(0.2883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5151, device='cuda:1')  +-  tensor(0.2957, device='cuda:1') (0.060)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5166, device='cuda:1')  +-  tensor(0.2883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5780, device='cuda:1')  +-  tensor(0.1313, device='cuda:1') (0.072)
Original Stability MCC for r=0.3 = 0.965 +- 0.094
Intervened Stability MCC for r=0.3 = 0.547 +- 0.373
Original Stability F1 for r=0.3 = 0.977 +- 0.061
Intervened Stability F1 for r=0.3 = 0.721 +- 0.214
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.545525
Plausibility completed in  0:00:05.491800
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5166, device='cuda:1')  +-  tensor(0.2883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5023, device='cuda:1')  +-  tensor(0.2849, device='cuda:1') (0.054)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5166, device='cuda:1')  +-  tensor(0.2883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9098, device='cuda:1')  +-  tensor(0.0915, device='cuda:1') (0.041)
Original Stability MCC for r=0.6 = 0.975 +- 0.081
Intervened Stability MCC for r=0.6 = 0.592 +- 0.368
Original Stability F1 for r=0.6 = 0.991 +- 0.029
Intervened Stability F1 for r=0.6 = 0.886 +- 0.099
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.545857
Plausibility completed in  0:00:05.325757
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5019, device='cuda:1')  +-  tensor(0.2768, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4985, device='cuda:1')  +-  tensor(0.2860, device='cuda:1') (0.058)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5019, device='cuda:1')  +-  tensor(0.2768, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5713, device='cuda:1')  +-  tensor(0.1213, device='cuda:1') (0.071)
Original Stability MCC for r=0.3 = 0.965 +- 0.094
Intervened Stability MCC for r=0.3 = 0.546 +- 0.375
Original Stability F1 for r=0.3 = 0.977 +- 0.061
Intervened Stability F1 for r=0.3 = 0.721 +- 0.214
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.693405
Plausibility completed in  0:00:05.315438
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5019, device='cuda:1')  +-  tensor(0.2768, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4873, device='cuda:1')  +-  tensor(0.2758, device='cuda:1') (0.054)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5019, device='cuda:1')  +-  tensor(0.2768, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9160, device='cuda:1')  +-  tensor(0.0889, device='cuda:1') (0.040)
Original Stability MCC for r=0.6 = 0.975 +- 0.083
Intervened Stability MCC for r=0.6 = 0.632 +- 0.361
Original Stability F1 for r=0.6 = 0.991 +- 0.029
Intervened Stability F1 for r=0.6 = 0.896 +- 0.099
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.684844
Plausibility completed in  0:00:05.322462
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2685, device='cuda:1')  +-  tensor(0.1121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3191, device='cuda:1')  +-  tensor(0.1351, device='cuda:1') (0.058)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2685, device='cuda:1')  +-  tensor(0.1121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4297, device='cuda:1')  +-  tensor(0.0491, device='cuda:1') (0.050)
Original Stability MCC for r=0.3 = 0.878 +- 0.174
Intervened Stability MCC for r=0.3 = 0.513 +- 0.340
Original Stability F1 for r=0.3 = 0.920 +- 0.113
Intervened Stability F1 for r=0.3 = 0.697 +- 0.201
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.555009
Plausibility completed in  0:00:05.488838
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2685, device='cuda:1')  +-  tensor(0.1121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2992, device='cuda:1')  +-  tensor(0.1343, device='cuda:1') (0.040)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2685, device='cuda:1')  +-  tensor(0.1121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7748, device='cuda:1')  +-  tensor(0.0713, device='cuda:1') (0.043)
Original Stability MCC for r=0.6 = 0.990 +- 0.034
Intervened Stability MCC for r=0.6 = 0.505 +- 0.289
Original Stability F1 for r=0.6 = 0.996 +- 0.013
Intervened Stability F1 for r=0.6 = 0.849 +- 0.079
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:52:23 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:52:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.380
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.483
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.373
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.473
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.150
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.189


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.701743
Plausibility completed in  0:00:05.341322
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4791, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3340, device='cuda:1')  +-  tensor(0.1645, device='cuda:1') (0.095)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4791, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5483, device='cuda:1')  +-  tensor(0.1373, device='cuda:1') (0.095)
Original Stability MCC for r=0.3 = 0.944 +- 0.132
Intervened Stability MCC for r=0.3 = 0.443 +- 0.398
Original Stability F1 for r=0.3 = 0.962 +- 0.089
Intervened Stability F1 for r=0.3 = 0.655 +- 0.231
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.686808
Plausibility completed in  0:00:05.236091
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4787, device='cuda:1')  +-  tensor(0.2715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3167, device='cuda:1')  +-  tensor(0.1840, device='cuda:1') (0.072)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4787, device='cuda:1')  +-  tensor(0.2715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8665, device='cuda:1')  +-  tensor(0.1590, device='cuda:1') (0.050)
Original Stability MCC for r=0.6 = 0.978 +- 0.070
Intervened Stability MCC for r=0.6 = 0.513 +- 0.431
Original Stability F1 for r=0.6 = 0.992 +- 0.026
Intervened Stability F1 for r=0.6 = 0.862 +- 0.115
Intervened samples: 785


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.544657
Plausibility completed in  0:00:05.318247
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4677, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3325, device='cuda:1')  +-  tensor(0.1599, device='cuda:1') (0.088)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4677, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5547, device='cuda:1')  +-  tensor(0.1361, device='cuda:1') (0.090)
Original Stability MCC for r=0.3 = 0.931 +- 0.151
Intervened Stability MCC for r=0.3 = 0.453 +- 0.389
Original Stability F1 for r=0.3 = 0.954 +- 0.102
Intervened Stability F1 for r=0.3 = 0.660 +- 0.227
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.682415
Plausibility completed in  0:00:05.228766
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2576, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3195, device='cuda:1')  +-  tensor(0.1808, device='cuda:1') (0.064)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2576, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8765, device='cuda:1')  +-  tensor(0.1522, device='cuda:1') (0.049)
Original Stability MCC for r=0.6 = 0.977 +- 0.071
Intervened Stability MCC for r=0.6 = 0.535 +- 0.443
Original Stability F1 for r=0.6 = 0.992 +- 0.027
Intervened Stability F1 for r=0.6 = 0.867 +- 0.120
Intervened samples: 788


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.694947
Plausibility completed in  0:00:05.325437
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0774, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2638, device='cuda:1')  +-  tensor(0.0993, device='cuda:1') (0.095)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0774, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6106, device='cuda:1')  +-  tensor(0.1163, device='cuda:1') (0.107)
Original Stability MCC for r=0.3 = 0.805 +- 0.281
Intervened Stability MCC for r=0.3 = 0.677 +- 0.297
Original Stability F1 for r=0.3 = 0.879 +- 0.171
Intervened Stability F1 for r=0.3 = 0.797 +- 0.178
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.715144
Plausibility completed in  0:00:05.327796
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0774, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2290, device='cuda:1')  +-  tensor(0.1277, device='cuda:1') (0.032)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0774, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8907, device='cuda:1')  +-  tensor(0.0870, device='cuda:1') (0.040)
Original Stability MCC for r=0.6 = 0.974 +- 0.081
Intervened Stability MCC for r=0.6 = 0.569 +- 0.313
Original Stability F1 for r=0.6 = 0.991 +- 0.029
Intervened Stability F1 for r=0.6 = 0.866 +- 0.085
Intervened samples: 800


DONE GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.57222123 0.57218484] +- [0.09288389 0.09298268] (mean across ratios: 0.572)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.49518623 0.47701324] +- [0.08739242 0.08653094] (mean across ratios: 0.486)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.68091596 0.96863241] +- [0.09304208 0.01497629] (mean across ratios: 0.825)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.60217594 0.89810175] +- [0.06253984 0.02736934] (mean across ratios: 0.750)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.96191287 0.99055388] +- [0.01960063 0.00342104] (mean across ratios: 0.976)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.69521071 0.87546405] +- [0.05290128 0.01239755] (mean across ratios: 0.785)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.94244767 0.97442544] +- [0.03035807 0.00922697] (mean across ratios: 0.958)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.5045895  0.55650443] +- [0.08614517 0.03320872] (mean across ratios: 0.531)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56271798 0.56264759] +- [0.09849016 0.09859822] (mean across ratios: 0.563)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.48533015 0.46889328] +- [0.08443638 0.08172121] (mean across ratios: 0.477)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.68048373 0.96980993] +- [0.09707465 0.01469085] (mean across ratios: 0.825)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.60187032 0.90342929] +- [0.05831375 0.02466482] (mean across ratios: 0.753)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.96097529 0.99058679] +- [0.020138   0.00309262] (mean across ratios: 0.976)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.69579245 0.88044969] +- [0.05335267 0.01341357] (mean across ratios: 0.788)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.94102397 0.97446603] +- [0.03111251 0.0083435 ] (mean across ratios: 0.958)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.5064426 0.5772349] +- [0.0866255  0.03963094] (mean across ratios: 0.542)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.2663095 0.2663095] +- [0.02564301 0.02564301] (mean across ratios: 0.266)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.31929898 0.29866889] +- [0.0304434  0.03811314] (mean across ratios: 0.309)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.4124865  0.78079299] +- [0.06445513 0.0856531 ] (mean across ratios: 0.597)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.47930354 0.80425407] +- [0.08785034 0.08096365] (mean across ratios: 0.642)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.8243811  0.94586487] +- [0.12355428 0.05947317] (mean across ratios: 0.885)
(id) (test) STABILITY_F1_PERTURBED: 	[0.67982062 0.84087268] +- [0.10134828 0.04810239] (mean across ratios: 0.760)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.72656545 0.84816896] +- [0.19220389 0.16780212] (mean across ratios: 0.787)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.48417374 0.48496247] +- [0.16623839 0.15137629] (mean across ratios: 0.485)

Overall time of execution:  0:04:43.876383
DONE CIGA GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:53:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:53:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 111...
[0m[1;37mINFO[0m: [1mCheckpoint 111: 
-----------------------------------
Train ACCURACY: 0.9205
Train Loss: 0.3805
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3724
ID Test ACCURACY: 0.9183
ID Test Loss: 0.4140
OOD Validation ACCURACY: 0.8453
OOD Validation Loss: 0.4964
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.3446

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 50...
[0m[1;37mINFO[0m: [1mCheckpoint 50: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4880
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.4614
ID Test ACCURACY: 0.8947
ID Test Loss: 0.5226
OOD Validation ACCURACY: 0.9203
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.4087
OOD Test Loss: 28.2468

[0m[1;37mINFO[0m: [1mChartInfo 0.9183 0.4087 0.8947 0.4087 0.9050 0.9203[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.605
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.629
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.601
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.628
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.106
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.229


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.575602
Plausibility completed in  0:00:05.292739
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6114, device='cuda:1')  +-  tensor(0.2839, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5431, device='cuda:1')  +-  tensor(0.3265, device='cuda:1') (0.069)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6114, device='cuda:1')  +-  tensor(0.2839, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5223, device='cuda:1')  +-  tensor(0.1224, device='cuda:1') (0.076)
Original Stability MCC for r=0.3 = 0.887 +- 0.199
Intervened Stability MCC for r=0.3 = 0.177 +- 0.456
Original Stability F1 for r=0.3 = 0.926 +- 0.126
Intervened Stability F1 for r=0.3 = 0.533 +- 0.259
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.508542
Plausibility completed in  0:00:05.024924
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6116, device='cuda:1')  +-  tensor(0.2866, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4954, device='cuda:1')  +-  tensor(0.2951, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6116, device='cuda:1')  +-  tensor(0.2866, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8714, device='cuda:1')  +-  tensor(0.1582, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 0.963 +- 0.085
Intervened Stability MCC for r=0.6 = 0.224 +- 0.361
Original Stability F1 for r=0.6 = 0.986 +- 0.031
Intervened Stability F1 for r=0.6 = 0.862 +- 0.100
Intervened samples: 785


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.661165
Plausibility completed in  0:00:05.107788
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6092, device='cuda:1')  +-  tensor(0.2811, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5247, device='cuda:1')  +-  tensor(0.3231, device='cuda:1') (0.069)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.6092, device='cuda:1')  +-  tensor(0.2811, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5148, device='cuda:1')  +-  tensor(0.1130, device='cuda:1') (0.078)
Original Stability MCC for r=0.3 = 0.886 +- 0.198
Intervened Stability MCC for r=0.3 = 0.169 +- 0.450
Original Stability F1 for r=0.3 = 0.925 +- 0.124
Intervened Stability F1 for r=0.3 = 0.529 +- 0.255
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.657613
Plausibility completed in  0:00:05.020801
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6093, device='cuda:1')  +-  tensor(0.2832, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4860, device='cuda:1')  +-  tensor(0.2911, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.6093, device='cuda:1')  +-  tensor(0.2832, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8792, device='cuda:1')  +-  tensor(0.1489, device='cuda:1') (0.038)
Original Stability MCC for r=0.6 = 0.959 +- 0.092
Intervened Stability MCC for r=0.6 = 0.237 +- 0.363
Original Stability F1 for r=0.6 = 0.985 +- 0.033
Intervened Stability F1 for r=0.6 = 0.862 +- 0.098
Intervened samples: 788


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.528499
Plausibility completed in  0:00:05.232798
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2556, device='cuda:1')  +-  tensor(0.1261, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4302, device='cuda:1')  +-  tensor(0.2546, device='cuda:1') (0.063)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2556, device='cuda:1')  +-  tensor(0.1261, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4466, device='cuda:1')  +-  tensor(0.0990, device='cuda:1') (0.047)
Original Stability MCC for r=0.3 = 0.495 +- 0.243
Intervened Stability MCC for r=0.3 = 0.139 +- 0.448
Original Stability F1 for r=0.3 = 0.678 +- 0.141
Intervened Stability F1 for r=0.3 = 0.543 +- 0.207
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.535215
Plausibility completed in  0:00:05.273807
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2556, device='cuda:1')  +-  tensor(0.1261, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4012, device='cuda:1')  +-  tensor(0.2396, device='cuda:1') (0.048)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2556, device='cuda:1')  +-  tensor(0.1261, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7967, device='cuda:1')  +-  tensor(0.1037, device='cuda:1') (0.034)
Original Stability MCC for r=0.6 = 0.660 +- 0.440
Intervened Stability MCC for r=0.6 = 0.198 +- 0.390
Original Stability F1 for r=0.6 = 0.876 +- 0.160
Intervened Stability F1 for r=0.6 = 0.835 +- 0.115
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:54:33 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:54:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9219
Train Loss: 0.4585
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.4446
ID Test ACCURACY: 0.9153
ID Test Loss: 0.5136
OOD Validation ACCURACY: 0.9030
OOD Validation Loss: 0.4462
OOD Test ACCURACY: 0.4087
OOD Test Loss: 12.6375

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.9233
Train Loss: 0.4108
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3921
ID Test ACCURACY: 0.9180
ID Test Loss: 0.4568
OOD Validation ACCURACY: 0.9187
OOD Validation Loss: 0.3832
OOD Test ACCURACY: 0.4087
OOD Test Loss: 14.2353

[0m[1;37mINFO[0m: [1mChartInfo 0.9153 0.4087 0.9180 0.4087 0.9277 0.9187[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.484
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.519
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.470
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.502
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.266
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.306


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.532149
Plausibility completed in  0:00:05.274037
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5178, device='cuda:1')  +-  tensor(0.2652, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5371, device='cuda:1')  +-  tensor(0.3047, device='cuda:1') (0.055)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5178, device='cuda:1')  +-  tensor(0.2652, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6426, device='cuda:1')  +-  tensor(0.1645, device='cuda:1') (0.065)
Original Stability MCC for r=0.3 = 0.973 +- 0.076
Intervened Stability MCC for r=0.3 = 0.462 +- 0.405
Original Stability F1 for r=0.3 = 0.982 +- 0.051
Intervened Stability F1 for r=0.3 = 0.699 +- 0.198
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.534516
Plausibility completed in  0:00:05.117659
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5178, device='cuda:1')  +-  tensor(0.2652, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5092, device='cuda:1')  +-  tensor(0.2800, device='cuda:1') (0.029)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5178, device='cuda:1')  +-  tensor(0.2652, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9179, device='cuda:1')  +-  tensor(0.1023, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.972 +- 0.089
Intervened Stability MCC for r=0.6 = 0.330 +- 0.441
Original Stability F1 for r=0.6 = 0.990 +- 0.031
Intervened Stability F1 for r=0.6 = 0.894 +- 0.107
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.661477
Plausibility completed in  0:00:05.106449
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4998, device='cuda:1')  +-  tensor(0.2504, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5175, device='cuda:1')  +-  tensor(0.2951, device='cuda:1') (0.052)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4998, device='cuda:1')  +-  tensor(0.2504, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6391, device='cuda:1')  +-  tensor(0.1572, device='cuda:1') (0.064)
Original Stability MCC for r=0.3 = 0.972 +- 0.081
Intervened Stability MCC for r=0.3 = 0.468 +- 0.406
Original Stability F1 for r=0.3 = 0.981 +- 0.055
Intervened Stability F1 for r=0.3 = 0.701 +- 0.199
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.683554
Plausibility completed in  0:00:05.095660
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4998, device='cuda:1')  +-  tensor(0.2504, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4883, device='cuda:1')  +-  tensor(0.2704, device='cuda:1') (0.029)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4998, device='cuda:1')  +-  tensor(0.2504, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9213, device='cuda:1')  +-  tensor(0.1004, device='cuda:1') (0.025)
Original Stability MCC for r=0.6 = 0.974 +- 0.093
Intervened Stability MCC for r=0.6 = 0.351 +- 0.449
Original Stability F1 for r=0.6 = 0.991 +- 0.032
Intervened Stability F1 for r=0.6 = 0.897 +- 0.106
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.673143
Plausibility completed in  0:00:05.105800
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.0965, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5123, device='cuda:1')  +-  tensor(0.2607, device='cuda:1') (0.077)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.0965, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5369, device='cuda:1')  +-  tensor(0.1378, device='cuda:1') (0.079)
Original Stability MCC for r=0.3 = 0.951 +- 0.155
Intervened Stability MCC for r=0.3 = 0.309 +- 0.424
Original Stability F1 for r=0.3 = 0.967 +- 0.103
Intervened Stability F1 for r=0.3 = 0.626 +- 0.204
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.531861
Plausibility completed in  0:00:05.251236
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.0965, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3813, device='cuda:1')  +-  tensor(0.2153, device='cuda:1') (0.024)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3080, device='cuda:1')  +-  tensor(0.0965, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9237, device='cuda:1')  +-  tensor(0.0568, device='cuda:1') (0.023)
Original Stability MCC for r=0.6 = 0.989 +- 0.036
Intervened Stability MCC for r=0.6 = 0.480 +- 0.399
Original Stability F1 for r=0.6 = 0.996 +- 0.014
Intervened Stability F1 for r=0.6 = 0.917 +- 0.059
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:55:26 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:55:26 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.5536
ID Validation ACCURACY: 0.9003
ID Validation Loss: 0.5339
ID Test ACCURACY: 0.8880
ID Test Loss: 0.5790
OOD Validation ACCURACY: 0.8117
OOD Validation Loss: 0.5655
OOD Test ACCURACY: 0.4087
OOD Test Loss: 19.5623

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 144...
[0m[1;37mINFO[0m: [1mCheckpoint 144: 
-----------------------------------
Train ACCURACY: 0.8036
Train Loss: 0.5833
ID Validation ACCURACY: 0.8053
ID Validation Loss: 0.5878
ID Test ACCURACY: 0.7930
ID Test Loss: 0.6074
OOD Validation ACCURACY: 0.8780
OOD Validation Loss: 0.4487
OOD Test ACCURACY: 0.4087
OOD Test Loss: 16.8359

[0m[1;37mINFO[0m: [1mChartInfo 0.8880 0.4087 0.7930 0.4087 0.8053 0.8780[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.697
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.693
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.735
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.135
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.217


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.700611
Plausibility completed in  0:00:05.116100
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7362, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5941, device='cuda:1')  +-  tensor(0.3137, device='cuda:1') (0.092)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7362, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6424, device='cuda:1')  +-  tensor(0.1535, device='cuda:1') (0.098)
Original Stability MCC for r=0.3 = 0.942 +- 0.155
Intervened Stability MCC for r=0.3 = 0.346 +- 0.462
Original Stability F1 for r=0.3 = 0.962 +- 0.099
Intervened Stability F1 for r=0.3 = 0.631 +- 0.246
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.540706
Plausibility completed in  0:00:05.264097
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7362, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5517, device='cuda:1')  +-  tensor(0.3136, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7362, device='cuda:1')  +-  tensor(0.2688, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8987, device='cuda:1')  +-  tensor(0.1076, device='cuda:1') (0.040)
Original Stability MCC for r=0.6 = 0.986 +- 0.054
Intervened Stability MCC for r=0.6 = 0.305 +- 0.408
Original Stability F1 for r=0.6 = 0.995 +- 0.020
Intervened Stability F1 for r=0.6 = 0.875 +- 0.106
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.532557
Plausibility completed in  0:00:05.084530
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7350, device='cuda:1')  +-  tensor(0.2757, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5802, device='cuda:1')  +-  tensor(0.3134, device='cuda:1') (0.098)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7350, device='cuda:1')  +-  tensor(0.2757, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6379, device='cuda:1')  +-  tensor(0.1464, device='cuda:1') (0.104)
Original Stability MCC for r=0.3 = 0.945 +- 0.155
Intervened Stability MCC for r=0.3 = 0.343 +- 0.460
Original Stability F1 for r=0.3 = 0.964 +- 0.099
Intervened Stability F1 for r=0.3 = 0.629 +- 0.243
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.688175
Plausibility completed in  0:00:05.091319
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7350, device='cuda:1')  +-  tensor(0.2757, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5346, device='cuda:1')  +-  tensor(0.3124, device='cuda:1') (0.053)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7350, device='cuda:1')  +-  tensor(0.2757, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9014, device='cuda:1')  +-  tensor(0.1075, device='cuda:1') (0.040)
Original Stability MCC for r=0.6 = 0.987 +- 0.051
Intervened Stability MCC for r=0.6 = 0.330 +- 0.409
Original Stability F1 for r=0.6 = 0.995 +- 0.019
Intervened Stability F1 for r=0.6 = 0.880 +- 0.106
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.671746
Plausibility completed in  0:00:05.087426
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2287, device='cuda:1')  +-  tensor(0.1176, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4782, device='cuda:1')  +-  tensor(0.2714, device='cuda:1') (0.078)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2287, device='cuda:1')  +-  tensor(0.1176, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4082, device='cuda:1')  +-  tensor(0.1485, device='cuda:1') (0.072)
Original Stability MCC for r=0.3 = 0.504 +- 0.413
Intervened Stability MCC for r=0.3 = 0.153 +- 0.520
Original Stability F1 for r=0.3 = 0.677 +- 0.261
Intervened Stability F1 for r=0.3 = 0.522 +- 0.281
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.543162
Plausibility completed in  0:00:05.249781
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2287, device='cuda:1')  +-  tensor(0.1176, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4915, device='cuda:1')  +-  tensor(0.2847, device='cuda:1') (0.066)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2287, device='cuda:1')  +-  tensor(0.1176, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7338, device='cuda:1')  +-  tensor(0.1370, device='cuda:1') (0.062)
Original Stability MCC for r=0.6 = 0.626 +- 0.426
Intervened Stability MCC for r=0.6 = -0.060 +- 0.323
Original Stability F1 for r=0.6 = 0.870 +- 0.149
Intervened Stability F1 for r=0.6 = 0.754 +- 0.119
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:56:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:56:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 33...
[0m[1;37mINFO[0m: [1mCheckpoint 33: 
-----------------------------------
Train ACCURACY: 0.9238
Train Loss: 0.4617
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.4236
ID Test ACCURACY: 0.9190
ID Test Loss: 0.4980
OOD Validation ACCURACY: 0.9040
OOD Validation Loss: 0.4178
OOD Test ACCURACY: 0.4087
OOD Test Loss: 18.1921

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9162
Train Loss: 0.4235
ID Validation ACCURACY: 0.9237
ID Validation Loss: 0.3927
ID Test ACCURACY: 0.9133
ID Test Loss: 0.4441
OOD Validation ACCURACY: 0.9150
OOD Validation Loss: 0.3759
OOD Test ACCURACY: 0.6387
OOD Test Loss: 3.0586

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4087 0.9133 0.6387 0.9237 0.9150[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.492
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.525
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.469
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.510
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.171
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.288


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.700382
Plausibility completed in  0:00:05.110579
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5166, device='cuda:1')  +-  tensor(0.2883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5557, device='cuda:1')  +-  tensor(0.3286, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5166, device='cuda:1')  +-  tensor(0.2883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5818, device='cuda:1')  +-  tensor(0.1552, device='cuda:1') (0.063)
Original Stability MCC for r=0.3 = 0.966 +- 0.094
Intervened Stability MCC for r=0.3 = 0.346 +- 0.452
Original Stability F1 for r=0.3 = 0.977 +- 0.060
Intervened Stability F1 for r=0.3 = 0.635 +- 0.221
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.543904
Plausibility completed in  0:00:05.275755
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5166, device='cuda:1')  +-  tensor(0.2883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5362, device='cuda:1')  +-  tensor(0.3231, device='cuda:1') (0.038)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5166, device='cuda:1')  +-  tensor(0.2883, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9090, device='cuda:1')  +-  tensor(0.1024, device='cuda:1') (0.032)
Original Stability MCC for r=0.6 = 0.976 +- 0.080
Intervened Stability MCC for r=0.6 = 0.308 +- 0.423
Original Stability F1 for r=0.6 = 0.991 +- 0.029
Intervened Stability F1 for r=0.6 = 0.889 +- 0.102
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.538445
Plausibility completed in  0:00:05.095525
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5019, device='cuda:1')  +-  tensor(0.2768, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5377, device='cuda:1')  +-  tensor(0.3233, device='cuda:1') (0.050)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5019, device='cuda:1')  +-  tensor(0.2768, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5743, device='cuda:1')  +-  tensor(0.1447, device='cuda:1') (0.060)
Original Stability MCC for r=0.3 = 0.963 +- 0.093
Intervened Stability MCC for r=0.3 = 0.330 +- 0.456
Original Stability F1 for r=0.3 = 0.975 +- 0.060
Intervened Stability F1 for r=0.3 = 0.627 +- 0.220
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.697408
Plausibility completed in  0:00:05.100598
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5019, device='cuda:1')  +-  tensor(0.2768, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5196, device='cuda:1')  +-  tensor(0.3155, device='cuda:1') (0.038)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5019, device='cuda:1')  +-  tensor(0.2768, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9168, device='cuda:1')  +-  tensor(0.0989, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 0.970 +- 0.089
Intervened Stability MCC for r=0.6 = 0.346 +- 0.440
Original Stability F1 for r=0.6 = 0.989 +- 0.031
Intervened Stability F1 for r=0.6 = 0.896 +- 0.103
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.682580
Plausibility completed in  0:00:05.276521
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2685, device='cuda:1')  +-  tensor(0.1121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4695, device='cuda:1')  +-  tensor(0.2581, device='cuda:1') (0.082)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2685, device='cuda:1')  +-  tensor(0.1121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4697, device='cuda:1')  +-  tensor(0.0890, device='cuda:1') (0.080)
Original Stability MCC for r=0.3 = 0.875 +- 0.175
Intervened Stability MCC for r=0.3 = 0.250 +- 0.436
Original Stability F1 for r=0.3 = 0.918 +- 0.113
Intervened Stability F1 for r=0.3 = 0.586 +- 0.219
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.539411
Plausibility completed in  0:00:05.242661
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2685, device='cuda:1')  +-  tensor(0.1121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.2244, device='cuda:1') (0.048)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2685, device='cuda:1')  +-  tensor(0.1121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8439, device='cuda:1')  +-  tensor(0.1097, device='cuda:1') (0.025)
Original Stability MCC for r=0.6 = 0.990 +- 0.034
Intervened Stability MCC for r=0.6 = 0.353 +- 0.368
Original Stability F1 for r=0.6 = 0.996 +- 0.013
Intervened Stability F1 for r=0.6 = 0.865 +- 0.095
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:57:12 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 11:57:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 62...
[0m[1;37mINFO[0m: [1mCheckpoint 62: 
-----------------------------------
Train ACCURACY: 0.9232
Train Loss: 0.4686
ID Validation ACCURACY: 0.9290
ID Validation Loss: 0.4482
ID Test ACCURACY: 0.9190
ID Test Loss: 0.5270
OOD Validation ACCURACY: 0.9023
OOD Validation Loss: 0.4335
OOD Test ACCURACY: 0.4097
OOD Test Loss: 11.4881

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9212
Train Loss: 0.4121
ID Validation ACCURACY: 0.9280
ID Validation Loss: 0.3988
ID Test ACCURACY: 0.9170
ID Test Loss: 0.4630
OOD Validation ACCURACY: 0.9170
OOD Validation Loss: 0.3851
OOD Test ACCURACY: 0.4087
OOD Test Loss: 36.3874

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.4097 0.9170 0.4087 0.9280 0.9170[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.380
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.483
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.372
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.473
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.150
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.189


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.698622
Plausibility completed in  0:00:05.090661
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4791, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3239, device='cuda:1')  +-  tensor(0.2070, device='cuda:1') (0.080)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4791, device='cuda:1')  +-  tensor(0.2690, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5447, device='cuda:1')  +-  tensor(0.1532, device='cuda:1') (0.075)
Original Stability MCC for r=0.3 = 0.944 +- 0.132
Intervened Stability MCC for r=0.3 = 0.284 +- 0.399
Original Stability F1 for r=0.3 = 0.962 +- 0.089
Intervened Stability F1 for r=0.3 = 0.595 +- 0.207
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.674089
Plausibility completed in  0:00:04.986681
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4787, device='cuda:1')  +-  tensor(0.2715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2882, device='cuda:1')  +-  tensor(0.2079, device='cuda:1') (0.048)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4787, device='cuda:1')  +-  tensor(0.2715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8668, device='cuda:1')  +-  tensor(0.1608, device='cuda:1') (0.034)
Original Stability MCC for r=0.6 = 0.977 +- 0.068
Intervened Stability MCC for r=0.6 = 0.302 +- 0.462
Original Stability F1 for r=0.6 = 0.991 +- 0.026
Intervened Stability F1 for r=0.6 = 0.863 +- 0.107
Intervened samples: 785


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.538486
Plausibility completed in  0:00:05.059783
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4677, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3260, device='cuda:1')  +-  tensor(0.2026, device='cuda:1') (0.072)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4677, device='cuda:1')  +-  tensor(0.2557, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5553, device='cuda:1')  +-  tensor(0.1463, device='cuda:1') (0.069)
Original Stability MCC for r=0.3 = 0.932 +- 0.151
Intervened Stability MCC for r=0.3 = 0.308 +- 0.395
Original Stability F1 for r=0.3 = 0.954 +- 0.102
Intervened Stability F1 for r=0.3 = 0.607 +- 0.204
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.673380
Plausibility completed in  0:00:04.999216
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2576, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2976, device='cuda:1')  +-  tensor(0.2014, device='cuda:1') (0.049)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4672, device='cuda:1')  +-  tensor(0.2576, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8743, device='cuda:1')  +-  tensor(0.1519, device='cuda:1') (0.032)
Original Stability MCC for r=0.6 = 0.980 +- 0.065
Intervened Stability MCC for r=0.6 = 0.345 +- 0.480
Original Stability F1 for r=0.6 = 0.992 +- 0.024
Intervened Stability F1 for r=0.6 = 0.868 +- 0.108
Intervened samples: 788


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.681088
Plausibility completed in  0:00:05.065286
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0774, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3877, device='cuda:1')  +-  tensor(0.3358, device='cuda:1') (0.037)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0774, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4985, device='cuda:1')  +-  tensor(0.2882, device='cuda:1') (0.050)
Original Stability MCC for r=0.3 = 0.804 +- 0.281
Intervened Stability MCC for r=0.3 = 0.251 +- 0.716
Original Stability F1 for r=0.3 = 0.879 +- 0.171
Intervened Stability F1 for r=0.3 = 0.588 +- 0.360
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.703565
Plausibility completed in  0:00:05.083121
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0774, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2185, device='cuda:1')  +-  tensor(0.1337, device='cuda:1') (0.030)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2708, device='cuda:1')  +-  tensor(0.0774, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8767, device='cuda:1')  +-  tensor(0.0910, device='cuda:1') (0.030)
Original Stability MCC for r=0.6 = 0.964 +- 0.101
Intervened Stability MCC for r=0.6 = 0.441 +- 0.310
Original Stability F1 for r=0.6 = 0.987 +- 0.036
Intervened Stability F1 for r=0.6 = 0.843 +- 0.084
Intervened samples: 800


DONE GOODMotif2 - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.57222123 0.57218484] +- [0.09288389 0.09298268] (mean across ratios: 0.572)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.51079944 0.47615213] +- [0.09554608 0.09600907] (mean across ratios: 0.493)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.68091596 0.96863241] +- [0.09304208 0.01497629] (mean across ratios: 0.825)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.5867437  0.89276651] +- [0.0493157  0.02030861] (mean across ratios: 0.740)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.96175711 0.99063094] +- [0.01954458 0.00276165] (mean across ratios: 0.976)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.61884475 0.87667705] +- [0.0543324  0.01289785] (mean across ratios: 0.748)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.9422562  0.97462881] +- [0.03027488 0.00749386] (mean across ratios: 0.958)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.32272063 0.29388161] +- [0.09314493 0.03616841] (mean across ratios: 0.308)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56271798 0.56264759] +- [0.09849016 0.09859822] (mean across ratios: 0.563)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.49718488 0.46521346] +- [0.08833055 0.08581975] (mean across ratios: 0.481)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.68048373 0.96980993] +- [0.09707465 0.01469085] (mean across ratios: 0.825)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.5843008 0.8985754] +- [0.04828648 0.0190994 ] (mean across ratios: 0.741)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.95994118 0.99044214] +- [0.0195636  0.00336473] (mean across ratios: 0.975)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.61872158 0.88056669] +- [0.0550161  0.01429952] (mean across ratios: 0.750)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.93950076 0.97399728] +- [0.03026826 0.00924129] (mean across ratios: 0.957)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.32350258 0.32189854] +- [0.09518994 0.04277556] (mean across ratios: 0.323)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.2663095 0.2663095] +- [0.02564301 0.02564301] (mean across ratios: 0.266)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.45557473 0.37379749] +- [0.04283601 0.08806456] (mean across ratios: 0.415)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.4124865  0.78079299] +- [0.06445513 0.0856531 ] (mean across ratios: 0.597)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.47197233 0.83498012] +- [0.04389272 0.06541125] (mean across ratios: 0.653)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.82386222 0.94501946] +- [0.12268309 0.0589626 ] (mean across ratios: 0.884)
(id) (test) STABILITY_F1_PERTURBED: 	[0.57291305 0.84262154] +- [0.03641857 0.0528116 ] (mean across ratios: 0.708)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.72586355 0.84584614] +- [0.1908147  0.16626126] (mean across ratios: 0.786)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.22046778 0.28218568] +- [0.06445789 0.19696256] (mean across ratios: 0.251)

Overall time of execution:  0:04:28.802177
DONE CIGA GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:58:25 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:25 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:37 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:39 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:40 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:44 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 11:58:50 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.364
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.380
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.466
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.131
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.096


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.709296
Plausibility completed in  0:00:05.252046
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3961, device='cuda:1')  +-  tensor(0.1997, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4718, device='cuda:1')  +-  tensor(0.2576, device='cuda:1') (0.027)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3961, device='cuda:1')  +-  tensor(0.1997, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5953, device='cuda:1')  +-  tensor(0.1117, device='cuda:1') (0.022)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.695 +- 0.284
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.860 +- 0.128
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.660686
Plausibility completed in  0:00:05.224518
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3954, device='cuda:1')  +-  tensor(0.2000, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4470, device='cuda:1')  +-  tensor(0.2412, device='cuda:1') (0.011)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3954, device='cuda:1')  +-  tensor(0.2000, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8541, device='cuda:1')  +-  tensor(0.1388, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 0.999 +- 0.010
Intervened Stability MCC for r=0.6 = 0.474 +- 0.417
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.917 +- 0.070
Intervened samples: 789


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.483962
Plausibility completed in  0:00:05.152100
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4090, device='cuda:1')  +-  tensor(0.2039, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4811, device='cuda:1')  +-  tensor(0.2666, device='cuda:1') (0.026)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4090, device='cuda:1')  +-  tensor(0.2039, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5861, device='cuda:1')  +-  tensor(0.1260, device='cuda:1') (0.023)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.704 +- 0.283
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.863 +- 0.128
Intervened samples: 783


ratio=0.6


Interventions completed in  0:00:01.624035
Plausibility completed in  0:00:05.127951
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4086, device='cuda:1')  +-  tensor(0.2043, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4553, device='cuda:1')  +-  tensor(0.2485, device='cuda:1') (0.012)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4086, device='cuda:1')  +-  tensor(0.2043, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8469, device='cuda:1')  +-  tensor(0.1700, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 1.000 +- 0.009
Intervened Stability MCC for r=0.6 = 0.477 +- 0.419
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.920 +- 0.068
Intervened samples: 778


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.619637
Plausibility completed in  0:00:05.844729
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0730, device='cuda:1')  +-  tensor(0.0376, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0986, device='cuda:1')  +-  tensor(0.0590, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0730, device='cuda:1')  +-  tensor(0.0376, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5585, device='cuda:1')  +-  tensor(0.0785, device='cuda:1') (0.009)
Original Stability MCC for r=0.3 = 0.998 +- 0.013
Intervened Stability MCC for r=0.3 = 0.702 +- 0.195
Original Stability F1 for r=0.3 = 0.999 +- 0.009
Intervened Stability F1 for r=0.3 = 0.848 +- 0.116
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.570851
Plausibility completed in  0:00:05.535267
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0719, device='cuda:1')  +-  tensor(0.0370, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0897, device='cuda:1')  +-  tensor(0.0562, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0719, device='cuda:1')  +-  tensor(0.0370, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8202, device='cuda:1')  +-  tensor(0.1812, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 0.995 +- 0.027
Intervened Stability MCC for r=0.6 = 0.340 +- 0.312
Original Stability F1 for r=0.6 = 0.998 +- 0.010
Intervened Stability F1 for r=0.6 = 0.875 +- 0.087
Intervened samples: 775
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 11:59:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 11:59:54 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:10 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:13 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:00:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.360
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.446
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.463
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.290
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.275


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.645014
Plausibility completed in  0:00:05.142809
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4034, device='cuda:1')  +-  tensor(0.1912, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4595, device='cuda:1')  +-  tensor(0.2476, device='cuda:1') (0.021)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4034, device='cuda:1')  +-  tensor(0.1912, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5941, device='cuda:1')  +-  tensor(0.1250, device='cuda:1') (0.016)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.806 +- 0.269
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.912 +- 0.119
Intervened samples: 786


ratio=0.6


Interventions completed in  0:00:01.443416
Plausibility completed in  0:00:05.098701
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4054, device='cuda:1')  +-  tensor(0.2273, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8245, device='cuda:1')  +-  tensor(0.2188, device='cuda:1') (0.007)
Original Stability MCC for r=0.6 = 0.999 +- 0.009
Intervened Stability MCC for r=0.6 = 0.627 +- 0.392
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.945 +- 0.066
Intervened samples: 755


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.459359
Plausibility completed in  0:00:05.038726
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4163, device='cuda:1')  +-  tensor(0.1958, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4615, device='cuda:1')  +-  tensor(0.2510, device='cuda:1') (0.020)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4163, device='cuda:1')  +-  tensor(0.1958, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5908, device='cuda:1')  +-  tensor(0.1454, device='cuda:1') (0.015)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.819 +- 0.259
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.918 +- 0.115
Intervened samples: 773


ratio=0.6


Interventions completed in  0:00:01.574511
Plausibility completed in  0:00:04.890455
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4092, device='cuda:1')  +-  tensor(0.1935, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4130, device='cuda:1')  +-  tensor(0.2327, device='cuda:1') (0.007)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4092, device='cuda:1')  +-  tensor(0.1935, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8179, device='cuda:1')  +-  tensor(0.2337, device='cuda:1') (0.007)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.638 +- 0.388
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.949 +- 0.064
Intervened samples: 747


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.612180
Plausibility completed in  0:00:05.832694
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2753, device='cuda:1')  +-  tensor(0.3410, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2774, device='cuda:1')  +-  tensor(0.3242, device='cuda:1') (0.007)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2753, device='cuda:1')  +-  tensor(0.3410, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7206, device='cuda:1')  +-  tensor(0.1778, device='cuda:1') (0.010)
Original Stability MCC for r=0.3 = 0.992 +- 0.026
Intervened Stability MCC for r=0.3 = 0.788 +- 0.188
Original Stability F1 for r=0.3 = 0.995 +- 0.018
Intervened Stability F1 for r=0.3 = 0.883 +- 0.103
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.562514
Plausibility completed in  0:00:05.498263
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2541, device='cuda:1')  +-  tensor(0.3251, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2426, device='cuda:1')  +-  tensor(0.3128, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2541, device='cuda:1')  +-  tensor(0.3251, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9305, device='cuda:1')  +-  tensor(0.1735, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.009
Intervened Stability MCC for r=0.6 = 0.590 +- 0.345
Original Stability F1 for r=0.6 = 0.999 +- 0.003
Intervened Stability F1 for r=0.6 = 0.935 +- 0.051
Intervened samples: 775
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:01:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:01:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.472
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.579
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.478
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.594
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.215
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.166


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.576676
Plausibility completed in  0:00:05.626168
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5740, device='cuda:1')  +-  tensor(0.3102, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6181, device='cuda:1')  +-  tensor(0.3267, device='cuda:1') (0.040)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5740, device='cuda:1')  +-  tensor(0.3102, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7067, device='cuda:1')  +-  tensor(0.1659, device='cuda:1') (0.032)
Original Stability MCC for r=0.3 = 1.000 +- 0.006
Intervened Stability MCC for r=0.3 = 0.839 +- 0.248
Original Stability F1 for r=0.3 = 1.000 +- 0.004
Intervened Stability F1 for r=0.3 = 0.919 +- 0.124
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.548134
Plausibility completed in  0:00:05.336349
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5773, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5896, device='cuda:1')  +-  tensor(0.3272, device='cuda:1') (0.025)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5773, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9120, device='cuda:1')  +-  tensor(0.1733, device='cuda:1') (0.011)
Original Stability MCC for r=0.6 = 0.999 +- 0.012
Intervened Stability MCC for r=0.6 = 0.698 +- 0.383
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.948 +- 0.072
Intervened samples: 778


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.693208
Plausibility completed in  0:00:05.301444
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5891, device='cuda:1')  +-  tensor(0.3087, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6294, device='cuda:1')  +-  tensor(0.3325, device='cuda:1') (0.037)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5891, device='cuda:1')  +-  tensor(0.3087, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7027, device='cuda:1')  +-  tensor(0.1871, device='cuda:1') (0.029)
Original Stability MCC for r=0.3 = 0.999 +- 0.012
Intervened Stability MCC for r=0.3 = 0.833 +- 0.254
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.915 +- 0.128
Intervened samples: 784


ratio=0.6


Interventions completed in  0:00:01.689581
Plausibility completed in  0:00:05.208686
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5917, device='cuda:1')  +-  tensor(0.3108, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6004, device='cuda:1')  +-  tensor(0.3330, device='cuda:1') (0.024)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5917, device='cuda:1')  +-  tensor(0.3108, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9026, device='cuda:1')  +-  tensor(0.1984, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 0.999 +- 0.017
Intervened Stability MCC for r=0.6 = 0.705 +- 0.380
Original Stability F1 for r=0.6 = 1.000 +- 0.007
Intervened Stability F1 for r=0.6 = 0.947 +- 0.072
Intervened samples: 769


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.688613
Plausibility completed in  0:00:05.834070
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1444, device='cuda:1')  +-  tensor(0.0987, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1632, device='cuda:1')  +-  tensor(0.0983, device='cuda:1') (0.014)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1444, device='cuda:1')  +-  tensor(0.0987, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7194, device='cuda:1')  +-  tensor(0.1531, device='cuda:1') (0.026)
Original Stability MCC for r=0.3 = 1.000 +- 0.002
Intervened Stability MCC for r=0.3 = 0.787 +- 0.228
Original Stability F1 for r=0.3 = 1.000 +- 0.002
Intervened Stability F1 for r=0.3 = 0.866 +- 0.144
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.815671
Plausibility completed in  0:00:05.757756
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1442, device='cuda:1')  +-  tensor(0.0997, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1535, device='cuda:1')  +-  tensor(0.0970, device='cuda:1') (0.010)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1442, device='cuda:1')  +-  tensor(0.0997, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9331, device='cuda:1')  +-  tensor(0.1501, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 0.999 +- 0.006
Intervened Stability MCC for r=0.6 = 0.689 +- 0.301
Original Stability F1 for r=0.6 = 1.000 +- 0.002
Intervened Stability F1 for r=0.6 = 0.948 +- 0.054
Intervened samples: 783
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:02:52 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:02:52 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:04 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:06 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:12 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:03:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.345
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.357
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.365
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.376
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.250
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.256


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.720944
Plausibility completed in  0:00:05.388699
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3887, device='cuda:1')  +-  tensor(0.2248, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3422, device='cuda:1')  +-  tensor(0.2405, device='cuda:1') (0.030)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3887, device='cuda:1')  +-  tensor(0.2248, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5879, device='cuda:1')  +-  tensor(0.1951, device='cuda:1') (0.025)
Original Stability MCC for r=0.3 = 0.999 +- 0.011
Intervened Stability MCC for r=0.3 = 0.546 +- 0.333
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.746 +- 0.183
Intervened samples: 786


ratio=0.6


Interventions completed in  0:00:01.466666
Plausibility completed in  0:00:05.023465
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.2217, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3083, device='cuda:1')  +-  tensor(0.2345, device='cuda:1') (0.012)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.2217, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7647, device='cuda:1')  +-  tensor(0.2420, device='cuda:1') (0.016)
Original Stability MCC for r=0.6 = 0.992 +- 0.037
Intervened Stability MCC for r=0.6 = 0.483 +- 0.398
Original Stability F1 for r=0.6 = 0.997 +- 0.013
Intervened Stability F1 for r=0.6 = 0.857 +- 0.110
Intervened samples: 739


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.670295
Plausibility completed in  0:00:05.178300
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4037, device='cuda:1')  +-  tensor(0.2216, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3510, device='cuda:1')  +-  tensor(0.2456, device='cuda:1') (0.029)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4037, device='cuda:1')  +-  tensor(0.2216, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5750, device='cuda:1')  +-  tensor(0.2022, device='cuda:1') (0.023)
Original Stability MCC for r=0.3 = 0.999 +- 0.012
Intervened Stability MCC for r=0.3 = 0.554 +- 0.336
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.752 +- 0.185
Intervened samples: 776


ratio=0.6


Interventions completed in  0:00:01.565103
Plausibility completed in  0:00:04.722609
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3890, device='cuda:1')  +-  tensor(0.2206, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3164, device='cuda:1')  +-  tensor(0.2397, device='cuda:1') (0.010)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3890, device='cuda:1')  +-  tensor(0.2206, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7463, device='cuda:1')  +-  tensor(0.2632, device='cuda:1') (0.015)
Original Stability MCC for r=0.6 = 0.991 +- 0.036
Intervened Stability MCC for r=0.6 = 0.481 +- 0.406
Original Stability F1 for r=0.6 = 0.997 +- 0.014
Intervened Stability F1 for r=0.6 = 0.859 +- 0.112
Intervened samples: 723


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.620936
Plausibility completed in  0:00:05.673787
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2625, device='cuda:1')  +-  tensor(0.3785, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2551, device='cuda:1')  +-  tensor(0.3808, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2625, device='cuda:1')  +-  tensor(0.3785, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6724, device='cuda:1')  +-  tensor(0.2131, device='cuda:1') (0.010)
Original Stability MCC for r=0.3 = 0.999 +- 0.009
Intervened Stability MCC for r=0.3 = 0.566 +- 0.405
Original Stability F1 for r=0.3 = 0.999 +- 0.006
Intervened Stability F1 for r=0.3 = 0.761 +- 0.241
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.705231
Plausibility completed in  0:00:05.501469
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2307, device='cuda:1')  +-  tensor(0.3536, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2114, device='cuda:1')  +-  tensor(0.3521, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2307, device='cuda:1')  +-  tensor(0.3536, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8749, device='cuda:1')  +-  tensor(0.2022, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 0.985 +- 0.041
Intervened Stability MCC for r=0.6 = 0.408 +- 0.404
Original Stability F1 for r=0.6 = 0.995 +- 0.016
Intervened Stability F1 for r=0.6 = 0.871 +- 0.109
Intervened samples: 767
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:04:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:32 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:34 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:36 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:40 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:04:46 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.237
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.299
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.252
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.324
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.261
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.247


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.494204
Plausibility completed in  0:00:05.273584
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3773, device='cuda:1')  +-  tensor(0.1940, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4342, device='cuda:1')  +-  tensor(0.2733, device='cuda:1') (0.031)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3773, device='cuda:1')  +-  tensor(0.1940, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5392, device='cuda:1')  +-  tensor(0.1373, device='cuda:1') (0.020)
Original Stability MCC for r=0.3 = 1.000 +- 0.003
Intervened Stability MCC for r=0.3 = 0.592 +- 0.398
Original Stability F1 for r=0.3 = 1.000 +- 0.002
Intervened Stability F1 for r=0.3 = 0.780 +- 0.213
Intervened samples: 781


ratio=0.6


Interventions completed in  0:00:01.475775
Plausibility completed in  0:00:05.057133
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3760, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4070, device='cuda:1')  +-  tensor(0.2580, device='cuda:1') (0.019)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3760, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7721, device='cuda:1')  +-  tensor(0.1788, device='cuda:1') (0.009)
Original Stability MCC for r=0.6 = 0.997 +- 0.022
Intervened Stability MCC for r=0.6 = 0.471 +- 0.393
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.871 +- 0.095
Intervened samples: 771


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.608720
Plausibility completed in  0:00:05.045161
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3926, device='cuda:1')  +-  tensor(0.2001, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4499, device='cuda:1')  +-  tensor(0.2826, device='cuda:1') (0.030)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3926, device='cuda:1')  +-  tensor(0.2001, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5287, device='cuda:1')  +-  tensor(0.1452, device='cuda:1') (0.020)
Original Stability MCC for r=0.3 = 1.000 +- 0.005
Intervened Stability MCC for r=0.3 = 0.555 +- 0.445
Original Stability F1 for r=0.3 = 1.000 +- 0.003
Intervened Stability F1 for r=0.3 = 0.762 +- 0.234
Intervened samples: 774


ratio=0.6


Interventions completed in  0:00:01.602392
Plausibility completed in  0:00:05.011273
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3910, device='cuda:1')  +-  tensor(0.2018, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4199, device='cuda:1')  +-  tensor(0.2739, device='cuda:1') (0.017)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3910, device='cuda:1')  +-  tensor(0.2018, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7586, device='cuda:1')  +-  tensor(0.2071, device='cuda:1') (0.008)
Original Stability MCC for r=0.6 = 0.996 +- 0.032
Intervened Stability MCC for r=0.6 = 0.456 +- 0.402
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.872 +- 0.092
Intervened samples: 756


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.767767
Plausibility completed in  0:00:05.734041
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2385, device='cuda:1')  +-  tensor(0.2993, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2074, device='cuda:1')  +-  tensor(0.2409, device='cuda:1') (0.009)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2385, device='cuda:1')  +-  tensor(0.2993, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6222, device='cuda:1')  +-  tensor(0.1417, device='cuda:1') (0.023)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.711 +- 0.358
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.841 +- 0.195
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.574186
Plausibility completed in  0:00:05.717444
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2225, device='cuda:1')  +-  tensor(0.2884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1923, device='cuda:1')  +-  tensor(0.2541, device='cuda:1') (0.007)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2225, device='cuda:1')  +-  tensor(0.2884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8363, device='cuda:1')  +-  tensor(0.1813, device='cuda:1') (0.012)
Original Stability MCC for r=0.6 = 0.991 +- 0.030
Intervened Stability MCC for r=0.6 = 0.509 +- 0.327
Original Stability F1 for r=0.6 = 0.996 +- 0.012
Intervened Stability F1 for r=0.6 = 0.896 +- 0.078
Intervened samples: 776


DONE GOODMotif - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.42790465 0.42348592] +- [0.07356084 0.07740524] (mean across ratios: 0.426)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.46516188 0.43145833] +- [0.08894309 0.09131253] (mean across ratios: 0.448)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.42004556 0.74122384] +- [0.06011793 0.06364342] (mean across ratios: 0.581)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.60462463 0.82547255] +- [0.05510327 0.05450869] (mean across ratios: 0.715)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99984553 0.99902664] +- [0.00020679 0.00106909] (mean across ratios: 0.999)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.84350636 0.90757879] +- [0.06956924 0.03738152] (mean across ratios: 0.876)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99977375 0.99740006] +- [0.00030309 0.00287897] (mean across ratios: 0.999)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.6956383  0.55060253] +- [0.1147652  0.09423049] (mean across ratios: 0.623)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.44214287 0.43789209] +- [0.07389346 0.07737198] (mean across ratios: 0.440)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.4745694  0.44102784] +- [0.08950196 0.09204873] (mean across ratios: 0.458)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.42286415 0.74438936] +- [0.060606   0.06356405] (mean across ratios: 0.584)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.5966495 0.8144554] +- [0.05741777 0.0576186 ] (mean across ratios: 0.706)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.99974161 0.99888083] +- [0.00025386 0.00127026] (mean across ratios: 0.999)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.84222215 0.90937126] +- [0.07227193 0.03783659] (mean across ratios: 0.876)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.99961836 0.99703549] +- [0.00037886 0.00335637] (mean across ratios: 0.998)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.69291147 0.55127099] +- [0.12168787 0.10065769] (mean across ratios: 0.622)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.1987425  0.18467203] +- [0.07778609 0.0674339 ] (mean across ratios: 0.192)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.20033779 0.17789599] +- [0.06437174 0.05271117] (mean across ratios: 0.189)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.53684174 0.78705394] +- [0.1011323  0.07650359] (mean across ratios: 0.662)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.6585987 0.8789945] +- [0.06177195 0.04665588] (mean across ratios: 0.769)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99856151 0.99752207] +- [0.00204877 0.00187576] (mean across ratios: 0.998)
(id) (test) STABILITY_F1_PERTURBED: 	[0.83976854 0.90517462] +- [0.04176274 0.03125457] (mean across ratios: 0.872)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99792038 0.99355315] +- [0.00296305 0.00496197] (mean across ratios: 0.996)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.71083372 0.50732723] +- [0.08095583 0.12456313] (mean across ratios: 0.609)

Overall time of execution:  0:07:24.783750
DONE LECI GOODMotif/size 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:06:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:07 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:19 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:21 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:23 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:27 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:33 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:06:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.364
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.380
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.466
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.131
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.096


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.549929
Plausibility completed in  0:00:05.489577
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3961, device='cuda:1')  +-  tensor(0.1997, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5219, device='cuda:1')  +-  tensor(0.2883, device='cuda:1') (0.016)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3961, device='cuda:1')  +-  tensor(0.1997, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6265, device='cuda:1')  +-  tensor(0.1287, device='cuda:1') (0.015)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.532 +- 0.382
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.817 +- 0.144
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.532956
Plausibility completed in  0:00:05.312623
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3954, device='cuda:1')  +-  tensor(0.2000, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4780, device='cuda:1')  +-  tensor(0.2608, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3954, device='cuda:1')  +-  tensor(0.2000, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8954, device='cuda:1')  +-  tensor(0.1392, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.004
Intervened Stability MCC for r=0.6 = 0.186 +- 0.353
Original Stability F1 for r=0.6 = 1.000 +- 0.002
Intervened Stability F1 for r=0.6 = 0.912 +- 0.067
Intervened samples: 789


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.649098
Plausibility completed in  0:00:05.266317
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4090, device='cuda:1')  +-  tensor(0.2039, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5316, device='cuda:1')  +-  tensor(0.2997, device='cuda:1') (0.017)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4090, device='cuda:1')  +-  tensor(0.2039, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6167, device='cuda:1')  +-  tensor(0.1458, device='cuda:1') (0.016)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.557 +- 0.388
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.825 +- 0.145
Intervened samples: 783


ratio=0.6


Interventions completed in  0:00:01.659882
Plausibility completed in  0:00:05.231466
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4086, device='cuda:1')  +-  tensor(0.2043, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4860, device='cuda:1')  +-  tensor(0.2694, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4086, device='cuda:1')  +-  tensor(0.2043, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8863, device='cuda:1')  +-  tensor(0.1731, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 1.000 +- 0.007
Intervened Stability MCC for r=0.6 = 0.193 +- 0.356
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.916 +- 0.065
Intervened samples: 778


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.643716
Plausibility completed in  0:00:05.769704
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0730, device='cuda:1')  +-  tensor(0.0376, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1180, device='cuda:1')  +-  tensor(0.0829, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0730, device='cuda:1')  +-  tensor(0.0376, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6448, device='cuda:1')  +-  tensor(0.1253, device='cuda:1') (0.008)
Original Stability MCC for r=0.3 = 0.998 +- 0.015
Intervened Stability MCC for r=0.3 = 0.626 +- 0.248
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.834 +- 0.135
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.739697
Plausibility completed in  0:00:05.599603
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0719, device='cuda:1')  +-  tensor(0.0370, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0986, device='cuda:1')  +-  tensor(0.0681, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0719, device='cuda:1')  +-  tensor(0.0370, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8732, device='cuda:1')  +-  tensor(0.1899, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.995 +- 0.023
Intervened Stability MCC for r=0.6 = 0.145 +- 0.273
Original Stability F1 for r=0.6 = 0.998 +- 0.009
Intervened Stability F1 for r=0.6 = 0.889 +- 0.083
Intervened samples: 775
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:07:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:07:38 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:07:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:07:52 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:07:54 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:07:57 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:08:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.360
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.446
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.463
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.289
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.275


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.683075
Plausibility completed in  0:00:05.287801
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4034, device='cuda:1')  +-  tensor(0.1912, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5008, device='cuda:1')  +-  tensor(0.2721, device='cuda:1') (0.016)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4034, device='cuda:1')  +-  tensor(0.1912, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6286, device='cuda:1')  +-  tensor(0.1370, device='cuda:1') (0.014)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.654 +- 0.384
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.864 +- 0.147
Intervened samples: 786


ratio=0.6


Interventions completed in  0:00:01.467138
Plausibility completed in  0:00:05.241684
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4232, device='cuda:1')  +-  tensor(0.2369, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.1876, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8645, device='cuda:1')  +-  tensor(0.2256, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 1.000 +- 0.005
Intervened Stability MCC for r=0.6 = 0.381 +- 0.428
Original Stability F1 for r=0.6 = 1.000 +- 0.002
Intervened Stability F1 for r=0.6 = 0.938 +- 0.065
Intervened samples: 755


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.497739
Plausibility completed in  0:00:05.187973
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4163, device='cuda:1')  +-  tensor(0.1958, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5015, device='cuda:1')  +-  tensor(0.2752, device='cuda:1') (0.016)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4163, device='cuda:1')  +-  tensor(0.1958, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6255, device='cuda:1')  +-  tensor(0.1587, device='cuda:1') (0.013)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.671 +- 0.381
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.873 +- 0.142
Intervened samples: 773


ratio=0.6


Interventions completed in  0:00:01.609252
Plausibility completed in  0:00:05.015380
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4092, device='cuda:1')  +-  tensor(0.1935, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4300, device='cuda:1')  +-  tensor(0.2431, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4092, device='cuda:1')  +-  tensor(0.1935, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8562, device='cuda:1')  +-  tensor(0.2418, device='cuda:1') (0.005)
Original Stability MCC for r=0.6 = 1.000 +- 0.005
Intervened Stability MCC for r=0.6 = 0.367 +- 0.428
Original Stability F1 for r=0.6 = 1.000 +- 0.002
Intervened Stability F1 for r=0.6 = 0.943 +- 0.064
Intervened samples: 747


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.642771
Plausibility completed in  0:00:05.742569
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2753, device='cuda:1')  +-  tensor(0.3410, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1294, device='cuda:1')  +-  tensor(0.0721, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2753, device='cuda:1')  +-  tensor(0.3410, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6566, device='cuda:1')  +-  tensor(0.0832, device='cuda:1') (0.013)
Original Stability MCC for r=0.3 = 0.992 +- 0.024
Intervened Stability MCC for r=0.3 = 0.602 +- 0.292
Original Stability F1 for r=0.3 = 0.995 +- 0.017
Intervened Stability F1 for r=0.3 = 0.808 +- 0.136
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.747545
Plausibility completed in  0:00:05.606801
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2541, device='cuda:1')  +-  tensor(0.3251, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1645, device='cuda:1')  +-  tensor(0.2213, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2541, device='cuda:1')  +-  tensor(0.3251, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9185, device='cuda:1')  +-  tensor(0.1742, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.008
Intervened Stability MCC for r=0.6 = 0.377 +- 0.345
Original Stability F1 for r=0.6 = 0.999 +- 0.003
Intervened Stability F1 for r=0.6 = 0.937 +- 0.042
Intervened samples: 775
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:09:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:05 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:09:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.472
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.579
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.478
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.594
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.215
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.166


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.536176
Plausibility completed in  0:00:05.435083
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5740, device='cuda:1')  +-  tensor(0.3102, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6568, device='cuda:1')  +-  tensor(0.3342, device='cuda:1') (0.040)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5740, device='cuda:1')  +-  tensor(0.3102, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7274, device='cuda:1')  +-  tensor(0.1698, device='cuda:1') (0.032)
Original Stability MCC for r=0.3 = 0.999 +- 0.011
Intervened Stability MCC for r=0.3 = 0.698 +- 0.347
Original Stability F1 for r=0.3 = 1.000 +- 0.007
Intervened Stability F1 for r=0.3 = 0.865 +- 0.152
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.507400
Plausibility completed in  0:00:05.179741
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5773, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6140, device='cuda:1')  +-  tensor(0.3366, device='cuda:1') (0.022)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5773, device='cuda:1')  +-  tensor(0.3121, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9275, device='cuda:1')  +-  tensor(0.1723, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 0.999 +- 0.019
Intervened Stability MCC for r=0.6 = 0.364 +- 0.441
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.942 +- 0.068
Intervened samples: 778


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.657732
Plausibility completed in  0:00:05.204307
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5891, device='cuda:1')  +-  tensor(0.3087, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6611, device='cuda:1')  +-  tensor(0.3378, device='cuda:1') (0.039)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5891, device='cuda:1')  +-  tensor(0.3087, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7192, device='cuda:1')  +-  tensor(0.1903, device='cuda:1') (0.032)
Original Stability MCC for r=0.3 = 1.000 +- 0.008
Intervened Stability MCC for r=0.3 = 0.697 +- 0.358
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.864 +- 0.158
Intervened samples: 784


ratio=0.6


Interventions completed in  0:00:01.491054
Plausibility completed in  0:00:05.297229
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5917, device='cuda:1')  +-  tensor(0.3108, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6185, device='cuda:1')  +-  tensor(0.3380, device='cuda:1') (0.021)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5917, device='cuda:1')  +-  tensor(0.3108, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9170, device='cuda:1')  +-  tensor(0.1983, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 0.998 +- 0.025
Intervened Stability MCC for r=0.6 = 0.363 +- 0.441
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.941 +- 0.069
Intervened samples: 769


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.643860
Plausibility completed in  0:00:05.896309
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1444, device='cuda:1')  +-  tensor(0.0987, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2058, device='cuda:1')  +-  tensor(0.1111, device='cuda:1') (0.023)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1444, device='cuda:1')  +-  tensor(0.0987, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7719, device='cuda:1')  +-  tensor(0.1227, device='cuda:1') (0.038)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.668 +- 0.220
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.821 +- 0.122
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.608638
Plausibility completed in  0:00:05.633698
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1442, device='cuda:1')  +-  tensor(0.0997, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1688, device='cuda:1')  +-  tensor(0.0996, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1442, device='cuda:1')  +-  tensor(0.0997, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9654, device='cuda:1')  +-  tensor(0.1445, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.999 +- 0.006
Intervened Stability MCC for r=0.6 = 0.139 +- 0.247
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.917 +- 0.088
Intervened samples: 783
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:10:34 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:10:34 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:10:46 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:10:48 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:10:50 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:10:54 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:11:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.345
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.357
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.365
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.376
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.250
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.256


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.520872
Plausibility completed in  0:00:05.378681
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3887, device='cuda:1')  +-  tensor(0.2248, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3437, device='cuda:1')  +-  tensor(0.2485, device='cuda:1') (0.027)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3887, device='cuda:1')  +-  tensor(0.2248, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6128, device='cuda:1')  +-  tensor(0.1960, device='cuda:1') (0.021)
Original Stability MCC for r=0.3 = 0.998 +- 0.018
Intervened Stability MCC for r=0.3 = 0.455 +- 0.377
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.717 +- 0.194
Intervened samples: 786


ratio=0.6


Interventions completed in  0:00:01.441058
Plausibility completed in  0:00:04.925006
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.2217, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3074, device='cuda:1')  +-  tensor(0.2303, device='cuda:1') (0.008)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3743, device='cuda:1')  +-  tensor(0.2217, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7998, device='cuda:1')  +-  tensor(0.2505, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 0.992 +- 0.034
Intervened Stability MCC for r=0.6 = 0.439 +- 0.409
Original Stability F1 for r=0.6 = 0.997 +- 0.012
Intervened Stability F1 for r=0.6 = 0.874 +- 0.098
Intervened samples: 739


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.648109
Plausibility completed in  0:00:05.142679
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4037, device='cuda:1')  +-  tensor(0.2216, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3513, device='cuda:1')  +-  tensor(0.2565, device='cuda:1') (0.022)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4037, device='cuda:1')  +-  tensor(0.2216, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6033, device='cuda:1')  +-  tensor(0.2125, device='cuda:1') (0.018)
Original Stability MCC for r=0.3 = 0.999 +- 0.014
Intervened Stability MCC for r=0.3 = 0.460 +- 0.380
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.721 +- 0.198
Intervened samples: 776


ratio=0.6


Interventions completed in  0:00:01.401765
Plausibility completed in  0:00:04.833151
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3890, device='cuda:1')  +-  tensor(0.2206, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3141, device='cuda:1')  +-  tensor(0.2320, device='cuda:1') (0.008)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3890, device='cuda:1')  +-  tensor(0.2206, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7783, device='cuda:1')  +-  tensor(0.2722, device='cuda:1') (0.009)
Original Stability MCC for r=0.6 = 0.994 +- 0.031
Intervened Stability MCC for r=0.6 = 0.427 +- 0.415
Original Stability F1 for r=0.6 = 0.998 +- 0.012
Intervened Stability F1 for r=0.6 = 0.873 +- 0.101
Intervened samples: 723


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.785539
Plausibility completed in  0:00:05.743808
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2625, device='cuda:1')  +-  tensor(0.3785, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2666, device='cuda:1')  +-  tensor(0.3756, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2625, device='cuda:1')  +-  tensor(0.3785, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7183, device='cuda:1')  +-  tensor(0.1962, device='cuda:1') (0.008)
Original Stability MCC for r=0.3 = 0.999 +- 0.007
Intervened Stability MCC for r=0.3 = 0.416 +- 0.445
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.720 +- 0.222
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.735891
Plausibility completed in  0:00:05.514498
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2307, device='cuda:1')  +-  tensor(0.3536, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2158, device='cuda:1')  +-  tensor(0.3506, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2307, device='cuda:1')  +-  tensor(0.3536, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9208, device='cuda:1')  +-  tensor(0.1959, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.985 +- 0.041
Intervened Stability MCC for r=0.6 = 0.240 +- 0.281
Original Stability F1 for r=0.6 = 0.994 +- 0.016
Intervened Stability F1 for r=0.6 = 0.895 +- 0.060
Intervened samples: 767
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:12:02 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:02 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:14 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:16 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:18 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:21 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mInit vGINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 09/10/2024 12:12:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.237
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.299
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.252
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.324
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.261
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.247


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.519140
Plausibility completed in  0:00:05.196741
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3773, device='cuda:1')  +-  tensor(0.1940, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4785, device='cuda:1')  +-  tensor(0.2977, device='cuda:1') (0.028)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3773, device='cuda:1')  +-  tensor(0.1940, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5545, device='cuda:1')  +-  tensor(0.1452, device='cuda:1') (0.016)
Original Stability MCC for r=0.3 = 0.999 +- 0.014
Intervened Stability MCC for r=0.3 = 0.426 +- 0.455
Original Stability F1 for r=0.3 = 0.999 +- 0.009
Intervened Stability F1 for r=0.3 = 0.712 +- 0.225
Intervened samples: 781


ratio=0.6


Interventions completed in  0:00:01.654517
Plausibility completed in  0:00:05.152297
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3760, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4255, device='cuda:1')  +-  tensor(0.2729, device='cuda:1') (0.013)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3760, device='cuda:1')  +-  tensor(0.1946, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7917, device='cuda:1')  +-  tensor(0.1809, device='cuda:1') (0.008)
Original Stability MCC for r=0.6 = 0.997 +- 0.026
Intervened Stability MCC for r=0.6 = 0.350 +- 0.407
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.866 +- 0.091
Intervened samples: 771


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.501798
Plausibility completed in  0:00:05.307644
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3926, device='cuda:1')  +-  tensor(0.2001, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4912, device='cuda:1')  +-  tensor(0.3050, device='cuda:1') (0.025)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3926, device='cuda:1')  +-  tensor(0.2001, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5423, device='cuda:1')  +-  tensor(0.1560, device='cuda:1') (0.015)
Original Stability MCC for r=0.3 = 0.999 +- 0.011
Intervened Stability MCC for r=0.3 = 0.383 +- 0.491
Original Stability F1 for r=0.3 = 1.000 +- 0.007
Intervened Stability F1 for r=0.3 = 0.691 +- 0.242
Intervened samples: 774


ratio=0.6


Interventions completed in  0:00:01.473963
Plausibility completed in  0:00:05.057142
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3910, device='cuda:1')  +-  tensor(0.2018, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4404, device='cuda:1')  +-  tensor(0.2861, device='cuda:1') (0.013)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3910, device='cuda:1')  +-  tensor(0.2018, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7780, device='cuda:1')  +-  tensor(0.2099, device='cuda:1') (0.008)
Original Stability MCC for r=0.6 = 0.997 +- 0.026
Intervened Stability MCC for r=0.6 = 0.341 +- 0.408
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.866 +- 0.090
Intervened samples: 756


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.794185
Plausibility completed in  0:00:05.752619
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2385, device='cuda:1')  +-  tensor(0.2993, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1450, device='cuda:1')  +-  tensor(0.1052, device='cuda:1') (0.008)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2385, device='cuda:1')  +-  tensor(0.2993, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6201, device='cuda:1')  +-  tensor(0.1063, device='cuda:1') (0.018)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.565 +- 0.430
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.792 +- 0.196
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.762470
Plausibility completed in  0:00:05.600078
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2225, device='cuda:1')  +-  tensor(0.2884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1616, device='cuda:1')  +-  tensor(0.2091, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2225, device='cuda:1')  +-  tensor(0.2884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8793, device='cuda:1')  +-  tensor(0.1838, device='cuda:1') (0.004)
Original Stability MCC for r=0.6 = 0.991 +- 0.030
Intervened Stability MCC for r=0.6 = 0.328 +- 0.310
Original Stability F1 for r=0.6 = 0.996 +- 0.012
Intervened Stability F1 for r=0.6 = 0.923 +- 0.056
Intervened samples: 776


DONE GOODMotif - LECIvGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.42790465 0.42348592] +- [0.07356084 0.07740524] (mean across ratios: 0.426)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.50033043 0.44960064] +- [0.09996338 0.09932968] (mean across ratios: 0.475)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.42004556 0.74122384] +- [0.06011793 0.06364342] (mean across ratios: 0.581)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.62995633 0.85575953] +- [0.05567843 0.05297144] (mean across ratios: 0.743)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99960748 0.99901592] +- [0.0004018  0.00108384] (mean across ratios: 0.999)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.79508578 0.90649624] +- [0.06809485 0.03160445] (mean across ratios: 0.851)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.9994211  0.99736116] +- [0.0005889  0.00290796] (mean across ratios: 0.998)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.55289713 0.34400187] +- [0.10716672 0.08454933] (mean across ratios: 0.448)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.44214287 0.43789209] +- [0.07389346 0.07737198] (mean across ratios: 0.440)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.50733156 0.45780624] +- [0.09885652 0.09832626] (mean across ratios: 0.483)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.42286415 0.74438936] +- [0.060606   0.06356405] (mean across ratios: 0.584)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.62139884 0.84317842] +- [0.05689785 0.05644221] (mean across ratios: 0.732)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.99968722 0.99904809] +- [0.00031439 0.00085693] (mean across ratios: 0.999)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.79499192 0.90770311] +- [0.07489475 0.03264226] (mean across ratios: 0.851)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.99953969 0.99749347] +- [0.00046102 0.00225546] (mean across ratios: 0.999)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.55383012 0.33822486] +- [0.12005159 0.07796051] (mean across ratios: 0.446)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.1987425  0.18467203] +- [0.07778609 0.0674339 ] (mean across ratios: 0.192)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.17294175 0.16185089] +- [0.0557742  0.03734957] (mean across ratios: 0.167)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.53684149 0.78705394] +- [0.10113206 0.07650359] (mean across ratios: 0.662)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.68234874 0.91142664] +- [0.05526509 0.03329967] (mean across ratios: 0.797)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99858649 0.99753287] +- [0.00204315 0.00192007] (mean across ratios: 0.998)
(id) (test) STABILITY_F1_PERTURBED: 	[0.79517826 0.91201366] +- [0.0399385  0.01796762] (mean across ratios: 0.854)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99794816 0.99356756] +- [0.00295812 0.00506679] (mean across ratios: 0.996)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.57529411 0.24601033] +- [0.08648351 0.09553621] (mean across ratios: 0.411)

Overall time of execution:  0:07:26.093581
DONE LECI GOODMotif/size 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:13:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:13:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:04 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:06 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:09 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:14:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.430
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.513
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.436
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.273
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.277


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.518329
Plausibility completed in  0:00:05.078529
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5103, device='cuda:1')  +-  tensor(0.3048, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5559, device='cuda:1')  +-  tensor(0.3212, device='cuda:1') (0.045)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5103, device='cuda:1')  +-  tensor(0.3048, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6391, device='cuda:1')  +-  tensor(0.1853, device='cuda:1') (0.061)
Original Stability MCC for r=0.3 = 0.976 +- 0.089
Intervened Stability MCC for r=0.3 = 0.586 +- 0.358
Original Stability F1 for r=0.3 = 0.984 +- 0.057
Intervened Stability F1 for r=0.3 = 0.752 +- 0.203
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.469880
Plausibility completed in  0:00:04.826077
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5064, device='cuda:1')  +-  tensor(0.3056, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5162, device='cuda:1')  +-  tensor(0.3109, device='cuda:1') (0.030)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5064, device='cuda:1')  +-  tensor(0.3056, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8900, device='cuda:1')  +-  tensor(0.1782, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 0.984 +- 0.060
Intervened Stability MCC for r=0.6 = 0.619 +- 0.403
Original Stability F1 for r=0.6 = 0.994 +- 0.021
Intervened Stability F1 for r=0.6 = 0.899 +- 0.105
Intervened samples: 777


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.610503
Plausibility completed in  0:00:04.868903
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5245, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5705, device='cuda:1')  +-  tensor(0.3307, device='cuda:1') (0.045)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5245, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6386, device='cuda:1')  +-  tensor(0.2002, device='cuda:1') (0.057)
Original Stability MCC for r=0.3 = 0.977 +- 0.076
Intervened Stability MCC for r=0.3 = 0.575 +- 0.376
Original Stability F1 for r=0.3 = 0.985 +- 0.050
Intervened Stability F1 for r=0.3 = 0.747 +- 0.212
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.447105
Plausibility completed in  0:00:04.887466
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5202, device='cuda:1')  +-  tensor(0.3096, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5261, device='cuda:1')  +-  tensor(0.3228, device='cuda:1') (0.030)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5202, device='cuda:1')  +-  tensor(0.3096, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8790, device='cuda:1')  +-  tensor(0.2092, device='cuda:1') (0.027)
Original Stability MCC for r=0.6 = 0.985 +- 0.061
Intervened Stability MCC for r=0.6 = 0.600 +- 0.412
Original Stability F1 for r=0.6 = 0.994 +- 0.021
Intervened Stability F1 for r=0.6 = 0.898 +- 0.106
Intervened samples: 765


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.601761
Plausibility completed in  0:00:05.108752
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2843, device='cuda:1')  +-  tensor(0.3741, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2825, device='cuda:1')  +-  tensor(0.3719, device='cuda:1') (0.012)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2843, device='cuda:1')  +-  tensor(0.3741, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6931, device='cuda:1')  +-  tensor(0.1799, device='cuda:1') (0.028)
Original Stability MCC for r=0.3 = 0.970 +- 0.050
Intervened Stability MCC for r=0.3 = 0.641 +- 0.217
Original Stability F1 for r=0.3 = 0.980 +- 0.034
Intervened Stability F1 for r=0.3 = 0.777 +- 0.135
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.751859
Plausibility completed in  0:00:05.104071
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2843, device='cuda:1')  +-  tensor(0.3741, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2800, device='cuda:1')  +-  tensor(0.3729, device='cuda:1') (0.010)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2843, device='cuda:1')  +-  tensor(0.3741, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9203, device='cuda:1')  +-  tensor(0.0772, device='cuda:1') (0.017)
Original Stability MCC for r=0.6 = 0.898 +- 0.199
Intervened Stability MCC for r=0.6 = 0.509 +- 0.289
Original Stability F1 for r=0.6 = 0.978 +- 0.039
Intervened Stability F1 for r=0.6 = 0.882 +- 0.075
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:15:15 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:15 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:27 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:29 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:31 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:34 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:15:40 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.403
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.415
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.506
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.271
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.277


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.510805
Plausibility completed in  0:00:05.089672
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4905, device='cuda:1')  +-  tensor(0.2981, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5235, device='cuda:1')  +-  tensor(0.3071, device='cuda:1') (0.045)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4905, device='cuda:1')  +-  tensor(0.2981, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6091, device='cuda:1')  +-  tensor(0.1927, device='cuda:1') (0.053)
Original Stability MCC for r=0.3 = 0.990 +- 0.046
Intervened Stability MCC for r=0.3 = 0.595 +- 0.350
Original Stability F1 for r=0.3 = 0.994 +- 0.030
Intervened Stability F1 for r=0.3 = 0.756 +- 0.200
Intervened samples: 793


ratio=0.6


Interventions completed in  0:00:01.454177
Plausibility completed in  0:00:04.737407
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4890, device='cuda:1')  +-  tensor(0.3009, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4850, device='cuda:1')  +-  tensor(0.3074, device='cuda:1') (0.025)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4890, device='cuda:1')  +-  tensor(0.3009, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8519, device='cuda:1')  +-  tensor(0.2063, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 0.991 +- 0.038
Intervened Stability MCC for r=0.6 = 0.581 +- 0.425
Original Stability F1 for r=0.6 = 0.996 +- 0.014
Intervened Stability F1 for r=0.6 = 0.889 +- 0.111
Intervened samples: 766


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.614918
Plausibility completed in  0:00:04.845741
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5043, device='cuda:1')  +-  tensor(0.3026, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5331, device='cuda:1')  +-  tensor(0.3192, device='cuda:1') (0.042)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5043, device='cuda:1')  +-  tensor(0.3026, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6093, device='cuda:1')  +-  tensor(0.2032, device='cuda:1') (0.052)
Original Stability MCC for r=0.3 = 0.988 +- 0.050
Intervened Stability MCC for r=0.3 = 0.602 +- 0.350
Original Stability F1 for r=0.3 = 0.992 +- 0.033
Intervened Stability F1 for r=0.3 = 0.761 +- 0.201
Intervened samples: 783


ratio=0.6


Interventions completed in  0:00:01.580588
Plausibility completed in  0:00:04.768147
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4898, device='cuda:1')  +-  tensor(0.3162, device='cuda:1') (0.025)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8389, device='cuda:1')  +-  tensor(0.2346, device='cuda:1') (0.026)
Original Stability MCC for r=0.6 = 0.990 +- 0.042
Intervened Stability MCC for r=0.6 = 0.574 +- 0.431
Original Stability F1 for r=0.6 = 0.996 +- 0.016
Intervened Stability F1 for r=0.6 = 0.889 +- 0.112
Intervened samples: 752


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.631916
Plausibility completed in  0:00:05.298442
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2814, device='cuda:1')  +-  tensor(0.3742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2718, device='cuda:1')  +-  tensor(0.3746, device='cuda:1') (0.010)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2814, device='cuda:1')  +-  tensor(0.3742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6633, device='cuda:1')  +-  tensor(0.1811, device='cuda:1') (0.024)
Original Stability MCC for r=0.3 = 0.957 +- 0.079
Intervened Stability MCC for r=0.3 = 0.613 +- 0.212
Original Stability F1 for r=0.3 = 0.972 +- 0.053
Intervened Stability F1 for r=0.3 = 0.760 +- 0.134
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.578297
Plausibility completed in  0:00:04.956827
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2592, device='cuda:1')  +-  tensor(0.3576, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2418, device='cuda:1')  +-  tensor(0.3548, device='cuda:1') (0.008)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2592, device='cuda:1')  +-  tensor(0.3576, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8658, device='cuda:1')  +-  tensor(0.1769, device='cuda:1') (0.017)
Original Stability MCC for r=0.6 = 0.933 +- 0.130
Intervened Stability MCC for r=0.6 = 0.530 +- 0.290
Original Stability F1 for r=0.6 = 0.978 +- 0.040
Intervened Stability F1 for r=0.6 = 0.881 +- 0.075
Intervened samples: 776
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:16:38 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:16:38 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:16:50 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:16:52 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:16:54 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:16:57 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:17:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.449
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.494
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.459
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.515
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.278
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.279


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.654021
Plausibility completed in  0:00:04.867388
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4960, device='cuda:1')  +-  tensor(0.2979, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5375, device='cuda:1')  +-  tensor(0.3102, device='cuda:1') (0.050)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4960, device='cuda:1')  +-  tensor(0.2979, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6010, device='cuda:1')  +-  tensor(0.1886, device='cuda:1') (0.058)
Original Stability MCC for r=0.3 = 0.985 +- 0.055
Intervened Stability MCC for r=0.3 = 0.589 +- 0.368
Original Stability F1 for r=0.3 = 0.990 +- 0.037
Intervened Stability F1 for r=0.3 = 0.753 +- 0.207
Intervened samples: 793


ratio=0.6


Interventions completed in  0:00:01.613635
Plausibility completed in  0:00:04.761793
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4947, device='cuda:1')  +-  tensor(0.3000, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4946, device='cuda:1')  +-  tensor(0.3047, device='cuda:1') (0.028)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4947, device='cuda:1')  +-  tensor(0.3000, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8572, device='cuda:1')  +-  tensor(0.1991, device='cuda:1') (0.025)
Original Stability MCC for r=0.6 = 0.983 +- 0.068
Intervened Stability MCC for r=0.6 = 0.612 +- 0.400
Original Stability F1 for r=0.6 = 0.994 +- 0.024
Intervened Stability F1 for r=0.6 = 0.898 +- 0.106
Intervened samples: 770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.480051
Plausibility completed in  0:00:04.945672
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5109, device='cuda:1')  +-  tensor(0.3033, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5501, device='cuda:1')  +-  tensor(0.3231, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5109, device='cuda:1')  +-  tensor(0.3033, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5995, device='cuda:1')  +-  tensor(0.2029, device='cuda:1') (0.056)
Original Stability MCC for r=0.3 = 0.983 +- 0.060
Intervened Stability MCC for r=0.3 = 0.582 +- 0.378
Original Stability F1 for r=0.3 = 0.989 +- 0.040
Intervened Stability F1 for r=0.3 = 0.753 +- 0.207
Intervened samples: 783


ratio=0.6


Interventions completed in  0:00:01.430535
Plausibility completed in  0:00:04.630447
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5120, device='cuda:1')  +-  tensor(0.3056, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5042, device='cuda:1')  +-  tensor(0.3204, device='cuda:1') (0.028)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5120, device='cuda:1')  +-  tensor(0.3056, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8412, device='cuda:1')  +-  tensor(0.2345, device='cuda:1') (0.024)
Original Stability MCC for r=0.6 = 0.983 +- 0.067
Intervened Stability MCC for r=0.6 = 0.613 +- 0.412
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.899 +- 0.107
Intervened samples: 753


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:02.031245
Plausibility completed in  0:00:05.093177
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2819, device='cuda:1')  +-  tensor(0.3739, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2762, device='cuda:1')  +-  tensor(0.3733, device='cuda:1') (0.011)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2819, device='cuda:1')  +-  tensor(0.3739, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6757, device='cuda:1')  +-  tensor(0.1815, device='cuda:1') (0.026)
Original Stability MCC for r=0.3 = 0.901 +- 0.160
Intervened Stability MCC for r=0.3 = 0.598 +- 0.218
Original Stability F1 for r=0.3 = 0.936 +- 0.106
Intervened Stability F1 for r=0.3 = 0.753 +- 0.140
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.949532
Plausibility completed in  0:00:05.058729
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2616, device='cuda:1')  +-  tensor(0.3588, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2560, device='cuda:1')  +-  tensor(0.3549, device='cuda:1') (0.010)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2616, device='cuda:1')  +-  tensor(0.3588, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8896, device='cuda:1')  +-  tensor(0.1747, device='cuda:1') (0.014)
Original Stability MCC for r=0.6 = 0.938 +- 0.111
Intervened Stability MCC for r=0.6 = 0.540 +- 0.265
Original Stability F1 for r=0.6 = 0.978 +- 0.040
Intervened Stability F1 for r=0.6 = 0.885 +- 0.069
Intervened samples: 778
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:18:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:03 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:15 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:17 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:19 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:22 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:18:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.511
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.571
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.509
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.585
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.504
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.486


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.501165
Plausibility completed in  0:00:04.876958
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5570, device='cuda:1')  +-  tensor(0.2691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5499, device='cuda:1')  +-  tensor(0.3048, device='cuda:1') (0.052)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5570, device='cuda:1')  +-  tensor(0.2691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5595, device='cuda:1')  +-  tensor(0.1875, device='cuda:1') (0.050)
Original Stability MCC for r=0.3 = 0.972 +- 0.092
Intervened Stability MCC for r=0.3 = 0.578 +- 0.389
Original Stability F1 for r=0.3 = 0.982 +- 0.059
Intervened Stability F1 for r=0.3 = 0.744 +- 0.226
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.652110
Plausibility completed in  0:00:04.875954
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5567, device='cuda:1')  +-  tensor(0.2692, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5383, device='cuda:1')  +-  tensor(0.3004, device='cuda:1') (0.023)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5567, device='cuda:1')  +-  tensor(0.2692, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8631, device='cuda:1')  +-  tensor(0.1416, device='cuda:1') (0.029)
Original Stability MCC for r=0.6 = 0.973 +- 0.088
Intervened Stability MCC for r=0.6 = 0.609 +- 0.406
Original Stability F1 for r=0.6 = 0.990 +- 0.031
Intervened Stability F1 for r=0.6 = 0.895 +- 0.113
Intervened samples: 792


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.635426
Plausibility completed in  0:00:04.815250
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5707, device='cuda:1')  +-  tensor(0.2669, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5620, device='cuda:1')  +-  tensor(0.3102, device='cuda:1') (0.047)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5707, device='cuda:1')  +-  tensor(0.2669, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5584, device='cuda:1')  +-  tensor(0.1968, device='cuda:1') (0.045)
Original Stability MCC for r=0.3 = 0.976 +- 0.079
Intervened Stability MCC for r=0.3 = 0.590 +- 0.384
Original Stability F1 for r=0.3 = 0.984 +- 0.052
Intervened Stability F1 for r=0.3 = 0.753 +- 0.222
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.641313
Plausibility completed in  0:00:04.816261
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5704, device='cuda:1')  +-  tensor(0.2671, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5501, device='cuda:1')  +-  tensor(0.3046, device='cuda:1') (0.023)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5704, device='cuda:1')  +-  tensor(0.2671, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8598, device='cuda:1')  +-  tensor(0.1671, device='cuda:1') (0.028)
Original Stability MCC for r=0.6 = 0.976 +- 0.084
Intervened Stability MCC for r=0.6 = 0.625 +- 0.403
Original Stability F1 for r=0.6 = 0.991 +- 0.029
Intervened Stability F1 for r=0.6 = 0.902 +- 0.109
Intervened samples: 783


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.617561
Plausibility completed in  0:00:05.258604
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4823, device='cuda:1')  +-  tensor(0.3619, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3451, device='cuda:1')  +-  tensor(0.3563, device='cuda:1') (0.024)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4823, device='cuda:1')  +-  tensor(0.3619, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6536, device='cuda:1')  +-  tensor(0.2366, device='cuda:1') (0.040)
Original Stability MCC for r=0.3 = 0.964 +- 0.061
Intervened Stability MCC for r=0.3 = 0.578 +- 0.353
Original Stability F1 for r=0.3 = 0.976 +- 0.042
Intervened Stability F1 for r=0.3 = 0.723 +- 0.237
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.616023
Plausibility completed in  0:00:05.133972
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4823, device='cuda:1')  +-  tensor(0.3619, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3202, device='cuda:1')  +-  tensor(0.3544, device='cuda:1') (0.012)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4823, device='cuda:1')  +-  tensor(0.3619, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8452, device='cuda:1')  +-  tensor(0.1756, device='cuda:1') (0.023)
Original Stability MCC for r=0.6 = 0.875 +- 0.225
Intervened Stability MCC for r=0.6 = 0.328 +- 0.358
Original Stability F1 for r=0.6 = 0.973 +- 0.042
Intervened Stability F1 for r=0.6 = 0.838 +- 0.114
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:19:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:28 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:40 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:42 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:44 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:47 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:19:53 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.697
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.589
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.711
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.374
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.360


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.665627
Plausibility completed in  0:00:05.048961
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7025, device='cuda:1')  +-  tensor(0.2739, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6536, device='cuda:1')  +-  tensor(0.3262, device='cuda:1') (0.054)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7025, device='cuda:1')  +-  tensor(0.2739, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6223, device='cuda:1')  +-  tensor(0.2078, device='cuda:1') (0.056)
Original Stability MCC for r=0.3 = 0.988 +- 0.061
Intervened Stability MCC for r=0.3 = 0.552 +- 0.443
Original Stability F1 for r=0.3 = 0.992 +- 0.040
Intervened Stability F1 for r=0.3 = 0.730 +- 0.254
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.560546
Plausibility completed in  0:00:05.097225
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7028, device='cuda:1')  +-  tensor(0.2740, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6399, device='cuda:1')  +-  tensor(0.3124, device='cuda:1') (0.035)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7028, device='cuda:1')  +-  tensor(0.2740, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9189, device='cuda:1')  +-  tensor(0.1340, device='cuda:1') (0.017)
Original Stability MCC for r=0.6 = 0.990 +- 0.048
Intervened Stability MCC for r=0.6 = 0.612 +- 0.384
Original Stability F1 for r=0.6 = 0.996 +- 0.017
Intervened Stability F1 for r=0.6 = 0.901 +- 0.097
Intervened samples: 793


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.512360
Plausibility completed in  0:00:04.811361
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7159, device='cuda:1')  +-  tensor(0.2672, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6643, device='cuda:1')  +-  tensor(0.3325, device='cuda:1') (0.051)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7159, device='cuda:1')  +-  tensor(0.2672, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6202, device='cuda:1')  +-  tensor(0.2197, device='cuda:1') (0.055)
Original Stability MCC for r=0.3 = 0.985 +- 0.059
Intervened Stability MCC for r=0.3 = 0.541 +- 0.457
Original Stability F1 for r=0.3 = 0.990 +- 0.040
Intervened Stability F1 for r=0.3 = 0.725 +- 0.260
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.640423
Plausibility completed in  0:00:04.830196
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7162, device='cuda:1')  +-  tensor(0.2673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6549, device='cuda:1')  +-  tensor(0.3175, device='cuda:1') (0.035)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7162, device='cuda:1')  +-  tensor(0.2673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9109, device='cuda:1')  +-  tensor(0.1666, device='cuda:1') (0.016)
Original Stability MCC for r=0.6 = 0.991 +- 0.048
Intervened Stability MCC for r=0.6 = 0.606 +- 0.403
Original Stability F1 for r=0.6 = 0.997 +- 0.017
Intervened Stability F1 for r=0.6 = 0.904 +- 0.098
Intervened samples: 784


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.620459
Plausibility completed in  0:00:05.252255
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3567, device='cuda:1')  +-  tensor(0.3416, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3178, device='cuda:1')  +-  tensor(0.3574, device='cuda:1') (0.013)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3567, device='cuda:1')  +-  tensor(0.3416, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7057, device='cuda:1')  +-  tensor(0.2454, device='cuda:1') (0.045)
Original Stability MCC for r=0.3 = 0.960 +- 0.074
Intervened Stability MCC for r=0.3 = 0.523 +- 0.447
Original Stability F1 for r=0.3 = 0.974 +- 0.051
Intervened Stability F1 for r=0.3 = 0.690 +- 0.291
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.626796
Plausibility completed in  0:00:05.088443
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3567, device='cuda:1')  +-  tensor(0.3416, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3211, device='cuda:1')  +-  tensor(0.3538, device='cuda:1') (0.008)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3567, device='cuda:1')  +-  tensor(0.3416, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9507, device='cuda:1')  +-  tensor(0.0944, device='cuda:1') (0.012)
Original Stability MCC for r=0.6 = 0.943 +- 0.200
Intervened Stability MCC for r=0.6 = 0.503 +- 0.283
Original Stability F1 for r=0.6 = 0.997 +- 0.008
Intervened Stability F1 for r=0.6 = 0.891 +- 0.070
Intervened samples: 800


DONE GOODMotif - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.55126558 0.54993156] +- [0.07917589 0.08008435] (mean across ratios: 0.551)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.5640794  0.53478973] +- [0.04611781 0.05566262] (mean across ratios: 0.549)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.61567637 0.92960235] +- [0.0420056  0.02091083] (mean across ratios: 0.773)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.60618197 0.87619318] +- [0.02667269 0.02504804] (mean across ratios: 0.741)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.98825884 0.99416993] +- [0.00444479 0.00232601] (mean across ratios: 0.991)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.74730694 0.89642161] +- [0.0094139  0.00411163] (mean across ratios: 0.822)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98225614 0.98401929] +- [0.00694638 0.0064478 ] (mean across ratios: 0.983)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.58005464 0.60655322] +- [0.0149209  0.01318084] (mean across ratios: 0.593)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56524796 0.56497234] +- [0.07883169 0.07897684] (mean across ratios: 0.565)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.57598617 0.54502798] +- [0.04592621 0.05859433] (mean across ratios: 0.561)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.61411091 0.92653117] +- [0.04172409 0.0213188 ] (mean across ratios: 0.770)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.60522642 0.865955  ] +- [0.02676608 0.02674154] (mean across ratios: 0.736)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.98781642 0.99446636] +- [0.00309205 0.00188542] (mean across ratios: 0.991)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.74777259 0.89838703] +- [0.01211284 0.00509045] (mean across ratios: 0.823)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.98179148 0.98482149] +- [0.0047128  0.00530449] (mean across ratios: 0.983)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.57799225 0.60351864] +- [0.02048686 0.01715677] (mean across ratios: 0.591)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.33733475 0.32882875] +- [0.07796355 0.08446557] (mean across ratios: 0.333)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.2986588  0.28381549] +- [0.02833539 0.03246605] (mean across ratios: 0.291)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.74341873 0.95033708] +- [0.07908924 0.02561721] (mean across ratios: 0.847)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.67829269 0.89432418] +- [0.01904138 0.03768978] (mean across ratios: 0.786)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.96746131 0.98083564] +- [0.01612816 0.0081135 ] (mean across ratios: 0.974)
(id) (test) STABILITY_F1_PERTURBED: 	[0.74073726 0.87529948] +- [0.03072429 0.01915394] (mean across ratios: 0.808)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.95029929 0.91726282] +- [0.02508345 0.02622607] (mean across ratios: 0.934)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.59067286 0.48222755] +- [0.03949823 0.07830183] (mean across ratios: 0.536)

Overall time of execution:  0:07:05.101710
DONE CIGA GOODMotif/size 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:21:13 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:13 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:25 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:27 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:29 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:32 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:21:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8899
Train Loss: 0.5257
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.4847
ID Test ACCURACY: 0.8937
ID Test Loss: 0.5229
OOD Validation ACCURACY: 0.6193
OOD Validation Loss: 1.1712
OOD Test ACCURACY: 0.4250
OOD Test Loss: 6.2644

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 0.8699
Train Loss: 0.5291
ID Validation ACCURACY: 0.8790
ID Validation Loss: 0.4662
ID Test ACCURACY: 0.8723
ID Test Loss: 0.5479
OOD Validation ACCURACY: 0.7500
OOD Validation Loss: 0.6795
OOD Test ACCURACY: 0.4680
OOD Test Loss: 3.3662

[0m[1;37mINFO[0m: [1mChartInfo 0.8937 0.4250 0.8723 0.4680 0.8790 0.7500[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.430
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.513
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.436
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.530
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.273
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.277


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.546006
Plausibility completed in  0:00:05.205919
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5103, device='cuda:1')  +-  tensor(0.3048, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6011, device='cuda:1')  +-  tensor(0.3308, device='cuda:1') (0.043)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5103, device='cuda:1')  +-  tensor(0.3048, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6354, device='cuda:1')  +-  tensor(0.1893, device='cuda:1') (0.054)
Original Stability MCC for r=0.3 = 0.982 +- 0.069
Intervened Stability MCC for r=0.3 = 0.411 +- 0.412
Original Stability F1 for r=0.3 = 0.988 +- 0.045
Intervened Stability F1 for r=0.3 = 0.680 +- 0.214
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.490890
Plausibility completed in  0:00:04.941710
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5064, device='cuda:1')  +-  tensor(0.3056, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5323, device='cuda:1')  +-  tensor(0.3135, device='cuda:1') (0.022)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5064, device='cuda:1')  +-  tensor(0.3056, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8848, device='cuda:1')  +-  tensor(0.1821, device='cuda:1') (0.023)
Original Stability MCC for r=0.6 = 0.983 +- 0.067
Intervened Stability MCC for r=0.6 = 0.352 +- 0.439
Original Stability F1 for r=0.6 = 0.994 +- 0.023
Intervened Stability F1 for r=0.6 = 0.900 +- 0.107
Intervened samples: 777


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.630511
Plausibility completed in  0:00:04.989899
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5245, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6105, device='cuda:1')  +-  tensor(0.3398, device='cuda:1') (0.042)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5245, device='cuda:1')  +-  tensor(0.3081, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6338, device='cuda:1')  +-  tensor(0.1996, device='cuda:1') (0.051)
Original Stability MCC for r=0.3 = 0.978 +- 0.079
Intervened Stability MCC for r=0.3 = 0.408 +- 0.432
Original Stability F1 for r=0.3 = 0.986 +- 0.051
Intervened Stability F1 for r=0.3 = 0.681 +- 0.221
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.466811
Plausibility completed in  0:00:05.009858
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5202, device='cuda:1')  +-  tensor(0.3096, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5416, device='cuda:1')  +-  tensor(0.3262, device='cuda:1') (0.021)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5202, device='cuda:1')  +-  tensor(0.3096, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8769, device='cuda:1')  +-  tensor(0.2119, device='cuda:1') (0.020)
Original Stability MCC for r=0.6 = 0.981 +- 0.076
Intervened Stability MCC for r=0.6 = 0.371 +- 0.450
Original Stability F1 for r=0.6 = 0.993 +- 0.026
Intervened Stability F1 for r=0.6 = 0.903 +- 0.106
Intervened samples: 765


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.629100
Plausibility completed in  0:00:05.230613
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2843, device='cuda:1')  +-  tensor(0.3741, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2982, device='cuda:1')  +-  tensor(0.3658, device='cuda:1') (0.016)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2843, device='cuda:1')  +-  tensor(0.3741, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7213, device='cuda:1')  +-  tensor(0.1775, device='cuda:1') (0.033)
Original Stability MCC for r=0.3 = 0.969 +- 0.051
Intervened Stability MCC for r=0.3 = 0.529 +- 0.287
Original Stability F1 for r=0.3 = 0.979 +- 0.034
Intervened Stability F1 for r=0.3 = 0.733 +- 0.160
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.774496
Plausibility completed in  0:00:05.279191
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2843, device='cuda:1')  +-  tensor(0.3741, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2899, device='cuda:1')  +-  tensor(0.3690, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2843, device='cuda:1')  +-  tensor(0.3741, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9402, device='cuda:1')  +-  tensor(0.0780, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 0.898 +- 0.199
Intervened Stability MCC for r=0.6 = 0.342 +- 0.314
Original Stability F1 for r=0.6 = 0.978 +- 0.039
Intervened Stability F1 for r=0.6 = 0.914 +- 0.069
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:22:40 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:22:40 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:22:52 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:22:54 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:22:56 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:22:59 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:23:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 44...
[0m[1;37mINFO[0m: [1mCheckpoint 44: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.5320
ID Validation ACCURACY: 0.8943
ID Validation Loss: 0.4871
ID Test ACCURACY: 0.8910
ID Test Loss: 0.5314
OOD Validation ACCURACY: 0.6970
OOD Validation Loss: 0.9031
OOD Test ACCURACY: 0.5007
OOD Test Loss: 6.0511

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 11...
[0m[1;37mINFO[0m: [1mCheckpoint 11: 
-----------------------------------
Train ACCURACY: 0.8831
Train Loss: 0.5175
ID Validation ACCURACY: 0.8833
ID Validation Loss: 0.4767
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5135
OOD Validation ACCURACY: 0.7723
OOD Validation Loss: 0.6911
OOD Test ACCURACY: 0.4477
OOD Test Loss: 2.0349

[0m[1;37mINFO[0m: [1mChartInfo 0.8910 0.5007 0.8860 0.4477 0.8833 0.7723[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.402
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.415
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.505
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.271
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.277


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.548625
Plausibility completed in  0:00:05.279433
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4905, device='cuda:1')  +-  tensor(0.2981, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5545, device='cuda:1')  +-  tensor(0.3118, device='cuda:1') (0.040)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4905, device='cuda:1')  +-  tensor(0.2981, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6140, device='cuda:1')  +-  tensor(0.1829, device='cuda:1') (0.046)
Original Stability MCC for r=0.3 = 0.989 +- 0.052
Intervened Stability MCC for r=0.3 = 0.415 +- 0.397
Original Stability F1 for r=0.3 = 0.993 +- 0.035
Intervened Stability F1 for r=0.3 = 0.683 +- 0.203
Intervened samples: 793


ratio=0.6


Interventions completed in  0:00:01.496078
Plausibility completed in  0:00:04.914031
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4890, device='cuda:1')  +-  tensor(0.3009, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4845, device='cuda:1')  +-  tensor(0.3023, device='cuda:1') (0.018)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4890, device='cuda:1')  +-  tensor(0.3009, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8550, device='cuda:1')  +-  tensor(0.2084, device='cuda:1') (0.020)
Original Stability MCC for r=0.6 = 0.989 +- 0.044
Intervened Stability MCC for r=0.6 = 0.341 +- 0.454
Original Stability F1 for r=0.6 = 0.996 +- 0.016
Intervened Stability F1 for r=0.6 = 0.889 +- 0.111
Intervened samples: 766


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.646729
Plausibility completed in  0:00:05.161487
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5043, device='cuda:1')  +-  tensor(0.3026, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5566, device='cuda:1')  +-  tensor(0.3217, device='cuda:1') (0.040)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5043, device='cuda:1')  +-  tensor(0.3026, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6151, device='cuda:1')  +-  tensor(0.1974, device='cuda:1') (0.045)
Original Stability MCC for r=0.3 = 0.987 +- 0.053
Intervened Stability MCC for r=0.3 = 0.425 +- 0.415
Original Stability F1 for r=0.3 = 0.992 +- 0.034
Intervened Stability F1 for r=0.3 = 0.693 +- 0.209
Intervened samples: 783


ratio=0.6


Interventions completed in  0:00:01.604317
Plausibility completed in  0:00:04.772792
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4908, device='cuda:1')  +-  tensor(0.3109, device='cuda:1') (0.018)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5061, device='cuda:1')  +-  tensor(0.3062, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8434, device='cuda:1')  +-  tensor(0.2370, device='cuda:1') (0.019)
Original Stability MCC for r=0.6 = 0.988 +- 0.050
Intervened Stability MCC for r=0.6 = 0.318 +- 0.459
Original Stability F1 for r=0.6 = 0.996 +- 0.017
Intervened Stability F1 for r=0.6 = 0.892 +- 0.112
Intervened samples: 752


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.631881
Plausibility completed in  0:00:05.377103
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2814, device='cuda:1')  +-  tensor(0.3742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2783, device='cuda:1')  +-  tensor(0.3713, device='cuda:1') (0.012)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2814, device='cuda:1')  +-  tensor(0.3742, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6851, device='cuda:1')  +-  tensor(0.1790, device='cuda:1') (0.027)
Original Stability MCC for r=0.3 = 0.956 +- 0.079
Intervened Stability MCC for r=0.3 = 0.492 +- 0.269
Original Stability F1 for r=0.3 = 0.972 +- 0.053
Intervened Stability F1 for r=0.3 = 0.713 +- 0.158
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.590367
Plausibility completed in  0:00:05.090203
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2592, device='cuda:1')  +-  tensor(0.3576, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2517, device='cuda:1')  +-  tensor(0.3517, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2592, device='cuda:1')  +-  tensor(0.3576, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9030, device='cuda:1')  +-  tensor(0.1775, device='cuda:1') (0.012)
Original Stability MCC for r=0.6 = 0.932 +- 0.130
Intervened Stability MCC for r=0.6 = 0.364 +- 0.304
Original Stability F1 for r=0.6 = 0.978 +- 0.040
Intervened Stability F1 for r=0.6 = 0.912 +- 0.072
Intervened samples: 776
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:24:06 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:06 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:18 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:20 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:22 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:25 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:24:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 64...
[0m[1;37mINFO[0m: [1mCheckpoint 64: 
-----------------------------------
Train ACCURACY: 0.8937
Train Loss: 0.5698
ID Validation ACCURACY: 0.9000
ID Validation Loss: 0.5288
ID Test ACCURACY: 0.8943
ID Test Loss: 0.5798
OOD Validation ACCURACY: 0.6730
OOD Validation Loss: 1.3851
OOD Test ACCURACY: 0.4563
OOD Test Loss: 4.4608

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.8583
Train Loss: 0.7164
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.6880
ID Test ACCURACY: 0.8517
ID Test Loss: 0.7220
OOD Validation ACCURACY: 0.7457
OOD Validation Loss: 1.4504
OOD Test ACCURACY: 0.4083
OOD Test Loss: 6.2487

[0m[1;37mINFO[0m: [1mChartInfo 0.8943 0.4563 0.8517 0.4083 0.8650 0.7457[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.450
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.493
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.458
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.515
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.278
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.279


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.689626
Plausibility completed in  0:00:04.997719
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4960, device='cuda:1')  +-  tensor(0.2979, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5790, device='cuda:1')  +-  tensor(0.3198, device='cuda:1') (0.047)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4960, device='cuda:1')  +-  tensor(0.2979, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6109, device='cuda:1')  +-  tensor(0.1864, device='cuda:1') (0.052)
Original Stability MCC for r=0.3 = 0.982 +- 0.063
Intervened Stability MCC for r=0.3 = 0.431 +- 0.404
Original Stability F1 for r=0.3 = 0.988 +- 0.042
Intervened Stability F1 for r=0.3 = 0.690 +- 0.205
Intervened samples: 793


ratio=0.6


Interventions completed in  0:00:01.636695
Plausibility completed in  0:00:04.866733
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4947, device='cuda:1')  +-  tensor(0.3000, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4993, device='cuda:1')  +-  tensor(0.3038, device='cuda:1') (0.020)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4947, device='cuda:1')  +-  tensor(0.3000, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8617, device='cuda:1')  +-  tensor(0.1994, device='cuda:1') (0.021)
Original Stability MCC for r=0.6 = 0.986 +- 0.053
Intervened Stability MCC for r=0.6 = 0.368 +- 0.461
Original Stability F1 for r=0.6 = 0.995 +- 0.019
Intervened Stability F1 for r=0.6 = 0.896 +- 0.109
Intervened samples: 770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.504912
Plausibility completed in  0:00:05.075608
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5109, device='cuda:1')  +-  tensor(0.3033, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5871, device='cuda:1')  +-  tensor(0.3310, device='cuda:1') (0.046)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5109, device='cuda:1')  +-  tensor(0.3033, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6079, device='cuda:1')  +-  tensor(0.2022, device='cuda:1') (0.050)
Original Stability MCC for r=0.3 = 0.982 +- 0.061
Intervened Stability MCC for r=0.3 = 0.430 +- 0.415
Original Stability F1 for r=0.3 = 0.988 +- 0.040
Intervened Stability F1 for r=0.3 = 0.690 +- 0.213
Intervened samples: 783


ratio=0.6


Interventions completed in  0:00:01.450117
Plausibility completed in  0:00:04.747413
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5120, device='cuda:1')  +-  tensor(0.3056, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5088, device='cuda:1')  +-  tensor(0.3209, device='cuda:1') (0.017)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5120, device='cuda:1')  +-  tensor(0.3056, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8479, device='cuda:1')  +-  tensor(0.2361, device='cuda:1') (0.018)
Original Stability MCC for r=0.6 = 0.980 +- 0.078
Intervened Stability MCC for r=0.6 = 0.369 +- 0.470
Original Stability F1 for r=0.6 = 0.993 +- 0.027
Intervened Stability F1 for r=0.6 = 0.901 +- 0.110
Intervened samples: 753


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.775024
Plausibility completed in  0:00:05.212872
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2819, device='cuda:1')  +-  tensor(0.3739, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2836, device='cuda:1')  +-  tensor(0.3695, device='cuda:1') (0.014)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2819, device='cuda:1')  +-  tensor(0.3739, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6987, device='cuda:1')  +-  tensor(0.1782, device='cuda:1') (0.031)
Original Stability MCC for r=0.3 = 0.900 +- 0.159
Intervened Stability MCC for r=0.3 = 0.512 +- 0.270
Original Stability F1 for r=0.3 = 0.935 +- 0.105
Intervened Stability F1 for r=0.3 = 0.726 +- 0.165
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.756457
Plausibility completed in  0:00:05.089610
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2616, device='cuda:1')  +-  tensor(0.3588, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2650, device='cuda:1')  +-  tensor(0.3521, device='cuda:1') (0.007)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2616, device='cuda:1')  +-  tensor(0.3588, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9098, device='cuda:1')  +-  tensor(0.1743, device='cuda:1') (0.011)
Original Stability MCC for r=0.6 = 0.938 +- 0.112
Intervened Stability MCC for r=0.6 = 0.306 +- 0.320
Original Stability F1 for r=0.6 = 0.978 +- 0.040
Intervened Stability F1 for r=0.6 = 0.905 +- 0.074
Intervened samples: 778
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:25:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:30 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:46 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:49 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:25:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.5158
ID Validation ACCURACY: 0.8807
ID Validation Loss: 0.4789
ID Test ACCURACY: 0.8773
ID Test Loss: 0.5165
OOD Validation ACCURACY: 0.6493
OOD Validation Loss: 1.1427
OOD Test ACCURACY: 0.4040
OOD Test Loss: 2.8675

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 51...
[0m[1;37mINFO[0m: [1mCheckpoint 51: 
-----------------------------------
Train ACCURACY: 0.8559
Train Loss: 0.5232
ID Validation ACCURACY: 0.8650
ID Validation Loss: 0.4809
ID Test ACCURACY: 0.8633
ID Test Loss: 0.5159
OOD Validation ACCURACY: 0.7123
OOD Validation Loss: 0.8312
OOD Test ACCURACY: 0.3543
OOD Test Loss: 8.7485

[0m[1;37mINFO[0m: [1mChartInfo 0.8773 0.4040 0.8633 0.3543 0.8650 0.7123[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.511
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.572
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.509
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.585
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.504
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.486


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.524936
Plausibility completed in  0:00:04.993181
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5570, device='cuda:1')  +-  tensor(0.2691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5749, device='cuda:1')  +-  tensor(0.3277, device='cuda:1') (0.058)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5570, device='cuda:1')  +-  tensor(0.2691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5702, device='cuda:1')  +-  tensor(0.1939, device='cuda:1') (0.056)
Original Stability MCC for r=0.3 = 0.970 +- 0.094
Intervened Stability MCC for r=0.3 = 0.484 +- 0.397
Original Stability F1 for r=0.3 = 0.980 +- 0.061
Intervened Stability F1 for r=0.3 = 0.711 +- 0.215
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.673626
Plausibility completed in  0:00:04.995398
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5567, device='cuda:1')  +-  tensor(0.2692, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5489, device='cuda:1')  +-  tensor(0.3058, device='cuda:1') (0.017)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5567, device='cuda:1')  +-  tensor(0.2692, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8849, device='cuda:1')  +-  tensor(0.1441, device='cuda:1') (0.016)
Original Stability MCC for r=0.6 = 0.973 +- 0.093
Intervened Stability MCC for r=0.6 = 0.387 +- 0.455
Original Stability F1 for r=0.6 = 0.991 +- 0.032
Intervened Stability F1 for r=0.6 = 0.899 +- 0.110
Intervened samples: 792


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.641878
Plausibility completed in  0:00:04.927931
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5707, device='cuda:1')  +-  tensor(0.2669, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5873, device='cuda:1')  +-  tensor(0.3309, device='cuda:1') (0.050)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.5707, device='cuda:1')  +-  tensor(0.2669, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5732, device='cuda:1')  +-  tensor(0.2064, device='cuda:1') (0.048)
Original Stability MCC for r=0.3 = 0.976 +- 0.079
Intervened Stability MCC for r=0.3 = 0.498 +- 0.396
Original Stability F1 for r=0.3 = 0.984 +- 0.052
Intervened Stability F1 for r=0.3 = 0.720 +- 0.215
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.659754
Plausibility completed in  0:00:04.934800
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5704, device='cuda:1')  +-  tensor(0.2671, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5592, device='cuda:1')  +-  tensor(0.3085, device='cuda:1') (0.014)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.5704, device='cuda:1')  +-  tensor(0.2671, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8806, device='cuda:1')  +-  tensor(0.1696, device='cuda:1') (0.015)
Original Stability MCC for r=0.6 = 0.973 +- 0.101
Intervened Stability MCC for r=0.6 = 0.414 +- 0.453
Original Stability F1 for r=0.6 = 0.990 +- 0.034
Intervened Stability F1 for r=0.6 = 0.905 +- 0.106
Intervened samples: 783


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.637202
Plausibility completed in  0:00:05.369974
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4823, device='cuda:1')  +-  tensor(0.3619, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3068, device='cuda:1')  +-  tensor(0.3575, device='cuda:1') (0.016)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4823, device='cuda:1')  +-  tensor(0.3619, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6616, device='cuda:1')  +-  tensor(0.2227, device='cuda:1') (0.035)
Original Stability MCC for r=0.3 = 0.965 +- 0.060
Intervened Stability MCC for r=0.3 = 0.526 +- 0.370
Original Stability F1 for r=0.3 = 0.977 +- 0.041
Intervened Stability F1 for r=0.3 = 0.712 +- 0.239
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.629603
Plausibility completed in  0:00:05.207265
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4823, device='cuda:1')  +-  tensor(0.3619, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3041, device='cuda:1')  +-  tensor(0.3610, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4823, device='cuda:1')  +-  tensor(0.3619, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9124, device='cuda:1')  +-  tensor(0.1586, device='cuda:1') (0.010)
Original Stability MCC for r=0.6 = 0.875 +- 0.225
Intervened Stability MCC for r=0.6 = 0.220 +- 0.345
Original Stability F1 for r=0.6 = 0.973 +- 0.042
Intervened Stability F1 for r=0.6 = 0.891 +- 0.127
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_CIGAGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Sep 10 12:26:55 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/10/2024 12:26:55 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:07 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:09 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:11 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:14 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1m Init CIGAGIN
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mCreating GINFeatExtractor:  3
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mUsing  1  layers for classifier
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mUsing feature sampling = feat
[0m[1;34mDEBUG[0m: 09/10/2024 12:27:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 37...
[0m[1;37mINFO[0m: [1mCheckpoint 37: 
-----------------------------------
Train ACCURACY: 0.8598
Train Loss: 0.5187
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4867
ID Test ACCURACY: 0.8650
ID Test Loss: 0.5182
OOD Validation ACCURACY: 0.6850
OOD Validation Loss: 0.7691
OOD Test ACCURACY: 0.3613
OOD Test Loss: 3.5062

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 48...
[0m[1;37mINFO[0m: [1mCheckpoint 48: 
-----------------------------------
Train ACCURACY: 0.8180
Train Loss: 0.7026
ID Validation ACCURACY: 0.8267
ID Validation Loss: 0.6541
ID Test ACCURACY: 0.8193
ID Test Loss: 0.6900
OOD Validation ACCURACY: 0.8000
OOD Validation Loss: 0.6826
OOD Test ACCURACY: 0.4330
OOD Test Loss: 1.3960

[0m[1;37mINFO[0m: [1mChartInfo 0.8650 0.3613 0.8193 0.4330 0.8267 0.8000[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.583
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.697
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.589
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.711
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.374
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.360


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.696984
Plausibility completed in  0:00:05.005634
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7025, device='cuda:1')  +-  tensor(0.2739, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6800, device='cuda:1')  +-  tensor(0.3479, device='cuda:1') (0.041)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7025, device='cuda:1')  +-  tensor(0.2739, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6229, device='cuda:1')  +-  tensor(0.2234, device='cuda:1') (0.043)
Original Stability MCC for r=0.3 = 0.987 +- 0.064
Intervened Stability MCC for r=0.3 = 0.413 +- 0.487
Original Stability F1 for r=0.3 = 0.991 +- 0.042
Intervened Stability F1 for r=0.3 = 0.672 +- 0.269
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.530242
Plausibility completed in  0:00:05.179330
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7028, device='cuda:1')  +-  tensor(0.2740, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6529, device='cuda:1')  +-  tensor(0.3331, device='cuda:1') (0.022)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7028, device='cuda:1')  +-  tensor(0.2740, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9225, device='cuda:1')  +-  tensor(0.1294, device='cuda:1') (0.015)
Original Stability MCC for r=0.6 = 0.990 +- 0.046
Intervened Stability MCC for r=0.6 = 0.343 +- 0.427
Original Stability F1 for r=0.6 = 0.996 +- 0.017
Intervened Stability F1 for r=0.6 = 0.912 +- 0.092
Intervened samples: 793


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.509573
Plausibility completed in  0:00:04.933923
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7159, device='cuda:1')  +-  tensor(0.2672, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6877, device='cuda:1')  +-  tensor(0.3532, device='cuda:1') (0.037)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.7159, device='cuda:1')  +-  tensor(0.2672, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.6167, device='cuda:1')  +-  tensor(0.2323, device='cuda:1') (0.040)
Original Stability MCC for r=0.3 = 0.985 +- 0.061
Intervened Stability MCC for r=0.3 = 0.392 +- 0.501
Original Stability F1 for r=0.3 = 0.990 +- 0.040
Intervened Stability F1 for r=0.3 = 0.660 +- 0.278
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.665644
Plausibility completed in  0:00:04.934649
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7162, device='cuda:1')  +-  tensor(0.2673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6675, device='cuda:1')  +-  tensor(0.3387, device='cuda:1') (0.021)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.7162, device='cuda:1')  +-  tensor(0.2673, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9149, device='cuda:1')  +-  tensor(0.1628, device='cuda:1') (0.014)
Original Stability MCC for r=0.6 = 0.990 +- 0.052
Intervened Stability MCC for r=0.6 = 0.371 +- 0.447
Original Stability F1 for r=0.6 = 0.997 +- 0.018
Intervened Stability F1 for r=0.6 = 0.915 +- 0.093
Intervened samples: 784


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.643449
Plausibility completed in  0:00:05.399464
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3567, device='cuda:1')  +-  tensor(0.3416, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3378, device='cuda:1')  +-  tensor(0.3559, device='cuda:1') (0.017)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3567, device='cuda:1')  +-  tensor(0.3416, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.7110, device='cuda:1')  +-  tensor(0.2761, device='cuda:1') (0.030)
Original Stability MCC for r=0.3 = 0.961 +- 0.072
Intervened Stability MCC for r=0.3 = 0.394 +- 0.559
Original Stability F1 for r=0.3 = 0.974 +- 0.049
Intervened Stability F1 for r=0.3 = 0.632 +- 0.349
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.638069
Plausibility completed in  0:00:05.248386
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3567, device='cuda:1')  +-  tensor(0.3416, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3343, device='cuda:1')  +-  tensor(0.3517, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3567, device='cuda:1')  +-  tensor(0.3416, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.9535, device='cuda:1')  +-  tensor(0.0972, device='cuda:1') (0.006)
Original Stability MCC for r=0.6 = 0.941 +- 0.200
Intervened Stability MCC for r=0.6 = 0.271 +- 0.345
Original Stability F1 for r=0.6 = 0.996 +- 0.009
Intervened Stability F1 for r=0.6 = 0.908 +- 0.090
Intervened samples: 800


DONE GOODMotif - CIGAGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.55126558 0.54993156] +- [0.07917589 0.08008435] (mean across ratios: 0.551)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.59791634 0.54357038] +- [0.0436335  0.05925386] (mean across ratios: 0.571)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.61567637 0.92960235] +- [0.0420056  0.02091083] (mean across ratios: 0.773)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.61067886 0.88179319] +- [0.02193265 0.02363671] (mean across ratios: 0.746)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9879752  0.99434702] +- [0.00427536 0.00211992] (mean across ratios: 0.991)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.68735576 0.89922974] +- [0.01325103 0.00725756] (mean across ratios: 0.793)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.98189492 0.98445212] +- [0.00653627 0.00604993] (mean across ratios: 0.983)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.43086438 0.3582734 ] +- [0.02740475 0.0173888 ] (mean across ratios: 0.395)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.56524796 0.56497234] +- [0.07883169 0.07897684] (mean across ratios: 0.565)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.6058355  0.55357204] +- [0.0443576 0.0618152] (mean across ratios: 0.580)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.61411091 0.92653117] +- [0.04172409 0.0213188 ] (mean across ratios: 0.770)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.60932869 0.87272958] +- [0.0199568  0.02582004] (mean across ratios: 0.741)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.9879696  0.99370006] +- [0.0027117  0.00216297] (mean across ratios: 0.991)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.6887156  0.90318689] +- [0.01946366 0.00755182] (mean across ratios: 0.796)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.98185871 0.9824609 ] +- [0.00412022 0.00608733] (mean across ratios: 0.982)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.43076501 0.36844587] +- [0.03612455 0.03055433] (mean across ratios: 0.400)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.337335   0.32882875] +- [0.07796338 0.08446557] (mean across ratios: 0.333)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.30095055 0.28898464] +- [0.02104086 0.02914298] (mean across ratios: 0.295)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.74341848 0.95033708] +- [0.079089   0.02561721] (mean across ratios: 0.847)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.69553869 0.92377534] +- [0.02085741 0.01955288] (mean across ratios: 0.810)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.96734073 0.98068051] +- [0.01627788 0.00793271] (mean across ratios: 0.974)
(id) (test) STABILITY_F1_PERTURBED: 	[0.7032238  0.90573639] +- [0.03651068 0.00808583] (mean across ratios: 0.804)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.95013471 0.91688519] +- [0.02527214 0.02610391] (mean across ratios: 0.934)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.49074441 0.30064813] +- [0.05011908 0.05132683] (mean across ratios: 0.396)

Overall time of execution:  0:07:08.736370
DONE CIGA GOODMotif/size 0.10


I'm the stability of the DET :))
The PID of this script is: 2780462
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 14:57:03 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 02:57:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9222
Train Loss: 0.3693
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3559
ID Test ACCURACY: 0.9203
ID Test Loss: 0.3852
OOD Validation ACCURACY: 0.8900
OOD Validation Loss: 0.4914
OOD Test ACCURACY: 0.5517
OOD Test Loss: 1.5316

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9157
Train Loss: 0.3791
ID Validation ACCURACY: 0.9230
ID Validation Loss: 0.3661
ID Test ACCURACY: 0.9137
ID Test Loss: 0.3922
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.4447
OOD Test ACCURACY: 0.6490
OOD Test Loss: 1.4331

[0m[1;37mINFO[0m: [1mChartInfo 0.9203 0.5517 0.9137 0.6490 0.9230 0.9270[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.502
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.430
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.493
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.423
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.401
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.245
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.450
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.309


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.645644
Plausibility completed in  0:00:05.074984
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3139, device='cuda:1')  +-  tensor(0.1573, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3528, device='cuda:1')  +-  tensor(0.2081, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3139, device='cuda:1')  +-  tensor(0.1573, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3642, device='cuda:1')  +-  tensor(0.0743, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.994 +- 0.052
Intervened Stability MCC for r=0.3 = 0.025 +- 0.241
Original Stability F1 for r=0.3 = 0.996 +- 0.035
Intervened Stability F1 for r=0.3 = 0.347 +- 0.161
Intervened samples: 784


ratio=0.6


Interventions completed in  0:00:01.452668
Plausibility completed in  0:00:05.061679
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3093, device='cuda:1')  +-  tensor(0.1529, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3421, device='cuda:1')  +-  tensor(0.2040, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3093, device='cuda:1')  +-  tensor(0.1529, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6853, device='cuda:1')  +-  tensor(0.1413, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.030
Intervened Stability MCC for r=0.6 = 0.075 +- 0.278
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.717 +- 0.101
Intervened samples: 774


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.584407
Plausibility completed in  0:00:05.063692
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3078, device='cuda:1')  +-  tensor(0.1578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3463, device='cuda:1')  +-  tensor(0.2081, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3078, device='cuda:1')  +-  tensor(0.1578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3652, device='cuda:1')  +-  tensor(0.0728, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.998 +- 0.023
Intervened Stability MCC for r=0.3 = 0.012 +- 0.242
Original Stability F1 for r=0.3 = 0.998 +- 0.016
Intervened Stability F1 for r=0.3 = 0.340 +- 0.162
Intervened samples: 786


ratio=0.6


Interventions completed in  0:00:01.595232
Plausibility completed in  0:00:04.987840
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3027, device='cuda:1')  +-  tensor(0.1529, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3344, device='cuda:1')  +-  tensor(0.2029, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3027, device='cuda:1')  +-  tensor(0.1529, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6836, device='cuda:1')  +-  tensor(0.1385, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.996 +- 0.041
Intervened Stability MCC for r=0.6 = 0.085 +- 0.271
Original Stability F1 for r=0.6 = 0.999 +- 0.013
Intervened Stability F1 for r=0.6 = 0.717 +- 0.101
Intervened samples: 775


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.492843
Plausibility completed in  0:00:05.344106
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1675, device='cuda:1')  +-  tensor(0.0467, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1791, device='cuda:1')  +-  tensor(0.0546, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1675, device='cuda:1')  +-  tensor(0.0467, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3502, device='cuda:1')  +-  tensor(0.0188, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.997 +- 0.019
Intervened Stability MCC for r=0.3 = 0.019 +- 0.190
Original Stability F1 for r=0.3 = 0.998 +- 0.013
Intervened Stability F1 for r=0.3 = 0.346 +- 0.127
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.501654
Plausibility completed in  0:00:05.190346
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1675, device='cuda:1')  +-  tensor(0.0467, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1794, device='cuda:1')  +-  tensor(0.0549, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1675, device='cuda:1')  +-  tensor(0.0467, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6768, device='cuda:1')  +-  tensor(0.0255, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.018
Intervened Stability MCC for r=0.6 = 0.004 +- 0.189
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.671 +- 0.069
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.624652
Plausibility completed in  0:00:05.140058
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2575, device='cuda:1')  +-  tensor(0.0985, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2864, device='cuda:1')  +-  tensor(0.1192, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2575, device='cuda:1')  +-  tensor(0.0985, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3713, device='cuda:1')  +-  tensor(0.0378, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 1.000 +- 0.006
Intervened Stability MCC for r=0.3 = 0.124 +- 0.280
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.425 +- 0.174
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.484640
Plausibility completed in  0:00:05.141665
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2575, device='cuda:1')  +-  tensor(0.0985, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2871, device='cuda:1')  +-  tensor(0.1203, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2575, device='cuda:1')  +-  tensor(0.0985, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6943, device='cuda:1')  +-  tensor(0.0576, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.995 +- 0.027
Intervened Stability MCC for r=0.6 = 0.141 +- 0.231
Original Stability F1 for r=0.6 = 0.998 +- 0.011
Intervened Stability F1 for r=0.6 = 0.721 +- 0.098
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 14:58:16 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 02:58:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.9236
Train Loss: 0.3823
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3640
ID Test ACCURACY: 0.9223
ID Test Loss: 0.3970
OOD Validation ACCURACY: 0.9163
OOD Validation Loss: 0.4602
OOD Test ACCURACY: 0.6380
OOD Test Loss: 1.7702

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9191
Train Loss: 0.3765
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3656
ID Test ACCURACY: 0.9180
ID Test Loss: 0.3905
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.4647
OOD Test ACCURACY: 0.5130
OOD Test Loss: 1.8937

[0m[1;37mINFO[0m: [1mChartInfo 0.9223 0.6380 0.9180 0.5130 0.9240 0.9257[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.484
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.401
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.397
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.393
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.223
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.425
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.303


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.779569
Plausibility completed in  0:00:05.160278
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3193, device='cuda:1')  +-  tensor(0.1608, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3686, device='cuda:1')  +-  tensor(0.2119, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3193, device='cuda:1')  +-  tensor(0.1608, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3754, device='cuda:1')  +-  tensor(0.0589, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.992 +- 0.052
Intervened Stability MCC for r=0.3 = 0.007 +- 0.248
Original Stability F1 for r=0.3 = 0.994 +- 0.035
Intervened Stability F1 for r=0.3 = 0.346 +- 0.165
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.452095
Plausibility completed in  0:00:05.180217
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3103, device='cuda:1')  +-  tensor(0.1543, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3443, device='cuda:1')  +-  tensor(0.2047, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3103, device='cuda:1')  +-  tensor(0.1543, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6976, device='cuda:1')  +-  tensor(0.1406, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.048 +- 0.272
Original Stability F1 for r=0.6 = 1.000 +- 0.006
Intervened Stability F1 for r=0.6 = 0.715 +- 0.106
Intervened samples: 777


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.485537
Plausibility completed in  0:00:05.145032
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3128, device='cuda:1')  +-  tensor(0.1608, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3602, device='cuda:1')  +-  tensor(0.2118, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3128, device='cuda:1')  +-  tensor(0.1608, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3731, device='cuda:1')  +-  tensor(0.0570, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.990 +- 0.060
Intervened Stability MCC for r=0.3 = 0.023 +- 0.251
Original Stability F1 for r=0.3 = 0.993 +- 0.040
Intervened Stability F1 for r=0.3 = 0.354 +- 0.167
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.603708
Plausibility completed in  0:00:05.004507
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3036, device='cuda:1')  +-  tensor(0.1539, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3361, device='cuda:1')  +-  tensor(0.2039, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3036, device='cuda:1')  +-  tensor(0.1539, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6937, device='cuda:1')  +-  tensor(0.1390, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.038 +- 0.275
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.707 +- 0.105
Intervened samples: 777


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.503245
Plausibility completed in  0:00:05.184997
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1664, device='cuda:1')  +-  tensor(0.0474, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1796, device='cuda:1')  +-  tensor(0.0553, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1664, device='cuda:1')  +-  tensor(0.0474, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3488, device='cuda:1')  +-  tensor(0.0176, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.998 +- 0.017
Intervened Stability MCC for r=0.3 = 0.019 +- 0.189
Original Stability F1 for r=0.3 = 0.998 +- 0.012
Intervened Stability F1 for r=0.3 = 0.346 +- 0.126
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.657006
Plausibility completed in  0:00:05.189241
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1664, device='cuda:1')  +-  tensor(0.0474, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1796, device='cuda:1')  +-  tensor(0.0553, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1664, device='cuda:1')  +-  tensor(0.0474, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6782, device='cuda:1')  +-  tensor(0.0272, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.027
Intervened Stability MCC for r=0.6 = 0.017 +- 0.189
Original Stability F1 for r=0.6 = 0.998 +- 0.010
Intervened Stability F1 for r=0.6 = 0.675 +- 0.068
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.626456
Plausibility completed in  0:00:05.133141
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2584, device='cuda:1')  +-  tensor(0.0976, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2869, device='cuda:1')  +-  tensor(0.1188, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2584, device='cuda:1')  +-  tensor(0.0976, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3600, device='cuda:1')  +-  tensor(0.0309, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.998 +- 0.015
Intervened Stability MCC for r=0.3 = 0.051 +- 0.220
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.363 +- 0.149
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.489308
Plausibility completed in  0:00:05.319244
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2584, device='cuda:1')  +-  tensor(0.0976, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2868, device='cuda:1')  +-  tensor(0.1189, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2584, device='cuda:1')  +-  tensor(0.0976, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6800, device='cuda:1')  +-  tensor(0.0450, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.991 +- 0.037
Intervened Stability MCC for r=0.6 = 0.115 +- 0.227
Original Stability F1 for r=0.6 = 0.997 +- 0.014
Intervened Stability F1 for r=0.6 = 0.699 +- 0.097
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 14:59:28 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 02:59:28 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 0.9211
Train Loss: 0.3738
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3569
ID Test ACCURACY: 0.9193
ID Test Loss: 0.3863
OOD Validation ACCURACY: 0.8863
OOD Validation Loss: 0.4868
OOD Test ACCURACY: 0.6483
OOD Test Loss: 1.2024

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9178
Train Loss: 0.3688
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3548
ID Test ACCURACY: 0.9177
ID Test Loss: 0.3860
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.4565
OOD Test ACCURACY: 0.6407
OOD Test Loss: 1.2257

[0m[1;37mINFO[0m: [1mChartInfo 0.9193 0.6483 0.9177 0.6407 0.9257 0.9277[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.521
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.419
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.508
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.410
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.237
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.406
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.340


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.643231
Plausibility completed in  0:00:05.114813
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3187, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3674, device='cuda:1')  +-  tensor(0.2113, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3187, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3752, device='cuda:1')  +-  tensor(0.0569, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.998 +- 0.025
Intervened Stability MCC for r=0.3 = 0.017 +- 0.257
Original Stability F1 for r=0.3 = 0.998 +- 0.017
Intervened Stability F1 for r=0.3 = 0.349 +- 0.171
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.493427
Plausibility completed in  0:00:05.313032
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3187, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3634, device='cuda:1')  +-  tensor(0.2044, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3187, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7089, device='cuda:1')  +-  tensor(0.0653, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.015
Intervened Stability MCC for r=0.6 = 0.054 +- 0.292
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.715 +- 0.097
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.483604
Plausibility completed in  0:00:05.133854
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3119, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3587, device='cuda:1')  +-  tensor(0.2111, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3119, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3734, device='cuda:1')  +-  tensor(0.0565, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.993 +- 0.045
Intervened Stability MCC for r=0.3 = 0.019 +- 0.257
Original Stability F1 for r=0.3 = 0.995 +- 0.031
Intervened Stability F1 for r=0.3 = 0.349 +- 0.171
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.646242
Plausibility completed in  0:00:05.169134
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3119, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3551, device='cuda:1')  +-  tensor(0.2041, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3119, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7062, device='cuda:1')  +-  tensor(0.0650, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.016
Intervened Stability MCC for r=0.6 = 0.051 +- 0.291
Original Stability F1 for r=0.6 = 1.000 +- 0.006
Intervened Stability F1 for r=0.6 = 0.711 +- 0.100
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.504351
Plausibility completed in  0:00:05.317020
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1678, device='cuda:1')  +-  tensor(0.0469, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1784, device='cuda:1')  +-  tensor(0.0548, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1678, device='cuda:1')  +-  tensor(0.0469, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3480, device='cuda:1')  +-  tensor(0.0172, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.997 +- 0.019
Intervened Stability MCC for r=0.3 = 0.014 +- 0.186
Original Stability F1 for r=0.3 = 0.998 +- 0.013
Intervened Stability F1 for r=0.3 = 0.342 +- 0.126
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.505728
Plausibility completed in  0:00:05.180551
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1678, device='cuda:1')  +-  tensor(0.0469, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1784, device='cuda:1')  +-  tensor(0.0551, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1678, device='cuda:1')  +-  tensor(0.0469, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6766, device='cuda:1')  +-  tensor(0.0257, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.995 +- 0.025
Intervened Stability MCC for r=0.6 = 0.004 +- 0.188
Original Stability F1 for r=0.6 = 0.998 +- 0.010
Intervened Stability F1 for r=0.6 = 0.670 +- 0.069
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.625637
Plausibility completed in  0:00:05.109804
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2579, device='cuda:1')  +-  tensor(0.1004, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2859, device='cuda:1')  +-  tensor(0.1202, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2579, device='cuda:1')  +-  tensor(0.1004, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3694, device='cuda:1')  +-  tensor(0.0381, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.997 +- 0.020
Intervened Stability MCC for r=0.3 = 0.033 +- 0.242
Original Stability F1 for r=0.3 = 0.998 +- 0.014
Intervened Stability F1 for r=0.3 = 0.360 +- 0.159
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.660559
Plausibility completed in  0:00:05.142586
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2579, device='cuda:1')  +-  tensor(0.1004, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2854, device='cuda:1')  +-  tensor(0.1197, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2579, device='cuda:1')  +-  tensor(0.1004, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6946, device='cuda:1')  +-  tensor(0.0616, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.013
Intervened Stability MCC for r=0.6 = 0.051 +- 0.232
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.698 +- 0.080
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:00:39 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:00:39 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9218
Train Loss: 0.3744
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3613
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3906
OOD Validation ACCURACY: 0.7447
OOD Validation Loss: 0.5801
OOD Test ACCURACY: 0.5590
OOD Test Loss: 1.9371

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 19...
[0m[1;37mINFO[0m: [1mCheckpoint 19: 
-----------------------------------
Train ACCURACY: 0.9174
Train Loss: 0.3778
ID Validation ACCURACY: 0.9213
ID Validation Loss: 0.3598
ID Test ACCURACY: 0.9153
ID Test Loss: 0.3903
OOD Validation ACCURACY: 0.9237
OOD Validation Loss: 0.4252
OOD Test ACCURACY: 0.4633
OOD Test Loss: 2.5793

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.5590 0.9153 0.4633 0.9213 0.9237[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.541
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.440
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.538
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.456
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.487
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.320


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.646690
Plausibility completed in  0:00:05.121544
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3216, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3703, device='cuda:1')  +-  tensor(0.2128, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3216, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3780, device='cuda:1')  +-  tensor(0.0588, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.994 +- 0.045
Intervened Stability MCC for r=0.3 = 0.007 +- 0.252
Original Stability F1 for r=0.3 = 0.996 +- 0.031
Intervened Stability F1 for r=0.3 = 0.344 +- 0.169
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.637166
Plausibility completed in  0:00:05.112920
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3216, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3669, device='cuda:1')  +-  tensor(0.2063, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3216, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7135, device='cuda:1')  +-  tensor(0.0689, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.021
Intervened Stability MCC for r=0.6 = 0.030 +- 0.273
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.707 +- 0.098
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.483117
Plausibility completed in  0:00:05.265766
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3150, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3619, device='cuda:1')  +-  tensor(0.2128, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3150, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3751, device='cuda:1')  +-  tensor(0.0575, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.034
Intervened Stability MCC for r=0.3 = 0.012 +- 0.253
Original Stability F1 for r=0.3 = 0.998 +- 0.023
Intervened Stability F1 for r=0.3 = 0.345 +- 0.171
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.491704
Plausibility completed in  0:00:05.099639
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3150, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3585, device='cuda:1')  +-  tensor(0.2062, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3150, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7081, device='cuda:1')  +-  tensor(0.0658, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.014
Intervened Stability MCC for r=0.6 = 0.036 +- 0.271
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.705 +- 0.099
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.638053
Plausibility completed in  0:00:05.175393
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1682, device='cuda:1')  +-  tensor(0.0472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1798, device='cuda:1')  +-  tensor(0.0549, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1682, device='cuda:1')  +-  tensor(0.0472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3516, device='cuda:1')  +-  tensor(0.0192, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.997 +- 0.022
Intervened Stability MCC for r=0.3 = 0.014 +- 0.184
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.340 +- 0.124
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.663953
Plausibility completed in  0:00:05.179665
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1682, device='cuda:1')  +-  tensor(0.0472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1805, device='cuda:1')  +-  tensor(0.0548, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1682, device='cuda:1')  +-  tensor(0.0472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6765, device='cuda:1')  +-  tensor(0.0256, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.018
Intervened Stability MCC for r=0.6 = 0.005 +- 0.187
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.667 +- 0.069
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.490853
Plausibility completed in  0:00:05.282320
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2608, device='cuda:1')  +-  tensor(0.0989, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2882, device='cuda:1')  +-  tensor(0.1183, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2608, device='cuda:1')  +-  tensor(0.0989, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3704, device='cuda:1')  +-  tensor(0.0379, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.994 +- 0.036
Intervened Stability MCC for r=0.3 = 0.071 +- 0.226
Original Stability F1 for r=0.3 = 0.996 +- 0.025
Intervened Stability F1 for r=0.3 = 0.381 +- 0.151
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.495860
Plausibility completed in  0:00:05.116110
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2608, device='cuda:1')  +-  tensor(0.0989, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2884, device='cuda:1')  +-  tensor(0.1189, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2608, device='cuda:1')  +-  tensor(0.0989, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6878, device='cuda:1')  +-  tensor(0.0516, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.988 +- 0.049
Intervened Stability MCC for r=0.6 = 0.118 +- 0.263
Original Stability F1 for r=0.6 = 0.996 +- 0.018
Intervened Stability F1 for r=0.6 = 0.714 +- 0.091
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:01:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:01:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9188
Train Loss: 0.3755
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3545
ID Test ACCURACY: 0.9160
ID Test Loss: 0.3848
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4576
OOD Test ACCURACY: 0.6873
OOD Test Loss: 1.1964

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9188
Train Loss: 0.3755
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3545
ID Test ACCURACY: 0.9160
ID Test Loss: 0.3848
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4576
OOD Test ACCURACY: 0.6873
OOD Test Loss: 1.1964

[0m[1;37mINFO[0m: [1mChartInfo 0.9160 0.6873 0.9160 0.6873 0.9260 0.9263[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.510
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.413
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.509
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.410
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.364
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.215
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.448
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.314


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.489997
Plausibility completed in  0:00:05.265358
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3212, device='cuda:1')  +-  tensor(0.1633, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3704, device='cuda:1')  +-  tensor(0.2137, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3212, device='cuda:1')  +-  tensor(0.1633, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3781, device='cuda:1')  +-  tensor(0.0620, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.015
Intervened Stability MCC for r=0.3 = 0.051 +- 0.251
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.368 +- 0.167
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.486184
Plausibility completed in  0:00:05.094301
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3212, device='cuda:1')  +-  tensor(0.1633, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3705, device='cuda:1')  +-  tensor(0.2130, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3212, device='cuda:1')  +-  tensor(0.1633, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7159, device='cuda:1')  +-  tensor(0.0700, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.997 +- 0.025
Intervened Stability MCC for r=0.6 = 0.105 +- 0.312
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.725 +- 0.105
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.620001
Plausibility completed in  0:00:05.084071
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3147, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3618, device='cuda:1')  +-  tensor(0.2138, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3147, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3787, device='cuda:1')  +-  tensor(0.0640, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.015
Intervened Stability MCC for r=0.3 = 0.058 +- 0.254
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.373 +- 0.168
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.483374
Plausibility completed in  0:00:05.260155
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3147, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3619, device='cuda:1')  +-  tensor(0.2131, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3147, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7122, device='cuda:1')  +-  tensor(0.0690, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.026
Intervened Stability MCC for r=0.6 = 0.116 +- 0.304
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.724 +- 0.102
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.499065
Plausibility completed in  0:00:05.140488
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1667, device='cuda:1')  +-  tensor(0.0478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1787, device='cuda:1')  +-  tensor(0.0555, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1667, device='cuda:1')  +-  tensor(0.0478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3514, device='cuda:1')  +-  tensor(0.0188, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.026
Intervened Stability MCC for r=0.3 = 0.026 +- 0.185
Original Stability F1 for r=0.3 = 0.998 +- 0.018
Intervened Stability F1 for r=0.3 = 0.353 +- 0.123
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.660067
Plausibility completed in  0:00:05.159533
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1667, device='cuda:1')  +-  tensor(0.0478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1789, device='cuda:1')  +-  tensor(0.0555, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1667, device='cuda:1')  +-  tensor(0.0478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6759, device='cuda:1')  +-  tensor(0.0265, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.020
Intervened Stability MCC for r=0.6 = 0.016 +- 0.191
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.675 +- 0.069
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.480937
Plausibility completed in  0:00:05.255363
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2589, device='cuda:1')  +-  tensor(0.0999, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2872, device='cuda:1')  +-  tensor(0.1200, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2589, device='cuda:1')  +-  tensor(0.0999, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3616, device='cuda:1')  +-  tensor(0.0335, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 1.000 +- 0.006
Intervened Stability MCC for r=0.3 = 0.088 +- 0.226
Original Stability F1 for r=0.3 = 1.000 +- 0.004
Intervened Stability F1 for r=0.3 = 0.383 +- 0.156
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.493608
Plausibility completed in  0:00:05.090108
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2589, device='cuda:1')  +-  tensor(0.0999, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2868, device='cuda:1')  +-  tensor(0.1197, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2589, device='cuda:1')  +-  tensor(0.0999, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6875, device='cuda:1')  +-  tensor(0.0526, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.995 +- 0.024
Intervened Stability MCC for r=0.6 = 0.139 +- 0.231
Original Stability F1 for r=0.6 = 0.998 +- 0.009
Intervened Stability F1 for r=0.6 = 0.715 +- 0.090
Intervened samples: 800

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.31893042 0.31621106] +- [0.00276549 0.00534687] (mean across ratios: 0.318 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.36590474 0.35743103] +- [0.00663651 0.01184736] (mean across ratios: 0.362 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.32641445 0.62442253] +- [0.00117838 0.00125327] (mean across ratios: 0.475 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.37419639 0.70425378] +- [0.00513966 0.01135755] (mean across ratios: 0.539 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99678767 0.99934974] +- [0.00183897 0.000221  ] (mean across ratios: 0.998 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.35066065 0.71593291] +- [0.00870661 0.00574413] (mean across ratios: 0.533 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99530041 0.99822435] +- [0.00267544 0.00061554] (mean across ratios: 0.997 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.02134552 0.06243517] +- [0.01607965 0.02589487] (mean across ratios: 0.042 +- TODO)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.31244833 0.30958034] +- [0.00259286 0.00538379] (mean across ratios: 0.311 +- TODO)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.35776059 0.34919304] +- [0.00586805 0.01158752] (mean across ratios: 0.353 +- TODO)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.32608322 0.62401749] +- [0.00118869 0.00128291] (mean across ratios: 0.475 +- TODO)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.37312524 0.70076817] +- [0.00442797 0.01056539] (mean across ratios: 0.537 +- TODO)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.99680851 0.99923992] +- [0.00213285 0.00029772] (mean across ratios: 0.998 +- TODO)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.35216557 0.71282278] +- [0.01113744 0.00692383] (mean across ratios: 0.532 +- TODO)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.99533665 0.99788448] +- [0.00312294 0.00091871] (mean across ratios: 0.997 +- TODO)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.02483429 0.0652891 ] +- [0.01708929 0.03095917] (mean across ratios: 0.045 +- TODO)

(id) (val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.1673155 0.1673155] +- [0.00068408 0.00068408] (mean across ratios: 0.167 +- TODO)
(id) (val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.17911265 0.17935255] +- [0.00053076 0.00070264] (mean across ratios: 0.179 +- TODO)

(id) (val) STABILITY_WIOU_ORIGINAL: 	[0.31927249 0.61810725] +- [0.00053895 0.00099292] (mean across ratios: 0.469 +- TODO)
(id) (val) STABILITY_WIOU_PERTURBED: 	[0.3499936  0.67679174] +- [0.00141708 0.00075145] (mean across ratios: 0.513 +- TODO)

(id) (val) STABILITY_F1_ORIGINAL: 	[0.99803804 0.99870163] +- [0.00033831 0.00033668] (mean across ratios: 0.998 +- TODO)
(id) (val) STABILITY_F1_PERTURBED: 	[0.34511446 0.6715794 ] +- [0.00443955 0.00305029] (mean across ratios: 0.508 +- TODO)

(id) (val) STABILITY_MCC_ORIGINAL: 	[0.99711766 0.99654551] +- [0.00049659 0.00089505] (mean across ratios: 0.997 +- TODO)
(id) (val) STABILITY_MCC_PERTURBED: 	[0.01853364 0.00911095] +- [0.00441942 0.00609157] (mean across ratios: 0.014 +- TODO)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.25869048 0.25869048] +- [0.00114995 0.00114995] (mean across ratios: 0.259 +- TODO)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.2869138  0.28691949] +- [0.00075967 0.0009638 ] (mean across ratios: 0.287 +- TODO)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.31785699 0.62053248] +- [0.00099706 0.00139031] (mean across ratios: 0.469 +- TODO)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.366544   0.68882256] +- [0.00476358 0.00537929] (mean across ratios: 0.528 +- TODO)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.9984176 0.9976491] +- [0.00151039 0.00134873] (mean across ratios: 0.998 +- TODO)
(id) (test) STABILITY_F1_PERTURBED: 	[0.38233583 0.70928557] +- [0.02320014 0.00919414] (mean across ratios: 0.546 +- TODO)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99771878 0.99375657] +- [0.00217955 0.00359204] (mean across ratios: 0.996 +- TODO)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.07340833 0.11304335] +- [0.03123155 0.03259221] (mean across ratios: 0.093 +- TODO)

Overall time of execution:  0:05:59.160367
DONE GSAT GOODMotif2/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:03:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:03:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 22...
[0m[1;37mINFO[0m: [1mCheckpoint 22: 
-----------------------------------
Train ACCURACY: 0.9222
Train Loss: 0.3693
ID Validation ACCURACY: 0.9267
ID Validation Loss: 0.3559
ID Test ACCURACY: 0.9203
ID Test Loss: 0.3852
OOD Validation ACCURACY: 0.8900
OOD Validation Loss: 0.4914
OOD Test ACCURACY: 0.5517
OOD Test Loss: 1.5316

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9157
Train Loss: 0.3791
ID Validation ACCURACY: 0.9230
ID Validation Loss: 0.3661
ID Test ACCURACY: 0.9137
ID Test Loss: 0.3922
OOD Validation ACCURACY: 0.9270
OOD Validation Loss: 0.4447
OOD Test ACCURACY: 0.6490
OOD Test Loss: 1.4331

[0m[1;37mINFO[0m: [1mChartInfo 0.9203 0.5517 0.9137 0.6490 0.9230 0.9270[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.502
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.430
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.493
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.423
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.401
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.245
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.450
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.309


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.652352
Plausibility completed in  0:00:05.118851
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3139, device='cuda:1')  +-  tensor(0.1573, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4091, device='cuda:1')  +-  tensor(0.2576, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3139, device='cuda:1')  +-  tensor(0.1573, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4155, device='cuda:1')  +-  tensor(0.1005, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.995 +- 0.044
Intervened Stability MCC for r=0.3 = 0.065 +- 0.229
Original Stability F1 for r=0.3 = 0.996 +- 0.029
Intervened Stability F1 for r=0.3 = 0.446 +- 0.163
Intervened samples: 784


ratio=0.6


Interventions completed in  0:00:01.439816
Plausibility completed in  0:00:05.042472
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3093, device='cuda:1')  +-  tensor(0.1529, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3916, device='cuda:1')  +-  tensor(0.2455, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3093, device='cuda:1')  +-  tensor(0.1529, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7741, device='cuda:1')  +-  tensor(0.1813, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.030
Intervened Stability MCC for r=0.6 = -0.011 +- 0.196
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.798 +- 0.132
Intervened samples: 774


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.585886
Plausibility completed in  0:00:05.105447
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3078, device='cuda:1')  +-  tensor(0.1578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4003, device='cuda:1')  +-  tensor(0.2575, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3078, device='cuda:1')  +-  tensor(0.1578, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4146, device='cuda:1')  +-  tensor(0.0983, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.994 +- 0.044
Intervened Stability MCC for r=0.3 = 0.060 +- 0.233
Original Stability F1 for r=0.3 = 0.996 +- 0.030
Intervened Stability F1 for r=0.3 = 0.440 +- 0.165
Intervened samples: 786


ratio=0.6


Interventions completed in  0:00:01.435204
Plausibility completed in  0:00:05.200191
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3027, device='cuda:1')  +-  tensor(0.1529, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3821, device='cuda:1')  +-  tensor(0.2454, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3027, device='cuda:1')  +-  tensor(0.1529, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7702, device='cuda:1')  +-  tensor(0.1783, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.997 +- 0.041
Intervened Stability MCC for r=0.6 = -0.013 +- 0.194
Original Stability F1 for r=0.6 = 0.999 +- 0.013
Intervened Stability F1 for r=0.6 = 0.793 +- 0.131
Intervened samples: 775


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.494386
Plausibility completed in  0:00:05.230744
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1675, device='cuda:1')  +-  tensor(0.0467, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2062, device='cuda:1')  +-  tensor(0.0744, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1675, device='cuda:1')  +-  tensor(0.0467, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3997, device='cuda:1')  +-  tensor(0.0350, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.028
Intervened Stability MCC for r=0.3 = 0.001 +- 0.199
Original Stability F1 for r=0.3 = 0.997 +- 0.019
Intervened Stability F1 for r=0.3 = 0.382 +- 0.127
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.639624
Plausibility completed in  0:00:05.235014
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1675, device='cuda:1')  +-  tensor(0.0467, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2066, device='cuda:1')  +-  tensor(0.0735, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1675, device='cuda:1')  +-  tensor(0.0467, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7734, device='cuda:1')  +-  tensor(0.0611, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.022
Intervened Stability MCC for r=0.6 = 0.009 +- 0.202
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.769 +- 0.080
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.616539
Plausibility completed in  0:00:05.171069
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2575, device='cuda:1')  +-  tensor(0.0985, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3493, device='cuda:1')  +-  tensor(0.1694, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2575, device='cuda:1')  +-  tensor(0.0985, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4413, device='cuda:1')  +-  tensor(0.0770, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 1.000 +- 0.005
Intervened Stability MCC for r=0.3 = 0.100 +- 0.254
Original Stability F1 for r=0.3 = 1.000 +- 0.003
Intervened Stability F1 for r=0.3 = 0.472 +- 0.142
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.484571
Plausibility completed in  0:00:05.329841
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2575, device='cuda:1')  +-  tensor(0.0985, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3272, device='cuda:1')  +-  tensor(0.1495, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2575, device='cuda:1')  +-  tensor(0.0985, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7840, device='cuda:1')  +-  tensor(0.1073, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.994 +- 0.032
Intervened Stability MCC for r=0.6 = 0.085 +- 0.215
Original Stability F1 for r=0.6 = 0.998 +- 0.013
Intervened Stability F1 for r=0.6 = 0.811 +- 0.109
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:04:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:04:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.9236
Train Loss: 0.3823
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3640
ID Test ACCURACY: 0.9223
ID Test Loss: 0.3970
OOD Validation ACCURACY: 0.9163
OOD Validation Loss: 0.4602
OOD Test ACCURACY: 0.6380
OOD Test Loss: 1.7702

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 20...
[0m[1;37mINFO[0m: [1mCheckpoint 20: 
-----------------------------------
Train ACCURACY: 0.9191
Train Loss: 0.3765
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3656
ID Test ACCURACY: 0.9180
ID Test Loss: 0.3905
OOD Validation ACCURACY: 0.9257
OOD Validation Loss: 0.4647
OOD Test ACCURACY: 0.5130
OOD Test Loss: 1.8937

[0m[1;37mINFO[0m: [1mChartInfo 0.9223 0.6380 0.9180 0.5130 0.9240 0.9257[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.484
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.401
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.397
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.393
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.223
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.425
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.303


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.477573
Plausibility completed in  0:00:05.372707
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3193, device='cuda:1')  +-  tensor(0.1608, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4231, device='cuda:1')  +-  tensor(0.2541, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3193, device='cuda:1')  +-  tensor(0.1608, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4247, device='cuda:1')  +-  tensor(0.0839, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.992 +- 0.049
Intervened Stability MCC for r=0.3 = -0.001 +- 0.237
Original Stability F1 for r=0.3 = 0.994 +- 0.034
Intervened Stability F1 for r=0.3 = 0.414 +- 0.159
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.440552
Plausibility completed in  0:00:05.054333
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3103, device='cuda:1')  +-  tensor(0.1543, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3861, device='cuda:1')  +-  tensor(0.2369, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3103, device='cuda:1')  +-  tensor(0.1543, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7766, device='cuda:1')  +-  tensor(0.1744, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.011
Intervened Stability MCC for r=0.6 = -0.013 +- 0.196
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.795 +- 0.130
Intervened samples: 777


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.608366
Plausibility completed in  0:00:05.168137
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3128, device='cuda:1')  +-  tensor(0.1608, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4119, device='cuda:1')  +-  tensor(0.2536, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3128, device='cuda:1')  +-  tensor(0.1608, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4207, device='cuda:1')  +-  tensor(0.0808, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.988 +- 0.067
Intervened Stability MCC for r=0.3 = 0.002 +- 0.245
Original Stability F1 for r=0.3 = 0.992 +- 0.046
Intervened Stability F1 for r=0.3 = 0.411 +- 0.157
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.594241
Plausibility completed in  0:00:05.030893
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3036, device='cuda:1')  +-  tensor(0.1539, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3785, device='cuda:1')  +-  tensor(0.2382, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3036, device='cuda:1')  +-  tensor(0.1539, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7746, device='cuda:1')  +-  tensor(0.1748, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = -0.017 +- 0.193
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.792 +- 0.130
Intervened samples: 777


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.498207
Plausibility completed in  0:00:05.359976
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1664, device='cuda:1')  +-  tensor(0.0474, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2061, device='cuda:1')  +-  tensor(0.0744, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1664, device='cuda:1')  +-  tensor(0.0474, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3982, device='cuda:1')  +-  tensor(0.0339, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.997 +- 0.021
Intervened Stability MCC for r=0.3 = 0.006 +- 0.200
Original Stability F1 for r=0.3 = 0.998 +- 0.014
Intervened Stability F1 for r=0.3 = 0.385 +- 0.126
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.499762
Plausibility completed in  0:00:05.210992
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1664, device='cuda:1')  +-  tensor(0.0474, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2059, device='cuda:1')  +-  tensor(0.0728, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1664, device='cuda:1')  +-  tensor(0.0474, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7725, device='cuda:1')  +-  tensor(0.0584, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.996 +- 0.028
Intervened Stability MCC for r=0.6 = 0.015 +- 0.196
Original Stability F1 for r=0.6 = 0.998 +- 0.010
Intervened Stability F1 for r=0.6 = 0.770 +- 0.072
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.621972
Plausibility completed in  0:00:05.156151
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2584, device='cuda:1')  +-  tensor(0.0976, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3476, device='cuda:1')  +-  tensor(0.1682, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2584, device='cuda:1')  +-  tensor(0.0976, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4268, device='cuda:1')  +-  tensor(0.0659, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.998 +- 0.018
Intervened Stability MCC for r=0.3 = 0.012 +- 0.243
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.413 +- 0.152
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.639037
Plausibility completed in  0:00:05.170127
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2584, device='cuda:1')  +-  tensor(0.0976, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3238, device='cuda:1')  +-  tensor(0.1452, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2584, device='cuda:1')  +-  tensor(0.0976, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7663, device='cuda:1')  +-  tensor(0.0855, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.990 +- 0.039
Intervened Stability MCC for r=0.6 = 0.030 +- 0.229
Original Stability F1 for r=0.6 = 0.996 +- 0.015
Intervened Stability F1 for r=0.6 = 0.776 +- 0.090
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:05:47 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:05:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 0.9211
Train Loss: 0.3738
ID Validation ACCURACY: 0.9273
ID Validation Loss: 0.3569
ID Test ACCURACY: 0.9193
ID Test Loss: 0.3863
OOD Validation ACCURACY: 0.8863
OOD Validation Loss: 0.4868
OOD Test ACCURACY: 0.6483
OOD Test Loss: 1.2024

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 29...
[0m[1;37mINFO[0m: [1mCheckpoint 29: 
-----------------------------------
Train ACCURACY: 0.9178
Train Loss: 0.3688
ID Validation ACCURACY: 0.9257
ID Validation Loss: 0.3548
ID Test ACCURACY: 0.9177
ID Test Loss: 0.3860
OOD Validation ACCURACY: 0.9277
OOD Validation Loss: 0.4565
OOD Test ACCURACY: 0.6407
OOD Test Loss: 1.2257

[0m[1;37mINFO[0m: [1mChartInfo 0.9193 0.6483 0.9177 0.6407 0.9257 0.9277[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.521
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.419
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.508
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.410
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.433
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.237
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.406
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.340


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.645952
Plausibility completed in  0:00:05.180994
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3187, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4260, device='cuda:1')  +-  tensor(0.2626, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3187, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4283, device='cuda:1')  +-  tensor(0.0852, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.993 +- 0.047
Intervened Stability MCC for r=0.3 = 0.023 +- 0.257
Original Stability F1 for r=0.3 = 0.996 +- 0.032
Intervened Stability F1 for r=0.3 = 0.430 +- 0.171
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.645252
Plausibility completed in  0:00:05.198165
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3187, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4099, device='cuda:1')  +-  tensor(0.2369, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3187, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7958, device='cuda:1')  +-  tensor(0.1104, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.003 +- 0.206
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.797 +- 0.127
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.490530
Plausibility completed in  0:00:05.308282
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3119, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4147, device='cuda:1')  +-  tensor(0.2623, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3119, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4248, device='cuda:1')  +-  tensor(0.0850, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.994 +- 0.041
Intervened Stability MCC for r=0.3 = 0.031 +- 0.258
Original Stability F1 for r=0.3 = 0.996 +- 0.029
Intervened Stability F1 for r=0.3 = 0.431 +- 0.172
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.494285
Plausibility completed in  0:00:05.163558
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3119, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3996, device='cuda:1')  +-  tensor(0.2368, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3119, device='cuda:1')  +-  tensor(0.1616, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7905, device='cuda:1')  +-  tensor(0.1091, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.014 +- 0.209
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.794 +- 0.125
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.646928
Plausibility completed in  0:00:05.203327
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1678, device='cuda:1')  +-  tensor(0.0469, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2049, device='cuda:1')  +-  tensor(0.0744, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1678, device='cuda:1')  +-  tensor(0.0469, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3979, device='cuda:1')  +-  tensor(0.0338, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.026
Intervened Stability MCC for r=0.3 = 0.002 +- 0.200
Original Stability F1 for r=0.3 = 0.997 +- 0.018
Intervened Stability F1 for r=0.3 = 0.381 +- 0.126
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.508501
Plausibility completed in  0:00:05.374523
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1678, device='cuda:1')  +-  tensor(0.0469, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2044, device='cuda:1')  +-  tensor(0.0729, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1678, device='cuda:1')  +-  tensor(0.0469, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7718, device='cuda:1')  +-  tensor(0.0581, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.996 +- 0.025
Intervened Stability MCC for r=0.6 = 0.011 +- 0.193
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.769 +- 0.074
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.495031
Plausibility completed in  0:00:05.144746
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2579, device='cuda:1')  +-  tensor(0.1004, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3470, device='cuda:1')  +-  tensor(0.1688, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2579, device='cuda:1')  +-  tensor(0.1004, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4392, device='cuda:1')  +-  tensor(0.0773, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.997 +- 0.021
Intervened Stability MCC for r=0.3 = 0.036 +- 0.250
Original Stability F1 for r=0.3 = 0.998 +- 0.014
Intervened Stability F1 for r=0.3 = 0.427 +- 0.149
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.647643
Plausibility completed in  0:00:05.153192
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2579, device='cuda:1')  +-  tensor(0.1004, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3379, device='cuda:1')  +-  tensor(0.1592, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2579, device='cuda:1')  +-  tensor(0.1004, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8074, device='cuda:1')  +-  tensor(0.1158, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.010
Intervened Stability MCC for r=0.6 = 0.042 +- 0.172
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.827 +- 0.127
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:06:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:06:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.9218
Train Loss: 0.3744
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3613
ID Test ACCURACY: 0.9190
ID Test Loss: 0.3906
OOD Validation ACCURACY: 0.7447
OOD Validation Loss: 0.5801
OOD Test ACCURACY: 0.5590
OOD Test Loss: 1.9371

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 19...
[0m[1;37mINFO[0m: [1mCheckpoint 19: 
-----------------------------------
Train ACCURACY: 0.9174
Train Loss: 0.3778
ID Validation ACCURACY: 0.9213
ID Validation Loss: 0.3598
ID Test ACCURACY: 0.9153
ID Test Loss: 0.3903
OOD Validation ACCURACY: 0.9237
OOD Validation Loss: 0.4252
OOD Test ACCURACY: 0.4633
OOD Test Loss: 2.5793

[0m[1;37mINFO[0m: [1mChartInfo 0.9190 0.5590 0.9153 0.4633 0.9213 0.9237[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.541
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.440
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.538
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.434
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.456
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.248
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.487
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.320


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.488346
Plausibility completed in  0:00:05.163603
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3216, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4263, device='cuda:1')  +-  tensor(0.2582, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3216, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4298, device='cuda:1')  +-  tensor(0.0861, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.995 +- 0.038
Intervened Stability MCC for r=0.3 = 0.037 +- 0.267
Original Stability F1 for r=0.3 = 0.997 +- 0.026
Intervened Stability F1 for r=0.3 = 0.431 +- 0.184
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.634939
Plausibility completed in  0:00:05.146204
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3216, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4142, device='cuda:1')  +-  tensor(0.2386, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3216, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8006, device='cuda:1')  +-  tensor(0.1152, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.022
Intervened Stability MCC for r=0.6 = 0.002 +- 0.230
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.797 +- 0.126
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.480963
Plausibility completed in  0:00:05.274121
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3150, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4157, device='cuda:1')  +-  tensor(0.2586, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3150, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4249, device='cuda:1')  +-  tensor(0.0842, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.993 +- 0.048
Intervened Stability MCC for r=0.3 = 0.041 +- 0.268
Original Stability F1 for r=0.3 = 0.995 +- 0.033
Intervened Stability F1 for r=0.3 = 0.429 +- 0.185
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.487129
Plausibility completed in  0:00:05.149262
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3150, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4049, device='cuda:1')  +-  tensor(0.2401, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3150, device='cuda:1')  +-  tensor(0.1626, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7938, device='cuda:1')  +-  tensor(0.1132, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.997 +- 0.032
Intervened Stability MCC for r=0.6 = 0.011 +- 0.234
Original Stability F1 for r=0.6 = 0.999 +- 0.012
Intervened Stability F1 for r=0.6 = 0.793 +- 0.125
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.643361
Plausibility completed in  0:00:05.173463
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1682, device='cuda:1')  +-  tensor(0.0472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2066, device='cuda:1')  +-  tensor(0.0749, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1682, device='cuda:1')  +-  tensor(0.0472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4018, device='cuda:1')  +-  tensor(0.0367, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.997 +- 0.023
Intervened Stability MCC for r=0.3 = 0.000 +- 0.197
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.378 +- 0.128
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.658962
Plausibility completed in  0:00:05.193460
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1682, device='cuda:1')  +-  tensor(0.0472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2071, device='cuda:1')  +-  tensor(0.0730, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1682, device='cuda:1')  +-  tensor(0.0472, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7711, device='cuda:1')  +-  tensor(0.0574, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.028
Intervened Stability MCC for r=0.6 = 0.003 +- 0.194
Original Stability F1 for r=0.6 = 0.998 +- 0.010
Intervened Stability F1 for r=0.6 = 0.764 +- 0.074
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.493243
Plausibility completed in  0:00:05.277031
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2608, device='cuda:1')  +-  tensor(0.0989, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3509, device='cuda:1')  +-  tensor(0.1691, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2608, device='cuda:1')  +-  tensor(0.0989, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4394, device='cuda:1')  +-  tensor(0.0763, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.029
Intervened Stability MCC for r=0.3 = 0.068 +- 0.255
Original Stability F1 for r=0.3 = 0.997 +- 0.020
Intervened Stability F1 for r=0.3 = 0.442 +- 0.148
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.488290
Plausibility completed in  0:00:05.132600
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2608, device='cuda:1')  +-  tensor(0.0989, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3320, device='cuda:1')  +-  tensor(0.1521, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2608, device='cuda:1')  +-  tensor(0.0989, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7823, device='cuda:1')  +-  tensor(0.1031, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.991 +- 0.043
Intervened Stability MCC for r=0.6 = 0.125 +- 0.220
Original Stability F1 for r=0.6 = 0.997 +- 0.016
Intervened Stability F1 for r=0.6 = 0.825 +- 0.105
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:08:10 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:08:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9188
Train Loss: 0.3755
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3545
ID Test ACCURACY: 0.9160
ID Test Loss: 0.3848
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4576
OOD Test ACCURACY: 0.6873
OOD Test Loss: 1.1964

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9188
Train Loss: 0.3755
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.3545
ID Test ACCURACY: 0.9160
ID Test Loss: 0.3848
OOD Validation ACCURACY: 0.9263
OOD Validation Loss: 0.4576
OOD Test ACCURACY: 0.6873
OOD Test Loss: 1.1964

[0m[1;37mINFO[0m: [1mChartInfo 0.9160 0.6873 0.9160 0.6873 0.9260 0.9263[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument lr_filternod in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.510
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.413
GOODMotif2(3000)
Data example from id_test: Data(edge_index=[2, 56], x=[16, 1], node_gt=[16], edge_gt=[56], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=16)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([ 988,  973, 1039]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.509
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.410
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.364
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.215
GOODMotif2(3000)
Data example from test: Data(edge_index=[2, 70], x=[20, 1], node_gt=[20], edge_gt=[70], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=20)
Label distribution from test: (tensor([0, 1, 2]), tensor([ 971, 1026, 1003]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.448
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.314


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.490703
Plausibility completed in  0:00:05.375504
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3212, device='cuda:1')  +-  tensor(0.1633, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4262, device='cuda:1')  +-  tensor(0.2578, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3212, device='cuda:1')  +-  tensor(0.1633, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4304, device='cuda:1')  +-  tensor(0.0904, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.016
Intervened Stability MCC for r=0.3 = 0.070 +- 0.249
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.449 +- 0.167
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.499480
Plausibility completed in  0:00:05.195605
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3212, device='cuda:1')  +-  tensor(0.1633, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4144, device='cuda:1')  +-  tensor(0.2437, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3212, device='cuda:1')  +-  tensor(0.1633, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7961, device='cuda:1')  +-  tensor(0.1063, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.016
Intervened Stability MCC for r=0.6 = 0.016 +- 0.221
Original Stability F1 for r=0.6 = 1.000 +- 0.006
Intervened Stability F1 for r=0.6 = 0.798 +- 0.119
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.643828
Plausibility completed in  0:00:05.359671
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3147, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4153, device='cuda:1')  +-  tensor(0.2583, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3147, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4300, device='cuda:1')  +-  tensor(0.0937, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.998 +- 0.023
Intervened Stability MCC for r=0.3 = 0.078 +- 0.261
Original Stability F1 for r=0.3 = 0.999 +- 0.015
Intervened Stability F1 for r=0.3 = 0.452 +- 0.171
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.488835
Plausibility completed in  0:00:05.319225
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3147, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4068, device='cuda:1')  +-  tensor(0.2466, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3147, device='cuda:1')  +-  tensor(0.1637, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7944, device='cuda:1')  +-  tensor(0.1081, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.997 +- 0.026
Intervened Stability MCC for r=0.6 = 0.019 +- 0.208
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.796 +- 0.120
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.506518
Plausibility completed in  0:00:05.183808
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1667, device='cuda:1')  +-  tensor(0.0478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2065, device='cuda:1')  +-  tensor(0.0755, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1667, device='cuda:1')  +-  tensor(0.0478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4018, device='cuda:1')  +-  tensor(0.0355, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.998 +- 0.019
Intervened Stability MCC for r=0.3 = 0.011 +- 0.197
Original Stability F1 for r=0.3 = 0.998 +- 0.013
Intervened Stability F1 for r=0.3 = 0.391 +- 0.125
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.656430
Plausibility completed in  0:00:05.203869
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1667, device='cuda:1')  +-  tensor(0.0478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.2065, device='cuda:1')  +-  tensor(0.0740, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1667, device='cuda:1')  +-  tensor(0.0478, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7704, device='cuda:1')  +-  tensor(0.0591, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.996 +- 0.022
Intervened Stability MCC for r=0.6 = 0.006 +- 0.192
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.768 +- 0.075
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.490296
Plausibility completed in  0:00:05.288536
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2589, device='cuda:1')  +-  tensor(0.0999, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3510, device='cuda:1')  +-  tensor(0.1720, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.2589, device='cuda:1')  +-  tensor(0.0999, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4289, device='cuda:1')  +-  tensor(0.0685, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.009
Intervened Stability MCC for r=0.3 = 0.070 +- 0.259
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.438 +- 0.153
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.492510
Plausibility completed in  0:00:05.138128
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2589, device='cuda:1')  +-  tensor(0.0999, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3322, device='cuda:1')  +-  tensor(0.1543, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.2589, device='cuda:1')  +-  tensor(0.0999, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7849, device='cuda:1')  +-  tensor(0.1035, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.995 +- 0.027
Intervened Stability MCC for r=0.6 = 0.115 +- 0.232
Original Stability F1 for r=0.6 = 0.998 +- 0.010
Intervened Stability F1 for r=0.6 = 0.816 +- 0.109
Intervened samples: 800

\FINISHED GOODMotif2 - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.31893042 0.31621106] +- [0.00276549 0.00534687] (mean across ratios: 0.318 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.42212926 0.40324361] +- [0.00662292 0.011989  ] (mean across ratios: 0.413 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.3264147  0.62442278] +- [0.00117881 0.00125375] (mean across ratios: 0.475 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.42574055 0.78866665] +- [0.00548223 0.01101747] (mean across ratios: 0.607 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99643964 0.99950043] +- [0.00156932 0.0002327 ] (mean across ratios: 0.998 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.43422836 0.79700139] +- [0.01244432 0.00135039] (mean across ratios: 0.616 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.9947973  0.99862096] +- [0.00227954 0.00064152] (mean across ratios: 0.997 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[ 0.03889406 -0.00070835] +- [0.02629185 0.01055456] (mean across ratios: 0.019 +- TODO)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.31244833 0.30958034] +- [0.00259286 0.00538379] (mean across ratios: 0.311 +- TODO)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.41155793 0.39439418] +- [0.00579312 0.01178772] (mean across ratios: 0.403 +- TODO)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.32608322 0.62401749] +- [0.00118869 0.00128291] (mean across ratios: 0.475 +- TODO)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.42299228 0.78472034] +- [0.00514358 0.01023661] (mean across ratios: 0.604 +- TODO)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.99559786 0.99904277] +- [0.00220161 0.00025492] (mean across ratios: 0.997 +- TODO)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.43259031 0.79372993] +- [0.0133915  0.00147039] (mean across ratios: 0.613 +- TODO)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.99355556 0.99734967] +- [0.00320595 0.00074985] (mean across ratios: 0.995 +- TODO)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.04251705 0.00289813] +- [0.02571793 0.01497099] (mean across ratios: 0.023 +- TODO)

(id) (val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.1673155 0.1673155] +- [0.00068408 0.00068408] (mean across ratios: 0.167 +- TODO)
(id) (val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.20606084 0.20611395] +- [0.00060576 0.00091284] (mean across ratios: 0.206 +- TODO)

(id) (val) STABILITY_WIOU_ORIGINAL: 	[0.31927299 0.61810725] +- [0.00053892 0.00099292] (mean across ratios: 0.469 +- TODO)
(id) (val) STABILITY_WIOU_PERTURBED: 	[0.39986339 0.77183239] +- [0.00168717 0.00105171] (mean across ratios: 0.586 +- TODO)

(id) (val) STABILITY_F1_ORIGINAL: 	[0.99772754 0.9985893 ] +- [0.0006129  0.00017558] (mean across ratios: 0.998 +- TODO)
(id) (val) STABILITY_F1_PERTURBED: 	[0.38336669 0.7680522 ] +- [0.00418645 0.00232934] (mean across ratios: 0.576 +- TODO)

(id) (val) STABILITY_MCC_ORIGINAL: 	[0.99666299 0.99624308] +- [0.00089042 0.00047705] (mean across ratios: 0.996 +- TODO)
(id) (val) STABILITY_MCC_PERTURBED: 	[0.00430194 0.00892241] +- [0.00400474 0.00407809] (mean across ratios: 0.007 +- TODO)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.25869048 0.25869048] +- [0.00114995 0.00114995] (mean across ratios: 0.259 +- TODO)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.34914004 0.33062038] +- [0.00162815 0.00480835] (mean across ratios: 0.340 +- TODO)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.31785699 0.62053248] +- [0.00099706 0.00139031] (mean across ratios: 0.469 +- TODO)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.43511379 0.78495078] +- [0.00603297 0.01311198] (mean across ratios: 0.610 +- TODO)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99859029 0.99766109] +- [0.00104772 0.00118339] (mean across ratios: 0.998 +- TODO)
(id) (test) STABILITY_F1_PERTURBED: 	[0.43842354 0.81083673] +- [0.01967344 0.01859563] (mean across ratios: 0.625 +- TODO)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99796833 0.9938097 ] +- [0.00151269 0.00316449] (mean across ratios: 0.996 +- TODO)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.05721348 0.0792844 ] +- [0.03018184 0.03788077] (mean across ratios: 0.068 +- TODO)

Overall time of execution:  0:06:02.919373
DONE GSAT GOODMotif2/basis 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:09:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:09:42 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:09:54 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:09:56 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:09:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:10:01 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:10:07 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9010
Train Loss: 0.4113
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3841
ID Test ACCURACY: 0.9073
ID Test Loss: 0.4060
OOD Validation ACCURACY: 0.7423
OOD Validation Loss: 0.6636
OOD Test ACCURACY: 0.4077
OOD Test Loss: 1.2302

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8978
Train Loss: 0.4102
ID Validation ACCURACY: 0.8993
ID Validation Loss: 0.3779
ID Test ACCURACY: 0.9033
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8020
OOD Validation Loss: 0.6381
OOD Test ACCURACY: 0.5353
OOD Test Loss: 1.1219

[0m[1;37mINFO[0m: [1mChartInfo 0.9073 0.4077 0.9033 0.5353 0.8993 0.8020[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.505
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.424
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.503
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.435
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.351
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.205
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.173
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.096


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.522915
Plausibility completed in  0:00:05.324286
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1711, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4087, device='cuda:1')  +-  tensor(0.2238, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1711, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3937, device='cuda:1')  +-  tensor(0.0728, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.044
Intervened Stability MCC for r=0.3 = 0.283 +- 0.305
Original Stability F1 for r=0.3 = 0.997 +- 0.029
Intervened Stability F1 for r=0.3 = 0.553 +- 0.200
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.421885
Plausibility completed in  0:00:04.886031
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3447, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3681, device='cuda:1')  +-  tensor(0.2234, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3447, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6808, device='cuda:1')  +-  tensor(0.1911, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.031
Intervened Stability MCC for r=0.6 = 0.229 +- 0.326
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.783 +- 0.111
Intervened samples: 750


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.616283
Plausibility completed in  0:00:05.158716
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3658, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4176, device='cuda:1')  +-  tensor(0.2339, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3658, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3930, device='cuda:1')  +-  tensor(0.0854, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.995 +- 0.047
Intervened Stability MCC for r=0.3 = 0.278 +- 0.284
Original Stability F1 for r=0.3 = 0.996 +- 0.032
Intervened Stability F1 for r=0.3 = 0.556 +- 0.185
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.388590
Plausibility completed in  0:00:04.786135
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3520, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3683, device='cuda:1')  +-  tensor(0.2310, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3520, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6696, device='cuda:1')  +-  tensor(0.2147, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.999 +- 0.017
Intervened Stability MCC for r=0.6 = 0.230 +- 0.321
Original Stability F1 for r=0.6 = 1.000 +- 0.006
Intervened Stability F1 for r=0.6 = 0.786 +- 0.111
Intervened samples: 734


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.680432
Plausibility completed in  0:00:05.344917
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1462, device='cuda:1')  +-  tensor(0.0698, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1708, device='cuda:1')  +-  tensor(0.0933, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1462, device='cuda:1')  +-  tensor(0.0698, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3872, device='cuda:1')  +-  tensor(0.0594, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.998 +- 0.011
Intervened Stability MCC for r=0.3 = 0.203 +- 0.238
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.505 +- 0.171
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.660535
Plausibility completed in  0:00:05.216047
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1448, device='cuda:1')  +-  tensor(0.0702, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1634, device='cuda:1')  +-  tensor(0.0953, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1448, device='cuda:1')  +-  tensor(0.0702, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7200, device='cuda:1')  +-  tensor(0.1578, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.016
Intervened Stability MCC for r=0.6 = 0.115 +- 0.224
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.771 +- 0.107
Intervened samples: 778


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.604103
Plausibility completed in  0:00:05.879215
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0265, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0732, device='cuda:1')  +-  tensor(0.0325, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0265, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3943, device='cuda:1')  +-  tensor(0.0841, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.995 +- 0.025
Intervened Stability MCC for r=0.3 = 0.189 +- 0.241
Original Stability F1 for r=0.3 = 0.996 +- 0.017
Intervened Stability F1 for r=0.3 = 0.499 +- 0.180
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.566619
Plausibility completed in  0:00:05.567846
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0635, device='cuda:1')  +-  tensor(0.0266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0702, device='cuda:1')  +-  tensor(0.0339, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0635, device='cuda:1')  +-  tensor(0.0266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7285, device='cuda:1')  +-  tensor(0.1593, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.015
Intervened Stability MCC for r=0.6 = 0.057 +- 0.141
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.762 +- 0.103
Intervened samples: 779
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:11:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:31 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:43 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:45 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:47 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:50 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:11:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8982
Train Loss: 0.4154
ID Validation ACCURACY: 0.9063
ID Validation Loss: 0.3884
ID Test ACCURACY: 0.9040
ID Test Loss: 0.4108
OOD Validation ACCURACY: 0.7660
OOD Validation Loss: 0.6770
OOD Test ACCURACY: 0.3893
OOD Test Loss: 1.9553

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8992
Train Loss: 0.4251
ID Validation ACCURACY: 0.9040
ID Validation Loss: 0.3990
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4150
OOD Validation ACCURACY: 0.8080
OOD Validation Loss: 0.6806
OOD Test ACCURACY: 0.5023
OOD Test Loss: 1.2075

[0m[1;37mINFO[0m: [1mChartInfo 0.9040 0.3893 0.9030 0.5023 0.9040 0.8080[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.501
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.458
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.503
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.480
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.366
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.215
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.172
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.095


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.504286
Plausibility completed in  0:00:05.310952
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3542, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4076, device='cuda:1')  +-  tensor(0.2228, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3542, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3862, device='cuda:1')  +-  tensor(0.0682, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.998 +- 0.023
Intervened Stability MCC for r=0.3 = 0.252 +- 0.284
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.532 +- 0.186
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.474224
Plausibility completed in  0:00:05.060851
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3506, device='cuda:1')  +-  tensor(0.1686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3931, device='cuda:1')  +-  tensor(0.2214, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3506, device='cuda:1')  +-  tensor(0.1686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7185, device='cuda:1')  +-  tensor(0.1437, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.013
Intervened Stability MCC for r=0.6 = 0.190 +- 0.333
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.782 +- 0.112
Intervened samples: 779


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.616323
Plausibility completed in  0:00:05.069375
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3647, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4164, device='cuda:1')  +-  tensor(0.2331, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3647, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3861, device='cuda:1')  +-  tensor(0.0813, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.995 +- 0.043
Intervened Stability MCC for r=0.3 = 0.287 +- 0.298
Original Stability F1 for r=0.3 = 0.997 +- 0.029
Intervened Stability F1 for r=0.3 = 0.558 +- 0.192
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.610736
Plausibility completed in  0:00:05.006481
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3618, device='cuda:1')  +-  tensor(0.1729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4054, device='cuda:1')  +-  tensor(0.2312, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3618, device='cuda:1')  +-  tensor(0.1729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7203, device='cuda:1')  +-  tensor(0.1586, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.010
Intervened Stability MCC for r=0.6 = 0.193 +- 0.341
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.792 +- 0.116
Intervened samples: 774


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.548001
Plausibility completed in  0:00:05.470699
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1462, device='cuda:1')  +-  tensor(0.0696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1709, device='cuda:1')  +-  tensor(0.0928, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1462, device='cuda:1')  +-  tensor(0.0696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3845, device='cuda:1')  +-  tensor(0.0510, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.998 +- 0.015
Intervened Stability MCC for r=0.3 = 0.197 +- 0.236
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.501 +- 0.165
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.530765
Plausibility completed in  0:00:05.271200
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1459, device='cuda:1')  +-  tensor(0.0699, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1674, device='cuda:1')  +-  tensor(0.0932, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1459, device='cuda:1')  +-  tensor(0.0699, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7368, device='cuda:1')  +-  tensor(0.1352, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.012
Intervened Stability MCC for r=0.6 = 0.037 +- 0.200
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.758 +- 0.121
Intervened samples: 791


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.751163
Plausibility completed in  0:00:05.668834
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0733, device='cuda:1')  +-  tensor(0.0326, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3931, device='cuda:1')  +-  tensor(0.0850, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.998 +- 0.011
Intervened Stability MCC for r=0.3 = 0.184 +- 0.228
Original Stability F1 for r=0.3 = 0.999 +- 0.007
Intervened Stability F1 for r=0.3 = 0.502 +- 0.169
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.725858
Plausibility completed in  0:00:05.502190
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0633, device='cuda:1')  +-  tensor(0.0265, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0697, device='cuda:1')  +-  tensor(0.0340, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0633, device='cuda:1')  +-  tensor(0.0265, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7140, device='cuda:1')  +-  tensor(0.1638, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.006
Intervened Stability MCC for r=0.6 = 0.066 +- 0.143
Original Stability F1 for r=0.6 = 1.000 +- 0.002
Intervened Stability F1 for r=0.6 = 0.761 +- 0.098
Intervened samples: 775
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:13:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:19 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:31 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:33 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:35 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:38 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:13:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 0.8945
Train Loss: 0.4116
ID Validation ACCURACY: 0.9040
ID Validation Loss: 0.3795
ID Test ACCURACY: 0.8997
ID Test Loss: 0.4107
OOD Validation ACCURACY: 0.7253
OOD Validation Loss: 0.6863
OOD Test ACCURACY: 0.4013
OOD Test Loss: 2.0413

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8913
Train Loss: 0.4172
ID Validation ACCURACY: 0.8983
ID Validation Loss: 0.3806
ID Test ACCURACY: 0.8980
ID Test Loss: 0.4151
OOD Validation ACCURACY: 0.8380
OOD Validation Loss: 0.6095
OOD Test ACCURACY: 0.5037
OOD Test Loss: 0.9645

[0m[1;37mINFO[0m: [1mChartInfo 0.8997 0.4013 0.8980 0.5037 0.8983 0.8380[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.471
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.420
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.471
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.430
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.358
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.216
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.178
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.100


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.663733
Plausibility completed in  0:00:05.083714
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3538, device='cuda:1')  +-  tensor(0.1712, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4059, device='cuda:1')  +-  tensor(0.2233, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3538, device='cuda:1')  +-  tensor(0.1712, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3818, device='cuda:1')  +-  tensor(0.0695, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.033
Intervened Stability MCC for r=0.3 = 0.240 +- 0.299
Original Stability F1 for r=0.3 = 0.997 +- 0.022
Intervened Stability F1 for r=0.3 = 0.525 +- 0.191
Intervened samples: 793


ratio=0.6


Interventions completed in  0:00:01.575998
Plausibility completed in  0:00:04.802519
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3420, device='cuda:1')  +-  tensor(0.1666, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3631, device='cuda:1')  +-  tensor(0.2252, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3420, device='cuda:1')  +-  tensor(0.1666, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6795, device='cuda:1')  +-  tensor(0.2027, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.021
Intervened Stability MCC for r=0.6 = 0.119 +- 0.309
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.767 +- 0.108
Intervened samples: 744


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.483469
Plausibility completed in  0:00:05.017660
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3643, device='cuda:1')  +-  tensor(0.1754, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4144, device='cuda:1')  +-  tensor(0.2322, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3643, device='cuda:1')  +-  tensor(0.1754, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3846, device='cuda:1')  +-  tensor(0.0845, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.032
Intervened Stability MCC for r=0.3 = 0.232 +- 0.307
Original Stability F1 for r=0.3 = 0.997 +- 0.022
Intervened Stability F1 for r=0.3 = 0.524 +- 0.192
Intervened samples: 784


ratio=0.6


Interventions completed in  0:00:01.531564
Plausibility completed in  0:00:04.694599
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3536, device='cuda:1')  +-  tensor(0.1730, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3674, device='cuda:1')  +-  tensor(0.2364, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3536, device='cuda:1')  +-  tensor(0.1730, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6652, device='cuda:1')  +-  tensor(0.2235, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.023
Intervened Stability MCC for r=0.6 = 0.127 +- 0.315
Original Stability F1 for r=0.6 = 1.000 +- 0.008
Intervened Stability F1 for r=0.6 = 0.770 +- 0.108
Intervened samples: 728


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.552277
Plausibility completed in  0:00:05.421751
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1467, device='cuda:1')  +-  tensor(0.0703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1710, device='cuda:1')  +-  tensor(0.0930, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1467, device='cuda:1')  +-  tensor(0.0703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3845, device='cuda:1')  +-  tensor(0.0556, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.999 +- 0.014
Intervened Stability MCC for r=0.3 = 0.211 +- 0.237
Original Stability F1 for r=0.3 = 0.999 +- 0.009
Intervened Stability F1 for r=0.3 = 0.508 +- 0.167
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.541606
Plausibility completed in  0:00:05.251556
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1463, device='cuda:1')  +-  tensor(0.0705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1673, device='cuda:1')  +-  tensor(0.0933, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1463, device='cuda:1')  +-  tensor(0.0705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7402, device='cuda:1')  +-  tensor(0.1318, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.012
Intervened Stability MCC for r=0.6 = 0.064 +- 0.202
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.774 +- 0.111
Intervened samples: 792


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.770889
Plausibility completed in  0:00:05.692518
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0648, device='cuda:1')  +-  tensor(0.0271, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0739, device='cuda:1')  +-  tensor(0.0333, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0648, device='cuda:1')  +-  tensor(0.0271, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4053, device='cuda:1')  +-  tensor(0.0926, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.999 +- 0.009
Intervened Stability MCC for r=0.3 = 0.181 +- 0.255
Original Stability F1 for r=0.3 = 0.999 +- 0.006
Intervened Stability F1 for r=0.3 = 0.500 +- 0.184
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.740772
Plausibility completed in  0:00:05.551539
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0270, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0714, device='cuda:1')  +-  tensor(0.0339, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0270, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7233, device='cuda:1')  +-  tensor(0.1457, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.013
Intervened Stability MCC for r=0.6 = 0.052 +- 0.150
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.761 +- 0.106
Intervened samples: 785
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:15:05 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:05 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:16 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:18 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:20 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:23 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:15:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4122
ID Validation ACCURACY: 0.9040
ID Validation Loss: 0.3819
ID Test ACCURACY: 0.9023
ID Test Loss: 0.4090
OOD Validation ACCURACY: 0.7800
OOD Validation Loss: 0.6749
OOD Test ACCURACY: 0.4270
OOD Test Loss: 1.3846

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.8968
Train Loss: 0.4227
ID Validation ACCURACY: 0.9027
ID Validation Loss: 0.3960
ID Test ACCURACY: 0.8967
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.6848
OOD Test ACCURACY: 0.4540
OOD Test Loss: 1.3474

[0m[1;37mINFO[0m: [1mChartInfo 0.9023 0.4270 0.8967 0.4540 0.9027 0.7857[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.395
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.412
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.321
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.187
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.127
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.075


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.671342
Plausibility completed in  0:00:05.085762
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3535, device='cuda:1')  +-  tensor(0.1702, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4064, device='cuda:1')  +-  tensor(0.2228, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3535, device='cuda:1')  +-  tensor(0.1702, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3882, device='cuda:1')  +-  tensor(0.0699, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.013
Intervened Stability MCC for r=0.3 = 0.275 +- 0.291
Original Stability F1 for r=0.3 = 0.999 +- 0.009
Intervened Stability F1 for r=0.3 = 0.548 +- 0.191
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.424985
Plausibility completed in  0:00:04.815557
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3471, device='cuda:1')  +-  tensor(0.1689, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3689, device='cuda:1')  +-  tensor(0.2268, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3471, device='cuda:1')  +-  tensor(0.1689, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6821, device='cuda:1')  +-  tensor(0.1969, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.996 +- 0.029
Intervened Stability MCC for r=0.6 = 0.211 +- 0.325
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.784 +- 0.109
Intervened samples: 747


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.636922
Plausibility completed in  0:00:05.018311
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3639, device='cuda:1')  +-  tensor(0.1747, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4152, device='cuda:1')  +-  tensor(0.2331, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3639, device='cuda:1')  +-  tensor(0.1747, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3900, device='cuda:1')  +-  tensor(0.0851, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.016
Intervened Stability MCC for r=0.3 = 0.294 +- 0.296
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.564 +- 0.193
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.587801
Plausibility completed in  0:00:04.805237
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3582, device='cuda:1')  +-  tensor(0.1738, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3811, device='cuda:1')  +-  tensor(0.2329, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3582, device='cuda:1')  +-  tensor(0.1738, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6841, device='cuda:1')  +-  tensor(0.1984, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.997 +- 0.028
Intervened Stability MCC for r=0.6 = 0.200 +- 0.336
Original Stability F1 for r=0.6 = 0.999 +- 0.010
Intervened Stability F1 for r=0.6 = 0.783 +- 0.114
Intervened samples: 747


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.553633
Plausibility completed in  0:00:05.420225
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1452, device='cuda:1')  +-  tensor(0.0691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1698, device='cuda:1')  +-  tensor(0.0929, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1452, device='cuda:1')  +-  tensor(0.0691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3884, device='cuda:1')  +-  tensor(0.0621, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.999 +- 0.011
Intervened Stability MCC for r=0.3 = 0.215 +- 0.235
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.510 +- 0.171
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.493511
Plausibility completed in  0:00:05.068515
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1436, device='cuda:1')  +-  tensor(0.0700, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1594, device='cuda:1')  +-  tensor(0.0964, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1436, device='cuda:1')  +-  tensor(0.0700, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7054, device='cuda:1')  +-  tensor(0.1771, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.013
Intervened Stability MCC for r=0.6 = 0.129 +- 0.230
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.769 +- 0.103
Intervened samples: 766


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.755985
Plausibility completed in  0:00:05.650245
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0629, device='cuda:1')  +-  tensor(0.0256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0720, device='cuda:1')  +-  tensor(0.0319, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0629, device='cuda:1')  +-  tensor(0.0256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3980, device='cuda:1')  +-  tensor(0.1003, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.995 +- 0.024
Intervened Stability MCC for r=0.3 = 0.187 +- 0.226
Original Stability F1 for r=0.3 = 0.997 +- 0.016
Intervened Stability F1 for r=0.3 = 0.499 +- 0.179
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.709127
Plausibility completed in  0:00:05.304719
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0615, device='cuda:1')  +-  tensor(0.0258, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0656, device='cuda:1')  +-  tensor(0.0349, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0615, device='cuda:1')  +-  tensor(0.0258, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6865, device='cuda:1')  +-  tensor(0.1968, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.010
Intervened Stability MCC for r=0.6 = 0.122 +- 0.191
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.754 +- 0.092
Intervened samples: 751
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:16:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:16:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:04 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:06 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:09 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:17:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9022
Train Loss: 0.4024
ID Validation ACCURACY: 0.9063
ID Validation Loss: 0.3754
ID Test ACCURACY: 0.9057
ID Test Loss: 0.3967
OOD Validation ACCURACY: 0.8143
OOD Validation Loss: 0.6194
OOD Test ACCURACY: 0.5047
OOD Test Loss: 0.9707

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8958
Train Loss: 0.4127
ID Validation ACCURACY: 0.9017
ID Validation Loss: 0.3839
ID Test ACCURACY: 0.8987
ID Test Loss: 0.4093
OOD Validation ACCURACY: 0.8263
OOD Validation Loss: 0.6432
OOD Test ACCURACY: 0.5150
OOD Test Loss: 1.2884

[0m[1;37mINFO[0m: [1mChartInfo 0.9057 0.5047 0.8987 0.5150 0.9017 0.8263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.529
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.528
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.476
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.398
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.232
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.195
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.106


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.678019
Plausibility completed in  0:00:05.114643
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3594, device='cuda:1')  +-  tensor(0.1719, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4117, device='cuda:1')  +-  tensor(0.2235, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3594, device='cuda:1')  +-  tensor(0.1719, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3875, device='cuda:1')  +-  tensor(0.0696, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.993 +- 0.051
Intervened Stability MCC for r=0.3 = 0.244 +- 0.289
Original Stability F1 for r=0.3 = 0.995 +- 0.034
Intervened Stability F1 for r=0.3 = 0.530 +- 0.187
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.473844
Plausibility completed in  0:00:05.167469
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3506, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3860, device='cuda:1')  +-  tensor(0.2200, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3506, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7083, device='cuda:1')  +-  tensor(0.1611, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.015
Intervened Stability MCC for r=0.6 = 0.154 +- 0.317
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.775 +- 0.110
Intervened samples: 770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.491206
Plausibility completed in  0:00:05.043078
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3697, device='cuda:1')  +-  tensor(0.1759, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4204, device='cuda:1')  +-  tensor(0.2336, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3697, device='cuda:1')  +-  tensor(0.1759, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3872, device='cuda:1')  +-  tensor(0.0827, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.994 +- 0.041
Intervened Stability MCC for r=0.3 = 0.249 +- 0.312
Original Stability F1 for r=0.3 = 0.996 +- 0.028
Intervened Stability F1 for r=0.3 = 0.536 +- 0.197
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.604060
Plausibility completed in  0:00:04.880847
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3580, device='cuda:1')  +-  tensor(0.1691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3856, device='cuda:1')  +-  tensor(0.2287, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3580, device='cuda:1')  +-  tensor(0.1691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6943, device='cuda:1')  +-  tensor(0.1917, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.137 +- 0.318
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.775 +- 0.111
Intervened samples: 753


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.560347
Plausibility completed in  0:00:05.276198
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1501, device='cuda:1')  +-  tensor(0.0713, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.1744, device='cuda:1')  +-  tensor(0.0951, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1501, device='cuda:1')  +-  tensor(0.0713, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3841, device='cuda:1')  +-  tensor(0.0498, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.998 +- 0.018
Intervened Stability MCC for r=0.3 = 0.213 +- 0.243
Original Stability F1 for r=0.3 = 0.998 +- 0.013
Intervened Stability F1 for r=0.3 = 0.508 +- 0.169
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.694329
Plausibility completed in  0:00:05.216083
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1494, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1688, device='cuda:1')  +-  tensor(0.0962, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1494, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7287, device='cuda:1')  +-  tensor(0.1464, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.015
Intervened Stability MCC for r=0.6 = 0.081 +- 0.196
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.771 +- 0.109
Intervened samples: 785


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.625518
Plausibility completed in  0:00:05.835915
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0664, device='cuda:1')  +-  tensor(0.0275, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0753, device='cuda:1')  +-  tensor(0.0337, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0664, device='cuda:1')  +-  tensor(0.0275, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3911, device='cuda:1')  +-  tensor(0.0871, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.998 +- 0.010
Intervened Stability MCC for r=0.3 = 0.193 +- 0.247
Original Stability F1 for r=0.3 = 0.999 +- 0.007
Intervened Stability F1 for r=0.3 = 0.500 +- 0.183
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.574487
Plausibility completed in  0:00:05.514575
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0656, device='cuda:1')  +-  tensor(0.0275, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0716, device='cuda:1')  +-  tensor(0.0351, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0656, device='cuda:1')  +-  tensor(0.0275, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7162, device='cuda:1')  +-  tensor(0.1652, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.012
Intervened Stability MCC for r=0.6 = 0.059 +- 0.147
Original Stability F1 for r=0.6 = 0.999 +- 0.004
Intervened Stability F1 for r=0.6 = 0.761 +- 0.101
Intervened samples: 775

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.35525686 0.34700617] +- [0.00217321 0.00335326] (mean across ratios: 0.351 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.40805945 0.375819  ] +- [0.00208219 0.01157387] (mean across ratios: 0.392 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.32946313 0.62747368] +- [0.00175882 0.00153264] (mean across ratios: 0.478 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.38747834 0.69381131] +- [0.00384162 0.0163028 ] (mean across ratios: 0.541 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99740292 0.99922221] +- [0.00146323 0.00038321] (mean across ratios: 0.998 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.53762839 0.7784887 ] +- [0.01091227 0.00641077] (mean across ratios: 0.658 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99617676 0.99786886] +- [0.00215569 0.00102873] (mean across ratios: 0.997 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.2586351  0.18034949] +- [0.01693864 0.03967015] (mean across ratios: 0.219 +- TODO)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.36567142 0.35673338] +- [0.00211909 0.00350982] (mean across ratios: 0.361 +- TODO)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.41678424 0.38154283] +- [0.00209016 0.01385533] (mean across ratios: 0.399 +- TODO)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.32971257 0.62810429] +- [0.00177905 0.00154933] (mean across ratios: 0.479 +- TODO)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.38817825 0.68670152] +- [0.00299979 0.01973605] (mean across ratios: 0.537 +- TODO)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.99701098 0.99947088] +- [0.00112562 0.00030577] (mean across ratios: 0.998 +- TODO)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.54766911 0.78094082] +- [0.01508791 0.00772798] (mean across ratios: 0.664 +- TODO)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.99561946 0.99857066] +- [0.00165837 0.00079283] (mean across ratios: 0.997 +- TODO)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.26810936 0.17734147] +- [0.02387237 0.03907108] (mean across ratios: 0.223 +- TODO)

(id) (val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.1468855  0.14601061] +- [0.00168983 0.00193467] (mean across ratios: 0.146 +- TODO)
(id) (val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.17136975 0.165257  ] +- [0.00157675 0.00344957] (mean across ratios: 0.168 +- TODO)

(id) (val) STABILITY_WIOU_ORIGINAL: 	[0.3188675  0.61711957] +- [0.00168858 0.00120569] (mean across ratios: 0.468 +- TODO)
(id) (val) STABILITY_WIOU_PERTURBED: 	[0.38574268 0.72623087] +- [0.00173797 0.01254901] (mean across ratios: 0.556 +- TODO)

(id) (val) STABILITY_F1_ORIGINAL: 	[0.99880707 0.99949232] +- [2.82587686e-04 6.74869742e-05] (mean across ratios: 0.999 +- TODO)
(id) (val) STABILITY_F1_PERTURBED: 	[0.50647928 0.76870402] +- [0.00317474 0.00538162] (mean across ratios: 0.638 +- TODO)

(id) (val) STABILITY_MCC_ORIGINAL: 	[0.99825492 0.99865296] +- [0.00041033 0.00018455] (mean across ratios: 0.998 +- TODO)
(id) (val) STABILITY_MCC_PERTURBED: 	[0.2077237  0.08537995] +- [0.00674993 0.03334055] (mean across ratios: 0.147 +- TODO)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.064506   0.06362284] +- [0.00111971 0.00131343] (mean across ratios: 0.064 +- TODO)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.07355795 0.0696868 ] +- [0.00108161 0.00217853] (mean across ratios: 0.072 +- TODO)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.31403924 0.61277672] +- [0.00160841 0.0009968 ] (mean across ratios: 0.463 +- TODO)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.39635258 0.7137046 ] +- [0.00501255 0.01454923] (mean across ratios: 0.555 +- TODO)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99787669 0.9994365 ] +- [0.00106419 0.0002239 ] (mean across ratios: 0.999 +- TODO)
(id) (test) STABILITY_F1_PERTURBED: 	[0.49965189 0.75987349] +- [0.00112908 0.00284692] (mean across ratios: 0.630 +- TODO)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99689724 0.99851978] +- [0.001574   0.00059157] (mean across ratios: 0.998 +- TODO)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.18698415 0.07121225] +- [0.00403054 0.02575233] (mean across ratios: 0.129 +- TODO)

Overall time of execution:  0:08:58.126565
DONE GSAT GOODMotif/size 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:18:57 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:18:57 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:08 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:10 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:12 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:15 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:19:22 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 24...
[0m[1;37mINFO[0m: [1mCheckpoint 24: 
-----------------------------------
Train ACCURACY: 0.9010
Train Loss: 0.4113
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3841
ID Test ACCURACY: 0.9073
ID Test Loss: 0.4060
OOD Validation ACCURACY: 0.7423
OOD Validation Loss: 0.6636
OOD Test ACCURACY: 0.4077
OOD Test Loss: 1.2302

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 28...
[0m[1;37mINFO[0m: [1mCheckpoint 28: 
-----------------------------------
Train ACCURACY: 0.8978
Train Loss: 0.4102
ID Validation ACCURACY: 0.8993
ID Validation Loss: 0.3779
ID Test ACCURACY: 0.9033
ID Test Loss: 0.4072
OOD Validation ACCURACY: 0.8020
OOD Validation Loss: 0.6381
OOD Test ACCURACY: 0.5353
OOD Test Loss: 1.1219

[0m[1;37mINFO[0m: [1mChartInfo 0.9073 0.4077 0.9033 0.5353 0.8993 0.8020[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.505
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.424
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.503
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.435
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.351
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.205
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.173
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.096


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.494723
Plausibility completed in  0:00:05.213241
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1711, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4677, device='cuda:1')  +-  tensor(0.2613, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3555, device='cuda:1')  +-  tensor(0.1711, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4474, device='cuda:1')  +-  tensor(0.0979, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.995 +- 0.047
Intervened Stability MCC for r=0.3 = 0.277 +- 0.322
Original Stability F1 for r=0.3 = 0.997 +- 0.031
Intervened Stability F1 for r=0.3 = 0.589 +- 0.200
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.403084
Plausibility completed in  0:00:04.786122
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3447, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4067, device='cuda:1')  +-  tensor(0.2509, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3447, device='cuda:1')  +-  tensor(0.1645, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7483, device='cuda:1')  +-  tensor(0.2164, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.006
Intervened Stability MCC for r=0.6 = 0.162 +- 0.326
Original Stability F1 for r=0.6 = 1.000 +- 0.002
Intervened Stability F1 for r=0.6 = 0.832 +- 0.109
Intervened samples: 750


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.589268
Plausibility completed in  0:00:05.003103
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3658, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4763, device='cuda:1')  +-  tensor(0.2689, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3658, device='cuda:1')  +-  tensor(0.1753, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4467, device='cuda:1')  +-  tensor(0.1105, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.038
Intervened Stability MCC for r=0.3 = 0.275 +- 0.297
Original Stability F1 for r=0.3 = 0.997 +- 0.025
Intervened Stability F1 for r=0.3 = 0.594 +- 0.185
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.367716
Plausibility completed in  0:00:04.663272
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3520, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4074, device='cuda:1')  +-  tensor(0.2611, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3520, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7360, device='cuda:1')  +-  tensor(0.2417, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.007
Intervened Stability MCC for r=0.6 = 0.176 +- 0.327
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.837 +- 0.111
Intervened samples: 734


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.653401
Plausibility completed in  0:00:05.235578
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1462, device='cuda:1')  +-  tensor(0.0698, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2087, device='cuda:1')  +-  tensor(0.1345, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1462, device='cuda:1')  +-  tensor(0.0698, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4558, device='cuda:1')  +-  tensor(0.1003, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.009
Intervened Stability MCC for r=0.3 = 0.170 +- 0.246
Original Stability F1 for r=0.3 = 0.999 +- 0.006
Intervened Stability F1 for r=0.3 = 0.540 +- 0.179
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.627148
Plausibility completed in  0:00:05.102864
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1448, device='cuda:1')  +-  tensor(0.0702, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1843, device='cuda:1')  +-  tensor(0.1123, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1448, device='cuda:1')  +-  tensor(0.0702, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8011, device='cuda:1')  +-  tensor(0.1792, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.083 +- 0.231
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.835 +- 0.117
Intervened samples: 778


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.578104
Plausibility completed in  0:00:05.724882
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0265, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0879, device='cuda:1')  +-  tensor(0.0427, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0265, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4637, device='cuda:1')  +-  tensor(0.1163, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.995 +- 0.023
Intervened Stability MCC for r=0.3 = 0.148 +- 0.231
Original Stability F1 for r=0.3 = 0.997 +- 0.016
Intervened Stability F1 for r=0.3 = 0.530 +- 0.181
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.539075
Plausibility completed in  0:00:05.465669
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0635, device='cuda:1')  +-  tensor(0.0266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0817, device='cuda:1')  +-  tensor(0.0422, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0635, device='cuda:1')  +-  tensor(0.0266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8321, device='cuda:1')  +-  tensor(0.1905, device='cuda:1') (0.000)
Original Stability MCC for r=0.6 = 0.998 +- 0.014
Intervened Stability MCC for r=0.6 = 0.036 +- 0.120
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.849 +- 0.119
Intervened samples: 779
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:20:42 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:20:42 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:20:53 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:20:55 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:20:57 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:21:00 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:21:06 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8982
Train Loss: 0.4154
ID Validation ACCURACY: 0.9063
ID Validation Loss: 0.3884
ID Test ACCURACY: 0.9040
ID Test Loss: 0.4108
OOD Validation ACCURACY: 0.7660
OOD Validation Loss: 0.6770
OOD Test ACCURACY: 0.3893
OOD Test Loss: 1.9553

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 17...
[0m[1;37mINFO[0m: [1mCheckpoint 17: 
-----------------------------------
Train ACCURACY: 0.8992
Train Loss: 0.4251
ID Validation ACCURACY: 0.9040
ID Validation Loss: 0.3990
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4150
OOD Validation ACCURACY: 0.8080
OOD Validation Loss: 0.6806
OOD Test ACCURACY: 0.5023
OOD Test Loss: 1.2075

[0m[1;37mINFO[0m: [1mChartInfo 0.9040 0.3893 0.9030 0.5023 0.9040 0.8080[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.501
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.458
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.503
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.480
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.366
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.215
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.172
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.095


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.485564
Plausibility completed in  0:00:05.208287
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3542, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4683, device='cuda:1')  +-  tensor(0.2625, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3542, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4399, device='cuda:1')  +-  tensor(0.0932, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.041
Intervened Stability MCC for r=0.3 = 0.224 +- 0.320
Original Stability F1 for r=0.3 = 0.997 +- 0.027
Intervened Stability F1 for r=0.3 = 0.560 +- 0.191
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.449691
Plausibility completed in  0:00:04.956688
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3506, device='cuda:1')  +-  tensor(0.1686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4394, device='cuda:1')  +-  tensor(0.2493, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3506, device='cuda:1')  +-  tensor(0.1686, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7983, device='cuda:1')  +-  tensor(0.1684, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.011
Intervened Stability MCC for r=0.6 = 0.140 +- 0.342
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.841 +- 0.117
Intervened samples: 779


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.592447
Plausibility completed in  0:00:04.973864
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3647, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4789, device='cuda:1')  +-  tensor(0.2736, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3647, device='cuda:1')  +-  tensor(0.1750, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4411, device='cuda:1')  +-  tensor(0.1070, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.994 +- 0.049
Intervened Stability MCC for r=0.3 = 0.235 +- 0.333
Original Stability F1 for r=0.3 = 0.996 +- 0.032
Intervened Stability F1 for r=0.3 = 0.574 +- 0.195
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.589452
Plausibility completed in  0:00:04.902597
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3618, device='cuda:1')  +-  tensor(0.1729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4552, device='cuda:1')  +-  tensor(0.2635, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3618, device='cuda:1')  +-  tensor(0.1729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8025, device='cuda:1')  +-  tensor(0.1837, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.024
Intervened Stability MCC for r=0.6 = 0.132 +- 0.339
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.848 +- 0.123
Intervened samples: 774


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.525243
Plausibility completed in  0:00:05.369797
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1462, device='cuda:1')  +-  tensor(0.0696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2086, device='cuda:1')  +-  tensor(0.1333, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1462, device='cuda:1')  +-  tensor(0.0696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4519, device='cuda:1')  +-  tensor(0.0913, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.997 +- 0.016
Intervened Stability MCC for r=0.3 = 0.157 +- 0.244
Original Stability F1 for r=0.3 = 0.998 +- 0.011
Intervened Stability F1 for r=0.3 = 0.533 +- 0.170
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.508756
Plausibility completed in  0:00:05.166799
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1459, device='cuda:1')  +-  tensor(0.0699, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1891, device='cuda:1')  +-  tensor(0.1101, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1459, device='cuda:1')  +-  tensor(0.0699, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8204, device='cuda:1')  +-  tensor(0.1522, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.013 +- 0.180
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.828 +- 0.130
Intervened samples: 791


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.725215
Plausibility completed in  0:00:05.562654
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0881, device='cuda:1')  +-  tensor(0.0427, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0266, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4626, device='cuda:1')  +-  tensor(0.1188, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.997 +- 0.013
Intervened Stability MCC for r=0.3 = 0.146 +- 0.221
Original Stability F1 for r=0.3 = 0.998 +- 0.009
Intervened Stability F1 for r=0.3 = 0.537 +- 0.170
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.693527
Plausibility completed in  0:00:05.398395
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0633, device='cuda:1')  +-  tensor(0.0265, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0812, device='cuda:1')  +-  tensor(0.0422, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0633, device='cuda:1')  +-  tensor(0.0265, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8164, device='cuda:1')  +-  tensor(0.1934, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.013
Intervened Stability MCC for r=0.6 = 0.045 +- 0.134
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.842 +- 0.117
Intervened samples: 775
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:22:27 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:27 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:38 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:40 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:42 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:45 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:51 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:51 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:52 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:22:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:52 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:52 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:22:52 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:22:52 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 25...
[0m[1;37mINFO[0m: [1mCheckpoint 25: 
-----------------------------------
Train ACCURACY: 0.8945
Train Loss: 0.4116
ID Validation ACCURACY: 0.9040
ID Validation Loss: 0.3795
ID Test ACCURACY: 0.8997
ID Test Loss: 0.4107
OOD Validation ACCURACY: 0.7253
OOD Validation Loss: 0.6863
OOD Test ACCURACY: 0.4013
OOD Test Loss: 2.0413

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8913
Train Loss: 0.4172
ID Validation ACCURACY: 0.8983
ID Validation Loss: 0.3806
ID Test ACCURACY: 0.8980
ID Test Loss: 0.4151
OOD Validation ACCURACY: 0.8380
OOD Validation Loss: 0.6095
OOD Test ACCURACY: 0.5037
OOD Test Loss: 0.9645

[0m[1;37mINFO[0m: [1mChartInfo 0.8997 0.4013 0.8980 0.5037 0.8983 0.8380[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.471
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.420
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.471
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.430
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.358
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.216
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.178
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.100


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.634229
Plausibility completed in  0:00:04.973018
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3538, device='cuda:1')  +-  tensor(0.1712, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4607, device='cuda:1')  +-  tensor(0.2569, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3538, device='cuda:1')  +-  tensor(0.1712, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4300, device='cuda:1')  +-  tensor(0.0857, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.993 +- 0.047
Intervened Stability MCC for r=0.3 = 0.216 +- 0.314
Original Stability F1 for r=0.3 = 0.995 +- 0.031
Intervened Stability F1 for r=0.3 = 0.551 +- 0.188
Intervened samples: 793


ratio=0.6


Interventions completed in  0:00:01.553954
Plausibility completed in  0:00:04.696914
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3420, device='cuda:1')  +-  tensor(0.1666, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4032, device='cuda:1')  +-  tensor(0.2533, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3420, device='cuda:1')  +-  tensor(0.1666, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7504, device='cuda:1')  +-  tensor(0.2292, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.016
Intervened Stability MCC for r=0.6 = 0.079 +- 0.293
Original Stability F1 for r=0.6 = 1.000 +- 0.006
Intervened Stability F1 for r=0.6 = 0.827 +- 0.113
Intervened samples: 744


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.459865
Plausibility completed in  0:00:04.910376
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3643, device='cuda:1')  +-  tensor(0.1754, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4681, device='cuda:1')  +-  tensor(0.2645, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3643, device='cuda:1')  +-  tensor(0.1754, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4319, device='cuda:1')  +-  tensor(0.1009, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.996 +- 0.038
Intervened Stability MCC for r=0.3 = 0.198 +- 0.323
Original Stability F1 for r=0.3 = 0.997 +- 0.026
Intervened Stability F1 for r=0.3 = 0.547 +- 0.187
Intervened samples: 784


ratio=0.6


Interventions completed in  0:00:01.519483
Plausibility completed in  0:00:04.597909
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3536, device='cuda:1')  +-  tensor(0.1729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4068, device='cuda:1')  +-  tensor(0.2636, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3536, device='cuda:1')  +-  tensor(0.1729, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7342, device='cuda:1')  +-  tensor(0.2497, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.096 +- 0.313
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.827 +- 0.117
Intervened samples: 729


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.525719
Plausibility completed in  0:00:05.299854
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1467, device='cuda:1')  +-  tensor(0.0703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2077, device='cuda:1')  +-  tensor(0.1322, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1467, device='cuda:1')  +-  tensor(0.0703, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4517, device='cuda:1')  +-  tensor(0.0955, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.008
Intervened Stability MCC for r=0.3 = 0.176 +- 0.245
Original Stability F1 for r=0.3 = 0.999 +- 0.006
Intervened Stability F1 for r=0.3 = 0.542 +- 0.170
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.514078
Plausibility completed in  0:00:05.120007
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1463, device='cuda:1')  +-  tensor(0.0705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1887, device='cuda:1')  +-  tensor(0.1108, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1463, device='cuda:1')  +-  tensor(0.0705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8228, device='cuda:1')  +-  tensor(0.1462, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.012
Intervened Stability MCC for r=0.6 = 0.045 +- 0.182
Original Stability F1 for r=0.6 = 0.999 +- 0.004
Intervened Stability F1 for r=0.6 = 0.845 +- 0.115
Intervened samples: 792


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.726662
Plausibility completed in  0:00:05.559148
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0648, device='cuda:1')  +-  tensor(0.0271, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0887, device='cuda:1')  +-  tensor(0.0434, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0648, device='cuda:1')  +-  tensor(0.0271, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4775, device='cuda:1')  +-  tensor(0.1287, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.998 +- 0.011
Intervened Stability MCC for r=0.3 = 0.144 +- 0.243
Original Stability F1 for r=0.3 = 0.999 +- 0.007
Intervened Stability F1 for r=0.3 = 0.536 +- 0.180
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.558899
Plausibility completed in  0:00:05.614887
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0270, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0829, device='cuda:1')  +-  tensor(0.0418, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0642, device='cuda:1')  +-  tensor(0.0270, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8247, device='cuda:1')  +-  tensor(0.1680, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.044 +- 0.145
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.852 +- 0.114
Intervened samples: 785
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:24:11 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:11 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:22 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:24 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:26 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:29 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:24:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4122
ID Validation ACCURACY: 0.9040
ID Validation Loss: 0.3819
ID Test ACCURACY: 0.9023
ID Test Loss: 0.4090
OOD Validation ACCURACY: 0.7800
OOD Validation Loss: 0.6749
OOD Test ACCURACY: 0.4270
OOD Test Loss: 1.3846

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 21...
[0m[1;37mINFO[0m: [1mCheckpoint 21: 
-----------------------------------
Train ACCURACY: 0.8968
Train Loss: 0.4227
ID Validation ACCURACY: 0.9027
ID Validation Loss: 0.3960
ID Test ACCURACY: 0.8967
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.6848
OOD Test ACCURACY: 0.4540
OOD Test Loss: 1.3474

[0m[1;37mINFO[0m: [1mChartInfo 0.9023 0.4270 0.8967 0.4540 0.9027 0.7857[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.395
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.412
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.321
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.187
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.127
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.075


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.640189
Plausibility completed in  0:00:04.979600
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3535, device='cuda:1')  +-  tensor(0.1702, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4654, device='cuda:1')  +-  tensor(0.2602, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3535, device='cuda:1')  +-  tensor(0.1702, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4407, device='cuda:1')  +-  tensor(0.0917, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.009
Intervened Stability MCC for r=0.3 = 0.256 +- 0.309
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.575 +- 0.192
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.393678
Plausibility completed in  0:00:04.878457
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3471, device='cuda:1')  +-  tensor(0.1689, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4030, device='cuda:1')  +-  tensor(0.2488, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3471, device='cuda:1')  +-  tensor(0.1689, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7445, device='cuda:1')  +-  tensor(0.2209, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.996 +- 0.029
Intervened Stability MCC for r=0.6 = 0.167 +- 0.333
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.830 +- 0.114
Intervened samples: 747


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.455007
Plausibility completed in  0:00:04.917691
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3639, device='cuda:1')  +-  tensor(0.1747, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4744, device='cuda:1')  +-  tensor(0.2686, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3639, device='cuda:1')  +-  tensor(0.1747, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4426, device='cuda:1')  +-  tensor(0.1072, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.018
Intervened Stability MCC for r=0.3 = 0.270 +- 0.314
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.591 +- 0.190
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.544022
Plausibility completed in  0:00:04.714244
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3582, device='cuda:1')  +-  tensor(0.1738, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4165, device='cuda:1')  +-  tensor(0.2571, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3582, device='cuda:1')  +-  tensor(0.1738, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7458, device='cuda:1')  +-  tensor(0.2216, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.020
Intervened Stability MCC for r=0.6 = 0.169 +- 0.340
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.829 +- 0.118
Intervened samples: 747


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.669975
Plausibility completed in  0:00:05.146547
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1452, device='cuda:1')  +-  tensor(0.0691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2074, device='cuda:1')  +-  tensor(0.1335, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1452, device='cuda:1')  +-  tensor(0.0691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4568, device='cuda:1')  +-  tensor(0.1009, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.012
Intervened Stability MCC for r=0.3 = 0.190 +- 0.239
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.548 +- 0.176
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.466927
Plausibility completed in  0:00:04.957359
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1436, device='cuda:1')  +-  tensor(0.0700, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1784, device='cuda:1')  +-  tensor(0.1116, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1436, device='cuda:1')  +-  tensor(0.0700, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7811, device='cuda:1')  +-  tensor(0.1985, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.014
Intervened Stability MCC for r=0.6 = 0.115 +- 0.245
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.832 +- 0.111
Intervened samples: 766


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.722765
Plausibility completed in  0:00:05.545758
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0629, device='cuda:1')  +-  tensor(0.0256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0870, device='cuda:1')  +-  tensor(0.0422, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0629, device='cuda:1')  +-  tensor(0.0256, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4684, device='cuda:1')  +-  tensor(0.1354, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.995 +- 0.023
Intervened Stability MCC for r=0.3 = 0.150 +- 0.202
Original Stability F1 for r=0.3 = 0.997 +- 0.015
Intervened Stability F1 for r=0.3 = 0.533 +- 0.179
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.648613
Plausibility completed in  0:00:05.198204
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0615, device='cuda:1')  +-  tensor(0.0258, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0764, device='cuda:1')  +-  tensor(0.0434, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0615, device='cuda:1')  +-  tensor(0.0258, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7837, device='cuda:1')  +-  tensor(0.2327, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.007
Intervened Stability MCC for r=0.6 = 0.143 +- 0.232
Original Stability F1 for r=0.6 = 1.000 +- 0.003
Intervened Stability F1 for r=0.6 = 0.843 +- 0.108
Intervened samples: 751
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:25:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:25:54 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:06 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:08 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:10 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:13 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:26:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 27...
[0m[1;37mINFO[0m: [1mCheckpoint 27: 
-----------------------------------
Train ACCURACY: 0.9022
Train Loss: 0.4024
ID Validation ACCURACY: 0.9063
ID Validation Loss: 0.3754
ID Test ACCURACY: 0.9057
ID Test Loss: 0.3967
OOD Validation ACCURACY: 0.8143
OOD Validation Loss: 0.6194
OOD Test ACCURACY: 0.5047
OOD Test Loss: 0.9707

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 26...
[0m[1;37mINFO[0m: [1mCheckpoint 26: 
-----------------------------------
Train ACCURACY: 0.8958
Train Loss: 0.4127
ID Validation ACCURACY: 0.9017
ID Validation Loss: 0.3839
ID Test ACCURACY: 0.8987
ID Test Loss: 0.4093
OOD Validation ACCURACY: 0.8263
OOD Validation Loss: 0.6432
OOD Test ACCURACY: 0.5150
OOD Test Loss: 1.2884

[0m[1;37mINFO[0m: [1mChartInfo 0.9057 0.5047 0.8987 0.5150 0.9017 0.8263[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.529
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.462
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1006, 1011,  983]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.528
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.476
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.398
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.232
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 462], x=[149, 1], node_gt=[149], edge_gt=[462], y=[1], env_id=[1], ori_edge_index=[2, 462], node_perm=[149], num_nodes=149)
Label distribution from test: (tensor([0, 1, 2]), tensor([1019, 1029,  952]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.195
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.106


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.644945
Plausibility completed in  0:00:04.974135
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3594, device='cuda:1')  +-  tensor(0.1719, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4692, device='cuda:1')  +-  tensor(0.2586, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3594, device='cuda:1')  +-  tensor(0.1719, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4386, device='cuda:1')  +-  tensor(0.0906, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.994 +- 0.043
Intervened Stability MCC for r=0.3 = 0.212 +- 0.304
Original Stability F1 for r=0.3 = 0.996 +- 0.029
Intervened Stability F1 for r=0.3 = 0.552 +- 0.185
Intervened samples: 794


ratio=0.6


Interventions completed in  0:00:01.630854
Plausibility completed in  0:00:04.844647
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3506, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4292, device='cuda:1')  +-  tensor(0.2463, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3506, device='cuda:1')  +-  tensor(0.1664, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7848, device='cuda:1')  +-  tensor(0.1862, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.107 +- 0.314
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.833 +- 0.116
Intervened samples: 770


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.467590
Plausibility completed in  0:00:04.898659
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3697, device='cuda:1')  +-  tensor(0.1759, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4779, device='cuda:1')  +-  tensor(0.2673, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3697, device='cuda:1')  +-  tensor(0.1759, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4390, device='cuda:1')  +-  tensor(0.1041, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.994 +- 0.048
Intervened Stability MCC for r=0.3 = 0.227 +- 0.323
Original Stability F1 for r=0.3 = 0.996 +- 0.032
Intervened Stability F1 for r=0.3 = 0.565 +- 0.192
Intervened samples: 785


ratio=0.6


Interventions completed in  0:00:01.590022
Plausibility completed in  0:00:04.729346
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3580, device='cuda:1')  +-  tensor(0.1691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4305, device='cuda:1')  +-  tensor(0.2577, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3580, device='cuda:1')  +-  tensor(0.1691, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7718, device='cuda:1')  +-  tensor(0.2193, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.003
Intervened Stability MCC for r=0.6 = 0.097 +- 0.312
Original Stability F1 for r=0.6 = 1.000 +- 0.001
Intervened Stability F1 for r=0.6 = 0.838 +- 0.119
Intervened samples: 753


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.679078
Plausibility completed in  0:00:05.125210
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1501, device='cuda:1')  +-  tensor(0.0713, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.2124, device='cuda:1')  +-  tensor(0.1361, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.1501, device='cuda:1')  +-  tensor(0.0713, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4515, device='cuda:1')  +-  tensor(0.0912, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.997 +- 0.020
Intervened Stability MCC for r=0.3 = 0.173 +- 0.255
Original Stability F1 for r=0.3 = 0.998 +- 0.014
Intervened Stability F1 for r=0.3 = 0.540 +- 0.173
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.506721
Plausibility completed in  0:00:05.068244
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1494, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.1919, device='cuda:1')  +-  tensor(0.1162, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.1494, device='cuda:1')  +-  tensor(0.0717, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8160, device='cuda:1')  +-  tensor(0.1680, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.998 +- 0.023
Intervened Stability MCC for r=0.6 = 0.036 +- 0.155
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.838 +- 0.123
Intervened samples: 785


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.754065
Plausibility completed in  0:00:05.535963
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0664, device='cuda:1')  +-  tensor(0.0275, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.0905, device='cuda:1')  +-  tensor(0.0442, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.0664, device='cuda:1')  +-  tensor(0.0275, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4599, device='cuda:1')  +-  tensor(0.1203, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 0.998 +- 0.011
Intervened Stability MCC for r=0.3 = 0.164 +- 0.232
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.536 +- 0.182
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.705639
Plausibility completed in  0:00:05.368913
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0656, device='cuda:1')  +-  tensor(0.0275, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.0833, device='cuda:1')  +-  tensor(0.0436, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.0656, device='cuda:1')  +-  tensor(0.0275, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8181, device='cuda:1')  +-  tensor(0.1940, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 0.999 +- 0.010
Intervened Stability MCC for r=0.6 = 0.041 +- 0.134
Original Stability F1 for r=0.6 = 0.999 +- 0.004
Intervened Stability F1 for r=0.6 = 0.844 +- 0.117
Intervened samples: 775

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.35525686 0.34700617] +- [0.00217321 0.00335326] (mean across ratios: 0.351 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.4662214  0.41630309] +- [0.00304139 0.01511971] (mean across ratios: 0.441 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.32946313 0.62747368] +- [0.00175882 0.00153264] (mean across ratios: 0.478 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.43933594 0.76524137] +- [0.00555773 0.02195739] (mean across ratios: 0.602 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99694016 0.99950135] +- [0.00149319 0.0004651 ] (mean across ratios: 0.998 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.56533567 0.83267401] +- [0.01482022 0.00479859] (mean across ratios: 0.699 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99549209 0.99864919] +- [0.00218461 0.00125207] (mean across ratios: 0.997 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.23688709 0.13107647] +- [0.02531594 0.03339796] (mean across ratios: 0.184 +- TODO)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.36567142 0.35672058] +- [0.00211909 0.00352126] (mean across ratios: 0.361 +- TODO)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.47509004 0.42330054] +- [0.00380856 0.01812547] (mean across ratios: 0.449 +- TODO)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.32971257 0.62810557] +- [0.00177905 0.00154791] (mean across ratios: 0.479 +- TODO)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.44026803 0.75808082] +- [0.00488086 0.02596275] (mean across ratios: 0.599 +- TODO)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.99709249 0.99965715] +- [0.00107789 0.00024259] (mean across ratios: 0.998 +- TODO)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.57421632 0.83579879] +- [0.0171981  0.00735436] (mean across ratios: 0.705 +- TODO)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.99571779 0.99906234] +- [0.00161323 0.00065246] (mean across ratios: 0.997 +- TODO)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.24120958 0.13398269] +- [0.02852893 0.03424267] (mean across ratios: 0.188 +- TODO)

(id) (val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.1468855  0.14601036] +- [0.00168983 0.00193469] (mean across ratios: 0.146 +- TODO)
(id) (val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.2089621 0.1864917] +- [0.00176467 0.00470075] (mean across ratios: 0.198 +- TODO)

(id) (val) STABILITY_WIOU_ORIGINAL: 	[0.3188675  0.61711932] +- [0.00168858 0.00120598] (mean across ratios: 0.468 +- TODO)
(id) (val) STABILITY_WIOU_PERTURBED: 	[0.45355709 0.80828028] +- [0.00227678 0.01555021] (mean across ratios: 0.631 +- TODO)

(id) (val) STABILITY_F1_ORIGINAL: 	[0.99875367 0.99934739] +- [0.00052969 0.00016186] (mean across ratios: 0.999 +- TODO)
(id) (val) STABILITY_F1_PERTURBED: 	[0.54066828 0.83558029] +- [0.00473332 0.00570209] (mean across ratios: 0.688 +- TODO)

(id) (val) STABILITY_MCC_ORIGINAL: 	[0.99818218 0.99826787] +- [0.00077927 0.00041155] (mean across ratios: 0.998 +- TODO)
(id) (val) STABILITY_MCC_PERTURBED: 	[0.17331682 0.05845388] +- [0.01061897 0.036282  ] (mean across ratios: 0.116 +- TODO)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.064506   0.06362284] +- [0.00111971 0.00131343] (mean across ratios: 0.064 +- TODO)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.08841335 0.08107675] +- [0.00117356 0.00247485] (mean across ratios: 0.085 +- TODO)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.31403924 0.61277672] +- [0.00160841 0.0009968 ] (mean across ratios: 0.463 +- TODO)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.4664098  0.81500777] +- [0.00618588 0.01659815] (mean across ratios: 0.641 +- TODO)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99783683 0.99934757] +- [0.00087646 0.00016801] (mean across ratios: 0.999 +- TODO)
(id) (test) STABILITY_F1_PERTURBED: 	[0.53442223 0.84593453] +- [0.00274759 0.00371477] (mean across ratios: 0.690 +- TODO)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99683725 0.99827331] +- [0.00129918 0.00046675] (mean across ratios: 0.998 +- TODO)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.1501955 0.0618174] +- [0.00697626 0.0408002 ] (mean across ratios: 0.106 +- TODO)

Overall time of execution:  0:08:45.189720
DONE GSAT GOODMotif/size 0.10
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:27:59 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:27:59 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:14 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:16 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:18 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:28:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.570
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.585
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.505
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.178
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.779633
Plausibility completed in  0:00:05.252035
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3208, device='cuda:1')  +-  tensor(0.1680, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3690, device='cuda:1')  +-  tensor(0.2236, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3208, device='cuda:1')  +-  tensor(0.1680, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3758, device='cuda:1')  +-  tensor(0.0605, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.012
Intervened Stability MCC for r=0.3 = 0.196 +- 0.297
Original Stability F1 for r=0.3 = 0.999 +- 0.008
Intervened Stability F1 for r=0.3 = 0.493 +- 0.191
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.574869
Plausibility completed in  0:00:05.388156
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3208, device='cuda:1')  +-  tensor(0.1680, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3689, device='cuda:1')  +-  tensor(0.2238, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3208, device='cuda:1')  +-  tensor(0.1680, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7120, device='cuda:1')  +-  tensor(0.0694, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.014
Intervened Stability MCC for r=0.6 = 0.175 +- 0.318
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.759 +- 0.110
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.560302
Plausibility completed in  0:00:05.220594
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3315, device='cuda:1')  +-  tensor(0.1651, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3825, device='cuda:1')  +-  tensor(0.2200, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3315, device='cuda:1')  +-  tensor(0.1651, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3778, device='cuda:1')  +-  tensor(0.0586, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 1.000 +- 0.006
Intervened Stability MCC for r=0.3 = 0.200 +- 0.307
Original Stability F1 for r=0.3 = 1.000 +- 0.004
Intervened Stability F1 for r=0.3 = 0.496 +- 0.196
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.717056
Plausibility completed in  0:00:05.200480
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3315, device='cuda:1')  +-  tensor(0.1651, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3822, device='cuda:1')  +-  tensor(0.2201, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3315, device='cuda:1')  +-  tensor(0.1651, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7173, device='cuda:1')  +-  tensor(0.0694, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.999 +- 0.013
Intervened Stability MCC for r=0.6 = 0.164 +- 0.319
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.760 +- 0.111
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.687559
Plausibility completed in  0:00:05.166876
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4395, device='cuda:1')  +-  tensor(0.0817, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4678, device='cuda:1')  +-  tensor(0.0918, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4395, device='cuda:1')  +-  tensor(0.0817, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3622, device='cuda:1')  +-  tensor(0.0284, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 1.000 +- 0.000
Intervened Stability MCC for r=0.3 = 0.431 +- 0.271
Original Stability F1 for r=0.3 = 1.000 +- 0.000
Intervened Stability F1 for r=0.3 = 0.624 +- 0.180
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.557296
Plausibility completed in  0:00:05.165916
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4395, device='cuda:1')  +-  tensor(0.0817, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4676, device='cuda:1')  +-  tensor(0.0920, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4395, device='cuda:1')  +-  tensor(0.0817, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7753, device='cuda:1')  +-  tensor(0.0766, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.204 +- 0.372
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.839 +- 0.088
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.685838
Plausibility completed in  0:00:05.152166
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.0998, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4268, device='cuda:1')  +-  tensor(0.1156, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.0998, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3676, device='cuda:1')  +-  tensor(0.0335, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.998 +- 0.020
Intervened Stability MCC for r=0.3 = 0.222 +- 0.300
Original Stability F1 for r=0.3 = 0.999 +- 0.013
Intervened Stability F1 for r=0.3 = 0.502 +- 0.194
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.709607
Plausibility completed in  0:00:05.152256
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.0998, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4266, device='cuda:1')  +-  tensor(0.1157, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.0998, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6914, device='cuda:1')  +-  tensor(0.0381, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.022
Intervened Stability MCC for r=0.6 = 0.208 +- 0.297
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.750 +- 0.097
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:29:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:30 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:43 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:45 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:47 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:29:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.588
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.491
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.511
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.697
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.491


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.574259
Plausibility completed in  0:00:05.264023
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3293, device='cuda:1')  +-  tensor(0.1735, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3762, device='cuda:1')  +-  tensor(0.2271, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3293, device='cuda:1')  +-  tensor(0.1735, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3906, device='cuda:1')  +-  tensor(0.0723, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.994 +- 0.044
Intervened Stability MCC for r=0.3 = 0.215 +- 0.295
Original Stability F1 for r=0.3 = 0.996 +- 0.030
Intervened Stability F1 for r=0.3 = 0.513 +- 0.195
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.728340
Plausibility completed in  0:00:05.234021
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3293, device='cuda:1')  +-  tensor(0.1735, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3759, device='cuda:1')  +-  tensor(0.2259, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3293, device='cuda:1')  +-  tensor(0.1735, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7141, device='cuda:1')  +-  tensor(0.0713, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.185 +- 0.333
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.758 +- 0.116
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.565709
Plausibility completed in  0:00:05.361797
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3402, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3903, device='cuda:1')  +-  tensor(0.2233, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3402, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3932, device='cuda:1')  +-  tensor(0.0701, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.994 +- 0.042
Intervened Stability MCC for r=0.3 = 0.227 +- 0.297
Original Stability F1 for r=0.3 = 0.996 +- 0.028
Intervened Stability F1 for r=0.3 = 0.520 +- 0.198
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.575182
Plausibility completed in  0:00:05.228740
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3402, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3901, device='cuda:1')  +-  tensor(0.2227, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3402, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7188, device='cuda:1')  +-  tensor(0.0705, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.033
Intervened Stability MCC for r=0.6 = 0.192 +- 0.327
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.763 +- 0.115
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.687964
Plausibility completed in  0:00:05.174125
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4450, device='cuda:1')  +-  tensor(0.0884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4748, device='cuda:1')  +-  tensor(0.0991, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4450, device='cuda:1')  +-  tensor(0.0884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3775, device='cuda:1')  +-  tensor(0.0440, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.013
Intervened Stability MCC for r=0.3 = 0.443 +- 0.258
Original Stability F1 for r=0.3 = 0.999 +- 0.009
Intervened Stability F1 for r=0.3 = 0.639 +- 0.171
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.707664
Plausibility completed in  0:00:05.181816
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4450, device='cuda:1')  +-  tensor(0.0884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4747, device='cuda:1')  +-  tensor(0.0991, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4450, device='cuda:1')  +-  tensor(0.0884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7633, device='cuda:1')  +-  tensor(0.0720, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.214 +- 0.364
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.835 +- 0.085
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.552232
Plausibility completed in  0:00:05.326859
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.1050, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4375, device='cuda:1')  +-  tensor(0.1211, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.1050, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3782, device='cuda:1')  +-  tensor(0.0434, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.996 +- 0.030
Intervened Stability MCC for r=0.3 = 0.218 +- 0.302
Original Stability F1 for r=0.3 = 0.998 +- 0.019
Intervened Stability F1 for r=0.3 = 0.506 +- 0.197
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.566176
Plausibility completed in  0:00:05.189162
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.1050, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4369, device='cuda:1')  +-  tensor(0.1215, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.1050, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6884, device='cuda:1')  +-  tensor(0.0348, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.022
Intervened Stability MCC for r=0.6 = 0.247 +- 0.292
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.758 +- 0.096
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:31:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:00 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:12 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:14 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:16 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:18 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:31:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.582
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.489
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.509
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.700
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.308
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.728103
Plausibility completed in  0:00:05.227459
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3258, device='cuda:1')  +-  tensor(0.1715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3735, device='cuda:1')  +-  tensor(0.2251, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3258, device='cuda:1')  +-  tensor(0.1715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3887, device='cuda:1')  +-  tensor(0.0703, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.046
Intervened Stability MCC for r=0.3 = 0.177 +- 0.306
Original Stability F1 for r=0.3 = 0.998 +- 0.026
Intervened Stability F1 for r=0.3 = 0.488 +- 0.199
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.730322
Plausibility completed in  0:00:05.218584
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3258, device='cuda:1')  +-  tensor(0.1715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3725, device='cuda:1')  +-  tensor(0.2241, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3258, device='cuda:1')  +-  tensor(0.1715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7130, device='cuda:1')  +-  tensor(0.0712, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.997 +- 0.023
Intervened Stability MCC for r=0.6 = 0.157 +- 0.328
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.750 +- 0.117
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.569044
Plausibility completed in  0:00:05.357269
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3366, device='cuda:1')  +-  tensor(0.1685, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3876, device='cuda:1')  +-  tensor(0.2215, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3366, device='cuda:1')  +-  tensor(0.1685, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3928, device='cuda:1')  +-  tensor(0.0684, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.036
Intervened Stability MCC for r=0.3 = 0.213 +- 0.310
Original Stability F1 for r=0.3 = 0.998 +- 0.021
Intervened Stability F1 for r=0.3 = 0.512 +- 0.201
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.566082
Plausibility completed in  0:00:05.208139
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3366, device='cuda:1')  +-  tensor(0.1685, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3867, device='cuda:1')  +-  tensor(0.2207, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3366, device='cuda:1')  +-  tensor(0.1685, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7196, device='cuda:1')  +-  tensor(0.0712, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.997 +- 0.027
Intervened Stability MCC for r=0.6 = 0.195 +- 0.337
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.765 +- 0.116
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.692006
Plausibility completed in  0:00:05.156438
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4471, device='cuda:1')  +-  tensor(0.0861, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4755, device='cuda:1')  +-  tensor(0.0955, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4471, device='cuda:1')  +-  tensor(0.0861, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3765, device='cuda:1')  +-  tensor(0.0445, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.997 +- 0.034
Intervened Stability MCC for r=0.3 = 0.440 +- 0.260
Original Stability F1 for r=0.3 = 0.998 +- 0.022
Intervened Stability F1 for r=0.3 = 0.636 +- 0.170
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.722095
Plausibility completed in  0:00:05.179299
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4471, device='cuda:1')  +-  tensor(0.0861, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4755, device='cuda:1')  +-  tensor(0.0955, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4471, device='cuda:1')  +-  tensor(0.0861, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7660, device='cuda:1')  +-  tensor(0.0726, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.210 +- 0.358
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.836 +- 0.087
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.551508
Plausibility completed in  0:00:05.330214
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3999, device='cuda:1')  +-  tensor(0.1047, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4359, device='cuda:1')  +-  tensor(0.1198, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3999, device='cuda:1')  +-  tensor(0.1047, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3801, device='cuda:1')  +-  tensor(0.0429, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.993 +- 0.048
Intervened Stability MCC for r=0.3 = 0.220 +- 0.302
Original Stability F1 for r=0.3 = 0.996 +- 0.031
Intervened Stability F1 for r=0.3 = 0.507 +- 0.200
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.564012
Plausibility completed in  0:00:05.164409
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3999, device='cuda:1')  +-  tensor(0.1047, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4348, device='cuda:1')  +-  tensor(0.1205, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3999, device='cuda:1')  +-  tensor(0.1047, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6876, device='cuda:1')  +-  tensor(0.0351, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.996 +- 0.029
Intervened Stability MCC for r=0.6 = 0.225 +- 0.302
Original Stability F1 for r=0.6 = 0.999 +- 0.011
Intervened Stability F1 for r=0.6 = 0.750 +- 0.102
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:32:30 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:30 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:42 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:44 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:46 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:48 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:32:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.592
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.496
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.258
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.453


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.580509
Plausibility completed in  0:00:05.241096
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3245, device='cuda:1')  +-  tensor(0.1704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3726, device='cuda:1')  +-  tensor(0.2239, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3245, device='cuda:1')  +-  tensor(0.1704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3910, device='cuda:1')  +-  tensor(0.0701, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.990 +- 0.053
Intervened Stability MCC for r=0.3 = 0.204 +- 0.295
Original Stability F1 for r=0.3 = 0.993 +- 0.035
Intervened Stability F1 for r=0.3 = 0.503 +- 0.197
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.740373
Plausibility completed in  0:00:05.243023
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3245, device='cuda:1')  +-  tensor(0.1704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3719, device='cuda:1')  +-  tensor(0.2235, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3245, device='cuda:1')  +-  tensor(0.1704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7120, device='cuda:1')  +-  tensor(0.0699, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.999 +- 0.011
Intervened Stability MCC for r=0.6 = 0.139 +- 0.299
Original Stability F1 for r=0.6 = 1.000 +- 0.004
Intervened Stability F1 for r=0.6 = 0.750 +- 0.108
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.575636
Plausibility completed in  0:00:05.365471
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1675, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3862, device='cuda:1')  +-  tensor(0.2202, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1675, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3973, device='cuda:1')  +-  tensor(0.0713, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.994 +- 0.045
Intervened Stability MCC for r=0.3 = 0.214 +- 0.304
Original Stability F1 for r=0.3 = 0.996 +- 0.028
Intervened Stability F1 for r=0.3 = 0.518 +- 0.194
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.582539
Plausibility completed in  0:00:05.377485
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1675, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3857, device='cuda:1')  +-  tensor(0.2198, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1675, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7171, device='cuda:1')  +-  tensor(0.0693, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.018
Intervened Stability MCC for r=0.6 = 0.149 +- 0.309
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.759 +- 0.107
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.556551
Plausibility completed in  0:00:05.185780
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4446, device='cuda:1')  +-  tensor(0.0858, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4736, device='cuda:1')  +-  tensor(0.0959, device='cuda:1') (0.001)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4446, device='cuda:1')  +-  tensor(0.0858, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3789, device='cuda:1')  +-  tensor(0.0432, device='cuda:1') (0.001)
Original Stability MCC for r=0.3 = 1.000 +- 0.006
Intervened Stability MCC for r=0.3 = 0.443 +- 0.262
Original Stability F1 for r=0.3 = 1.000 +- 0.004
Intervened Stability F1 for r=0.3 = 0.640 +- 0.174
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.731095
Plausibility completed in  0:00:05.190764
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4446, device='cuda:1')  +-  tensor(0.0858, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4732, device='cuda:1')  +-  tensor(0.0958, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4446, device='cuda:1')  +-  tensor(0.0858, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7645, device='cuda:1')  +-  tensor(0.0732, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.189 +- 0.369
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.832 +- 0.090
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.558660
Plausibility completed in  0:00:05.180716
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3982, device='cuda:1')  +-  tensor(0.1030, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4336, device='cuda:1')  +-  tensor(0.1182, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3982, device='cuda:1')  +-  tensor(0.1030, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3777, device='cuda:1')  +-  tensor(0.0417, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.995 +- 0.040
Intervened Stability MCC for r=0.3 = 0.221 +- 0.304
Original Stability F1 for r=0.3 = 0.997 +- 0.026
Intervened Stability F1 for r=0.3 = 0.509 +- 0.196
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.708831
Plausibility completed in  0:00:05.187047
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3983, device='cuda:1')  +-  tensor(0.1030, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4332, device='cuda:1')  +-  tensor(0.1193, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3983, device='cuda:1')  +-  tensor(0.1030, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6880, device='cuda:1')  +-  tensor(0.0463, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.999 +- 0.022
Intervened Stability MCC for r=0.6 = 0.183 +- 0.302
Original Stability F1 for r=0.6 = 1.000 +- 0.008
Intervened Stability F1 for r=0.6 = 0.738 +- 0.101
Intervened samples: 799
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:34:00 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:00 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:13 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:15 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:17 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:19 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:34:20 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.452
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.529
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.466
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.709
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.243
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.447


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.734727
Plausibility completed in  0:00:05.214042
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3721, device='cuda:1')  +-  tensor(0.2254, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3893, device='cuda:1')  +-  tensor(0.0715, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.016
Intervened Stability MCC for r=0.3 = 0.209 +- 0.304
Original Stability F1 for r=0.3 = 0.999 +- 0.011
Intervened Stability F1 for r=0.3 = 0.507 +- 0.194
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.582952
Plausibility completed in  0:00:05.381704
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3710, device='cuda:1')  +-  tensor(0.2243, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7118, device='cuda:1')  +-  tensor(0.0692, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.999 +- 0.013
Intervened Stability MCC for r=0.6 = 0.164 +- 0.312
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.753 +- 0.110
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.569972
Plausibility completed in  0:00:05.194612
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3339, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3855, device='cuda:1')  +-  tensor(0.2219, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3339, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3909, device='cuda:1')  +-  tensor(0.0682, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.997 +- 0.036
Intervened Stability MCC for r=0.3 = 0.221 +- 0.296
Original Stability F1 for r=0.3 = 0.998 +- 0.021
Intervened Stability F1 for r=0.3 = 0.517 +- 0.191
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.739951
Plausibility completed in  0:00:05.203961
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3339, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.3843, device='cuda:1')  +-  tensor(0.2211, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3339, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7149, device='cuda:1')  +-  tensor(0.0677, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.176 +- 0.323
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.759 +- 0.112
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.555297
Plausibility completed in  0:00:05.318918
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4577, device='cuda:1')  +-  tensor(0.0863, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4857, device='cuda:1')  +-  tensor(0.0945, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4577, device='cuda:1')  +-  tensor(0.0863, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3735, device='cuda:1')  +-  tensor(0.0360, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.994 +- 0.055
Intervened Stability MCC for r=0.3 = 0.419 +- 0.270
Original Stability F1 for r=0.3 = 0.996 +- 0.036
Intervened Stability F1 for r=0.3 = 0.622 +- 0.177
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.574643
Plausibility completed in  0:00:05.168747
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4577, device='cuda:1')  +-  tensor(0.0863, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4849, device='cuda:1')  +-  tensor(0.0943, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4577, device='cuda:1')  +-  tensor(0.0863, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7627, device='cuda:1')  +-  tensor(0.0706, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.181 +- 0.353
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.827 +- 0.086
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.699838
Plausibility completed in  0:00:05.331218
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3976, device='cuda:1')  +-  tensor(0.1036, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4334, device='cuda:1')  +-  tensor(0.1195, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3976, device='cuda:1')  +-  tensor(0.1036, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.3700, device='cuda:1')  +-  tensor(0.0365, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.996 +- 0.037
Intervened Stability MCC for r=0.3 = 0.201 +- 0.307
Original Stability F1 for r=0.3 = 0.998 +- 0.024
Intervened Stability F1 for r=0.3 = 0.490 +- 0.198
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.567913
Plausibility completed in  0:00:05.321097
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3976, device='cuda:1')  +-  tensor(0.1036, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4326, device='cuda:1')  +-  tensor(0.1194, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3976, device='cuda:1')  +-  tensor(0.1036, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.6900, device='cuda:1')  +-  tensor(0.0400, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.023
Intervened Stability MCC for r=0.6 = 0.182 +- 0.309
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.740 +- 0.104
Intervened samples: 800

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32478199 0.32478199] +- [0.00276193 0.00276193] (mean across ratios: 0.325 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.37268284 0.37203665] +- [0.00232714 0.00226548] (mean across ratios: 0.372 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33239399 0.63323349] +- [0.00305505 0.00314738] (mean across ratios: 0.483 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.38707725 0.71257422] +- [0.00571393 0.00089235] (mean across ratios: 0.550 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.99699396 0.9992476 ] +- [0.00225081 0.00025185] (mean across ratios: 0.998 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.50084375 0.75400735] +- [0.00918456 0.00369679] (mean across ratios: 0.627 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99552138 0.99801383] +- [0.00327626 0.00068307] (mean across ratios: 0.997 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.2003061  0.16422083] +- [0.01295103 0.01562103] (mean across ratios: 0.182 +- TODO)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.33548999 0.33548999] +- [0.00290896 0.00290896] (mean across ratios: 0.335 +- TODO)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.38642265 0.38580879] +- [0.00257152 0.00260883] (mean across ratios: 0.386 +- TODO)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.33252749 0.63368775] +- [0.00300955 0.00306271] (mean across ratios: 0.483 +- TODO)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.39040583 0.71754099] +- [0.00663078 0.00158759] (mean across ratios: 0.554 +- TODO)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.99751757 0.99912372] +- [0.00140283 0.00025731] (mean across ratios: 0.998 +- TODO)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.51250964 0.76134866] +- [0.00852037 0.00251209] (mean across ratios: 0.637 +- TODO)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.99623311 0.99760422] +- [0.00208457 0.00076131] (mean across ratios: 0.997 +- TODO)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.21503544 0.17513606] +- [0.00910152 0.01712026] (mean across ratios: 0.195 +- TODO)

(id) (val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.44678174 0.44678174] +- [0.00598185 0.00598185] (mean across ratios: 0.447 +- TODO)
(id) (val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.47548339 0.47517669] +- [0.00580261 0.00560441] (mean across ratios: 0.475 +- TODO)

(id) (val) STABILITY_WIOU_ORIGINAL: 	[0.34024625 0.63702475] +- [0.00472528 0.00426165] (mean across ratios: 0.489 +- TODO)
(id) (val) STABILITY_WIOU_PERTURBED: 	[0.37371344 0.76636686] +- [0.00604205 0.0046102 ] (mean across ratios: 0.570 +- TODO)

(id) (val) STABILITY_F1_ORIGINAL: 	[0.99866604 0.99999934] +- [0.00140885 0.        ] (mean across ratios: 0.999 +- TODO)
(id) (val) STABILITY_F1_PERTURBED: 	[0.63215815 0.83359555] +- [0.00755781 0.00424255] (mean across ratios: 0.733 +- TODO)

(id) (val) STABILITY_MCC_ORIGINAL: 	[0.99799412 1.        ] +- [0.0021413 0.       ] (mean across ratios: 0.999 +- TODO)
(id) (val) STABILITY_MCC_PERTURBED: 	[0.43520738 0.19963185] +- [0.00923419 0.0125988 ] (mean across ratios: 0.317 +- TODO)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.3984385  0.39846334] +- [0.00249419 0.00249232] (mean across ratios: 0.398 +- TODO)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.4334189  0.43280919] +- [0.00364844 0.00343104] (mean across ratios: 0.433 +- TODO)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.33231924 0.63533436] +- [0.0021855  0.00355976] (mean across ratios: 0.484 +- TODO)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.37473243 0.68906906] +- [0.00494234 0.00142302] (mean across ratios: 0.532 +- TODO)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99727842 0.99926815] +- [0.00106536 0.00030463] (mean across ratios: 0.998 +- TODO)
(id) (test) STABILITY_F1_PERTURBED: 	[0.50288155 0.74710072] +- [0.00676021 0.00733933] (mean across ratios: 0.625 +- TODO)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99583948 0.9979704 ] +- [0.00164345 0.000822  ] (mean across ratios: 0.997 +- TODO)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.2164433  0.20910004] +- [0.0077097 0.025046 ] (mean across ratios: 0.213 +- TODO)

Overall time of execution:  0:07:33.330724
DONE GSAT GOODMotif/basis 0.05
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:35:50 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:35:50 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:02 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:06 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:08 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:36:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 43...
[0m[1;37mINFO[0m: [1mCheckpoint 43: 
-----------------------------------
Train ACCURACY: 0.9308
Train Loss: 0.3145
ID Validation ACCURACY: 0.9293
ID Validation Loss: 0.3244
ID Test ACCURACY: 0.9283
ID Test Loss: 0.3193
OOD Validation ACCURACY: 0.6753
OOD Validation Loss: 0.8286
OOD Test ACCURACY: 0.4867
OOD Test Loss: 1.7108

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 39...
[0m[1;37mINFO[0m: [1mCheckpoint 39: 
-----------------------------------
Train ACCURACY: 0.9298
Train Loss: 0.3159
ID Validation ACCURACY: 0.9283
ID Validation Loss: 0.3336
ID Test ACCURACY: 0.9267
ID Test Loss: 0.3211
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3462
OOD Test ACCURACY: 0.6530
OOD Test Loss: 1.2926

[0m[1;37mINFO[0m: [1mChartInfo 0.9283 0.4867 0.9267 0.6530 0.9283 0.9303[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.570
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.487
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.585
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.505
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.696
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.178
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.455


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.759259
Plausibility completed in  0:00:05.216767
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3208, device='cuda:1')  +-  tensor(0.1680, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4265, device='cuda:1')  +-  tensor(0.2757, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3208, device='cuda:1')  +-  tensor(0.1680, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4263, device='cuda:1')  +-  tensor(0.0879, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.999 +- 0.007
Intervened Stability MCC for r=0.3 = 0.149 +- 0.314
Original Stability F1 for r=0.3 = 1.000 +- 0.005
Intervened Stability F1 for r=0.3 = 0.513 +- 0.194
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.706165
Plausibility completed in  0:00:05.215501
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3208, device='cuda:1')  +-  tensor(0.1680, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4255, device='cuda:1')  +-  tensor(0.2754, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3208, device='cuda:1')  +-  tensor(0.1680, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8059, device='cuda:1')  +-  tensor(0.1215, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.015
Intervened Stability MCC for r=0.6 = 0.051 +- 0.220
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.819 +- 0.127
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.546321
Plausibility completed in  0:00:05.352926
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3315, device='cuda:1')  +-  tensor(0.1651, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4440, device='cuda:1')  +-  tensor(0.2722, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3315, device='cuda:1')  +-  tensor(0.1651, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:1')  +-  tensor(0.0862, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 0.999 +- 0.008
Intervened Stability MCC for r=0.3 = 0.160 +- 0.322
Original Stability F1 for r=0.3 = 1.000 +- 0.006
Intervened Stability F1 for r=0.3 = 0.522 +- 0.197
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.545556
Plausibility completed in  0:00:05.180643
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3315, device='cuda:1')  +-  tensor(0.1651, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4427, device='cuda:1')  +-  tensor(0.2717, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3315, device='cuda:1')  +-  tensor(0.1651, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8171, device='cuda:1')  +-  tensor(0.1221, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.048 +- 0.217
Original Stability F1 for r=0.6 = 0.999 +- 0.005
Intervened Stability F1 for r=0.6 = 0.829 +- 0.127
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.668266
Plausibility completed in  0:00:05.151328
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4395, device='cuda:1')  +-  tensor(0.0817, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5383, device='cuda:1')  +-  tensor(0.1213, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4395, device='cuda:1')  +-  tensor(0.0817, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4187, device='cuda:1')  +-  tensor(0.0421, device='cuda:1') (0.002)
Original Stability MCC for r=0.3 = 1.000 +- 0.013
Intervened Stability MCC for r=0.3 = 0.409 +- 0.280
Original Stability F1 for r=0.3 = 1.000 +- 0.009
Intervened Stability F1 for r=0.3 = 0.646 +- 0.165
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.698567
Plausibility completed in  0:00:05.158024
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4395, device='cuda:1')  +-  tensor(0.0817, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5372, device='cuda:1')  +-  tensor(0.1225, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4395, device='cuda:1')  +-  tensor(0.0817, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8930, device='cuda:1')  +-  tensor(0.0762, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.031 +- 0.294
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.909 +- 0.077
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.528394
Plausibility completed in  0:00:05.300998
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.0998, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5019, device='cuda:1')  +-  tensor(0.1462, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.0998, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4263, device='cuda:1')  +-  tensor(0.0486, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.999 +- 0.019
Intervened Stability MCC for r=0.3 = 0.086 +- 0.325
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.473 +- 0.194
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.544191
Plausibility completed in  0:00:05.139904
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.0998, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5004, device='cuda:1')  +-  tensor(0.1469, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3945, device='cuda:1')  +-  tensor(0.0998, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8023, device='cuda:1')  +-  tensor(0.0637, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.999 +- 0.017
Intervened Stability MCC for r=0.6 = 0.085 +- 0.322
Original Stability F1 for r=0.6 = 1.000 +- 0.006
Intervened Stability F1 for r=0.6 = 0.814 +- 0.086
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:37:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:33 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:35 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:37 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:37:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 141...
[0m[1;37mINFO[0m: [1mCheckpoint 141: 
-----------------------------------
Train ACCURACY: 0.9309
Train Loss: 0.3119
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3271
ID Test ACCURACY: 0.9277
ID Test Loss: 0.3181
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 0.6208
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2346

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3279
ID Validation ACCURACY: 0.9250
ID Validation Loss: 0.3353
ID Test ACCURACY: 0.9243
ID Test Loss: 0.3312
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.3368
OOD Test ACCURACY: 0.5587
OOD Test Loss: 1.1490

[0m[1;37mINFO[0m: [1mChartInfo 0.9277 0.5837 0.9243 0.5587 0.9250 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.588
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.491
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.603
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.511
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.697
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.265
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.491


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.564213
Plausibility completed in  0:00:05.222843
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3293, device='cuda:1')  +-  tensor(0.1735, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4332, device='cuda:1')  +-  tensor(0.2778, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3293, device='cuda:1')  +-  tensor(0.1735, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4434, device='cuda:1')  +-  tensor(0.1056, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.994 +- 0.043
Intervened Stability MCC for r=0.3 = 0.160 +- 0.309
Original Stability F1 for r=0.3 = 0.996 +- 0.029
Intervened Stability F1 for r=0.3 = 0.531 +- 0.190
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.712293
Plausibility completed in  0:00:05.212114
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3293, device='cuda:1')  +-  tensor(0.1735, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4294, device='cuda:1')  +-  tensor(0.2714, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3293, device='cuda:1')  +-  tensor(0.1735, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8052, device='cuda:1')  +-  tensor(0.1208, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.997 +- 0.025
Intervened Stability MCC for r=0.6 = 0.102 +- 0.304
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.821 +- 0.133
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.551081
Plausibility completed in  0:00:05.357104
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3402, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4513, device='cuda:1')  +-  tensor(0.2747, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3402, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4483, device='cuda:1')  +-  tensor(0.1024, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.992 +- 0.060
Intervened Stability MCC for r=0.3 = 0.168 +- 0.310
Original Stability F1 for r=0.3 = 0.995 +- 0.041
Intervened Stability F1 for r=0.3 = 0.538 +- 0.191
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.558963
Plausibility completed in  0:00:05.360327
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3402, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4481, device='cuda:1')  +-  tensor(0.2697, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3402, device='cuda:1')  +-  tensor(0.1705, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8160, device='cuda:1')  +-  tensor(0.1213, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.020
Intervened Stability MCC for r=0.6 = 0.098 +- 0.302
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.832 +- 0.132
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.540903
Plausibility completed in  0:00:05.161452
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4450, device='cuda:1')  +-  tensor(0.0884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5486, device='cuda:1')  +-  tensor(0.1292, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4450, device='cuda:1')  +-  tensor(0.0884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4378, device='cuda:1')  +-  tensor(0.0624, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.999 +- 0.016
Intervened Stability MCC for r=0.3 = 0.434 +- 0.272
Original Stability F1 for r=0.3 = 0.999 +- 0.010
Intervened Stability F1 for r=0.3 = 0.667 +- 0.163
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.714202
Plausibility completed in  0:00:05.165506
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4450, device='cuda:1')  +-  tensor(0.0884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5479, device='cuda:1')  +-  tensor(0.1295, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4450, device='cuda:1')  +-  tensor(0.0884, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8800, device='cuda:1')  +-  tensor(0.0731, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.118 +- 0.371
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.908 +- 0.076
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.542269
Plausibility completed in  0:00:05.156159
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.1050, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5186, device='cuda:1')  +-  tensor(0.1556, device='cuda:1') (0.007)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.1050, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4406, device='cuda:1')  +-  tensor(0.0622, device='cuda:1') (0.005)
Original Stability MCC for r=0.3 = 0.993 +- 0.048
Intervened Stability MCC for r=0.3 = 0.104 +- 0.328
Original Stability F1 for r=0.3 = 0.996 +- 0.030
Intervened Stability F1 for r=0.3 = 0.492 +- 0.199
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.701996
Plausibility completed in  0:00:05.160438
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.1050, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5127, device='cuda:1')  +-  tensor(0.1561, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4020, device='cuda:1')  +-  tensor(0.1050, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7989, device='cuda:1')  +-  tensor(0.0654, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.999 +- 0.014
Intervened Stability MCC for r=0.6 = 0.133 +- 0.345
Original Stability F1 for r=0.6 = 1.000 +- 0.005
Intervened Stability F1 for r=0.6 = 0.823 +- 0.093
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:38:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:38:51 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:03 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:05 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:07 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:09 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:39:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 156...
[0m[1;37mINFO[0m: [1mCheckpoint 156: 
-----------------------------------
Train ACCURACY: 0.9315
Train Loss: 0.3074
ID Validation ACCURACY: 0.9300
ID Validation Loss: 0.3203
ID Test ACCURACY: 0.9287
ID Test Loss: 0.3132
OOD Validation ACCURACY: 0.6043
OOD Validation Loss: 1.1704
OOD Test ACCURACY: 0.5793
OOD Test Loss: 1.3878

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9269
Train Loss: 0.3333
ID Validation ACCURACY: 0.9240
ID Validation Loss: 0.3419
ID Test ACCURACY: 0.9233
ID Test Loss: 0.3373
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3663
OOD Test ACCURACY: 0.5720
OOD Test Loss: 1.3522

[0m[1;37mINFO[0m: [1mChartInfo 0.9287 0.5793 0.9233 0.5720 0.9240 0.9313[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.582
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.489
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.595
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.509
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.700
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.307
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.484


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.739016
Plausibility completed in  0:00:05.269854
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3258, device='cuda:1')  +-  tensor(0.1715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4296, device='cuda:1')  +-  tensor(0.2763, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3258, device='cuda:1')  +-  tensor(0.1715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4419, device='cuda:1')  +-  tensor(0.1032, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.018
Intervened Stability MCC for r=0.3 = 0.129 +- 0.311
Original Stability F1 for r=0.3 = 0.999 +- 0.012
Intervened Stability F1 for r=0.3 = 0.515 +- 0.194
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.583708
Plausibility completed in  0:00:05.429277
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3258, device='cuda:1')  +-  tensor(0.1715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4240, device='cuda:1')  +-  tensor(0.2697, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3258, device='cuda:1')  +-  tensor(0.1715, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8045, device='cuda:1')  +-  tensor(0.1214, device='cuda:1') (0.003)
Original Stability MCC for r=0.6 = 0.998 +- 0.022
Intervened Stability MCC for r=0.6 = 0.045 +- 0.245
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.815 +- 0.136
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.566722
Plausibility completed in  0:00:05.241069
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3366, device='cuda:1')  +-  tensor(0.1685, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4479, device='cuda:1')  +-  tensor(0.2729, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3366, device='cuda:1')  +-  tensor(0.1685, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4490, device='cuda:1')  +-  tensor(0.1013, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.996 +- 0.033
Intervened Stability MCC for r=0.3 = 0.168 +- 0.312
Original Stability F1 for r=0.3 = 0.997 +- 0.021
Intervened Stability F1 for r=0.3 = 0.536 +- 0.195
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.739296
Plausibility completed in  0:00:05.248779
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3366, device='cuda:1')  +-  tensor(0.1685, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4424, device='cuda:1')  +-  tensor(0.2673, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3366, device='cuda:1')  +-  tensor(0.1685, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8170, device='cuda:1')  +-  tensor(0.1234, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.021
Intervened Stability MCC for r=0.6 = 0.061 +- 0.264
Original Stability F1 for r=0.6 = 0.999 +- 0.008
Intervened Stability F1 for r=0.6 = 0.828 +- 0.140
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.561239
Plausibility completed in  0:00:05.371793
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4471, device='cuda:1')  +-  tensor(0.0861, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5460, device='cuda:1')  +-  tensor(0.1233, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4471, device='cuda:1')  +-  tensor(0.0861, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4359, device='cuda:1')  +-  tensor(0.0633, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.998 +- 0.032
Intervened Stability MCC for r=0.3 = 0.445 +- 0.272
Original Stability F1 for r=0.3 = 0.998 +- 0.021
Intervened Stability F1 for r=0.3 = 0.675 +- 0.156
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.574801
Plausibility completed in  0:00:05.221409
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4471, device='cuda:1')  +-  tensor(0.0861, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5458, device='cuda:1')  +-  tensor(0.1237, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4471, device='cuda:1')  +-  tensor(0.0861, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8827, device='cuda:1')  +-  tensor(0.0724, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.128 +- 0.363
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.913 +- 0.072
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.708868
Plausibility completed in  0:00:05.212185
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3999, device='cuda:1')  +-  tensor(0.1047, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5173, device='cuda:1')  +-  tensor(0.1548, device='cuda:1') (0.007)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3999, device='cuda:1')  +-  tensor(0.1047, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4432, device='cuda:1')  +-  tensor(0.0598, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.993 +- 0.055
Intervened Stability MCC for r=0.3 = 0.098 +- 0.344
Original Stability F1 for r=0.3 = 0.995 +- 0.035
Intervened Stability F1 for r=0.3 = 0.489 +- 0.211
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.571822
Plausibility completed in  0:00:05.378992
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3999, device='cuda:1')  +-  tensor(0.1047, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5087, device='cuda:1')  +-  tensor(0.1526, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3999, device='cuda:1')  +-  tensor(0.1047, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7967, device='cuda:1')  +-  tensor(0.0669, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.024
Intervened Stability MCC for r=0.6 = 0.107 +- 0.337
Original Stability F1 for r=0.6 = 0.999 +- 0.009
Intervened Stability F1 for r=0.6 = 0.813 +- 0.100
Intervened samples: 800
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:40:21 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:21 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:33 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:35 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:37 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:39 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:40:41 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 136...
[0m[1;37mINFO[0m: [1mCheckpoint 136: 
-----------------------------------
Train ACCURACY: 0.9312
Train Loss: 0.3182
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3316
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3271
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.4588
OOD Test ACCURACY: 0.5283
OOD Test Loss: 1.4435

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 30...
[0m[1;37mINFO[0m: [1mCheckpoint 30: 
-----------------------------------
Train ACCURACY: 0.9285
Train Loss: 0.3202
ID Validation ACCURACY: 0.9270
ID Validation Loss: 0.3310
ID Test ACCURACY: 0.9270
ID Test Loss: 0.3274
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3340
OOD Test ACCURACY: 0.5837
OOD Test Loss: 1.2512

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5283 0.9270 0.5837 0.9270 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.578
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.475
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.592
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.496
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.780
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.699
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.258
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.454


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.575869
Plausibility completed in  0:00:05.403395
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3245, device='cuda:1')  +-  tensor(0.1704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4298, device='cuda:1')  +-  tensor(0.2756, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3245, device='cuda:1')  +-  tensor(0.1704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4444, device='cuda:1')  +-  tensor(0.1031, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.990 +- 0.062
Intervened Stability MCC for r=0.3 = 0.149 +- 0.315
Original Stability F1 for r=0.3 = 0.994 +- 0.038
Intervened Stability F1 for r=0.3 = 0.526 +- 0.195
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.576156
Plausibility completed in  0:00:05.209629
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3245, device='cuda:1')  +-  tensor(0.1704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4233, device='cuda:1')  +-  tensor(0.2664, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3245, device='cuda:1')  +-  tensor(0.1704, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8015, device='cuda:1')  +-  tensor(0.1163, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.018
Intervened Stability MCC for r=0.6 = 0.078 +- 0.267
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.816 +- 0.128
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.707279
Plausibility completed in  0:00:05.197213
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1675, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4476, device='cuda:1')  +-  tensor(0.2720, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1675, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4543, device='cuda:1')  +-  tensor(0.1057, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.994 +- 0.035
Intervened Stability MCC for r=0.3 = 0.169 +- 0.323
Original Stability F1 for r=0.3 = 0.996 +- 0.024
Intervened Stability F1 for r=0.3 = 0.543 +- 0.193
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.571905
Plausibility completed in  0:00:05.371847
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1675, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4402, device='cuda:1')  +-  tensor(0.2623, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3353, device='cuda:1')  +-  tensor(0.1675, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8118, device='cuda:1')  +-  tensor(0.1170, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.020
Intervened Stability MCC for r=0.6 = 0.078 +- 0.289
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.825 +- 0.129
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.553484
Plausibility completed in  0:00:05.144794
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4446, device='cuda:1')  +-  tensor(0.0858, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5448, device='cuda:1')  +-  tensor(0.1236, device='cuda:1') (0.002)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4446, device='cuda:1')  +-  tensor(0.0858, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4383, device='cuda:1')  +-  tensor(0.0612, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.998 +- 0.032
Intervened Stability MCC for r=0.3 = 0.441 +- 0.272
Original Stability F1 for r=0.3 = 0.999 +- 0.022
Intervened Stability F1 for r=0.3 = 0.671 +- 0.164
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.721379
Plausibility completed in  0:00:05.168197
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4446, device='cuda:1')  +-  tensor(0.0858, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5438, device='cuda:1')  +-  tensor(0.1244, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4446, device='cuda:1')  +-  tensor(0.0858, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8815, device='cuda:1')  +-  tensor(0.0747, device='cuda:1') (0.001)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.074 +- 0.341
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.903 +- 0.079
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.546762
Plausibility completed in  0:00:05.305846
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3982, device='cuda:1')  +-  tensor(0.1030, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5133, device='cuda:1')  +-  tensor(0.1512, device='cuda:1') (0.006)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3982, device='cuda:1')  +-  tensor(0.1030, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4397, device='cuda:1')  +-  tensor(0.0587, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.994 +- 0.052
Intervened Stability MCC for r=0.3 = 0.081 +- 0.341
Original Stability F1 for r=0.3 = 0.996 +- 0.034
Intervened Stability F1 for r=0.3 = 0.481 +- 0.202
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.564728
Plausibility completed in  0:00:05.152099
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3983, device='cuda:1')  +-  tensor(0.1030, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5077, device='cuda:1')  +-  tensor(0.1481, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3983, device='cuda:1')  +-  tensor(0.1030, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7954, device='cuda:1')  +-  tensor(0.0729, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.999 +- 0.018
Intervened Stability MCC for r=0.6 = 0.059 +- 0.326
Original Stability F1 for r=0.6 = 1.000 +- 0.006
Intervened Stability F1 for r=0.6 = 0.802 +- 0.100
Intervened samples: 799
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_GSATGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Mon Sep 16 15:41:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 09/16/2024 03:41:51 PM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:04 PM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:06 PM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:08 PM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:10 PM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1mInit GINFeatExtractor
[0mUsing BN in BasicEncoder
mitigation_readout =  None
[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 09/16/2024 03:42:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.3152
ID Validation ACCURACY: 0.9303
ID Validation Loss: 0.3261
ID Test ACCURACY: 0.9280
ID Test Loss: 0.3206
OOD Validation ACCURACY: 0.5570
OOD Validation Loss: 1.0961
OOD Test ACCURACY: 0.5530
OOD Test Loss: 1.3591

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 46...
[0m[1;37mINFO[0m: [1mCheckpoint 46: 
-----------------------------------
Train ACCURACY: 0.9284
Train Loss: 0.3274
ID Validation ACCURACY: 0.9277
ID Validation Loss: 0.3360
ID Test ACCURACY: 0.9260
ID Test Loss: 0.3348
OOD Validation ACCURACY: 0.9320
OOD Validation Loss: 0.3331
OOD Test ACCURACY: 0.5507
OOD Test Loss: 1.5619

[0m[1;37mINFO[0m: [1mChartInfo 0.9280 0.5530 0.9260 0.5507 0.9277 0.9320[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
/mnt/cimec-storage6/users/steve.azzolin/sedignn/leci_private_fork/GOOD/utils/config_reader.py:166: UserWarning: Argument channel_weight_decay in the chosen config yaml file are not defined in command arguments, which will lead to incomplete code detection and the lack of argument temporary modification by adding command arguments.
  warnings.warn(f'Argument {key} in the chosen config yaml file are not defined in command arguments, '
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.531
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.452
GOODMotif(3000)
Data example from id_test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from id_test: (tensor([0, 1, 2]), tensor([1012, 1021,  967]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.529
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.466
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.781
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.709
GOODMotif(3000)
Data example from test: Data(edge_index=[2, 26], x=[12, 1], node_gt=[12], edge_gt=[26], y=[1], env_id=[1], ori_edge_index=[2, 26], node_perm=[12], num_nodes=12)
Label distribution from test: (tensor([0, 1, 2]), tensor([1017,  962, 1021]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.243
F1 for r=0.6 = 0.000
WIoU for r=0.6 = 0.447


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.740956
Plausibility completed in  0:00:05.213924
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4293, device='cuda:1')  +-  tensor(0.2769, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4420, device='cuda:1')  +-  tensor(0.1041, device='cuda:1') (0.003)
Original Stability MCC for r=0.3 = 0.997 +- 0.022
Intervened Stability MCC for r=0.3 = 0.163 +- 0.323
Original Stability F1 for r=0.3 = 0.998 +- 0.015
Intervened Stability F1 for r=0.3 = 0.526 +- 0.201
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.735045
Plausibility completed in  0:00:05.217466
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4227, device='cuda:1')  +-  tensor(0.2678, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3236, device='cuda:1')  +-  tensor(0.1696, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8004, device='cuda:1')  +-  tensor(0.1166, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.016
Intervened Stability MCC for r=0.6 = 0.068 +- 0.258
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.815 +- 0.126
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over id_test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.562533
Plausibility completed in  0:00:05.345261
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3339, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4468, device='cuda:1')  +-  tensor(0.2736, device='cuda:1') (0.005)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3339, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4461, device='cuda:1')  +-  tensor(0.0999, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.992 +- 0.056
Intervened Stability MCC for r=0.3 = 0.162 +- 0.336
Original Stability F1 for r=0.3 = 0.995 +- 0.035
Intervened Stability F1 for r=0.3 = 0.536 +- 0.201
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.573756
Plausibility completed in  0:00:05.209084
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3339, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.4398, device='cuda:1')  +-  tensor(0.2642, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3339, device='cuda:1')  +-  tensor(0.1668, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8091, device='cuda:1')  +-  tensor(0.1154, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.997 +- 0.019
Intervened Stability MCC for r=0.6 = 0.068 +- 0.277
Original Stability F1 for r=0.6 = 0.999 +- 0.007
Intervened Stability F1 for r=0.6 = 0.821 +- 0.129
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.702201
Plausibility completed in  0:00:05.153144
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4577, device='cuda:1')  +-  tensor(0.0863, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5545, device='cuda:1')  +-  tensor(0.1195, device='cuda:1') (0.003)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.4577, device='cuda:1')  +-  tensor(0.0863, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4318, device='cuda:1')  +-  tensor(0.0498, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.996 +- 0.044
Intervened Stability MCC for r=0.3 = 0.416 +- 0.281
Original Stability F1 for r=0.3 = 0.997 +- 0.029
Intervened Stability F1 for r=0.3 = 0.655 +- 0.165
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.566976
Plausibility completed in  0:00:05.334013
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4577, device='cuda:1')  +-  tensor(0.0863, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5520, device='cuda:1')  +-  tensor(0.1201, device='cuda:1') (0.000)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.4577, device='cuda:1')  +-  tensor(0.0863, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.8783, device='cuda:1')  +-  tensor(0.0712, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 1.000 +- 0.000
Intervened Stability MCC for r=0.6 = 0.052 +- 0.316
Original Stability F1 for r=0.6 = 1.000 +- 0.000
Intervened Stability F1 for r=0.6 = 0.897 +- 0.075
Intervened samples: 800


 -------------------------------------------------- 

#D#Computing stability detector extended under SUFF_SIMPLE over test across ratios (random_expl=False)


ratio=0.3


Interventions completed in  0:00:01.554225
Plausibility completed in  0:00:05.142765
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3976, device='cuda:1')  +-  tensor(0.1036, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.5130, device='cuda:1')  +-  tensor(0.1507, device='cuda:1') (0.007)
Original Plaus. XAI WIoU for r=0.3 =  tensor(0.3976, device='cuda:1')  +-  tensor(0.1036, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.3 =  tensor(0.4297, device='cuda:1')  +-  tensor(0.0504, device='cuda:1') (0.004)
Original Stability MCC for r=0.3 = 0.998 +- 0.023
Intervened Stability MCC for r=0.3 = 0.053 +- 0.342
Original Stability F1 for r=0.3 = 0.999 +- 0.015
Intervened Stability F1 for r=0.3 = 0.458 +- 0.203
Intervened samples: 800


ratio=0.6


Interventions completed in  0:00:01.717772
Plausibility completed in  0:00:05.163253
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3976, device='cuda:1')  +-  tensor(0.1036, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.5072, device='cuda:1')  +-  tensor(0.1507, device='cuda:1') (0.004)
Original Plaus. XAI WIoU for r=0.6 =  tensor(0.3976, device='cuda:1')  +-  tensor(0.1036, device='cuda:1')
Intervened Plaus. XAI WIoU for r=0.6 =  tensor(0.7971, device='cuda:1')  +-  tensor(0.0697, device='cuda:1') (0.002)
Original Stability MCC for r=0.6 = 0.998 +- 0.017
Intervened Stability MCC for r=0.6 = 0.038 +- 0.320
Original Stability F1 for r=0.6 = 0.999 +- 0.006
Intervened Stability F1 for r=0.6 = 0.799 +- 0.100
Intervened samples: 800

\FINISHED GOODMotif - GSATGIN
(id) (id_val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.32478199 0.32478199] +- [0.00276193 0.00276193] (mean across ratios: 0.325 +- TODO)
(id) (id_val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.42967064 0.42499298] +- [0.00213917 0.00239659] (mean across ratios: 0.427 +- TODO)

(id) (id_val) STABILITY_WIOU_ORIGINAL: 	[0.33239399 0.63323324] +- [0.00305505 0.00314726] (mean across ratios: 0.483 +- TODO)
(id) (id_val) STABILITY_WIOU_PERTURBED: 	[0.43961609 0.8035102 ] +- [0.00670056 0.00215813] (mean across ratios: 0.622 +- TODO)

(id) (id_val) STABILITY_F1_ORIGINAL: 	[0.9972111  0.99908915] +- [0.00207362 0.00021899] (mean across ratios: 0.998 +- TODO)
(id) (id_val) STABILITY_F1_PERTURBED: 	[0.5221074  0.81713603] +- [0.0071183  0.00277088] (mean across ratios: 0.670 +- TODO)

(id) (id_val) STABILITY_MCC_ORIGINAL: 	[0.99583337 0.99756978] +- [0.00317901 0.00060381] (mean across ratios: 0.997 +- TODO)
(id) (id_val) STABILITY_MCC_PERTURBED: 	[0.15003838 0.06887819] +- [0.01175739 0.02053251] (mean across ratios: 0.109 +- TODO)

(id) (id_test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.33548999 0.33548999] +- [0.00290896 0.00290896] (mean across ratios: 0.335 +- TODO)
(id) (id_test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.44750184 0.44264508] +- [0.00234047 0.00295628] (mean across ratios: 0.445 +- TODO)

(id) (id_test) STABILITY_WIOU_ORIGINAL: 	[0.33252749 0.63368775] +- [0.00300955 0.00306271] (mean across ratios: 0.483 +- TODO)
(id) (id_test) STABILITY_WIOU_PERTURBED: 	[0.44574289 0.81420432] +- [0.00782047 0.00321037] (mean across ratios: 0.630 +- TODO)

(id) (id_test) STABILITY_F1_ORIGINAL: 	[0.99655282 0.99919327] +- [0.00180336 0.00016414] (mean across ratios: 0.998 +- TODO)
(id) (id_test) STABILITY_F1_PERTURBED: 	[0.53478062 0.82695177] +- [0.00718881 0.00369225] (mean across ratios: 0.681 +- TODO)

(id) (id_test) STABILITY_MCC_ORIGINAL: 	[0.99486247 0.99784576] +- [0.00268941 0.00044185] (mean across ratios: 0.996 +- TODO)
(id) (id_test) STABILITY_MCC_PERTURBED: 	[0.16538495 0.07038682] +- [0.00389018 0.01678876] (mean across ratios: 0.118 +- TODO)

(id) (val) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.44678174 0.44678174] +- [0.00598185 0.00598185] (mean across ratios: 0.447 +- TODO)
(id) (val) PLAUSIBILITY_WIOU_PERTURBED: 	[0.54643792 0.54534575] +- [0.00527847 0.00488578] (mean across ratios: 0.546 +- TODO)

(id) (val) STABILITY_WIOU_ORIGINAL: 	[0.34024625 0.63702475] +- [0.00472528 0.00426165] (mean across ratios: 0.489 +- TODO)
(id) (val) STABILITY_WIOU_PERTURBED: 	[0.4324941  0.88310788] +- [0.00728344 0.00515403] (mean across ratios: 0.658 +- TODO)

(id) (val) STABILITY_F1_ORIGINAL: 	[0.99869938 0.99999934] +- [0.00083926 0.        ] (mean across ratios: 0.999 +- TODO)
(id) (val) STABILITY_F1_PERTURBED: 	[0.66281812 0.90591449] +- [0.01083311 0.00544737] (mean across ratios: 0.784 +- TODO)

(id) (val) STABILITY_MCC_ORIGINAL: 	[0.99804447 1.        ] +- [0.00128277 0.        ] (mean across ratios: 0.999 +- TODO)
(id) (val) STABILITY_MCC_PERTURBED: 	[0.42922686 0.08040409] +- [0.01425318 0.03717641] (mean across ratios: 0.255 +- TODO)

(id) (test) PLAUSIBILITY_WIOU_ORIGINAL: 	[0.3984385  0.39846334] +- [0.00249419 0.00249232] (mean across ratios: 0.398 +- TODO)
(id) (test) PLAUSIBILITY_WIOU_PERTURBED: 	[0.51283134 0.50732925] +- [0.00587939 0.00395204] (mean across ratios: 0.510 +- TODO)

(id) (test) STABILITY_WIOU_ORIGINAL: 	[0.33231924 0.63533436] +- [0.0021855  0.00355976] (mean across ratios: 0.484 +- TODO)
(id) (test) STABILITY_WIOU_PERTURBED: 	[0.43588941 0.79809035] +- [0.00661895 0.00236196] (mean across ratios: 0.617 +- TODO)

(id) (test) STABILITY_F1_ORIGINAL: 	[0.99688017 0.99946036] +- [0.00164385 0.00024786] (mean across ratios: 0.998 +- TODO)
(id) (test) STABILITY_F1_PERTURBED: 	[0.478789   0.81025635] +- [0.01240655 0.00857119] (mean across ratios: 0.645 +- TODO)

(id) (test) STABILITY_MCC_ORIGINAL: 	[0.99516563 0.99850307] +- [0.00259075 0.00066407] (mean across ratios: 0.997 +- TODO)
(id) (test) STABILITY_MCC_PERTURBED: 	[0.08430371 0.08431896] +- [0.01785818 0.03349659] (mean across ratios: 0.084 +- TODO)

Overall time of execution:  0:07:34.596131
DONE GSAT GOODMotif/basis 0.10
DONE all :)
