nohup: ignoring input
I'm the stability of the DET :))
The PID of this script is: 1667569

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:13:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:13:51 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 102...
[0m[1;37mINFO[0m: [1mCheckpoint 102: 
-----------------------------------
Train ACCURACY: 0.8846
Train Loss: 0.4663
ID Validation ACCURACY: 0.8883
ID Validation Loss: 0.4567
ID Test ACCURACY: 0.8753
ID Test Loss: 0.4923
OOD Validation ACCURACY: 0.8767
OOD Validation Loss: 0.5561
OOD Test ACCURACY: 0.8990
OOD Test Loss: 0.4482

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 149...
[0m[1;37mINFO[0m: [1mCheckpoint 149: 
-----------------------------------
Train ACCURACY: 0.8700
Train Loss: 0.4809
ID Validation ACCURACY: 0.8710
ID Validation Loss: 0.4691
ID Test ACCURACY: 0.8660
ID Test Loss: 0.5000
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.4306
OOD Test ACCURACY: 0.6947
OOD Test Loss: 0.8828

[0m[1;37mINFO[0m: [1mChartInfo 0.8753 0.8990 0.8660 0.6947 0.8710 0.9313[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.660
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.989



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.649069
Original XAI WIoU for r=0.3 =  tensor(0.7342, device='cuda:0')  +-  tensor(0.2531, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6514, device='cuda:0')  +-  tensor(0.2730, device='cuda:0') (0.10145808756351471)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.874910
Original XAI WIoU for r=0.3 =  tensor(0.9897, device='cuda:0')  +-  tensor(0.0502, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3298, device='cuda:0')  +-  tensor(0.0641, device='cuda:0') (0.0878911092877388)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:15:18 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:15:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 110...
[0m[1;37mINFO[0m: [1mCheckpoint 110: 
-----------------------------------
Train ACCURACY: 0.8872
Train Loss: 0.4454
ID Validation ACCURACY: 0.8927
ID Validation Loss: 0.4356
ID Test ACCURACY: 0.8933
ID Test Loss: 0.4534
OOD Validation ACCURACY: 0.8837
OOD Validation Loss: 0.4829
OOD Test ACCURACY: 0.8907
OOD Test Loss: 0.4426

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 127...
[0m[1;37mINFO[0m: [1mCheckpoint 127: 
-----------------------------------
Train ACCURACY: 0.8367
Train Loss: 0.5254
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.5010
ID Test ACCURACY: 0.8350
ID Test Loss: 0.5355
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.5277
OOD Test ACCURACY: 0.8627
OOD Test Loss: 0.5303

[0m[1;37mINFO[0m: [1mChartInfo 0.8933 0.8907 0.8350 0.8627 0.8440 0.9210[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.702
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.995



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.634830
Original XAI WIoU for r=0.3 =  tensor(0.7670, device='cuda:0')  +-  tensor(0.2417, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6750, device='cuda:0')  +-  tensor(0.2931, device='cuda:0') (0.08561138063669205)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.991581
Original XAI WIoU for r=0.3 =  tensor(0.9950, device='cuda:0')  +-  tensor(0.0432, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3539, device='cuda:0')  +-  tensor(0.0767, device='cuda:0') (0.11467626690864563)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:16:43 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:16:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 138...
[0m[1;37mINFO[0m: [1mCheckpoint 138: 
-----------------------------------
Train ACCURACY: 0.9123
Train Loss: 0.4007
ID Validation ACCURACY: 0.9150
ID Validation Loss: 0.3813
ID Test ACCURACY: 0.9053
ID Test Loss: 0.4430
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3879
OOD Test ACCURACY: 0.7097
OOD Test Loss: 0.7779

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8903
Train Loss: 0.4322
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4222
ID Test ACCURACY: 0.8893
ID Test Loss: 0.4666
OOD Validation ACCURACY: 0.9303
OOD Validation Loss: 0.3953
OOD Test ACCURACY: 0.8417
OOD Test Loss: 0.6994

[0m[1;37mINFO[0m: [1mChartInfo 0.9053 0.7097 0.8893 0.8417 0.8910 0.9303[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.593
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.994



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.694445
Original XAI WIoU for r=0.3 =  tensor(0.6969, device='cuda:0')  +-  tensor(0.2256, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6168, device='cuda:0')  +-  tensor(0.2715, device='cuda:0') (0.09258031845092773)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.875150
Original XAI WIoU for r=0.3 =  tensor(0.9944, device='cuda:0')  +-  tensor(0.0460, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3236, device='cuda:0')  +-  tensor(0.0634, device='cuda:0') (0.09265893697738647)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:18:07 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:18:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 120...
[0m[1;37mINFO[0m: [1mCheckpoint 120: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.5315
ID Validation ACCURACY: 0.8940
ID Validation Loss: 0.5268
ID Test ACCURACY: 0.8807
ID Test Loss: 0.5595
OOD Validation ACCURACY: 0.8480
OOD Validation Loss: 0.5785
OOD Test ACCURACY: 0.9053
OOD Test Loss: 0.4997

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 116...
[0m[1;37mINFO[0m: [1mCheckpoint 116: 
-----------------------------------
Train ACCURACY: 0.8415
Train Loss: 0.5162
ID Validation ACCURACY: 0.8440
ID Validation Loss: 0.4990
ID Test ACCURACY: 0.8423
ID Test Loss: 0.5364
OOD Validation ACCURACY: 0.9043
OOD Validation Loss: 0.5293
OOD Test ACCURACY: 0.7010
OOD Test Loss: 0.9220

[0m[1;37mINFO[0m: [1mChartInfo 0.8807 0.9053 0.8423 0.7010 0.8440 0.9043[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.841
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.996



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.621913
Original XAI WIoU for r=0.3 =  tensor(0.9049, device='cuda:0')  +-  tensor(0.1937, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6671, device='cuda:0')  +-  tensor(0.2495, device='cuda:0') (0.1474357694387436)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.810226
Original XAI WIoU for r=0.3 =  tensor(0.9965, device='cuda:0')  +-  tensor(0.0489, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:0')  +-  tensor(0.1417, device='cuda:0') (0.15767209231853485)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:19:29 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif2
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mDataset: {'train': GOODMotif2(18000), 'id_val': GOODMotif2(3000), 'id_test': GOODMotif2(3000), 'val': GOODMotif2(3000), 'test': GOODMotif2(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1m Data(edge_index=[2, 84], x=[29, 1], node_gt=[29], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[0mData(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:19:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8887
Train Loss: 0.4987
ID Validation ACCURACY: 0.8910
ID Validation Loss: 0.4744
ID Test ACCURACY: 0.8860
ID Test Loss: 0.5215
OOD Validation ACCURACY: 0.8970
OOD Validation Loss: 0.5042
OOD Test ACCURACY: 0.8647
OOD Test Loss: 0.5045

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 119...
[0m[1;37mINFO[0m: [1mCheckpoint 119: 
-----------------------------------
Train ACCURACY: 0.7957
Train Loss: 0.6628
ID Validation ACCURACY: 0.7933
ID Validation Loss: 0.6550
ID Test ACCURACY: 0.7830
ID Test Loss: 0.7186
OOD Validation ACCURACY: 0.9107
OOD Validation Loss: 0.5086
OOD Test ACCURACY: 0.8793
OOD Test Loss: 0.5214

[0m[1;37mINFO[0m: [1mChartInfo 0.8860 0.8647 0.7830 0.8793 0.7933 0.9107[0mGOODMotif2(3000)
Data example from id_val: Data(edge_index=[2, 86], x=[29, 1], node_gt=[29], edge_gt=[86], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=29)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1002, 1009,  989]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.656
GOODMotif2(3000)
Data example from val: Data(edge_index=[2, 84], x=[27, 1], node_gt=[27], edge_gt=[84], basis_id=[1], motif_id=[1], y=[1], env_id=[1], num_nodes=27)
Label distribution from val: (tensor([0, 1, 2]), tensor([1009,  978, 1013]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.930



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.842074
Original XAI WIoU for r=0.3 =  tensor(0.7154, device='cuda:0')  +-  tensor(0.2482, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6494, device='cuda:0')  +-  tensor(0.2594, device='cuda:0') (0.11234758049249649)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.832251
Original XAI WIoU for r=0.3 =  tensor(0.9276, device='cuda:0')  +-  tensor(0.1148, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3670, device='cuda:0')  +-  tensor(0.1055, device='cuda:0') (0.10504388064146042)
len(reference) = 3000


DONE GOODMotif2 - LECIGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.76367326] +- [0.07432533]
(id) id_val WIOU_PERTURBED: 	[0.65195575] +- [0.02001625]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.98065083] +- [0.02661738]
(id) val WIOU_PERTURBED: 	[0.36106752] +- [0.03837744]
DONE LECI GOODMotif2/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:21:17 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:17 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:30 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:31 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:34 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:35 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:21:37 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.9035
Train Loss: 0.4128
ID Validation ACCURACY: 0.9023
ID Validation Loss: 0.4270
ID Test ACCURACY: 0.8953
ID Test Loss: 0.4215
OOD Validation ACCURACY: 0.8670
OOD Validation Loss: 0.4795
OOD Test ACCURACY: 0.6793
OOD Test Loss: 0.8040

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8663
Train Loss: 0.4837
ID Validation ACCURACY: 0.8677
ID Validation Loss: 0.4913
ID Test ACCURACY: 0.8707
ID Test Loss: 0.4812
OOD Validation ACCURACY: 0.9310
OOD Validation Loss: 0.4154
OOD Test ACCURACY: 0.7697
OOD Test Loss: 0.6769

[0m[1;37mINFO[0m: [1mChartInfo 0.8953 0.6793 0.8707 0.7697 0.8677 0.9310[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.666
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.892



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.530558
Original XAI WIoU for r=0.3 =  tensor(0.7649, device='cuda:0')  +-  tensor(0.2609, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6067, device='cuda:0')  +-  tensor(0.2611, device='cuda:0') (0.09666896611452103)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.424900
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:22:54 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:22:54 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:06 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:08 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:10 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:12 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:23:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 133...
[0m[1;37mINFO[0m: [1mCheckpoint 133: 
-----------------------------------
Train ACCURACY: 0.8972
Train Loss: 0.4272
ID Validation ACCURACY: 0.8990
ID Validation Loss: 0.4477
ID Test ACCURACY: 0.9030
ID Test Loss: 0.4154
OOD Validation ACCURACY: 0.9210
OOD Validation Loss: 0.3677
OOD Test ACCURACY: 0.6950
OOD Test Loss: 0.7662

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8812
Train Loss: 0.4545
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4837
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4477
OOD Validation ACCURACY: 0.9280
OOD Validation Loss: 0.3667
OOD Test ACCURACY: 0.6257
OOD Test Loss: 1.1210

[0m[1;37mINFO[0m: [1mChartInfo 0.9030 0.6950 0.8840 0.6257 0.8767 0.9280[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.640
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.877



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.648523
Original XAI WIoU for r=0.3 =  tensor(0.7502, device='cuda:0')  +-  tensor(0.2537, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6177, device='cuda:0')  +-  tensor(0.2728, device='cuda:0') (0.11023050546646118)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.384768
Original XAI WIoU for r=0.3 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(1., device='cuda:0')  +-  tensor(0., device='cuda:0') (0.0)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:24:20 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:20 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:33 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:34 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:36 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:38 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:24:40 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 124...
[0m[1;37mINFO[0m: [1mCheckpoint 124: 
-----------------------------------
Train ACCURACY: 0.8979
Train Loss: 0.4207
ID Validation ACCURACY: 0.8973
ID Validation Loss: 0.4417
ID Test ACCURACY: 0.8983
ID Test Loss: 0.4343
OOD Validation ACCURACY: 0.8787
OOD Validation Loss: 0.4566
OOD Test ACCURACY: 0.7470
OOD Test Loss: 0.7194

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 109...
[0m[1;37mINFO[0m: [1mCheckpoint 109: 
-----------------------------------
Train ACCURACY: 0.8898
Train Loss: 0.4455
ID Validation ACCURACY: 0.8893
ID Validation Loss: 0.4661
ID Test ACCURACY: 0.8897
ID Test Loss: 0.4398
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3359
OOD Test ACCURACY: 0.7320
OOD Test Loss: 0.7218

[0m[1;37mINFO[0m: [1mChartInfo 0.8983 0.7470 0.8897 0.7320 0.8893 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.714
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.884



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.293863
Original XAI WIoU for r=0.3 =  tensor(0.7890, device='cuda:0')  +-  tensor(0.2203, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6366, device='cuda:0')  +-  tensor(0.2716, device='cuda:0') (0.09341750293970108)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.410168
Original XAI WIoU for r=0.3 =  tensor(0.9999, device='cuda:0')  +-  tensor(0.0004, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9941, device='cuda:0')  +-  tensor(0.0454, device='cuda:0') (0.0017062530387192965)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:25:37 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:37 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:49 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:51 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:53 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:55 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:25:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9111
Train Loss: 0.4118
ID Validation ACCURACY: 0.9100
ID Validation Loss: 0.4282
ID Test ACCURACY: 0.9093
ID Test Loss: 0.4292
OOD Validation ACCURACY: 0.8720
OOD Validation Loss: 0.4700
OOD Test ACCURACY: 0.6660
OOD Test Loss: 0.8918

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 146...
[0m[1;37mINFO[0m: [1mCheckpoint 146: 
-----------------------------------
Train ACCURACY: 0.8854
Train Loss: 0.4498
ID Validation ACCURACY: 0.8820
ID Validation Loss: 0.4694
ID Test ACCURACY: 0.8770
ID Test Loss: 0.4720
OOD Validation ACCURACY: 0.9293
OOD Validation Loss: 0.3373
OOD Test ACCURACY: 0.5787
OOD Test Loss: 1.0425

[0m[1;37mINFO[0m: [1mChartInfo 0.9093 0.6660 0.8770 0.5787 0.8820 0.9293[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.734
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.888



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.138424
Original XAI WIoU for r=0.3 =  tensor(0.8237, device='cuda:0')  +-  tensor(0.2282, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6383, device='cuda:0')  +-  tensor(0.2481, device='cuda:0') (0.1258159577846527)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.427040
Original XAI WIoU for r=0.3 =  tensor(0.9801, device='cuda:0')  +-  tensor(0.0528, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9818, device='cuda:0')  +-  tensor(0.0481, device='cuda:0') (0.00437130406498909)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:26:51 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:26:51 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:03 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:05 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:07 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:09 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1m Data(edge_index=[2, 64], x=[18, 1], node_gt=[18], edge_gt=[64], y=[1], env_id=[1], ori_edge_index=[2, 64], node_perm=[18], num_nodes=18)
[0mData(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:27:11 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 137...
[0m[1;37mINFO[0m: [1mCheckpoint 137: 
-----------------------------------
Train ACCURACY: 0.9082
Train Loss: 0.4161
ID Validation ACCURACY: 0.9060
ID Validation Loss: 0.4276
ID Test ACCURACY: 0.9077
ID Test Loss: 0.4175
OOD Validation ACCURACY: 0.9313
OOD Validation Loss: 0.3282
OOD Test ACCURACY: 0.8457
OOD Test Loss: 0.4898

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 115...
[0m[1;37mINFO[0m: [1mCheckpoint 115: 
-----------------------------------
Train ACCURACY: 0.8790
Train Loss: 0.4656
ID Validation ACCURACY: 0.8803
ID Validation Loss: 0.4735
ID Test ACCURACY: 0.8743
ID Test Loss: 0.4768
OOD Validation ACCURACY: 0.9317
OOD Validation Loss: 0.3354
OOD Test ACCURACY: 0.8413
OOD Test Loss: 0.5178

[0m[1;37mINFO[0m: [1mChartInfo 0.9077 0.8457 0.8743 0.8413 0.8803 0.9317[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 52], x=[19, 1], node_gt=[19], edge_gt=[52], y=[1], env_id=[1], ori_edge_index=[2, 52], node_perm=[19], num_nodes=19)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([ 959, 1004, 1037]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.708
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 34], x=[17, 1], node_gt=[17], edge_gt=[34], y=[1], env_id=[1], ori_edge_index=[2, 34], node_perm=[17], num_nodes=17)
Label distribution from val: (tensor([0, 1, 2]), tensor([1007,  991, 1002]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.785



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:05.033735
Original XAI WIoU for r=0.3 =  tensor(0.7997, device='cuda:0')  +-  tensor(0.2459, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6368, device='cuda:0')  +-  tensor(0.2529, device='cuda:0') (0.11209747195243835)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.135401
Original XAI WIoU for r=0.3 =  tensor(1.0000, device='cuda:0')  +-  tensor(0.0002, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.9998, device='cuda:0')  +-  tensor(0.0024, device='cuda:0') (6.618858606088907e-05)
len(reference) = 3000


DONE GOODMotif - LECIGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.78548733] +- [0.02587127]
(id) id_val WIOU_PERTURBED: 	[0.62722174] +- [0.01273517]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.99601128] +- [0.00793648]
(id) val WIOU_PERTURBED: 	[0.99513828] +- [0.00703681]
DONE LECI GOODMotif/basis 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:28:35 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:28:35 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:28:47 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:28:49 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:28:51 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:28:55 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:29:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 132...
[0m[1;37mINFO[0m: [1mCheckpoint 132: 
-----------------------------------
Train ACCURACY: 0.8827
Train Loss: 0.3987
ID Validation ACCURACY: 0.8930
ID Validation Loss: 0.3834
ID Test ACCURACY: 0.8840
ID Test Loss: 0.4012
OOD Validation ACCURACY: 0.7283
OOD Validation Loss: 1.1107
OOD Test ACCURACY: 0.3310
OOD Test Loss: 21.6677

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 65...
[0m[1;37mINFO[0m: [1mCheckpoint 65: 
-----------------------------------
Train ACCURACY: 0.8045
Train Loss: 0.7745
ID Validation ACCURACY: 0.8013
ID Validation Loss: 0.7842
ID Test ACCURACY: 0.8077
ID Test Loss: 0.7623
OOD Validation ACCURACY: 0.7757
OOD Validation Loss: 3.1424
OOD Test ACCURACY: 0.3323
OOD Test Loss: 22.8137

[0m[1;37mINFO[0m: [1mChartInfo 0.8840 0.3310 0.8077 0.3323 0.8013 0.7757[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.378
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.262



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.623579
Original XAI WIoU for r=0.3 =  tensor(0.4143, device='cuda:0')  +-  tensor(0.2121, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.5116, device='cuda:0')  +-  tensor(0.2767, device='cuda:0') (0.03988854959607124)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.226813
Original XAI WIoU for r=0.3 =  tensor(0.1854, device='cuda:0')  +-  tensor(0.1094, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.2308, device='cuda:0')  +-  tensor(0.1366, device='cuda:0') (0.01094814669340849)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 2


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:30:19 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:19 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:31 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:32 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:34 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:38 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:30:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 129...
[0m[1;37mINFO[0m: [1mCheckpoint 129: 
-----------------------------------
Train ACCURACY: 0.8893
Train Loss: 0.3913
ID Validation ACCURACY: 0.8960
ID Validation Loss: 0.3740
ID Test ACCURACY: 0.8947
ID Test Loss: 0.3923
OOD Validation ACCURACY: 0.6763
OOD Validation Loss: 1.0331
OOD Test ACCURACY: 0.3673
OOD Test Loss: 6.2730

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 60...
[0m[1;37mINFO[0m: [1mCheckpoint 60: 
-----------------------------------
Train ACCURACY: 0.8292
Train Loss: 0.6194
ID Validation ACCURACY: 0.8333
ID Validation Loss: 0.6112
ID Test ACCURACY: 0.8327
ID Test Loss: 0.6185
OOD Validation ACCURACY: 0.7947
OOD Validation Loss: 2.4540
OOD Test ACCURACY: 0.3827
OOD Test Loss: 9.6786

[0m[1;37mINFO[0m: [1mChartInfo 0.8947 0.3673 0.8327 0.3827 0.8333 0.7947[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.368
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.344



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.741347
Original XAI WIoU for r=0.3 =  tensor(0.4232, device='cuda:0')  +-  tensor(0.2026, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.5122, device='cuda:0')  +-  tensor(0.2684, device='cuda:0') (0.03303704038262367)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.988280
Original XAI WIoU for r=0.3 =  tensor(0.3198, device='cuda:0')  +-  tensor(0.3062, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3359, device='cuda:0')  +-  tensor(0.2633, device='cuda:0') (0.023888282477855682)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 3


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:32:04 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:04 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:15 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:17 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:19 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:23 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:32:29 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 192...
[0m[1;37mINFO[0m: [1mCheckpoint 192: 
-----------------------------------
Train ACCURACY: 0.9289
Train Loss: 0.3014
ID Validation ACCURACY: 0.9363
ID Validation Loss: 0.2957
ID Test ACCURACY: 0.9313
ID Test Loss: 0.3056
OOD Validation ACCURACY: 0.8693
OOD Validation Loss: 0.4349
OOD Test ACCURACY: 0.4197
OOD Test Loss: 3.0359

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 147...
[0m[1;37mINFO[0m: [1mCheckpoint 147: 
-----------------------------------
Train ACCURACY: 0.9283
Train Loss: 0.3001
ID Validation ACCURACY: 0.9340
ID Validation Loss: 0.2878
ID Test ACCURACY: 0.9307
ID Test Loss: 0.3011
OOD Validation ACCURACY: 0.9180
OOD Validation Loss: 0.3532
OOD Test ACCURACY: 0.4307
OOD Test Loss: 2.2044

[0m[1;37mINFO[0m: [1mChartInfo 0.9313 0.4197 0.9307 0.4307 0.9340 0.9180[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.482
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.463



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.530978
Original XAI WIoU for r=0.3 =  tensor(0.5922, device='cuda:0')  +-  tensor(0.3091, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.6550, device='cuda:0')  +-  tensor(0.3258, device='cuda:0') (0.04384210333228111)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.989478
Original XAI WIoU for r=0.3 =  tensor(0.4310, device='cuda:0')  +-  tensor(0.3487, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4732, device='cuda:0')  +-  tensor(0.3432, device='cuda:0') (0.050580594688653946)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 4


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:33:48 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:33:48 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:00 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:01 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:03 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:07 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:34:13 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 123...
[0m[1;37mINFO[0m: [1mCheckpoint 123: 
-----------------------------------
Train ACCURACY: 0.9266
Train Loss: 0.3084
ID Validation ACCURACY: 0.9333
ID Validation Loss: 0.2927
ID Test ACCURACY: 0.9300
ID Test Loss: 0.3020
OOD Validation ACCURACY: 0.7857
OOD Validation Loss: 0.8791
OOD Test ACCURACY: 0.5160
OOD Test Loss: 2.9408

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 183...
[0m[1;37mINFO[0m: [1mCheckpoint 183: 
-----------------------------------
Train ACCURACY: 0.9069
Train Loss: 0.3431
ID Validation ACCURACY: 0.9113
ID Validation Loss: 0.3325
ID Test ACCURACY: 0.9107
ID Test Loss: 0.3433
OOD Validation ACCURACY: 0.8867
OOD Validation Loss: 0.4057
OOD Test ACCURACY: 0.5663
OOD Test Loss: 1.7709

[0m[1;37mINFO[0m: [1mChartInfo 0.9300 0.5160 0.9107 0.5663 0.9113 0.8867[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.354
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.312



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.852434
Original XAI WIoU for r=0.3 =  tensor(0.4112, device='cuda:0')  +-  tensor(0.2328, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4188, device='cuda:0')  +-  tensor(0.2556, device='cuda:0') (0.049717120826244354)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:03.999912
Original XAI WIoU for r=0.3 =  tensor(0.3225, device='cuda:0')  +-  tensor(0.3396, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.3231, device='cuda:0')  +-  tensor(0.3273, device='cuda:0') (0.024876177310943604)
len(reference) = 3000
COMPUTING STABILITY DETECTOR FOR LOAD SPLIT = id AND SEED 5


model_dirname= repr_LECIvGIN_3l_meanpool_0.5dp_mitig_backboneNone_mitig_samplingfeatavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Sun Aug  4 11:35:31 2024
[0m[1;37mINFO[0m: [1mLoad Dataset GOODMotif
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:31 AM : [1mPermuting node indices to remove explanation bias for train
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:43 AM : [1mPermuting node indices to remove explanation bias for id_val
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:44 AM : [1mPermuting node indices to remove explanation bias for id_test
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:46 AM : [1mPermuting node indices to remove explanation bias for val
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:50 AM : [1mPermuting node indices to remove explanation bias for test
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mDataset: {'train': GOODMotif(18000), 'id_val': GOODMotif(3000), 'id_test': GOODMotif(3000), 'val': GOODMotif(3000), 'test': GOODMotif(3000), 'task': 'Multi-label classification', 'metric': 'Accuracy'}
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1m Data(edge_index=[2, 58], x=[17, 1], node_gt=[17], edge_gt=[58], y=[1], env_id=[1], ori_edge_index=[2, 58], node_perm=[17], num_nodes=17)
[0mData(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0mUsing feature sampling := feat
self.EF = 0
mitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0mLECIvGIN
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit GINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mInit vGINFeatExtractor
[0mmitigation_readout =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mUsing no mitigation (None)
[0mmitigation_virtual in vGINEncoder =  None
[1;34mDEBUG[0m: 08/04/2024 11:35:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 112...
[0m[1;37mINFO[0m: [1mCheckpoint 112: 
-----------------------------------
Train ACCURACY: 0.9028
Train Loss: 0.3784
ID Validation ACCURACY: 0.9050
ID Validation Loss: 0.3693
ID Test ACCURACY: 0.9047
ID Test Loss: 0.3724
OOD Validation ACCURACY: 0.8107
OOD Validation Loss: 0.5547
OOD Test ACCURACY: 0.4367
OOD Test Loss: 3.7916

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 184...
[0m[1;37mINFO[0m: [1mCheckpoint 184: 
-----------------------------------
Train ACCURACY: 0.8753
Train Loss: 0.4256
ID Validation ACCURACY: 0.8767
ID Validation Loss: 0.4180
ID Test ACCURACY: 0.8850
ID Test Loss: 0.4110
OOD Validation ACCURACY: 0.8257
OOD Validation Loss: 0.5473
OOD Test ACCURACY: 0.6033
OOD Test Loss: 1.3601

[0m[1;37mINFO[0m: [1mChartInfo 0.9047 0.4367 0.8850 0.6033 0.8767 0.8257[0mGOODMotif(3000)
Data example from id_val: Data(edge_index=[2, 80], x=[22, 1], node_gt=[22], edge_gt=[80], y=[1], env_id=[1], ori_edge_index=[2, 80], node_perm=[22], num_nodes=22)
Label distribution from id_val: (tensor([0, 1, 2]), tensor([1019,  973, 1008]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.246
GOODMotif(3000)
Data example from val: Data(edge_index=[2, 42], x=[20, 1], node_gt=[20], edge_gt=[42], y=[1], env_id=[1], ori_edge_index=[2, 42], node_perm=[20], num_nodes=20)
Label distribution from val: (tensor([0, 1, 2]), tensor([1025, 1009,  966]))
F1 for r=0.3 = 0.000
WIoU for r=0.3 = 0.280



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over id_val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.063694
Original XAI WIoU for r=0.3 =  tensor(0.3971, device='cuda:0')  +-  tensor(0.2053, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.4917, device='cuda:0')  +-  tensor(0.2811, device='cuda:0') (0.04805610701441765)
len(reference) = 3000



--------------------------------------------------


#D#Computing stability detector under SUFF_SIMPLE over val across ratios (random_expl=False)


ratio=0.3


Computing with masking
Completed in  0:00:04.026713
Original XAI WIoU for r=0.3 =  tensor(0.2415, device='cuda:0')  +-  tensor(0.1914, device='cuda:0')
Intervened XAI WIoU for r=0.3 =  tensor(0.2475, device='cuda:0')  +-  tensor(0.1648, device='cuda:0') (0.0334896445274353)
len(reference) = 3000


DONE GOODMotif - LECIvGIN
(id) id_val SUFF_SIMPLE: 	[] +- []
(id) id_val WIOU_ORIGINAL: 	[0.44761314] +- [0.07279325]
(id) id_val WIOU_PERTURBED: 	[0.51788024] +- [0.07665269]
(id) val SUFF_SIMPLE: 	[] +- []
(id) val WIOU_ORIGINAL: 	[0.30000614] +- [0.08320276]
(id) val WIOU_PERTURBED: 	[0.32208894] +- [0.08592075]
DONE LECI GOODMotif/size 0.05
DONE all :)
