nohup: ignoring input
I'm computing faithfulness :)
The PID of this script is: 103665

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 18:13:23 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 06:13:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mChartInfo 0.9860 0.9860 0.9860 0.9860 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.038
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.052
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.064
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.075
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.083
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037961999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.954
SUFF_SIMPLE for r=0.05 class 0.0 = 0.902 +- 0.214 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.95 +- 0.214 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all KL = 0.906 +- 0.214 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all L1 = 0.929 +- 0.148 (in-sample avg dev_std = 0.264)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051508
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.953
SUFF_SIMPLE for r=0.1 class 0.0 = 0.906 +- 0.217 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.942 +- 0.217 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all KL = 0.898 +- 0.217 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.1 all L1 = 0.926 +- 0.151 (in-sample avg dev_std = 0.275)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.063782
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.948
SUFF_SIMPLE for r=0.2 class 0.0 = 0.898 +- 0.221 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.946 +- 0.221 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.2 all KL = 0.899 +- 0.221 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.2 all L1 = 0.925 +- 0.156 (in-sample avg dev_std = 0.271)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075396
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.956
SUFF_SIMPLE for r=0.4 class 0.0 = 0.904 +- 0.215 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.95 +- 0.215 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.4 all KL = 0.903 +- 0.215 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.4 all L1 = 0.929 +- 0.145 (in-sample avg dev_std = 0.265)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08294800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.964
SUFF_SIMPLE for r=0.8 class 0.0 = 0.934 +- 0.190 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.954 +- 0.190 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 all KL = 0.93 +- 0.190 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 all L1 = 0.945 +- 0.138 (in-sample avg dev_std = 0.209)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085554
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.875
SUFF_SIMPLE for r=0.05 class 0.0 = 0.838 +- 0.321 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.321 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.05 all KL = 0.838 +- 0.321 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.05 all L1 = 0.915 +- 0.181 (in-sample avg dev_std = 0.281)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009137600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.874
SUFF_SIMPLE for r=0.1 class 0.0 = 0.838 +- 0.322 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.322 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.1 all KL = 0.836 +- 0.322 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.181 (in-sample avg dev_std = 0.281)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009422999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.874
SUFF_SIMPLE for r=0.2 class 0.0 = 0.834 +- 0.327 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.988 +- 0.327 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.2 all KL = 0.831 +- 0.327 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.2 all L1 = 0.912 +- 0.183 (in-sample avg dev_std = 0.288)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009673600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.874
SUFF_SIMPLE for r=0.4 class 0.0 = 0.83 +- 0.330 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.330 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.4 all KL = 0.83 +- 0.330 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.4 all L1 = 0.911 +- 0.185 (in-sample avg dev_std = 0.291)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097454
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.873
SUFF_SIMPLE for r=0.8 class 0.0 = 0.84 +- 0.316 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.316 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.8 all KL = 0.847 +- 0.316 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.8 all L1 = 0.916 +- 0.184 (in-sample avg dev_std = 0.274)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.026340999999999996
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.62
SUFF_SIMPLE for r=0.05 class 0.0 = 0.894 +- 0.239 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.848 +- 0.239 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.05 all KL = 0.88 +- 0.239 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.05 all L1 = 0.871 +- 0.219 (in-sample avg dev_std = 0.221)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0372252
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.619
SUFF_SIMPLE for r=0.1 class 0.0 = 0.896 +- 0.240 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.847 +- 0.240 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all KL = 0.881 +- 0.240 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all L1 = 0.872 +- 0.219 (in-sample avg dev_std = 0.218)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.62
SUFF_SIMPLE for r=0.2 class 0.0 = 0.895 +- 0.242 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.846 +- 0.242 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all KL = 0.881 +- 0.242 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all L1 = 0.871 +- 0.222 (in-sample avg dev_std = 0.209)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06344580000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.627
SUFF_SIMPLE for r=0.4 class 0.0 = 0.903 +- 0.226 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.861 +- 0.226 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all KL = 0.897 +- 0.226 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all L1 = 0.883 +- 0.210 (in-sample avg dev_std = 0.191)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790086
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.639
SUFF_SIMPLE for r=0.8 class 0.0 = 0.936 +- 0.173 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.907 +- 0.173 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.173 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 all L1 = 0.922 +- 0.176 (in-sample avg dev_std = 0.092)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037961999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.985
NEC for r=0.05 class 0.0 = 0.029 +- 0.100 (in-sample avg dev_std = 0.108)
NEC for r=0.05 class 1.0 = 0.019 +- 0.100 (in-sample avg dev_std = 0.108)
NEC for r=0.05 all KL = 0.021 +- 0.100 (in-sample avg dev_std = 0.108)
NEC for r=0.05 all L1 = 0.023 +- 0.080 (in-sample avg dev_std = 0.108)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051508
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.987
NEC for r=0.1 class 0.0 = 0.025 +- 0.101 (in-sample avg dev_std = 0.117)
NEC for r=0.1 class 1.0 = 0.02 +- 0.101 (in-sample avg dev_std = 0.117)
NEC for r=0.1 all KL = 0.023 +- 0.101 (in-sample avg dev_std = 0.117)
NEC for r=0.1 all L1 = 0.022 +- 0.072 (in-sample avg dev_std = 0.117)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.063782
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.986
NEC for r=0.2 class 0.0 = 0.033 +- 0.102 (in-sample avg dev_std = 0.131)
NEC for r=0.2 class 1.0 = 0.017 +- 0.102 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all KL = 0.023 +- 0.102 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all L1 = 0.024 +- 0.080 (in-sample avg dev_std = 0.131)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075396
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.984
NEC for r=0.4 class 0.0 = 0.028 +- 0.100 (in-sample avg dev_std = 0.140)
NEC for r=0.4 class 1.0 = 0.023 +- 0.100 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all KL = 0.026 +- 0.100 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all L1 = 0.025 +- 0.076 (in-sample avg dev_std = 0.140)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08294800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.987
NEC for r=0.8 class 0.0 = 0.033 +- 0.093 (in-sample avg dev_std = 0.144)
NEC for r=0.8 class 1.0 = 0.016 +- 0.093 (in-sample avg dev_std = 0.144)
NEC for r=0.8 all KL = 0.023 +- 0.093 (in-sample avg dev_std = 0.144)
NEC for r=0.8 all L1 = 0.024 +- 0.072 (in-sample avg dev_std = 0.144)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085554
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.865
NEC for r=0.05 class 0.0 = 0.068 +- 0.150 (in-sample avg dev_std = 0.134)
NEC for r=0.05 class 1.0 = 0.003 +- 0.150 (in-sample avg dev_std = 0.134)
NEC for r=0.05 all KL = 0.038 +- 0.150 (in-sample avg dev_std = 0.134)
NEC for r=0.05 all L1 = 0.035 +- 0.115 (in-sample avg dev_std = 0.134)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009137600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.865
NEC for r=0.1 class 0.0 = 0.069 +- 0.156 (in-sample avg dev_std = 0.143)
NEC for r=0.1 class 1.0 = 0.003 +- 0.156 (in-sample avg dev_std = 0.143)
NEC for r=0.1 all KL = 0.042 +- 0.156 (in-sample avg dev_std = 0.143)
NEC for r=0.1 all L1 = 0.036 +- 0.112 (in-sample avg dev_std = 0.143)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009422999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.866
NEC for r=0.2 class 0.0 = 0.069 +- 0.152 (in-sample avg dev_std = 0.141)
NEC for r=0.2 class 1.0 = 0.003 +- 0.152 (in-sample avg dev_std = 0.141)
NEC for r=0.2 all KL = 0.043 +- 0.152 (in-sample avg dev_std = 0.141)
NEC for r=0.2 all L1 = 0.036 +- 0.110 (in-sample avg dev_std = 0.141)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009673600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.865
NEC for r=0.4 class 0.0 = 0.069 +- 0.159 (in-sample avg dev_std = 0.144)
NEC for r=0.4 class 1.0 = 0.003 +- 0.159 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all KL = 0.045 +- 0.159 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all L1 = 0.036 +- 0.109 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097454
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.866
NEC for r=0.8 class 0.0 = 0.07 +- 0.157 (in-sample avg dev_std = 0.148)
NEC for r=0.8 class 1.0 = 0.003 +- 0.157 (in-sample avg dev_std = 0.148)
NEC for r=0.8 all KL = 0.046 +- 0.157 (in-sample avg dev_std = 0.148)
NEC for r=0.8 all L1 = 0.036 +- 0.109 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.026340999999999996
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.651
NEC for r=0.05 class 0.0 = 0.036 +- 0.111 (in-sample avg dev_std = 0.025)
NEC for r=0.05 class 1.0 = 0.059 +- 0.111 (in-sample avg dev_std = 0.025)
NEC for r=0.05 all KL = 0.025 +- 0.111 (in-sample avg dev_std = 0.025)
NEC for r=0.05 all L1 = 0.047 +- 0.127 (in-sample avg dev_std = 0.025)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0372252
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.643
NEC for r=0.1 class 0.0 = 0.049 +- 0.141 (in-sample avg dev_std = 0.075)
NEC for r=0.1 class 1.0 = 0.067 +- 0.141 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all KL = 0.036 +- 0.141 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all L1 = 0.058 +- 0.146 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.642
NEC for r=0.2 class 0.0 = 0.06 +- 0.156 (in-sample avg dev_std = 0.122)
NEC for r=0.2 class 1.0 = 0.083 +- 0.156 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all KL = 0.05 +- 0.156 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all L1 = 0.072 +- 0.160 (in-sample avg dev_std = 0.122)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06344580000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.639
NEC for r=0.4 class 0.0 = 0.07 +- 0.173 (in-sample avg dev_std = 0.165)
NEC for r=0.4 class 1.0 = 0.099 +- 0.173 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all KL = 0.066 +- 0.173 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all L1 = 0.084 +- 0.172 (in-sample avg dev_std = 0.165)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.652
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790086
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.638
NEC for r=0.8 class 0.0 = 0.073 +- 0.178 (in-sample avg dev_std = 0.197)
NEC for r=0.8 class 1.0 = 0.104 +- 0.178 (in-sample avg dev_std = 0.197)
NEC for r=0.8 all KL = 0.073 +- 0.178 (in-sample avg dev_std = 0.197)
NEC for r=0.8 all L1 = 0.088 +- 0.173 (in-sample avg dev_std = 0.197)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 18:28:42 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 06:28:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.048
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.059
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.038
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.064
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03645400000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.964
SUFF_SIMPLE for r=0.05 class 0.0 = 0.904 +- 0.197 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.97 +- 0.197 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.05 all KL = 0.919 +- 0.197 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.05 all L1 = 0.941 +- 0.127 (in-sample avg dev_std = 0.257)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048091999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.96
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.203 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.967 +- 0.203 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.1 all KL = 0.916 +- 0.203 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.133 (in-sample avg dev_std = 0.265)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059421999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.97
SUFF_SIMPLE for r=0.2 class 0.0 = 0.913 +- 0.180 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.977 +- 0.180 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 all KL = 0.93 +- 0.180 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.2 all L1 = 0.948 +- 0.112 (in-sample avg dev_std = 0.238)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07090400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.965
SUFF_SIMPLE for r=0.4 class 0.0 = 0.904 +- 0.201 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.973 +- 0.201 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.4 all KL = 0.922 +- 0.201 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.4 all L1 = 0.942 +- 0.130 (in-sample avg dev_std = 0.247)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07983799999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.97
SUFF_SIMPLE for r=0.8 class 0.0 = 0.92 +- 0.174 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.981 +- 0.174 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 all KL = 0.944 +- 0.174 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.114 (in-sample avg dev_std = 0.200)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090664
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.927
SUFF_SIMPLE for r=0.05 class 0.0 = 0.977 +- 0.172 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.878 +- 0.172 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all KL = 0.933 +- 0.172 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all L1 = 0.927 +- 0.128 (in-sample avg dev_std = 0.176)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.926
SUFF_SIMPLE for r=0.1 class 0.0 = 0.975 +- 0.177 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.877 +- 0.177 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.1 all KL = 0.931 +- 0.177 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.1 all L1 = 0.926 +- 0.129 (in-sample avg dev_std = 0.179)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009436599999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.926
SUFF_SIMPLE for r=0.2 class 0.0 = 0.976 +- 0.174 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.878 +- 0.174 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.2 all KL = 0.933 +- 0.174 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.2 all L1 = 0.927 +- 0.127 (in-sample avg dev_std = 0.176)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009517
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.925
SUFF_SIMPLE for r=0.4 class 0.0 = 0.976 +- 0.176 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.878 +- 0.176 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.4 all KL = 0.932 +- 0.176 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.4 all L1 = 0.926 +- 0.128 (in-sample avg dev_std = 0.177)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.927
SUFF_SIMPLE for r=0.8 class 0.0 = 0.978 +- 0.163 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.879 +- 0.163 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.8 all KL = 0.94 +- 0.163 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.8 all L1 = 0.928 +- 0.130 (in-sample avg dev_std = 0.165)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027151400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.66
SUFF_SIMPLE for r=0.05 class 0.0 = 0.898 +- 0.240 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.86 +- 0.240 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.05 all KL = 0.884 +- 0.240 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.05 all L1 = 0.879 +- 0.207 (in-sample avg dev_std = 0.217)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.038323800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.658
SUFF_SIMPLE for r=0.1 class 0.0 = 0.898 +- 0.240 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.859 +- 0.240 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 all KL = 0.883 +- 0.240 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.1 all L1 = 0.879 +- 0.207 (in-sample avg dev_std = 0.217)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05034740000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.658
SUFF_SIMPLE for r=0.2 class 0.0 = 0.897 +- 0.242 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.86 +- 0.242 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.242 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all L1 = 0.879 +- 0.210 (in-sample avg dev_std = 0.205)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06435620000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.666
SUFF_SIMPLE for r=0.4 class 0.0 = 0.905 +- 0.228 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.871 +- 0.228 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.4 all KL = 0.896 +- 0.228 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.4 all L1 = 0.888 +- 0.200 (in-sample avg dev_std = 0.199)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.696
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0799668
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.679
SUFF_SIMPLE for r=0.8 class 0.0 = 0.935 +- 0.177 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.913 +- 0.177 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.8 all KL = 0.944 +- 0.177 (in-sample avg dev_std = 0.095)
SUFF_SIMPLE for r=0.8 all L1 = 0.924 +- 0.173 (in-sample avg dev_std = 0.095)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03645400000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.988
NEC for r=0.05 class 0.0 = 0.022 +- 0.072 (in-sample avg dev_std = 0.080)
NEC for r=0.05 class 1.0 = 0.008 +- 0.072 (in-sample avg dev_std = 0.080)
NEC for r=0.05 all KL = 0.011 +- 0.072 (in-sample avg dev_std = 0.080)
NEC for r=0.05 all L1 = 0.014 +- 0.058 (in-sample avg dev_std = 0.080)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048091999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.985
NEC for r=0.1 class 0.0 = 0.029 +- 0.086 (in-sample avg dev_std = 0.098)
NEC for r=0.1 class 1.0 = 0.009 +- 0.086 (in-sample avg dev_std = 0.098)
NEC for r=0.1 all KL = 0.016 +- 0.086 (in-sample avg dev_std = 0.098)
NEC for r=0.1 all L1 = 0.018 +- 0.068 (in-sample avg dev_std = 0.098)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059421999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.985
NEC for r=0.2 class 0.0 = 0.029 +- 0.077 (in-sample avg dev_std = 0.113)
NEC for r=0.2 class 1.0 = 0.012 +- 0.077 (in-sample avg dev_std = 0.113)
NEC for r=0.2 all KL = 0.017 +- 0.077 (in-sample avg dev_std = 0.113)
NEC for r=0.2 all L1 = 0.019 +- 0.068 (in-sample avg dev_std = 0.113)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07090400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.985
NEC for r=0.4 class 0.0 = 0.028 +- 0.089 (in-sample avg dev_std = 0.120)
NEC for r=0.4 class 1.0 = 0.012 +- 0.089 (in-sample avg dev_std = 0.120)
NEC for r=0.4 all KL = 0.019 +- 0.089 (in-sample avg dev_std = 0.120)
NEC for r=0.4 all L1 = 0.019 +- 0.068 (in-sample avg dev_std = 0.120)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07983799999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.988
NEC for r=0.8 class 0.0 = 0.028 +- 0.084 (in-sample avg dev_std = 0.129)
NEC for r=0.8 class 1.0 = 0.01 +- 0.084 (in-sample avg dev_std = 0.129)
NEC for r=0.8 all KL = 0.019 +- 0.084 (in-sample avg dev_std = 0.129)
NEC for r=0.8 all L1 = 0.018 +- 0.059 (in-sample avg dev_std = 0.129)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090664
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.926
NEC for r=0.05 class 0.0 = 0.007 +- 0.083 (in-sample avg dev_std = 0.102)
NEC for r=0.05 class 1.0 = 0.08 +- 0.083 (in-sample avg dev_std = 0.102)
NEC for r=0.05 all KL = 0.02 +- 0.083 (in-sample avg dev_std = 0.102)
NEC for r=0.05 all L1 = 0.044 +- 0.093 (in-sample avg dev_std = 0.102)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.928
NEC for r=0.1 class 0.0 = 0.008 +- 0.078 (in-sample avg dev_std = 0.107)
NEC for r=0.1 class 1.0 = 0.078 +- 0.078 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all KL = 0.02 +- 0.078 (in-sample avg dev_std = 0.107)
NEC for r=0.1 all L1 = 0.043 +- 0.088 (in-sample avg dev_std = 0.107)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009436599999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.927
NEC for r=0.2 class 0.0 = 0.009 +- 0.089 (in-sample avg dev_std = 0.117)
NEC for r=0.2 class 1.0 = 0.079 +- 0.089 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all KL = 0.023 +- 0.089 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all L1 = 0.044 +- 0.086 (in-sample avg dev_std = 0.117)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009517
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.927
NEC for r=0.4 class 0.0 = 0.009 +- 0.086 (in-sample avg dev_std = 0.119)
NEC for r=0.4 class 1.0 = 0.079 +- 0.086 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all KL = 0.024 +- 0.086 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all L1 = 0.044 +- 0.084 (in-sample avg dev_std = 0.119)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.927
NEC for r=0.8 class 0.0 = 0.009 +- 0.088 (in-sample avg dev_std = 0.119)
NEC for r=0.8 class 1.0 = 0.078 +- 0.088 (in-sample avg dev_std = 0.119)
NEC for r=0.8 all KL = 0.024 +- 0.088 (in-sample avg dev_std = 0.119)
NEC for r=0.8 all L1 = 0.044 +- 0.084 (in-sample avg dev_std = 0.119)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027151400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.688
NEC for r=0.05 class 0.0 = 0.035 +- 0.120 (in-sample avg dev_std = 0.044)
NEC for r=0.05 class 1.0 = 0.058 +- 0.120 (in-sample avg dev_std = 0.044)
NEC for r=0.05 all KL = 0.027 +- 0.120 (in-sample avg dev_std = 0.044)
NEC for r=0.05 all L1 = 0.047 +- 0.129 (in-sample avg dev_std = 0.044)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.038323800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.684
NEC for r=0.1 class 0.0 = 0.046 +- 0.143 (in-sample avg dev_std = 0.081)
NEC for r=0.1 class 1.0 = 0.065 +- 0.143 (in-sample avg dev_std = 0.081)
NEC for r=0.1 all KL = 0.037 +- 0.143 (in-sample avg dev_std = 0.081)
NEC for r=0.1 all L1 = 0.056 +- 0.143 (in-sample avg dev_std = 0.081)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05034740000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.677
NEC for r=0.2 class 0.0 = 0.059 +- 0.165 (in-sample avg dev_std = 0.132)
NEC for r=0.2 class 1.0 = 0.076 +- 0.165 (in-sample avg dev_std = 0.132)
NEC for r=0.2 all KL = 0.05 +- 0.165 (in-sample avg dev_std = 0.132)
NEC for r=0.2 all L1 = 0.068 +- 0.157 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06435620000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.675
NEC for r=0.4 class 0.0 = 0.063 +- 0.170 (in-sample avg dev_std = 0.164)
NEC for r=0.4 class 1.0 = 0.088 +- 0.170 (in-sample avg dev_std = 0.164)
NEC for r=0.4 all KL = 0.062 +- 0.170 (in-sample avg dev_std = 0.164)
NEC for r=0.4 all L1 = 0.075 +- 0.158 (in-sample avg dev_std = 0.164)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.695
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0799668
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.674
NEC for r=0.8 class 0.0 = 0.07 +- 0.177 (in-sample avg dev_std = 0.192)
NEC for r=0.8 class 1.0 = 0.093 +- 0.177 (in-sample avg dev_std = 0.192)
NEC for r=0.8 all KL = 0.07 +- 0.177 (in-sample avg dev_std = 0.192)
NEC for r=0.8 all L1 = 0.081 +- 0.161 (in-sample avg dev_std = 0.192)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 18:44:18 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 06:44:18 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 77 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.048
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.062
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035300000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.93
SUFF_SIMPLE for r=0.05 class 0.0 = 0.849 +- 0.271 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.941 +- 0.271 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.05 all KL = 0.86 +- 0.271 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.05 all L1 = 0.9 +- 0.176 (in-sample avg dev_std = 0.337)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047757999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.934
SUFF_SIMPLE for r=0.1 class 0.0 = 0.847 +- 0.265 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.945 +- 0.265 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.1 all KL = 0.863 +- 0.265 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.1 all L1 = 0.902 +- 0.170 (in-sample avg dev_std = 0.337)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061932
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.938
SUFF_SIMPLE for r=0.2 class 0.0 = 0.854 +- 0.262 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.943 +- 0.262 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.2 all KL = 0.866 +- 0.262 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.2 all L1 = 0.903 +- 0.167 (in-sample avg dev_std = 0.336)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071274
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.929
SUFF_SIMPLE for r=0.4 class 0.0 = 0.851 +- 0.271 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.938 +- 0.271 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.4 all KL = 0.861 +- 0.271 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.4 all L1 = 0.899 +- 0.177 (in-sample avg dev_std = 0.338)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078928
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.937
SUFF_SIMPLE for r=0.8 class 0.0 = 0.866 +- 0.262 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.951 +- 0.262 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.8 all KL = 0.887 +- 0.262 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.8 all L1 = 0.913 +- 0.177 (in-sample avg dev_std = 0.291)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008754999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.768
SUFF_SIMPLE for r=0.05 class 0.0 = 0.963 +- 0.241 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.894 +- 0.241 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.05 all KL = 0.908 +- 0.241 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.05 all L1 = 0.928 +- 0.098 (in-sample avg dev_std = 0.193)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009405799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.766
SUFF_SIMPLE for r=0.1 class 0.0 = 0.962 +- 0.241 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.893 +- 0.241 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.1 all KL = 0.908 +- 0.241 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.1 all L1 = 0.927 +- 0.101 (in-sample avg dev_std = 0.195)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009508800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.768
SUFF_SIMPLE for r=0.2 class 0.0 = 0.961 +- 0.242 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.894 +- 0.242 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all KL = 0.908 +- 0.242 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.2 all L1 = 0.928 +- 0.100 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009540200000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.767
SUFF_SIMPLE for r=0.4 class 0.0 = 0.96 +- 0.246 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.894 +- 0.246 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all KL = 0.905 +- 0.246 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all L1 = 0.927 +- 0.101 (in-sample avg dev_std = 0.197)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009659799999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.767
SUFF_SIMPLE for r=0.8 class 0.0 = 0.962 +- 0.236 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.894 +- 0.236 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all KL = 0.914 +- 0.236 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all L1 = 0.928 +- 0.106 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249234
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.649
SUFF_SIMPLE for r=0.05 class 0.0 = 0.896 +- 0.253 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.845 +- 0.253 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.05 all KL = 0.872 +- 0.253 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.05 all L1 = 0.871 +- 0.221 (in-sample avg dev_std = 0.243)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03595399999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.648
SUFF_SIMPLE for r=0.1 class 0.0 = 0.897 +- 0.252 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.848 +- 0.252 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 all KL = 0.874 +- 0.252 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 all L1 = 0.873 +- 0.220 (in-sample avg dev_std = 0.240)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048873200000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.651
SUFF_SIMPLE for r=0.2 class 0.0 = 0.9 +- 0.249 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.85 +- 0.249 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all KL = 0.879 +- 0.249 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all L1 = 0.875 +- 0.220 (in-sample avg dev_std = 0.221)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06226460000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.655
SUFF_SIMPLE for r=0.4 class 0.0 = 0.901 +- 0.238 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.859 +- 0.238 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.4 all KL = 0.888 +- 0.238 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.4 all L1 = 0.881 +- 0.214 (in-sample avg dev_std = 0.204)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.68
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078543
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.664
SUFF_SIMPLE for r=0.8 class 0.0 = 0.936 +- 0.187 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.908 +- 0.187 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.8 all KL = 0.94 +- 0.187 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.8 all L1 = 0.922 +- 0.179 (in-sample avg dev_std = 0.101)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035300000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.97
NEC for r=0.05 class 0.0 = 0.047 +- 0.148 (in-sample avg dev_std = 0.142)
NEC for r=0.05 class 1.0 = 0.025 +- 0.148 (in-sample avg dev_std = 0.142)
NEC for r=0.05 all KL = 0.035 +- 0.148 (in-sample avg dev_std = 0.142)
NEC for r=0.05 all L1 = 0.035 +- 0.117 (in-sample avg dev_std = 0.142)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047757999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.971
NEC for r=0.1 class 0.0 = 0.046 +- 0.154 (in-sample avg dev_std = 0.174)
NEC for r=0.1 class 1.0 = 0.025 +- 0.154 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all KL = 0.04 +- 0.154 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all L1 = 0.034 +- 0.106 (in-sample avg dev_std = 0.174)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061932
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.971
NEC for r=0.2 class 0.0 = 0.05 +- 0.149 (in-sample avg dev_std = 0.190)
NEC for r=0.2 class 1.0 = 0.025 +- 0.149 (in-sample avg dev_std = 0.190)
NEC for r=0.2 all KL = 0.042 +- 0.149 (in-sample avg dev_std = 0.190)
NEC for r=0.2 all L1 = 0.036 +- 0.105 (in-sample avg dev_std = 0.190)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071274
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.975
NEC for r=0.4 class 0.0 = 0.046 +- 0.139 (in-sample avg dev_std = 0.183)
NEC for r=0.4 class 1.0 = 0.023 +- 0.139 (in-sample avg dev_std = 0.183)
NEC for r=0.4 all KL = 0.04 +- 0.139 (in-sample avg dev_std = 0.183)
NEC for r=0.4 all L1 = 0.033 +- 0.090 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078928
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.973
NEC for r=0.8 class 0.0 = 0.043 +- 0.133 (in-sample avg dev_std = 0.185)
NEC for r=0.8 class 1.0 = 0.028 +- 0.133 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all KL = 0.041 +- 0.133 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all L1 = 0.035 +- 0.088 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008754999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.784
NEC for r=0.05 class 0.0 = 0.011 +- 0.121 (in-sample avg dev_std = 0.102)
NEC for r=0.05 class 1.0 = 0.067 +- 0.121 (in-sample avg dev_std = 0.102)
NEC for r=0.05 all KL = 0.023 +- 0.121 (in-sample avg dev_std = 0.102)
NEC for r=0.05 all L1 = 0.039 +- 0.073 (in-sample avg dev_std = 0.102)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009405799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.783
NEC for r=0.1 class 0.0 = 0.011 +- 0.130 (in-sample avg dev_std = 0.108)
NEC for r=0.1 class 1.0 = 0.066 +- 0.130 (in-sample avg dev_std = 0.108)
NEC for r=0.1 all KL = 0.027 +- 0.130 (in-sample avg dev_std = 0.108)
NEC for r=0.1 all L1 = 0.039 +- 0.066 (in-sample avg dev_std = 0.108)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009508800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.784
NEC for r=0.2 class 0.0 = 0.011 +- 0.142 (in-sample avg dev_std = 0.111)
NEC for r=0.2 class 1.0 = 0.067 +- 0.142 (in-sample avg dev_std = 0.111)
NEC for r=0.2 all KL = 0.031 +- 0.142 (in-sample avg dev_std = 0.111)
NEC for r=0.2 all L1 = 0.039 +- 0.062 (in-sample avg dev_std = 0.111)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009540200000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.784
NEC for r=0.4 class 0.0 = 0.011 +- 0.136 (in-sample avg dev_std = 0.113)
NEC for r=0.4 class 1.0 = 0.068 +- 0.136 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all KL = 0.031 +- 0.136 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all L1 = 0.04 +- 0.063 (in-sample avg dev_std = 0.113)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009659799999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.785
NEC for r=0.8 class 0.0 = 0.011 +- 0.140 (in-sample avg dev_std = 0.111)
NEC for r=0.8 class 1.0 = 0.066 +- 0.140 (in-sample avg dev_std = 0.111)
NEC for r=0.8 all KL = 0.032 +- 0.140 (in-sample avg dev_std = 0.111)
NEC for r=0.8 all L1 = 0.039 +- 0.060 (in-sample avg dev_std = 0.111)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249234
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.675
NEC for r=0.05 class 0.0 = 0.036 +- 0.121 (in-sample avg dev_std = 0.030)
NEC for r=0.05 class 1.0 = 0.057 +- 0.121 (in-sample avg dev_std = 0.030)
NEC for r=0.05 all KL = 0.027 +- 0.121 (in-sample avg dev_std = 0.030)
NEC for r=0.05 all L1 = 0.046 +- 0.130 (in-sample avg dev_std = 0.030)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03595399999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.673
NEC for r=0.1 class 0.0 = 0.048 +- 0.147 (in-sample avg dev_std = 0.072)
NEC for r=0.1 class 1.0 = 0.067 +- 0.147 (in-sample avg dev_std = 0.072)
NEC for r=0.1 all KL = 0.038 +- 0.147 (in-sample avg dev_std = 0.072)
NEC for r=0.1 all L1 = 0.057 +- 0.149 (in-sample avg dev_std = 0.072)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048873200000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.669
NEC for r=0.2 class 0.0 = 0.064 +- 0.175 (in-sample avg dev_std = 0.138)
NEC for r=0.2 class 1.0 = 0.084 +- 0.175 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all KL = 0.057 +- 0.175 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all L1 = 0.074 +- 0.169 (in-sample avg dev_std = 0.138)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06226460000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.666
NEC for r=0.4 class 0.0 = 0.071 +- 0.190 (in-sample avg dev_std = 0.185)
NEC for r=0.4 class 1.0 = 0.099 +- 0.190 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all KL = 0.073 +- 0.190 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all L1 = 0.085 +- 0.176 (in-sample avg dev_std = 0.185)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.679
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078543
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.665
NEC for r=0.8 class 0.0 = 0.073 +- 0.192 (in-sample avg dev_std = 0.209)
NEC for r=0.8 class 1.0 = 0.104 +- 0.192 (in-sample avg dev_std = 0.209)
NEC for r=0.8 all KL = 0.079 +- 0.192 (in-sample avg dev_std = 0.209)
NEC for r=0.8 all L1 = 0.088 +- 0.175 (in-sample avg dev_std = 0.209)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 19:00:01 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 07:00:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.060
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.048
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031674
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.943
SUFF_SIMPLE for r=0.05 class 0.0 = 0.856 +- 0.253 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.955 +- 0.253 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all KL = 0.88 +- 0.253 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all L1 = 0.911 +- 0.165 (in-sample avg dev_std = 0.306)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047403999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.947
SUFF_SIMPLE for r=0.1 class 0.0 = 0.865 +- 0.240 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.957 +- 0.240 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.1 all KL = 0.889 +- 0.240 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.156 (in-sample avg dev_std = 0.291)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060094
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.939
SUFF_SIMPLE for r=0.2 class 0.0 = 0.862 +- 0.250 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.949 +- 0.250 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.2 all KL = 0.88 +- 0.250 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.163 (in-sample avg dev_std = 0.312)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073904
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.943
SUFF_SIMPLE for r=0.4 class 0.0 = 0.863 +- 0.245 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.951 +- 0.245 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.4 all KL = 0.885 +- 0.245 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.4 all L1 = 0.912 +- 0.162 (in-sample avg dev_std = 0.295)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08061800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.949
SUFF_SIMPLE for r=0.8 class 0.0 = 0.876 +- 0.234 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.962 +- 0.234 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 all KL = 0.908 +- 0.234 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 all L1 = 0.923 +- 0.164 (in-sample avg dev_std = 0.241)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086018
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.737
SUFF_SIMPLE for r=0.05 class 0.0 = 0.986 +- 0.177 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.818 +- 0.177 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.05 all KL = 0.916 +- 0.177 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.05 all L1 = 0.902 +- 0.142 (in-sample avg dev_std = 0.220)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0090214
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.736
SUFF_SIMPLE for r=0.1 class 0.0 = 0.986 +- 0.182 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.818 +- 0.182 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 all KL = 0.915 +- 0.182 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 all L1 = 0.901 +- 0.143 (in-sample avg dev_std = 0.219)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0093638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.737
SUFF_SIMPLE for r=0.2 class 0.0 = 0.985 +- 0.181 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.82 +- 0.181 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 all KL = 0.915 +- 0.181 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 all L1 = 0.902 +- 0.141 (in-sample avg dev_std = 0.217)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096116
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.736
SUFF_SIMPLE for r=0.4 class 0.0 = 0.987 +- 0.175 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.818 +- 0.175 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.4 all KL = 0.918 +- 0.175 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.4 all L1 = 0.902 +- 0.143 (in-sample avg dev_std = 0.217)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009753
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.736
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.175 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.822 +- 0.175 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.8 all KL = 0.923 +- 0.175 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.8 all L1 = 0.904 +- 0.147 (in-sample avg dev_std = 0.204)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024698599999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.593
SUFF_SIMPLE for r=0.05 class 0.0 = 0.911 +- 0.246 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.849 +- 0.246 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.246 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 all L1 = 0.88 +- 0.216 (in-sample avg dev_std = 0.224)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0358638
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.592
SUFF_SIMPLE for r=0.1 class 0.0 = 0.913 +- 0.247 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.847 +- 0.247 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 all KL = 0.881 +- 0.247 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 all L1 = 0.88 +- 0.216 (in-sample avg dev_std = 0.223)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047934199999999996
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.594
SUFF_SIMPLE for r=0.2 class 0.0 = 0.915 +- 0.244 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.849 +- 0.244 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all KL = 0.885 +- 0.244 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all L1 = 0.882 +- 0.216 (in-sample avg dev_std = 0.209)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06318860000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.594
SUFF_SIMPLE for r=0.4 class 0.0 = 0.916 +- 0.241 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.853 +- 0.241 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.4 all KL = 0.889 +- 0.241 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.4 all L1 = 0.885 +- 0.215 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.627
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079252
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.618
SUFF_SIMPLE for r=0.8 class 0.0 = 0.938 +- 0.187 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.896 +- 0.187 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 all KL = 0.936 +- 0.187 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.185 (in-sample avg dev_std = 0.103)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031674
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.968
NEC for r=0.05 class 0.0 = 0.039 +- 0.131 (in-sample avg dev_std = 0.128)
NEC for r=0.05 class 1.0 = 0.023 +- 0.131 (in-sample avg dev_std = 0.128)
NEC for r=0.05 all KL = 0.027 +- 0.131 (in-sample avg dev_std = 0.128)
NEC for r=0.05 all L1 = 0.03 +- 0.100 (in-sample avg dev_std = 0.128)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047403999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.97
NEC for r=0.1 class 0.0 = 0.053 +- 0.156 (in-sample avg dev_std = 0.178)
NEC for r=0.1 class 1.0 = 0.021 +- 0.156 (in-sample avg dev_std = 0.178)
NEC for r=0.1 all KL = 0.039 +- 0.156 (in-sample avg dev_std = 0.178)
NEC for r=0.1 all L1 = 0.035 +- 0.104 (in-sample avg dev_std = 0.178)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060094
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.97
NEC for r=0.2 class 0.0 = 0.05 +- 0.133 (in-sample avg dev_std = 0.161)
NEC for r=0.2 class 1.0 = 0.016 +- 0.133 (in-sample avg dev_std = 0.161)
NEC for r=0.2 all KL = 0.033 +- 0.133 (in-sample avg dev_std = 0.161)
NEC for r=0.2 all L1 = 0.031 +- 0.090 (in-sample avg dev_std = 0.161)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073904
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.968
NEC for r=0.4 class 0.0 = 0.05 +- 0.145 (in-sample avg dev_std = 0.190)
NEC for r=0.4 class 1.0 = 0.023 +- 0.145 (in-sample avg dev_std = 0.190)
NEC for r=0.4 all KL = 0.042 +- 0.145 (in-sample avg dev_std = 0.190)
NEC for r=0.4 all L1 = 0.035 +- 0.093 (in-sample avg dev_std = 0.190)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08061800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.972
NEC for r=0.8 class 0.0 = 0.048 +- 0.128 (in-sample avg dev_std = 0.172)
NEC for r=0.8 class 1.0 = 0.017 +- 0.128 (in-sample avg dev_std = 0.172)
NEC for r=0.8 all KL = 0.036 +- 0.128 (in-sample avg dev_std = 0.172)
NEC for r=0.8 all L1 = 0.03 +- 0.077 (in-sample avg dev_std = 0.172)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086018
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.739
NEC for r=0.05 class 0.0 = 0.005 +- 0.110 (in-sample avg dev_std = 0.139)
NEC for r=0.05 class 1.0 = 0.107 +- 0.110 (in-sample avg dev_std = 0.139)
NEC for r=0.05 all KL = 0.03 +- 0.110 (in-sample avg dev_std = 0.139)
NEC for r=0.05 all L1 = 0.056 +- 0.108 (in-sample avg dev_std = 0.139)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0090214
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.741
NEC for r=0.1 class 0.0 = 0.004 +- 0.111 (in-sample avg dev_std = 0.152)
NEC for r=0.1 class 1.0 = 0.11 +- 0.111 (in-sample avg dev_std = 0.152)
NEC for r=0.1 all KL = 0.033 +- 0.111 (in-sample avg dev_std = 0.152)
NEC for r=0.1 all L1 = 0.058 +- 0.103 (in-sample avg dev_std = 0.152)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0093638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.74
NEC for r=0.2 class 0.0 = 0.005 +- 0.114 (in-sample avg dev_std = 0.160)
NEC for r=0.2 class 1.0 = 0.111 +- 0.114 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all KL = 0.035 +- 0.114 (in-sample avg dev_std = 0.160)
NEC for r=0.2 all L1 = 0.058 +- 0.099 (in-sample avg dev_std = 0.160)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096116
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.741
NEC for r=0.4 class 0.0 = 0.004 +- 0.103 (in-sample avg dev_std = 0.161)
NEC for r=0.4 class 1.0 = 0.112 +- 0.103 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all KL = 0.035 +- 0.103 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all L1 = 0.058 +- 0.097 (in-sample avg dev_std = 0.161)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009753
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.74
NEC for r=0.8 class 0.0 = 0.004 +- 0.110 (in-sample avg dev_std = 0.170)
NEC for r=0.8 class 1.0 = 0.113 +- 0.110 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all KL = 0.038 +- 0.110 (in-sample avg dev_std = 0.170)
NEC for r=0.8 all L1 = 0.059 +- 0.096 (in-sample avg dev_std = 0.170)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024698599999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.621
NEC for r=0.05 class 0.0 = 0.033 +- 0.117 (in-sample avg dev_std = 0.024)
NEC for r=0.05 class 1.0 = 0.066 +- 0.117 (in-sample avg dev_std = 0.024)
NEC for r=0.05 all KL = 0.028 +- 0.117 (in-sample avg dev_std = 0.024)
NEC for r=0.05 all L1 = 0.049 +- 0.134 (in-sample avg dev_std = 0.024)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0358638
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.616
NEC for r=0.1 class 0.0 = 0.047 +- 0.148 (in-sample avg dev_std = 0.078)
NEC for r=0.1 class 1.0 = 0.077 +- 0.148 (in-sample avg dev_std = 0.078)
NEC for r=0.1 all KL = 0.041 +- 0.148 (in-sample avg dev_std = 0.078)
NEC for r=0.1 all L1 = 0.062 +- 0.155 (in-sample avg dev_std = 0.078)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047934199999999996
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.612
NEC for r=0.2 class 0.0 = 0.057 +- 0.165 (in-sample avg dev_std = 0.128)
NEC for r=0.2 class 1.0 = 0.092 +- 0.165 (in-sample avg dev_std = 0.128)
NEC for r=0.2 all KL = 0.055 +- 0.165 (in-sample avg dev_std = 0.128)
NEC for r=0.2 all L1 = 0.074 +- 0.166 (in-sample avg dev_std = 0.128)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06318860000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.607
NEC for r=0.4 class 0.0 = 0.063 +- 0.187 (in-sample avg dev_std = 0.167)
NEC for r=0.4 class 1.0 = 0.107 +- 0.187 (in-sample avg dev_std = 0.167)
NEC for r=0.4 all KL = 0.072 +- 0.187 (in-sample avg dev_std = 0.167)
NEC for r=0.4 all L1 = 0.085 +- 0.177 (in-sample avg dev_std = 0.167)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.626
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079252
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.606
NEC for r=0.8 class 0.0 = 0.066 +- 0.188 (in-sample avg dev_std = 0.194)
NEC for r=0.8 class 1.0 = 0.11 +- 0.188 (in-sample avg dev_std = 0.194)
NEC for r=0.8 all KL = 0.077 +- 0.188 (in-sample avg dev_std = 0.194)
NEC for r=0.8 all L1 = 0.088 +- 0.176 (in-sample avg dev_std = 0.194)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 19:15:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 07:15:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mChartInfo 0.9580 0.9580 0.9580 0.9580 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.045
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.069
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034804
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.936
SUFF_SIMPLE for r=0.05 class 0.0 = 0.875 +- 0.192 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.951 +- 0.192 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.05 all KL = 0.911 +- 0.192 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.05 all L1 = 0.917 +- 0.147 (in-sample avg dev_std = 0.273)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.044708
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.938
SUFF_SIMPLE for r=0.1 class 0.0 = 0.884 +- 0.186 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.949 +- 0.186 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 all KL = 0.914 +- 0.186 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 all L1 = 0.92 +- 0.141 (in-sample avg dev_std = 0.266)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056204000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.943
SUFF_SIMPLE for r=0.2 class 0.0 = 0.881 +- 0.188 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.949 +- 0.188 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all KL = 0.913 +- 0.188 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all L1 = 0.919 +- 0.143 (in-sample avg dev_std = 0.268)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06890600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.938
SUFF_SIMPLE for r=0.4 class 0.0 = 0.88 +- 0.191 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.945 +- 0.191 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all KL = 0.909 +- 0.191 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.4 all L1 = 0.916 +- 0.146 (in-sample avg dev_std = 0.278)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.929
SUFF_SIMPLE for r=0.8 class 0.0 = 0.883 +- 0.201 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.955 +- 0.201 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all KL = 0.923 +- 0.201 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all L1 = 0.923 +- 0.162 (in-sample avg dev_std = 0.229)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086272
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.772
SUFF_SIMPLE for r=0.05 class 0.0 = 0.993 +- 0.169 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.824 +- 0.169 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.05 all KL = 0.914 +- 0.169 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.05 all L1 = 0.908 +- 0.146 (in-sample avg dev_std = 0.250)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091434
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.772
SUFF_SIMPLE for r=0.1 class 0.0 = 0.992 +- 0.173 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.821 +- 0.173 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.1 all KL = 0.912 +- 0.173 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.1 all L1 = 0.906 +- 0.149 (in-sample avg dev_std = 0.255)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009401000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.773
SUFF_SIMPLE for r=0.2 class 0.0 = 0.993 +- 0.171 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.171 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.2 all KL = 0.914 +- 0.171 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.2 all L1 = 0.907 +- 0.149 (in-sample avg dev_std = 0.251)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009639199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.773
SUFF_SIMPLE for r=0.4 class 0.0 = 0.992 +- 0.174 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.821 +- 0.174 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.4 all KL = 0.912 +- 0.174 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.4 all L1 = 0.906 +- 0.151 (in-sample avg dev_std = 0.256)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009715999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.771
SUFF_SIMPLE for r=0.8 class 0.0 = 0.994 +- 0.177 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.177 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.8 all KL = 0.92 +- 0.177 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.8 all L1 = 0.908 +- 0.157 (in-sample avg dev_std = 0.244)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266938
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.624
SUFF_SIMPLE for r=0.05 class 0.0 = 0.895 +- 0.226 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.853 +- 0.226 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all KL = 0.89 +- 0.226 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all L1 = 0.874 +- 0.214 (in-sample avg dev_std = 0.214)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0373308
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.623
SUFF_SIMPLE for r=0.1 class 0.0 = 0.894 +- 0.228 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.852 +- 0.228 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.1 all KL = 0.889 +- 0.228 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.1 all L1 = 0.873 +- 0.215 (in-sample avg dev_std = 0.216)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500774
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.626
SUFF_SIMPLE for r=0.2 class 0.0 = 0.895 +- 0.227 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.853 +- 0.227 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all KL = 0.891 +- 0.227 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.2 all L1 = 0.874 +- 0.216 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064822
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.622
SUFF_SIMPLE for r=0.4 class 0.0 = 0.899 +- 0.223 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.854 +- 0.223 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.4 all KL = 0.896 +- 0.223 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.4 all L1 = 0.877 +- 0.216 (in-sample avg dev_std = 0.185)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.666
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0803778
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
SUFF_SIMPLE for r=0.8 class 0.0 = 0.923 +- 0.176 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.896 +- 0.176 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.8 all KL = 0.937 +- 0.176 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.184 (in-sample avg dev_std = 0.099)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034804
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.961
NEC for r=0.05 class 0.0 = 0.042 +- 0.093 (in-sample avg dev_std = 0.105)
NEC for r=0.05 class 1.0 = 0.013 +- 0.093 (in-sample avg dev_std = 0.105)
NEC for r=0.05 all KL = 0.017 +- 0.093 (in-sample avg dev_std = 0.105)
NEC for r=0.05 all L1 = 0.026 +- 0.081 (in-sample avg dev_std = 0.105)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.044708
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.958
NEC for r=0.1 class 0.0 = 0.053 +- 0.124 (in-sample avg dev_std = 0.168)
NEC for r=0.1 class 1.0 = 0.021 +- 0.124 (in-sample avg dev_std = 0.168)
NEC for r=0.1 all KL = 0.03 +- 0.124 (in-sample avg dev_std = 0.168)
NEC for r=0.1 all L1 = 0.035 +- 0.099 (in-sample avg dev_std = 0.168)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056204000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.956
NEC for r=0.2 class 0.0 = 0.058 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=0.2 class 1.0 = 0.016 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all KL = 0.027 +- 0.112 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all L1 = 0.035 +- 0.100 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06890600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.962
NEC for r=0.4 class 0.0 = 0.051 +- 0.093 (in-sample avg dev_std = 0.159)
NEC for r=0.4 class 1.0 = 0.017 +- 0.093 (in-sample avg dev_std = 0.159)
NEC for r=0.4 all KL = 0.025 +- 0.093 (in-sample avg dev_std = 0.159)
NEC for r=0.4 all L1 = 0.032 +- 0.084 (in-sample avg dev_std = 0.159)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.962
NEC for r=0.8 class 0.0 = 0.047 +- 0.085 (in-sample avg dev_std = 0.153)
NEC for r=0.8 class 1.0 = 0.022 +- 0.085 (in-sample avg dev_std = 0.153)
NEC for r=0.8 all KL = 0.025 +- 0.085 (in-sample avg dev_std = 0.153)
NEC for r=0.8 all L1 = 0.033 +- 0.084 (in-sample avg dev_std = 0.153)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086272
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.783
NEC for r=0.05 class 0.0 = 0.002 +- 0.123 (in-sample avg dev_std = 0.167)
NEC for r=0.05 class 1.0 = 0.107 +- 0.123 (in-sample avg dev_std = 0.167)
NEC for r=0.05 all KL = 0.036 +- 0.123 (in-sample avg dev_std = 0.167)
NEC for r=0.05 all L1 = 0.055 +- 0.118 (in-sample avg dev_std = 0.167)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091434
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.783
NEC for r=0.1 class 0.0 = 0.002 +- 0.113 (in-sample avg dev_std = 0.178)
NEC for r=0.1 class 1.0 = 0.108 +- 0.113 (in-sample avg dev_std = 0.178)
NEC for r=0.1 all KL = 0.038 +- 0.113 (in-sample avg dev_std = 0.178)
NEC for r=0.1 all L1 = 0.056 +- 0.109 (in-sample avg dev_std = 0.178)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009401000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.785
NEC for r=0.2 class 0.0 = 0.003 +- 0.114 (in-sample avg dev_std = 0.184)
NEC for r=0.2 class 1.0 = 0.107 +- 0.114 (in-sample avg dev_std = 0.184)
NEC for r=0.2 all KL = 0.04 +- 0.114 (in-sample avg dev_std = 0.184)
NEC for r=0.2 all L1 = 0.055 +- 0.103 (in-sample avg dev_std = 0.184)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009639199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.782
NEC for r=0.4 class 0.0 = 0.002 +- 0.115 (in-sample avg dev_std = 0.196)
NEC for r=0.4 class 1.0 = 0.113 +- 0.115 (in-sample avg dev_std = 0.196)
NEC for r=0.4 all KL = 0.043 +- 0.115 (in-sample avg dev_std = 0.196)
NEC for r=0.4 all L1 = 0.058 +- 0.105 (in-sample avg dev_std = 0.196)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009715999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.783
NEC for r=0.8 class 0.0 = 0.003 +- 0.110 (in-sample avg dev_std = 0.189)
NEC for r=0.8 class 1.0 = 0.109 +- 0.110 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all KL = 0.041 +- 0.110 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all L1 = 0.056 +- 0.101 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266938
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.656
NEC for r=0.05 class 0.0 = 0.04 +- 0.102 (in-sample avg dev_std = 0.038)
NEC for r=0.05 class 1.0 = 0.063 +- 0.102 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all KL = 0.024 +- 0.102 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all L1 = 0.051 +- 0.126 (in-sample avg dev_std = 0.038)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0373308
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.648
NEC for r=0.1 class 0.0 = 0.056 +- 0.132 (in-sample avg dev_std = 0.073)
NEC for r=0.1 class 1.0 = 0.076 +- 0.132 (in-sample avg dev_std = 0.073)
NEC for r=0.1 all KL = 0.037 +- 0.132 (in-sample avg dev_std = 0.073)
NEC for r=0.1 all L1 = 0.066 +- 0.149 (in-sample avg dev_std = 0.073)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500774
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.639
NEC for r=0.2 class 0.0 = 0.067 +- 0.151 (in-sample avg dev_std = 0.134)
NEC for r=0.2 class 1.0 = 0.092 +- 0.151 (in-sample avg dev_std = 0.134)
NEC for r=0.2 all KL = 0.053 +- 0.151 (in-sample avg dev_std = 0.134)
NEC for r=0.2 all L1 = 0.079 +- 0.163 (in-sample avg dev_std = 0.134)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064822
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.637
NEC for r=0.4 class 0.0 = 0.075 +- 0.165 (in-sample avg dev_std = 0.163)
NEC for r=0.4 class 1.0 = 0.102 +- 0.165 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all KL = 0.064 +- 0.165 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all L1 = 0.088 +- 0.173 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.666
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0803778
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.638
NEC for r=0.8 class 0.0 = 0.079 +- 0.166 (in-sample avg dev_std = 0.193)
NEC for r=0.8 class 1.0 = 0.107 +- 0.166 (in-sample avg dev_std = 0.193)
NEC for r=0.8 all KL = 0.07 +- 0.166 (in-sample avg dev_std = 0.193)
NEC for r=0.8 all L1 = 0.093 +- 0.173 (in-sample avg dev_std = 0.193)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 19:31:15 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 07:31:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.038
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.062
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.029
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.040
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037700000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.949
SUFF_SIMPLE for r=0.05 class 0.0 = 0.87 +- 0.236 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.974 +- 0.236 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 all KL = 0.894 +- 0.236 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 all L1 = 0.928 +- 0.150 (in-sample avg dev_std = 0.290)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.945
SUFF_SIMPLE for r=0.1 class 0.0 = 0.859 +- 0.253 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.972 +- 0.253 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all KL = 0.877 +- 0.253 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.1 all L1 = 0.922 +- 0.151 (in-sample avg dev_std = 0.315)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06214
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.942
SUFF_SIMPLE for r=0.2 class 0.0 = 0.864 +- 0.247 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.97 +- 0.247 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.2 all KL = 0.885 +- 0.247 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.2 all L1 = 0.922 +- 0.157 (in-sample avg dev_std = 0.299)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07128799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.942
SUFF_SIMPLE for r=0.4 class 0.0 = 0.863 +- 0.248 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.968 +- 0.248 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.4 all KL = 0.885 +- 0.248 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.4 all L1 = 0.921 +- 0.159 (in-sample avg dev_std = 0.303)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.945
SUFF_SIMPLE for r=0.8 class 0.0 = 0.883 +- 0.226 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.974 +- 0.226 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.8 all KL = 0.912 +- 0.226 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.8 all L1 = 0.933 +- 0.156 (in-sample avg dev_std = 0.236)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008740800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.879
SUFF_SIMPLE for r=0.05 class 0.0 = 0.82 +- 0.349 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.976 +- 0.349 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 all KL = 0.802 +- 0.349 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 all L1 = 0.899 +- 0.178 (in-sample avg dev_std = 0.335)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.878
SUFF_SIMPLE for r=0.1 class 0.0 = 0.819 +- 0.352 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.976 +- 0.352 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.1 all KL = 0.799 +- 0.352 (in-sample avg dev_std = 0.337)
SUFF_SIMPLE for r=0.1 all L1 = 0.898 +- 0.179 (in-sample avg dev_std = 0.337)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096732
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.878
SUFF_SIMPLE for r=0.2 class 0.0 = 0.819 +- 0.348 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.976 +- 0.348 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.2 all KL = 0.802 +- 0.348 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.2 all L1 = 0.898 +- 0.181 (in-sample avg dev_std = 0.333)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009841200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.879
SUFF_SIMPLE for r=0.4 class 0.0 = 0.819 +- 0.351 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.974 +- 0.351 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.4 all KL = 0.799 +- 0.351 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.4 all L1 = 0.897 +- 0.181 (in-sample avg dev_std = 0.335)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009777
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.882
SUFF_SIMPLE for r=0.8 class 0.0 = 0.831 +- 0.332 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.975 +- 0.332 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all KL = 0.825 +- 0.332 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all L1 = 0.904 +- 0.183 (in-sample avg dev_std = 0.312)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0287986
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.683
SUFF_SIMPLE for r=0.05 class 0.0 = 0.885 +- 0.240 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.86 +- 0.240 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.05 all KL = 0.88 +- 0.240 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.05 all L1 = 0.873 +- 0.207 (in-sample avg dev_std = 0.218)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.039788
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.683
SUFF_SIMPLE for r=0.1 class 0.0 = 0.885 +- 0.241 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.862 +- 0.241 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all KL = 0.881 +- 0.241 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.1 all L1 = 0.874 +- 0.207 (in-sample avg dev_std = 0.218)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050878400000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.684
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.241 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.861 +- 0.241 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all KL = 0.883 +- 0.241 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.2 all L1 = 0.874 +- 0.209 (in-sample avg dev_std = 0.205)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0654224
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.687
SUFF_SIMPLE for r=0.4 class 0.0 = 0.895 +- 0.226 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.876 +- 0.226 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 all KL = 0.897 +- 0.226 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.4 all L1 = 0.886 +- 0.196 (in-sample avg dev_std = 0.194)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.709
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0809076
len(reference) = 4981
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.695
SUFF_SIMPLE for r=0.8 class 0.0 = 0.926 +- 0.182 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.915 +- 0.182 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all KL = 0.943 +- 0.182 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all L1 = 0.92 +- 0.174 (in-sample avg dev_std = 0.093)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037700000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.97
NEC for r=0.05 class 0.0 = 0.046 +- 0.142 (in-sample avg dev_std = 0.129)
NEC for r=0.05 class 1.0 = 0.011 +- 0.142 (in-sample avg dev_std = 0.129)
NEC for r=0.05 all KL = 0.029 +- 0.142 (in-sample avg dev_std = 0.129)
NEC for r=0.05 all L1 = 0.027 +- 0.108 (in-sample avg dev_std = 0.129)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.975
NEC for r=0.1 class 0.0 = 0.045 +- 0.134 (in-sample avg dev_std = 0.168)
NEC for r=0.1 class 1.0 = 0.012 +- 0.134 (in-sample avg dev_std = 0.168)
NEC for r=0.1 all KL = 0.031 +- 0.134 (in-sample avg dev_std = 0.168)
NEC for r=0.1 all L1 = 0.027 +- 0.092 (in-sample avg dev_std = 0.168)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06214
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.977
NEC for r=0.2 class 0.0 = 0.043 +- 0.126 (in-sample avg dev_std = 0.159)
NEC for r=0.2 class 1.0 = 0.013 +- 0.126 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all KL = 0.031 +- 0.126 (in-sample avg dev_std = 0.159)
NEC for r=0.2 all L1 = 0.026 +- 0.086 (in-sample avg dev_std = 0.159)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07128799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.977
NEC for r=0.4 class 0.0 = 0.043 +- 0.133 (in-sample avg dev_std = 0.178)
NEC for r=0.4 class 1.0 = 0.013 +- 0.133 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all KL = 0.035 +- 0.133 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all L1 = 0.026 +- 0.080 (in-sample avg dev_std = 0.178)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.976
NEC for r=0.8 class 0.0 = 0.05 +- 0.143 (in-sample avg dev_std = 0.189)
NEC for r=0.8 class 1.0 = 0.013 +- 0.143 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all KL = 0.042 +- 0.143 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all L1 = 0.029 +- 0.080 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008740800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.885
NEC for r=0.05 class 0.0 = 0.072 +- 0.173 (in-sample avg dev_std = 0.159)
NEC for r=0.05 class 1.0 = 0.01 +- 0.173 (in-sample avg dev_std = 0.159)
NEC for r=0.05 all KL = 0.047 +- 0.173 (in-sample avg dev_std = 0.159)
NEC for r=0.05 all L1 = 0.041 +- 0.115 (in-sample avg dev_std = 0.159)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.886
NEC for r=0.1 class 0.0 = 0.077 +- 0.195 (in-sample avg dev_std = 0.179)
NEC for r=0.1 class 1.0 = 0.011 +- 0.195 (in-sample avg dev_std = 0.179)
NEC for r=0.1 all KL = 0.059 +- 0.195 (in-sample avg dev_std = 0.179)
NEC for r=0.1 all L1 = 0.044 +- 0.114 (in-sample avg dev_std = 0.179)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096732
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.885
NEC for r=0.2 class 0.0 = 0.078 +- 0.209 (in-sample avg dev_std = 0.188)
NEC for r=0.2 class 1.0 = 0.011 +- 0.209 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all KL = 0.066 +- 0.209 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all L1 = 0.044 +- 0.110 (in-sample avg dev_std = 0.188)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009841200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.886
NEC for r=0.4 class 0.0 = 0.078 +- 0.208 (in-sample avg dev_std = 0.187)
NEC for r=0.4 class 1.0 = 0.01 +- 0.208 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all KL = 0.067 +- 0.208 (in-sample avg dev_std = 0.187)
NEC for r=0.4 all L1 = 0.044 +- 0.108 (in-sample avg dev_std = 0.187)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009777
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.885
NEC for r=0.8 class 0.0 = 0.077 +- 0.206 (in-sample avg dev_std = 0.185)
NEC for r=0.8 class 1.0 = 0.011 +- 0.206 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all KL = 0.067 +- 0.206 (in-sample avg dev_std = 0.185)
NEC for r=0.8 all L1 = 0.044 +- 0.107 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0287986
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.702
NEC for r=0.05 class 0.0 = 0.037 +- 0.111 (in-sample avg dev_std = 0.038)
NEC for r=0.05 class 1.0 = 0.055 +- 0.111 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all KL = 0.024 +- 0.111 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all L1 = 0.046 +- 0.120 (in-sample avg dev_std = 0.038)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.039788
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.698
NEC for r=0.1 class 0.0 = 0.05 +- 0.140 (in-sample avg dev_std = 0.076)
NEC for r=0.1 class 1.0 = 0.063 +- 0.140 (in-sample avg dev_std = 0.076)
NEC for r=0.1 all KL = 0.035 +- 0.140 (in-sample avg dev_std = 0.076)
NEC for r=0.1 all L1 = 0.056 +- 0.140 (in-sample avg dev_std = 0.076)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050878400000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.695
NEC for r=0.2 class 0.0 = 0.062 +- 0.159 (in-sample avg dev_std = 0.129)
NEC for r=0.2 class 1.0 = 0.074 +- 0.159 (in-sample avg dev_std = 0.129)
NEC for r=0.2 all KL = 0.048 +- 0.159 (in-sample avg dev_std = 0.129)
NEC for r=0.2 all L1 = 0.067 +- 0.149 (in-sample avg dev_std = 0.129)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0654224
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.694
NEC for r=0.4 class 0.0 = 0.072 +- 0.172 (in-sample avg dev_std = 0.173)
NEC for r=0.4 class 1.0 = 0.086 +- 0.172 (in-sample avg dev_std = 0.173)
NEC for r=0.4 all KL = 0.063 +- 0.172 (in-sample avg dev_std = 0.173)
NEC for r=0.4 all L1 = 0.079 +- 0.156 (in-sample avg dev_std = 0.173)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.708
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0809076
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.696
NEC for r=0.8 class 0.0 = 0.077 +- 0.177 (in-sample avg dev_std = 0.193)
NEC for r=0.8 class 1.0 = 0.091 +- 0.177 (in-sample avg dev_std = 0.193)
NEC for r=0.8 all KL = 0.07 +- 0.177 (in-sample avg dev_std = 0.193)
NEC for r=0.8 all L1 = 0.084 +- 0.158 (in-sample avg dev_std = 0.193)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 19:47:16 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 07:47:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9880 0.9880[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.040
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.049
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.059
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.028
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.038
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04007000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.962
SUFF_SIMPLE for r=0.05 class 0.0 = 0.918 +- 0.164 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.962 +- 0.164 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.05 all KL = 0.933 +- 0.164 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.05 all L1 = 0.942 +- 0.119 (in-sample avg dev_std = 0.225)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048693999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.964
SUFF_SIMPLE for r=0.1 class 0.0 = 0.916 +- 0.172 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.961 +- 0.172 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.1 all KL = 0.933 +- 0.172 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.1 all L1 = 0.941 +- 0.123 (in-sample avg dev_std = 0.222)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059098
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.962
SUFF_SIMPLE for r=0.2 class 0.0 = 0.917 +- 0.174 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.959 +- 0.174 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all KL = 0.932 +- 0.174 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all L1 = 0.94 +- 0.128 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073508
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.968
SUFF_SIMPLE for r=0.4 class 0.0 = 0.923 +- 0.165 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.96 +- 0.165 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 all KL = 0.938 +- 0.165 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.4 all L1 = 0.943 +- 0.118 (in-sample avg dev_std = 0.219)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080304
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.969
SUFF_SIMPLE for r=0.8 class 0.0 = 0.924 +- 0.167 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.966 +- 0.167 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.167 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 all L1 = 0.947 +- 0.130 (in-sample avg dev_std = 0.179)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092758
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.91
SUFF_SIMPLE for r=0.05 class 0.0 = 0.931 +- 0.157 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.85 +- 0.157 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.05 all KL = 0.92 +- 0.157 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.05 all L1 = 0.89 +- 0.158 (in-sample avg dev_std = 0.204)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0095294
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.909
SUFF_SIMPLE for r=0.1 class 0.0 = 0.931 +- 0.161 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.847 +- 0.161 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all KL = 0.917 +- 0.161 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.1 all L1 = 0.889 +- 0.161 (in-sample avg dev_std = 0.209)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0097084
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.908
SUFF_SIMPLE for r=0.2 class 0.0 = 0.932 +- 0.160 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.847 +- 0.160 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all KL = 0.917 +- 0.160 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all L1 = 0.889 +- 0.159 (in-sample avg dev_std = 0.209)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0097986
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.911
SUFF_SIMPLE for r=0.4 class 0.0 = 0.933 +- 0.151 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.85 +- 0.151 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.4 all KL = 0.922 +- 0.151 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.4 all L1 = 0.891 +- 0.158 (in-sample avg dev_std = 0.199)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0098394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.912
SUFF_SIMPLE for r=0.8 class 0.0 = 0.932 +- 0.157 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.853 +- 0.157 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.8 all KL = 0.924 +- 0.157 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.8 all L1 = 0.892 +- 0.162 (in-sample avg dev_std = 0.192)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027963400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.622
SUFF_SIMPLE for r=0.05 class 0.0 = 0.905 +- 0.225 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.854 +- 0.225 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 all KL = 0.893 +- 0.225 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.05 all L1 = 0.88 +- 0.207 (in-sample avg dev_std = 0.205)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0377118
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.62
SUFF_SIMPLE for r=0.1 class 0.0 = 0.907 +- 0.225 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.854 +- 0.225 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 all KL = 0.894 +- 0.225 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 all L1 = 0.88 +- 0.206 (in-sample avg dev_std = 0.203)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0494224
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.621
SUFF_SIMPLE for r=0.2 class 0.0 = 0.907 +- 0.225 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.856 +- 0.225 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 all KL = 0.896 +- 0.225 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 all L1 = 0.882 +- 0.207 (in-sample avg dev_std = 0.193)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.063401
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.631
SUFF_SIMPLE for r=0.4 class 0.0 = 0.91 +- 0.215 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.864 +- 0.215 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all KL = 0.904 +- 0.215 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all L1 = 0.887 +- 0.200 (in-sample avg dev_std = 0.186)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079007
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.641
SUFF_SIMPLE for r=0.8 class 0.0 = 0.933 +- 0.172 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.904 +- 0.172 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.8 all KL = 0.944 +- 0.172 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.8 all L1 = 0.919 +- 0.176 (in-sample avg dev_std = 0.086)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04007000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.985
NEC for r=0.05 class 0.0 = 0.023 +- 0.080 (in-sample avg dev_std = 0.075)
NEC for r=0.05 class 1.0 = 0.016 +- 0.080 (in-sample avg dev_std = 0.075)
NEC for r=0.05 all KL = 0.013 +- 0.080 (in-sample avg dev_std = 0.075)
NEC for r=0.05 all L1 = 0.019 +- 0.070 (in-sample avg dev_std = 0.075)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048693999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.986
NEC for r=0.1 class 0.0 = 0.023 +- 0.072 (in-sample avg dev_std = 0.084)
NEC for r=0.1 class 1.0 = 0.015 +- 0.072 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all KL = 0.013 +- 0.072 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all L1 = 0.019 +- 0.063 (in-sample avg dev_std = 0.084)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059098
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.984
NEC for r=0.2 class 0.0 = 0.022 +- 0.079 (in-sample avg dev_std = 0.108)
NEC for r=0.2 class 1.0 = 0.02 +- 0.079 (in-sample avg dev_std = 0.108)
NEC for r=0.2 all KL = 0.017 +- 0.079 (in-sample avg dev_std = 0.108)
NEC for r=0.2 all L1 = 0.021 +- 0.064 (in-sample avg dev_std = 0.108)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073508
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.983
NEC for r=0.4 class 0.0 = 0.025 +- 0.077 (in-sample avg dev_std = 0.113)
NEC for r=0.4 class 1.0 = 0.019 +- 0.077 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all KL = 0.017 +- 0.077 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all L1 = 0.022 +- 0.067 (in-sample avg dev_std = 0.113)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080304
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.984
NEC for r=0.8 class 0.0 = 0.027 +- 0.063 (in-sample avg dev_std = 0.105)
NEC for r=0.8 class 1.0 = 0.016 +- 0.063 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all KL = 0.015 +- 0.063 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all L1 = 0.021 +- 0.064 (in-sample avg dev_std = 0.105)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092758
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.909
NEC for r=0.05 class 0.0 = 0.04 +- 0.087 (in-sample avg dev_std = 0.129)
NEC for r=0.05 class 1.0 = 0.096 +- 0.087 (in-sample avg dev_std = 0.129)
NEC for r=0.05 all KL = 0.031 +- 0.087 (in-sample avg dev_std = 0.129)
NEC for r=0.05 all L1 = 0.068 +- 0.117 (in-sample avg dev_std = 0.129)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0095294
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.907
NEC for r=0.1 class 0.0 = 0.04 +- 0.081 (in-sample avg dev_std = 0.141)
NEC for r=0.1 class 1.0 = 0.097 +- 0.081 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all KL = 0.032 +- 0.081 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all L1 = 0.069 +- 0.112 (in-sample avg dev_std = 0.141)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0097084
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.908
NEC for r=0.2 class 0.0 = 0.041 +- 0.078 (in-sample avg dev_std = 0.144)
NEC for r=0.2 class 1.0 = 0.096 +- 0.078 (in-sample avg dev_std = 0.144)
NEC for r=0.2 all KL = 0.032 +- 0.078 (in-sample avg dev_std = 0.144)
NEC for r=0.2 all L1 = 0.069 +- 0.108 (in-sample avg dev_std = 0.144)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0097986
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.907
NEC for r=0.4 class 0.0 = 0.041 +- 0.080 (in-sample avg dev_std = 0.155)
NEC for r=0.4 class 1.0 = 0.099 +- 0.080 (in-sample avg dev_std = 0.155)
NEC for r=0.4 all KL = 0.034 +- 0.080 (in-sample avg dev_std = 0.155)
NEC for r=0.4 all L1 = 0.07 +- 0.108 (in-sample avg dev_std = 0.155)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0098394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.907
NEC for r=0.8 class 0.0 = 0.041 +- 0.080 (in-sample avg dev_std = 0.157)
NEC for r=0.8 class 1.0 = 0.099 +- 0.080 (in-sample avg dev_std = 0.157)
NEC for r=0.8 all KL = 0.034 +- 0.080 (in-sample avg dev_std = 0.157)
NEC for r=0.8 all L1 = 0.07 +- 0.108 (in-sample avg dev_std = 0.157)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027963400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.65
NEC for r=0.05 class 0.0 = 0.036 +- 0.106 (in-sample avg dev_std = 0.027)
NEC for r=0.05 class 1.0 = 0.063 +- 0.106 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all KL = 0.025 +- 0.106 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all L1 = 0.049 +- 0.128 (in-sample avg dev_std = 0.027)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0377118
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.645
NEC for r=0.1 class 0.0 = 0.048 +- 0.135 (in-sample avg dev_std = 0.061)
NEC for r=0.1 class 1.0 = 0.073 +- 0.135 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all KL = 0.036 +- 0.135 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all L1 = 0.06 +- 0.148 (in-sample avg dev_std = 0.061)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0494224
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.642
NEC for r=0.2 class 0.0 = 0.059 +- 0.157 (in-sample avg dev_std = 0.117)
NEC for r=0.2 class 1.0 = 0.087 +- 0.157 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all KL = 0.049 +- 0.157 (in-sample avg dev_std = 0.117)
NEC for r=0.2 all L1 = 0.073 +- 0.160 (in-sample avg dev_std = 0.117)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.063401
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.639
NEC for r=0.4 class 0.0 = 0.064 +- 0.164 (in-sample avg dev_std = 0.163)
NEC for r=0.4 class 1.0 = 0.097 +- 0.164 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all KL = 0.061 +- 0.164 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all L1 = 0.08 +- 0.163 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079007
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.634
NEC for r=0.8 class 0.0 = 0.066 +- 0.166 (in-sample avg dev_std = 0.183)
NEC for r=0.8 class 1.0 = 0.099 +- 0.166 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all KL = 0.065 +- 0.166 (in-sample avg dev_std = 0.183)
NEC for r=0.8 all L1 = 0.083 +- 0.161 (in-sample avg dev_std = 0.183)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 20:03:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 08:03:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.034
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03444199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.942
SUFF_SIMPLE for r=0.05 class 0.0 = 0.864 +- 0.259 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.968 +- 0.259 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.05 all KL = 0.872 +- 0.259 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.05 all L1 = 0.922 +- 0.160 (in-sample avg dev_std = 0.307)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046655999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.946
SUFF_SIMPLE for r=0.1 class 0.0 = 0.88 +- 0.246 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.968 +- 0.246 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.1 all KL = 0.886 +- 0.246 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.1 all L1 = 0.929 +- 0.152 (in-sample avg dev_std = 0.284)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.947
SUFF_SIMPLE for r=0.2 class 0.0 = 0.876 +- 0.249 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.97 +- 0.249 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.2 all KL = 0.883 +- 0.249 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.2 all L1 = 0.928 +- 0.152 (in-sample avg dev_std = 0.291)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070048
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.945
SUFF_SIMPLE for r=0.4 class 0.0 = 0.875 +- 0.258 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.967 +- 0.258 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.4 all KL = 0.883 +- 0.258 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.4 all L1 = 0.926 +- 0.161 (in-sample avg dev_std = 0.292)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080336
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.942
SUFF_SIMPLE for r=0.8 class 0.0 = 0.883 +- 0.255 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.973 +- 0.255 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.8 all KL = 0.903 +- 0.255 (in-sample avg dev_std = 0.248)
SUFF_SIMPLE for r=0.8 all L1 = 0.933 +- 0.171 (in-sample avg dev_std = 0.248)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084298
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.946
SUFF_SIMPLE for r=0.05 class 0.0 = 0.95 +- 0.263 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.931 +- 0.263 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.05 all KL = 0.888 +- 0.263 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.05 all L1 = 0.94 +- 0.134 (in-sample avg dev_std = 0.241)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0089742
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.948
SUFF_SIMPLE for r=0.1 class 0.0 = 0.951 +- 0.261 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.931 +- 0.261 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.1 all KL = 0.889 +- 0.261 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.1 all L1 = 0.941 +- 0.132 (in-sample avg dev_std = 0.243)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009020199999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.946
SUFF_SIMPLE for r=0.2 class 0.0 = 0.948 +- 0.267 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.929 +- 0.267 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 all KL = 0.886 +- 0.267 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.138 (in-sample avg dev_std = 0.249)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009419400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.947
SUFF_SIMPLE for r=0.4 class 0.0 = 0.949 +- 0.266 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.93 +- 0.266 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 all KL = 0.886 +- 0.266 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 all L1 = 0.94 +- 0.135 (in-sample avg dev_std = 0.245)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658199999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.947
SUFF_SIMPLE for r=0.8 class 0.0 = 0.952 +- 0.252 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.933 +- 0.252 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.8 all KL = 0.899 +- 0.252 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.137 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0259716
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.642
SUFF_SIMPLE for r=0.05 class 0.0 = 0.887 +- 0.256 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.856 +- 0.256 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all KL = 0.867 +- 0.256 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.05 all L1 = 0.872 +- 0.221 (in-sample avg dev_std = 0.232)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368228
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.644
SUFF_SIMPLE for r=0.1 class 0.0 = 0.887 +- 0.258 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.853 +- 0.258 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 all KL = 0.864 +- 0.258 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 all L1 = 0.87 +- 0.222 (in-sample avg dev_std = 0.234)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500588
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.645
SUFF_SIMPLE for r=0.2 class 0.0 = 0.888 +- 0.258 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.856 +- 0.258 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.2 all KL = 0.868 +- 0.258 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.2 all L1 = 0.872 +- 0.222 (in-sample avg dev_std = 0.222)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0645058
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.644
SUFF_SIMPLE for r=0.4 class 0.0 = 0.901 +- 0.243 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.872 +- 0.243 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all KL = 0.885 +- 0.243 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all L1 = 0.887 +- 0.208 (in-sample avg dev_std = 0.211)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.661
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07993779999999999
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.651
SUFF_SIMPLE for r=0.8 class 0.0 = 0.937 +- 0.186 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.186 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.186 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.8 all L1 = 0.924 +- 0.180 (in-sample avg dev_std = 0.101)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03444199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.98
NEC for r=0.05 class 0.0 = 0.036 +- 0.115 (in-sample avg dev_std = 0.100)
NEC for r=0.05 class 1.0 = 0.008 +- 0.115 (in-sample avg dev_std = 0.100)
NEC for r=0.05 all KL = 0.024 +- 0.115 (in-sample avg dev_std = 0.100)
NEC for r=0.05 all L1 = 0.02 +- 0.083 (in-sample avg dev_std = 0.100)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046655999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.98
NEC for r=0.1 class 0.0 = 0.035 +- 0.113 (in-sample avg dev_std = 0.115)
NEC for r=0.1 class 1.0 = 0.009 +- 0.113 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all KL = 0.024 +- 0.113 (in-sample avg dev_std = 0.115)
NEC for r=0.1 all L1 = 0.02 +- 0.083 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.983
NEC for r=0.2 class 0.0 = 0.029 +- 0.106 (in-sample avg dev_std = 0.115)
NEC for r=0.2 class 1.0 = 0.009 +- 0.106 (in-sample avg dev_std = 0.115)
NEC for r=0.2 all KL = 0.023 +- 0.106 (in-sample avg dev_std = 0.115)
NEC for r=0.2 all L1 = 0.018 +- 0.068 (in-sample avg dev_std = 0.115)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070048
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.98
NEC for r=0.4 class 0.0 = 0.039 +- 0.127 (in-sample avg dev_std = 0.155)
NEC for r=0.4 class 1.0 = 0.012 +- 0.127 (in-sample avg dev_std = 0.155)
NEC for r=0.4 all KL = 0.034 +- 0.127 (in-sample avg dev_std = 0.155)
NEC for r=0.4 all L1 = 0.024 +- 0.076 (in-sample avg dev_std = 0.155)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080336
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.979
NEC for r=0.8 class 0.0 = 0.041 +- 0.125 (in-sample avg dev_std = 0.159)
NEC for r=0.8 class 1.0 = 0.011 +- 0.125 (in-sample avg dev_std = 0.159)
NEC for r=0.8 all KL = 0.032 +- 0.125 (in-sample avg dev_std = 0.159)
NEC for r=0.8 all L1 = 0.024 +- 0.078 (in-sample avg dev_std = 0.159)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084298
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.958
NEC for r=0.05 class 0.0 = 0.015 +- 0.125 (in-sample avg dev_std = 0.123)
NEC for r=0.05 class 1.0 = 0.043 +- 0.125 (in-sample avg dev_std = 0.123)
NEC for r=0.05 all KL = 0.029 +- 0.125 (in-sample avg dev_std = 0.123)
NEC for r=0.05 all L1 = 0.029 +- 0.096 (in-sample avg dev_std = 0.123)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0089742
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.958
NEC for r=0.1 class 0.0 = 0.014 +- 0.125 (in-sample avg dev_std = 0.129)
NEC for r=0.1 class 1.0 = 0.043 +- 0.125 (in-sample avg dev_std = 0.129)
NEC for r=0.1 all KL = 0.03 +- 0.125 (in-sample avg dev_std = 0.129)
NEC for r=0.1 all L1 = 0.029 +- 0.090 (in-sample avg dev_std = 0.129)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009020199999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.96
NEC for r=0.2 class 0.0 = 0.015 +- 0.128 (in-sample avg dev_std = 0.130)
NEC for r=0.2 class 1.0 = 0.041 +- 0.128 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all KL = 0.032 +- 0.128 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all L1 = 0.028 +- 0.085 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009419400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.959
NEC for r=0.4 class 0.0 = 0.014 +- 0.126 (in-sample avg dev_std = 0.128)
NEC for r=0.4 class 1.0 = 0.042 +- 0.126 (in-sample avg dev_std = 0.128)
NEC for r=0.4 all KL = 0.032 +- 0.126 (in-sample avg dev_std = 0.128)
NEC for r=0.4 all L1 = 0.028 +- 0.084 (in-sample avg dev_std = 0.128)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658199999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.959
NEC for r=0.8 class 0.0 = 0.016 +- 0.136 (in-sample avg dev_std = 0.138)
NEC for r=0.8 class 1.0 = 0.042 +- 0.136 (in-sample avg dev_std = 0.138)
NEC for r=0.8 all KL = 0.035 +- 0.136 (in-sample avg dev_std = 0.138)
NEC for r=0.8 all L1 = 0.029 +- 0.085 (in-sample avg dev_std = 0.138)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0259716
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.663
NEC for r=0.05 class 0.0 = 0.035 +- 0.118 (in-sample avg dev_std = 0.042)
NEC for r=0.05 class 1.0 = 0.057 +- 0.118 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all KL = 0.028 +- 0.118 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all L1 = 0.046 +- 0.130 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368228
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.655
NEC for r=0.1 class 0.0 = 0.047 +- 0.151 (in-sample avg dev_std = 0.091)
NEC for r=0.1 class 1.0 = 0.067 +- 0.151 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all KL = 0.041 +- 0.151 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all L1 = 0.057 +- 0.149 (in-sample avg dev_std = 0.091)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500588
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.65
NEC for r=0.2 class 0.0 = 0.06 +- 0.175 (in-sample avg dev_std = 0.139)
NEC for r=0.2 class 1.0 = 0.079 +- 0.175 (in-sample avg dev_std = 0.139)
NEC for r=0.2 all KL = 0.056 +- 0.175 (in-sample avg dev_std = 0.139)
NEC for r=0.2 all L1 = 0.069 +- 0.164 (in-sample avg dev_std = 0.139)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0645058
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.651
NEC for r=0.4 class 0.0 = 0.067 +- 0.185 (in-sample avg dev_std = 0.181)
NEC for r=0.4 class 1.0 = 0.091 +- 0.185 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all KL = 0.07 +- 0.185 (in-sample avg dev_std = 0.181)
NEC for r=0.4 all L1 = 0.079 +- 0.166 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07993779999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.652
NEC for r=0.8 class 0.0 = 0.072 +- 0.187 (in-sample avg dev_std = 0.199)
NEC for r=0.8 class 1.0 = 0.095 +- 0.187 (in-sample avg dev_std = 0.199)
NEC for r=0.8 all KL = 0.077 +- 0.187 (in-sample avg dev_std = 0.199)
NEC for r=0.8 all L1 = 0.083 +- 0.167 (in-sample avg dev_std = 0.199)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 20:18:59 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 08:18:59 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.060
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03541
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.928
SUFF_SIMPLE for r=0.05 class 0.0 = 0.839 +- 0.248 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.946 +- 0.248 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.05 all KL = 0.866 +- 0.248 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.05 all L1 = 0.898 +- 0.163 (in-sample avg dev_std = 0.329)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04666200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.932
SUFF_SIMPLE for r=0.1 class 0.0 = 0.841 +- 0.254 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.951 +- 0.254 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.1 all KL = 0.874 +- 0.254 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.1 all L1 = 0.902 +- 0.165 (in-sample avg dev_std = 0.317)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059781999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.933
SUFF_SIMPLE for r=0.2 class 0.0 = 0.835 +- 0.251 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.955 +- 0.251 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all KL = 0.876 +- 0.251 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all L1 = 0.901 +- 0.168 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070386
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.933
SUFF_SIMPLE for r=0.4 class 0.0 = 0.836 +- 0.254 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.952 +- 0.254 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.4 all KL = 0.874 +- 0.254 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.4 all L1 = 0.9 +- 0.169 (in-sample avg dev_std = 0.322)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07937000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.928
SUFF_SIMPLE for r=0.8 class 0.0 = 0.837 +- 0.256 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.962 +- 0.256 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.8 all KL = 0.887 +- 0.256 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.8 all L1 = 0.906 +- 0.181 (in-sample avg dev_std = 0.289)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090016
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.878
SUFF_SIMPLE for r=0.05 class 0.0 = 0.962 +- 0.205 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.893 +- 0.205 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.05 all KL = 0.923 +- 0.205 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.05 all L1 = 0.927 +- 0.104 (in-sample avg dev_std = 0.194)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094584
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.876
SUFF_SIMPLE for r=0.1 class 0.0 = 0.962 +- 0.204 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.891 +- 0.204 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all KL = 0.922 +- 0.204 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all L1 = 0.926 +- 0.105 (in-sample avg dev_std = 0.196)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095112
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.877
SUFF_SIMPLE for r=0.2 class 0.0 = 0.96 +- 0.209 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.894 +- 0.209 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all KL = 0.922 +- 0.209 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all L1 = 0.927 +- 0.104 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096676
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.879
SUFF_SIMPLE for r=0.4 class 0.0 = 0.962 +- 0.203 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.894 +- 0.203 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 all KL = 0.924 +- 0.203 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 all L1 = 0.928 +- 0.105 (in-sample avg dev_std = 0.193)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097348
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.876
SUFF_SIMPLE for r=0.8 class 0.0 = 0.961 +- 0.199 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.892 +- 0.199 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all KL = 0.929 +- 0.199 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all L1 = 0.926 +- 0.113 (in-sample avg dev_std = 0.190)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266952
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.645
SUFF_SIMPLE for r=0.05 class 0.0 = 0.901 +- 0.238 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.862 +- 0.238 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all KL = 0.889 +- 0.238 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.05 all L1 = 0.882 +- 0.206 (in-sample avg dev_std = 0.213)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368964
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.647
SUFF_SIMPLE for r=0.1 class 0.0 = 0.901 +- 0.237 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.863 +- 0.237 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all KL = 0.89 +- 0.237 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.1 all L1 = 0.882 +- 0.205 (in-sample avg dev_std = 0.208)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0488506
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.645
SUFF_SIMPLE for r=0.2 class 0.0 = 0.904 +- 0.235 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.862 +- 0.235 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 all KL = 0.893 +- 0.235 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 all L1 = 0.883 +- 0.208 (in-sample avg dev_std = 0.193)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0633258
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.648
SUFF_SIMPLE for r=0.4 class 0.0 = 0.907 +- 0.223 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.87 +- 0.223 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 all KL = 0.903 +- 0.223 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 all L1 = 0.889 +- 0.201 (in-sample avg dev_std = 0.175)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.686
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791104
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.672
SUFF_SIMPLE for r=0.8 class 0.0 = 0.932 +- 0.165 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.92 +- 0.165 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.165 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.8 all L1 = 0.926 +- 0.165 (in-sample avg dev_std = 0.090)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03541
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.955
NEC for r=0.05 class 0.0 = 0.081 +- 0.174 (in-sample avg dev_std = 0.181)
NEC for r=0.05 class 1.0 = 0.016 +- 0.174 (in-sample avg dev_std = 0.181)
NEC for r=0.05 all KL = 0.046 +- 0.174 (in-sample avg dev_std = 0.181)
NEC for r=0.05 all L1 = 0.045 +- 0.133 (in-sample avg dev_std = 0.181)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04666200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.967
NEC for r=0.1 class 0.0 = 0.07 +- 0.157 (in-sample avg dev_std = 0.188)
NEC for r=0.1 class 1.0 = 0.013 +- 0.157 (in-sample avg dev_std = 0.188)
NEC for r=0.1 all KL = 0.044 +- 0.157 (in-sample avg dev_std = 0.188)
NEC for r=0.1 all L1 = 0.039 +- 0.102 (in-sample avg dev_std = 0.188)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059781999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.964
NEC for r=0.2 class 0.0 = 0.067 +- 0.151 (in-sample avg dev_std = 0.207)
NEC for r=0.2 class 1.0 = 0.019 +- 0.151 (in-sample avg dev_std = 0.207)
NEC for r=0.2 all KL = 0.046 +- 0.151 (in-sample avg dev_std = 0.207)
NEC for r=0.2 all L1 = 0.04 +- 0.100 (in-sample avg dev_std = 0.207)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070386
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.966
NEC for r=0.4 class 0.0 = 0.065 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.4 class 1.0 = 0.018 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.4 all KL = 0.043 +- 0.141 (in-sample avg dev_std = 0.201)
NEC for r=0.4 all L1 = 0.039 +- 0.095 (in-sample avg dev_std = 0.201)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07937000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.964
NEC for r=0.8 class 0.0 = 0.07 +- 0.150 (in-sample avg dev_std = 0.205)
NEC for r=0.8 class 1.0 = 0.017 +- 0.150 (in-sample avg dev_std = 0.205)
NEC for r=0.8 all KL = 0.047 +- 0.150 (in-sample avg dev_std = 0.205)
NEC for r=0.8 all L1 = 0.041 +- 0.097 (in-sample avg dev_std = 0.205)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090016
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.889
NEC for r=0.05 class 0.0 = 0.014 +- 0.097 (in-sample avg dev_std = 0.103)
NEC for r=0.05 class 1.0 = 0.063 +- 0.097 (in-sample avg dev_std = 0.103)
NEC for r=0.05 all KL = 0.019 +- 0.097 (in-sample avg dev_std = 0.103)
NEC for r=0.05 all L1 = 0.039 +- 0.077 (in-sample avg dev_std = 0.103)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094584
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.889
NEC for r=0.1 class 0.0 = 0.013 +- 0.101 (in-sample avg dev_std = 0.109)
NEC for r=0.1 class 1.0 = 0.064 +- 0.101 (in-sample avg dev_std = 0.109)
NEC for r=0.1 all KL = 0.022 +- 0.101 (in-sample avg dev_std = 0.109)
NEC for r=0.1 all L1 = 0.039 +- 0.069 (in-sample avg dev_std = 0.109)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095112
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.889
NEC for r=0.2 class 0.0 = 0.015 +- 0.114 (in-sample avg dev_std = 0.120)
NEC for r=0.2 class 1.0 = 0.065 +- 0.114 (in-sample avg dev_std = 0.120)
NEC for r=0.2 all KL = 0.026 +- 0.114 (in-sample avg dev_std = 0.120)
NEC for r=0.2 all L1 = 0.04 +- 0.068 (in-sample avg dev_std = 0.120)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096676
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.892
NEC for r=0.4 class 0.0 = 0.015 +- 0.109 (in-sample avg dev_std = 0.117)
NEC for r=0.4 class 1.0 = 0.064 +- 0.109 (in-sample avg dev_std = 0.117)
NEC for r=0.4 all KL = 0.025 +- 0.109 (in-sample avg dev_std = 0.117)
NEC for r=0.4 all L1 = 0.04 +- 0.065 (in-sample avg dev_std = 0.117)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097348
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.89
NEC for r=0.8 class 0.0 = 0.015 +- 0.113 (in-sample avg dev_std = 0.121)
NEC for r=0.8 class 1.0 = 0.065 +- 0.113 (in-sample avg dev_std = 0.121)
NEC for r=0.8 all KL = 0.026 +- 0.113 (in-sample avg dev_std = 0.121)
NEC for r=0.8 all L1 = 0.04 +- 0.065 (in-sample avg dev_std = 0.121)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266952
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.679
NEC for r=0.05 class 0.0 = 0.039 +- 0.108 (in-sample avg dev_std = 0.030)
NEC for r=0.05 class 1.0 = 0.053 +- 0.108 (in-sample avg dev_std = 0.030)
NEC for r=0.05 all KL = 0.023 +- 0.108 (in-sample avg dev_std = 0.030)
NEC for r=0.05 all L1 = 0.046 +- 0.122 (in-sample avg dev_std = 0.030)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368964
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.675
NEC for r=0.1 class 0.0 = 0.052 +- 0.136 (in-sample avg dev_std = 0.071)
NEC for r=0.1 class 1.0 = 0.061 +- 0.136 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all KL = 0.034 +- 0.136 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all L1 = 0.056 +- 0.139 (in-sample avg dev_std = 0.071)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0488506
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.671
NEC for r=0.2 class 0.0 = 0.063 +- 0.152 (in-sample avg dev_std = 0.122)
NEC for r=0.2 class 1.0 = 0.076 +- 0.152 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all KL = 0.048 +- 0.152 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all L1 = 0.069 +- 0.154 (in-sample avg dev_std = 0.122)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0633258
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.666
NEC for r=0.4 class 0.0 = 0.07 +- 0.172 (in-sample avg dev_std = 0.161)
NEC for r=0.4 class 1.0 = 0.09 +- 0.172 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all KL = 0.063 +- 0.172 (in-sample avg dev_std = 0.161)
NEC for r=0.4 all L1 = 0.08 +- 0.163 (in-sample avg dev_std = 0.161)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.685
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791104
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 0.0 = 0.072 +- 0.175 (in-sample avg dev_std = 0.189)
NEC for r=0.8 class 1.0 = 0.096 +- 0.175 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all KL = 0.07 +- 0.175 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all L1 = 0.084 +- 0.163 (in-sample avg dev_std = 0.189)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 20:34:34 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 08:34:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mChartInfo 0.9780 0.9780 0.9780 0.9780 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.039
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.057
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.038
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03925800000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.945
SUFF_SIMPLE for r=0.05 class 0.0 = 0.893 +- 0.211 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.945 +- 0.211 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.05 all KL = 0.903 +- 0.211 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.05 all L1 = 0.922 +- 0.139 (in-sample avg dev_std = 0.282)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.049506
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.942
SUFF_SIMPLE for r=0.1 class 0.0 = 0.89 +- 0.214 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.949 +- 0.214 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.1 all KL = 0.905 +- 0.214 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.1 all L1 = 0.923 +- 0.141 (in-sample avg dev_std = 0.280)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.949
SUFF_SIMPLE for r=0.2 class 0.0 = 0.906 +- 0.200 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.944 +- 0.200 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.2 all KL = 0.917 +- 0.200 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.2 all L1 = 0.927 +- 0.139 (in-sample avg dev_std = 0.253)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.068316
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.945
SUFF_SIMPLE for r=0.4 class 0.0 = 0.882 +- 0.221 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.952 +- 0.221 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.4 all KL = 0.901 +- 0.221 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.4 all L1 = 0.92 +- 0.146 (in-sample avg dev_std = 0.284)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077988
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.949
SUFF_SIMPLE for r=0.8 class 0.0 = 0.911 +- 0.204 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.954 +- 0.204 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.8 all KL = 0.927 +- 0.204 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.8 all L1 = 0.935 +- 0.145 (in-sample avg dev_std = 0.224)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081226
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.631
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.100 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.881 +- 0.100 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.05 all KL = 0.966 +- 0.100 (in-sample avg dev_std = 0.116)
SUFF_SIMPLE for r=0.05 all L1 = 0.938 +- 0.109 (in-sample avg dev_std = 0.116)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0086932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.63
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.106 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.88 +- 0.106 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.106 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.1 all L1 = 0.938 +- 0.109 (in-sample avg dev_std = 0.120)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091848
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.631
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.102 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.881 +- 0.102 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.2 all KL = 0.966 +- 0.102 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.2 all L1 = 0.938 +- 0.108 (in-sample avg dev_std = 0.117)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.629
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.102 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.881 +- 0.102 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 all KL = 0.966 +- 0.102 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.4 all L1 = 0.938 +- 0.109 (in-sample avg dev_std = 0.117)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.63
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.101 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.884 +- 0.101 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.8 all KL = 0.968 +- 0.101 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.8 all L1 = 0.939 +- 0.109 (in-sample avg dev_std = 0.111)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027093799999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.627
SUFF_SIMPLE for r=0.05 class 0.0 = 0.905 +- 0.230 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.855 +- 0.230 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.05 all KL = 0.892 +- 0.230 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.05 all L1 = 0.88 +- 0.203 (in-sample avg dev_std = 0.215)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0379552
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.629
SUFF_SIMPLE for r=0.1 class 0.0 = 0.905 +- 0.228 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.856 +- 0.228 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 all KL = 0.893 +- 0.228 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 all L1 = 0.881 +- 0.202 (in-sample avg dev_std = 0.213)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500464
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.625
SUFF_SIMPLE for r=0.2 class 0.0 = 0.905 +- 0.232 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.856 +- 0.232 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all KL = 0.893 +- 0.232 (in-sample avg dev_std = 0.202)
SUFF_SIMPLE for r=0.2 all L1 = 0.881 +- 0.206 (in-sample avg dev_std = 0.202)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0653638
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.628
SUFF_SIMPLE for r=0.4 class 0.0 = 0.907 +- 0.225 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.862 +- 0.225 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all KL = 0.899 +- 0.225 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all L1 = 0.885 +- 0.202 (in-sample avg dev_std = 0.191)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07935
len(reference) = 4983
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.647
SUFF_SIMPLE for r=0.8 class 0.0 = 0.933 +- 0.170 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.908 +- 0.170 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.170 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all L1 = 0.921 +- 0.174 (in-sample avg dev_std = 0.093)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03925800000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.975
NEC for r=0.05 class 0.0 = 0.032 +- 0.134 (in-sample avg dev_std = 0.130)
NEC for r=0.05 class 1.0 = 0.026 +- 0.134 (in-sample avg dev_std = 0.130)
NEC for r=0.05 all KL = 0.027 +- 0.134 (in-sample avg dev_std = 0.130)
NEC for r=0.05 all L1 = 0.029 +- 0.099 (in-sample avg dev_std = 0.130)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.049506
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.974
NEC for r=0.1 class 0.0 = 0.03 +- 0.113 (in-sample avg dev_std = 0.136)
NEC for r=0.1 class 1.0 = 0.024 +- 0.113 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all KL = 0.025 +- 0.113 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all L1 = 0.027 +- 0.080 (in-sample avg dev_std = 0.136)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.972
NEC for r=0.2 class 0.0 = 0.033 +- 0.111 (in-sample avg dev_std = 0.147)
NEC for r=0.2 class 1.0 = 0.022 +- 0.111 (in-sample avg dev_std = 0.147)
NEC for r=0.2 all KL = 0.027 +- 0.111 (in-sample avg dev_std = 0.147)
NEC for r=0.2 all L1 = 0.027 +- 0.075 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.068316
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.974
NEC for r=0.4 class 0.0 = 0.036 +- 0.127 (in-sample avg dev_std = 0.165)
NEC for r=0.4 class 1.0 = 0.024 +- 0.127 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all KL = 0.032 +- 0.127 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all L1 = 0.029 +- 0.082 (in-sample avg dev_std = 0.165)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077988
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.971
NEC for r=0.8 class 0.0 = 0.039 +- 0.119 (in-sample avg dev_std = 0.166)
NEC for r=0.8 class 1.0 = 0.022 +- 0.119 (in-sample avg dev_std = 0.166)
NEC for r=0.8 all KL = 0.031 +- 0.119 (in-sample avg dev_std = 0.166)
NEC for r=0.8 all L1 = 0.029 +- 0.076 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081226
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.624
NEC for r=0.05 class 0.0 = 0.001 +- 0.054 (in-sample avg dev_std = 0.075)
NEC for r=0.05 class 1.0 = 0.071 +- 0.054 (in-sample avg dev_std = 0.075)
NEC for r=0.05 all KL = 0.012 +- 0.054 (in-sample avg dev_std = 0.075)
NEC for r=0.05 all L1 = 0.037 +- 0.076 (in-sample avg dev_std = 0.075)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0086932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.623
NEC for r=0.1 class 0.0 = 0.001 +- 0.058 (in-sample avg dev_std = 0.083)
NEC for r=0.1 class 1.0 = 0.072 +- 0.058 (in-sample avg dev_std = 0.083)
NEC for r=0.1 all KL = 0.013 +- 0.058 (in-sample avg dev_std = 0.083)
NEC for r=0.1 all L1 = 0.037 +- 0.074 (in-sample avg dev_std = 0.083)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091848
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.623
NEC for r=0.2 class 0.0 = 0.001 +- 0.053 (in-sample avg dev_std = 0.089)
NEC for r=0.2 class 1.0 = 0.073 +- 0.053 (in-sample avg dev_std = 0.089)
NEC for r=0.2 all KL = 0.013 +- 0.053 (in-sample avg dev_std = 0.089)
NEC for r=0.2 all L1 = 0.038 +- 0.072 (in-sample avg dev_std = 0.089)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.623
NEC for r=0.4 class 0.0 = 0.001 +- 0.046 (in-sample avg dev_std = 0.089)
NEC for r=0.4 class 1.0 = 0.074 +- 0.046 (in-sample avg dev_std = 0.089)
NEC for r=0.4 all KL = 0.013 +- 0.046 (in-sample avg dev_std = 0.089)
NEC for r=0.4 all L1 = 0.037 +- 0.071 (in-sample avg dev_std = 0.089)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.623
NEC for r=0.8 class 0.0 = 0.001 +- 0.055 (in-sample avg dev_std = 0.089)
NEC for r=0.8 class 1.0 = 0.072 +- 0.055 (in-sample avg dev_std = 0.089)
NEC for r=0.8 all KL = 0.013 +- 0.055 (in-sample avg dev_std = 0.089)
NEC for r=0.8 all L1 = 0.037 +- 0.069 (in-sample avg dev_std = 0.089)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027093799999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.656
NEC for r=0.05 class 0.0 = 0.036 +- 0.107 (in-sample avg dev_std = 0.029)
NEC for r=0.05 class 1.0 = 0.061 +- 0.107 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all KL = 0.024 +- 0.107 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all L1 = 0.048 +- 0.126 (in-sample avg dev_std = 0.029)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0379552
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.649
NEC for r=0.1 class 0.0 = 0.047 +- 0.131 (in-sample avg dev_std = 0.070)
NEC for r=0.1 class 1.0 = 0.069 +- 0.131 (in-sample avg dev_std = 0.070)
NEC for r=0.1 all KL = 0.034 +- 0.131 (in-sample avg dev_std = 0.070)
NEC for r=0.1 all L1 = 0.058 +- 0.141 (in-sample avg dev_std = 0.070)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500464
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.646
NEC for r=0.2 class 0.0 = 0.058 +- 0.153 (in-sample avg dev_std = 0.125)
NEC for r=0.2 class 1.0 = 0.084 +- 0.153 (in-sample avg dev_std = 0.125)
NEC for r=0.2 all KL = 0.048 +- 0.153 (in-sample avg dev_std = 0.125)
NEC for r=0.2 all L1 = 0.071 +- 0.155 (in-sample avg dev_std = 0.125)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0653638
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.641
NEC for r=0.4 class 0.0 = 0.066 +- 0.169 (in-sample avg dev_std = 0.163)
NEC for r=0.4 class 1.0 = 0.098 +- 0.169 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all KL = 0.062 +- 0.169 (in-sample avg dev_std = 0.163)
NEC for r=0.4 all L1 = 0.082 +- 0.164 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.659
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07935
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.64
NEC for r=0.8 class 0.0 = 0.069 +- 0.174 (in-sample avg dev_std = 0.191)
NEC for r=0.8 class 1.0 = 0.103 +- 0.174 (in-sample avg dev_std = 0.191)
NEC for r=0.8 all KL = 0.069 +- 0.174 (in-sample avg dev_std = 0.191)
NEC for r=0.8 all L1 = 0.086 +- 0.163 (in-sample avg dev_std = 0.191)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.906, 0.898, 0.899, 0.903, 0.93], 'all_L1': [0.929, 0.926, 0.925, 0.929, 0.945]}), defaultdict(<class 'list'>, {'all_KL': [0.919, 0.916, 0.93, 0.922, 0.944], 'all_L1': [0.941, 0.938, 0.948, 0.942, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.86, 0.863, 0.866, 0.861, 0.887], 'all_L1': [0.9, 0.902, 0.903, 0.899, 0.913]}), defaultdict(<class 'list'>, {'all_KL': [0.88, 0.889, 0.88, 0.885, 0.908], 'all_L1': [0.911, 0.916, 0.91, 0.912, 0.923]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.914, 0.913, 0.909, 0.923], 'all_L1': [0.917, 0.92, 0.919, 0.916, 0.923]}), defaultdict(<class 'list'>, {'all_KL': [0.894, 0.877, 0.885, 0.885, 0.912], 'all_L1': [0.928, 0.922, 0.922, 0.921, 0.933]}), defaultdict(<class 'list'>, {'all_KL': [0.933, 0.933, 0.932, 0.938, 0.947], 'all_L1': [0.942, 0.941, 0.94, 0.943, 0.947]}), defaultdict(<class 'list'>, {'all_KL': [0.872, 0.886, 0.883, 0.883, 0.903], 'all_L1': [0.922, 0.929, 0.928, 0.926, 0.933]}), defaultdict(<class 'list'>, {'all_KL': [0.866, 0.874, 0.876, 0.874, 0.887], 'all_L1': [0.898, 0.902, 0.901, 0.9, 0.906]}), defaultdict(<class 'list'>, {'all_KL': [0.903, 0.905, 0.917, 0.901, 0.927], 'all_L1': [0.922, 0.923, 0.927, 0.92, 0.935]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.021, 0.023, 0.023, 0.026, 0.023], 'all_L1': [0.023, 0.022, 0.024, 0.025, 0.024]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.016, 0.017, 0.019, 0.019], 'all_L1': [0.014, 0.018, 0.019, 0.019, 0.018]}), defaultdict(<class 'list'>, {'all_KL': [0.035, 0.04, 0.042, 0.04, 0.041], 'all_L1': [0.035, 0.034, 0.036, 0.033, 0.035]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.039, 0.033, 0.042, 0.036], 'all_L1': [0.03, 0.035, 0.031, 0.035, 0.03]}), defaultdict(<class 'list'>, {'all_KL': [0.017, 0.03, 0.027, 0.025, 0.025], 'all_L1': [0.026, 0.035, 0.035, 0.032, 0.033]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.031, 0.031, 0.035, 0.042], 'all_L1': [0.027, 0.027, 0.026, 0.026, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.013, 0.013, 0.017, 0.017, 0.015], 'all_L1': [0.019, 0.019, 0.021, 0.022, 0.021]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.024, 0.023, 0.034, 0.032], 'all_L1': [0.02, 0.02, 0.018, 0.024, 0.024]}), defaultdict(<class 'list'>, {'all_KL': [0.046, 0.044, 0.046, 0.043, 0.047], 'all_L1': [0.045, 0.039, 0.04, 0.039, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.025, 0.027, 0.032, 0.031], 'all_L1': [0.029, 0.027, 0.027, 0.029, 0.029]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.838, 0.836, 0.831, 0.83, 0.847], 'all_L1': [0.915, 0.914, 0.912, 0.911, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.933, 0.931, 0.933, 0.932, 0.94], 'all_L1': [0.927, 0.926, 0.927, 0.926, 0.928]}), defaultdict(<class 'list'>, {'all_KL': [0.908, 0.908, 0.908, 0.905, 0.914], 'all_L1': [0.928, 0.927, 0.928, 0.927, 0.928]}), defaultdict(<class 'list'>, {'all_KL': [0.916, 0.915, 0.915, 0.918, 0.923], 'all_L1': [0.902, 0.901, 0.902, 0.902, 0.904]}), defaultdict(<class 'list'>, {'all_KL': [0.914, 0.912, 0.914, 0.912, 0.92], 'all_L1': [0.908, 0.906, 0.907, 0.906, 0.908]}), defaultdict(<class 'list'>, {'all_KL': [0.802, 0.799, 0.802, 0.799, 0.825], 'all_L1': [0.899, 0.898, 0.898, 0.897, 0.904]}), defaultdict(<class 'list'>, {'all_KL': [0.92, 0.917, 0.917, 0.922, 0.924], 'all_L1': [0.89, 0.889, 0.889, 0.891, 0.892]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.889, 0.886, 0.886, 0.899], 'all_L1': [0.94, 0.941, 0.938, 0.94, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.923, 0.922, 0.922, 0.924, 0.929], 'all_L1': [0.927, 0.926, 0.927, 0.928, 0.926]}), defaultdict(<class 'list'>, {'all_KL': [0.966, 0.964, 0.966, 0.966, 0.968], 'all_L1': [0.938, 0.938, 0.938, 0.938, 0.939]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.038, 0.042, 0.043, 0.045, 0.046], 'all_L1': [0.035, 0.036, 0.036, 0.036, 0.036]}), defaultdict(<class 'list'>, {'all_KL': [0.02, 0.02, 0.023, 0.024, 0.024], 'all_L1': [0.044, 0.043, 0.044, 0.044, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.027, 0.031, 0.031, 0.032], 'all_L1': [0.039, 0.039, 0.039, 0.04, 0.039]}), defaultdict(<class 'list'>, {'all_KL': [0.03, 0.033, 0.035, 0.035, 0.038], 'all_L1': [0.056, 0.058, 0.058, 0.058, 0.059]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.038, 0.04, 0.043, 0.041], 'all_L1': [0.055, 0.056, 0.055, 0.058, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.047, 0.059, 0.066, 0.067, 0.067], 'all_L1': [0.041, 0.044, 0.044, 0.044, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.032, 0.032, 0.034, 0.034], 'all_L1': [0.068, 0.069, 0.069, 0.07, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.03, 0.032, 0.032, 0.035], 'all_L1': [0.029, 0.029, 0.028, 0.028, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.019, 0.022, 0.026, 0.025, 0.026], 'all_L1': [0.039, 0.039, 0.04, 0.04, 0.04]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.013, 0.013, 0.013, 0.013], 'all_L1': [0.037, 0.037, 0.038, 0.037, 0.037]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.88, 0.881, 0.881, 0.897, 0.945], 'all_L1': [0.871, 0.872, 0.871, 0.883, 0.922]}), defaultdict(<class 'list'>, {'all_KL': [0.884, 0.883, 0.884, 0.896, 0.944], 'all_L1': [0.879, 0.879, 0.879, 0.888, 0.924]}), defaultdict(<class 'list'>, {'all_KL': [0.872, 0.874, 0.879, 0.888, 0.94], 'all_L1': [0.871, 0.873, 0.875, 0.881, 0.922]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.881, 0.885, 0.889, 0.936], 'all_L1': [0.88, 0.88, 0.882, 0.885, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.89, 0.889, 0.891, 0.896, 0.937], 'all_L1': [0.874, 0.873, 0.874, 0.877, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.88, 0.881, 0.883, 0.897, 0.943], 'all_L1': [0.873, 0.874, 0.874, 0.886, 0.92]}), defaultdict(<class 'list'>, {'all_KL': [0.893, 0.894, 0.896, 0.904, 0.944], 'all_L1': [0.88, 0.88, 0.882, 0.887, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.867, 0.864, 0.868, 0.885, 0.939], 'all_L1': [0.872, 0.87, 0.872, 0.887, 0.924]}), defaultdict(<class 'list'>, {'all_KL': [0.889, 0.89, 0.893, 0.903, 0.95], 'all_L1': [0.882, 0.882, 0.883, 0.889, 0.926]}), defaultdict(<class 'list'>, {'all_KL': [0.892, 0.893, 0.893, 0.899, 0.945], 'all_L1': [0.88, 0.881, 0.881, 0.885, 0.921]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.025, 0.036, 0.05, 0.066, 0.073], 'all_L1': [0.047, 0.058, 0.072, 0.084, 0.088]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.037, 0.05, 0.062, 0.07], 'all_L1': [0.047, 0.056, 0.068, 0.075, 0.081]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.038, 0.057, 0.073, 0.079], 'all_L1': [0.046, 0.057, 0.074, 0.085, 0.088]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.041, 0.055, 0.072, 0.077], 'all_L1': [0.049, 0.062, 0.074, 0.085, 0.088]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.037, 0.053, 0.064, 0.07], 'all_L1': [0.051, 0.066, 0.079, 0.088, 0.093]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.035, 0.048, 0.063, 0.07], 'all_L1': [0.046, 0.056, 0.067, 0.079, 0.084]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.036, 0.049, 0.061, 0.065], 'all_L1': [0.049, 0.06, 0.073, 0.08, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.041, 0.056, 0.07, 0.077], 'all_L1': [0.046, 0.057, 0.069, 0.079, 0.083]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.034, 0.048, 0.063, 0.07], 'all_L1': [0.046, 0.056, 0.069, 0.08, 0.084]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.034, 0.048, 0.062, 0.069], 'all_L1': [0.048, 0.058, 0.071, 0.082, 0.086]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.921 +- 0.014, 0.922 +- 0.012, 0.922 +- 0.014, 0.921 +- 0.014, 0.931 +- 0.014
suff_simple class all_KL  =  0.894 +- 0.023, 0.895 +- 0.021, 0.898 +- 0.022, 0.896 +- 0.022, 0.917 +- 0.020
[[0.9537500143051147, 0.953000009059906, 0.9482499957084656, 0.9557499885559082, 0.9635000228881836], [0.9639999866485596, 0.9602500200271606, 0.9704999923706055, 0.9649999737739563, 0.9702500104904175], [0.9297500252723694, 0.934499979019165, 0.9380000233650208, 0.9287499785423279, 0.9367499947547913], [0.9430000185966492, 0.9465000033378601, 0.9390000104904175, 0.9427499771118164, 0.9487500190734863], [0.9357500076293945, 0.937749981880188, 0.9432500004768372, 0.9384999871253967, 0.9294999837875366], [0.9487500190734863, 0.9447500109672546, 0.9422500133514404, 0.9419999718666077, 0.9452499747276306], [0.9622499942779541, 0.9639999866485596, 0.9624999761581421, 0.9677500128746033, 0.968500018119812], [0.9422500133514404, 0.9457499980926514, 0.9474999904632568, 0.9445000290870667, 0.9419999718666077], [0.9277499914169312, 0.9322500228881836, 0.9330000281333923, 0.9332500100135803, 0.9275000095367432], [0.9447500109672546, 0.9424999952316284, 0.9490000009536743, 0.9447500109672546, 0.9487500190734863]]
[[0.906, 0.898, 0.899, 0.903, 0.93], [0.919, 0.916, 0.93, 0.922, 0.944], [0.86, 0.863, 0.866, 0.861, 0.887], [0.88, 0.889, 0.88, 0.885, 0.908], [0.911, 0.914, 0.913, 0.909, 0.923], [0.894, 0.877, 0.885, 0.885, 0.912], [0.933, 0.933, 0.932, 0.938, 0.947], [0.872, 0.886, 0.883, 0.883, 0.903], [0.866, 0.874, 0.876, 0.874, 0.887], [0.903, 0.905, 0.917, 0.901, 0.927]]
suff_simple_acc_int  =  0.945 +- 0.012, 0.946 +- 0.010, 0.947 +- 0.011, 0.946 +- 0.012, 0.948 +- 0.014
nec class all_L1  =  0.027 +- 0.008, 0.028 +- 0.007, 0.028 +- 0.007, 0.028 +- 0.006, 0.028 +- 0.007
nec class all_KL  =  0.025 +- 0.010, 0.029 +- 0.010, 0.029 +- 0.009, 0.031 +- 0.009, 0.031 +- 0.010
[[0.9852499961853027, 0.9869999885559082, 0.9860000014305115, 0.984250009059906, 0.9872499704360962], [0.9879999756813049, 0.9854999780654907, 0.9850000143051147, 0.9854999780654907, 0.987500011920929], [0.9702500104904175, 0.9707499742507935, 0.9714999794960022, 0.9752500057220459, 0.9727500081062317], [0.9682499766349792, 0.9697499871253967, 0.9704999923706055, 0.9677500128746033, 0.9722499847412109], [0.9612500071525574, 0.9577500224113464, 0.9564999938011169, 0.9624999761581421, 0.9624999761581421], [0.9695000052452087, 0.9754999876022339, 0.9767500162124634, 0.9767500162124634, 0.9764999747276306], [0.9850000143051147, 0.9857500195503235, 0.9837499856948853, 0.9825000166893005, 0.984499990940094], [0.9797499775886536, 0.9802500009536743, 0.9829999804496765, 0.9797499775886536, 0.9787499904632568], [0.9545000195503235, 0.9667500257492065, 0.9642500281333923, 0.9662500023841858, 0.9635000228881836], [0.9745000004768372, 0.9742500185966492, 0.971750020980835, 0.9735000133514404, 0.9714999794960022]]
[[0.021, 0.023, 0.023, 0.026, 0.023], [0.011, 0.016, 0.017, 0.019, 0.019], [0.035, 0.04, 0.042, 0.04, 0.041], [0.027, 0.039, 0.033, 0.042, 0.036], [0.017, 0.03, 0.027, 0.025, 0.025], [0.029, 0.031, 0.031, 0.035, 0.042], [0.013, 0.013, 0.017, 0.017, 0.015], [0.024, 0.024, 0.023, 0.034, 0.032], [0.046, 0.044, 0.046, 0.043, 0.047], [0.027, 0.025, 0.027, 0.032, 0.031]]
nec_acc_int  =  0.974 +- 0.010, 0.975 +- 0.009, 0.975 +- 0.009, 0.975 +- 0.008, 0.976 +- 0.008

Eval split val
suff_simple class all_L1  =  0.917 +- 0.016, 0.917 +- 0.017, 0.917 +- 0.016, 0.917 +- 0.017, 0.919 +- 0.016
suff_simple class all_KL  =  0.901 +- 0.045, 0.899 +- 0.045, 0.899 +- 0.046, 0.899 +- 0.047, 0.909 +- 0.041
[[0.8751999735832214, 0.87357497215271, 0.8736500144004822, 0.8742499947547913, 0.8732249736785889], [0.926925003528595, 0.9256500005722046, 0.9263499975204468, 0.9254000186920166, 0.927299976348877], [0.7684000134468079, 0.7663499712944031, 0.7675750255584717, 0.7667250037193298, 0.7672500014305115], [0.7369250059127808, 0.7358750104904175, 0.7371749877929688, 0.7361249923706055, 0.7356749773025513], [0.7718999981880188, 0.772225022315979, 0.772599995136261, 0.7726500034332275, 0.7710000276565552], [0.8787000179290771, 0.8777750134468079, 0.8778749704360962, 0.8788250088691711, 0.882099986076355], [0.9096249938011169, 0.909375011920929, 0.9084749817848206, 0.911050021648407, 0.911549985408783], [0.9464250206947327, 0.9483000040054321, 0.9462500214576721, 0.9466000199317932, 0.9469249844551086], [0.878125011920929, 0.8763999938964844, 0.8767250180244446, 0.8786500096321106, 0.8762500286102295], [0.6305750012397766, 0.6302250027656555, 0.6306999921798706, 0.6286749839782715, 0.6302250027656555]]
[[0.838, 0.836, 0.831, 0.83, 0.847], [0.933, 0.931, 0.933, 0.932, 0.94], [0.908, 0.908, 0.908, 0.905, 0.914], [0.916, 0.915, 0.915, 0.918, 0.923], [0.914, 0.912, 0.914, 0.912, 0.92], [0.802, 0.799, 0.802, 0.799, 0.825], [0.92, 0.917, 0.917, 0.922, 0.924], [0.888, 0.889, 0.886, 0.886, 0.899], [0.923, 0.922, 0.922, 0.924, 0.929], [0.966, 0.964, 0.966, 0.966, 0.968]]
suff_simple_acc_int  =  0.832 +- 0.096, 0.832 +- 0.096, 0.832 +- 0.095, 0.832 +- 0.096, 0.832 +- 0.096
nec class all_L1  =  0.044 +- 0.011, 0.045 +- 0.012, 0.045 +- 0.012, 0.045 +- 0.012, 0.045 +- 0.012
nec class all_KL  =  0.029 +- 0.010, 0.032 +- 0.012, 0.034 +- 0.013, 0.035 +- 0.014, 0.036 +- 0.014
[[0.864674985408783, 0.8653500080108643, 0.8660249710083008, 0.8650749921798706, 0.8658000230789185], [0.9262750148773193, 0.9280250072479248, 0.9271249771118164, 0.9267249703407288, 0.9272249937057495], [0.7837499976158142, 0.7832750082015991, 0.7844750285148621, 0.784250020980835, 0.7846249938011169], [0.7393249869346619, 0.7406250238418579, 0.7403500080108643, 0.7413250207901001, 0.7400749921798706], [0.7829750180244446, 0.7827749848365784, 0.7846249938011169, 0.7817749977111816, 0.7832000255584717], [0.8852999806404114, 0.8861500024795532, 0.8854749798774719, 0.8855249881744385, 0.8852750062942505], [0.9086250066757202, 0.9074749946594238, 0.9083250164985657, 0.9068999886512756, 0.9067999720573425], [0.958424985408783, 0.9583250284194946, 0.9595999717712402, 0.9593250155448914, 0.958774983882904], [0.8892750144004822, 0.888824999332428, 0.889074981212616, 0.8915749788284302, 0.8904749751091003], [0.6238499879837036, 0.6230499744415283, 0.623199999332428, 0.6228749752044678, 0.6225249767303467]]
[[0.038, 0.042, 0.043, 0.045, 0.046], [0.02, 0.02, 0.023, 0.024, 0.024], [0.023, 0.027, 0.031, 0.031, 0.032], [0.03, 0.033, 0.035, 0.035, 0.038], [0.036, 0.038, 0.04, 0.043, 0.041], [0.047, 0.059, 0.066, 0.067, 0.067], [0.031, 0.032, 0.032, 0.034, 0.034], [0.029, 0.03, 0.032, 0.032, 0.035], [0.019, 0.022, 0.026, 0.025, 0.026], [0.012, 0.013, 0.013, 0.013, 0.013]]
nec_acc_int  =  0.836 +- 0.097, 0.836 +- 0.097, 0.837 +- 0.097, 0.837 +- 0.097, 0.836 +- 0.097

Eval split test
suff_simple class all_L1  =  0.876 +- 0.004, 0.876 +- 0.004, 0.877 +- 0.004, 0.885 +- 0.003, 0.920 +- 0.004
suff_simple class all_KL  =  0.883 +- 0.008, 0.883 +- 0.009, 0.885 +- 0.008, 0.895 +- 0.006, 0.942 +- 0.004
[[0.6202221512794495, 0.6189213395118713, 0.6196967959403992, 0.6273514032363892, 0.6386632323265076], [0.6601961255073547, 0.6580948829650879, 0.658194899559021, 0.6659995913505554, 0.6791273355484009], [0.6491394639015198, 0.6483640074729919, 0.650815486907959, 0.6550430059432983, 0.6643931865692139], [0.5933810472488403, 0.5916799902915955, 0.5944817066192627, 0.5942815542221069, 0.6178550124168396], [0.6235491037368774, 0.623399019241333, 0.6257254481315613, 0.6222233176231384, 0.6423270106315613], [0.683059811592102, 0.68333500623703, 0.6840854287147522, 0.6873874068260193, 0.694664716720581], [0.6217230558395386, 0.6204723119735718, 0.6206974387168884, 0.6305533051490784, 0.6413490176200867], [0.642485499382019, 0.6441615223884583, 0.6450369954109192, 0.644086480140686, 0.6509925723075867], [0.6451621055603027, 0.6466129422187805, 0.6446617841720581, 0.6477636694908142, 0.6717652678489685], [0.6271762847900391, 0.6289023160934448, 0.6245497465133667, 0.6283270120620728, 0.6472757458686829]]
[[0.88, 0.881, 0.881, 0.897, 0.945], [0.884, 0.883, 0.884, 0.896, 0.944], [0.872, 0.874, 0.879, 0.888, 0.94], [0.881, 0.881, 0.885, 0.889, 0.936], [0.89, 0.889, 0.891, 0.896, 0.937], [0.88, 0.881, 0.883, 0.897, 0.943], [0.893, 0.894, 0.896, 0.904, 0.944], [0.867, 0.864, 0.868, 0.885, 0.939], [0.889, 0.89, 0.893, 0.903, 0.95], [0.892, 0.893, 0.893, 0.899, 0.945]]
suff_simple_acc_int  =  0.637 +- 0.024, 0.636 +- 0.024, 0.637 +- 0.024, 0.640 +- 0.025, 0.655 +- 0.021
nec class all_L1  =  0.047 +- 0.002, 0.059 +- 0.003, 0.072 +- 0.003, 0.082 +- 0.004, 0.086 +- 0.003
nec class all_KL  =  0.026 +- 0.002, 0.037 +- 0.002, 0.051 +- 0.003, 0.066 +- 0.004, 0.072 +- 0.004
[[0.6507154107093811, 0.6429858207702637, 0.6419851779937744, 0.6386581659317017, 0.6375074982643127], [0.6876876354217529, 0.6837602853775024, 0.6766059398651123, 0.6752051115036011, 0.6739043593406677], [0.6751300692558289, 0.6726285815238953, 0.6687262654304504, 0.6657494306564331, 0.6646237969398499], [0.6210976839065552, 0.6163448095321655, 0.6116669774055481, 0.6073393821716309, 0.6061636805534363], [0.6557684540748596, 0.6481888890266418, 0.6386581659317017, 0.6371322870254517, 0.637582540512085], [0.7022963762283325, 0.6984691023826599, 0.6950920820236206, 0.6935161352157593, 0.695917546749115], [0.6504902839660645, 0.6447118520736694, 0.6415849328041077, 0.6388083100318909, 0.6343055963516235], [0.6628727316856384, 0.655068039894104, 0.6496147513389587, 0.651090681552887, 0.6518160700798035], [0.6788322925567627, 0.6749799847602844, 0.6713528037071228, 0.6661496758460999, 0.6630478501319885], [0.6558685302734375, 0.6488893628120422, 0.6463878154754639, 0.6410346031188965, 0.6401090621948242]]
[[0.025, 0.036, 0.05, 0.066, 0.073], [0.027, 0.037, 0.05, 0.062, 0.07], [0.027, 0.038, 0.057, 0.073, 0.079], [0.028, 0.041, 0.055, 0.072, 0.077], [0.024, 0.037, 0.053, 0.064, 0.07], [0.024, 0.035, 0.048, 0.063, 0.07], [0.025, 0.036, 0.049, 0.061, 0.065], [0.028, 0.041, 0.056, 0.07, 0.077], [0.023, 0.034, 0.048, 0.063, 0.07], [0.024, 0.034, 0.048, 0.062, 0.069]]
nec_acc_int  =  0.664 +- 0.022, 0.659 +- 0.023, 0.654 +- 0.023, 0.651 +- 0.023, 0.650 +- 0.024


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.474 +- 0.004, 0.475 +- 0.003, 0.475 +- 0.004, 0.475 +- 0.005, 0.480 +- 0.004
Faith. Armon (L1)= 		  =  0.052 +- 0.016, 0.053 +- 0.014, 0.054 +- 0.013, 0.055 +- 0.011, 0.055 +- 0.012
Faith. GMean (L1)= 	  =  0.155 +- 0.023, 0.158 +- 0.020, 0.158 +- 0.020, 0.161 +- 0.016, 0.161 +- 0.018
Faith. Aritm (KL)= 		  =  0.460 +- 0.008, 0.462 +- 0.007, 0.463 +- 0.008, 0.464 +- 0.007, 0.474 +- 0.006
Faith. Armon (KL)= 		  =  0.048 +- 0.019, 0.055 +- 0.018, 0.055 +- 0.017, 0.060 +- 0.016, 0.060 +- 0.019
Faith. GMean (KL)= 	  =  0.146 +- 0.028, 0.157 +- 0.027, 0.158 +- 0.024, 0.165 +- 0.023, 0.166 +- 0.026

Eval split val
Faith. Aritm (L1)= 		  =  0.481 +- 0.005, 0.481 +- 0.005, 0.481 +- 0.005, 0.481 +- 0.005, 0.482 +- 0.004
Faith. Armon (L1)= 		  =  0.084 +- 0.020, 0.086 +- 0.021, 0.086 +- 0.021, 0.086 +- 0.022, 0.086 +- 0.021
Faith. GMean (L1)= 	  =  0.200 +- 0.023, 0.201 +- 0.024, 0.202 +- 0.024, 0.202 +- 0.025, 0.202 +- 0.024
Faith. Aritm (KL)= 		  =  0.465 +- 0.019, 0.465 +- 0.017, 0.467 +- 0.017, 0.467 +- 0.018, 0.472 +- 0.014
Faith. Armon (KL)= 		  =  0.055 +- 0.018, 0.061 +- 0.022, 0.065 +- 0.024, 0.067 +- 0.025, 0.068 +- 0.025
Faith. GMean (KL)= 	  =  0.157 +- 0.025, 0.165 +- 0.028, 0.171 +- 0.029, 0.173 +- 0.030, 0.176 +- 0.031

Eval split test
Faith. Aritm (L1)= 		  =  0.462 +- 0.002, 0.468 +- 0.003, 0.474 +- 0.003, 0.483 +- 0.001, 0.503 +- 0.001
Faith. Armon (L1)= 		  =  0.090 +- 0.003, 0.110 +- 0.005, 0.132 +- 0.006, 0.150 +- 0.006, 0.157 +- 0.006
Faith. GMean (L1)= 	  =  0.204 +- 0.004, 0.227 +- 0.006, 0.251 +- 0.006, 0.269 +- 0.006, 0.281 +- 0.005
Faith. Aritm (KL)= 		  =  0.454 +- 0.004, 0.460 +- 0.004, 0.468 +- 0.003, 0.481 +- 0.002, 0.507 +- 0.002
Faith. Armon (KL)= 		  =  0.050 +- 0.003, 0.071 +- 0.004, 0.097 +- 0.006, 0.122 +- 0.007, 0.134 +- 0.007
Faith. GMean (KL)= 	  =  0.150 +- 0.005, 0.180 +- 0.005, 0.213 +- 0.006, 0.242 +- 0.007, 0.260 +- 0.007
Computed for split load_split = id



Completed in  2:36:45.375148  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 20:50:11 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 08:50:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.048
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.082
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.035
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.048
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03597
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.991
SUFF_SIMPLE for r=0.05 class 0.0 = 0.971 +- 0.131 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.991 +- 0.131 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.05 all KL = 0.967 +- 0.131 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.05 all L1 = 0.982 +- 0.070 (in-sample avg dev_std = 0.132)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047726
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.99
SUFF_SIMPLE for r=0.1 class 0.0 = 0.973 +- 0.123 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.123 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.123 (in-sample avg dev_std = 0.137)
SUFF_SIMPLE for r=0.1 all L1 = 0.982 +- 0.073 (in-sample avg dev_std = 0.137)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061348
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.988
SUFF_SIMPLE for r=0.2 class 0.0 = 0.963 +- 0.141 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.991 +- 0.141 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 all KL = 0.964 +- 0.141 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 all L1 = 0.979 +- 0.088 (in-sample avg dev_std = 0.143)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07434
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.991
SUFF_SIMPLE for r=0.4 class 0.0 = 0.971 +- 0.127 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.991 +- 0.127 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.4 all KL = 0.969 +- 0.127 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.4 all L1 = 0.982 +- 0.077 (in-sample avg dev_std = 0.129)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.994
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.085 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.996 +- 0.085 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.8 all KL = 0.986 +- 0.085 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.8 all L1 = 0.989 +- 0.063 (in-sample avg dev_std = 0.066)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080328
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.838
SUFF_SIMPLE for r=0.05 class 0.0 = 0.977 +- 0.113 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.967 +- 0.113 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.05 all KL = 0.971 +- 0.113 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.05 all L1 = 0.972 +- 0.075 (in-sample avg dev_std = 0.120)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0085574
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.837
SUFF_SIMPLE for r=0.1 class 0.0 = 0.976 +- 0.119 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.967 +- 0.119 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all KL = 0.969 +- 0.119 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.1 all L1 = 0.971 +- 0.076 (in-sample avg dev_std = 0.129)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091202
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.837
SUFF_SIMPLE for r=0.2 class 0.0 = 0.976 +- 0.117 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.967 +- 0.117 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 all KL = 0.969 +- 0.117 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 all L1 = 0.971 +- 0.076 (in-sample avg dev_std = 0.126)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094654
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.837
SUFF_SIMPLE for r=0.4 class 0.0 = 0.977 +- 0.117 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.967 +- 0.117 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all KL = 0.97 +- 0.117 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all L1 = 0.972 +- 0.075 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096952
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.839
SUFF_SIMPLE for r=0.8 class 0.0 = 0.978 +- 0.110 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.968 +- 0.110 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all KL = 0.972 +- 0.110 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all L1 = 0.973 +- 0.073 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0258052
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.796
SUFF_SIMPLE for r=0.05 class 0.0 = 0.925 +- 0.260 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.260 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.05 all KL = 0.875 +- 0.260 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.05 all L1 = 0.878 +- 0.213 (in-sample avg dev_std = 0.244)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0353
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.797
SUFF_SIMPLE for r=0.1 class 0.0 = 0.924 +- 0.258 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.834 +- 0.258 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 all KL = 0.879 +- 0.258 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 all L1 = 0.88 +- 0.213 (in-sample avg dev_std = 0.235)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0475984
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.798
SUFF_SIMPLE for r=0.2 class 0.0 = 0.925 +- 0.251 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.837 +- 0.251 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.251 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 all L1 = 0.882 +- 0.213 (in-sample avg dev_std = 0.210)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.061493200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.811
SUFF_SIMPLE for r=0.4 class 0.0 = 0.931 +- 0.223 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.861 +- 0.223 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all KL = 0.902 +- 0.223 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all L1 = 0.897 +- 0.190 (in-sample avg dev_std = 0.206)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.832
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07859880000000001
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.821
SUFF_SIMPLE for r=0.8 class 0.0 = 0.954 +- 0.171 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.887 +- 0.171 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.171 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 all L1 = 0.921 +- 0.165 (in-sample avg dev_std = 0.160)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03597
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.994
NEC for r=0.05 class 0.0 = 0.008 +- 0.063 (in-sample avg dev_std = 0.016)
NEC for r=0.05 class 1.0 = 0.006 +- 0.063 (in-sample avg dev_std = 0.016)
NEC for r=0.05 all KL = 0.007 +- 0.063 (in-sample avg dev_std = 0.016)
NEC for r=0.05 all L1 = 0.007 +- 0.056 (in-sample avg dev_std = 0.016)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047726
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.994
NEC for r=0.1 class 0.0 = 0.007 +- 0.065 (in-sample avg dev_std = 0.046)
NEC for r=0.1 class 1.0 = 0.006 +- 0.065 (in-sample avg dev_std = 0.046)
NEC for r=0.1 all KL = 0.007 +- 0.065 (in-sample avg dev_std = 0.046)
NEC for r=0.1 all L1 = 0.006 +- 0.052 (in-sample avg dev_std = 0.046)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061348
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.996
NEC for r=0.2 class 0.0 = 0.006 +- 0.059 (in-sample avg dev_std = 0.058)
NEC for r=0.2 class 1.0 = 0.005 +- 0.059 (in-sample avg dev_std = 0.058)
NEC for r=0.2 all KL = 0.006 +- 0.059 (in-sample avg dev_std = 0.058)
NEC for r=0.2 all L1 = 0.005 +- 0.048 (in-sample avg dev_std = 0.058)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07434
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.996
NEC for r=0.4 class 0.0 = 0.006 +- 0.061 (in-sample avg dev_std = 0.068)
NEC for r=0.4 class 1.0 = 0.005 +- 0.061 (in-sample avg dev_std = 0.068)
NEC for r=0.4 all KL = 0.007 +- 0.061 (in-sample avg dev_std = 0.068)
NEC for r=0.4 all L1 = 0.006 +- 0.042 (in-sample avg dev_std = 0.068)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
NEC for r=0.8 class 0.0 = 0.005 +- 0.049 (in-sample avg dev_std = 0.063)
NEC for r=0.8 class 1.0 = 0.004 +- 0.049 (in-sample avg dev_std = 0.063)
NEC for r=0.8 all KL = 0.006 +- 0.049 (in-sample avg dev_std = 0.063)
NEC for r=0.8 all L1 = 0.005 +- 0.033 (in-sample avg dev_std = 0.063)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080328
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.84
NEC for r=0.05 class 0.0 = 0.004 +- 0.049 (in-sample avg dev_std = 0.055)
NEC for r=0.05 class 1.0 = 0.019 +- 0.049 (in-sample avg dev_std = 0.055)
NEC for r=0.05 all KL = 0.006 +- 0.049 (in-sample avg dev_std = 0.055)
NEC for r=0.05 all L1 = 0.012 +- 0.042 (in-sample avg dev_std = 0.055)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0085574
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.84
NEC for r=0.1 class 0.0 = 0.004 +- 0.047 (in-sample avg dev_std = 0.059)
NEC for r=0.1 class 1.0 = 0.02 +- 0.047 (in-sample avg dev_std = 0.059)
NEC for r=0.1 all KL = 0.006 +- 0.047 (in-sample avg dev_std = 0.059)
NEC for r=0.1 all L1 = 0.012 +- 0.041 (in-sample avg dev_std = 0.059)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091202
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.84
NEC for r=0.2 class 0.0 = 0.004 +- 0.044 (in-sample avg dev_std = 0.057)
NEC for r=0.2 class 1.0 = 0.02 +- 0.044 (in-sample avg dev_std = 0.057)
NEC for r=0.2 all KL = 0.006 +- 0.044 (in-sample avg dev_std = 0.057)
NEC for r=0.2 all L1 = 0.012 +- 0.040 (in-sample avg dev_std = 0.057)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094654
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.84
NEC for r=0.4 class 0.0 = 0.003 +- 0.042 (in-sample avg dev_std = 0.059)
NEC for r=0.4 class 1.0 = 0.02 +- 0.042 (in-sample avg dev_std = 0.059)
NEC for r=0.4 all KL = 0.006 +- 0.042 (in-sample avg dev_std = 0.059)
NEC for r=0.4 all L1 = 0.012 +- 0.039 (in-sample avg dev_std = 0.059)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096952
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.84
NEC for r=0.8 class 0.0 = 0.005 +- 0.051 (in-sample avg dev_std = 0.068)
NEC for r=0.8 class 1.0 = 0.02 +- 0.051 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all KL = 0.008 +- 0.051 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all L1 = 0.013 +- 0.040 (in-sample avg dev_std = 0.068)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0258052
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.828
NEC for r=0.05 class 0.0 = 0.024 +- 0.125 (in-sample avg dev_std = 0.110)
NEC for r=0.05 class 1.0 = 0.074 +- 0.125 (in-sample avg dev_std = 0.110)
NEC for r=0.05 all KL = 0.032 +- 0.125 (in-sample avg dev_std = 0.110)
NEC for r=0.05 all L1 = 0.049 +- 0.129 (in-sample avg dev_std = 0.110)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0353
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.823
NEC for r=0.1 class 0.0 = 0.032 +- 0.139 (in-sample avg dev_std = 0.127)
NEC for r=0.1 class 1.0 = 0.078 +- 0.139 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all KL = 0.04 +- 0.139 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all L1 = 0.055 +- 0.138 (in-sample avg dev_std = 0.127)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0475984
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.823
NEC for r=0.2 class 0.0 = 0.039 +- 0.155 (in-sample avg dev_std = 0.152)
NEC for r=0.2 class 1.0 = 0.083 +- 0.155 (in-sample avg dev_std = 0.152)
NEC for r=0.2 all KL = 0.049 +- 0.155 (in-sample avg dev_std = 0.152)
NEC for r=0.2 all L1 = 0.061 +- 0.144 (in-sample avg dev_std = 0.152)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.061493200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.821
NEC for r=0.4 class 0.0 = 0.045 +- 0.168 (in-sample avg dev_std = 0.170)
NEC for r=0.4 class 1.0 = 0.086 +- 0.168 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all KL = 0.057 +- 0.168 (in-sample avg dev_std = 0.170)
NEC for r=0.4 all L1 = 0.065 +- 0.147 (in-sample avg dev_std = 0.170)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.831
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07859880000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.818
NEC for r=0.8 class 0.0 = 0.049 +- 0.183 (in-sample avg dev_std = 0.204)
NEC for r=0.8 class 1.0 = 0.093 +- 0.183 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all KL = 0.069 +- 0.183 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all L1 = 0.071 +- 0.150 (in-sample avg dev_std = 0.204)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 21:05:34 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 09:05:34 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 54 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.023
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.032
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032861999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.993
SUFF_SIMPLE for r=0.05 class 0.0 = 0.977 +- 0.147 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.147 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all KL = 0.973 +- 0.147 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.05 all L1 = 0.99 +- 0.062 (in-sample avg dev_std = 0.142)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041794
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.992
SUFF_SIMPLE for r=0.1 class 0.0 = 0.974 +- 0.153 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.153 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 all KL = 0.971 +- 0.153 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 all L1 = 0.988 +- 0.068 (in-sample avg dev_std = 0.146)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.051998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.991
SUFF_SIMPLE for r=0.2 class 0.0 = 0.97 +- 0.166 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.166 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.2 all KL = 0.965 +- 0.166 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.2 all L1 = 0.987 +- 0.071 (in-sample avg dev_std = 0.161)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064676
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.993
SUFF_SIMPLE for r=0.4 class 0.0 = 0.978 +- 0.143 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.143 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all KL = 0.974 +- 0.143 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all L1 = 0.99 +- 0.062 (in-sample avg dev_std = 0.138)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078292
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.991
SUFF_SIMPLE for r=0.8 class 0.0 = 0.973 +- 0.156 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.156 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 all KL = 0.97 +- 0.156 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 all L1 = 0.988 +- 0.072 (in-sample avg dev_std = 0.134)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086458
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.993
SUFF_SIMPLE for r=0.05 class 0.0 = 0.977 +- 0.181 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.996 +- 0.181 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.05 all KL = 0.958 +- 0.181 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.05 all L1 = 0.986 +- 0.065 (in-sample avg dev_std = 0.156)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092028
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.993
SUFF_SIMPLE for r=0.1 class 0.0 = 0.977 +- 0.182 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.182 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all KL = 0.957 +- 0.182 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.1 all L1 = 0.986 +- 0.064 (in-sample avg dev_std = 0.156)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009534
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.993
SUFF_SIMPLE for r=0.2 class 0.0 = 0.977 +- 0.178 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.995 +- 0.178 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all KL = 0.96 +- 0.178 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all L1 = 0.986 +- 0.065 (in-sample avg dev_std = 0.154)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009619800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.993
SUFF_SIMPLE for r=0.4 class 0.0 = 0.975 +- 0.185 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.185 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 all KL = 0.956 +- 0.185 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.4 all L1 = 0.985 +- 0.066 (in-sample avg dev_std = 0.161)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009695400000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.993
SUFF_SIMPLE for r=0.8 class 0.0 = 0.977 +- 0.176 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.995 +- 0.176 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.8 all KL = 0.961 +- 0.176 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.8 all L1 = 0.986 +- 0.068 (in-sample avg dev_std = 0.155)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0230524
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.877
SUFF_SIMPLE for r=0.05 class 0.0 = 0.952 +- 0.202 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.962 +- 0.202 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.05 all KL = 0.941 +- 0.202 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.05 all L1 = 0.957 +- 0.144 (in-sample avg dev_std = 0.192)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0324914
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.879
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.199 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.964 +- 0.199 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.1 all KL = 0.943 +- 0.199 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.140 (in-sample avg dev_std = 0.191)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0442574
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.879
SUFF_SIMPLE for r=0.2 class 0.0 = 0.953 +- 0.193 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.965 +- 0.193 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.2 all KL = 0.947 +- 0.193 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.2 all L1 = 0.959 +- 0.141 (in-sample avg dev_std = 0.181)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0599978
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.88
SUFF_SIMPLE for r=0.4 class 0.0 = 0.955 +- 0.190 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.965 +- 0.190 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all KL = 0.949 +- 0.190 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all L1 = 0.96 +- 0.140 (in-sample avg dev_std = 0.173)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.897
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0767382
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.885
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.165 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.964 +- 0.165 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.8 all KL = 0.96 +- 0.165 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.8 all L1 = 0.966 +- 0.130 (in-sample avg dev_std = 0.135)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032861999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 0.0 = 0.002 +- 0.044 (in-sample avg dev_std = 0.040)
NEC for r=0.05 class 1.0 = 0.0 +- 0.044 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all L1 = 0.001 +- 0.021 (in-sample avg dev_std = 0.040)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041794
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
NEC for r=0.1 class 0.0 = 0.002 +- 0.044 (in-sample avg dev_std = 0.040)
NEC for r=0.1 class 1.0 = 0.0 +- 0.044 (in-sample avg dev_std = 0.040)
NEC for r=0.1 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.040)
NEC for r=0.1 all L1 = 0.001 +- 0.021 (in-sample avg dev_std = 0.040)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.051998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.999
NEC for r=0.2 class 0.0 = 0.002 +- 0.044 (in-sample avg dev_std = 0.040)
NEC for r=0.2 class 1.0 = 0.0 +- 0.044 (in-sample avg dev_std = 0.040)
NEC for r=0.2 all KL = 0.003 +- 0.044 (in-sample avg dev_std = 0.040)
NEC for r=0.2 all L1 = 0.001 +- 0.013 (in-sample avg dev_std = 0.040)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064676
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.003 +- 0.057 (in-sample avg dev_std = 0.050)
NEC for r=0.4 class 1.0 = 0.0 +- 0.057 (in-sample avg dev_std = 0.050)
NEC for r=0.4 all KL = 0.004 +- 0.057 (in-sample avg dev_std = 0.050)
NEC for r=0.4 all L1 = 0.001 +- 0.019 (in-sample avg dev_std = 0.050)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078292
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
NEC for r=0.8 class 0.0 = 0.006 +- 0.079 (in-sample avg dev_std = 0.069)
NEC for r=0.8 class 1.0 = 0.0 +- 0.079 (in-sample avg dev_std = 0.069)
NEC for r=0.8 all KL = 0.009 +- 0.079 (in-sample avg dev_std = 0.069)
NEC for r=0.8 all L1 = 0.003 +- 0.026 (in-sample avg dev_std = 0.069)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086458
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 0.0 = 0.003 +- 0.067 (in-sample avg dev_std = 0.053)
NEC for r=0.05 class 1.0 = 0.004 +- 0.067 (in-sample avg dev_std = 0.053)
NEC for r=0.05 all KL = 0.006 +- 0.067 (in-sample avg dev_std = 0.053)
NEC for r=0.05 all L1 = 0.003 +- 0.037 (in-sample avg dev_std = 0.053)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092028
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.003 +- 0.075 (in-sample avg dev_std = 0.060)
NEC for r=0.1 class 1.0 = 0.004 +- 0.075 (in-sample avg dev_std = 0.060)
NEC for r=0.1 all KL = 0.007 +- 0.075 (in-sample avg dev_std = 0.060)
NEC for r=0.1 all L1 = 0.003 +- 0.036 (in-sample avg dev_std = 0.060)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009534
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.999
NEC for r=0.2 class 0.0 = 0.003 +- 0.071 (in-sample avg dev_std = 0.055)
NEC for r=0.2 class 1.0 = 0.004 +- 0.071 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all KL = 0.007 +- 0.071 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all L1 = 0.003 +- 0.035 (in-sample avg dev_std = 0.055)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009619800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.003 +- 0.074 (in-sample avg dev_std = 0.058)
NEC for r=0.4 class 1.0 = 0.004 +- 0.074 (in-sample avg dev_std = 0.058)
NEC for r=0.4 all KL = 0.007 +- 0.074 (in-sample avg dev_std = 0.058)
NEC for r=0.4 all L1 = 0.003 +- 0.036 (in-sample avg dev_std = 0.058)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009695400000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.002 +- 0.069 (in-sample avg dev_std = 0.053)
NEC for r=0.8 class 1.0 = 0.004 +- 0.069 (in-sample avg dev_std = 0.053)
NEC for r=0.8 all KL = 0.006 +- 0.069 (in-sample avg dev_std = 0.053)
NEC for r=0.8 all L1 = 0.003 +- 0.036 (in-sample avg dev_std = 0.053)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0230524
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.893
NEC for r=0.05 class 0.0 = 0.015 +- 0.108 (in-sample avg dev_std = 0.083)
NEC for r=0.05 class 1.0 = 0.018 +- 0.108 (in-sample avg dev_std = 0.083)
NEC for r=0.05 all KL = 0.016 +- 0.108 (in-sample avg dev_std = 0.083)
NEC for r=0.05 all L1 = 0.017 +- 0.090 (in-sample avg dev_std = 0.083)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0324914
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.891
NEC for r=0.1 class 0.0 = 0.019 +- 0.117 (in-sample avg dev_std = 0.091)
NEC for r=0.1 class 1.0 = 0.019 +- 0.117 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all KL = 0.02 +- 0.117 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all L1 = 0.019 +- 0.097 (in-sample avg dev_std = 0.091)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0442574
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.886
NEC for r=0.2 class 0.0 = 0.028 +- 0.144 (in-sample avg dev_std = 0.131)
NEC for r=0.2 class 1.0 = 0.019 +- 0.144 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all KL = 0.028 +- 0.144 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all L1 = 0.023 +- 0.108 (in-sample avg dev_std = 0.131)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0599978
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.886
NEC for r=0.4 class 0.0 = 0.031 +- 0.156 (in-sample avg dev_std = 0.152)
NEC for r=0.4 class 1.0 = 0.017 +- 0.156 (in-sample avg dev_std = 0.152)
NEC for r=0.4 all KL = 0.033 +- 0.156 (in-sample avg dev_std = 0.152)
NEC for r=0.4 all L1 = 0.025 +- 0.107 (in-sample avg dev_std = 0.152)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.896
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0767382
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.887
NEC for r=0.8 class 0.0 = 0.032 +- 0.159 (in-sample avg dev_std = 0.159)
NEC for r=0.8 class 1.0 = 0.018 +- 0.159 (in-sample avg dev_std = 0.159)
NEC for r=0.8 all KL = 0.035 +- 0.159 (in-sample avg dev_std = 0.159)
NEC for r=0.8 all L1 = 0.025 +- 0.104 (in-sample avg dev_std = 0.159)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 21:21:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 09:21:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.042
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.058
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04221000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.994
SUFF_SIMPLE for r=0.05 class 0.0 = 0.977 +- 0.151 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.151 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 all KL = 0.968 +- 0.151 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 all L1 = 0.99 +- 0.052 (in-sample avg dev_std = 0.144)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04986
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.996
SUFF_SIMPLE for r=0.1 class 0.0 = 0.985 +- 0.119 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.119 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 all KL = 0.98 +- 0.119 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.1 all L1 = 0.993 +- 0.040 (in-sample avg dev_std = 0.113)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.058192
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.996
SUFF_SIMPLE for r=0.2 class 0.0 = 0.981 +- 0.138 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.138 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.2 all KL = 0.972 +- 0.138 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.2 all L1 = 0.991 +- 0.045 (in-sample avg dev_std = 0.131)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06778400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.996
SUFF_SIMPLE for r=0.4 class 0.0 = 0.986 +- 0.110 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.110 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 all KL = 0.983 +- 0.110 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.4 all L1 = 0.994 +- 0.044 (in-sample avg dev_std = 0.105)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077462
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.993
SUFF_SIMPLE for r=0.8 class 0.0 = 0.98 +- 0.132 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.132 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.8 all KL = 0.98 +- 0.132 (in-sample avg dev_std = 0.123)
SUFF_SIMPLE for r=0.8 all L1 = 0.99 +- 0.070 (in-sample avg dev_std = 0.123)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084326
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.991
SUFF_SIMPLE for r=0.05 class 0.0 = 0.969 +- 0.204 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.204 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all KL = 0.944 +- 0.204 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all L1 = 0.98 +- 0.085 (in-sample avg dev_std = 0.179)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091108
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 0.0 = 0.969 +- 0.205 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.205 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 all KL = 0.945 +- 0.205 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 all L1 = 0.979 +- 0.086 (in-sample avg dev_std = 0.181)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094056
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.991
SUFF_SIMPLE for r=0.2 class 0.0 = 0.971 +- 0.200 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.200 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.2 all KL = 0.946 +- 0.200 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.2 all L1 = 0.98 +- 0.084 (in-sample avg dev_std = 0.176)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009528199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.991
SUFF_SIMPLE for r=0.4 class 0.0 = 0.969 +- 0.202 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.202 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.4 all KL = 0.946 +- 0.202 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.4 all L1 = 0.98 +- 0.086 (in-sample avg dev_std = 0.178)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096482
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.99
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.201 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.201 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 all KL = 0.948 +- 0.201 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 all L1 = 0.979 +- 0.089 (in-sample avg dev_std = 0.179)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024804399999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.95
SUFF_SIMPLE for r=0.05 class 0.0 = 0.949 +- 0.195 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.976 +- 0.195 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.05 all KL = 0.946 +- 0.195 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.05 all L1 = 0.962 +- 0.137 (in-sample avg dev_std = 0.185)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0359612
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.949
SUFF_SIMPLE for r=0.1 class 0.0 = 0.947 +- 0.198 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.974 +- 0.198 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.1 all KL = 0.944 +- 0.198 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.1 all L1 = 0.961 +- 0.139 (in-sample avg dev_std = 0.188)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.049202800000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.95
SUFF_SIMPLE for r=0.2 class 0.0 = 0.948 +- 0.191 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.979 +- 0.191 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.2 all KL = 0.949 +- 0.191 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.2 all L1 = 0.963 +- 0.139 (in-sample avg dev_std = 0.165)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.062382799999999995
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.952
SUFF_SIMPLE for r=0.4 class 0.0 = 0.951 +- 0.185 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.982 +- 0.185 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all KL = 0.955 +- 0.185 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all L1 = 0.966 +- 0.135 (in-sample avg dev_std = 0.160)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07781400000000001
len(reference) = 4981
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.961
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.137 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.983 +- 0.137 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all KL = 0.974 +- 0.137 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all L1 = 0.976 +- 0.115 (in-sample avg dev_std = 0.089)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04221000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04986
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.058192
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06778400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.001 +- 0.037 (in-sample avg dev_std = 0.033)
NEC for r=0.4 class 1.0 = 0.0 +- 0.037 (in-sample avg dev_std = 0.033)
NEC for r=0.4 all KL = 0.002 +- 0.037 (in-sample avg dev_std = 0.033)
NEC for r=0.4 all L1 = 0.001 +- 0.010 (in-sample avg dev_std = 0.033)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077462
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.001 +- 0.036 (in-sample avg dev_std = 0.032)
NEC for r=0.8 class 1.0 = 0.0 +- 0.036 (in-sample avg dev_std = 0.032)
NEC for r=0.8 all KL = 0.002 +- 0.036 (in-sample avg dev_std = 0.032)
NEC for r=0.8 all L1 = 0.001 +- 0.010 (in-sample avg dev_std = 0.032)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084326
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.003 +- 0.082 (in-sample avg dev_std = 0.064)
NEC for r=0.05 class 1.0 = 0.009 +- 0.082 (in-sample avg dev_std = 0.064)
NEC for r=0.05 all KL = 0.009 +- 0.082 (in-sample avg dev_std = 0.064)
NEC for r=0.05 all L1 = 0.006 +- 0.057 (in-sample avg dev_std = 0.064)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091108
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.004 +- 0.090 (in-sample avg dev_std = 0.071)
NEC for r=0.1 class 1.0 = 0.009 +- 0.090 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all KL = 0.011 +- 0.090 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all L1 = 0.006 +- 0.057 (in-sample avg dev_std = 0.071)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094056
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.004 +- 0.089 (in-sample avg dev_std = 0.069)
NEC for r=0.2 class 1.0 = 0.009 +- 0.089 (in-sample avg dev_std = 0.069)
NEC for r=0.2 all KL = 0.011 +- 0.089 (in-sample avg dev_std = 0.069)
NEC for r=0.2 all L1 = 0.006 +- 0.057 (in-sample avg dev_std = 0.069)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009528199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.998
NEC for r=0.4 class 0.0 = 0.003 +- 0.086 (in-sample avg dev_std = 0.065)
NEC for r=0.4 class 1.0 = 0.009 +- 0.086 (in-sample avg dev_std = 0.065)
NEC for r=0.4 all KL = 0.01 +- 0.086 (in-sample avg dev_std = 0.065)
NEC for r=0.4 all L1 = 0.006 +- 0.056 (in-sample avg dev_std = 0.065)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096482
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.998
NEC for r=0.8 class 0.0 = 0.004 +- 0.096 (in-sample avg dev_std = 0.076)
NEC for r=0.8 class 1.0 = 0.009 +- 0.096 (in-sample avg dev_std = 0.076)
NEC for r=0.8 all KL = 0.013 +- 0.096 (in-sample avg dev_std = 0.076)
NEC for r=0.8 all L1 = 0.007 +- 0.057 (in-sample avg dev_std = 0.076)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024804399999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.97
NEC for r=0.05 class 0.0 = 0.011 +- 0.084 (in-sample avg dev_std = 0.058)
NEC for r=0.05 class 1.0 = 0.009 +- 0.084 (in-sample avg dev_std = 0.058)
NEC for r=0.05 all KL = 0.01 +- 0.084 (in-sample avg dev_std = 0.058)
NEC for r=0.05 all L1 = 0.01 +- 0.073 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0359612
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.967
NEC for r=0.1 class 0.0 = 0.017 +- 0.101 (in-sample avg dev_std = 0.063)
NEC for r=0.1 class 1.0 = 0.009 +- 0.101 (in-sample avg dev_std = 0.063)
NEC for r=0.1 all KL = 0.014 +- 0.101 (in-sample avg dev_std = 0.063)
NEC for r=0.1 all L1 = 0.013 +- 0.085 (in-sample avg dev_std = 0.063)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.049202800000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.963
NEC for r=0.2 class 0.0 = 0.026 +- 0.131 (in-sample avg dev_std = 0.109)
NEC for r=0.2 class 1.0 = 0.011 +- 0.131 (in-sample avg dev_std = 0.109)
NEC for r=0.2 all KL = 0.023 +- 0.131 (in-sample avg dev_std = 0.109)
NEC for r=0.2 all L1 = 0.019 +- 0.101 (in-sample avg dev_std = 0.109)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.062382799999999995
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.963
NEC for r=0.4 class 0.0 = 0.031 +- 0.148 (in-sample avg dev_std = 0.136)
NEC for r=0.4 class 1.0 = 0.01 +- 0.148 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all KL = 0.028 +- 0.148 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all L1 = 0.021 +- 0.104 (in-sample avg dev_std = 0.136)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07781400000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.963
NEC for r=0.8 class 0.0 = 0.034 +- 0.157 (in-sample avg dev_std = 0.152)
NEC for r=0.8 class 1.0 = 0.011 +- 0.157 (in-sample avg dev_std = 0.152)
NEC for r=0.8 all KL = 0.033 +- 0.157 (in-sample avg dev_std = 0.152)
NEC for r=0.8 all L1 = 0.022 +- 0.104 (in-sample avg dev_std = 0.152)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 21:36:55 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 09:36:55 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.046
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.057
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.035
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.985
SUFF_SIMPLE for r=0.05 class 0.0 = 0.95 +- 0.207 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.207 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.05 all KL = 0.941 +- 0.207 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.05 all L1 = 0.978 +- 0.087 (in-sample avg dev_std = 0.201)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046182
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.987
SUFF_SIMPLE for r=0.1 class 0.0 = 0.951 +- 0.204 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.204 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.204 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all L1 = 0.978 +- 0.084 (in-sample avg dev_std = 0.196)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05686
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.986
SUFF_SIMPLE for r=0.2 class 0.0 = 0.95 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 all KL = 0.94 +- 0.204 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.2 all L1 = 0.978 +- 0.085 (in-sample avg dev_std = 0.193)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06764400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.987
SUFF_SIMPLE for r=0.4 class 0.0 = 0.956 +- 0.194 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.194 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.4 all KL = 0.949 +- 0.194 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.4 all L1 = 0.98 +- 0.083 (in-sample avg dev_std = 0.189)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0786
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.99
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.154 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.154 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all KL = 0.97 +- 0.154 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all L1 = 0.986 +- 0.080 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008801999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.904
SUFF_SIMPLE for r=0.05 class 0.0 = 0.843 +- 0.364 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.364 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all KL = 0.814 +- 0.364 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all L1 = 0.922 +- 0.170 (in-sample avg dev_std = 0.376)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094696
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.906
SUFF_SIMPLE for r=0.1 class 0.0 = 0.848 +- 0.362 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.362 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.1 all KL = 0.816 +- 0.362 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.1 all L1 = 0.924 +- 0.167 (in-sample avg dev_std = 0.370)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.905
SUFF_SIMPLE for r=0.2 class 0.0 = 0.847 +- 0.361 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.361 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.2 all KL = 0.819 +- 0.361 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.2 all L1 = 0.923 +- 0.170 (in-sample avg dev_std = 0.369)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096576
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.907
SUFF_SIMPLE for r=0.4 class 0.0 = 0.85 +- 0.360 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.360 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.4 all KL = 0.819 +- 0.360 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.4 all L1 = 0.925 +- 0.166 (in-sample avg dev_std = 0.368)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097536
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.904
SUFF_SIMPLE for r=0.8 class 0.0 = 0.848 +- 0.356 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.356 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.8 all KL = 0.827 +- 0.356 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.8 all L1 = 0.924 +- 0.174 (in-sample avg dev_std = 0.360)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0250228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.946
SUFF_SIMPLE for r=0.05 class 0.0 = 0.946 +- 0.237 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.971 +- 0.237 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 all KL = 0.93 +- 0.237 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.05 all L1 = 0.958 +- 0.152 (in-sample avg dev_std = 0.184)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.034944399999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.946
SUFF_SIMPLE for r=0.1 class 0.0 = 0.946 +- 0.235 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.971 +- 0.235 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 all KL = 0.932 +- 0.235 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.153 (in-sample avg dev_std = 0.182)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461592
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.945
SUFF_SIMPLE for r=0.2 class 0.0 = 0.947 +- 0.218 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.976 +- 0.218 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.2 all KL = 0.944 +- 0.218 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.2 all L1 = 0.962 +- 0.156 (in-sample avg dev_std = 0.135)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060563
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.951
SUFF_SIMPLE for r=0.4 class 0.0 = 0.955 +- 0.169 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.169 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.4 all KL = 0.967 +- 0.169 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.4 all L1 = 0.976 +- 0.126 (in-sample avg dev_std = 0.119)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.973
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769859999999999
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.956
SUFF_SIMPLE for r=0.8 class 0.0 = 0.966 +- 0.135 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.135 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.8 all KL = 0.979 +- 0.135 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.8 all L1 = 0.983 +- 0.114 (in-sample avg dev_std = 0.050)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.009 +- 0.087 (in-sample avg dev_std = 0.070)
NEC for r=0.05 class 1.0 = 0.0 +- 0.087 (in-sample avg dev_std = 0.070)
NEC for r=0.05 all KL = 0.009 +- 0.087 (in-sample avg dev_std = 0.070)
NEC for r=0.05 all L1 = 0.004 +- 0.041 (in-sample avg dev_std = 0.070)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046182
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.011 +- 0.098 (in-sample avg dev_std = 0.089)
NEC for r=0.1 class 1.0 = 0.0 +- 0.098 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all KL = 0.014 +- 0.098 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all L1 = 0.005 +- 0.039 (in-sample avg dev_std = 0.089)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05686
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.009 +- 0.095 (in-sample avg dev_std = 0.086)
NEC for r=0.2 class 1.0 = 0.0 +- 0.095 (in-sample avg dev_std = 0.086)
NEC for r=0.2 all KL = 0.012 +- 0.095 (in-sample avg dev_std = 0.086)
NEC for r=0.2 all L1 = 0.004 +- 0.034 (in-sample avg dev_std = 0.086)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06764400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.006 +- 0.071 (in-sample avg dev_std = 0.067)
NEC for r=0.4 class 1.0 = 0.0 +- 0.071 (in-sample avg dev_std = 0.067)
NEC for r=0.4 all KL = 0.008 +- 0.071 (in-sample avg dev_std = 0.067)
NEC for r=0.4 all L1 = 0.003 +- 0.024 (in-sample avg dev_std = 0.067)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0786
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
NEC for r=0.8 class 0.0 = 0.009 +- 0.089 (in-sample avg dev_std = 0.085)
NEC for r=0.8 class 1.0 = 0.0 +- 0.089 (in-sample avg dev_std = 0.085)
NEC for r=0.8 all KL = 0.013 +- 0.089 (in-sample avg dev_std = 0.085)
NEC for r=0.8 all L1 = 0.004 +- 0.030 (in-sample avg dev_std = 0.085)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008801999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.944
NEC for r=0.05 class 0.0 = 0.04 +- 0.198 (in-sample avg dev_std = 0.182)
NEC for r=0.05 class 1.0 = 0.001 +- 0.198 (in-sample avg dev_std = 0.182)
NEC for r=0.05 all KL = 0.048 +- 0.198 (in-sample avg dev_std = 0.182)
NEC for r=0.05 all L1 = 0.02 +- 0.091 (in-sample avg dev_std = 0.182)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094696
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.944
NEC for r=0.1 class 0.0 = 0.042 +- 0.211 (in-sample avg dev_std = 0.194)
NEC for r=0.1 class 1.0 = 0.001 +- 0.211 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all KL = 0.058 +- 0.211 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all L1 = 0.021 +- 0.086 (in-sample avg dev_std = 0.194)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.942
NEC for r=0.2 class 0.0 = 0.049 +- 0.234 (in-sample avg dev_std = 0.215)
NEC for r=0.2 class 1.0 = 0.001 +- 0.234 (in-sample avg dev_std = 0.215)
NEC for r=0.2 all KL = 0.073 +- 0.234 (in-sample avg dev_std = 0.215)
NEC for r=0.2 all L1 = 0.025 +- 0.086 (in-sample avg dev_std = 0.215)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096576
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.943
NEC for r=0.4 class 0.0 = 0.048 +- 0.233 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 1.0 = 0.001 +- 0.233 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all KL = 0.075 +- 0.233 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all L1 = 0.024 +- 0.083 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097536
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.942
NEC for r=0.8 class 0.0 = 0.05 +- 0.239 (in-sample avg dev_std = 0.218)
NEC for r=0.8 class 1.0 = 0.001 +- 0.239 (in-sample avg dev_std = 0.218)
NEC for r=0.8 all KL = 0.079 +- 0.239 (in-sample avg dev_std = 0.218)
NEC for r=0.8 all L1 = 0.025 +- 0.081 (in-sample avg dev_std = 0.218)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0250228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.966
NEC for r=0.05 class 0.0 = 0.016 +- 0.089 (in-sample avg dev_std = 0.009)
NEC for r=0.05 class 1.0 = 0.0 +- 0.089 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all KL = 0.009 +- 0.089 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all L1 = 0.008 +- 0.079 (in-sample avg dev_std = 0.009)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.034944399999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.963
NEC for r=0.1 class 0.0 = 0.023 +- 0.111 (in-sample avg dev_std = 0.034)
NEC for r=0.1 class 1.0 = 0.0 +- 0.111 (in-sample avg dev_std = 0.034)
NEC for r=0.1 all KL = 0.014 +- 0.111 (in-sample avg dev_std = 0.034)
NEC for r=0.1 all L1 = 0.012 +- 0.093 (in-sample avg dev_std = 0.034)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461592
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.96
NEC for r=0.2 class 0.0 = 0.032 +- 0.138 (in-sample avg dev_std = 0.097)
NEC for r=0.2 class 1.0 = 0.0 +- 0.138 (in-sample avg dev_std = 0.097)
NEC for r=0.2 all KL = 0.022 +- 0.138 (in-sample avg dev_std = 0.097)
NEC for r=0.2 all L1 = 0.016 +- 0.105 (in-sample avg dev_std = 0.097)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060563
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.96
NEC for r=0.4 class 0.0 = 0.033 +- 0.145 (in-sample avg dev_std = 0.119)
NEC for r=0.4 class 1.0 = 0.0 +- 0.145 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all KL = 0.026 +- 0.145 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all L1 = 0.017 +- 0.102 (in-sample avg dev_std = 0.119)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769859999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.96
NEC for r=0.8 class 0.0 = 0.034 +- 0.164 (in-sample avg dev_std = 0.145)
NEC for r=0.8 class 1.0 = 0.007 +- 0.164 (in-sample avg dev_std = 0.145)
NEC for r=0.8 all KL = 0.034 +- 0.164 (in-sample avg dev_std = 0.145)
NEC for r=0.8 all L1 = 0.02 +- 0.106 (in-sample avg dev_std = 0.145)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 21:52:47 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 09:52:47 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.034
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.033142
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.993
SUFF_SIMPLE for r=0.05 class 0.0 = 0.975 +- 0.145 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.145 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 all KL = 0.971 +- 0.145 (in-sample avg dev_std = 0.144)
SUFF_SIMPLE for r=0.05 all L1 = 0.989 +- 0.063 (in-sample avg dev_std = 0.144)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04718000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.993
SUFF_SIMPLE for r=0.1 class 0.0 = 0.976 +- 0.143 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.143 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all KL = 0.974 +- 0.143 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all L1 = 0.989 +- 0.067 (in-sample avg dev_std = 0.134)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061318000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.993
SUFF_SIMPLE for r=0.2 class 0.0 = 0.976 +- 0.146 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.146 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 all KL = 0.972 +- 0.146 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.2 all L1 = 0.989 +- 0.065 (in-sample avg dev_std = 0.143)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07402600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.995
SUFF_SIMPLE for r=0.4 class 0.0 = 0.985 +- 0.115 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.115 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all KL = 0.982 +- 0.115 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all L1 = 0.993 +- 0.051 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.996
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.113 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.113 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all KL = 0.984 +- 0.113 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all L1 = 0.993 +- 0.056 (in-sample avg dev_std = 0.094)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008237000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.896
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.431 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.581 +- 0.431 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 all KL = 0.719 +- 0.431 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 all L1 = 0.787 +- 0.341 (in-sample avg dev_std = 0.297)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.008912799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.896
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.430 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.583 +- 0.430 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.1 all KL = 0.72 +- 0.430 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.1 all L1 = 0.789 +- 0.340 (in-sample avg dev_std = 0.297)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009259
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.896
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.431 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.582 +- 0.431 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.2 all KL = 0.72 +- 0.431 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.2 all L1 = 0.788 +- 0.340 (in-sample avg dev_std = 0.298)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009552199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.897
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.432 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.58 +- 0.432 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.4 all KL = 0.719 +- 0.432 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.4 all L1 = 0.787 +- 0.340 (in-sample avg dev_std = 0.298)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097164
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.896
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.430 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.584 +- 0.430 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 all KL = 0.723 +- 0.430 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.8 all L1 = 0.789 +- 0.341 (in-sample avg dev_std = 0.287)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249308
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.813
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.192 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.962 +- 0.192 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.05 all KL = 0.943 +- 0.192 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.05 all L1 = 0.958 +- 0.136 (in-sample avg dev_std = 0.180)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0338566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.814
SUFF_SIMPLE for r=0.1 class 0.0 = 0.955 +- 0.186 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.962 +- 0.186 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.1 all KL = 0.946 +- 0.186 (in-sample avg dev_std = 0.172)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.136 (in-sample avg dev_std = 0.172)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0458186
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.812
SUFF_SIMPLE for r=0.2 class 0.0 = 0.954 +- 0.187 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.965 +- 0.187 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.2 all KL = 0.949 +- 0.187 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.2 all L1 = 0.959 +- 0.138 (in-sample avg dev_std = 0.164)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0598442
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.814
SUFF_SIMPLE for r=0.4 class 0.0 = 0.955 +- 0.181 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.969 +- 0.181 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.4 all KL = 0.954 +- 0.181 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.4 all L1 = 0.962 +- 0.135 (in-sample avg dev_std = 0.164)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.83
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0774122
len(reference) = 4980
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.821
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.142 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.969 +- 0.142 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.8 all KL = 0.97 +- 0.142 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.8 all L1 = 0.97 +- 0.122 (in-sample avg dev_std = 0.102)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.033142
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.001 +- 0.018 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.018 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.001 +- 0.018 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.007 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04718000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.002 +- 0.038 (in-sample avg dev_std = 0.020)
NEC for r=0.1 class 1.0 = 0.0 +- 0.038 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all KL = 0.002 +- 0.038 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all L1 = 0.001 +- 0.015 (in-sample avg dev_std = 0.020)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061318000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.002 +- 0.046 (in-sample avg dev_std = 0.037)
NEC for r=0.2 class 1.0 = 0.0 +- 0.046 (in-sample avg dev_std = 0.037)
NEC for r=0.2 all KL = 0.003 +- 0.046 (in-sample avg dev_std = 0.037)
NEC for r=0.2 all L1 = 0.001 +- 0.016 (in-sample avg dev_std = 0.037)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07402600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.001 +- 0.030 (in-sample avg dev_std = 0.018)
NEC for r=0.4 class 1.0 = 0.0 +- 0.030 (in-sample avg dev_std = 0.018)
NEC for r=0.4 all KL = 0.002 +- 0.030 (in-sample avg dev_std = 0.018)
NEC for r=0.4 all L1 = 0.001 +- 0.010 (in-sample avg dev_std = 0.018)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.002 +- 0.041 (in-sample avg dev_std = 0.041)
NEC for r=0.8 class 1.0 = 0.0 +- 0.041 (in-sample avg dev_std = 0.041)
NEC for r=0.8 all KL = 0.003 +- 0.041 (in-sample avg dev_std = 0.041)
NEC for r=0.8 all L1 = 0.001 +- 0.013 (in-sample avg dev_std = 0.041)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008237000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.796
NEC for r=0.05 class 0.0 = 0.0 +- 0.346 (in-sample avg dev_std = 0.243)
NEC for r=0.05 class 1.0 = 0.24 +- 0.346 (in-sample avg dev_std = 0.243)
NEC for r=0.05 all KL = 0.164 +- 0.346 (in-sample avg dev_std = 0.243)
NEC for r=0.05 all L1 = 0.121 +- 0.264 (in-sample avg dev_std = 0.243)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.008912799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.797
NEC for r=0.1 class 0.0 = 0.0 +- 0.355 (in-sample avg dev_std = 0.266)
NEC for r=0.1 class 1.0 = 0.247 +- 0.355 (in-sample avg dev_std = 0.266)
NEC for r=0.1 all KL = 0.177 +- 0.355 (in-sample avg dev_std = 0.266)
NEC for r=0.1 all L1 = 0.125 +- 0.264 (in-sample avg dev_std = 0.266)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009259
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.795
NEC for r=0.2 class 0.0 = 0.0 +- 0.355 (in-sample avg dev_std = 0.270)
NEC for r=0.2 class 1.0 = 0.245 +- 0.355 (in-sample avg dev_std = 0.270)
NEC for r=0.2 all KL = 0.177 +- 0.355 (in-sample avg dev_std = 0.270)
NEC for r=0.2 all L1 = 0.124 +- 0.262 (in-sample avg dev_std = 0.270)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009552199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.797
NEC for r=0.4 class 0.0 = 0.0 +- 0.359 (in-sample avg dev_std = 0.279)
NEC for r=0.4 class 1.0 = 0.249 +- 0.359 (in-sample avg dev_std = 0.279)
NEC for r=0.4 all KL = 0.183 +- 0.359 (in-sample avg dev_std = 0.279)
NEC for r=0.4 all L1 = 0.126 +- 0.262 (in-sample avg dev_std = 0.279)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097164
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.797
NEC for r=0.8 class 0.0 = 0.0 +- 0.361 (in-sample avg dev_std = 0.281)
NEC for r=0.8 class 1.0 = 0.251 +- 0.361 (in-sample avg dev_std = 0.281)
NEC for r=0.8 all KL = 0.186 +- 0.361 (in-sample avg dev_std = 0.281)
NEC for r=0.8 all L1 = 0.126 +- 0.262 (in-sample avg dev_std = 0.281)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249308
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.825
NEC for r=0.05 class 0.0 = 0.015 +- 0.097 (in-sample avg dev_std = 0.061)
NEC for r=0.05 class 1.0 = 0.015 +- 0.097 (in-sample avg dev_std = 0.061)
NEC for r=0.05 all KL = 0.013 +- 0.097 (in-sample avg dev_std = 0.061)
NEC for r=0.05 all L1 = 0.015 +- 0.085 (in-sample avg dev_std = 0.061)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0338566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.823
NEC for r=0.1 class 0.0 = 0.02 +- 0.109 (in-sample avg dev_std = 0.071)
NEC for r=0.1 class 1.0 = 0.015 +- 0.109 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all KL = 0.016 +- 0.109 (in-sample avg dev_std = 0.071)
NEC for r=0.1 all L1 = 0.017 +- 0.092 (in-sample avg dev_std = 0.071)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0458186
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.821
NEC for r=0.2 class 0.0 = 0.029 +- 0.139 (in-sample avg dev_std = 0.121)
NEC for r=0.2 class 1.0 = 0.016 +- 0.139 (in-sample avg dev_std = 0.121)
NEC for r=0.2 all KL = 0.026 +- 0.139 (in-sample avg dev_std = 0.121)
NEC for r=0.2 all L1 = 0.023 +- 0.106 (in-sample avg dev_std = 0.121)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0598442
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.82
NEC for r=0.4 class 0.0 = 0.03 +- 0.146 (in-sample avg dev_std = 0.141)
NEC for r=0.4 class 1.0 = 0.016 +- 0.146 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all KL = 0.029 +- 0.146 (in-sample avg dev_std = 0.141)
NEC for r=0.4 all L1 = 0.023 +- 0.102 (in-sample avg dev_std = 0.141)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.828
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0774122
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.821
NEC for r=0.8 class 0.0 = 0.031 +- 0.150 (in-sample avg dev_std = 0.147)
NEC for r=0.8 class 1.0 = 0.017 +- 0.150 (in-sample avg dev_std = 0.147)
NEC for r=0.8 all KL = 0.032 +- 0.150 (in-sample avg dev_std = 0.147)
NEC for r=0.8 all L1 = 0.024 +- 0.100 (in-sample avg dev_std = 0.147)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 22:08:45 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 10:08:45 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.046
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.059
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034836
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.984
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.167 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.986 +- 0.167 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.05 all KL = 0.951 +- 0.167 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.05 all L1 = 0.971 +- 0.093 (in-sample avg dev_std = 0.170)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045554000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.987
SUFF_SIMPLE for r=0.1 class 0.0 = 0.954 +- 0.146 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.146 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.1 all KL = 0.96 +- 0.146 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.1 all L1 = 0.973 +- 0.092 (in-sample avg dev_std = 0.153)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059278000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.984
SUFF_SIMPLE for r=0.2 class 0.0 = 0.953 +- 0.168 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.987 +- 0.168 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 all KL = 0.952 +- 0.168 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.2 all L1 = 0.972 +- 0.094 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070852
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.987
SUFF_SIMPLE for r=0.4 class 0.0 = 0.953 +- 0.156 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.989 +- 0.156 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.4 all KL = 0.958 +- 0.156 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.4 all L1 = 0.973 +- 0.093 (in-sample avg dev_std = 0.152)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.99
SUFF_SIMPLE for r=0.8 class 0.0 = 0.967 +- 0.127 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.988 +- 0.127 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 all KL = 0.972 +- 0.127 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 all L1 = 0.979 +- 0.094 (in-sample avg dev_std = 0.092)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085098
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.915
SUFF_SIMPLE for r=0.05 class 0.0 = 0.866 +- 0.223 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.929 +- 0.223 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 all KL = 0.885 +- 0.223 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.05 all L1 = 0.898 +- 0.193 (in-sample avg dev_std = 0.224)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091046
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.915
SUFF_SIMPLE for r=0.1 class 0.0 = 0.865 +- 0.225 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.931 +- 0.225 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 all KL = 0.884 +- 0.225 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 all L1 = 0.898 +- 0.193 (in-sample avg dev_std = 0.223)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009589
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.914
SUFF_SIMPLE for r=0.2 class 0.0 = 0.865 +- 0.226 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.931 +- 0.226 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all KL = 0.883 +- 0.226 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all L1 = 0.898 +- 0.193 (in-sample avg dev_std = 0.226)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009715600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.915
SUFF_SIMPLE for r=0.4 class 0.0 = 0.865 +- 0.225 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.93 +- 0.225 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all KL = 0.884 +- 0.225 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.4 all L1 = 0.898 +- 0.193 (in-sample avg dev_std = 0.225)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009750400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.916
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.221 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.932 +- 0.221 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.8 all KL = 0.891 +- 0.221 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.8 all L1 = 0.901 +- 0.193 (in-sample avg dev_std = 0.207)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.025713
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.638
SUFF_SIMPLE for r=0.05 class 0.0 = 0.906 +- 0.290 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.842 +- 0.290 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.05 all KL = 0.855 +- 0.290 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.05 all L1 = 0.875 +- 0.228 (in-sample avg dev_std = 0.267)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0365034
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.637
SUFF_SIMPLE for r=0.1 class 0.0 = 0.907 +- 0.289 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.842 +- 0.289 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.1 all KL = 0.857 +- 0.289 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.1 all L1 = 0.875 +- 0.229 (in-sample avg dev_std = 0.261)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0490452
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.638
SUFF_SIMPLE for r=0.2 class 0.0 = 0.908 +- 0.285 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.847 +- 0.285 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.2 all KL = 0.862 +- 0.285 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.2 all L1 = 0.878 +- 0.230 (in-sample avg dev_std = 0.231)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0634418
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.647
SUFF_SIMPLE for r=0.4 class 0.0 = 0.917 +- 0.254 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.87 +- 0.254 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all KL = 0.888 +- 0.254 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.4 all L1 = 0.894 +- 0.214 (in-sample avg dev_std = 0.197)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918420000000001
len(reference) = 4980
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.652
SUFF_SIMPLE for r=0.8 class 0.0 = 0.941 +- 0.209 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.892 +- 0.209 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.8 all KL = 0.924 +- 0.209 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.188 (in-sample avg dev_std = 0.132)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034836
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.997
NEC for r=0.05 class 0.0 = 0.015 +- 0.046 (in-sample avg dev_std = 0.028)
NEC for r=0.05 class 1.0 = 0.002 +- 0.046 (in-sample avg dev_std = 0.028)
NEC for r=0.05 all KL = 0.006 +- 0.046 (in-sample avg dev_std = 0.028)
NEC for r=0.05 all L1 = 0.008 +- 0.052 (in-sample avg dev_std = 0.028)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045554000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.995
NEC for r=0.1 class 0.0 = 0.015 +- 0.066 (in-sample avg dev_std = 0.049)
NEC for r=0.1 class 1.0 = 0.005 +- 0.066 (in-sample avg dev_std = 0.049)
NEC for r=0.1 all KL = 0.008 +- 0.066 (in-sample avg dev_std = 0.049)
NEC for r=0.1 all L1 = 0.009 +- 0.061 (in-sample avg dev_std = 0.049)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059278000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.997
NEC for r=0.2 class 0.0 = 0.015 +- 0.056 (in-sample avg dev_std = 0.065)
NEC for r=0.2 class 1.0 = 0.003 +- 0.056 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all KL = 0.007 +- 0.056 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all L1 = 0.008 +- 0.049 (in-sample avg dev_std = 0.065)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070852
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.996
NEC for r=0.4 class 0.0 = 0.015 +- 0.060 (in-sample avg dev_std = 0.066)
NEC for r=0.4 class 1.0 = 0.003 +- 0.060 (in-sample avg dev_std = 0.066)
NEC for r=0.4 all KL = 0.009 +- 0.060 (in-sample avg dev_std = 0.066)
NEC for r=0.4 all L1 = 0.009 +- 0.051 (in-sample avg dev_std = 0.066)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.997
NEC for r=0.8 class 0.0 = 0.013 +- 0.050 (in-sample avg dev_std = 0.064)
NEC for r=0.8 class 1.0 = 0.004 +- 0.050 (in-sample avg dev_std = 0.064)
NEC for r=0.8 all KL = 0.008 +- 0.050 (in-sample avg dev_std = 0.064)
NEC for r=0.8 all L1 = 0.008 +- 0.042 (in-sample avg dev_std = 0.064)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085098
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.938
NEC for r=0.05 class 0.0 = 0.06 +- 0.105 (in-sample avg dev_std = 0.118)
NEC for r=0.05 class 1.0 = 0.047 +- 0.105 (in-sample avg dev_std = 0.118)
NEC for r=0.05 all KL = 0.036 +- 0.105 (in-sample avg dev_std = 0.118)
NEC for r=0.05 all L1 = 0.054 +- 0.127 (in-sample avg dev_std = 0.118)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091046
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.938
NEC for r=0.1 class 0.0 = 0.06 +- 0.105 (in-sample avg dev_std = 0.132)
NEC for r=0.1 class 1.0 = 0.048 +- 0.105 (in-sample avg dev_std = 0.132)
NEC for r=0.1 all KL = 0.038 +- 0.105 (in-sample avg dev_std = 0.132)
NEC for r=0.1 all L1 = 0.054 +- 0.125 (in-sample avg dev_std = 0.132)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009589
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.937
NEC for r=0.2 class 0.0 = 0.061 +- 0.104 (in-sample avg dev_std = 0.137)
NEC for r=0.2 class 1.0 = 0.048 +- 0.104 (in-sample avg dev_std = 0.137)
NEC for r=0.2 all KL = 0.039 +- 0.104 (in-sample avg dev_std = 0.137)
NEC for r=0.2 all L1 = 0.054 +- 0.124 (in-sample avg dev_std = 0.137)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009715600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.938
NEC for r=0.4 class 0.0 = 0.06 +- 0.104 (in-sample avg dev_std = 0.143)
NEC for r=0.4 class 1.0 = 0.049 +- 0.104 (in-sample avg dev_std = 0.143)
NEC for r=0.4 all KL = 0.04 +- 0.104 (in-sample avg dev_std = 0.143)
NEC for r=0.4 all L1 = 0.055 +- 0.122 (in-sample avg dev_std = 0.143)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009750400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.937
NEC for r=0.8 class 0.0 = 0.061 +- 0.103 (in-sample avg dev_std = 0.145)
NEC for r=0.8 class 1.0 = 0.049 +- 0.103 (in-sample avg dev_std = 0.145)
NEC for r=0.8 all KL = 0.04 +- 0.103 (in-sample avg dev_std = 0.145)
NEC for r=0.8 all L1 = 0.055 +- 0.123 (in-sample avg dev_std = 0.145)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.025713
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.658
NEC for r=0.05 class 0.0 = 0.031 +- 0.141 (in-sample avg dev_std = 0.070)
NEC for r=0.05 class 1.0 = 0.069 +- 0.141 (in-sample avg dev_std = 0.070)
NEC for r=0.05 all KL = 0.036 +- 0.141 (in-sample avg dev_std = 0.070)
NEC for r=0.05 all L1 = 0.05 +- 0.141 (in-sample avg dev_std = 0.070)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0365034
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.651
NEC for r=0.1 class 0.0 = 0.042 +- 0.161 (in-sample avg dev_std = 0.096)
NEC for r=0.1 class 1.0 = 0.073 +- 0.161 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all KL = 0.046 +- 0.161 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all L1 = 0.057 +- 0.154 (in-sample avg dev_std = 0.096)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0490452
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.647
NEC for r=0.2 class 0.0 = 0.052 +- 0.188 (in-sample avg dev_std = 0.137)
NEC for r=0.2 class 1.0 = 0.08 +- 0.188 (in-sample avg dev_std = 0.137)
NEC for r=0.2 all KL = 0.06 +- 0.188 (in-sample avg dev_std = 0.137)
NEC for r=0.2 all L1 = 0.066 +- 0.165 (in-sample avg dev_std = 0.137)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0634418
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.648
NEC for r=0.4 class 0.0 = 0.054 +- 0.200 (in-sample avg dev_std = 0.178)
NEC for r=0.4 class 1.0 = 0.089 +- 0.200 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all KL = 0.07 +- 0.200 (in-sample avg dev_std = 0.178)
NEC for r=0.4 all L1 = 0.072 +- 0.169 (in-sample avg dev_std = 0.178)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.657
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918420000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.648
NEC for r=0.8 class 0.0 = 0.063 +- 0.221 (in-sample avg dev_std = 0.235)
NEC for r=0.8 class 1.0 = 0.095 +- 0.221 (in-sample avg dev_std = 0.235)
NEC for r=0.8 all KL = 0.087 +- 0.221 (in-sample avg dev_std = 0.235)
NEC for r=0.8 all L1 = 0.079 +- 0.171 (in-sample avg dev_std = 0.235)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 22:24:12 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 10:24:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.045
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.072
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.035
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032502
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.977
SUFF_SIMPLE for r=0.05 class 0.0 = 0.934 +- 0.182 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.991 +- 0.182 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.05 all KL = 0.95 +- 0.182 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.05 all L1 = 0.966 +- 0.124 (in-sample avg dev_std = 0.165)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045287999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.973
SUFF_SIMPLE for r=0.1 class 0.0 = 0.927 +- 0.198 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.198 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.1 all KL = 0.936 +- 0.198 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.1 all L1 = 0.96 +- 0.125 (in-sample avg dev_std = 0.190)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055628
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.971
SUFF_SIMPLE for r=0.2 class 0.0 = 0.923 +- 0.204 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.988 +- 0.204 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 all KL = 0.937 +- 0.204 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.2 all L1 = 0.959 +- 0.135 (in-sample avg dev_std = 0.194)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.072182
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.979
SUFF_SIMPLE for r=0.4 class 0.0 = 0.935 +- 0.176 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.992 +- 0.176 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all KL = 0.952 +- 0.176 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all L1 = 0.966 +- 0.122 (in-sample avg dev_std = 0.166)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.974
SUFF_SIMPLE for r=0.8 class 0.0 = 0.936 +- 0.172 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.992 +- 0.172 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all KL = 0.956 +- 0.172 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all L1 = 0.967 +- 0.132 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008719999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.81
SUFF_SIMPLE for r=0.05 class 0.0 = 0.985 +- 0.285 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.828 +- 0.285 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 all KL = 0.861 +- 0.285 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.05 all L1 = 0.906 +- 0.205 (in-sample avg dev_std = 0.253)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093566
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.807
SUFF_SIMPLE for r=0.1 class 0.0 = 0.982 +- 0.281 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.832 +- 0.281 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.1 all KL = 0.862 +- 0.281 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.1 all L1 = 0.906 +- 0.203 (in-sample avg dev_std = 0.247)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095666
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.807
SUFF_SIMPLE for r=0.2 class 0.0 = 0.983 +- 0.282 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.831 +- 0.282 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.2 all KL = 0.862 +- 0.282 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.2 all L1 = 0.907 +- 0.204 (in-sample avg dev_std = 0.252)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.808
SUFF_SIMPLE for r=0.4 class 0.0 = 0.983 +- 0.282 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.832 +- 0.282 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 all KL = 0.864 +- 0.282 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 all L1 = 0.907 +- 0.204 (in-sample avg dev_std = 0.245)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009791999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.808
SUFF_SIMPLE for r=0.8 class 0.0 = 0.983 +- 0.281 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.832 +- 0.281 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.8 all KL = 0.869 +- 0.281 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.8 all L1 = 0.907 +- 0.208 (in-sample avg dev_std = 0.239)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0257466
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.632
SUFF_SIMPLE for r=0.05 class 0.0 = 0.901 +- 0.310 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.855 +- 0.310 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.05 all KL = 0.838 +- 0.310 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.05 all L1 = 0.878 +- 0.238 (in-sample avg dev_std = 0.273)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035068600000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.629
SUFF_SIMPLE for r=0.1 class 0.0 = 0.901 +- 0.311 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.856 +- 0.311 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all KL = 0.838 +- 0.311 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all L1 = 0.879 +- 0.238 (in-sample avg dev_std = 0.269)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0466994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.631
SUFF_SIMPLE for r=0.2 class 0.0 = 0.902 +- 0.305 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.859 +- 0.305 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all KL = 0.845 +- 0.305 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.2 all L1 = 0.881 +- 0.239 (in-sample avg dev_std = 0.243)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0622812
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.637
SUFF_SIMPLE for r=0.4 class 0.0 = 0.912 +- 0.278 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.886 +- 0.278 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.4 all KL = 0.871 +- 0.278 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.4 all L1 = 0.899 +- 0.217 (in-sample avg dev_std = 0.222)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828580000000002
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.65
SUFF_SIMPLE for r=0.8 class 0.0 = 0.937 +- 0.226 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.916 +- 0.226 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.8 all KL = 0.916 +- 0.226 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.8 all L1 = 0.926 +- 0.185 (in-sample avg dev_std = 0.162)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032502
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.993
NEC for r=0.05 class 0.0 = 0.015 +- 0.066 (in-sample avg dev_std = 0.041)
NEC for r=0.05 class 1.0 = 0.004 +- 0.066 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all KL = 0.008 +- 0.066 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all L1 = 0.009 +- 0.057 (in-sample avg dev_std = 0.041)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045287999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.995
NEC for r=0.1 class 0.0 = 0.013 +- 0.077 (in-sample avg dev_std = 0.076)
NEC for r=0.1 class 1.0 = 0.007 +- 0.077 (in-sample avg dev_std = 0.076)
NEC for r=0.1 all KL = 0.01 +- 0.077 (in-sample avg dev_std = 0.076)
NEC for r=0.1 all L1 = 0.01 +- 0.058 (in-sample avg dev_std = 0.076)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055628
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.989
NEC for r=0.2 class 0.0 = 0.022 +- 0.098 (in-sample avg dev_std = 0.101)
NEC for r=0.2 class 1.0 = 0.006 +- 0.098 (in-sample avg dev_std = 0.101)
NEC for r=0.2 all KL = 0.015 +- 0.098 (in-sample avg dev_std = 0.101)
NEC for r=0.2 all L1 = 0.013 +- 0.070 (in-sample avg dev_std = 0.101)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.072182
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.99
NEC for r=0.4 class 0.0 = 0.022 +- 0.093 (in-sample avg dev_std = 0.096)
NEC for r=0.4 class 1.0 = 0.005 +- 0.093 (in-sample avg dev_std = 0.096)
NEC for r=0.4 all KL = 0.013 +- 0.093 (in-sample avg dev_std = 0.096)
NEC for r=0.4 all L1 = 0.013 +- 0.068 (in-sample avg dev_std = 0.096)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.991
NEC for r=0.8 class 0.0 = 0.023 +- 0.082 (in-sample avg dev_std = 0.086)
NEC for r=0.8 class 1.0 = 0.006 +- 0.082 (in-sample avg dev_std = 0.086)
NEC for r=0.8 all KL = 0.013 +- 0.082 (in-sample avg dev_std = 0.086)
NEC for r=0.8 all L1 = 0.013 +- 0.069 (in-sample avg dev_std = 0.086)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008719999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.781
NEC for r=0.05 class 0.0 = 0.005 +- 0.158 (in-sample avg dev_std = 0.144)
NEC for r=0.05 class 1.0 = 0.093 +- 0.158 (in-sample avg dev_std = 0.144)
NEC for r=0.05 all KL = 0.05 +- 0.158 (in-sample avg dev_std = 0.144)
NEC for r=0.05 all L1 = 0.049 +- 0.144 (in-sample avg dev_std = 0.144)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093566
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.783
NEC for r=0.1 class 0.0 = 0.006 +- 0.169 (in-sample avg dev_std = 0.164)
NEC for r=0.1 class 1.0 = 0.099 +- 0.169 (in-sample avg dev_std = 0.164)
NEC for r=0.1 all KL = 0.058 +- 0.169 (in-sample avg dev_std = 0.164)
NEC for r=0.1 all L1 = 0.053 +- 0.147 (in-sample avg dev_std = 0.164)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095666
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.782
NEC for r=0.2 class 0.0 = 0.006 +- 0.160 (in-sample avg dev_std = 0.162)
NEC for r=0.2 class 1.0 = 0.096 +- 0.160 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all KL = 0.056 +- 0.160 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all L1 = 0.051 +- 0.141 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.782
NEC for r=0.4 class 0.0 = 0.006 +- 0.160 (in-sample avg dev_std = 0.166)
NEC for r=0.4 class 1.0 = 0.097 +- 0.160 (in-sample avg dev_std = 0.166)
NEC for r=0.4 all KL = 0.058 +- 0.160 (in-sample avg dev_std = 0.166)
NEC for r=0.4 all L1 = 0.052 +- 0.141 (in-sample avg dev_std = 0.166)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009791999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.783
NEC for r=0.8 class 0.0 = 0.005 +- 0.161 (in-sample avg dev_std = 0.167)
NEC for r=0.8 class 1.0 = 0.098 +- 0.161 (in-sample avg dev_std = 0.167)
NEC for r=0.8 all KL = 0.058 +- 0.161 (in-sample avg dev_std = 0.167)
NEC for r=0.8 all L1 = 0.052 +- 0.141 (in-sample avg dev_std = 0.167)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0257466
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.658
NEC for r=0.05 class 0.0 = 0.03 +- 0.152 (in-sample avg dev_std = 0.102)
NEC for r=0.05 class 1.0 = 0.057 +- 0.152 (in-sample avg dev_std = 0.102)
NEC for r=0.05 all KL = 0.039 +- 0.152 (in-sample avg dev_std = 0.102)
NEC for r=0.05 all L1 = 0.043 +- 0.135 (in-sample avg dev_std = 0.102)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035068600000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.651
NEC for r=0.1 class 0.0 = 0.042 +- 0.175 (in-sample avg dev_std = 0.118)
NEC for r=0.1 class 1.0 = 0.06 +- 0.175 (in-sample avg dev_std = 0.118)
NEC for r=0.1 all KL = 0.051 +- 0.175 (in-sample avg dev_std = 0.118)
NEC for r=0.1 all L1 = 0.051 +- 0.151 (in-sample avg dev_std = 0.118)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0466994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.646
NEC for r=0.2 class 0.0 = 0.052 +- 0.197 (in-sample avg dev_std = 0.158)
NEC for r=0.2 class 1.0 = 0.066 +- 0.197 (in-sample avg dev_std = 0.158)
NEC for r=0.2 all KL = 0.065 +- 0.197 (in-sample avg dev_std = 0.158)
NEC for r=0.2 all L1 = 0.059 +- 0.161 (in-sample avg dev_std = 0.158)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0622812
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.645
NEC for r=0.4 class 0.0 = 0.06 +- 0.221 (in-sample avg dev_std = 0.185)
NEC for r=0.4 class 1.0 = 0.077 +- 0.221 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all KL = 0.082 +- 0.221 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all L1 = 0.068 +- 0.174 (in-sample avg dev_std = 0.185)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828580000000002
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
NEC for r=0.8 class 0.0 = 0.067 +- 0.240 (in-sample avg dev_std = 0.238)
NEC for r=0.8 class 1.0 = 0.083 +- 0.240 (in-sample avg dev_std = 0.238)
NEC for r=0.8 all KL = 0.097 +- 0.240 (in-sample avg dev_std = 0.238)
NEC for r=0.8 all L1 = 0.075 +- 0.178 (in-sample avg dev_std = 0.238)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 22:39:51 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 10:39:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.069
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.024
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.034
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034603999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.999
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.061 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.061 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.05 all KL = 0.994 +- 0.061 (in-sample avg dev_std = 0.055)
SUFF_SIMPLE for r=0.05 all L1 = 0.998 +- 0.020 (in-sample avg dev_std = 0.055)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046728
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 0.0 = 0.991 +- 0.088 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.088 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.1 all KL = 0.989 +- 0.088 (in-sample avg dev_std = 0.085)
SUFF_SIMPLE for r=0.1 all L1 = 0.996 +- 0.037 (in-sample avg dev_std = 0.085)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056165999999999994
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
SUFF_SIMPLE for r=0.2 class 0.0 = 0.994 +- 0.085 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.085 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.2 all KL = 0.988 +- 0.085 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.2 all L1 = 0.996 +- 0.029 (in-sample avg dev_std = 0.081)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06944800000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.071 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.071 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.4 all KL = 0.992 +- 0.071 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.4 all L1 = 0.997 +- 0.025 (in-sample avg dev_std = 0.068)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.039 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.039 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all KL = 0.997 +- 0.039 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all L1 = 0.999 +- 0.012 (in-sample avg dev_std = 0.031)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0079212
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.768
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.399 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.653 +- 0.399 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.05 all KL = 0.737 +- 0.399 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.05 all L1 = 0.825 +- 0.286 (in-sample avg dev_std = 0.357)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0087958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.767
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.398 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.654 +- 0.398 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.1 all KL = 0.739 +- 0.398 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.1 all L1 = 0.826 +- 0.286 (in-sample avg dev_std = 0.356)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094218
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.767
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.397 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.654 +- 0.397 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.2 all KL = 0.738 +- 0.397 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.2 all L1 = 0.826 +- 0.286 (in-sample avg dev_std = 0.353)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009572
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.766
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.396 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.655 +- 0.396 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all KL = 0.741 +- 0.396 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all L1 = 0.826 +- 0.287 (in-sample avg dev_std = 0.349)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.00968
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.769
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.396 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.658 +- 0.396 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.8 all KL = 0.75 +- 0.396 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.8 all L1 = 0.828 +- 0.290 (in-sample avg dev_std = 0.331)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0240774
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.78
SUFF_SIMPLE for r=0.05 class 0.0 = 0.948 +- 0.256 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.934 +- 0.256 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.05 all KL = 0.904 +- 0.256 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.05 all L1 = 0.941 +- 0.166 (in-sample avg dev_std = 0.216)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.033907799999999995
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.78
SUFF_SIMPLE for r=0.1 class 0.0 = 0.948 +- 0.259 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.932 +- 0.259 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 all KL = 0.902 +- 0.259 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.1 all L1 = 0.94 +- 0.169 (in-sample avg dev_std = 0.219)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.781
SUFF_SIMPLE for r=0.2 class 0.0 = 0.947 +- 0.247 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.936 +- 0.247 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all KL = 0.914 +- 0.247 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all L1 = 0.942 +- 0.174 (in-sample avg dev_std = 0.189)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0606546
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.784
SUFF_SIMPLE for r=0.4 class 0.0 = 0.955 +- 0.211 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.956 +- 0.211 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all KL = 0.935 +- 0.211 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all L1 = 0.955 +- 0.154 (in-sample avg dev_std = 0.184)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.799
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07728800000000001
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.793
SUFF_SIMPLE for r=0.8 class 0.0 = 0.972 +- 0.171 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.961 +- 0.171 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 all KL = 0.958 +- 0.171 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.8 all L1 = 0.966 +- 0.136 (in-sample avg dev_std = 0.119)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034603999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046728
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056165999999999994
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06944800000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.004 (in-sample avg dev_std = 0.002)
NEC for r=0.4 class 1.0 = 0.0 +- 0.004 (in-sample avg dev_std = 0.002)
NEC for r=0.4 all KL = 0.0 +- 0.004 (in-sample avg dev_std = 0.002)
NEC for r=0.4 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.002)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.0 +- 0.002 (in-sample avg dev_std = 0.002)
NEC for r=0.8 class 1.0 = 0.0 +- 0.002 (in-sample avg dev_std = 0.002)
NEC for r=0.8 all KL = 0.0 +- 0.002 (in-sample avg dev_std = 0.002)
NEC for r=0.8 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0079212
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.691
NEC for r=0.05 class 0.0 = 0.0 +- 0.282 (in-sample avg dev_std = 0.229)
NEC for r=0.05 class 1.0 = 0.182 +- 0.282 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all KL = 0.121 +- 0.282 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all L1 = 0.092 +- 0.215 (in-sample avg dev_std = 0.229)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0087958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.688
NEC for r=0.1 class 0.0 = 0.0 +- 0.286 (in-sample avg dev_std = 0.247)
NEC for r=0.1 class 1.0 = 0.184 +- 0.286 (in-sample avg dev_std = 0.247)
NEC for r=0.1 all KL = 0.131 +- 0.286 (in-sample avg dev_std = 0.247)
NEC for r=0.1 all L1 = 0.093 +- 0.211 (in-sample avg dev_std = 0.247)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094218
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.688
NEC for r=0.2 class 0.0 = 0.0 +- 0.289 (in-sample avg dev_std = 0.261)
NEC for r=0.2 class 1.0 = 0.186 +- 0.289 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all KL = 0.137 +- 0.289 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all L1 = 0.094 +- 0.208 (in-sample avg dev_std = 0.261)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009572
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.689
NEC for r=0.4 class 0.0 = 0.0 +- 0.294 (in-sample avg dev_std = 0.267)
NEC for r=0.4 class 1.0 = 0.191 +- 0.294 (in-sample avg dev_std = 0.267)
NEC for r=0.4 all KL = 0.144 +- 0.294 (in-sample avg dev_std = 0.267)
NEC for r=0.4 all L1 = 0.096 +- 0.209 (in-sample avg dev_std = 0.267)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.00968
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.69
NEC for r=0.8 class 0.0 = 0.0 +- 0.297 (in-sample avg dev_std = 0.274)
NEC for r=0.8 class 1.0 = 0.193 +- 0.297 (in-sample avg dev_std = 0.274)
NEC for r=0.8 all KL = 0.149 +- 0.297 (in-sample avg dev_std = 0.274)
NEC for r=0.8 all L1 = 0.097 +- 0.207 (in-sample avg dev_std = 0.274)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0240774
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.799
NEC for r=0.05 class 0.0 = 0.01 +- 0.098 (in-sample avg dev_std = 0.076)
NEC for r=0.05 class 1.0 = 0.021 +- 0.098 (in-sample avg dev_std = 0.076)
NEC for r=0.05 all KL = 0.014 +- 0.098 (in-sample avg dev_std = 0.076)
NEC for r=0.05 all L1 = 0.015 +- 0.086 (in-sample avg dev_std = 0.076)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.033907799999999995
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.796
NEC for r=0.1 class 0.0 = 0.016 +- 0.116 (in-sample avg dev_std = 0.084)
NEC for r=0.1 class 1.0 = 0.022 +- 0.116 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all KL = 0.02 +- 0.116 (in-sample avg dev_std = 0.084)
NEC for r=0.1 all L1 = 0.019 +- 0.096 (in-sample avg dev_std = 0.084)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.791
NEC for r=0.2 class 0.0 = 0.024 +- 0.141 (in-sample avg dev_std = 0.115)
NEC for r=0.2 class 1.0 = 0.023 +- 0.141 (in-sample avg dev_std = 0.115)
NEC for r=0.2 all KL = 0.028 +- 0.141 (in-sample avg dev_std = 0.115)
NEC for r=0.2 all L1 = 0.023 +- 0.109 (in-sample avg dev_std = 0.115)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0606546
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.791
NEC for r=0.4 class 0.0 = 0.029 +- 0.161 (in-sample avg dev_std = 0.149)
NEC for r=0.4 class 1.0 = 0.025 +- 0.161 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all KL = 0.037 +- 0.161 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all L1 = 0.027 +- 0.114 (in-sample avg dev_std = 0.149)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.798
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07728800000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.791
NEC for r=0.8 class 0.0 = 0.031 +- 0.182 (in-sample avg dev_std = 0.175)
NEC for r=0.8 class 1.0 = 0.031 +- 0.182 (in-sample avg dev_std = 0.175)
NEC for r=0.8 all KL = 0.049 +- 0.182 (in-sample avg dev_std = 0.175)
NEC for r=0.8 all L1 = 0.031 +- 0.115 (in-sample avg dev_std = 0.175)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 22:55:20 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 10:55:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.034
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.044
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.069
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 0.0 = 0.991 +- 0.092 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.092 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.05 all KL = 0.987 +- 0.092 (in-sample avg dev_std = 0.086)
SUFF_SIMPLE for r=0.05 all L1 = 0.995 +- 0.042 (in-sample avg dev_std = 0.086)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043786
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
SUFF_SIMPLE for r=0.1 class 0.0 = 0.994 +- 0.082 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.082 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.1 all KL = 0.988 +- 0.082 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.1 all L1 = 0.995 +- 0.035 (in-sample avg dev_std = 0.076)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055574
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.996
SUFF_SIMPLE for r=0.2 class 0.0 = 0.989 +- 0.102 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.102 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all KL = 0.985 +- 0.102 (in-sample avg dev_std = 0.090)
SUFF_SIMPLE for r=0.2 all L1 = 0.994 +- 0.046 (in-sample avg dev_std = 0.090)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06853200000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
SUFF_SIMPLE for r=0.4 class 0.0 = 0.994 +- 0.078 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.997 +- 0.078 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.4 all KL = 0.988 +- 0.078 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.4 all L1 = 0.996 +- 0.031 (in-sample avg dev_std = 0.076)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07941600000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.045 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.045 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.8 all KL = 0.998 +- 0.045 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.8 all L1 = 0.998 +- 0.027 (in-sample avg dev_std = 0.045)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086168
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.691
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.386 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.701 +- 0.386 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.05 all KL = 0.763 +- 0.386 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.05 all L1 = 0.849 +- 0.270 (in-sample avg dev_std = 0.331)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009078600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.69
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.384 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.705 +- 0.384 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 all KL = 0.766 +- 0.384 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 all L1 = 0.851 +- 0.268 (in-sample avg dev_std = 0.331)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094518
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.69
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.385 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.706 +- 0.385 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.2 all KL = 0.768 +- 0.385 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.2 all L1 = 0.852 +- 0.268 (in-sample avg dev_std = 0.332)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096226
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.692
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.387 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.7 +- 0.387 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.4 all KL = 0.762 +- 0.387 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.4 all L1 = 0.849 +- 0.270 (in-sample avg dev_std = 0.330)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.689
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.380 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.709 +- 0.380 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all KL = 0.777 +- 0.380 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all L1 = 0.853 +- 0.270 (in-sample avg dev_std = 0.312)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0267322
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.745
SUFF_SIMPLE for r=0.05 class 0.0 = 0.942 +- 0.276 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.899 +- 0.276 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 all KL = 0.888 +- 0.276 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 all L1 = 0.921 +- 0.202 (in-sample avg dev_std = 0.240)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035812000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.74
SUFF_SIMPLE for r=0.1 class 0.0 = 0.942 +- 0.275 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.898 +- 0.275 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 all KL = 0.89 +- 0.275 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 all L1 = 0.92 +- 0.203 (in-sample avg dev_std = 0.235)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048664400000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.74
SUFF_SIMPLE for r=0.2 class 0.0 = 0.944 +- 0.261 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.903 +- 0.261 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all KL = 0.897 +- 0.261 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all L1 = 0.924 +- 0.200 (in-sample avg dev_std = 0.192)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.062375
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.757
SUFF_SIMPLE for r=0.4 class 0.0 = 0.951 +- 0.212 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.946 +- 0.212 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all KL = 0.929 +- 0.212 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all L1 = 0.948 +- 0.158 (in-sample avg dev_std = 0.190)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.771
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0787262
len(reference) = 4988
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.763
SUFF_SIMPLE for r=0.8 class 0.0 = 0.966 +- 0.179 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.952 +- 0.179 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.179 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all L1 = 0.959 +- 0.142 (in-sample avg dev_std = 0.143)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.029 (in-sample avg dev_std = 0.031)
NEC for r=0.05 class 1.0 = 0.001 +- 0.029 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all KL = 0.002 +- 0.029 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all L1 = 0.001 +- 0.010 (in-sample avg dev_std = 0.031)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043786
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.002 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.0 +- 0.002 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.0 +- 0.002 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055574
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.014 (in-sample avg dev_std = 0.025)
NEC for r=0.2 class 1.0 = 0.001 +- 0.014 (in-sample avg dev_std = 0.025)
NEC for r=0.2 all KL = 0.001 +- 0.014 (in-sample avg dev_std = 0.025)
NEC for r=0.2 all L1 = 0.001 +- 0.008 (in-sample avg dev_std = 0.025)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06853200000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.006 (in-sample avg dev_std = 0.007)
NEC for r=0.4 class 1.0 = 0.0 +- 0.006 (in-sample avg dev_std = 0.007)
NEC for r=0.4 all KL = 0.0 +- 0.006 (in-sample avg dev_std = 0.007)
NEC for r=0.4 all L1 = 0.0 +- 0.003 (in-sample avg dev_std = 0.007)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07941600000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)
NEC for r=0.8 class 1.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all KL = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086168
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.62
NEC for r=0.05 class 0.0 = 0.0 +- 0.261 (in-sample avg dev_std = 0.196)
NEC for r=0.05 class 1.0 = 0.147 +- 0.261 (in-sample avg dev_std = 0.196)
NEC for r=0.05 all KL = 0.101 +- 0.261 (in-sample avg dev_std = 0.196)
NEC for r=0.05 all L1 = 0.074 +- 0.197 (in-sample avg dev_std = 0.196)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009078600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.619
NEC for r=0.1 class 0.0 = 0.0 +- 0.267 (in-sample avg dev_std = 0.214)
NEC for r=0.1 class 1.0 = 0.149 +- 0.267 (in-sample avg dev_std = 0.214)
NEC for r=0.1 all KL = 0.11 +- 0.267 (in-sample avg dev_std = 0.214)
NEC for r=0.1 all L1 = 0.075 +- 0.192 (in-sample avg dev_std = 0.214)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094518
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.619
NEC for r=0.2 class 0.0 = 0.0 +- 0.275 (in-sample avg dev_std = 0.236)
NEC for r=0.2 class 1.0 = 0.154 +- 0.275 (in-sample avg dev_std = 0.236)
NEC for r=0.2 all KL = 0.12 +- 0.275 (in-sample avg dev_std = 0.236)
NEC for r=0.2 all L1 = 0.078 +- 0.190 (in-sample avg dev_std = 0.236)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096226
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.62
NEC for r=0.4 class 0.0 = 0.0 +- 0.276 (in-sample avg dev_std = 0.237)
NEC for r=0.4 class 1.0 = 0.155 +- 0.276 (in-sample avg dev_std = 0.237)
NEC for r=0.4 all KL = 0.122 +- 0.276 (in-sample avg dev_std = 0.237)
NEC for r=0.4 all L1 = 0.078 +- 0.191 (in-sample avg dev_std = 0.237)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.619
NEC for r=0.8 class 0.0 = 0.0 +- 0.278 (in-sample avg dev_std = 0.242)
NEC for r=0.8 class 1.0 = 0.156 +- 0.278 (in-sample avg dev_std = 0.242)
NEC for r=0.8 all KL = 0.126 +- 0.278 (in-sample avg dev_std = 0.242)
NEC for r=0.8 all L1 = 0.078 +- 0.188 (in-sample avg dev_std = 0.242)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0267322
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.769
NEC for r=0.05 class 0.0 = 0.015 +- 0.116 (in-sample avg dev_std = 0.093)
NEC for r=0.05 class 1.0 = 0.028 +- 0.116 (in-sample avg dev_std = 0.093)
NEC for r=0.05 all KL = 0.021 +- 0.116 (in-sample avg dev_std = 0.093)
NEC for r=0.05 all L1 = 0.021 +- 0.099 (in-sample avg dev_std = 0.093)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035812000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.768
NEC for r=0.1 class 0.0 = 0.022 +- 0.140 (in-sample avg dev_std = 0.114)
NEC for r=0.1 class 1.0 = 0.031 +- 0.140 (in-sample avg dev_std = 0.114)
NEC for r=0.1 all KL = 0.03 +- 0.140 (in-sample avg dev_std = 0.114)
NEC for r=0.1 all L1 = 0.026 +- 0.110 (in-sample avg dev_std = 0.114)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048664400000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.763
NEC for r=0.2 class 0.0 = 0.031 +- 0.157 (in-sample avg dev_std = 0.137)
NEC for r=0.2 class 1.0 = 0.031 +- 0.157 (in-sample avg dev_std = 0.137)
NEC for r=0.2 all KL = 0.037 +- 0.157 (in-sample avg dev_std = 0.137)
NEC for r=0.2 all L1 = 0.031 +- 0.122 (in-sample avg dev_std = 0.137)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.062375
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.764
NEC for r=0.4 class 0.0 = 0.032 +- 0.163 (in-sample avg dev_std = 0.149)
NEC for r=0.4 class 1.0 = 0.033 +- 0.163 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all KL = 0.042 +- 0.163 (in-sample avg dev_std = 0.149)
NEC for r=0.4 all L1 = 0.033 +- 0.121 (in-sample avg dev_std = 0.149)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.771
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0787262
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.758
NEC for r=0.8 class 0.0 = 0.036 +- 0.191 (in-sample avg dev_std = 0.181)
NEC for r=0.8 class 1.0 = 0.045 +- 0.191 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all KL = 0.055 +- 0.191 (in-sample avg dev_std = 0.181)
NEC for r=0.8 all L1 = 0.041 +- 0.138 (in-sample avg dev_std = 0.181)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:11:24 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:11:24 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.041
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.007
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.008
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.008
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.007
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.020
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.027
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.035
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.048
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.067


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03554
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 0.0 = 0.984 +- 0.123 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.123 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.05 all KL = 0.978 +- 0.123 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.05 all L1 = 0.993 +- 0.047 (in-sample avg dev_std = 0.113)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04098
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.994
SUFF_SIMPLE for r=0.1 class 0.0 = 0.983 +- 0.123 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.123 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 all KL = 0.979 +- 0.123 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 all L1 = 0.992 +- 0.054 (in-sample avg dev_std = 0.106)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047308
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.997
SUFF_SIMPLE for r=0.2 class 0.0 = 0.992 +- 0.072 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.072 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.2 all KL = 0.992 +- 0.072 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.2 all L1 = 0.996 +- 0.042 (in-sample avg dev_std = 0.051)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.065416
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
SUFF_SIMPLE for r=0.4 class 0.0 = 0.992 +- 0.077 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.077 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.4 all KL = 0.993 +- 0.077 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.4 all L1 = 0.996 +- 0.042 (in-sample avg dev_std = 0.074)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07919200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
SUFF_SIMPLE for r=0.8 class 0.0 = 0.991 +- 0.090 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.090 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.8 all KL = 0.989 +- 0.090 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.8 all L1 = 0.996 +- 0.034 (in-sample avg dev_std = 0.065)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0074828
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.993
SUFF_SIMPLE for r=0.05 class 0.0 = 0.976 +- 0.178 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.178 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.05 all KL = 0.958 +- 0.178 (in-sample avg dev_std = 0.161)
SUFF_SIMPLE for r=0.05 all L1 = 0.987 +- 0.059 (in-sample avg dev_std = 0.161)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0081988
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.993
SUFF_SIMPLE for r=0.1 class 0.0 = 0.975 +- 0.182 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.182 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.1 all KL = 0.956 +- 0.182 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.1 all L1 = 0.986 +- 0.059 (in-sample avg dev_std = 0.164)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0085554
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.993
SUFF_SIMPLE for r=0.2 class 0.0 = 0.977 +- 0.175 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.175 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.2 all KL = 0.959 +- 0.175 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.2 all L1 = 0.987 +- 0.056 (in-sample avg dev_std = 0.157)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0083574
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.993
SUFF_SIMPLE for r=0.4 class 0.0 = 0.977 +- 0.173 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.173 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all KL = 0.96 +- 0.173 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all L1 = 0.987 +- 0.058 (in-sample avg dev_std = 0.157)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0065260000000000006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.988
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.197 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.989 +- 0.197 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.197 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.8 all L1 = 0.98 +- 0.087 (in-sample avg dev_std = 0.192)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.019841
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.952
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.177 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.997 +- 0.177 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.05 all KL = 0.963 +- 0.177 (in-sample avg dev_std = 0.125)
SUFF_SIMPLE for r=0.05 all L1 = 0.975 +- 0.129 (in-sample avg dev_std = 0.125)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0268306
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.953
SUFF_SIMPLE for r=0.1 class 0.0 = 0.953 +- 0.176 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.997 +- 0.176 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.176 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.1 all L1 = 0.975 +- 0.131 (in-sample avg dev_std = 0.124)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0347138
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.953
SUFF_SIMPLE for r=0.2 class 0.0 = 0.955 +- 0.168 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.168 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.2 all KL = 0.967 +- 0.168 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.2 all L1 = 0.977 +- 0.128 (in-sample avg dev_std = 0.109)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0477758
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.952
SUFF_SIMPLE for r=0.4 class 0.0 = 0.955 +- 0.171 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.171 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.4 all KL = 0.967 +- 0.171 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.4 all L1 = 0.976 +- 0.128 (in-sample avg dev_std = 0.115)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06650260000000001
len(reference) = 4977
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.934
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.287 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.917 +- 0.287 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.8 all KL = 0.881 +- 0.287 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.8 all L1 = 0.943 +- 0.156 (in-sample avg dev_std = 0.291)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03554
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04098
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047308
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.065416
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.4 class 1.0 = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.4 all KL = 0.0 +- 0.010 (in-sample avg dev_std = 0.006)
NEC for r=0.4 all L1 = 0.0 +- 0.003 (in-sample avg dev_std = 0.006)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07919200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0074828
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 0.0 = 0.002 +- 0.056 (in-sample avg dev_std = 0.046)
NEC for r=0.05 class 1.0 = 0.002 +- 0.056 (in-sample avg dev_std = 0.046)
NEC for r=0.05 all KL = 0.004 +- 0.056 (in-sample avg dev_std = 0.046)
NEC for r=0.05 all L1 = 0.002 +- 0.029 (in-sample avg dev_std = 0.046)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0081988
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.999
NEC for r=0.1 class 0.0 = 0.002 +- 0.055 (in-sample avg dev_std = 0.046)
NEC for r=0.1 class 1.0 = 0.002 +- 0.055 (in-sample avg dev_std = 0.046)
NEC for r=0.1 all KL = 0.004 +- 0.055 (in-sample avg dev_std = 0.046)
NEC for r=0.1 all L1 = 0.002 +- 0.026 (in-sample avg dev_std = 0.046)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0085554
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.999
NEC for r=0.2 class 0.0 = 0.003 +- 0.065 (in-sample avg dev_std = 0.055)
NEC for r=0.2 class 1.0 = 0.002 +- 0.065 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all KL = 0.006 +- 0.065 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all L1 = 0.002 +- 0.027 (in-sample avg dev_std = 0.055)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0083574
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.004 +- 0.073 (in-sample avg dev_std = 0.061)
NEC for r=0.4 class 1.0 = 0.002 +- 0.073 (in-sample avg dev_std = 0.061)
NEC for r=0.4 all KL = 0.007 +- 0.073 (in-sample avg dev_std = 0.061)
NEC for r=0.4 all L1 = 0.003 +- 0.029 (in-sample avg dev_std = 0.061)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0065260000000000006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.003 +- 0.063 (in-sample avg dev_std = 0.052)
NEC for r=0.8 class 1.0 = 0.002 +- 0.063 (in-sample avg dev_std = 0.052)
NEC for r=0.8 all KL = 0.006 +- 0.063 (in-sample avg dev_std = 0.052)
NEC for r=0.8 all L1 = 0.002 +- 0.028 (in-sample avg dev_std = 0.052)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.019841
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.971
NEC for r=0.05 class 0.0 = 0.01 +- 0.068 (in-sample avg dev_std = 0.012)
NEC for r=0.05 class 1.0 = 0.0 +- 0.068 (in-sample avg dev_std = 0.012)
NEC for r=0.05 all KL = 0.006 +- 0.068 (in-sample avg dev_std = 0.012)
NEC for r=0.05 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.012)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0268306
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.968
NEC for r=0.1 class 0.0 = 0.017 +- 0.090 (in-sample avg dev_std = 0.023)
NEC for r=0.1 class 1.0 = 0.0 +- 0.090 (in-sample avg dev_std = 0.023)
NEC for r=0.1 all KL = 0.01 +- 0.090 (in-sample avg dev_std = 0.023)
NEC for r=0.1 all L1 = 0.009 +- 0.077 (in-sample avg dev_std = 0.023)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0347138
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.964
NEC for r=0.2 class 0.0 = 0.024 +- 0.116 (in-sample avg dev_std = 0.070)
NEC for r=0.2 class 1.0 = 0.0 +- 0.116 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all KL = 0.016 +- 0.116 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all L1 = 0.012 +- 0.092 (in-sample avg dev_std = 0.070)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0477758
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.963
NEC for r=0.4 class 0.0 = 0.027 +- 0.128 (in-sample avg dev_std = 0.091)
NEC for r=0.4 class 1.0 = 0.0 +- 0.128 (in-sample avg dev_std = 0.091)
NEC for r=0.4 all KL = 0.019 +- 0.128 (in-sample avg dev_std = 0.091)
NEC for r=0.4 all L1 = 0.014 +- 0.095 (in-sample avg dev_std = 0.091)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.975
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06650260000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.963
NEC for r=0.8 class 0.0 = 0.029 +- 0.135 (in-sample avg dev_std = 0.106)
NEC for r=0.8 class 1.0 = 0.0 +- 0.135 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all KL = 0.022 +- 0.135 (in-sample avg dev_std = 0.106)
NEC for r=0.8 all L1 = 0.015 +- 0.095 (in-sample avg dev_std = 0.106)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.967, 0.968, 0.964, 0.969, 0.986], 'all_L1': [0.982, 0.982, 0.979, 0.982, 0.989]}), defaultdict(<class 'list'>, {'all_KL': [0.973, 0.971, 0.965, 0.974, 0.97], 'all_L1': [0.99, 0.988, 0.987, 0.99, 0.988]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.98, 0.972, 0.983, 0.98], 'all_L1': [0.99, 0.993, 0.991, 0.994, 0.99]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.941, 0.94, 0.949, 0.97], 'all_L1': [0.978, 0.978, 0.978, 0.98, 0.986]}), defaultdict(<class 'list'>, {'all_KL': [0.971, 0.974, 0.972, 0.982, 0.984], 'all_L1': [0.989, 0.989, 0.989, 0.993, 0.993]}), defaultdict(<class 'list'>, {'all_KL': [0.951, 0.96, 0.952, 0.958, 0.972], 'all_L1': [0.971, 0.973, 0.972, 0.973, 0.979]}), defaultdict(<class 'list'>, {'all_KL': [0.95, 0.936, 0.937, 0.952, 0.956], 'all_L1': [0.966, 0.96, 0.959, 0.966, 0.967]}), defaultdict(<class 'list'>, {'all_KL': [0.994, 0.989, 0.988, 0.992, 0.997], 'all_L1': [0.998, 0.996, 0.996, 0.997, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.987, 0.988, 0.985, 0.988, 0.998], 'all_L1': [0.995, 0.995, 0.994, 0.996, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.979, 0.992, 0.993, 0.989], 'all_L1': [0.993, 0.992, 0.996, 0.996, 0.996]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.007, 0.007, 0.006, 0.007, 0.006], 'all_L1': [0.007, 0.006, 0.005, 0.006, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.002, 0.003, 0.004, 0.009], 'all_L1': [0.001, 0.001, 0.001, 0.001, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.002, 0.002], 'all_L1': [0.0, 0.0, 0.0, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.014, 0.012, 0.008, 0.013], 'all_L1': [0.004, 0.005, 0.004, 0.003, 0.004]}), defaultdict(<class 'list'>, {'all_KL': [0.001, 0.002, 0.003, 0.002, 0.003], 'all_L1': [0.0, 0.001, 0.001, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.006, 0.008, 0.007, 0.009, 0.008], 'all_L1': [0.008, 0.009, 0.008, 0.009, 0.008]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.01, 0.015, 0.013, 0.013], 'all_L1': [0.009, 0.01, 0.013, 0.013, 0.013]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.0, 0.001, 0.0, 0.0], 'all_L1': [0.001, 0.0, 0.001, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0, 0.0]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.971, 0.969, 0.969, 0.97, 0.972], 'all_L1': [0.972, 0.971, 0.971, 0.972, 0.973]}), defaultdict(<class 'list'>, {'all_KL': [0.958, 0.957, 0.96, 0.956, 0.961], 'all_L1': [0.986, 0.986, 0.986, 0.985, 0.986]}), defaultdict(<class 'list'>, {'all_KL': [0.944, 0.945, 0.946, 0.946, 0.948], 'all_L1': [0.98, 0.979, 0.98, 0.98, 0.979]}), defaultdict(<class 'list'>, {'all_KL': [0.814, 0.816, 0.819, 0.819, 0.827], 'all_L1': [0.922, 0.924, 0.923, 0.925, 0.924]}), defaultdict(<class 'list'>, {'all_KL': [0.719, 0.72, 0.72, 0.719, 0.723], 'all_L1': [0.787, 0.789, 0.788, 0.787, 0.789]}), defaultdict(<class 'list'>, {'all_KL': [0.885, 0.884, 0.883, 0.884, 0.891], 'all_L1': [0.898, 0.898, 0.898, 0.898, 0.901]}), defaultdict(<class 'list'>, {'all_KL': [0.861, 0.862, 0.862, 0.864, 0.869], 'all_L1': [0.906, 0.906, 0.907, 0.907, 0.907]}), defaultdict(<class 'list'>, {'all_KL': [0.737, 0.739, 0.738, 0.741, 0.75], 'all_L1': [0.825, 0.826, 0.826, 0.826, 0.828]}), defaultdict(<class 'list'>, {'all_KL': [0.763, 0.766, 0.768, 0.762, 0.777], 'all_L1': [0.849, 0.851, 0.852, 0.849, 0.853]}), defaultdict(<class 'list'>, {'all_KL': [0.958, 0.956, 0.959, 0.96, 0.95], 'all_L1': [0.987, 0.986, 0.987, 0.987, 0.98]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.006, 0.006, 0.006, 0.006, 0.008], 'all_L1': [0.012, 0.012, 0.012, 0.012, 0.013]}), defaultdict(<class 'list'>, {'all_KL': [0.006, 0.007, 0.007, 0.007, 0.006], 'all_L1': [0.003, 0.003, 0.003, 0.003, 0.003]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.011, 0.011, 0.01, 0.013], 'all_L1': [0.006, 0.006, 0.006, 0.006, 0.007]}), defaultdict(<class 'list'>, {'all_KL': [0.048, 0.058, 0.073, 0.075, 0.079], 'all_L1': [0.02, 0.021, 0.025, 0.024, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.164, 0.177, 0.177, 0.183, 0.186], 'all_L1': [0.121, 0.125, 0.124, 0.126, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.038, 0.039, 0.04, 0.04], 'all_L1': [0.054, 0.054, 0.054, 0.055, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.05, 0.058, 0.056, 0.058, 0.058], 'all_L1': [0.049, 0.053, 0.051, 0.052, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.121, 0.131, 0.137, 0.144, 0.149], 'all_L1': [0.092, 0.093, 0.094, 0.096, 0.097]}), defaultdict(<class 'list'>, {'all_KL': [0.101, 0.11, 0.12, 0.122, 0.126], 'all_L1': [0.074, 0.075, 0.078, 0.078, 0.078]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.004, 0.006, 0.007, 0.006], 'all_L1': [0.002, 0.002, 0.002, 0.003, 0.002]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.875, 0.879, 0.884, 0.902, 0.939], 'all_L1': [0.878, 0.88, 0.882, 0.897, 0.921]}), defaultdict(<class 'list'>, {'all_KL': [0.941, 0.943, 0.947, 0.949, 0.96], 'all_L1': [0.957, 0.958, 0.959, 0.96, 0.966]}), defaultdict(<class 'list'>, {'all_KL': [0.946, 0.944, 0.949, 0.955, 0.974], 'all_L1': [0.962, 0.961, 0.963, 0.966, 0.976]}), defaultdict(<class 'list'>, {'all_KL': [0.93, 0.932, 0.944, 0.967, 0.979], 'all_L1': [0.958, 0.958, 0.962, 0.976, 0.983]}), defaultdict(<class 'list'>, {'all_KL': [0.943, 0.946, 0.949, 0.954, 0.97], 'all_L1': [0.958, 0.958, 0.959, 0.962, 0.97]}), defaultdict(<class 'list'>, {'all_KL': [0.855, 0.857, 0.862, 0.888, 0.924], 'all_L1': [0.875, 0.875, 0.878, 0.894, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.838, 0.838, 0.845, 0.871, 0.916], 'all_L1': [0.878, 0.879, 0.881, 0.899, 0.926]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.902, 0.914, 0.935, 0.958], 'all_L1': [0.941, 0.94, 0.942, 0.955, 0.966]}), defaultdict(<class 'list'>, {'all_KL': [0.888, 0.89, 0.897, 0.929, 0.95], 'all_L1': [0.921, 0.92, 0.924, 0.948, 0.959]}), defaultdict(<class 'list'>, {'all_KL': [0.963, 0.964, 0.967, 0.967, 0.881], 'all_L1': [0.975, 0.975, 0.977, 0.976, 0.943]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.032, 0.04, 0.049, 0.057, 0.069], 'all_L1': [0.049, 0.055, 0.061, 0.065, 0.071]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.02, 0.028, 0.033, 0.035], 'all_L1': [0.017, 0.019, 0.023, 0.025, 0.025]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.014, 0.023, 0.028, 0.033], 'all_L1': [0.01, 0.013, 0.019, 0.021, 0.022]}), defaultdict(<class 'list'>, {'all_KL': [0.009, 0.014, 0.022, 0.026, 0.034], 'all_L1': [0.008, 0.012, 0.016, 0.017, 0.02]}), defaultdict(<class 'list'>, {'all_KL': [0.013, 0.016, 0.026, 0.029, 0.032], 'all_L1': [0.015, 0.017, 0.023, 0.023, 0.024]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.046, 0.06, 0.07, 0.087], 'all_L1': [0.05, 0.057, 0.066, 0.072, 0.079]}), defaultdict(<class 'list'>, {'all_KL': [0.039, 0.051, 0.065, 0.082, 0.097], 'all_L1': [0.043, 0.051, 0.059, 0.068, 0.075]}), defaultdict(<class 'list'>, {'all_KL': [0.014, 0.02, 0.028, 0.037, 0.049], 'all_L1': [0.015, 0.019, 0.023, 0.027, 0.031]}), defaultdict(<class 'list'>, {'all_KL': [0.021, 0.03, 0.037, 0.042, 0.055], 'all_L1': [0.021, 0.026, 0.031, 0.033, 0.041]}), defaultdict(<class 'list'>, {'all_KL': [0.006, 0.01, 0.016, 0.019, 0.022], 'all_L1': [0.005, 0.009, 0.012, 0.014, 0.015]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.985 +- 0.010, 0.985 +- 0.011, 0.984 +- 0.011, 0.987 +- 0.010, 0.988 +- 0.009
suff_simple class all_KL  =  0.968 +- 0.016, 0.969 +- 0.017, 0.967 +- 0.018, 0.974 +- 0.016, 0.980 +- 0.013
[[0.9907500147819519, 0.9900000095367432, 0.9877499938011169, 0.9907500147819519, 0.9940000176429749], [0.9932500123977661, 0.9922500252723694, 0.9912499785423279, 0.9934999942779541, 0.9909999966621399], [0.9940000176429749, 0.9962499737739563, 0.9955000281333923, 0.9959999918937683, 0.9925000071525574], [0.9854999780654907, 0.9867500066757202, 0.9862499833106995, 0.9872499704360962, 0.9897500276565552], [0.9929999709129333, 0.9927499890327454, 0.9927499890327454, 0.9952499866485596, 0.9957500100135803], [0.984250009059906, 0.9867500066757202, 0.9835000038146973, 0.9867500066757202, 0.9897500276565552], [0.9767500162124634, 0.9729999899864197, 0.9714999794960022, 0.9787499904632568, 0.9742500185966492], [0.9990000128746033, 0.9972500205039978, 0.9982500076293945, 0.9987499713897705, 0.9994999766349792], [0.9962499737739563, 0.9977499842643738, 0.9959999918937683, 0.9980000257492065, 0.9990000128746033], [0.9955000281333923, 0.9942499995231628, 0.9972500205039978, 0.9975000023841858, 0.9984999895095825]]
[[0.967, 0.968, 0.964, 0.969, 0.986], [0.973, 0.971, 0.965, 0.974, 0.97], [0.968, 0.98, 0.972, 0.983, 0.98], [0.941, 0.941, 0.94, 0.949, 0.97], [0.971, 0.974, 0.972, 0.982, 0.984], [0.951, 0.96, 0.952, 0.958, 0.972], [0.95, 0.936, 0.937, 0.952, 0.956], [0.994, 0.989, 0.988, 0.992, 0.997], [0.987, 0.988, 0.985, 0.988, 0.998], [0.978, 0.979, 0.992, 0.993, 0.989]]
suff_simple_acc_int  =  0.991 +- 0.006, 0.991 +- 0.007, 0.990 +- 0.008, 0.992 +- 0.006, 0.992 +- 0.007
nec class all_L1  =  0.003 +- 0.003, 0.003 +- 0.004, 0.003 +- 0.004, 0.003 +- 0.004, 0.004 +- 0.004
nec class all_KL  =  0.004 +- 0.003, 0.004 +- 0.005, 0.005 +- 0.005, 0.004 +- 0.004, 0.005 +- 0.005
[[0.9940000176429749, 0.9944999814033508, 0.9957500100135803, 0.9959999918937683, 0.9977499842643738], [0.9992499947547913, 0.9992499947547913, 0.9994999766349792, 0.9990000128746033, 0.9982500076293945], [1.0, 1.0, 1.0, 0.999750018119812, 0.999750018119812], [0.9982500076293945, 0.9975000023841858, 0.9977499842643738, 0.9987499713897705, 0.9980000257492065], [1.0, 1.0, 0.999750018119812, 1.0, 0.9994999766349792], [0.996999979019165, 0.9952499866485596, 0.996999979019165, 0.9962499737739563, 0.996749997138977], [0.9932500123977661, 0.9950000047683716, 0.9894999861717224, 0.9900000095367432, 0.9907500147819519], [1.0, 1.0, 1.0, 1.0, 1.0], [0.999750018119812, 1.0, 0.999750018119812, 1.0, 1.0], [1.0, 1.0, 1.0, 1.0, 1.0]]
[[0.007, 0.007, 0.006, 0.007, 0.006], [0.002, 0.002, 0.003, 0.004, 0.009], [0.0, 0.0, 0.0, 0.002, 0.002], [0.009, 0.014, 0.012, 0.008, 0.013], [0.001, 0.002, 0.003, 0.002, 0.003], [0.006, 0.008, 0.007, 0.009, 0.008], [0.008, 0.01, 0.015, 0.013, 0.013], [0.0, 0.0, 0.0, 0.0, 0.0], [0.002, 0.0, 0.001, 0.0, 0.0], [0.0, 0.0, 0.0, 0.0, 0.0]]
nec_acc_int  =  0.998 +- 0.002, 0.998 +- 0.002, 0.998 +- 0.003, 0.998 +- 0.003, 0.998 +- 0.003

Eval split val
suff_simple class all_L1  =  0.911 +- 0.068, 0.912 +- 0.067, 0.912 +- 0.068, 0.912 +- 0.068, 0.912 +- 0.067
suff_simple class all_KL  =  0.861 +- 0.093, 0.861 +- 0.091, 0.862 +- 0.092, 0.862 +- 0.092, 0.867 +- 0.088
[[0.8379999995231628, 0.8367499709129333, 0.8372250199317932, 0.8372250199317932, 0.8385000228881836], [0.9932000041007996, 0.993149995803833, 0.9931750297546387, 0.9926499724388123, 0.993025004863739], [0.9910249710083008, 0.9907000064849854, 0.9913250207901001, 0.9906250238418579, 0.9904500246047974], [0.904075026512146, 0.9057750105857849, 0.9046249985694885, 0.9065999984741211, 0.9041749835014343], [0.896399974822998, 0.8957750201225281, 0.8957250118255615, 0.8966249823570251, 0.8957750201225281], [0.9147999882698059, 0.9150999784469604, 0.9140250086784363, 0.9151999950408936, 0.9161999821662903], [0.8099750280380249, 0.8071749806404114, 0.8070499897003174, 0.8080750107765198, 0.8080750107765198], [0.7682250142097473, 0.7669249773025513, 0.7672500014305115, 0.7662749886512756, 0.7690250277519226], [0.6912999749183655, 0.6901000142097473, 0.6895750164985657, 0.6919000148773193, 0.6887500286102295], [0.9929999709129333, 0.992775022983551, 0.9933500289916992, 0.9932500123977661, 0.987625002861023]]
[[0.971, 0.969, 0.969, 0.97, 0.972], [0.958, 0.957, 0.96, 0.956, 0.961], [0.944, 0.945, 0.946, 0.946, 0.948], [0.814, 0.816, 0.819, 0.819, 0.827], [0.719, 0.72, 0.72, 0.719, 0.723], [0.885, 0.884, 0.883, 0.884, 0.891], [0.861, 0.862, 0.862, 0.864, 0.869], [0.737, 0.739, 0.738, 0.741, 0.75], [0.763, 0.766, 0.768, 0.762, 0.777], [0.958, 0.956, 0.959, 0.96, 0.95]]
suff_simple_acc_int  =  0.880 +- 0.097, 0.879 +- 0.098, 0.879 +- 0.098, 0.880 +- 0.098, 0.879 +- 0.097
nec class all_L1  =  0.043 +- 0.040, 0.044 +- 0.041, 0.045 +- 0.041, 0.045 +- 0.041, 0.046 +- 0.041
nec class all_KL  =  0.055 +- 0.053, 0.060 +- 0.057, 0.063 +- 0.059, 0.065 +- 0.061, 0.067 +- 0.063
[[0.8398249745368958, 0.839775025844574, 0.8399999737739563, 0.8398500084877014, 0.8396999835968018], [0.9986249804496765, 0.9984999895095825, 0.9987750053405762, 0.9988250136375427, 0.998924970626831], [0.9979749917984009, 0.9980000257492065, 0.9982249736785889, 0.9982749819755554, 0.9978500008583069], [0.9438499808311462, 0.9439250230789185, 0.9422249794006348, 0.9428250193595886, 0.9424750208854675], [0.7957000136375427, 0.7970749735832214, 0.7950500249862671, 0.7967000007629395, 0.7965499758720398], [0.9384499788284302, 0.9383249878883362, 0.9373000264167786, 0.9383249878883362, 0.9366250038146973], [0.7811999917030334, 0.7827249765396118, 0.7818750143051147, 0.7815999984741211, 0.7825499773025513], [0.6905500292778015, 0.6884499788284302, 0.6876749992370605, 0.6891000270843506, 0.6895250082015991], [0.6197749972343445, 0.6185749769210815, 0.6190999746322632, 0.6196749806404114, 0.619350016117096], [0.9993249773979187, 0.9993749856948853, 0.9991499781608582, 0.9990000128746033, 0.9992499947547913]]
[[0.006, 0.006, 0.006, 0.006, 0.008], [0.006, 0.007, 0.007, 0.007, 0.006], [0.009, 0.011, 0.011, 0.01, 0.013], [0.048, 0.058, 0.073, 0.075, 0.079], [0.164, 0.177, 0.177, 0.183, 0.186], [0.036, 0.038, 0.039, 0.04, 0.04], [0.05, 0.058, 0.056, 0.058, 0.058], [0.121, 0.131, 0.137, 0.144, 0.149], [0.101, 0.11, 0.12, 0.122, 0.126], [0.004, 0.004, 0.006, 0.007, 0.006]]
nec_acc_int  =  0.861 +- 0.130, 0.860 +- 0.130, 0.860 +- 0.130, 0.860 +- 0.130, 0.860 +- 0.130

Eval split test
suff_simple class all_L1  =  0.930 +- 0.037, 0.930 +- 0.037, 0.933 +- 0.037, 0.943 +- 0.032, 0.953 +- 0.023
suff_simple class all_KL  =  0.908 +- 0.041, 0.910 +- 0.040, 0.916 +- 0.040, 0.932 +- 0.032, 0.945 +- 0.029
[[0.7963027954101562, 0.7971032857894897, 0.798028826713562, 0.810811460018158, 0.8208483457565308], [0.877076268196106, 0.8786522150039673, 0.8786271810531616, 0.8795276880264282, 0.8849668502807617], [0.950370192527771, 0.9493696093559265, 0.9497448205947876, 0.9516960382461548, 0.961478590965271], [0.9463678002357483, 0.9463678002357483, 0.9454672932624817, 0.951295793056488, 0.9561170339584351], [0.8132379651069641, 0.8140383958816528, 0.8118370771408081, 0.8135131001472473, 0.8205070495605469], [0.6383079886436462, 0.6371822953224182, 0.638433039188385, 0.6473884582519531, 0.6519829034805298], [0.6318041086196899, 0.6293526291847229, 0.6308284997940063, 0.6366069912910461, 0.6495388150215149], [0.7798929214477539, 0.7804182767868042, 0.7806683778762817, 0.7844706773757935, 0.7928872108459473], [0.7446467876434326, 0.739893913269043, 0.7397688627243042, 0.7574294805526733, 0.7630563378334045], [0.9521713256835938, 0.952621579170227, 0.9534971117973328, 0.9521462917327881, 0.9336447715759277]]
[[0.875, 0.879, 0.884, 0.902, 0.939], [0.941, 0.943, 0.947, 0.949, 0.96], [0.946, 0.944, 0.949, 0.955, 0.974], [0.93, 0.932, 0.944, 0.967, 0.979], [0.943, 0.946, 0.949, 0.954, 0.97], [0.855, 0.857, 0.862, 0.888, 0.924], [0.838, 0.838, 0.845, 0.871, 0.916], [0.904, 0.902, 0.914, 0.935, 0.958], [0.888, 0.89, 0.897, 0.929, 0.95], [0.963, 0.964, 0.967, 0.967, 0.881]]
suff_simple_acc_int  =  0.813 +- 0.114, 0.812 +- 0.115, 0.813 +- 0.114, 0.818 +- 0.111, 0.824 +- 0.108
nec class all_L1  =  0.023 +- 0.016, 0.028 +- 0.018, 0.033 +- 0.019, 0.036 +- 0.021, 0.040 +- 0.024
nec class all_KL  =  0.020 +- 0.011, 0.026 +- 0.014, 0.035 +- 0.016, 0.042 +- 0.020, 0.051 +- 0.024
[[0.8276715874671936, 0.8231188654899597, 0.8230438232421875, 0.8207924962043762, 0.8183910250663757], [0.8929107189178467, 0.8909595608711243, 0.8864068388938904, 0.8861566781997681, 0.8874074220657349], [0.9699069261550903, 0.9673053622245789, 0.9628527164459229, 0.9626025557518005, 0.9629027247428894], [0.9655543565750122, 0.963027834892273, 0.9598509073257446, 0.9602011442184448, 0.9595007300376892], [0.825445294380188, 0.8227436542510986, 0.8208675384521484, 0.8196167945861816, 0.8206173777580261], [0.6583700180053711, 0.6511156558990479, 0.647213339805603, 0.6483640074729919, 0.6480888724327087], [0.6577696800231934, 0.6511657238006592, 0.6463127732276917, 0.6448619365692139, 0.6424354314804077], [0.7994296550750732, 0.796227753162384, 0.7911496758460999, 0.7910996675491333, 0.7910746335983276], [0.7691114544868469, 0.7675355076789856, 0.7631328701972961, 0.763908326625824, 0.7581048607826233], [0.9709075689315796, 0.9680057764053345, 0.9639283418655396, 0.9630778431892395, 0.963127851486206]]
[[0.032, 0.04, 0.049, 0.057, 0.069], [0.016, 0.02, 0.028, 0.033, 0.035], [0.01, 0.014, 0.023, 0.028, 0.033], [0.009, 0.014, 0.022, 0.026, 0.034], [0.013, 0.016, 0.026, 0.029, 0.032], [0.036, 0.046, 0.06, 0.07, 0.087], [0.039, 0.051, 0.065, 0.082, 0.097], [0.014, 0.02, 0.028, 0.037, 0.049], [0.021, 0.03, 0.037, 0.042, 0.055], [0.006, 0.01, 0.016, 0.019, 0.022]]
nec_acc_int  =  0.834 +- 0.112, 0.830 +- 0.113, 0.826 +- 0.113, 0.826 +- 0.113, 0.825 +- 0.114


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.494 +- 0.003, 0.494 +- 0.004, 0.494 +- 0.004, 0.495 +- 0.003, 0.496 +- 0.003
Faith. Armon (L1)= 		  =  0.006 +- 0.007, 0.006 +- 0.007, 0.007 +- 0.008, 0.007 +- 0.008, 0.007 +- 0.008
Faith. GMean (L1)= 	  =  0.039 +- 0.037, 0.040 +- 0.039, 0.043 +- 0.037, 0.043 +- 0.038, 0.045 +- 0.037
Faith. Aritm (KL)= 		  =  0.486 +- 0.007, 0.486 +- 0.006, 0.486 +- 0.007, 0.489 +- 0.006, 0.493 +- 0.004
Faith. Armon (KL)= 		  =  0.007 +- 0.007, 0.009 +- 0.010, 0.009 +- 0.010, 0.009 +- 0.008, 0.011 +- 0.010
Faith. GMean (KL)= 	  =  0.046 +- 0.035, 0.047 +- 0.043, 0.052 +- 0.042, 0.052 +- 0.040, 0.058 +- 0.043

Eval split val
Faith. Aritm (L1)= 		  =  0.477 +- 0.015, 0.478 +- 0.014, 0.478 +- 0.014, 0.479 +- 0.014, 0.479 +- 0.013
Faith. Armon (L1)= 		  =  0.079 +- 0.070, 0.081 +- 0.071, 0.082 +- 0.071, 0.083 +- 0.072, 0.083 +- 0.072
Faith. GMean (L1)= 	  =  0.168 +- 0.092, 0.171 +- 0.093, 0.172 +- 0.093, 0.174 +- 0.093, 0.174 +- 0.093
Faith. Aritm (KL)= 		  =  0.458 +- 0.022, 0.461 +- 0.019, 0.463 +- 0.018, 0.464 +- 0.017, 0.467 +- 0.014
Faith. Armon (KL)= 		  =  0.096 +- 0.088, 0.104 +- 0.094, 0.110 +- 0.096, 0.113 +- 0.099, 0.116 +- 0.101
Faith. GMean (KL)= 	  =  0.181 +- 0.097, 0.190 +- 0.102, 0.196 +- 0.103, 0.199 +- 0.105, 0.203 +- 0.107

Eval split test
Faith. Aritm (L1)= 		  =  0.477 +- 0.011, 0.479 +- 0.010, 0.483 +- 0.009, 0.490 +- 0.005, 0.497 +- 0.006
Faith. Armon (L1)= 		  =  0.045 +- 0.031, 0.053 +- 0.033, 0.063 +- 0.036, 0.069 +- 0.039, 0.076 +- 0.043
Faith. GMean (L1)= 	  =  0.137 +- 0.048, 0.152 +- 0.046, 0.168 +- 0.046, 0.177 +- 0.049, 0.187 +- 0.053
Faith. Aritm (KL)= 		  =  0.464 +- 0.015, 0.468 +- 0.014, 0.476 +- 0.012, 0.487 +- 0.006, 0.498 +- 0.016
Faith. Armon (KL)= 		  =  0.038 +- 0.021, 0.050 +- 0.026, 0.068 +- 0.029, 0.080 +- 0.035, 0.096 +- 0.043
Faith. GMean (KL)= 	  =  0.127 +- 0.035, 0.148 +- 0.037, 0.175 +- 0.035, 0.193 +- 0.040, 0.214 +- 0.049
Computed for split load_split = id



Completed in  2:39:55.804736  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GL-GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:30:12 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:30:12 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.052
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.063
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.076
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.037
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.046
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052486000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.999
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.037 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.037 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.05 all KL = 0.997 +- 0.037 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.05 all L1 = 0.999 +- 0.015 (in-sample avg dev_std = 0.046)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06340000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.034 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.034 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.1 all KL = 0.998 +- 0.034 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.1 all L1 = 0.999 +- 0.014 (in-sample avg dev_std = 0.036)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07078
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.021 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.021 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.2 all KL = 0.999 +- 0.021 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.2 all L1 = 0.999 +- 0.008 (in-sample avg dev_std = 0.024)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075792
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.047 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.047 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.4 all KL = 0.996 +- 0.047 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.4 all L1 = 0.998 +- 0.017 (in-sample avg dev_std = 0.054)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077492
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.036 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.036 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.8 all KL = 0.997 +- 0.036 (in-sample avg dev_std = 0.040)
SUFF_SIMPLE for r=0.8 all L1 = 0.999 +- 0.013 (in-sample avg dev_std = 0.040)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089806
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.997
SUFF_SIMPLE for r=0.05 class 0.0 = 0.989 +- 0.086 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.086 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.05 all KL = 0.985 +- 0.086 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.05 all L1 = 0.994 +- 0.033 (in-sample avg dev_std = 0.098)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009006400000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 0.0 = 0.987 +- 0.092 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.092 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 all KL = 0.983 +- 0.092 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.1 all L1 = 0.993 +- 0.035 (in-sample avg dev_std = 0.106)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.008993000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.997
SUFF_SIMPLE for r=0.2 class 0.0 = 0.988 +- 0.086 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.086 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.2 all KL = 0.985 +- 0.086 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.2 all L1 = 0.994 +- 0.033 (in-sample avg dev_std = 0.099)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0089888
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.997
SUFF_SIMPLE for r=0.4 class 0.0 = 0.988 +- 0.088 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.088 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 all KL = 0.985 +- 0.088 (in-sample avg dev_std = 0.101)
SUFF_SIMPLE for r=0.4 all L1 = 0.994 +- 0.034 (in-sample avg dev_std = 0.101)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0089886
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.997
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.092 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.092 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.8 all KL = 0.984 +- 0.092 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.8 all L1 = 0.993 +- 0.036 (in-sample avg dev_std = 0.104)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0372566
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.962
SUFF_SIMPLE for r=0.05 class 0.0 = 0.952 +- 0.190 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.991 +- 0.190 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all KL = 0.956 +- 0.190 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all L1 = 0.971 +- 0.134 (in-sample avg dev_std = 0.176)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0461748
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.962
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.192 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.192 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 all KL = 0.955 +- 0.192 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.1 all L1 = 0.971 +- 0.134 (in-sample avg dev_std = 0.181)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0563976
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.962
SUFF_SIMPLE for r=0.2 class 0.0 = 0.953 +- 0.180 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.994 +- 0.180 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all KL = 0.962 +- 0.180 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all L1 = 0.973 +- 0.134 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0679408
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.963
SUFF_SIMPLE for r=0.4 class 0.0 = 0.957 +- 0.170 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.170 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 all KL = 0.965 +- 0.170 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.4 all L1 = 0.975 +- 0.129 (in-sample avg dev_std = 0.128)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08047760000000001
len(reference) = 4977
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.96
SUFF_SIMPLE for r=0.8 class 0.0 = 0.979 +- 0.211 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.945 +- 0.211 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.8 all KL = 0.931 +- 0.211 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.127 (in-sample avg dev_std = 0.217)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052486000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)
NEC for r=0.05 class 1.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all KL = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06340000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07078
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.2 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075792
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077492
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.0 +- 0.003 (in-sample avg dev_std = 0.004)
NEC for r=0.8 class 1.0 = 0.0 +- 0.003 (in-sample avg dev_std = 0.004)
NEC for r=0.8 all KL = 0.0 +- 0.003 (in-sample avg dev_std = 0.004)
NEC for r=0.8 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.004)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089806
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.001 +- 0.029 (in-sample avg dev_std = 0.031)
NEC for r=0.05 class 1.0 = 0.0 +- 0.029 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all KL = 0.001 +- 0.029 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all L1 = 0.001 +- 0.014 (in-sample avg dev_std = 0.031)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009006400000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.001 +- 0.026 (in-sample avg dev_std = 0.031)
NEC for r=0.1 class 1.0 = 0.0 +- 0.026 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.002 +- 0.026 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.001 +- 0.011 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.008993000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.001 +- 0.026 (in-sample avg dev_std = 0.030)
NEC for r=0.2 class 1.0 = 0.0 +- 0.026 (in-sample avg dev_std = 0.030)
NEC for r=0.2 all KL = 0.002 +- 0.026 (in-sample avg dev_std = 0.030)
NEC for r=0.2 all L1 = 0.001 +- 0.010 (in-sample avg dev_std = 0.030)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0089888
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.002 +- 0.038 (in-sample avg dev_std = 0.045)
NEC for r=0.4 class 1.0 = 0.0 +- 0.038 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all KL = 0.003 +- 0.038 (in-sample avg dev_std = 0.045)
NEC for r=0.4 all L1 = 0.001 +- 0.015 (in-sample avg dev_std = 0.045)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0089886
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.001 +- 0.025 (in-sample avg dev_std = 0.030)
NEC for r=0.8 class 1.0 = 0.0 +- 0.025 (in-sample avg dev_std = 0.030)
NEC for r=0.8 all KL = 0.001 +- 0.025 (in-sample avg dev_std = 0.030)
NEC for r=0.8 all L1 = 0.001 +- 0.010 (in-sample avg dev_std = 0.030)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0372566
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.981
NEC for r=0.05 class 0.0 = 0.009 +- 0.066 (in-sample avg dev_std = 0.013)
NEC for r=0.05 class 1.0 = 0.0 +- 0.066 (in-sample avg dev_std = 0.013)
NEC for r=0.05 all KL = 0.005 +- 0.066 (in-sample avg dev_std = 0.013)
NEC for r=0.05 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.013)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0461748
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.978
NEC for r=0.1 class 0.0 = 0.015 +- 0.088 (in-sample avg dev_std = 0.012)
NEC for r=0.1 class 1.0 = 0.0 +- 0.088 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all KL = 0.009 +- 0.088 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all L1 = 0.008 +- 0.077 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0563976
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.976
NEC for r=0.2 class 0.0 = 0.021 +- 0.108 (in-sample avg dev_std = 0.065)
NEC for r=0.2 class 1.0 = 0.0 +- 0.108 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all KL = 0.014 +- 0.108 (in-sample avg dev_std = 0.065)
NEC for r=0.2 all L1 = 0.011 +- 0.087 (in-sample avg dev_std = 0.065)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0679408
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.973
NEC for r=0.4 class 0.0 = 0.026 +- 0.130 (in-sample avg dev_std = 0.105)
NEC for r=0.4 class 1.0 = 0.002 +- 0.130 (in-sample avg dev_std = 0.105)
NEC for r=0.4 all KL = 0.02 +- 0.130 (in-sample avg dev_std = 0.105)
NEC for r=0.4 all L1 = 0.014 +- 0.095 (in-sample avg dev_std = 0.105)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08047760000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.973
NEC for r=0.8 class 0.0 = 0.031 +- 0.147 (in-sample avg dev_std = 0.145)
NEC for r=0.8 class 1.0 = 0.003 +- 0.147 (in-sample avg dev_std = 0.145)
NEC for r=0.8 all KL = 0.027 +- 0.147 (in-sample avg dev_std = 0.145)
NEC for r=0.8 all L1 = 0.017 +- 0.097 (in-sample avg dev_std = 0.145)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Tue Jan 14 23:49:29 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/14/2025 11:49:29 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/14/2025 11:49:29 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/14/2025 11:49:29 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/14/2025 11:49:29 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:49:29 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:49:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:49:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/14/2025 11:49:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/14/2025 11:49:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/14/2025 11:49:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.057
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.067
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.067
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.994
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.118 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.987 +- 0.118 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.05 all KL = 0.979 +- 0.118 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.05 all L1 = 0.991 +- 0.055 (in-sample avg dev_std = 0.138)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06731000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.991
SUFF_SIMPLE for r=0.1 class 0.0 = 0.994 +- 0.148 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.978 +- 0.148 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.1 all KL = 0.965 +- 0.148 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.1 all L1 = 0.985 +- 0.066 (in-sample avg dev_std = 0.178)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070602
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.992
SUFF_SIMPLE for r=0.2 class 0.0 = 0.993 +- 0.146 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.98 +- 0.146 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.2 all KL = 0.966 +- 0.146 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.2 all L1 = 0.986 +- 0.062 (in-sample avg dev_std = 0.175)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076564
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.991
SUFF_SIMPLE for r=0.4 class 0.0 = 0.994 +- 0.143 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.98 +- 0.143 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.4 all KL = 0.971 +- 0.143 (in-sample avg dev_std = 0.167)
SUFF_SIMPLE for r=0.4 all L1 = 0.987 +- 0.072 (in-sample avg dev_std = 0.167)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080314
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.993
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.101 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.101 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all KL = 0.987 +- 0.101 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all L1 = 0.993 +- 0.067 (in-sample avg dev_std = 0.089)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0098826
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.996
SUFF_SIMPLE for r=0.05 class 0.0 = 0.986 +- 0.116 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.116 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.05 all KL = 0.978 +- 0.116 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.05 all L1 = 0.992 +- 0.043 (in-sample avg dev_std = 0.131)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0098832
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.995
SUFF_SIMPLE for r=0.1 class 0.0 = 0.984 +- 0.121 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.121 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.976 +- 0.121 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.991 +- 0.044 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009895000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.995
SUFF_SIMPLE for r=0.2 class 0.0 = 0.986 +- 0.117 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.117 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all KL = 0.977 +- 0.117 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.2 all L1 = 0.992 +- 0.043 (in-sample avg dev_std = 0.133)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098774
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.995
SUFF_SIMPLE for r=0.4 class 0.0 = 0.984 +- 0.122 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.122 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all KL = 0.975 +- 0.122 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all L1 = 0.991 +- 0.045 (in-sample avg dev_std = 0.138)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877799999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.995
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.119 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.998 +- 0.119 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all KL = 0.977 +- 0.119 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all L1 = 0.992 +- 0.046 (in-sample avg dev_std = 0.133)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035289999999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.964
SUFF_SIMPLE for r=0.05 class 0.0 = 0.958 +- 0.234 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.961 +- 0.234 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.234 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.05 all L1 = 0.959 +- 0.143 (in-sample avg dev_std = 0.260)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042921799999999996
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.964
SUFF_SIMPLE for r=0.1 class 0.0 = 0.958 +- 0.234 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.961 +- 0.234 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.1 all KL = 0.927 +- 0.234 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.1 all L1 = 0.96 +- 0.142 (in-sample avg dev_std = 0.260)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053993000000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.967
SUFF_SIMPLE for r=0.2 class 0.0 = 0.963 +- 0.211 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.97 +- 0.211 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 all KL = 0.942 +- 0.211 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.2 all L1 = 0.966 +- 0.138 (in-sample avg dev_std = 0.208)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0670826
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.968
SUFF_SIMPLE for r=0.4 class 0.0 = 0.964 +- 0.201 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.973 +- 0.201 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.4 all KL = 0.95 +- 0.201 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.4 all L1 = 0.968 +- 0.141 (in-sample avg dev_std = 0.177)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0801148
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.977
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.143 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.979 +- 0.143 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all KL = 0.977 +- 0.143 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.8 all L1 = 0.983 +- 0.112 (in-sample avg dev_std = 0.089)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 0.0 = 0.0 +- 0.050 (in-sample avg dev_std = 0.057)
NEC for r=0.05 class 1.0 = 0.003 +- 0.050 (in-sample avg dev_std = 0.057)
NEC for r=0.05 all KL = 0.003 +- 0.050 (in-sample avg dev_std = 0.057)
NEC for r=0.05 all L1 = 0.002 +- 0.030 (in-sample avg dev_std = 0.057)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06731000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.997
NEC for r=0.1 class 0.0 = 0.0 +- 0.086 (in-sample avg dev_std = 0.099)
NEC for r=0.1 class 1.0 = 0.009 +- 0.086 (in-sample avg dev_std = 0.099)
NEC for r=0.1 all KL = 0.009 +- 0.086 (in-sample avg dev_std = 0.099)
NEC for r=0.1 all L1 = 0.005 +- 0.046 (in-sample avg dev_std = 0.099)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070602
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.997
NEC for r=0.2 class 0.0 = 0.0 +- 0.089 (in-sample avg dev_std = 0.105)
NEC for r=0.2 class 1.0 = 0.009 +- 0.089 (in-sample avg dev_std = 0.105)
NEC for r=0.2 all KL = 0.011 +- 0.089 (in-sample avg dev_std = 0.105)
NEC for r=0.2 all L1 = 0.005 +- 0.043 (in-sample avg dev_std = 0.105)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076564
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.997
NEC for r=0.4 class 0.0 = 0.0 +- 0.084 (in-sample avg dev_std = 0.102)
NEC for r=0.4 class 1.0 = 0.008 +- 0.084 (in-sample avg dev_std = 0.102)
NEC for r=0.4 all KL = 0.011 +- 0.084 (in-sample avg dev_std = 0.102)
NEC for r=0.4 all L1 = 0.005 +- 0.036 (in-sample avg dev_std = 0.102)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080314
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.997
NEC for r=0.8 class 0.0 = 0.0 +- 0.086 (in-sample avg dev_std = 0.105)
NEC for r=0.8 class 1.0 = 0.009 +- 0.086 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all KL = 0.012 +- 0.086 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all L1 = 0.005 +- 0.038 (in-sample avg dev_std = 0.105)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0098826
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 0.0 = 0.004 +- 0.060 (in-sample avg dev_std = 0.066)
NEC for r=0.05 class 1.0 = 0.0 +- 0.060 (in-sample avg dev_std = 0.066)
NEC for r=0.05 all KL = 0.005 +- 0.060 (in-sample avg dev_std = 0.066)
NEC for r=0.05 all L1 = 0.002 +- 0.025 (in-sample avg dev_std = 0.066)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0098832
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.005 +- 0.066 (in-sample avg dev_std = 0.072)
NEC for r=0.1 class 1.0 = 0.0 +- 0.066 (in-sample avg dev_std = 0.072)
NEC for r=0.1 all KL = 0.006 +- 0.066 (in-sample avg dev_std = 0.072)
NEC for r=0.1 all L1 = 0.003 +- 0.027 (in-sample avg dev_std = 0.072)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009895000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.005 +- 0.071 (in-sample avg dev_std = 0.080)
NEC for r=0.2 class 1.0 = 0.0 +- 0.071 (in-sample avg dev_std = 0.080)
NEC for r=0.2 all KL = 0.008 +- 0.071 (in-sample avg dev_std = 0.080)
NEC for r=0.2 all L1 = 0.003 +- 0.026 (in-sample avg dev_std = 0.080)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098774
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.998
NEC for r=0.4 class 0.0 = 0.005 +- 0.071 (in-sample avg dev_std = 0.080)
NEC for r=0.4 class 1.0 = 0.001 +- 0.071 (in-sample avg dev_std = 0.080)
NEC for r=0.4 all KL = 0.008 +- 0.071 (in-sample avg dev_std = 0.080)
NEC for r=0.4 all L1 = 0.003 +- 0.025 (in-sample avg dev_std = 0.080)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877799999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.004 +- 0.063 (in-sample avg dev_std = 0.070)
NEC for r=0.8 class 1.0 = 0.001 +- 0.063 (in-sample avg dev_std = 0.070)
NEC for r=0.8 all KL = 0.006 +- 0.063 (in-sample avg dev_std = 0.070)
NEC for r=0.8 all L1 = 0.002 +- 0.023 (in-sample avg dev_std = 0.070)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035289999999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.984
NEC for r=0.05 class 0.0 = 0.009 +- 0.103 (in-sample avg dev_std = 0.031)
NEC for r=0.05 class 1.0 = 0.009 +- 0.103 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all KL = 0.011 +- 0.103 (in-sample avg dev_std = 0.031)
NEC for r=0.05 all L1 = 0.009 +- 0.088 (in-sample avg dev_std = 0.031)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042921799999999996
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.982
NEC for r=0.1 class 0.0 = 0.011 +- 0.115 (in-sample avg dev_std = 0.053)
NEC for r=0.1 class 1.0 = 0.012 +- 0.115 (in-sample avg dev_std = 0.053)
NEC for r=0.1 all KL = 0.014 +- 0.115 (in-sample avg dev_std = 0.053)
NEC for r=0.1 all L1 = 0.011 +- 0.095 (in-sample avg dev_std = 0.053)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053993000000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.977
NEC for r=0.2 class 0.0 = 0.018 +- 0.146 (in-sample avg dev_std = 0.103)
NEC for r=0.2 class 1.0 = 0.017 +- 0.146 (in-sample avg dev_std = 0.103)
NEC for r=0.2 all KL = 0.023 +- 0.146 (in-sample avg dev_std = 0.103)
NEC for r=0.2 all L1 = 0.017 +- 0.111 (in-sample avg dev_std = 0.103)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0670826
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.973
NEC for r=0.4 class 0.0 = 0.022 +- 0.174 (in-sample avg dev_std = 0.160)
NEC for r=0.4 class 1.0 = 0.024 +- 0.174 (in-sample avg dev_std = 0.160)
NEC for r=0.4 all KL = 0.037 +- 0.174 (in-sample avg dev_std = 0.160)
NEC for r=0.4 all L1 = 0.023 +- 0.119 (in-sample avg dev_std = 0.160)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0801148
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.976
NEC for r=0.8 class 0.0 = 0.027 +- 0.195 (in-sample avg dev_std = 0.221)
NEC for r=0.8 class 1.0 = 0.027 +- 0.195 (in-sample avg dev_std = 0.221)
NEC for r=0.8 all KL = 0.052 +- 0.195 (in-sample avg dev_std = 0.221)
NEC for r=0.8 all L1 = 0.027 +- 0.112 (in-sample avg dev_std = 0.221)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:08:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:08:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.056
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.059
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.082
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.085
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.053
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.055805999999999994
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.989
SUFF_SIMPLE for r=0.05 class 0.0 = 0.988 +- 0.145 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.978 +- 0.145 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.05 all KL = 0.965 +- 0.145 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.05 all L1 = 0.983 +- 0.076 (in-sample avg dev_std = 0.191)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.058688000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.989
SUFF_SIMPLE for r=0.1 class 0.0 = 0.989 +- 0.145 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.976 +- 0.145 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.1 all KL = 0.962 +- 0.145 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.1 all L1 = 0.982 +- 0.073 (in-sample avg dev_std = 0.195)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07193599999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.991
SUFF_SIMPLE for r=0.2 class 0.0 = 0.992 +- 0.132 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.981 +- 0.132 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.2 all KL = 0.971 +- 0.132 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.2 all L1 = 0.986 +- 0.067 (in-sample avg dev_std = 0.174)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.081944
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.993
SUFF_SIMPLE for r=0.4 class 0.0 = 0.991 +- 0.119 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.986 +- 0.119 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all KL = 0.976 +- 0.119 (in-sample avg dev_std = 0.157)
SUFF_SIMPLE for r=0.4 all L1 = 0.988 +- 0.062 (in-sample avg dev_std = 0.157)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085276
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.994
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.104 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.991 +- 0.104 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.8 all KL = 0.986 +- 0.104 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.8 all L1 = 0.992 +- 0.064 (in-sample avg dev_std = 0.115)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0100756
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.913
SUFF_SIMPLE for r=0.05 class 0.0 = 0.944 +- 0.180 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.180 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all KL = 0.94 +- 0.180 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.05 all L1 = 0.972 +- 0.088 (in-sample avg dev_std = 0.236)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010077599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.913
SUFF_SIMPLE for r=0.1 class 0.0 = 0.945 +- 0.178 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.178 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 all KL = 0.94 +- 0.178 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.1 all L1 = 0.972 +- 0.085 (in-sample avg dev_std = 0.234)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010061
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.913
SUFF_SIMPLE for r=0.2 class 0.0 = 0.946 +- 0.176 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.176 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.2 all KL = 0.942 +- 0.176 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.2 all L1 = 0.973 +- 0.084 (in-sample avg dev_std = 0.232)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100376
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.912
SUFF_SIMPLE for r=0.4 class 0.0 = 0.943 +- 0.183 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.183 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.4 all KL = 0.939 +- 0.183 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.4 all L1 = 0.971 +- 0.090 (in-sample avg dev_std = 0.239)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010035800000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.913
SUFF_SIMPLE for r=0.8 class 0.0 = 0.946 +- 0.181 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.181 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all KL = 0.944 +- 0.181 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all L1 = 0.973 +- 0.091 (in-sample avg dev_std = 0.232)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0321112
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.963
SUFF_SIMPLE for r=0.05 class 0.0 = 0.96 +- 0.225 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.954 +- 0.225 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.05 all KL = 0.929 +- 0.225 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.05 all L1 = 0.957 +- 0.146 (in-sample avg dev_std = 0.266)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041798
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.964
SUFF_SIMPLE for r=0.1 class 0.0 = 0.961 +- 0.225 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.955 +- 0.225 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.1 all KL = 0.93 +- 0.225 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.1 all L1 = 0.958 +- 0.145 (in-sample avg dev_std = 0.265)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053203
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.961
SUFF_SIMPLE for r=0.2 class 0.0 = 0.962 +- 0.215 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.96 +- 0.215 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all KL = 0.94 +- 0.215 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.2 all L1 = 0.961 +- 0.151 (in-sample avg dev_std = 0.221)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066414
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.963
SUFF_SIMPLE for r=0.4 class 0.0 = 0.967 +- 0.202 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.962 +- 0.202 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.949 +- 0.202 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.965 +- 0.150 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080014
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.974
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.142 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.978 +- 0.142 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.8 all KL = 0.978 +- 0.142 (in-sample avg dev_std = 0.060)
SUFF_SIMPLE for r=0.8 all L1 = 0.982 +- 0.120 (in-sample avg dev_std = 0.060)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.055805999999999994
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 0.0 = 0.0 +- 0.033 (in-sample avg dev_std = 0.041)
NEC for r=0.05 class 1.0 = 0.001 +- 0.033 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all KL = 0.002 +- 0.033 (in-sample avg dev_std = 0.041)
NEC for r=0.05 all L1 = 0.001 +- 0.018 (in-sample avg dev_std = 0.041)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.058688000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
NEC for r=0.1 class 0.0 = 0.0 +- 0.031 (in-sample avg dev_std = 0.044)
NEC for r=0.1 class 1.0 = 0.002 +- 0.031 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all KL = 0.002 +- 0.031 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all L1 = 0.001 +- 0.014 (in-sample avg dev_std = 0.044)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07193599999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.997
NEC for r=0.2 class 0.0 = 0.0 +- 0.074 (in-sample avg dev_std = 0.089)
NEC for r=0.2 class 1.0 = 0.007 +- 0.074 (in-sample avg dev_std = 0.089)
NEC for r=0.2 all KL = 0.007 +- 0.074 (in-sample avg dev_std = 0.089)
NEC for r=0.2 all L1 = 0.004 +- 0.045 (in-sample avg dev_std = 0.089)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.081944
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.996
NEC for r=0.4 class 0.0 = 0.002 +- 0.091 (in-sample avg dev_std = 0.118)
NEC for r=0.4 class 1.0 = 0.011 +- 0.091 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all KL = 0.013 +- 0.091 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all L1 = 0.007 +- 0.048 (in-sample avg dev_std = 0.118)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085276
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.997
NEC for r=0.8 class 0.0 = 0.001 +- 0.082 (in-sample avg dev_std = 0.108)
NEC for r=0.8 class 1.0 = 0.009 +- 0.082 (in-sample avg dev_std = 0.108)
NEC for r=0.8 all KL = 0.011 +- 0.082 (in-sample avg dev_std = 0.108)
NEC for r=0.8 all L1 = 0.006 +- 0.042 (in-sample avg dev_std = 0.108)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0100756
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.924
NEC for r=0.05 class 0.0 = 0.016 +- 0.103 (in-sample avg dev_std = 0.122)
NEC for r=0.05 class 1.0 = 0.0 +- 0.103 (in-sample avg dev_std = 0.122)
NEC for r=0.05 all KL = 0.016 +- 0.103 (in-sample avg dev_std = 0.122)
NEC for r=0.05 all L1 = 0.008 +- 0.055 (in-sample avg dev_std = 0.122)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010077599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.924
NEC for r=0.1 class 0.0 = 0.017 +- 0.102 (in-sample avg dev_std = 0.130)
NEC for r=0.1 class 1.0 = 0.0 +- 0.102 (in-sample avg dev_std = 0.130)
NEC for r=0.1 all KL = 0.018 +- 0.102 (in-sample avg dev_std = 0.130)
NEC for r=0.1 all L1 = 0.009 +- 0.050 (in-sample avg dev_std = 0.130)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010061
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.923
NEC for r=0.2 class 0.0 = 0.02 +- 0.110 (in-sample avg dev_std = 0.142)
NEC for r=0.2 class 1.0 = 0.0 +- 0.110 (in-sample avg dev_std = 0.142)
NEC for r=0.2 all KL = 0.022 +- 0.110 (in-sample avg dev_std = 0.142)
NEC for r=0.2 all L1 = 0.01 +- 0.052 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100376
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.924
NEC for r=0.4 class 0.0 = 0.019 +- 0.106 (in-sample avg dev_std = 0.140)
NEC for r=0.4 class 1.0 = 0.0 +- 0.106 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all KL = 0.022 +- 0.106 (in-sample avg dev_std = 0.140)
NEC for r=0.4 all L1 = 0.01 +- 0.048 (in-sample avg dev_std = 0.140)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010035800000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.924
NEC for r=0.8 class 0.0 = 0.019 +- 0.104 (in-sample avg dev_std = 0.139)
NEC for r=0.8 class 1.0 = 0.0 +- 0.104 (in-sample avg dev_std = 0.139)
NEC for r=0.8 all KL = 0.022 +- 0.104 (in-sample avg dev_std = 0.139)
NEC for r=0.8 all L1 = 0.009 +- 0.046 (in-sample avg dev_std = 0.139)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0321112
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.979
NEC for r=0.05 class 0.0 = 0.007 +- 0.107 (in-sample avg dev_std = 0.027)
NEC for r=0.05 class 1.0 = 0.013 +- 0.107 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all KL = 0.012 +- 0.107 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all L1 = 0.01 +- 0.091 (in-sample avg dev_std = 0.027)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041798
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.978
NEC for r=0.1 class 0.0 = 0.01 +- 0.126 (in-sample avg dev_std = 0.048)
NEC for r=0.1 class 1.0 = 0.018 +- 0.126 (in-sample avg dev_std = 0.048)
NEC for r=0.1 all KL = 0.017 +- 0.126 (in-sample avg dev_std = 0.048)
NEC for r=0.1 all L1 = 0.014 +- 0.106 (in-sample avg dev_std = 0.048)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053203
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.974
NEC for r=0.2 class 0.0 = 0.016 +- 0.150 (in-sample avg dev_std = 0.104)
NEC for r=0.2 class 1.0 = 0.023 +- 0.150 (in-sample avg dev_std = 0.104)
NEC for r=0.2 all KL = 0.025 +- 0.150 (in-sample avg dev_std = 0.104)
NEC for r=0.2 all L1 = 0.019 +- 0.119 (in-sample avg dev_std = 0.104)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066414
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.972
NEC for r=0.4 class 0.0 = 0.021 +- 0.173 (in-sample avg dev_std = 0.158)
NEC for r=0.4 class 1.0 = 0.029 +- 0.173 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all KL = 0.036 +- 0.173 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all L1 = 0.025 +- 0.127 (in-sample avg dev_std = 0.158)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080014
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.974
NEC for r=0.8 class 0.0 = 0.024 +- 0.188 (in-sample avg dev_std = 0.226)
NEC for r=0.8 class 1.0 = 0.034 +- 0.188 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all KL = 0.05 +- 0.188 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all L1 = 0.029 +- 0.117 (in-sample avg dev_std = 0.226)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:27:42 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:27:42 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.057
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.065
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.075
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056974000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.995
SUFF_SIMPLE for r=0.05 class 0.0 = 0.994 +- 0.086 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.991 +- 0.086 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.05 all KL = 0.988 +- 0.086 (in-sample avg dev_std = 0.111)
SUFF_SIMPLE for r=0.05 all L1 = 0.992 +- 0.053 (in-sample avg dev_std = 0.111)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06515399999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.994
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.091 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.091 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 all KL = 0.987 +- 0.091 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 all L1 = 0.992 +- 0.056 (in-sample avg dev_std = 0.118)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071744
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.997
SUFF_SIMPLE for r=0.2 class 0.0 = 0.994 +- 0.070 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.994 +- 0.070 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.2 all KL = 0.991 +- 0.070 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.2 all L1 = 0.994 +- 0.046 (in-sample avg dev_std = 0.089)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07501000000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.997
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.065 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.065 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.4 all KL = 0.992 +- 0.065 (in-sample avg dev_std = 0.091)
SUFF_SIMPLE for r=0.4 all L1 = 0.995 +- 0.039 (in-sample avg dev_std = 0.091)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078934
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.997
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.062 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.995 +- 0.062 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.8 all KL = 0.995 +- 0.062 (in-sample avg dev_std = 0.058)
SUFF_SIMPLE for r=0.8 all L1 = 0.996 +- 0.046 (in-sample avg dev_std = 0.058)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.846
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.189 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.903 +- 0.189 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.05 all KL = 0.938 +- 0.189 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.05 all L1 = 0.95 +- 0.139 (in-sample avg dev_std = 0.225)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009945599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.847
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.183 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.905 +- 0.183 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.1 all KL = 0.941 +- 0.183 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.1 all L1 = 0.951 +- 0.138 (in-sample avg dev_std = 0.216)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009889
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.848
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.183 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.907 +- 0.183 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 all KL = 0.943 +- 0.183 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.2 all L1 = 0.952 +- 0.137 (in-sample avg dev_std = 0.213)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.847
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.185 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.905 +- 0.185 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all KL = 0.942 +- 0.185 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all L1 = 0.951 +- 0.139 (in-sample avg dev_std = 0.215)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.846
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.186 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.904 +- 0.186 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.8 all KL = 0.941 +- 0.186 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.8 all L1 = 0.951 +- 0.140 (in-sample avg dev_std = 0.213)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0331508
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.958
SUFF_SIMPLE for r=0.05 class 0.0 = 0.96 +- 0.231 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.936 +- 0.231 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.05 all KL = 0.922 +- 0.231 (in-sample avg dev_std = 0.275)
SUFF_SIMPLE for r=0.05 all L1 = 0.948 +- 0.161 (in-sample avg dev_std = 0.275)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.956
SUFF_SIMPLE for r=0.1 class 0.0 = 0.962 +- 0.231 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.934 +- 0.231 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all KL = 0.923 +- 0.231 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.1 all L1 = 0.948 +- 0.163 (in-sample avg dev_std = 0.269)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0508582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.957
SUFF_SIMPLE for r=0.2 class 0.0 = 0.965 +- 0.217 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.942 +- 0.217 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.217 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.161 (in-sample avg dev_std = 0.226)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0630722
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.953
SUFF_SIMPLE for r=0.4 class 0.0 = 0.966 +- 0.223 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.934 +- 0.223 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.4 all KL = 0.933 +- 0.223 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.4 all L1 = 0.95 +- 0.173 (in-sample avg dev_std = 0.199)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0781998
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.959
SUFF_SIMPLE for r=0.8 class 0.0 = 0.983 +- 0.192 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.94 +- 0.192 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 all KL = 0.95 +- 0.192 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.8 all L1 = 0.962 +- 0.151 (in-sample avg dev_std = 0.160)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056974000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.0 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.003 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.038 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06515399999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.996
NEC for r=0.1 class 0.0 = 0.0 +- 0.061 (in-sample avg dev_std = 0.027)
NEC for r=0.1 class 1.0 = 0.006 +- 0.061 (in-sample avg dev_std = 0.027)
NEC for r=0.1 all KL = 0.004 +- 0.061 (in-sample avg dev_std = 0.027)
NEC for r=0.1 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.027)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071744
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.0 +- 0.053 (in-sample avg dev_std = 0.068)
NEC for r=0.2 class 1.0 = 0.004 +- 0.053 (in-sample avg dev_std = 0.068)
NEC for r=0.2 all KL = 0.004 +- 0.053 (in-sample avg dev_std = 0.068)
NEC for r=0.2 all L1 = 0.003 +- 0.033 (in-sample avg dev_std = 0.068)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07501000000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
NEC for r=0.4 class 0.0 = 0.001 +- 0.054 (in-sample avg dev_std = 0.051)
NEC for r=0.4 class 1.0 = 0.004 +- 0.054 (in-sample avg dev_std = 0.051)
NEC for r=0.4 all KL = 0.003 +- 0.054 (in-sample avg dev_std = 0.051)
NEC for r=0.4 all L1 = 0.003 +- 0.041 (in-sample avg dev_std = 0.051)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078934
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.001 +- 0.045 (in-sample avg dev_std = 0.056)
NEC for r=0.8 class 1.0 = 0.003 +- 0.045 (in-sample avg dev_std = 0.056)
NEC for r=0.8 all KL = 0.003 +- 0.045 (in-sample avg dev_std = 0.056)
NEC for r=0.8 all L1 = 0.002 +- 0.030 (in-sample avg dev_std = 0.056)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.874
NEC for r=0.05 class 0.0 = 0.0 +- 0.074 (in-sample avg dev_std = 0.079)
NEC for r=0.05 class 1.0 = 0.02 +- 0.074 (in-sample avg dev_std = 0.079)
NEC for r=0.05 all KL = 0.01 +- 0.074 (in-sample avg dev_std = 0.079)
NEC for r=0.05 all L1 = 0.01 +- 0.061 (in-sample avg dev_std = 0.079)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009945599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.874
NEC for r=0.1 class 0.0 = 0.0 +- 0.077 (in-sample avg dev_std = 0.088)
NEC for r=0.1 class 1.0 = 0.021 +- 0.077 (in-sample avg dev_std = 0.088)
NEC for r=0.1 all KL = 0.011 +- 0.077 (in-sample avg dev_std = 0.088)
NEC for r=0.1 all L1 = 0.011 +- 0.062 (in-sample avg dev_std = 0.088)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009889
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.873
NEC for r=0.2 class 0.0 = 0.001 +- 0.084 (in-sample avg dev_std = 0.096)
NEC for r=0.2 class 1.0 = 0.023 +- 0.084 (in-sample avg dev_std = 0.096)
NEC for r=0.2 all KL = 0.013 +- 0.084 (in-sample avg dev_std = 0.096)
NEC for r=0.2 all L1 = 0.012 +- 0.065 (in-sample avg dev_std = 0.096)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.874
NEC for r=0.4 class 0.0 = 0.0 +- 0.077 (in-sample avg dev_std = 0.088)
NEC for r=0.4 class 1.0 = 0.021 +- 0.077 (in-sample avg dev_std = 0.088)
NEC for r=0.4 all KL = 0.011 +- 0.077 (in-sample avg dev_std = 0.088)
NEC for r=0.4 all L1 = 0.011 +- 0.061 (in-sample avg dev_std = 0.088)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.874
NEC for r=0.8 class 0.0 = 0.001 +- 0.078 (in-sample avg dev_std = 0.093)
NEC for r=0.8 class 1.0 = 0.022 +- 0.078 (in-sample avg dev_std = 0.093)
NEC for r=0.8 all KL = 0.012 +- 0.078 (in-sample avg dev_std = 0.093)
NEC for r=0.8 all L1 = 0.011 +- 0.060 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0331508
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.973
NEC for r=0.05 class 0.0 = 0.008 +- 0.119 (in-sample avg dev_std = 0.032)
NEC for r=0.05 class 1.0 = 0.022 +- 0.119 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all KL = 0.016 +- 0.119 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all L1 = 0.015 +- 0.104 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.972
NEC for r=0.1 class 0.0 = 0.012 +- 0.138 (in-sample avg dev_std = 0.044)
NEC for r=0.1 class 1.0 = 0.028 +- 0.138 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all KL = 0.022 +- 0.138 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all L1 = 0.02 +- 0.119 (in-sample avg dev_std = 0.044)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0508582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.97
NEC for r=0.2 class 0.0 = 0.019 +- 0.166 (in-sample avg dev_std = 0.095)
NEC for r=0.2 class 1.0 = 0.036 +- 0.166 (in-sample avg dev_std = 0.095)
NEC for r=0.2 all KL = 0.033 +- 0.166 (in-sample avg dev_std = 0.095)
NEC for r=0.2 all L1 = 0.028 +- 0.139 (in-sample avg dev_std = 0.095)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0630722
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.968
NEC for r=0.4 class 0.0 = 0.021 +- 0.183 (in-sample avg dev_std = 0.168)
NEC for r=0.4 class 1.0 = 0.044 +- 0.183 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all KL = 0.043 +- 0.183 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all L1 = 0.033 +- 0.141 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.979
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0781998
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.969
NEC for r=0.8 class 0.0 = 0.026 +- 0.193 (in-sample avg dev_std = 0.236)
NEC for r=0.8 class 1.0 = 0.048 +- 0.193 (in-sample avg dev_std = 0.236)
NEC for r=0.8 all KL = 0.056 +- 0.193 (in-sample avg dev_std = 0.236)
NEC for r=0.8 all L1 = 0.037 +- 0.133 (in-sample avg dev_std = 0.236)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 00:46:41 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:46:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.058
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.068
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.077
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.081
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.044
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.055
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.067
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057848
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.994
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.121 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.984 +- 0.121 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all KL = 0.978 +- 0.121 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.05 all L1 = 0.99 +- 0.055 (in-sample avg dev_std = 0.145)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06810000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.995
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.112 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.985 +- 0.112 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.1 all KL = 0.981 +- 0.112 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.1 all L1 = 0.992 +- 0.050 (in-sample avg dev_std = 0.136)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07681600000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.997
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.092 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.991 +- 0.092 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.2 all KL = 0.987 +- 0.092 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.2 all L1 = 0.995 +- 0.040 (in-sample avg dev_std = 0.110)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08120999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.996
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.102 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.102 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all KL = 0.982 +- 0.102 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all L1 = 0.993 +- 0.040 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.083534
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.996
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.095 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.991 +- 0.095 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 all KL = 0.987 +- 0.095 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 all L1 = 0.994 +- 0.055 (in-sample avg dev_std = 0.105)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092894
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.94
SUFF_SIMPLE for r=0.05 class 0.0 = 0.984 +- 0.107 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.107 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all KL = 0.978 +- 0.107 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.05 all L1 = 0.992 +- 0.042 (in-sample avg dev_std = 0.128)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092764
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.941
SUFF_SIMPLE for r=0.1 class 0.0 = 0.987 +- 0.098 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.098 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.1 all KL = 0.982 +- 0.098 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.1 all L1 = 0.993 +- 0.038 (in-sample avg dev_std = 0.115)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009251599999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.941
SUFF_SIMPLE for r=0.2 class 0.0 = 0.986 +- 0.101 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.101 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.2 all KL = 0.981 +- 0.101 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.2 all L1 = 0.992 +- 0.040 (in-sample avg dev_std = 0.119)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0092452
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.941
SUFF_SIMPLE for r=0.4 class 0.0 = 0.986 +- 0.102 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.102 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.4 all KL = 0.98 +- 0.102 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.4 all L1 = 0.992 +- 0.040 (in-sample avg dev_std = 0.120)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0092438
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.94
SUFF_SIMPLE for r=0.8 class 0.0 = 0.986 +- 0.104 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.104 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.8 all KL = 0.981 +- 0.104 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.8 all L1 = 0.992 +- 0.045 (in-sample avg dev_std = 0.120)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035731200000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.961
SUFF_SIMPLE for r=0.05 class 0.0 = 0.954 +- 0.224 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.969 +- 0.224 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.05 all KL = 0.931 +- 0.224 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.05 all L1 = 0.961 +- 0.139 (in-sample avg dev_std = 0.249)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0443548
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.961
SUFF_SIMPLE for r=0.1 class 0.0 = 0.955 +- 0.219 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.971 +- 0.219 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 all KL = 0.936 +- 0.219 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 all L1 = 0.963 +- 0.140 (in-sample avg dev_std = 0.235)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05519400000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.959
SUFF_SIMPLE for r=0.2 class 0.0 = 0.955 +- 0.207 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.975 +- 0.207 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.2 all KL = 0.945 +- 0.207 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.2 all L1 = 0.965 +- 0.147 (in-sample avg dev_std = 0.190)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0674132
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.964
SUFF_SIMPLE for r=0.4 class 0.0 = 0.961 +- 0.194 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.98 +- 0.194 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.4 all KL = 0.951 +- 0.194 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.4 all L1 = 0.97 +- 0.130 (in-sample avg dev_std = 0.185)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0811432
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.964
SUFF_SIMPLE for r=0.8 class 0.0 = 0.983 +- 0.210 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.949 +- 0.210 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.210 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.8 all L1 = 0.966 +- 0.130 (in-sample avg dev_std = 0.223)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057848
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.0 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.003 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06810000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.999
NEC for r=0.1 class 0.0 = 0.0 +- 0.040 (in-sample avg dev_std = 0.046)
NEC for r=0.1 class 1.0 = 0.002 +- 0.040 (in-sample avg dev_std = 0.046)
NEC for r=0.1 all KL = 0.002 +- 0.040 (in-sample avg dev_std = 0.046)
NEC for r=0.1 all L1 = 0.001 +- 0.024 (in-sample avg dev_std = 0.046)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07681600000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.0 +- 0.062 (in-sample avg dev_std = 0.075)
NEC for r=0.2 class 1.0 = 0.005 +- 0.062 (in-sample avg dev_std = 0.075)
NEC for r=0.2 all KL = 0.006 +- 0.062 (in-sample avg dev_std = 0.075)
NEC for r=0.2 all L1 = 0.003 +- 0.026 (in-sample avg dev_std = 0.075)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08120999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
NEC for r=0.4 class 0.0 = 0.0 +- 0.080 (in-sample avg dev_std = 0.094)
NEC for r=0.4 class 1.0 = 0.007 +- 0.080 (in-sample avg dev_std = 0.094)
NEC for r=0.4 all KL = 0.009 +- 0.080 (in-sample avg dev_std = 0.094)
NEC for r=0.4 all L1 = 0.004 +- 0.037 (in-sample avg dev_std = 0.094)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.083534
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.0 +- 0.056 (in-sample avg dev_std = 0.068)
NEC for r=0.8 class 1.0 = 0.004 +- 0.056 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all KL = 0.005 +- 0.056 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all L1 = 0.002 +- 0.024 (in-sample avg dev_std = 0.068)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092894
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.944
NEC for r=0.05 class 0.0 = 0.002 +- 0.045 (in-sample avg dev_std = 0.048)
NEC for r=0.05 class 1.0 = 0.001 +- 0.045 (in-sample avg dev_std = 0.048)
NEC for r=0.05 all KL = 0.003 +- 0.045 (in-sample avg dev_std = 0.048)
NEC for r=0.05 all L1 = 0.001 +- 0.020 (in-sample avg dev_std = 0.048)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092764
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.944
NEC for r=0.1 class 0.0 = 0.002 +- 0.045 (in-sample avg dev_std = 0.052)
NEC for r=0.1 class 1.0 = 0.001 +- 0.045 (in-sample avg dev_std = 0.052)
NEC for r=0.1 all KL = 0.004 +- 0.045 (in-sample avg dev_std = 0.052)
NEC for r=0.1 all L1 = 0.001 +- 0.018 (in-sample avg dev_std = 0.052)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009251599999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.944
NEC for r=0.2 class 0.0 = 0.002 +- 0.045 (in-sample avg dev_std = 0.055)
NEC for r=0.2 class 1.0 = 0.001 +- 0.045 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all KL = 0.004 +- 0.045 (in-sample avg dev_std = 0.055)
NEC for r=0.2 all L1 = 0.002 +- 0.018 (in-sample avg dev_std = 0.055)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0092452
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.944
NEC for r=0.4 class 0.0 = 0.003 +- 0.049 (in-sample avg dev_std = 0.057)
NEC for r=0.4 class 1.0 = 0.001 +- 0.049 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all KL = 0.004 +- 0.049 (in-sample avg dev_std = 0.057)
NEC for r=0.4 all L1 = 0.002 +- 0.019 (in-sample avg dev_std = 0.057)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0092438
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.944
NEC for r=0.8 class 0.0 = 0.003 +- 0.046 (in-sample avg dev_std = 0.054)
NEC for r=0.8 class 1.0 = 0.0 +- 0.046 (in-sample avg dev_std = 0.054)
NEC for r=0.8 all KL = 0.004 +- 0.046 (in-sample avg dev_std = 0.054)
NEC for r=0.8 all L1 = 0.002 +- 0.018 (in-sample avg dev_std = 0.054)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035731200000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.983
NEC for r=0.05 class 0.0 = 0.006 +- 0.079 (in-sample avg dev_std = 0.038)
NEC for r=0.05 class 1.0 = 0.004 +- 0.079 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all KL = 0.007 +- 0.079 (in-sample avg dev_std = 0.038)
NEC for r=0.05 all L1 = 0.005 +- 0.064 (in-sample avg dev_std = 0.038)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0443548
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.98
NEC for r=0.1 class 0.0 = 0.01 +- 0.103 (in-sample avg dev_std = 0.065)
NEC for r=0.1 class 1.0 = 0.007 +- 0.103 (in-sample avg dev_std = 0.065)
NEC for r=0.1 all KL = 0.012 +- 0.103 (in-sample avg dev_std = 0.065)
NEC for r=0.1 all L1 = 0.009 +- 0.081 (in-sample avg dev_std = 0.065)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05519400000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.978
NEC for r=0.2 class 0.0 = 0.019 +- 0.126 (in-sample avg dev_std = 0.095)
NEC for r=0.2 class 1.0 = 0.007 +- 0.126 (in-sample avg dev_std = 0.095)
NEC for r=0.2 all KL = 0.019 +- 0.126 (in-sample avg dev_std = 0.095)
NEC for r=0.2 all L1 = 0.013 +- 0.094 (in-sample avg dev_std = 0.095)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0674132
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.976
NEC for r=0.4 class 0.0 = 0.024 +- 0.142 (in-sample avg dev_std = 0.134)
NEC for r=0.4 class 1.0 = 0.007 +- 0.142 (in-sample avg dev_std = 0.134)
NEC for r=0.4 all KL = 0.025 +- 0.142 (in-sample avg dev_std = 0.134)
NEC for r=0.4 all L1 = 0.016 +- 0.098 (in-sample avg dev_std = 0.134)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0811432
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.974
NEC for r=0.8 class 0.0 = 0.028 +- 0.169 (in-sample avg dev_std = 0.186)
NEC for r=0.8 class 1.0 = 0.013 +- 0.169 (in-sample avg dev_std = 0.186)
NEC for r=0.8 all KL = 0.038 +- 0.169 (in-sample avg dev_std = 0.186)
NEC for r=0.8 all L1 = 0.021 +- 0.102 (in-sample avg dev_std = 0.186)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:05:49 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:05:49 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.054
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.034
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05356
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.063 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.996 +- 0.063 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.05 all KL = 0.992 +- 0.063 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.05 all L1 = 0.996 +- 0.027 (in-sample avg dev_std = 0.088)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05660000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.997
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.083 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.993 +- 0.083 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.1 all KL = 0.989 +- 0.083 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.1 all L1 = 0.995 +- 0.044 (in-sample avg dev_std = 0.104)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065534
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.074 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.993 +- 0.074 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 all KL = 0.991 +- 0.074 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.2 all L1 = 0.996 +- 0.036 (in-sample avg dev_std = 0.094)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.074154
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.997
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.083 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.083 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.4 all KL = 0.988 +- 0.083 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.4 all L1 = 0.995 +- 0.040 (in-sample avg dev_std = 0.107)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.998
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.049 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.997 +- 0.049 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all KL = 0.997 +- 0.049 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.8 all L1 = 0.998 +- 0.040 (in-sample avg dev_std = 0.031)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009666999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.966
SUFF_SIMPLE for r=0.05 class 0.0 = 0.992 +- 0.084 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.084 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.05 all KL = 0.987 +- 0.084 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.05 all L1 = 0.994 +- 0.042 (in-sample avg dev_std = 0.108)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0096274
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.966
SUFF_SIMPLE for r=0.1 class 0.0 = 0.993 +- 0.080 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.996 +- 0.080 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.1 all KL = 0.988 +- 0.080 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.1 all L1 = 0.994 +- 0.040 (in-sample avg dev_std = 0.103)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096334
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.966
SUFF_SIMPLE for r=0.2 class 0.0 = 0.993 +- 0.082 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.995 +- 0.082 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.2 all KL = 0.988 +- 0.082 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.2 all L1 = 0.994 +- 0.043 (in-sample avg dev_std = 0.103)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009627600000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.966
SUFF_SIMPLE for r=0.4 class 0.0 = 0.993 +- 0.079 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.996 +- 0.079 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.4 all KL = 0.989 +- 0.079 (in-sample avg dev_std = 0.102)
SUFF_SIMPLE for r=0.4 all L1 = 0.994 +- 0.042 (in-sample avg dev_std = 0.102)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.966
SUFF_SIMPLE for r=0.8 class 0.0 = 0.992 +- 0.082 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.996 +- 0.082 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 all KL = 0.988 +- 0.082 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.8 all L1 = 0.994 +- 0.041 (in-sample avg dev_std = 0.103)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03395360000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.962
SUFF_SIMPLE for r=0.05 class 0.0 = 0.961 +- 0.239 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.945 +- 0.239 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 all KL = 0.922 +- 0.239 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 all L1 = 0.953 +- 0.156 (in-sample avg dev_std = 0.272)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042783
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.962
SUFF_SIMPLE for r=0.1 class 0.0 = 0.961 +- 0.237 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.946 +- 0.237 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.1 all KL = 0.925 +- 0.237 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.158 (in-sample avg dev_std = 0.264)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052482400000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.962
SUFF_SIMPLE for r=0.2 class 0.0 = 0.964 +- 0.220 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.953 +- 0.220 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all KL = 0.939 +- 0.220 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all L1 = 0.959 +- 0.159 (in-sample avg dev_std = 0.209)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06523179999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.966
SUFF_SIMPLE for r=0.4 class 0.0 = 0.968 +- 0.208 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.957 +- 0.208 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 all KL = 0.947 +- 0.208 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 all L1 = 0.962 +- 0.158 (in-sample avg dev_std = 0.176)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07869480000000001
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.976
SUFF_SIMPLE for r=0.8 class 0.0 = 0.986 +- 0.149 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.974 +- 0.149 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.8 all KL = 0.974 +- 0.149 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.8 all L1 = 0.98 +- 0.121 (in-sample avg dev_std = 0.084)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05356
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05660000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065534
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  1.0
NEC for r=0.2 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.074154
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  1.0
NEC for r=0.4 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  1.0
NEC for r=0.8 class 0.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009666999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.969
NEC for r=0.05 class 0.0 = 0.001 +- 0.038 (in-sample avg dev_std = 0.042)
NEC for r=0.05 class 1.0 = 0.001 +- 0.038 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all KL = 0.002 +- 0.038 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all L1 = 0.001 +- 0.022 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0096274
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.969
NEC for r=0.1 class 0.0 = 0.001 +- 0.039 (in-sample avg dev_std = 0.044)
NEC for r=0.1 class 1.0 = 0.001 +- 0.039 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all KL = 0.003 +- 0.039 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all L1 = 0.001 +- 0.021 (in-sample avg dev_std = 0.044)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096334
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.969
NEC for r=0.2 class 0.0 = 0.002 +- 0.043 (in-sample avg dev_std = 0.049)
NEC for r=0.2 class 1.0 = 0.001 +- 0.043 (in-sample avg dev_std = 0.049)
NEC for r=0.2 all KL = 0.003 +- 0.043 (in-sample avg dev_std = 0.049)
NEC for r=0.2 all L1 = 0.001 +- 0.023 (in-sample avg dev_std = 0.049)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009627600000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.969
NEC for r=0.4 class 0.0 = 0.001 +- 0.039 (in-sample avg dev_std = 0.047)
NEC for r=0.4 class 1.0 = 0.001 +- 0.039 (in-sample avg dev_std = 0.047)
NEC for r=0.4 all KL = 0.003 +- 0.039 (in-sample avg dev_std = 0.047)
NEC for r=0.4 all L1 = 0.001 +- 0.022 (in-sample avg dev_std = 0.047)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.969
NEC for r=0.8 class 0.0 = 0.001 +- 0.038 (in-sample avg dev_std = 0.046)
NEC for r=0.8 class 1.0 = 0.001 +- 0.038 (in-sample avg dev_std = 0.046)
NEC for r=0.8 all KL = 0.003 +- 0.038 (in-sample avg dev_std = 0.046)
NEC for r=0.8 all L1 = 0.001 +- 0.020 (in-sample avg dev_std = 0.046)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03395360000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.98
NEC for r=0.05 class 0.0 = 0.008 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.01 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.087 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042783
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.98
NEC for r=0.1 class 0.0 = 0.01 +- 0.116 (in-sample avg dev_std = 0.031)
NEC for r=0.1 class 1.0 = 0.014 +- 0.116 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.014 +- 0.116 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.012 +- 0.100 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052482400000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.977
NEC for r=0.2 class 0.0 = 0.014 +- 0.144 (in-sample avg dev_std = 0.094)
NEC for r=0.2 class 1.0 = 0.022 +- 0.144 (in-sample avg dev_std = 0.094)
NEC for r=0.2 all KL = 0.023 +- 0.144 (in-sample avg dev_std = 0.094)
NEC for r=0.2 all L1 = 0.018 +- 0.116 (in-sample avg dev_std = 0.094)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06523179999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.972
NEC for r=0.4 class 0.0 = 0.021 +- 0.175 (in-sample avg dev_std = 0.158)
NEC for r=0.4 class 1.0 = 0.03 +- 0.175 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all KL = 0.037 +- 0.175 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all L1 = 0.026 +- 0.128 (in-sample avg dev_std = 0.158)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07869480000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.973
NEC for r=0.8 class 0.0 = 0.024 +- 0.197 (in-sample avg dev_std = 0.227)
NEC for r=0.8 class 1.0 = 0.038 +- 0.197 (in-sample avg dev_std = 0.227)
NEC for r=0.8 all KL = 0.052 +- 0.197 (in-sample avg dev_std = 0.227)
NEC for r=0.8 all L1 = 0.031 +- 0.126 (in-sample avg dev_std = 0.227)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:25:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:25:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.057
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.059
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.011
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.011
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057002000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.974
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.217 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.934 +- 0.217 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all KL = 0.93 +- 0.217 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all L1 = 0.963 +- 0.125 (in-sample avg dev_std = 0.264)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05931
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.976
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.217 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.937 +- 0.217 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.1 all KL = 0.933 +- 0.217 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.1 all L1 = 0.965 +- 0.122 (in-sample avg dev_std = 0.263)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.974
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.225 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.934 +- 0.225 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.2 all KL = 0.928 +- 0.225 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.2 all L1 = 0.962 +- 0.125 (in-sample avg dev_std = 0.274)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076754
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.974
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.215 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.936 +- 0.215 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.4 all KL = 0.933 +- 0.215 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.4 all L1 = 0.964 +- 0.126 (in-sample avg dev_std = 0.259)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079788
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.972
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.198 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.946 +- 0.198 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all KL = 0.953 +- 0.198 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all L1 = 0.969 +- 0.138 (in-sample avg dev_std = 0.190)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010604599999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.995
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.100 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.988 +- 0.100 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all KL = 0.981 +- 0.100 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all L1 = 0.992 +- 0.045 (in-sample avg dev_std = 0.134)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010598999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.995
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.099 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.099 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 all KL = 0.982 +- 0.099 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.1 all L1 = 0.992 +- 0.044 (in-sample avg dev_std = 0.132)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010568200000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.995
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.098 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.989 +- 0.098 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all KL = 0.983 +- 0.098 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all L1 = 0.992 +- 0.046 (in-sample avg dev_std = 0.129)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01055
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.996
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.094 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.989 +- 0.094 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all KL = 0.984 +- 0.094 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.4 all L1 = 0.993 +- 0.043 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0105494
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.995
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.099 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.989 +- 0.099 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.8 all KL = 0.983 +- 0.099 (in-sample avg dev_std = 0.128)
SUFF_SIMPLE for r=0.8 all L1 = 0.992 +- 0.050 (in-sample avg dev_std = 0.128)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0329248
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.938
SUFF_SIMPLE for r=0.05 class 0.0 = 0.973 +- 0.296 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.875 +- 0.296 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 all KL = 0.879 +- 0.296 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.05 all L1 = 0.924 +- 0.199 (in-sample avg dev_std = 0.335)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0423122
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.937
SUFF_SIMPLE for r=0.1 class 0.0 = 0.974 +- 0.293 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.876 +- 0.293 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all KL = 0.882 +- 0.293 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.1 all L1 = 0.926 +- 0.197 (in-sample avg dev_std = 0.326)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053900199999999995
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.937
SUFF_SIMPLE for r=0.2 class 0.0 = 0.975 +- 0.281 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.885 +- 0.281 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.2 all KL = 0.896 +- 0.281 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.2 all L1 = 0.931 +- 0.202 (in-sample avg dev_std = 0.283)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0656808
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.946
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.258 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.905 +- 0.258 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.4 all KL = 0.916 +- 0.258 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.4 all L1 = 0.943 +- 0.189 (in-sample avg dev_std = 0.243)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.981
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791548
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.955
SUFF_SIMPLE for r=0.8 class 0.0 = 0.993 +- 0.213 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.924 +- 0.213 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.213 (in-sample avg dev_std = 0.124)
SUFF_SIMPLE for r=0.8 all L1 = 0.959 +- 0.172 (in-sample avg dev_std = 0.124)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057002000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.992
NEC for r=0.05 class 0.0 = 0.0 +- 0.098 (in-sample avg dev_std = 0.065)
NEC for r=0.05 class 1.0 = 0.014 +- 0.098 (in-sample avg dev_std = 0.065)
NEC for r=0.05 all KL = 0.01 +- 0.098 (in-sample avg dev_std = 0.065)
NEC for r=0.05 all L1 = 0.008 +- 0.077 (in-sample avg dev_std = 0.065)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05931
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.997
NEC for r=0.1 class 0.0 = 0.0 +- 0.087 (in-sample avg dev_std = 0.098)
NEC for r=0.1 class 1.0 = 0.009 +- 0.087 (in-sample avg dev_std = 0.098)
NEC for r=0.1 all KL = 0.009 +- 0.087 (in-sample avg dev_std = 0.098)
NEC for r=0.1 all L1 = 0.005 +- 0.050 (in-sample avg dev_std = 0.098)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.996
NEC for r=0.2 class 0.0 = 0.0 +- 0.099 (in-sample avg dev_std = 0.121)
NEC for r=0.2 class 1.0 = 0.013 +- 0.099 (in-sample avg dev_std = 0.121)
NEC for r=0.2 all KL = 0.015 +- 0.099 (in-sample avg dev_std = 0.121)
NEC for r=0.2 all L1 = 0.007 +- 0.049 (in-sample avg dev_std = 0.121)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076754
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.997
NEC for r=0.4 class 0.0 = 0.0 +- 0.082 (in-sample avg dev_std = 0.101)
NEC for r=0.4 class 1.0 = 0.009 +- 0.082 (in-sample avg dev_std = 0.101)
NEC for r=0.4 all KL = 0.011 +- 0.082 (in-sample avg dev_std = 0.101)
NEC for r=0.4 all L1 = 0.005 +- 0.039 (in-sample avg dev_std = 0.101)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079788
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.994
NEC for r=0.8 class 0.0 = 0.0 +- 0.112 (in-sample avg dev_std = 0.138)
NEC for r=0.8 class 1.0 = 0.016 +- 0.112 (in-sample avg dev_std = 0.138)
NEC for r=0.8 all KL = 0.019 +- 0.112 (in-sample avg dev_std = 0.138)
NEC for r=0.8 all L1 = 0.009 +- 0.055 (in-sample avg dev_std = 0.138)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010604599999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 0.0 = 0.001 +- 0.042 (in-sample avg dev_std = 0.052)
NEC for r=0.05 class 1.0 = 0.002 +- 0.042 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all KL = 0.003 +- 0.042 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all L1 = 0.001 +- 0.022 (in-sample avg dev_std = 0.052)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010598999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.999
NEC for r=0.1 class 0.0 = 0.001 +- 0.052 (in-sample avg dev_std = 0.065)
NEC for r=0.1 class 1.0 = 0.003 +- 0.052 (in-sample avg dev_std = 0.065)
NEC for r=0.1 all KL = 0.004 +- 0.052 (in-sample avg dev_std = 0.065)
NEC for r=0.1 all L1 = 0.002 +- 0.027 (in-sample avg dev_std = 0.065)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010568200000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.999
NEC for r=0.2 class 0.0 = 0.001 +- 0.044 (in-sample avg dev_std = 0.058)
NEC for r=0.2 class 1.0 = 0.002 +- 0.044 (in-sample avg dev_std = 0.058)
NEC for r=0.2 all KL = 0.004 +- 0.044 (in-sample avg dev_std = 0.058)
NEC for r=0.2 all L1 = 0.002 +- 0.020 (in-sample avg dev_std = 0.058)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01055
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.001 +- 0.040 (in-sample avg dev_std = 0.052)
NEC for r=0.4 class 1.0 = 0.002 +- 0.040 (in-sample avg dev_std = 0.052)
NEC for r=0.4 all KL = 0.003 +- 0.040 (in-sample avg dev_std = 0.052)
NEC for r=0.4 all L1 = 0.001 +- 0.017 (in-sample avg dev_std = 0.052)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0105494
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.002 +- 0.042 (in-sample avg dev_std = 0.057)
NEC for r=0.8 class 1.0 = 0.001 +- 0.042 (in-sample avg dev_std = 0.057)
NEC for r=0.8 all KL = 0.004 +- 0.042 (in-sample avg dev_std = 0.057)
NEC for r=0.8 all L1 = 0.002 +- 0.018 (in-sample avg dev_std = 0.057)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0329248
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.967
NEC for r=0.05 class 0.0 = 0.004 +- 0.145 (in-sample avg dev_std = 0.032)
NEC for r=0.05 class 1.0 = 0.035 +- 0.145 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all KL = 0.022 +- 0.145 (in-sample avg dev_std = 0.032)
NEC for r=0.05 all L1 = 0.019 +- 0.125 (in-sample avg dev_std = 0.032)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0423122
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.963
NEC for r=0.1 class 0.0 = 0.005 +- 0.174 (in-sample avg dev_std = 0.080)
NEC for r=0.1 class 1.0 = 0.05 +- 0.174 (in-sample avg dev_std = 0.080)
NEC for r=0.1 all KL = 0.033 +- 0.174 (in-sample avg dev_std = 0.080)
NEC for r=0.1 all L1 = 0.027 +- 0.145 (in-sample avg dev_std = 0.080)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053900199999999995
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.962
NEC for r=0.2 class 0.0 = 0.009 +- 0.202 (in-sample avg dev_std = 0.153)
NEC for r=0.2 class 1.0 = 0.062 +- 0.202 (in-sample avg dev_std = 0.153)
NEC for r=0.2 all KL = 0.048 +- 0.202 (in-sample avg dev_std = 0.153)
NEC for r=0.2 all L1 = 0.035 +- 0.156 (in-sample avg dev_std = 0.153)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0656808
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.96
NEC for r=0.4 class 0.0 = 0.01 +- 0.218 (in-sample avg dev_std = 0.216)
NEC for r=0.4 class 1.0 = 0.07 +- 0.218 (in-sample avg dev_std = 0.216)
NEC for r=0.4 all KL = 0.06 +- 0.218 (in-sample avg dev_std = 0.216)
NEC for r=0.4 all L1 = 0.04 +- 0.154 (in-sample avg dev_std = 0.216)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791548
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.958
NEC for r=0.8 class 0.0 = 0.014 +- 0.242 (in-sample avg dev_std = 0.281)
NEC for r=0.8 class 1.0 = 0.082 +- 0.242 (in-sample avg dev_std = 0.281)
NEC for r=0.8 all KL = 0.08 +- 0.242 (in-sample avg dev_std = 0.281)
NEC for r=0.8 all L1 = 0.048 +- 0.154 (in-sample avg dev_std = 0.281)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 01:43:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:43:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.044
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.068
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.076
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.029
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044073999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.994
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.101 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.986 +- 0.101 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.05 all KL = 0.983 +- 0.101 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.05 all L1 = 0.99 +- 0.059 (in-sample avg dev_std = 0.133)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057314
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.993
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.102 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.984 +- 0.102 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.981 +- 0.102 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.989 +- 0.061 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.068084
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.996
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.085 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.085 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.2 all KL = 0.987 +- 0.085 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.2 all L1 = 0.993 +- 0.047 (in-sample avg dev_std = 0.113)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07598400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.994
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.101 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.985 +- 0.101 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all KL = 0.982 +- 0.101 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.4 all L1 = 0.99 +- 0.057 (in-sample avg dev_std = 0.138)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.996
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.067 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.992 +- 0.067 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.8 all KL = 0.991 +- 0.067 (in-sample avg dev_std = 0.080)
SUFF_SIMPLE for r=0.8 all L1 = 0.995 +- 0.046 (in-sample avg dev_std = 0.080)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.744
SUFF_SIMPLE for r=0.05 class 0.0 = 1.0 +- 0.283 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.826 +- 0.283 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.05 all KL = 0.881 +- 0.283 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.05 all L1 = 0.912 +- 0.215 (in-sample avg dev_std = 0.315)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093206
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.744
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.281 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.827 +- 0.281 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.1 all KL = 0.881 +- 0.281 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.1 all L1 = 0.913 +- 0.213 (in-sample avg dev_std = 0.311)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094224
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.743
SUFF_SIMPLE for r=0.2 class 0.0 = 1.0 +- 0.284 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.822 +- 0.284 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.2 all KL = 0.878 +- 0.284 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.216 (in-sample avg dev_std = 0.320)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094386
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.744
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.282 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.826 +- 0.282 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.4 all KL = 0.881 +- 0.282 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.4 all L1 = 0.912 +- 0.214 (in-sample avg dev_std = 0.315)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0094424
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.746
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.277 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.834 +- 0.277 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.8 all KL = 0.889 +- 0.277 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.8 all L1 = 0.916 +- 0.213 (in-sample avg dev_std = 0.298)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029376999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.958
SUFF_SIMPLE for r=0.05 class 0.0 = 0.96 +- 0.233 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.941 +- 0.233 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.05 all KL = 0.921 +- 0.233 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.05 all L1 = 0.95 +- 0.156 (in-sample avg dev_std = 0.287)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0362364
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.957
SUFF_SIMPLE for r=0.1 class 0.0 = 0.96 +- 0.234 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.94 +- 0.234 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.1 all KL = 0.923 +- 0.234 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.1 all L1 = 0.95 +- 0.160 (in-sample avg dev_std = 0.278)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.046014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.955
SUFF_SIMPLE for r=0.2 class 0.0 = 0.962 +- 0.225 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.944 +- 0.225 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all KL = 0.931 +- 0.225 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all L1 = 0.953 +- 0.165 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05965340000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.956
SUFF_SIMPLE for r=0.4 class 0.0 = 0.968 +- 0.219 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.944 +- 0.219 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.4 all KL = 0.94 +- 0.219 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.4 all L1 = 0.956 +- 0.166 (in-sample avg dev_std = 0.204)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0769752
len(reference) = 4955
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.974
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.144 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.977 +- 0.144 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.8 all KL = 0.977 +- 0.144 (in-sample avg dev_std = 0.061)
SUFF_SIMPLE for r=0.8 all L1 = 0.981 +- 0.121 (in-sample avg dev_std = 0.061)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044073999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.0 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.003 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057314
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.0 +- 0.046 (in-sample avg dev_std = 0.019)
NEC for r=0.1 class 1.0 = 0.004 +- 0.046 (in-sample avg dev_std = 0.019)
NEC for r=0.1 all KL = 0.003 +- 0.046 (in-sample avg dev_std = 0.019)
NEC for r=0.1 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.019)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.068084
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.0 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.003 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07598400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.999
NEC for r=0.4 class 0.0 = 0.0 +- 0.046 (in-sample avg dev_std = 0.058)
NEC for r=0.4 class 1.0 = 0.003 +- 0.046 (in-sample avg dev_std = 0.058)
NEC for r=0.4 all KL = 0.003 +- 0.046 (in-sample avg dev_std = 0.058)
NEC for r=0.4 all L1 = 0.002 +- 0.025 (in-sample avg dev_std = 0.058)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.999
NEC for r=0.8 class 0.0 = 0.001 +- 0.045 (in-sample avg dev_std = 0.056)
NEC for r=0.8 class 1.0 = 0.003 +- 0.045 (in-sample avg dev_std = 0.056)
NEC for r=0.8 all KL = 0.003 +- 0.045 (in-sample avg dev_std = 0.056)
NEC for r=0.8 all L1 = 0.002 +- 0.026 (in-sample avg dev_std = 0.056)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.789
NEC for r=0.05 class 0.0 = 0.0 +- 0.185 (in-sample avg dev_std = 0.184)
NEC for r=0.05 class 1.0 = 0.071 +- 0.185 (in-sample avg dev_std = 0.184)
NEC for r=0.05 all KL = 0.045 +- 0.185 (in-sample avg dev_std = 0.184)
NEC for r=0.05 all L1 = 0.036 +- 0.146 (in-sample avg dev_std = 0.184)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093206
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.789
NEC for r=0.1 class 0.0 = 0.0 +- 0.184 (in-sample avg dev_std = 0.195)
NEC for r=0.1 class 1.0 = 0.071 +- 0.184 (in-sample avg dev_std = 0.195)
NEC for r=0.1 all KL = 0.048 +- 0.184 (in-sample avg dev_std = 0.195)
NEC for r=0.1 all L1 = 0.036 +- 0.141 (in-sample avg dev_std = 0.195)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094224
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.788
NEC for r=0.2 class 0.0 = 0.0 +- 0.187 (in-sample avg dev_std = 0.208)
NEC for r=0.2 class 1.0 = 0.075 +- 0.187 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all KL = 0.051 +- 0.187 (in-sample avg dev_std = 0.208)
NEC for r=0.2 all L1 = 0.038 +- 0.142 (in-sample avg dev_std = 0.208)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094386
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.788
NEC for r=0.4 class 0.0 = 0.0 +- 0.185 (in-sample avg dev_std = 0.206)
NEC for r=0.4 class 1.0 = 0.074 +- 0.185 (in-sample avg dev_std = 0.206)
NEC for r=0.4 all KL = 0.051 +- 0.185 (in-sample avg dev_std = 0.206)
NEC for r=0.4 all L1 = 0.037 +- 0.140 (in-sample avg dev_std = 0.206)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0094424
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.788
NEC for r=0.8 class 0.0 = 0.0 +- 0.188 (in-sample avg dev_std = 0.207)
NEC for r=0.8 class 1.0 = 0.076 +- 0.188 (in-sample avg dev_std = 0.207)
NEC for r=0.8 all KL = 0.052 +- 0.188 (in-sample avg dev_std = 0.207)
NEC for r=0.8 all L1 = 0.038 +- 0.143 (in-sample avg dev_std = 0.207)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029376999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.981
NEC for r=0.05 class 0.0 = 0.007 +- 0.103 (in-sample avg dev_std = 0.014)
NEC for r=0.05 class 1.0 = 0.012 +- 0.103 (in-sample avg dev_std = 0.014)
NEC for r=0.05 all KL = 0.011 +- 0.103 (in-sample avg dev_std = 0.014)
NEC for r=0.05 all L1 = 0.01 +- 0.089 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0362364
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.978
NEC for r=0.1 class 0.0 = 0.01 +- 0.118 (in-sample avg dev_std = 0.028)
NEC for r=0.1 class 1.0 = 0.016 +- 0.118 (in-sample avg dev_std = 0.028)
NEC for r=0.1 all KL = 0.015 +- 0.118 (in-sample avg dev_std = 0.028)
NEC for r=0.1 all L1 = 0.013 +- 0.102 (in-sample avg dev_std = 0.028)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.046014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.972
NEC for r=0.2 class 0.0 = 0.015 +- 0.147 (in-sample avg dev_std = 0.099)
NEC for r=0.2 class 1.0 = 0.025 +- 0.147 (in-sample avg dev_std = 0.099)
NEC for r=0.2 all KL = 0.025 +- 0.147 (in-sample avg dev_std = 0.099)
NEC for r=0.2 all L1 = 0.02 +- 0.119 (in-sample avg dev_std = 0.099)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05965340000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.968
NEC for r=0.4 class 0.0 = 0.02 +- 0.177 (in-sample avg dev_std = 0.175)
NEC for r=0.4 class 1.0 = 0.037 +- 0.177 (in-sample avg dev_std = 0.175)
NEC for r=0.4 all KL = 0.04 +- 0.177 (in-sample avg dev_std = 0.175)
NEC for r=0.4 all L1 = 0.028 +- 0.131 (in-sample avg dev_std = 0.175)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0769752
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.969
NEC for r=0.8 class 0.0 = 0.022 +- 0.189 (in-sample avg dev_std = 0.233)
NEC for r=0.8 class 1.0 = 0.042 +- 0.189 (in-sample avg dev_std = 0.233)
NEC for r=0.8 all KL = 0.051 +- 0.189 (in-sample avg dev_std = 0.233)
NEC for r=0.8 all L1 = 0.032 +- 0.124 (in-sample avg dev_std = 0.233)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:02:40 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:02:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.048
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.058
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.065
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.075
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.011
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.011
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.033
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.043
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.058
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04773600000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.987
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.147 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.963 +- 0.147 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.05 all KL = 0.957 +- 0.147 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.05 all L1 = 0.978 +- 0.076 (in-sample avg dev_std = 0.215)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057894
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.99
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.131 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.97 +- 0.131 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.1 all KL = 0.967 +- 0.131 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.1 all L1 = 0.983 +- 0.068 (in-sample avg dev_std = 0.192)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065108
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.989
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.136 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.969 +- 0.136 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all KL = 0.964 +- 0.136 (in-sample avg dev_std = 0.197)
SUFF_SIMPLE for r=0.2 all L1 = 0.982 +- 0.070 (in-sample avg dev_std = 0.197)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07490999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.988
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.143 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.967 +- 0.143 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.143 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.4 all L1 = 0.98 +- 0.078 (in-sample avg dev_std = 0.200)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08053
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.988
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.135 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.975 +- 0.135 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.8 all KL = 0.977 +- 0.135 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.8 all L1 = 0.985 +- 0.092 (in-sample avg dev_std = 0.150)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010719800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.858
SUFF_SIMPLE for r=0.05 class 0.0 = 0.991 +- 0.102 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.986 +- 0.102 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.05 all KL = 0.977 +- 0.102 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.05 all L1 = 0.989 +- 0.050 (in-sample avg dev_std = 0.150)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0107042
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.859
SUFF_SIMPLE for r=0.1 class 0.0 = 0.993 +- 0.092 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.092 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all KL = 0.981 +- 0.092 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.1 all L1 = 0.991 +- 0.044 (in-sample avg dev_std = 0.134)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010694
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.86
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.087 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.989 +- 0.087 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 all KL = 0.984 +- 0.087 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.2 all L1 = 0.992 +- 0.043 (in-sample avg dev_std = 0.126)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.859
SUFF_SIMPLE for r=0.4 class 0.0 = 0.993 +- 0.094 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.988 +- 0.094 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.4 all KL = 0.981 +- 0.094 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.4 all L1 = 0.991 +- 0.046 (in-sample avg dev_std = 0.135)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.859
SUFF_SIMPLE for r=0.8 class 0.0 = 0.994 +- 0.090 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.090 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.8 all KL = 0.985 +- 0.090 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.8 all L1 = 0.992 +- 0.050 (in-sample avg dev_std = 0.121)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024968
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.933
SUFF_SIMPLE for r=0.05 class 0.0 = 0.953 +- 0.282 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.878 +- 0.282 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.05 all KL = 0.868 +- 0.282 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.05 all L1 = 0.916 +- 0.194 (in-sample avg dev_std = 0.353)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03285
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.933
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.279 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.882 +- 0.279 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.1 all KL = 0.872 +- 0.279 (in-sample avg dev_std = 0.341)
SUFF_SIMPLE for r=0.1 all L1 = 0.917 +- 0.195 (in-sample avg dev_std = 0.341)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043273200000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.936
SUFF_SIMPLE for r=0.2 class 0.0 = 0.958 +- 0.265 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.89 +- 0.265 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.265 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.2 all L1 = 0.924 +- 0.190 (in-sample avg dev_std = 0.303)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0580692
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.941
SUFF_SIMPLE for r=0.4 class 0.0 = 0.961 +- 0.251 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.905 +- 0.251 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 all KL = 0.896 +- 0.251 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 all L1 = 0.933 +- 0.179 (in-sample avg dev_std = 0.287)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0773802
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.912
SUFF_SIMPLE for r=0.8 class 0.0 = 0.983 +- 0.315 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.815 +- 0.315 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.8 all KL = 0.854 +- 0.315 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.8 all L1 = 0.9 +- 0.223 (in-sample avg dev_std = 0.391)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04773600000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.0 +- 0.067 (in-sample avg dev_std = 0.084)
NEC for r=0.05 class 1.0 = 0.006 +- 0.067 (in-sample avg dev_std = 0.084)
NEC for r=0.05 all KL = 0.006 +- 0.067 (in-sample avg dev_std = 0.084)
NEC for r=0.05 all L1 = 0.004 +- 0.042 (in-sample avg dev_std = 0.084)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057894
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.995
NEC for r=0.1 class 0.0 = 0.0 +- 0.096 (in-sample avg dev_std = 0.123)
NEC for r=0.1 class 1.0 = 0.013 +- 0.096 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all KL = 0.013 +- 0.096 (in-sample avg dev_std = 0.123)
NEC for r=0.1 all L1 = 0.007 +- 0.057 (in-sample avg dev_std = 0.123)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065108
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.998
NEC for r=0.2 class 0.0 = 0.0 +- 0.068 (in-sample avg dev_std = 0.093)
NEC for r=0.2 class 1.0 = 0.007 +- 0.068 (in-sample avg dev_std = 0.093)
NEC for r=0.2 all KL = 0.008 +- 0.068 (in-sample avg dev_std = 0.093)
NEC for r=0.2 all L1 = 0.004 +- 0.036 (in-sample avg dev_std = 0.093)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07490999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.998
NEC for r=0.4 class 0.0 = 0.0 +- 0.060 (in-sample avg dev_std = 0.082)
NEC for r=0.4 class 1.0 = 0.006 +- 0.060 (in-sample avg dev_std = 0.082)
NEC for r=0.4 all KL = 0.006 +- 0.060 (in-sample avg dev_std = 0.082)
NEC for r=0.4 all L1 = 0.003 +- 0.034 (in-sample avg dev_std = 0.082)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08053
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.996
NEC for r=0.8 class 0.0 = 0.0 +- 0.087 (in-sample avg dev_std = 0.127)
NEC for r=0.8 class 1.0 = 0.013 +- 0.087 (in-sample avg dev_std = 0.127)
NEC for r=0.8 all KL = 0.014 +- 0.087 (in-sample avg dev_std = 0.127)
NEC for r=0.8 all L1 = 0.007 +- 0.046 (in-sample avg dev_std = 0.127)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010719800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.862
NEC for r=0.05 class 0.0 = 0.002 +- 0.060 (in-sample avg dev_std = 0.073)
NEC for r=0.05 class 1.0 = 0.004 +- 0.060 (in-sample avg dev_std = 0.073)
NEC for r=0.05 all KL = 0.005 +- 0.060 (in-sample avg dev_std = 0.073)
NEC for r=0.05 all L1 = 0.003 +- 0.037 (in-sample avg dev_std = 0.073)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0107042
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.863
NEC for r=0.1 class 0.0 = 0.001 +- 0.050 (in-sample avg dev_std = 0.069)
NEC for r=0.1 class 1.0 = 0.004 +- 0.050 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all KL = 0.004 +- 0.050 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all L1 = 0.002 +- 0.027 (in-sample avg dev_std = 0.069)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010694
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.863
NEC for r=0.2 class 0.0 = 0.001 +- 0.048 (in-sample avg dev_std = 0.070)
NEC for r=0.2 class 1.0 = 0.004 +- 0.048 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all KL = 0.005 +- 0.048 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all L1 = 0.003 +- 0.025 (in-sample avg dev_std = 0.070)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.863
NEC for r=0.4 class 0.0 = 0.001 +- 0.051 (in-sample avg dev_std = 0.076)
NEC for r=0.4 class 1.0 = 0.004 +- 0.051 (in-sample avg dev_std = 0.076)
NEC for r=0.4 all KL = 0.006 +- 0.051 (in-sample avg dev_std = 0.076)
NEC for r=0.4 all L1 = 0.003 +- 0.024 (in-sample avg dev_std = 0.076)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.863
NEC for r=0.8 class 0.0 = 0.0 +- 0.045 (in-sample avg dev_std = 0.069)
NEC for r=0.8 class 1.0 = 0.004 +- 0.045 (in-sample avg dev_std = 0.069)
NEC for r=0.8 all KL = 0.005 +- 0.045 (in-sample avg dev_std = 0.069)
NEC for r=0.8 all L1 = 0.002 +- 0.022 (in-sample avg dev_std = 0.069)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024968
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.982
NEC for r=0.05 class 0.0 = 0.01 +- 0.110 (in-sample avg dev_std = 0.094)
NEC for r=0.05 class 1.0 = 0.013 +- 0.110 (in-sample avg dev_std = 0.094)
NEC for r=0.05 all KL = 0.014 +- 0.110 (in-sample avg dev_std = 0.094)
NEC for r=0.05 all L1 = 0.011 +- 0.086 (in-sample avg dev_std = 0.094)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03285
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.978
NEC for r=0.1 class 0.0 = 0.013 +- 0.130 (in-sample avg dev_std = 0.116)
NEC for r=0.1 class 1.0 = 0.019 +- 0.130 (in-sample avg dev_std = 0.116)
NEC for r=0.1 all KL = 0.022 +- 0.130 (in-sample avg dev_std = 0.116)
NEC for r=0.1 all L1 = 0.016 +- 0.099 (in-sample avg dev_std = 0.116)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043273200000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.974
NEC for r=0.2 class 0.0 = 0.016 +- 0.151 (in-sample avg dev_std = 0.154)
NEC for r=0.2 class 1.0 = 0.027 +- 0.151 (in-sample avg dev_std = 0.154)
NEC for r=0.2 all KL = 0.032 +- 0.151 (in-sample avg dev_std = 0.154)
NEC for r=0.2 all L1 = 0.022 +- 0.109 (in-sample avg dev_std = 0.154)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0580692
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.97
NEC for r=0.4 class 0.0 = 0.025 +- 0.170 (in-sample avg dev_std = 0.185)
NEC for r=0.4 class 1.0 = 0.031 +- 0.170 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all KL = 0.042 +- 0.170 (in-sample avg dev_std = 0.185)
NEC for r=0.4 all L1 = 0.028 +- 0.120 (in-sample avg dev_std = 0.185)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0773802
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.968
NEC for r=0.8 class 0.0 = 0.028 +- 0.196 (in-sample avg dev_std = 0.249)
NEC for r=0.8 class 1.0 = 0.046 +- 0.196 (in-sample avg dev_std = 0.249)
NEC for r=0.8 all KL = 0.061 +- 0.196 (in-sample avg dev_std = 0.249)
NEC for r=0.8 all L1 = 0.037 +- 0.126 (in-sample avg dev_std = 0.249)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:22:18 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:22:18 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.058
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.067
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.053
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057756
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.98
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.220 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.94 +- 0.220 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all KL = 0.919 +- 0.220 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all L1 = 0.966 +- 0.095 (in-sample avg dev_std = 0.264)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06705199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.977
SUFF_SIMPLE for r=0.1 class 0.0 = 1.0 +- 0.229 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.934 +- 0.229 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.1 all KL = 0.917 +- 0.229 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.1 all L1 = 0.963 +- 0.108 (in-sample avg dev_std = 0.274)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07347
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.979
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.219 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.94 +- 0.219 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.2 all KL = 0.921 +- 0.219 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.2 all L1 = 0.966 +- 0.099 (in-sample avg dev_std = 0.261)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.079888
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.978
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.220 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.938 +- 0.220 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 all KL = 0.924 +- 0.220 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 all L1 = 0.965 +- 0.108 (in-sample avg dev_std = 0.261)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08387799999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.965
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.237 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.925 +- 0.237 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 all KL = 0.926 +- 0.237 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.8 all L1 = 0.958 +- 0.149 (in-sample avg dev_std = 0.241)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0093914
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.713
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.357 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.559 +- 0.357 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.05 all KL = 0.725 +- 0.357 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.05 all L1 = 0.777 +- 0.290 (in-sample avg dev_std = 0.391)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.712
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.357 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.559 +- 0.357 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.1 all KL = 0.724 +- 0.357 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.1 all L1 = 0.777 +- 0.290 (in-sample avg dev_std = 0.388)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009567
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.713
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.357 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.56 +- 0.357 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.2 all KL = 0.725 +- 0.357 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.2 all L1 = 0.778 +- 0.289 (in-sample avg dev_std = 0.388)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602800000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.713
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.357 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.561 +- 0.357 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 all KL = 0.727 +- 0.357 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 all L1 = 0.778 +- 0.290 (in-sample avg dev_std = 0.386)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096094
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.714
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.355 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.566 +- 0.355 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.8 all KL = 0.734 +- 0.355 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.8 all L1 = 0.781 +- 0.292 (in-sample avg dev_std = 0.368)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034668399999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.909
SUFF_SIMPLE for r=0.05 class 0.0 = 0.975 +- 0.342 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.809 +- 0.342 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.05 all KL = 0.814 +- 0.342 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.05 all L1 = 0.893 +- 0.218 (in-sample avg dev_std = 0.401)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042652800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.906
SUFF_SIMPLE for r=0.1 class 0.0 = 0.975 +- 0.345 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.805 +- 0.345 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 all KL = 0.812 +- 0.345 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 all L1 = 0.891 +- 0.222 (in-sample avg dev_std = 0.403)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0529322
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.908
SUFF_SIMPLE for r=0.2 class 0.0 = 0.977 +- 0.336 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.817 +- 0.336 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.2 all KL = 0.826 +- 0.336 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.2 all L1 = 0.898 +- 0.220 (in-sample avg dev_std = 0.366)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06489980000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.911
SUFF_SIMPLE for r=0.4 class 0.0 = 0.974 +- 0.332 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.822 +- 0.332 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all KL = 0.829 +- 0.332 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.4 all L1 = 0.899 +- 0.221 (in-sample avg dev_std = 0.349)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0789312
len(reference) = 4975
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.904
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.335 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.81 +- 0.335 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.8 all KL = 0.848 +- 0.335 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.8 all L1 = 0.901 +- 0.232 (in-sample avg dev_std = 0.331)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057756
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.997
NEC for r=0.05 class 0.0 = 0.0 +- 0.065 (in-sample avg dev_std = 0.052)
NEC for r=0.05 class 1.0 = 0.005 +- 0.065 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all KL = 0.005 +- 0.065 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all L1 = 0.003 +- 0.042 (in-sample avg dev_std = 0.052)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06705199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.996
NEC for r=0.1 class 0.0 = 0.0 +- 0.086 (in-sample avg dev_std = 0.083)
NEC for r=0.1 class 1.0 = 0.009 +- 0.086 (in-sample avg dev_std = 0.083)
NEC for r=0.1 all KL = 0.009 +- 0.086 (in-sample avg dev_std = 0.083)
NEC for r=0.1 all L1 = 0.005 +- 0.050 (in-sample avg dev_std = 0.083)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07347
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.993
NEC for r=0.2 class 0.0 = 0.0 +- 0.132 (in-sample avg dev_std = 0.146)
NEC for r=0.2 class 1.0 = 0.019 +- 0.132 (in-sample avg dev_std = 0.146)
NEC for r=0.2 all KL = 0.023 +- 0.132 (in-sample avg dev_std = 0.146)
NEC for r=0.2 all L1 = 0.011 +- 0.064 (in-sample avg dev_std = 0.146)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.079888
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.995
NEC for r=0.4 class 0.0 = 0.0 +- 0.115 (in-sample avg dev_std = 0.129)
NEC for r=0.4 class 1.0 = 0.015 +- 0.115 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all KL = 0.018 +- 0.115 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all L1 = 0.008 +- 0.053 (in-sample avg dev_std = 0.129)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08387799999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.995
NEC for r=0.8 class 0.0 = 0.0 +- 0.113 (in-sample avg dev_std = 0.132)
NEC for r=0.8 class 1.0 = 0.015 +- 0.113 (in-sample avg dev_std = 0.132)
NEC for r=0.8 all KL = 0.021 +- 0.113 (in-sample avg dev_std = 0.132)
NEC for r=0.8 all L1 = 0.008 +- 0.044 (in-sample avg dev_std = 0.132)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0093914
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.807
NEC for r=0.05 class 0.0 = 0.0 +- 0.214 (in-sample avg dev_std = 0.215)
NEC for r=0.05 class 1.0 = 0.228 +- 0.214 (in-sample avg dev_std = 0.215)
NEC for r=0.05 all KL = 0.107 +- 0.214 (in-sample avg dev_std = 0.215)
NEC for r=0.05 all L1 = 0.115 +- 0.208 (in-sample avg dev_std = 0.215)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.808
NEC for r=0.1 class 0.0 = 0.0 +- 0.214 (in-sample avg dev_std = 0.232)
NEC for r=0.1 class 1.0 = 0.232 +- 0.214 (in-sample avg dev_std = 0.232)
NEC for r=0.1 all KL = 0.113 +- 0.214 (in-sample avg dev_std = 0.232)
NEC for r=0.1 all L1 = 0.117 +- 0.206 (in-sample avg dev_std = 0.232)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009567
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.808
NEC for r=0.2 class 0.0 = 0.0 +- 0.215 (in-sample avg dev_std = 0.245)
NEC for r=0.2 class 1.0 = 0.237 +- 0.215 (in-sample avg dev_std = 0.245)
NEC for r=0.2 all KL = 0.118 +- 0.215 (in-sample avg dev_std = 0.245)
NEC for r=0.2 all L1 = 0.12 +- 0.204 (in-sample avg dev_std = 0.245)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602800000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.809
NEC for r=0.4 class 0.0 = 0.0 +- 0.215 (in-sample avg dev_std = 0.252)
NEC for r=0.4 class 1.0 = 0.238 +- 0.215 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all KL = 0.121 +- 0.215 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all L1 = 0.12 +- 0.203 (in-sample avg dev_std = 0.252)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096094
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.808
NEC for r=0.8 class 0.0 = 0.0 +- 0.217 (in-sample avg dev_std = 0.259)
NEC for r=0.8 class 1.0 = 0.241 +- 0.217 (in-sample avg dev_std = 0.259)
NEC for r=0.8 all KL = 0.124 +- 0.217 (in-sample avg dev_std = 0.259)
NEC for r=0.8 all L1 = 0.122 +- 0.203 (in-sample avg dev_std = 0.259)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034668399999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.96
NEC for r=0.05 class 0.0 = 0.005 +- 0.180 (in-sample avg dev_std = 0.101)
NEC for r=0.05 class 1.0 = 0.057 +- 0.180 (in-sample avg dev_std = 0.101)
NEC for r=0.05 all KL = 0.038 +- 0.180 (in-sample avg dev_std = 0.101)
NEC for r=0.05 all L1 = 0.03 +- 0.146 (in-sample avg dev_std = 0.101)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042652800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.953
NEC for r=0.1 class 0.0 = 0.009 +- 0.213 (in-sample avg dev_std = 0.141)
NEC for r=0.1 class 1.0 = 0.075 +- 0.213 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all KL = 0.056 +- 0.213 (in-sample avg dev_std = 0.141)
NEC for r=0.1 all L1 = 0.041 +- 0.166 (in-sample avg dev_std = 0.141)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0529322
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.947
NEC for r=0.2 class 0.0 = 0.011 +- 0.240 (in-sample avg dev_std = 0.203)
NEC for r=0.2 class 1.0 = 0.09 +- 0.240 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all KL = 0.075 +- 0.240 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all L1 = 0.05 +- 0.173 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06489980000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.941
NEC for r=0.4 class 0.0 = 0.015 +- 0.269 (in-sample avg dev_std = 0.271)
NEC for r=0.4 class 1.0 = 0.11 +- 0.269 (in-sample avg dev_std = 0.271)
NEC for r=0.4 all KL = 0.102 +- 0.269 (in-sample avg dev_std = 0.271)
NEC for r=0.4 all L1 = 0.062 +- 0.178 (in-sample avg dev_std = 0.271)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.969
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0789312
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.939
NEC for r=0.8 class 0.0 = 0.018 +- 0.295 (in-sample avg dev_std = 0.351)
NEC for r=0.8 class 1.0 = 0.129 +- 0.295 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all KL = 0.133 +- 0.295 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all L1 = 0.073 +- 0.177 (in-sample avg dev_std = 0.351)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.997, 0.998, 0.999, 0.996, 0.997], 'all_L1': [0.999, 0.999, 0.999, 0.998, 0.999]}), defaultdict(<class 'list'>, {'all_KL': [0.979, 0.965, 0.966, 0.971, 0.987], 'all_L1': [0.991, 0.985, 0.986, 0.987, 0.993]}), defaultdict(<class 'list'>, {'all_KL': [0.965, 0.962, 0.971, 0.976, 0.986], 'all_L1': [0.983, 0.982, 0.986, 0.988, 0.992]}), defaultdict(<class 'list'>, {'all_KL': [0.988, 0.987, 0.991, 0.992, 0.995], 'all_L1': [0.992, 0.992, 0.994, 0.995, 0.996]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.981, 0.987, 0.982, 0.987], 'all_L1': [0.99, 0.992, 0.995, 0.993, 0.994]}), defaultdict(<class 'list'>, {'all_KL': [0.992, 0.989, 0.991, 0.988, 0.997], 'all_L1': [0.996, 0.995, 0.996, 0.995, 0.998]}), defaultdict(<class 'list'>, {'all_KL': [0.93, 0.933, 0.928, 0.933, 0.953], 'all_L1': [0.963, 0.965, 0.962, 0.964, 0.969]}), defaultdict(<class 'list'>, {'all_KL': [0.983, 0.981, 0.987, 0.982, 0.991], 'all_L1': [0.99, 0.989, 0.993, 0.99, 0.995]}), defaultdict(<class 'list'>, {'all_KL': [0.957, 0.967, 0.964, 0.964, 0.977], 'all_L1': [0.978, 0.983, 0.982, 0.98, 0.985]}), defaultdict(<class 'list'>, {'all_KL': [0.919, 0.917, 0.921, 0.924, 0.926], 'all_L1': [0.966, 0.963, 0.966, 0.965, 0.958]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.009, 0.011, 0.011, 0.012], 'all_L1': [0.002, 0.005, 0.005, 0.005, 0.005]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.002, 0.007, 0.013, 0.011], 'all_L1': [0.001, 0.001, 0.004, 0.007, 0.006]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.004, 0.004, 0.003, 0.003], 'all_L1': [0.002, 0.003, 0.003, 0.003, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.002, 0.006, 0.009, 0.005], 'all_L1': [0.002, 0.001, 0.003, 0.004, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.0, 0.0, 0.0], 'all_L1': [0.0, 0.0, 0.0, 0.0, 0.0]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.009, 0.015, 0.011, 0.019], 'all_L1': [0.008, 0.005, 0.007, 0.005, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.003, 0.002, 0.003, 0.003], 'all_L1': [0.002, 0.002, 0.002, 0.002, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.006, 0.013, 0.008, 0.006, 0.014], 'all_L1': [0.004, 0.007, 0.004, 0.003, 0.007]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.009, 0.023, 0.018, 0.021], 'all_L1': [0.003, 0.005, 0.011, 0.008, 0.008]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.985, 0.983, 0.985, 0.985, 0.984], 'all_L1': [0.994, 0.993, 0.994, 0.994, 0.993]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.976, 0.977, 0.975, 0.977], 'all_L1': [0.992, 0.991, 0.992, 0.991, 0.992]}), defaultdict(<class 'list'>, {'all_KL': [0.94, 0.94, 0.942, 0.939, 0.944], 'all_L1': [0.972, 0.972, 0.973, 0.971, 0.973]}), defaultdict(<class 'list'>, {'all_KL': [0.938, 0.941, 0.943, 0.942, 0.941], 'all_L1': [0.95, 0.951, 0.952, 0.951, 0.951]}), defaultdict(<class 'list'>, {'all_KL': [0.978, 0.982, 0.981, 0.98, 0.981], 'all_L1': [0.992, 0.993, 0.992, 0.992, 0.992]}), defaultdict(<class 'list'>, {'all_KL': [0.987, 0.988, 0.988, 0.989, 0.988], 'all_L1': [0.994, 0.994, 0.994, 0.994, 0.994]}), defaultdict(<class 'list'>, {'all_KL': [0.981, 0.982, 0.983, 0.984, 0.983], 'all_L1': [0.992, 0.992, 0.992, 0.993, 0.992]}), defaultdict(<class 'list'>, {'all_KL': [0.881, 0.881, 0.878, 0.881, 0.889], 'all_L1': [0.912, 0.913, 0.91, 0.912, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.977, 0.981, 0.984, 0.981, 0.985], 'all_L1': [0.989, 0.991, 0.992, 0.991, 0.992]}), defaultdict(<class 'list'>, {'all_KL': [0.725, 0.724, 0.725, 0.727, 0.734], 'all_L1': [0.777, 0.777, 0.778, 0.778, 0.781]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.001, 0.002, 0.002, 0.003, 0.001], 'all_L1': [0.001, 0.001, 0.001, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.006, 0.008, 0.008, 0.006], 'all_L1': [0.002, 0.003, 0.003, 0.003, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.018, 0.022, 0.022, 0.022], 'all_L1': [0.008, 0.009, 0.01, 0.01, 0.009]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.011, 0.013, 0.011, 0.012], 'all_L1': [0.01, 0.011, 0.012, 0.011, 0.011]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.004, 0.004, 0.004, 0.004], 'all_L1': [0.001, 0.001, 0.002, 0.002, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.003, 0.003, 0.003, 0.003], 'all_L1': [0.001, 0.001, 0.001, 0.001, 0.001]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.004, 0.004, 0.003, 0.004], 'all_L1': [0.001, 0.002, 0.002, 0.001, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.045, 0.048, 0.051, 0.051, 0.052], 'all_L1': [0.036, 0.036, 0.038, 0.037, 0.038]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.004, 0.005, 0.006, 0.005], 'all_L1': [0.003, 0.002, 0.003, 0.003, 0.002]}), defaultdict(<class 'list'>, {'all_KL': [0.107, 0.113, 0.118, 0.121, 0.124], 'all_L1': [0.115, 0.117, 0.12, 0.12, 0.122]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.956, 0.955, 0.962, 0.965, 0.931], 'all_L1': [0.971, 0.971, 0.973, 0.975, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.927, 0.942, 0.95, 0.977], 'all_L1': [0.959, 0.96, 0.966, 0.968, 0.983]}), defaultdict(<class 'list'>, {'all_KL': [0.929, 0.93, 0.94, 0.949, 0.978], 'all_L1': [0.957, 0.958, 0.961, 0.965, 0.982]}), defaultdict(<class 'list'>, {'all_KL': [0.922, 0.923, 0.934, 0.933, 0.95], 'all_L1': [0.948, 0.948, 0.954, 0.95, 0.962]}), defaultdict(<class 'list'>, {'all_KL': [0.931, 0.936, 0.945, 0.951, 0.939], 'all_L1': [0.961, 0.963, 0.965, 0.97, 0.966]}), defaultdict(<class 'list'>, {'all_KL': [0.922, 0.925, 0.939, 0.947, 0.974], 'all_L1': [0.953, 0.954, 0.959, 0.962, 0.98]}), defaultdict(<class 'list'>, {'all_KL': [0.879, 0.882, 0.896, 0.916, 0.947], 'all_L1': [0.924, 0.926, 0.931, 0.943, 0.959]}), defaultdict(<class 'list'>, {'all_KL': [0.921, 0.923, 0.931, 0.94, 0.977], 'all_L1': [0.95, 0.95, 0.953, 0.956, 0.981]}), defaultdict(<class 'list'>, {'all_KL': [0.868, 0.872, 0.884, 0.896, 0.854], 'all_L1': [0.916, 0.917, 0.924, 0.933, 0.9]}), defaultdict(<class 'list'>, {'all_KL': [0.814, 0.812, 0.826, 0.829, 0.848], 'all_L1': [0.893, 0.891, 0.898, 0.899, 0.901]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.005, 0.009, 0.014, 0.02, 0.027], 'all_L1': [0.005, 0.008, 0.011, 0.014, 0.017]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.014, 0.023, 0.037, 0.052], 'all_L1': [0.009, 0.011, 0.017, 0.023, 0.027]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.017, 0.025, 0.036, 0.05], 'all_L1': [0.01, 0.014, 0.019, 0.025, 0.029]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.022, 0.033, 0.043, 0.056], 'all_L1': [0.015, 0.02, 0.028, 0.033, 0.037]}), defaultdict(<class 'list'>, {'all_KL': [0.007, 0.012, 0.019, 0.025, 0.038], 'all_L1': [0.005, 0.009, 0.013, 0.016, 0.021]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.014, 0.023, 0.037, 0.052], 'all_L1': [0.009, 0.012, 0.018, 0.026, 0.031]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.033, 0.048, 0.06, 0.08], 'all_L1': [0.019, 0.027, 0.035, 0.04, 0.048]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.015, 0.025, 0.04, 0.051], 'all_L1': [0.01, 0.013, 0.02, 0.028, 0.032]}), defaultdict(<class 'list'>, {'all_KL': [0.014, 0.022, 0.032, 0.042, 0.061], 'all_L1': [0.011, 0.016, 0.022, 0.028, 0.037]}), defaultdict(<class 'list'>, {'all_KL': [0.038, 0.056, 0.075, 0.102, 0.133], 'all_L1': [0.03, 0.041, 0.05, 0.062, 0.073]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.985 +- 0.012, 0.984 +- 0.011, 0.986 +- 0.012, 0.986 +- 0.012, 0.988 +- 0.013
suff_simple class all_KL  =  0.969 +- 0.025, 0.968 +- 0.024, 0.970 +- 0.026, 0.971 +- 0.023, 0.980 +- 0.022
[[0.9994999766349792, 0.9994999766349792, 0.999750018119812, 0.9992499947547913, 0.9994999766349792], [0.9944999814033508, 0.9909999966621399, 0.9917500019073486, 0.9912499785423279, 0.9934999942779541], [0.9890000224113464, 0.9890000224113464, 0.9912499785423279, 0.9927499890327454, 0.9937499761581421], [0.9952499866485596, 0.9944999814033508, 0.9965000152587891, 0.9972500205039978, 0.996999979019165], [0.9940000176429749, 0.9950000047683716, 0.996749997138977, 0.9959999918937683, 0.9955000281333923], [0.9980000257492065, 0.9965000152587891, 0.9975000023841858, 0.996749997138977, 0.9977499842643738], [0.9739999771118164, 0.9757500290870667, 0.9739999771118164, 0.9737499952316284, 0.972000002861023], [0.9940000176429749, 0.9929999709129333, 0.9962499737739563, 0.9940000176429749, 0.9962499737739563], [0.9867500066757202, 0.9897500276565552, 0.9890000224113464, 0.9879999756813049, 0.9877499938011169], [0.9797499775886536, 0.9767500162124634, 0.9794999957084656, 0.9775000214576721, 0.965499997138977]]
[[0.997, 0.998, 0.999, 0.996, 0.997], [0.979, 0.965, 0.966, 0.971, 0.987], [0.965, 0.962, 0.971, 0.976, 0.986], [0.988, 0.987, 0.991, 0.992, 0.995], [0.978, 0.981, 0.987, 0.982, 0.987], [0.992, 0.989, 0.991, 0.988, 0.997], [0.93, 0.933, 0.928, 0.933, 0.953], [0.983, 0.981, 0.987, 0.982, 0.991], [0.957, 0.967, 0.964, 0.964, 0.977], [0.919, 0.917, 0.921, 0.924, 0.926]]
suff_simple_acc_int  =  0.990 +- 0.008, 0.990 +- 0.008, 0.991 +- 0.008, 0.991 +- 0.008, 0.990 +- 0.011
nec class all_L1  =  0.002 +- 0.002, 0.003 +- 0.002, 0.004 +- 0.003, 0.004 +- 0.003, 0.004 +- 0.003
nec class all_KL  =  0.003 +- 0.003, 0.005 +- 0.004, 0.008 +- 0.007, 0.007 +- 0.006, 0.009 +- 0.007
[[1.0, 1.0, 1.0, 1.0, 1.0], [0.9987499713897705, 0.996749997138977, 0.996749997138977, 0.9972500205039978, 0.996999979019165], [0.9994999766349792, 0.9994999766349792, 0.996999979019165, 0.9957500100135803, 0.996749997138977], [0.9980000257492065, 0.9962499737739563, 0.9982500076293945, 0.9977499842643738, 0.9987499713897705], [0.9980000257492065, 0.9992499947547913, 0.9984999895095825, 0.9975000023841858, 0.9987499713897705], [1.0, 1.0, 1.0, 1.0, 1.0], [0.9919999837875366, 0.9965000152587891, 0.9957500100135803, 0.996999979019165, 0.9942499995231628], [0.9980000257492065, 0.9977499842643738, 0.9980000257492065, 0.9990000128746033, 0.9990000128746033], [0.9975000023841858, 0.9950000047683716, 0.9975000023841858, 0.9980000257492065, 0.9955000281333923], [0.9972500205039978, 0.9959999918937683, 0.9929999709129333, 0.9947500228881836, 0.9952499866485596]]
[[0.0, 0.0, 0.0, 0.0, 0.0], [0.003, 0.009, 0.011, 0.011, 0.012], [0.002, 0.002, 0.007, 0.013, 0.011], [0.002, 0.004, 0.004, 0.003, 0.003], [0.002, 0.002, 0.006, 0.009, 0.005], [0.0, 0.0, 0.0, 0.0, 0.0], [0.01, 0.009, 0.015, 0.011, 0.019], [0.002, 0.003, 0.002, 0.003, 0.003], [0.006, 0.013, 0.008, 0.006, 0.014], [0.005, 0.009, 0.023, 0.018, 0.021]]
nec_acc_int  =  0.998 +- 0.002, 0.998 +- 0.002, 0.997 +- 0.002, 0.998 +- 0.002, 0.998 +- 0.002

Eval split val
suff_simple class all_L1  =  0.956 +- 0.065, 0.957 +- 0.065, 0.957 +- 0.065, 0.957 +- 0.065, 0.958 +- 0.064
suff_simple class all_KL  =  0.937 +- 0.077, 0.938 +- 0.078, 0.939 +- 0.078, 0.938 +- 0.077, 0.941 +- 0.075
[[0.9969499707221985, 0.9965000152587891, 0.9969000220298767, 0.9968500137329102, 0.996749997138977], [0.9955000281333923, 0.9949749708175659, 0.9952999949455261, 0.9949250221252441, 0.9950500130653381], [0.9125999808311462, 0.9128249883651733, 0.9133750200271606, 0.9117749929428101, 0.9126250147819519], [0.8456000089645386, 0.8471999764442444, 0.8475750088691711, 0.8470249772071838, 0.8464000225067139], [0.9402250051498413, 0.9409499764442444, 0.9406999945640564, 0.9405500292778015, 0.9404000043869019], [0.9656749963760376, 0.9660000205039978, 0.9658250212669373, 0.9659500122070312, 0.9658750295639038], [0.9950000047683716, 0.9951000213623047, 0.9950249791145325, 0.9955250024795532, 0.9947500228881836], [0.7444249987602234, 0.7443749904632568, 0.7427499890327454, 0.7442499995231628, 0.7461000084877014], [0.8579750061035156, 0.8592000007629395, 0.8595749735832214, 0.8589249849319458, 0.8590750098228455], [0.713100016117096, 0.712149977684021, 0.7134000062942505, 0.7130500078201294, 0.7143750190734863]]
[[0.985, 0.983, 0.985, 0.985, 0.984], [0.978, 0.976, 0.977, 0.975, 0.977], [0.94, 0.94, 0.942, 0.939, 0.944], [0.938, 0.941, 0.943, 0.942, 0.941], [0.978, 0.982, 0.981, 0.98, 0.981], [0.987, 0.988, 0.988, 0.989, 0.988], [0.981, 0.982, 0.983, 0.984, 0.983], [0.881, 0.881, 0.878, 0.881, 0.889], [0.977, 0.981, 0.984, 0.981, 0.985], [0.725, 0.724, 0.725, 0.727, 0.734]]
suff_simple_acc_int  =  0.897 +- 0.099, 0.897 +- 0.099, 0.897 +- 0.099, 0.897 +- 0.099, 0.897 +- 0.098
nec class all_L1  =  0.018 +- 0.034, 0.018 +- 0.034, 0.019 +- 0.035, 0.019 +- 0.035, 0.019 +- 0.036
nec class all_KL  =  0.020 +- 0.032, 0.021 +- 0.033, 0.023 +- 0.035, 0.023 +- 0.036, 0.023 +- 0.037
[[0.9996500015258789, 0.9997249841690063, 0.9997749924659729, 0.9993500113487244, 0.9997249841690063], [0.9987499713897705, 0.9984750151634216, 0.9983749985694885, 0.998324990272522, 0.9986500144004822], [0.9241750240325928, 0.9243249893188477, 0.9234499931335449, 0.9237499833106995, 0.9240000247955322], [0.8743000030517578, 0.8738999962806702, 0.8731750249862671, 0.8739749789237976, 0.8736749887466431], [0.9441499710083008, 0.9442750215530396, 0.9441750049591064, 0.9440749883651733, 0.9441499710083008], [0.96875, 0.9687250256538391, 0.9685249924659729, 0.968625009059906, 0.9686999917030334], [0.9991250038146973, 0.9986500144004822, 0.9990500211715698, 0.9992750287055969, 0.9990749955177307], [0.7885249853134155, 0.7890999913215637, 0.7881249785423279, 0.7879499793052673, 0.7876499891281128], [0.8621500134468079, 0.8627750277519226, 0.8627499938011169, 0.8626000285148621, 0.8628749847412109], [0.807449996471405, 0.8081499934196472, 0.8081499934196472, 0.8093500137329102, 0.8075500130653381]]
[[0.001, 0.002, 0.002, 0.003, 0.001], [0.005, 0.006, 0.008, 0.008, 0.006], [0.016, 0.018, 0.022, 0.022, 0.022], [0.01, 0.011, 0.013, 0.011, 0.012], [0.003, 0.004, 0.004, 0.004, 0.004], [0.002, 0.003, 0.003, 0.003, 0.003], [0.003, 0.004, 0.004, 0.003, 0.004], [0.045, 0.048, 0.051, 0.051, 0.052], [0.005, 0.004, 0.005, 0.006, 0.005], [0.107, 0.113, 0.118, 0.121, 0.124]]
nec_acc_int  =  0.917 +- 0.076, 0.917 +- 0.075, 0.917 +- 0.075, 0.917 +- 0.075, 0.917 +- 0.076

Eval split test
suff_simple class all_L1  =  0.943 +- 0.023, 0.944 +- 0.024, 0.948 +- 0.022, 0.952 +- 0.022, 0.958 +- 0.030
suff_simple class all_KL  =  0.907 +- 0.039, 0.908 +- 0.040, 0.920 +- 0.038, 0.928 +- 0.038, 0.938 +- 0.046
[[0.9620522260665894, 0.9620271921157837, 0.9619771838188171, 0.9629777669906616, 0.959865391254425], [0.9639283418655396, 0.9637032151222229, 0.9671303033828735, 0.9680808782577515, 0.9772430658340454], [0.9634780883789062, 0.963878333568573, 0.9611517190933228, 0.9627026319503784, 0.9743930697441101], [0.95782470703125, 0.956498920917511, 0.9566490054130554, 0.9525465369224548, 0.9593449234962463], [0.9612017273902893, 0.960951566696167, 0.9592505693435669, 0.9637032151222229, 0.963547945022583], [0.9624274373054504, 0.9617020487785339, 0.9616519808769226, 0.9655793309211731, 0.9762251377105713], [0.9375125169754028, 0.936937153339386, 0.9370121955871582, 0.9457424283027649, 0.9547621607780457], [0.9579497575759888, 0.9567990899085999, 0.954897940158844, 0.9563988447189331, 0.9740161299705505], [0.9326345920562744, 0.9326345920562744, 0.9355863332748413, 0.941189706325531, 0.912320613861084], [0.9091454744338989, 0.9064939022064209, 0.9081198573112488, 0.9106964468955994, 0.9038693308830261]]
[[0.956, 0.955, 0.962, 0.965, 0.931], [0.927, 0.927, 0.942, 0.95, 0.977], [0.929, 0.93, 0.94, 0.949, 0.978], [0.922, 0.923, 0.934, 0.933, 0.95], [0.931, 0.936, 0.945, 0.951, 0.939], [0.922, 0.925, 0.939, 0.947, 0.974], [0.879, 0.882, 0.896, 0.916, 0.947], [0.921, 0.923, 0.931, 0.94, 0.977], [0.868, 0.872, 0.884, 0.896, 0.854], [0.814, 0.812, 0.826, 0.829, 0.848]]
suff_simple_acc_int  =  0.951 +- 0.017, 0.950 +- 0.018, 0.950 +- 0.017, 0.953 +- 0.016, 0.956 +- 0.025
nec class all_L1  =  0.012 +- 0.007, 0.017 +- 0.010, 0.023 +- 0.011, 0.030 +- 0.013, 0.035 +- 0.015
nec class all_KL  =  0.015 +- 0.009, 0.021 +- 0.013, 0.032 +- 0.017, 0.044 +- 0.022, 0.060 +- 0.028
[[0.9809385538101196, 0.9782119393348694, 0.9758355021476746, 0.9734840989112854, 0.9728086590766907], [0.98384028673172, 0.98231440782547, 0.9772863984107971, 0.9730338454246521, 0.9758104681968689], [0.9794126749038696, 0.977586567401886, 0.9740344285964966, 0.9720582365989685, 0.9735841751098633], [0.973058819770813, 0.9724084734916687, 0.9698819518089294, 0.9675805568695068, 0.9687062501907349], [0.9833149909973145, 0.9804632663726807, 0.9775364995002747, 0.9764859080314636, 0.9743095636367798], [0.9797878861427307, 0.979762852191925, 0.9770612120628357, 0.9722833633422852, 0.972583532333374], [0.9667050242424011, 0.9630778431892395, 0.9619021415710449, 0.9600009918212891, 0.9583249688148499], [0.9805383086204529, 0.9778116941452026, 0.9723083972930908, 0.9676305651664734, 0.9692815542221069], [0.9818891286849976, 0.9783120155334473, 0.9735591411590576, 0.9702070951461792, 0.9678056836128235], [0.9597758650779724, 0.952621579170227, 0.947243332862854, 0.9411646723747253, 0.9394136667251587]]
[[0.005, 0.009, 0.014, 0.02, 0.027], [0.011, 0.014, 0.023, 0.037, 0.052], [0.012, 0.017, 0.025, 0.036, 0.05], [0.016, 0.022, 0.033, 0.043, 0.056], [0.007, 0.012, 0.019, 0.025, 0.038], [0.01, 0.014, 0.023, 0.037, 0.052], [0.022, 0.033, 0.048, 0.06, 0.08], [0.011, 0.015, 0.025, 0.04, 0.051], [0.014, 0.022, 0.032, 0.042, 0.061], [0.038, 0.056, 0.075, 0.102, 0.133]]
nec_acc_int  =  0.977 +- 0.008, 0.974 +- 0.009, 0.971 +- 0.009, 0.967 +- 0.010, 0.967 +- 0.010


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.494 +- 0.005, 0.494 +- 0.005, 0.495 +- 0.005, 0.495 +- 0.005, 0.496 +- 0.005
Faith. Armon (L1)= 		  =  0.005 +- 0.004, 0.006 +- 0.005, 0.008 +- 0.006, 0.007 +- 0.005, 0.008 +- 0.006
Faith. GMean (L1)= 	  =  0.041 +- 0.025, 0.045 +- 0.028, 0.053 +- 0.031, 0.053 +- 0.029, 0.055 +- 0.032
Faith. Aritm (KL)= 		  =  0.486 +- 0.011, 0.487 +- 0.011, 0.489 +- 0.010, 0.489 +- 0.009, 0.494 +- 0.008
Faith. Armon (KL)= 		  =  0.006 +- 0.006, 0.010 +- 0.008, 0.015 +- 0.013, 0.015 +- 0.011, 0.017 +- 0.014
Faith. GMean (KL)= 	  =  0.047 +- 0.029, 0.059 +- 0.037, 0.072 +- 0.045, 0.073 +- 0.043, 0.078 +- 0.048

Eval split val
Faith. Aritm (L1)= 		  =  0.487 +- 0.016, 0.487 +- 0.015, 0.488 +- 0.015, 0.488 +- 0.015, 0.488 +- 0.014
Faith. Armon (L1)= 		  =  0.032 +- 0.059, 0.033 +- 0.060, 0.035 +- 0.061, 0.034 +- 0.061, 0.034 +- 0.062
Faith. GMean (L1)= 	  =  0.089 +- 0.083, 0.092 +- 0.083, 0.096 +- 0.083, 0.094 +- 0.084, 0.093 +- 0.085
Faith. Aritm (KL)= 		  =  0.478 +- 0.023, 0.480 +- 0.022, 0.481 +- 0.022, 0.481 +- 0.021, 0.482 +- 0.019
Faith. Armon (KL)= 		  =  0.036 +- 0.055, 0.039 +- 0.058, 0.042 +- 0.060, 0.042 +- 0.061, 0.042 +- 0.063
Faith. GMean (KL)= 	  =  0.102 +- 0.075, 0.109 +- 0.075, 0.114 +- 0.077, 0.114 +- 0.077, 0.112 +- 0.081

Eval split test
Faith. Aritm (L1)= 		  =  0.478 +- 0.009, 0.480 +- 0.008, 0.486 +- 0.007, 0.491 +- 0.005, 0.496 +- 0.012
Faith. Armon (L1)= 		  =  0.024 +- 0.014, 0.033 +- 0.018, 0.045 +- 0.021, 0.057 +- 0.024, 0.067 +- 0.027
Faith. GMean (L1)= 	  =  0.104 +- 0.027, 0.123 +- 0.030, 0.145 +- 0.031, 0.164 +- 0.032, 0.180 +- 0.034
Faith. Aritm (KL)= 		  =  0.461 +- 0.016, 0.465 +- 0.014, 0.476 +- 0.012, 0.486 +- 0.010, 0.499 +- 0.018
Faith. Armon (KL)= 		  =  0.029 +- 0.017, 0.041 +- 0.024, 0.061 +- 0.030, 0.083 +- 0.038, 0.111 +- 0.046
Faith. GMean (KL)= 	  =  0.110 +- 0.029, 0.133 +- 0.034, 0.165 +- 0.036, 0.197 +- 0.040, 0.231 +- 0.045
Computed for split load_split = id



Completed in  3:10:54.401874  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN simple_concept2temperature TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 02:41:12 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:41:12 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.047
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.058
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.067
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.040
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.064
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046784000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.9
SUFF_SIMPLE for r=0.05 class 0.0 = 0.894 +- 0.223 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.81 +- 0.223 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.05 all KL = 0.851 +- 0.223 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.05 all L1 = 0.847 +- 0.184 (in-sample avg dev_std = 0.325)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05810800000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.902
SUFF_SIMPLE for r=0.1 class 0.0 = 0.894 +- 0.221 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.814 +- 0.221 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all KL = 0.852 +- 0.221 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all L1 = 0.85 +- 0.181 (in-sample avg dev_std = 0.324)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.067458
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.901
SUFF_SIMPLE for r=0.2 class 0.0 = 0.897 +- 0.217 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.811 +- 0.217 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.2 all KL = 0.853 +- 0.217 (in-sample avg dev_std = 0.315)
SUFF_SIMPLE for r=0.2 all L1 = 0.849 +- 0.183 (in-sample avg dev_std = 0.315)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076612
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.9
SUFF_SIMPLE for r=0.4 class 0.0 = 0.894 +- 0.219 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.219 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.4 all KL = 0.854 +- 0.219 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.4 all L1 = 0.847 +- 0.188 (in-sample avg dev_std = 0.313)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08117
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.909
SUFF_SIMPLE for r=0.8 class 0.0 = 0.908 +- 0.214 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.825 +- 0.214 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 all KL = 0.878 +- 0.214 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.8 all L1 = 0.862 +- 0.188 (in-sample avg dev_std = 0.259)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.514
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.097 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.882 +- 0.097 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.05 all KL = 0.965 +- 0.097 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.05 all L1 = 0.94 +- 0.143 (in-sample avg dev_std = 0.113)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009281000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.515
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.096 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.884 +- 0.096 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.1 all KL = 0.966 +- 0.096 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.1 all L1 = 0.94 +- 0.142 (in-sample avg dev_std = 0.114)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009344400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.514
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.096 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.883 +- 0.096 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.2 all KL = 0.966 +- 0.096 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.2 all L1 = 0.94 +- 0.142 (in-sample avg dev_std = 0.112)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095086
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.515
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.095 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.884 +- 0.095 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 all KL = 0.966 +- 0.095 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 all L1 = 0.941 +- 0.141 (in-sample avg dev_std = 0.113)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0095604
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.514
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.098 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.883 +- 0.098 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.8 all KL = 0.966 +- 0.098 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.8 all L1 = 0.94 +- 0.143 (in-sample avg dev_std = 0.106)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032958
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.731
SUFF_SIMPLE for r=0.05 class 0.0 = 0.849 +- 0.310 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.832 +- 0.310 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.05 all KL = 0.806 +- 0.310 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.05 all L1 = 0.841 +- 0.234 (in-sample avg dev_std = 0.355)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0404916
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.729
SUFF_SIMPLE for r=0.1 class 0.0 = 0.849 +- 0.308 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.308 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.1 all KL = 0.809 +- 0.308 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.1 all L1 = 0.841 +- 0.235 (in-sample avg dev_std = 0.344)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050537
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.731
SUFF_SIMPLE for r=0.2 class 0.0 = 0.85 +- 0.304 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.304 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.2 all KL = 0.814 +- 0.304 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.2 all L1 = 0.843 +- 0.239 (in-sample avg dev_std = 0.318)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06428500000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.727
SUFF_SIMPLE for r=0.4 class 0.0 = 0.855 +- 0.291 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.852 +- 0.291 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 all KL = 0.835 +- 0.291 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 all L1 = 0.853 +- 0.239 (in-sample avg dev_std = 0.287)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.764
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0798366
len(reference) = 4977
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.74
SUFF_SIMPLE for r=0.8 class 0.0 = 0.887 +- 0.252 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.252 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.8 all KL = 0.88 +- 0.252 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.8 all L1 = 0.877 +- 0.227 (in-sample avg dev_std = 0.173)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046784000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.954
NEC for r=0.05 class 0.0 = 0.049 +- 0.082 (in-sample avg dev_std = 0.113)
NEC for r=0.05 class 1.0 = 0.048 +- 0.082 (in-sample avg dev_std = 0.113)
NEC for r=0.05 all KL = 0.027 +- 0.082 (in-sample avg dev_std = 0.113)
NEC for r=0.05 all L1 = 0.049 +- 0.093 (in-sample avg dev_std = 0.113)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05810800000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.958
NEC for r=0.1 class 0.0 = 0.049 +- 0.085 (in-sample avg dev_std = 0.139)
NEC for r=0.1 class 1.0 = 0.058 +- 0.085 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all KL = 0.033 +- 0.085 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all L1 = 0.054 +- 0.095 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.067458
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.956
NEC for r=0.2 class 0.0 = 0.055 +- 0.079 (in-sample avg dev_std = 0.153)
NEC for r=0.2 class 1.0 = 0.056 +- 0.079 (in-sample avg dev_std = 0.153)
NEC for r=0.2 all KL = 0.034 +- 0.079 (in-sample avg dev_std = 0.153)
NEC for r=0.2 all L1 = 0.056 +- 0.096 (in-sample avg dev_std = 0.153)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076612
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.957
NEC for r=0.4 class 0.0 = 0.059 +- 0.105 (in-sample avg dev_std = 0.174)
NEC for r=0.4 class 1.0 = 0.055 +- 0.105 (in-sample avg dev_std = 0.174)
NEC for r=0.4 all KL = 0.041 +- 0.105 (in-sample avg dev_std = 0.174)
NEC for r=0.4 all L1 = 0.057 +- 0.100 (in-sample avg dev_std = 0.174)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08117
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.956
NEC for r=0.8 class 0.0 = 0.058 +- 0.106 (in-sample avg dev_std = 0.178)
NEC for r=0.8 class 1.0 = 0.058 +- 0.106 (in-sample avg dev_std = 0.178)
NEC for r=0.8 all KL = 0.041 +- 0.106 (in-sample avg dev_std = 0.178)
NEC for r=0.8 all L1 = 0.058 +- 0.099 (in-sample avg dev_std = 0.178)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.531
NEC for r=0.05 class 0.0 = 0.001 +- 0.048 (in-sample avg dev_std = 0.077)
NEC for r=0.05 class 1.0 = 0.069 +- 0.048 (in-sample avg dev_std = 0.077)
NEC for r=0.05 all KL = 0.013 +- 0.048 (in-sample avg dev_std = 0.077)
NEC for r=0.05 all L1 = 0.035 +- 0.090 (in-sample avg dev_std = 0.077)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009281000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.53
NEC for r=0.1 class 0.0 = 0.001 +- 0.047 (in-sample avg dev_std = 0.089)
NEC for r=0.1 class 1.0 = 0.071 +- 0.047 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all KL = 0.014 +- 0.047 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all L1 = 0.037 +- 0.091 (in-sample avg dev_std = 0.089)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009344400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.53
NEC for r=0.2 class 0.0 = 0.001 +- 0.045 (in-sample avg dev_std = 0.094)
NEC for r=0.2 class 1.0 = 0.072 +- 0.045 (in-sample avg dev_std = 0.094)
NEC for r=0.2 all KL = 0.014 +- 0.045 (in-sample avg dev_std = 0.094)
NEC for r=0.2 all L1 = 0.037 +- 0.089 (in-sample avg dev_std = 0.094)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095086
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.529
NEC for r=0.4 class 0.0 = 0.001 +- 0.047 (in-sample avg dev_std = 0.096)
NEC for r=0.4 class 1.0 = 0.073 +- 0.047 (in-sample avg dev_std = 0.096)
NEC for r=0.4 all KL = 0.015 +- 0.047 (in-sample avg dev_std = 0.096)
NEC for r=0.4 all L1 = 0.037 +- 0.091 (in-sample avg dev_std = 0.096)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0095604
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.53
NEC for r=0.8 class 0.0 = 0.001 +- 0.044 (in-sample avg dev_std = 0.098)
NEC for r=0.8 class 1.0 = 0.072 +- 0.044 (in-sample avg dev_std = 0.098)
NEC for r=0.8 all KL = 0.014 +- 0.044 (in-sample avg dev_std = 0.098)
NEC for r=0.8 all L1 = 0.037 +- 0.088 (in-sample avg dev_std = 0.098)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032958
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.748
NEC for r=0.05 class 0.0 = 0.07 +- 0.187 (in-sample avg dev_std = 0.091)
NEC for r=0.05 class 1.0 = 0.074 +- 0.187 (in-sample avg dev_std = 0.091)
NEC for r=0.05 all KL = 0.063 +- 0.187 (in-sample avg dev_std = 0.091)
NEC for r=0.05 all L1 = 0.072 +- 0.177 (in-sample avg dev_std = 0.091)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0404916
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.744
NEC for r=0.1 class 0.0 = 0.084 +- 0.214 (in-sample avg dev_std = 0.121)
NEC for r=0.1 class 1.0 = 0.088 +- 0.214 (in-sample avg dev_std = 0.121)
NEC for r=0.1 all KL = 0.081 +- 0.214 (in-sample avg dev_std = 0.121)
NEC for r=0.1 all L1 = 0.086 +- 0.197 (in-sample avg dev_std = 0.121)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050537
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.738
NEC for r=0.2 class 0.0 = 0.094 +- 0.241 (in-sample avg dev_std = 0.178)
NEC for r=0.2 class 1.0 = 0.101 +- 0.241 (in-sample avg dev_std = 0.178)
NEC for r=0.2 all KL = 0.1 +- 0.241 (in-sample avg dev_std = 0.178)
NEC for r=0.2 all L1 = 0.097 +- 0.208 (in-sample avg dev_std = 0.178)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06428500000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.737
NEC for r=0.4 class 0.0 = 0.107 +- 0.252 (in-sample avg dev_std = 0.245)
NEC for r=0.4 class 1.0 = 0.103 +- 0.252 (in-sample avg dev_std = 0.245)
NEC for r=0.4 all KL = 0.117 +- 0.252 (in-sample avg dev_std = 0.245)
NEC for r=0.4 all L1 = 0.105 +- 0.206 (in-sample avg dev_std = 0.245)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0798366
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.739
NEC for r=0.8 class 0.0 = 0.109 +- 0.265 (in-sample avg dev_std = 0.298)
NEC for r=0.8 class 1.0 = 0.111 +- 0.265 (in-sample avg dev_std = 0.298)
NEC for r=0.8 all KL = 0.136 +- 0.265 (in-sample avg dev_std = 0.298)
NEC for r=0.8 all L1 = 0.11 +- 0.198 (in-sample avg dev_std = 0.298)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:00:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:00:02 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.055
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.064
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.079
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.083
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.067
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.054596
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.836
SUFF_SIMPLE for r=0.05 class 0.0 = 0.871 +- 0.364 (in-sample avg dev_std = 0.520)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.657 +- 0.364 (in-sample avg dev_std = 0.520)
SUFF_SIMPLE for r=0.05 all KL = 0.631 +- 0.364 (in-sample avg dev_std = 0.520)
SUFF_SIMPLE for r=0.05 all L1 = 0.752 +- 0.236 (in-sample avg dev_std = 0.520)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06373
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.841
SUFF_SIMPLE for r=0.1 class 0.0 = 0.879 +- 0.364 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.661 +- 0.364 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all KL = 0.641 +- 0.364 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all L1 = 0.758 +- 0.239 (in-sample avg dev_std = 0.506)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071076
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.839
SUFF_SIMPLE for r=0.2 class 0.0 = 0.874 +- 0.361 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.665 +- 0.361 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.2 all KL = 0.65 +- 0.361 (in-sample avg dev_std = 0.501)
SUFF_SIMPLE for r=0.2 all L1 = 0.758 +- 0.241 (in-sample avg dev_std = 0.501)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07916399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.839
SUFF_SIMPLE for r=0.4 class 0.0 = 0.882 +- 0.368 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.659 +- 0.368 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.4 all KL = 0.65 +- 0.368 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.4 all L1 = 0.759 +- 0.240 (in-sample avg dev_std = 0.500)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08348399999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.831
SUFF_SIMPLE for r=0.8 class 0.0 = 0.878 +- 0.360 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.681 +- 0.360 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.8 all KL = 0.691 +- 0.360 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.8 all L1 = 0.769 +- 0.261 (in-sample avg dev_std = 0.442)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009916000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.52
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.209 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.829 +- 0.209 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.05 all KL = 0.919 +- 0.209 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.05 all L1 = 0.913 +- 0.201 (in-sample avg dev_std = 0.181)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0099
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.519
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.211 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.828 +- 0.211 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 all KL = 0.917 +- 0.211 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 all L1 = 0.912 +- 0.201 (in-sample avg dev_std = 0.182)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010028
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.52
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.211 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.827 +- 0.211 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.2 all KL = 0.917 +- 0.211 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.2 all L1 = 0.911 +- 0.202 (in-sample avg dev_std = 0.183)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009947800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.519
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.211 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.827 +- 0.211 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all KL = 0.918 +- 0.211 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all L1 = 0.911 +- 0.203 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099608
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.518
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.210 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.828 +- 0.210 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.8 all KL = 0.919 +- 0.210 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.8 all L1 = 0.912 +- 0.203 (in-sample avg dev_std = 0.175)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0332188
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.695
SUFF_SIMPLE for r=0.05 class 0.0 = 0.835 +- 0.390 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.72 +- 0.390 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.05 all KL = 0.625 +- 0.390 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.05 all L1 = 0.778 +- 0.264 (in-sample avg dev_std = 0.489)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042681000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.698
SUFF_SIMPLE for r=0.1 class 0.0 = 0.832 +- 0.391 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.724 +- 0.391 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 all KL = 0.627 +- 0.391 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.1 all L1 = 0.779 +- 0.265 (in-sample avg dev_std = 0.486)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05388720000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.696
SUFF_SIMPLE for r=0.2 class 0.0 = 0.837 +- 0.393 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.725 +- 0.393 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.2 all KL = 0.64 +- 0.393 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.2 all L1 = 0.782 +- 0.269 (in-sample avg dev_std = 0.475)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06665940000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.692
SUFF_SIMPLE for r=0.4 class 0.0 = 0.842 +- 0.392 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.73 +- 0.392 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.4 all KL = 0.654 +- 0.392 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.4 all L1 = 0.787 +- 0.272 (in-sample avg dev_std = 0.465)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08023759999999999
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.696
SUFF_SIMPLE for r=0.8 class 0.0 = 0.857 +- 0.398 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.746 +- 0.398 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.8 all KL = 0.701 +- 0.398 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.8 all L1 = 0.802 +- 0.283 (in-sample avg dev_std = 0.391)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.054596
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.93
NEC for r=0.05 class 0.0 = 0.064 +- 0.246 (in-sample avg dev_std = 0.277)
NEC for r=0.05 class 1.0 = 0.116 +- 0.246 (in-sample avg dev_std = 0.277)
NEC for r=0.05 all KL = 0.115 +- 0.246 (in-sample avg dev_std = 0.277)
NEC for r=0.05 all L1 = 0.093 +- 0.168 (in-sample avg dev_std = 0.277)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06373
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.935
NEC for r=0.1 class 0.0 = 0.069 +- 0.237 (in-sample avg dev_std = 0.285)
NEC for r=0.1 class 1.0 = 0.11 +- 0.237 (in-sample avg dev_std = 0.285)
NEC for r=0.1 all KL = 0.123 +- 0.237 (in-sample avg dev_std = 0.285)
NEC for r=0.1 all L1 = 0.092 +- 0.149 (in-sample avg dev_std = 0.285)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071076
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.937
NEC for r=0.2 class 0.0 = 0.064 +- 0.250 (in-sample avg dev_std = 0.311)
NEC for r=0.2 class 1.0 = 0.121 +- 0.250 (in-sample avg dev_std = 0.311)
NEC for r=0.2 all KL = 0.137 +- 0.250 (in-sample avg dev_std = 0.311)
NEC for r=0.2 all L1 = 0.096 +- 0.146 (in-sample avg dev_std = 0.311)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07916399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.937
NEC for r=0.4 class 0.0 = 0.065 +- 0.246 (in-sample avg dev_std = 0.324)
NEC for r=0.4 class 1.0 = 0.125 +- 0.246 (in-sample avg dev_std = 0.324)
NEC for r=0.4 all KL = 0.144 +- 0.246 (in-sample avg dev_std = 0.324)
NEC for r=0.4 all L1 = 0.098 +- 0.143 (in-sample avg dev_std = 0.324)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08348399999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.937
NEC for r=0.8 class 0.0 = 0.065 +- 0.255 (in-sample avg dev_std = 0.338)
NEC for r=0.8 class 1.0 = 0.13 +- 0.255 (in-sample avg dev_std = 0.338)
NEC for r=0.8 all KL = 0.156 +- 0.255 (in-sample avg dev_std = 0.338)
NEC for r=0.8 all L1 = 0.101 +- 0.140 (in-sample avg dev_std = 0.338)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009916000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.537
NEC for r=0.05 class 0.0 = 0.002 +- 0.154 (in-sample avg dev_std = 0.156)
NEC for r=0.05 class 1.0 = 0.132 +- 0.154 (in-sample avg dev_std = 0.156)
NEC for r=0.05 all KL = 0.053 +- 0.154 (in-sample avg dev_std = 0.156)
NEC for r=0.05 all L1 = 0.068 +- 0.162 (in-sample avg dev_std = 0.156)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0099
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.538
NEC for r=0.1 class 0.0 = 0.002 +- 0.153 (in-sample avg dev_std = 0.167)
NEC for r=0.1 class 1.0 = 0.134 +- 0.153 (in-sample avg dev_std = 0.167)
NEC for r=0.1 all KL = 0.055 +- 0.153 (in-sample avg dev_std = 0.167)
NEC for r=0.1 all L1 = 0.069 +- 0.161 (in-sample avg dev_std = 0.167)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010028
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.538
NEC for r=0.2 class 0.0 = 0.002 +- 0.153 (in-sample avg dev_std = 0.177)
NEC for r=0.2 class 1.0 = 0.135 +- 0.153 (in-sample avg dev_std = 0.177)
NEC for r=0.2 all KL = 0.056 +- 0.153 (in-sample avg dev_std = 0.177)
NEC for r=0.2 all L1 = 0.069 +- 0.160 (in-sample avg dev_std = 0.177)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009947800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.538
NEC for r=0.4 class 0.0 = 0.003 +- 0.154 (in-sample avg dev_std = 0.183)
NEC for r=0.4 class 1.0 = 0.136 +- 0.154 (in-sample avg dev_std = 0.183)
NEC for r=0.4 all KL = 0.058 +- 0.154 (in-sample avg dev_std = 0.183)
NEC for r=0.4 all L1 = 0.07 +- 0.161 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099608
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.539
NEC for r=0.8 class 0.0 = 0.003 +- 0.151 (in-sample avg dev_std = 0.179)
NEC for r=0.8 class 1.0 = 0.135 +- 0.151 (in-sample avg dev_std = 0.179)
NEC for r=0.8 all KL = 0.057 +- 0.151 (in-sample avg dev_std = 0.179)
NEC for r=0.8 all L1 = 0.069 +- 0.159 (in-sample avg dev_std = 0.179)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0332188
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.74
NEC for r=0.05 class 0.0 = 0.081 +- 0.290 (in-sample avg dev_std = 0.209)
NEC for r=0.05 class 1.0 = 0.104 +- 0.290 (in-sample avg dev_std = 0.209)
NEC for r=0.05 all KL = 0.122 +- 0.290 (in-sample avg dev_std = 0.209)
NEC for r=0.05 all L1 = 0.093 +- 0.218 (in-sample avg dev_std = 0.209)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042681000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.731
NEC for r=0.1 class 0.0 = 0.095 +- 0.318 (in-sample avg dev_std = 0.279)
NEC for r=0.1 class 1.0 = 0.134 +- 0.318 (in-sample avg dev_std = 0.279)
NEC for r=0.1 all KL = 0.167 +- 0.318 (in-sample avg dev_std = 0.279)
NEC for r=0.1 all L1 = 0.114 +- 0.229 (in-sample avg dev_std = 0.279)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05388720000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.723
NEC for r=0.2 class 0.0 = 0.107 +- 0.333 (in-sample avg dev_std = 0.343)
NEC for r=0.2 class 1.0 = 0.158 +- 0.333 (in-sample avg dev_std = 0.343)
NEC for r=0.2 all KL = 0.205 +- 0.333 (in-sample avg dev_std = 0.343)
NEC for r=0.2 all L1 = 0.132 +- 0.233 (in-sample avg dev_std = 0.343)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06665940000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.718
NEC for r=0.4 class 0.0 = 0.108 +- 0.342 (in-sample avg dev_std = 0.383)
NEC for r=0.4 class 1.0 = 0.175 +- 0.342 (in-sample avg dev_std = 0.383)
NEC for r=0.4 all KL = 0.231 +- 0.342 (in-sample avg dev_std = 0.383)
NEC for r=0.4 all L1 = 0.141 +- 0.229 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08023759999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.715
NEC for r=0.8 class 0.0 = 0.112 +- 0.352 (in-sample avg dev_std = 0.413)
NEC for r=0.8 class 1.0 = 0.188 +- 0.352 (in-sample avg dev_std = 0.413)
NEC for r=0.8 all KL = 0.255 +- 0.352 (in-sample avg dev_std = 0.413)
NEC for r=0.8 all L1 = 0.15 +- 0.229 (in-sample avg dev_std = 0.413)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:18:31 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:18:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.052
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.060
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.085
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052216000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.859
SUFF_SIMPLE for r=0.05 class 0.0 = 0.911 +- 0.316 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.708 +- 0.316 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.05 all KL = 0.729 +- 0.316 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.05 all L1 = 0.799 +- 0.209 (in-sample avg dev_std = 0.444)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.060155999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.855
SUFF_SIMPLE for r=0.1 class 0.0 = 0.906 +- 0.312 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.709 +- 0.312 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.1 all KL = 0.728 +- 0.312 (in-sample avg dev_std = 0.449)
SUFF_SIMPLE for r=0.1 all L1 = 0.797 +- 0.211 (in-sample avg dev_std = 0.449)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07136200000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.851
SUFF_SIMPLE for r=0.2 class 0.0 = 0.904 +- 0.316 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.701 +- 0.316 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.2 all KL = 0.726 +- 0.316 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.2 all L1 = 0.791 +- 0.216 (in-sample avg dev_std = 0.456)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07992999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.856
SUFF_SIMPLE for r=0.4 class 0.0 = 0.911 +- 0.304 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.711 +- 0.304 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.4 all KL = 0.741 +- 0.304 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.4 all L1 = 0.8 +- 0.213 (in-sample avg dev_std = 0.433)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085024
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.861
SUFF_SIMPLE for r=0.8 class 0.0 = 0.91 +- 0.308 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.73 +- 0.308 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.8 all KL = 0.775 +- 0.308 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.8 all L1 = 0.81 +- 0.232 (in-sample avg dev_std = 0.374)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009889
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.525
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.165 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.878 +- 0.165 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.05 all KL = 0.944 +- 0.165 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.05 all L1 = 0.936 +- 0.166 (in-sample avg dev_std = 0.168)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010015000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.523
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.171 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.875 +- 0.171 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all KL = 0.942 +- 0.171 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.1 all L1 = 0.935 +- 0.170 (in-sample avg dev_std = 0.171)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010157000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.524
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.169 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.876 +- 0.169 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.2 all KL = 0.943 +- 0.169 (in-sample avg dev_std = 0.171)
SUFF_SIMPLE for r=0.2 all L1 = 0.935 +- 0.169 (in-sample avg dev_std = 0.171)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.524
SUFF_SIMPLE for r=0.4 class 0.0 = 0.995 +- 0.170 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.876 +- 0.170 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.4 all KL = 0.943 +- 0.170 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.4 all L1 = 0.935 +- 0.170 (in-sample avg dev_std = 0.169)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099502
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.524
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.167 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.877 +- 0.167 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all KL = 0.943 +- 0.167 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.8 all L1 = 0.935 +- 0.169 (in-sample avg dev_std = 0.166)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0345068
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.71
SUFF_SIMPLE for r=0.05 class 0.0 = 0.845 +- 0.341 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.741 +- 0.341 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all KL = 0.714 +- 0.341 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all L1 = 0.794 +- 0.255 (in-sample avg dev_std = 0.434)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043183799999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.714
SUFF_SIMPLE for r=0.1 class 0.0 = 0.845 +- 0.342 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.745 +- 0.342 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all KL = 0.72 +- 0.342 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all L1 = 0.796 +- 0.257 (in-sample avg dev_std = 0.427)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0541518
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.712
SUFF_SIMPLE for r=0.2 class 0.0 = 0.845 +- 0.342 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.744 +- 0.342 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.2 all KL = 0.721 +- 0.342 (in-sample avg dev_std = 0.418)
SUFF_SIMPLE for r=0.2 all L1 = 0.795 +- 0.258 (in-sample avg dev_std = 0.418)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661512
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.712
SUFF_SIMPLE for r=0.4 class 0.0 = 0.852 +- 0.339 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.748 +- 0.339 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.4 all KL = 0.729 +- 0.339 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.4 all L1 = 0.801 +- 0.258 (in-sample avg dev_std = 0.406)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0795928
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.706
SUFF_SIMPLE for r=0.8 class 0.0 = 0.864 +- 0.366 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.73 +- 0.366 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.8 all KL = 0.736 +- 0.366 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.8 all L1 = 0.798 +- 0.276 (in-sample avg dev_std = 0.360)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052216000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.946
NEC for r=0.05 class 0.0 = 0.041 +- 0.180 (in-sample avg dev_std = 0.212)
NEC for r=0.05 class 1.0 = 0.095 +- 0.180 (in-sample avg dev_std = 0.212)
NEC for r=0.05 all KL = 0.072 +- 0.180 (in-sample avg dev_std = 0.212)
NEC for r=0.05 all L1 = 0.071 +- 0.135 (in-sample avg dev_std = 0.212)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.060155999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.941
NEC for r=0.1 class 0.0 = 0.042 +- 0.199 (in-sample avg dev_std = 0.251)
NEC for r=0.1 class 1.0 = 0.11 +- 0.199 (in-sample avg dev_std = 0.251)
NEC for r=0.1 all KL = 0.088 +- 0.199 (in-sample avg dev_std = 0.251)
NEC for r=0.1 all L1 = 0.08 +- 0.143 (in-sample avg dev_std = 0.251)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07136200000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.941
NEC for r=0.2 class 0.0 = 0.044 +- 0.184 (in-sample avg dev_std = 0.271)
NEC for r=0.2 class 1.0 = 0.108 +- 0.184 (in-sample avg dev_std = 0.271)
NEC for r=0.2 all KL = 0.093 +- 0.184 (in-sample avg dev_std = 0.271)
NEC for r=0.2 all L1 = 0.08 +- 0.125 (in-sample avg dev_std = 0.271)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07992999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.948
NEC for r=0.4 class 0.0 = 0.038 +- 0.170 (in-sample avg dev_std = 0.252)
NEC for r=0.4 class 1.0 = 0.1 +- 0.170 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all KL = 0.086 +- 0.170 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all L1 = 0.072 +- 0.111 (in-sample avg dev_std = 0.252)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085024
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.945
NEC for r=0.8 class 0.0 = 0.042 +- 0.181 (in-sample avg dev_std = 0.271)
NEC for r=0.8 class 1.0 = 0.11 +- 0.181 (in-sample avg dev_std = 0.271)
NEC for r=0.8 all KL = 0.101 +- 0.181 (in-sample avg dev_std = 0.271)
NEC for r=0.8 all L1 = 0.08 +- 0.113 (in-sample avg dev_std = 0.271)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009889
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.539
NEC for r=0.05 class 0.0 = 0.003 +- 0.112 (in-sample avg dev_std = 0.130)
NEC for r=0.05 class 1.0 = 0.085 +- 0.112 (in-sample avg dev_std = 0.130)
NEC for r=0.05 all KL = 0.032 +- 0.112 (in-sample avg dev_std = 0.130)
NEC for r=0.05 all L1 = 0.045 +- 0.126 (in-sample avg dev_std = 0.130)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010015000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.54
NEC for r=0.1 class 0.0 = 0.003 +- 0.111 (in-sample avg dev_std = 0.144)
NEC for r=0.1 class 1.0 = 0.088 +- 0.111 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all KL = 0.033 +- 0.111 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all L1 = 0.046 +- 0.125 (in-sample avg dev_std = 0.144)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010157000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.539
NEC for r=0.2 class 0.0 = 0.003 +- 0.115 (in-sample avg dev_std = 0.154)
NEC for r=0.2 class 1.0 = 0.09 +- 0.115 (in-sample avg dev_std = 0.154)
NEC for r=0.2 all KL = 0.036 +- 0.115 (in-sample avg dev_std = 0.154)
NEC for r=0.2 all L1 = 0.047 +- 0.126 (in-sample avg dev_std = 0.154)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.539
NEC for r=0.4 class 0.0 = 0.003 +- 0.115 (in-sample avg dev_std = 0.158)
NEC for r=0.4 class 1.0 = 0.09 +- 0.115 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all KL = 0.036 +- 0.115 (in-sample avg dev_std = 0.158)
NEC for r=0.4 all L1 = 0.047 +- 0.125 (in-sample avg dev_std = 0.158)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099502
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.54
NEC for r=0.8 class 0.0 = 0.003 +- 0.111 (in-sample avg dev_std = 0.154)
NEC for r=0.8 class 1.0 = 0.089 +- 0.111 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all KL = 0.035 +- 0.111 (in-sample avg dev_std = 0.154)
NEC for r=0.8 all L1 = 0.046 +- 0.124 (in-sample avg dev_std = 0.154)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0345068
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.762
NEC for r=0.05 class 0.0 = 0.081 +- 0.242 (in-sample avg dev_std = 0.163)
NEC for r=0.05 class 1.0 = 0.096 +- 0.242 (in-sample avg dev_std = 0.163)
NEC for r=0.05 all KL = 0.098 +- 0.242 (in-sample avg dev_std = 0.163)
NEC for r=0.05 all L1 = 0.089 +- 0.201 (in-sample avg dev_std = 0.163)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043183799999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.749
NEC for r=0.1 class 0.0 = 0.094 +- 0.273 (in-sample avg dev_std = 0.231)
NEC for r=0.1 class 1.0 = 0.13 +- 0.273 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all KL = 0.135 +- 0.273 (in-sample avg dev_std = 0.231)
NEC for r=0.1 all L1 = 0.112 +- 0.218 (in-sample avg dev_std = 0.231)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0541518
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.738
NEC for r=0.2 class 0.0 = 0.102 +- 0.285 (in-sample avg dev_std = 0.281)
NEC for r=0.2 class 1.0 = 0.15 +- 0.285 (in-sample avg dev_std = 0.281)
NEC for r=0.2 all KL = 0.159 +- 0.285 (in-sample avg dev_std = 0.281)
NEC for r=0.2 all L1 = 0.126 +- 0.224 (in-sample avg dev_std = 0.281)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661512
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.731
NEC for r=0.4 class 0.0 = 0.109 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=0.4 class 1.0 = 0.168 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=0.4 all KL = 0.181 +- 0.299 (in-sample avg dev_std = 0.330)
NEC for r=0.4 all L1 = 0.138 +- 0.228 (in-sample avg dev_std = 0.330)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0795928
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.732
NEC for r=0.8 class 0.0 = 0.112 +- 0.303 (in-sample avg dev_std = 0.367)
NEC for r=0.8 class 1.0 = 0.174 +- 0.303 (in-sample avg dev_std = 0.367)
NEC for r=0.8 all KL = 0.195 +- 0.303 (in-sample avg dev_std = 0.367)
NEC for r=0.8 all L1 = 0.143 +- 0.223 (in-sample avg dev_std = 0.367)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:37:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:37:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.050
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.072
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.041
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.049656000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.812
SUFF_SIMPLE for r=0.05 class 0.0 = 0.907 +- 0.356 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.614 +- 0.356 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.05 all KL = 0.66 +- 0.356 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.05 all L1 = 0.744 +- 0.241 (in-sample avg dev_std = 0.550)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.056898
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.812
SUFF_SIMPLE for r=0.1 class 0.0 = 0.897 +- 0.352 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.617 +- 0.352 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.1 all KL = 0.655 +- 0.352 (in-sample avg dev_std = 0.556)
SUFF_SIMPLE for r=0.1 all L1 = 0.742 +- 0.236 (in-sample avg dev_std = 0.556)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06566799999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.817
SUFF_SIMPLE for r=0.2 class 0.0 = 0.903 +- 0.351 (in-sample avg dev_std = 0.544)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.626 +- 0.351 (in-sample avg dev_std = 0.544)
SUFF_SIMPLE for r=0.2 all KL = 0.664 +- 0.351 (in-sample avg dev_std = 0.544)
SUFF_SIMPLE for r=0.2 all L1 = 0.75 +- 0.238 (in-sample avg dev_std = 0.544)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07182599999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.808
SUFF_SIMPLE for r=0.4 class 0.0 = 0.9 +- 0.353 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.617 +- 0.353 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.4 all KL = 0.658 +- 0.353 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.4 all L1 = 0.743 +- 0.243 (in-sample avg dev_std = 0.543)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.807
SUFF_SIMPLE for r=0.8 class 0.0 = 0.905 +- 0.364 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.634 +- 0.364 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.8 all KL = 0.698 +- 0.364 (in-sample avg dev_std = 0.475)
SUFF_SIMPLE for r=0.8 all L1 = 0.755 +- 0.267 (in-sample avg dev_std = 0.475)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0097578
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.509
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.114 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.911 +- 0.114 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.05 all KL = 0.968 +- 0.114 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.05 all L1 = 0.955 +- 0.137 (in-sample avg dev_std = 0.114)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009645
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.51
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.112 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.912 +- 0.112 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.112 (in-sample avg dev_std = 0.117)
SUFF_SIMPLE for r=0.1 all L1 = 0.955 +- 0.136 (in-sample avg dev_std = 0.117)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009702800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.51
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.114 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.911 +- 0.114 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.2 all KL = 0.968 +- 0.114 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.2 all L1 = 0.955 +- 0.137 (in-sample avg dev_std = 0.115)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009762
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.509
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.113 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.911 +- 0.113 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 all KL = 0.968 +- 0.113 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.4 all L1 = 0.955 +- 0.136 (in-sample avg dev_std = 0.113)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097938
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.51
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.109 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.913 +- 0.109 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 all KL = 0.969 +- 0.109 (in-sample avg dev_std = 0.105)
SUFF_SIMPLE for r=0.8 all L1 = 0.956 +- 0.135 (in-sample avg dev_std = 0.105)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0322302
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.666
SUFF_SIMPLE for r=0.05 class 0.0 = 0.823 +- 0.372 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.645 +- 0.372 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all KL = 0.619 +- 0.372 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all L1 = 0.735 +- 0.274 (in-sample avg dev_std = 0.567)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0411626
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.664
SUFF_SIMPLE for r=0.1 class 0.0 = 0.823 +- 0.370 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.643 +- 0.370 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.1 all KL = 0.619 +- 0.370 (in-sample avg dev_std = 0.561)
SUFF_SIMPLE for r=0.1 all L1 = 0.734 +- 0.274 (in-sample avg dev_std = 0.561)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05165940000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.661
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.368 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.642 +- 0.368 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.2 all KL = 0.629 +- 0.368 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.2 all L1 = 0.737 +- 0.276 (in-sample avg dev_std = 0.550)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0649006
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.652
SUFF_SIMPLE for r=0.4 class 0.0 = 0.835 +- 0.369 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.631 +- 0.369 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.4 all KL = 0.629 +- 0.369 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.4 all L1 = 0.734 +- 0.279 (in-sample avg dev_std = 0.550)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0788566
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.602
SUFF_SIMPLE for r=0.8 class 0.0 = 0.841 +- 0.409 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.574 +- 0.409 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.8 all KL = 0.628 +- 0.409 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.8 all L1 = 0.709 +- 0.326 (in-sample avg dev_std = 0.478)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.049656000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.917
NEC for r=0.05 class 0.0 = 0.044 +- 0.250 (in-sample avg dev_std = 0.304)
NEC for r=0.05 class 1.0 = 0.134 +- 0.250 (in-sample avg dev_std = 0.304)
NEC for r=0.05 all KL = 0.108 +- 0.250 (in-sample avg dev_std = 0.304)
NEC for r=0.05 all L1 = 0.094 +- 0.182 (in-sample avg dev_std = 0.304)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.056898
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.917
NEC for r=0.1 class 0.0 = 0.044 +- 0.252 (in-sample avg dev_std = 0.318)
NEC for r=0.1 class 1.0 = 0.143 +- 0.252 (in-sample avg dev_std = 0.318)
NEC for r=0.1 all KL = 0.121 +- 0.252 (in-sample avg dev_std = 0.318)
NEC for r=0.1 all L1 = 0.099 +- 0.175 (in-sample avg dev_std = 0.318)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06566799999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.916
NEC for r=0.2 class 0.0 = 0.044 +- 0.250 (in-sample avg dev_std = 0.357)
NEC for r=0.2 class 1.0 = 0.156 +- 0.250 (in-sample avg dev_std = 0.357)
NEC for r=0.2 all KL = 0.141 +- 0.250 (in-sample avg dev_std = 0.357)
NEC for r=0.2 all L1 = 0.106 +- 0.158 (in-sample avg dev_std = 0.357)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07182599999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.92
NEC for r=0.4 class 0.0 = 0.05 +- 0.246 (in-sample avg dev_std = 0.356)
NEC for r=0.4 class 1.0 = 0.146 +- 0.246 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all KL = 0.141 +- 0.246 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all L1 = 0.103 +- 0.150 (in-sample avg dev_std = 0.356)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.918
NEC for r=0.8 class 0.0 = 0.048 +- 0.242 (in-sample avg dev_std = 0.358)
NEC for r=0.8 class 1.0 = 0.146 +- 0.242 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all KL = 0.138 +- 0.242 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all L1 = 0.102 +- 0.149 (in-sample avg dev_std = 0.358)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0097578
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.521
NEC for r=0.05 class 0.0 = 0.0 +- 0.076 (in-sample avg dev_std = 0.095)
NEC for r=0.05 class 1.0 = 0.058 +- 0.076 (in-sample avg dev_std = 0.095)
NEC for r=0.05 all KL = 0.016 +- 0.076 (in-sample avg dev_std = 0.095)
NEC for r=0.05 all L1 = 0.029 +- 0.097 (in-sample avg dev_std = 0.095)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009645
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.522
NEC for r=0.1 class 0.0 = 0.0 +- 0.070 (in-sample avg dev_std = 0.106)
NEC for r=0.1 class 1.0 = 0.059 +- 0.070 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all KL = 0.016 +- 0.070 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all L1 = 0.03 +- 0.093 (in-sample avg dev_std = 0.106)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009702800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.521
NEC for r=0.2 class 0.0 = 0.0 +- 0.069 (in-sample avg dev_std = 0.107)
NEC for r=0.2 class 1.0 = 0.058 +- 0.069 (in-sample avg dev_std = 0.107)
NEC for r=0.2 all KL = 0.016 +- 0.069 (in-sample avg dev_std = 0.107)
NEC for r=0.2 all L1 = 0.03 +- 0.092 (in-sample avg dev_std = 0.107)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009762
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.522
NEC for r=0.4 class 0.0 = 0.0 +- 0.065 (in-sample avg dev_std = 0.108)
NEC for r=0.4 class 1.0 = 0.058 +- 0.065 (in-sample avg dev_std = 0.108)
NEC for r=0.4 all KL = 0.016 +- 0.065 (in-sample avg dev_std = 0.108)
NEC for r=0.4 all L1 = 0.029 +- 0.090 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097938
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.522
NEC for r=0.8 class 0.0 = 0.001 +- 0.065 (in-sample avg dev_std = 0.111)
NEC for r=0.8 class 1.0 = 0.059 +- 0.065 (in-sample avg dev_std = 0.111)
NEC for r=0.8 all KL = 0.017 +- 0.065 (in-sample avg dev_std = 0.111)
NEC for r=0.8 all L1 = 0.03 +- 0.091 (in-sample avg dev_std = 0.111)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0322302
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.722
NEC for r=0.05 class 0.0 = 0.084 +- 0.293 (in-sample avg dev_std = 0.268)
NEC for r=0.05 class 1.0 = 0.137 +- 0.293 (in-sample avg dev_std = 0.268)
NEC for r=0.05 all KL = 0.134 +- 0.293 (in-sample avg dev_std = 0.268)
NEC for r=0.05 all L1 = 0.11 +- 0.235 (in-sample avg dev_std = 0.268)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0411626
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.712
NEC for r=0.1 class 0.0 = 0.102 +- 0.317 (in-sample avg dev_std = 0.353)
NEC for r=0.1 class 1.0 = 0.177 +- 0.317 (in-sample avg dev_std = 0.353)
NEC for r=0.1 all KL = 0.182 +- 0.317 (in-sample avg dev_std = 0.353)
NEC for r=0.1 all L1 = 0.139 +- 0.245 (in-sample avg dev_std = 0.353)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05165940000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.699
NEC for r=0.2 class 0.0 = 0.109 +- 0.323 (in-sample avg dev_std = 0.400)
NEC for r=0.2 class 1.0 = 0.204 +- 0.323 (in-sample avg dev_std = 0.400)
NEC for r=0.2 all KL = 0.212 +- 0.323 (in-sample avg dev_std = 0.400)
NEC for r=0.2 all L1 = 0.156 +- 0.245 (in-sample avg dev_std = 0.400)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0649006
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.695
NEC for r=0.4 class 0.0 = 0.11 +- 0.330 (in-sample avg dev_std = 0.438)
NEC for r=0.4 class 1.0 = 0.223 +- 0.330 (in-sample avg dev_std = 0.438)
NEC for r=0.4 all KL = 0.236 +- 0.330 (in-sample avg dev_std = 0.438)
NEC for r=0.4 all L1 = 0.166 +- 0.243 (in-sample avg dev_std = 0.438)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0788566
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.698
NEC for r=0.8 class 0.0 = 0.121 +- 0.334 (in-sample avg dev_std = 0.465)
NEC for r=0.8 class 1.0 = 0.227 +- 0.334 (in-sample avg dev_std = 0.465)
NEC for r=0.8 all KL = 0.254 +- 0.334 (in-sample avg dev_std = 0.465)
NEC for r=0.8 all L1 = 0.173 +- 0.239 (in-sample avg dev_std = 0.465)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 03:55:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:55:44 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.056
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.063
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.074
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.053
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056016
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.808
SUFF_SIMPLE for r=0.05 class 0.0 = 0.906 +- 0.356 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.593 +- 0.356 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.05 all KL = 0.654 +- 0.356 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.05 all L1 = 0.732 +- 0.245 (in-sample avg dev_std = 0.566)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06277200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.811
SUFF_SIMPLE for r=0.1 class 0.0 = 0.905 +- 0.358 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.594 +- 0.358 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.1 all KL = 0.654 +- 0.358 (in-sample avg dev_std = 0.568)
SUFF_SIMPLE for r=0.1 all L1 = 0.733 +- 0.246 (in-sample avg dev_std = 0.568)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07413400000000002
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.82
SUFF_SIMPLE for r=0.2 class 0.0 = 0.905 +- 0.353 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.602 +- 0.353 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.2 all KL = 0.653 +- 0.353 (in-sample avg dev_std = 0.571)
SUFF_SIMPLE for r=0.2 all L1 = 0.737 +- 0.237 (in-sample avg dev_std = 0.571)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07953199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.82
SUFF_SIMPLE for r=0.4 class 0.0 = 0.901 +- 0.349 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.61 +- 0.349 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.4 all KL = 0.662 +- 0.349 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.4 all L1 = 0.74 +- 0.239 (in-sample avg dev_std = 0.557)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08368199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.821
SUFF_SIMPLE for r=0.8 class 0.0 = 0.9 +- 0.359 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.64 +- 0.359 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.8 all KL = 0.709 +- 0.359 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.8 all L1 = 0.756 +- 0.266 (in-sample avg dev_std = 0.470)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009431400000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.513
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.144 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.853 +- 0.144 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.05 all KL = 0.946 +- 0.144 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.05 all L1 = 0.925 +- 0.171 (in-sample avg dev_std = 0.140)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.513
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.145 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.853 +- 0.145 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.1 all KL = 0.946 +- 0.145 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.1 all L1 = 0.924 +- 0.171 (in-sample avg dev_std = 0.142)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009599600000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.514
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.144 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.853 +- 0.144 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all KL = 0.946 +- 0.144 (in-sample avg dev_std = 0.142)
SUFF_SIMPLE for r=0.2 all L1 = 0.925 +- 0.171 (in-sample avg dev_std = 0.142)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096322
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.514
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.142 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.854 +- 0.142 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.4 all KL = 0.947 +- 0.142 (in-sample avg dev_std = 0.135)
SUFF_SIMPLE for r=0.4 all L1 = 0.925 +- 0.170 (in-sample avg dev_std = 0.135)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.514
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.143 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.854 +- 0.143 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all KL = 0.947 +- 0.143 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all L1 = 0.925 +- 0.170 (in-sample avg dev_std = 0.133)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03302859999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.67
SUFF_SIMPLE for r=0.05 class 0.0 = 0.826 +- 0.385 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.628 +- 0.385 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 all KL = 0.614 +- 0.385 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 all L1 = 0.728 +- 0.275 (in-sample avg dev_std = 0.584)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0427978
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.67
SUFF_SIMPLE for r=0.1 class 0.0 = 0.824 +- 0.383 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.631 +- 0.383 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.1 all KL = 0.616 +- 0.383 (in-sample avg dev_std = 0.585)
SUFF_SIMPLE for r=0.1 all L1 = 0.729 +- 0.274 (in-sample avg dev_std = 0.585)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052964599999999994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.664
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.381 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.63 +- 0.381 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.2 all KL = 0.632 +- 0.381 (in-sample avg dev_std = 0.569)
SUFF_SIMPLE for r=0.2 all L1 = 0.731 +- 0.279 (in-sample avg dev_std = 0.569)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066387
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.658
SUFF_SIMPLE for r=0.4 class 0.0 = 0.834 +- 0.378 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.634 +- 0.378 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.4 all KL = 0.643 +- 0.378 (in-sample avg dev_std = 0.562)
SUFF_SIMPLE for r=0.4 all L1 = 0.735 +- 0.281 (in-sample avg dev_std = 0.562)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.759
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08038319999999999
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.63
SUFF_SIMPLE for r=0.8 class 0.0 = 0.835 +- 0.401 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.598 +- 0.401 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.8 all KL = 0.648 +- 0.401 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.8 all L1 = 0.718 +- 0.319 (in-sample avg dev_std = 0.500)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056016
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.922
NEC for r=0.05 class 0.0 = 0.045 +- 0.265 (in-sample avg dev_std = 0.328)
NEC for r=0.05 class 1.0 = 0.152 +- 0.265 (in-sample avg dev_std = 0.328)
NEC for r=0.05 all KL = 0.123 +- 0.265 (in-sample avg dev_std = 0.328)
NEC for r=0.05 all L1 = 0.105 +- 0.187 (in-sample avg dev_std = 0.328)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06277200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.922
NEC for r=0.1 class 0.0 = 0.047 +- 0.259 (in-sample avg dev_std = 0.352)
NEC for r=0.1 class 1.0 = 0.156 +- 0.259 (in-sample avg dev_std = 0.352)
NEC for r=0.1 all KL = 0.134 +- 0.259 (in-sample avg dev_std = 0.352)
NEC for r=0.1 all L1 = 0.107 +- 0.173 (in-sample avg dev_std = 0.352)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07413400000000002
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.916
NEC for r=0.2 class 0.0 = 0.049 +- 0.270 (in-sample avg dev_std = 0.388)
NEC for r=0.2 class 1.0 = 0.174 +- 0.270 (in-sample avg dev_std = 0.388)
NEC for r=0.2 all KL = 0.155 +- 0.270 (in-sample avg dev_std = 0.388)
NEC for r=0.2 all L1 = 0.118 +- 0.171 (in-sample avg dev_std = 0.388)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07953199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.91
NEC for r=0.4 class 0.0 = 0.049 +- 0.273 (in-sample avg dev_std = 0.411)
NEC for r=0.4 class 1.0 = 0.186 +- 0.273 (in-sample avg dev_std = 0.411)
NEC for r=0.4 all KL = 0.172 +- 0.273 (in-sample avg dev_std = 0.411)
NEC for r=0.4 all L1 = 0.125 +- 0.168 (in-sample avg dev_std = 0.411)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08368199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.924
NEC for r=0.8 class 0.0 = 0.047 +- 0.261 (in-sample avg dev_std = 0.388)
NEC for r=0.8 class 1.0 = 0.163 +- 0.261 (in-sample avg dev_std = 0.388)
NEC for r=0.8 all KL = 0.155 +- 0.261 (in-sample avg dev_std = 0.388)
NEC for r=0.8 all L1 = 0.111 +- 0.150 (in-sample avg dev_std = 0.388)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009431400000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.531
NEC for r=0.05 class 0.0 = 0.002 +- 0.089 (in-sample avg dev_std = 0.109)
NEC for r=0.05 class 1.0 = 0.096 +- 0.089 (in-sample avg dev_std = 0.109)
NEC for r=0.05 all KL = 0.025 +- 0.089 (in-sample avg dev_std = 0.109)
NEC for r=0.05 all L1 = 0.049 +- 0.119 (in-sample avg dev_std = 0.109)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.531
NEC for r=0.1 class 0.0 = 0.002 +- 0.090 (in-sample avg dev_std = 0.127)
NEC for r=0.1 class 1.0 = 0.1 +- 0.090 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all KL = 0.028 +- 0.090 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all L1 = 0.051 +- 0.120 (in-sample avg dev_std = 0.127)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009599600000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.53
NEC for r=0.2 class 0.0 = 0.002 +- 0.086 (in-sample avg dev_std = 0.131)
NEC for r=0.2 class 1.0 = 0.099 +- 0.086 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all KL = 0.027 +- 0.086 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all L1 = 0.051 +- 0.117 (in-sample avg dev_std = 0.131)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096322
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.531
NEC for r=0.4 class 0.0 = 0.002 +- 0.086 (in-sample avg dev_std = 0.136)
NEC for r=0.4 class 1.0 = 0.1 +- 0.086 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all KL = 0.028 +- 0.086 (in-sample avg dev_std = 0.136)
NEC for r=0.4 all L1 = 0.051 +- 0.117 (in-sample avg dev_std = 0.136)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.531
NEC for r=0.8 class 0.0 = 0.002 +- 0.088 (in-sample avg dev_std = 0.140)
NEC for r=0.8 class 1.0 = 0.101 +- 0.088 (in-sample avg dev_std = 0.140)
NEC for r=0.8 all KL = 0.029 +- 0.088 (in-sample avg dev_std = 0.140)
NEC for r=0.8 all L1 = 0.052 +- 0.118 (in-sample avg dev_std = 0.140)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03302859999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.716
NEC for r=0.05 class 0.0 = 0.084 +- 0.306 (in-sample avg dev_std = 0.289)
NEC for r=0.05 class 1.0 = 0.16 +- 0.306 (in-sample avg dev_std = 0.289)
NEC for r=0.05 all KL = 0.143 +- 0.306 (in-sample avg dev_std = 0.289)
NEC for r=0.05 all L1 = 0.122 +- 0.246 (in-sample avg dev_std = 0.289)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0427978
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.703
NEC for r=0.1 class 0.0 = 0.097 +- 0.331 (in-sample avg dev_std = 0.372)
NEC for r=0.1 class 1.0 = 0.2 +- 0.331 (in-sample avg dev_std = 0.372)
NEC for r=0.1 all KL = 0.189 +- 0.331 (in-sample avg dev_std = 0.372)
NEC for r=0.1 all L1 = 0.148 +- 0.253 (in-sample avg dev_std = 0.372)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052964599999999994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.7
NEC for r=0.2 class 0.0 = 0.106 +- 0.333 (in-sample avg dev_std = 0.429)
NEC for r=0.2 class 1.0 = 0.221 +- 0.333 (in-sample avg dev_std = 0.429)
NEC for r=0.2 all KL = 0.221 +- 0.333 (in-sample avg dev_std = 0.429)
NEC for r=0.2 all L1 = 0.163 +- 0.245 (in-sample avg dev_std = 0.429)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066387
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.699
NEC for r=0.4 class 0.0 = 0.111 +- 0.340 (in-sample avg dev_std = 0.467)
NEC for r=0.4 class 1.0 = 0.235 +- 0.340 (in-sample avg dev_std = 0.467)
NEC for r=0.4 all KL = 0.246 +- 0.340 (in-sample avg dev_std = 0.467)
NEC for r=0.4 all L1 = 0.172 +- 0.240 (in-sample avg dev_std = 0.467)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.758
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08038319999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.696
NEC for r=0.8 class 0.0 = 0.112 +- 0.349 (in-sample avg dev_std = 0.489)
NEC for r=0.8 class 1.0 = 0.242 +- 0.349 (in-sample avg dev_std = 0.489)
NEC for r=0.8 all KL = 0.263 +- 0.349 (in-sample avg dev_std = 0.489)
NEC for r=0.8 all L1 = 0.177 +- 0.237 (in-sample avg dev_std = 0.489)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:14:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:14:09 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.042
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.051
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.062
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.031
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.039
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.042006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.767
SUFF_SIMPLE for r=0.05 class 0.0 = 0.878 +- 0.322 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.54 +- 0.322 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.05 all KL = 0.654 +- 0.322 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.05 all L1 = 0.691 +- 0.255 (in-sample avg dev_std = 0.530)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051398000000000006
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.772
SUFF_SIMPLE for r=0.1 class 0.0 = 0.881 +- 0.325 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.538 +- 0.325 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.1 all KL = 0.657 +- 0.325 (in-sample avg dev_std = 0.527)
SUFF_SIMPLE for r=0.1 all L1 = 0.691 +- 0.257 (in-sample avg dev_std = 0.527)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.062258
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.764
SUFF_SIMPLE for r=0.2 class 0.0 = 0.882 +- 0.329 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.535 +- 0.329 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.2 all KL = 0.656 +- 0.329 (in-sample avg dev_std = 0.522)
SUFF_SIMPLE for r=0.2 all L1 = 0.69 +- 0.261 (in-sample avg dev_std = 0.522)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071108
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.772
SUFF_SIMPLE for r=0.4 class 0.0 = 0.881 +- 0.319 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.549 +- 0.319 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.4 all KL = 0.667 +- 0.319 (in-sample avg dev_std = 0.509)
SUFF_SIMPLE for r=0.4 all L1 = 0.697 +- 0.255 (in-sample avg dev_std = 0.509)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078322
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.752
SUFF_SIMPLE for r=0.8 class 0.0 = 0.883 +- 0.346 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.539 +- 0.346 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.8 all KL = 0.675 +- 0.346 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.8 all L1 = 0.693 +- 0.284 (in-sample avg dev_std = 0.465)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090484
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.091 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.915 +- 0.091 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.05 all KL = 0.973 +- 0.091 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.05 all L1 = 0.957 +- 0.124 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009418
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.091 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.915 +- 0.091 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.1 all KL = 0.973 +- 0.091 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.1 all L1 = 0.957 +- 0.124 (in-sample avg dev_std = 0.048)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009648400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.090 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.915 +- 0.090 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.2 all KL = 0.973 +- 0.090 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.2 all L1 = 0.957 +- 0.124 (in-sample avg dev_std = 0.050)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00977
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.091 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.915 +- 0.091 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.4 all KL = 0.973 +- 0.091 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.4 all L1 = 0.957 +- 0.124 (in-sample avg dev_std = 0.049)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097698
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.090 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.916 +- 0.090 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 all KL = 0.973 +- 0.090 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.8 all L1 = 0.957 +- 0.124 (in-sample avg dev_std = 0.047)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0306144
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.673
SUFF_SIMPLE for r=0.05 class 0.0 = 0.846 +- 0.341 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.682 +- 0.341 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.05 all KL = 0.692 +- 0.341 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.05 all L1 = 0.765 +- 0.262 (in-sample avg dev_std = 0.521)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0393344
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.673
SUFF_SIMPLE for r=0.1 class 0.0 = 0.845 +- 0.339 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.685 +- 0.339 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.1 all KL = 0.693 +- 0.339 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.1 all L1 = 0.766 +- 0.262 (in-sample avg dev_std = 0.517)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0511508
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.673
SUFF_SIMPLE for r=0.2 class 0.0 = 0.842 +- 0.337 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.688 +- 0.337 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.2 all KL = 0.702 +- 0.337 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.2 all L1 = 0.766 +- 0.265 (in-sample avg dev_std = 0.508)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0650544
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.668
SUFF_SIMPLE for r=0.4 class 0.0 = 0.847 +- 0.334 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.689 +- 0.334 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.4 all KL = 0.714 +- 0.334 (in-sample avg dev_std = 0.500)
SUFF_SIMPLE for r=0.4 all L1 = 0.769 +- 0.270 (in-sample avg dev_std = 0.500)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790352
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.676
SUFF_SIMPLE for r=0.8 class 0.0 = 0.861 +- 0.343 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.708 +- 0.343 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.8 all KL = 0.747 +- 0.343 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.8 all L1 = 0.786 +- 0.281 (in-sample avg dev_std = 0.453)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.042006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.906
NEC for r=0.05 class 0.0 = 0.066 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.05 class 1.0 = 0.154 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.05 all KL = 0.101 +- 0.202 (in-sample avg dev_std = 0.282)
NEC for r=0.05 all L1 = 0.115 +- 0.176 (in-sample avg dev_std = 0.282)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051398000000000006
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.899
NEC for r=0.1 class 0.0 = 0.075 +- 0.206 (in-sample avg dev_std = 0.326)
NEC for r=0.1 class 1.0 = 0.169 +- 0.206 (in-sample avg dev_std = 0.326)
NEC for r=0.1 all KL = 0.121 +- 0.206 (in-sample avg dev_std = 0.326)
NEC for r=0.1 all L1 = 0.127 +- 0.171 (in-sample avg dev_std = 0.326)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.062258
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.901
NEC for r=0.2 class 0.0 = 0.074 +- 0.203 (in-sample avg dev_std = 0.339)
NEC for r=0.2 class 1.0 = 0.178 +- 0.203 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all KL = 0.129 +- 0.203 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all L1 = 0.132 +- 0.167 (in-sample avg dev_std = 0.339)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071108
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.892
NEC for r=0.4 class 0.0 = 0.073 +- 0.214 (in-sample avg dev_std = 0.377)
NEC for r=0.4 class 1.0 = 0.204 +- 0.214 (in-sample avg dev_std = 0.377)
NEC for r=0.4 all KL = 0.15 +- 0.214 (in-sample avg dev_std = 0.377)
NEC for r=0.4 all L1 = 0.146 +- 0.168 (in-sample avg dev_std = 0.377)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078322
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.901
NEC for r=0.8 class 0.0 = 0.07 +- 0.198 (in-sample avg dev_std = 0.357)
NEC for r=0.8 class 1.0 = 0.182 +- 0.198 (in-sample avg dev_std = 0.357)
NEC for r=0.8 all KL = 0.135 +- 0.198 (in-sample avg dev_std = 0.357)
NEC for r=0.8 all L1 = 0.132 +- 0.159 (in-sample avg dev_std = 0.357)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090484
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.501
NEC for r=0.05 class 0.0 = 0.001 +- 0.060 (in-sample avg dev_std = 0.064)
NEC for r=0.05 class 1.0 = 0.064 +- 0.060 (in-sample avg dev_std = 0.064)
NEC for r=0.05 all KL = 0.016 +- 0.060 (in-sample avg dev_std = 0.064)
NEC for r=0.05 all L1 = 0.033 +- 0.096 (in-sample avg dev_std = 0.064)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009418
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.001 +- 0.059 (in-sample avg dev_std = 0.069)
NEC for r=0.1 class 1.0 = 0.065 +- 0.059 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all KL = 0.017 +- 0.059 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all L1 = 0.033 +- 0.096 (in-sample avg dev_std = 0.069)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009648400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
NEC for r=0.2 class 0.0 = 0.0 +- 0.058 (in-sample avg dev_std = 0.072)
NEC for r=0.2 class 1.0 = 0.066 +- 0.058 (in-sample avg dev_std = 0.072)
NEC for r=0.2 all KL = 0.017 +- 0.058 (in-sample avg dev_std = 0.072)
NEC for r=0.2 all L1 = 0.033 +- 0.096 (in-sample avg dev_std = 0.072)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00977
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.501
NEC for r=0.4 class 0.0 = 0.001 +- 0.057 (in-sample avg dev_std = 0.069)
NEC for r=0.4 class 1.0 = 0.065 +- 0.057 (in-sample avg dev_std = 0.069)
NEC for r=0.4 all KL = 0.016 +- 0.057 (in-sample avg dev_std = 0.069)
NEC for r=0.4 all L1 = 0.033 +- 0.095 (in-sample avg dev_std = 0.069)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097698
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
NEC for r=0.8 class 0.0 = 0.001 +- 0.056 (in-sample avg dev_std = 0.070)
NEC for r=0.8 class 1.0 = 0.065 +- 0.056 (in-sample avg dev_std = 0.070)
NEC for r=0.8 all KL = 0.016 +- 0.056 (in-sample avg dev_std = 0.070)
NEC for r=0.8 all L1 = 0.033 +- 0.095 (in-sample avg dev_std = 0.070)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0306144
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.721
NEC for r=0.05 class 0.0 = 0.081 +- 0.268 (in-sample avg dev_std = 0.256)
NEC for r=0.05 class 1.0 = 0.14 +- 0.268 (in-sample avg dev_std = 0.256)
NEC for r=0.05 all KL = 0.117 +- 0.268 (in-sample avg dev_std = 0.256)
NEC for r=0.05 all L1 = 0.11 +- 0.231 (in-sample avg dev_std = 0.256)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0393344
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.711
NEC for r=0.1 class 0.0 = 0.093 +- 0.286 (in-sample avg dev_std = 0.332)
NEC for r=0.1 class 1.0 = 0.176 +- 0.286 (in-sample avg dev_std = 0.332)
NEC for r=0.1 all KL = 0.152 +- 0.286 (in-sample avg dev_std = 0.332)
NEC for r=0.1 all L1 = 0.134 +- 0.239 (in-sample avg dev_std = 0.332)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0511508
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.697
NEC for r=0.2 class 0.0 = 0.098 +- 0.291 (in-sample avg dev_std = 0.384)
NEC for r=0.2 class 1.0 = 0.202 +- 0.291 (in-sample avg dev_std = 0.384)
NEC for r=0.2 all KL = 0.179 +- 0.291 (in-sample avg dev_std = 0.384)
NEC for r=0.2 all L1 = 0.15 +- 0.238 (in-sample avg dev_std = 0.384)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0650544
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.694
NEC for r=0.4 class 0.0 = 0.102 +- 0.293 (in-sample avg dev_std = 0.413)
NEC for r=0.4 class 1.0 = 0.213 +- 0.293 (in-sample avg dev_std = 0.413)
NEC for r=0.4 all KL = 0.195 +- 0.293 (in-sample avg dev_std = 0.413)
NEC for r=0.4 all L1 = 0.156 +- 0.232 (in-sample avg dev_std = 0.413)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790352
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.696
NEC for r=0.8 class 0.0 = 0.108 +- 0.300 (in-sample avg dev_std = 0.437)
NEC for r=0.8 class 1.0 = 0.216 +- 0.300 (in-sample avg dev_std = 0.437)
NEC for r=0.8 all KL = 0.211 +- 0.300 (in-sample avg dev_std = 0.437)
NEC for r=0.8 all L1 = 0.161 +- 0.229 (in-sample avg dev_std = 0.437)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:32:55 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:32:55 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.054
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.065
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.053778
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.817
SUFF_SIMPLE for r=0.05 class 0.0 = 0.922 +- 0.331 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.636 +- 0.331 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.05 all KL = 0.7 +- 0.331 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.05 all L1 = 0.763 +- 0.236 (in-sample avg dev_std = 0.494)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06461199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.818
SUFF_SIMPLE for r=0.1 class 0.0 = 0.918 +- 0.336 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.63 +- 0.336 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all KL = 0.693 +- 0.336 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all L1 = 0.758 +- 0.239 (in-sample avg dev_std = 0.506)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07291999999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.817
SUFF_SIMPLE for r=0.2 class 0.0 = 0.921 +- 0.326 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.629 +- 0.326 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.2 all KL = 0.692 +- 0.326 (in-sample avg dev_std = 0.508)
SUFF_SIMPLE for r=0.2 all L1 = 0.759 +- 0.233 (in-sample avg dev_std = 0.508)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076572
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.818
SUFF_SIMPLE for r=0.4 class 0.0 = 0.921 +- 0.332 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.633 +- 0.332 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.4 all KL = 0.703 +- 0.332 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.4 all L1 = 0.761 +- 0.239 (in-sample avg dev_std = 0.489)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080766
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.822
SUFF_SIMPLE for r=0.8 class 0.0 = 0.923 +- 0.340 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.664 +- 0.340 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.8 all KL = 0.745 +- 0.340 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.8 all L1 = 0.779 +- 0.259 (in-sample avg dev_std = 0.406)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0102602
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.501
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.103 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.921 +- 0.103 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.05 all KL = 0.972 +- 0.103 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.05 all L1 = 0.96 +- 0.132 (in-sample avg dev_std = 0.076)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010405000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.105 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.92 +- 0.105 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.1 all KL = 0.972 +- 0.105 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.1 all L1 = 0.959 +- 0.133 (in-sample avg dev_std = 0.077)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0101366
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.104 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.92 +- 0.104 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.2 all KL = 0.972 +- 0.104 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.2 all L1 = 0.96 +- 0.133 (in-sample avg dev_std = 0.075)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100754
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.501
SUFF_SIMPLE for r=0.4 class 0.0 = 1.0 +- 0.104 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.92 +- 0.104 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.4 all KL = 0.972 +- 0.104 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.4 all L1 = 0.959 +- 0.133 (in-sample avg dev_std = 0.075)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099994
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
SUFF_SIMPLE for r=0.8 class 0.0 = 1.0 +- 0.103 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.92 +- 0.103 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.8 all KL = 0.972 +- 0.103 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.8 all L1 = 0.96 +- 0.132 (in-sample avg dev_std = 0.075)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0326934
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.676
SUFF_SIMPLE for r=0.05 class 0.0 = 0.852 +- 0.358 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.672 +- 0.358 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.05 all KL = 0.674 +- 0.358 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.05 all L1 = 0.763 +- 0.275 (in-sample avg dev_std = 0.486)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0418
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.678
SUFF_SIMPLE for r=0.1 class 0.0 = 0.853 +- 0.356 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.672 +- 0.356 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.1 all KL = 0.674 +- 0.356 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.1 all L1 = 0.764 +- 0.274 (in-sample avg dev_std = 0.488)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05241099999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.676
SUFF_SIMPLE for r=0.2 class 0.0 = 0.853 +- 0.359 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.673 +- 0.359 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.2 all KL = 0.678 +- 0.359 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.2 all L1 = 0.764 +- 0.277 (in-sample avg dev_std = 0.476)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06525059999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.678
SUFF_SIMPLE for r=0.4 class 0.0 = 0.852 +- 0.356 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.676 +- 0.356 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.4 all KL = 0.679 +- 0.356 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.4 all L1 = 0.765 +- 0.276 (in-sample avg dev_std = 0.473)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079707
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.681
SUFF_SIMPLE for r=0.8 class 0.0 = 0.865 +- 0.368 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.701 +- 0.368 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.8 all KL = 0.718 +- 0.368 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.8 all L1 = 0.784 +- 0.285 (in-sample avg dev_std = 0.415)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.053778
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.915
NEC for r=0.05 class 0.0 = 0.043 +- 0.227 (in-sample avg dev_std = 0.257)
NEC for r=0.05 class 1.0 = 0.127 +- 0.227 (in-sample avg dev_std = 0.257)
NEC for r=0.05 all KL = 0.093 +- 0.227 (in-sample avg dev_std = 0.257)
NEC for r=0.05 all L1 = 0.09 +- 0.176 (in-sample avg dev_std = 0.257)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06461199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.917
NEC for r=0.1 class 0.0 = 0.04 +- 0.237 (in-sample avg dev_std = 0.310)
NEC for r=0.1 class 1.0 = 0.145 +- 0.237 (in-sample avg dev_std = 0.310)
NEC for r=0.1 all KL = 0.115 +- 0.237 (in-sample avg dev_std = 0.310)
NEC for r=0.1 all L1 = 0.098 +- 0.168 (in-sample avg dev_std = 0.310)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07291999999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.915
NEC for r=0.2 class 0.0 = 0.041 +- 0.236 (in-sample avg dev_std = 0.349)
NEC for r=0.2 class 1.0 = 0.158 +- 0.236 (in-sample avg dev_std = 0.349)
NEC for r=0.2 all KL = 0.132 +- 0.236 (in-sample avg dev_std = 0.349)
NEC for r=0.2 all L1 = 0.106 +- 0.157 (in-sample avg dev_std = 0.349)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076572
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.923
NEC for r=0.4 class 0.0 = 0.041 +- 0.209 (in-sample avg dev_std = 0.313)
NEC for r=0.4 class 1.0 = 0.134 +- 0.209 (in-sample avg dev_std = 0.313)
NEC for r=0.4 all KL = 0.114 +- 0.209 (in-sample avg dev_std = 0.313)
NEC for r=0.4 all L1 = 0.093 +- 0.139 (in-sample avg dev_std = 0.313)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080766
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.913
NEC for r=0.8 class 0.0 = 0.045 +- 0.227 (in-sample avg dev_std = 0.358)
NEC for r=0.8 class 1.0 = 0.16 +- 0.227 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all KL = 0.14 +- 0.227 (in-sample avg dev_std = 0.358)
NEC for r=0.8 all L1 = 0.109 +- 0.149 (in-sample avg dev_std = 0.358)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0102602
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.509
NEC for r=0.05 class 0.0 = 0.0 +- 0.061 (in-sample avg dev_std = 0.069)
NEC for r=0.05 class 1.0 = 0.057 +- 0.061 (in-sample avg dev_std = 0.069)
NEC for r=0.05 all KL = 0.014 +- 0.061 (in-sample avg dev_std = 0.069)
NEC for r=0.05 all L1 = 0.029 +- 0.096 (in-sample avg dev_std = 0.069)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010405000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.51
NEC for r=0.1 class 0.0 = 0.0 +- 0.058 (in-sample avg dev_std = 0.075)
NEC for r=0.1 class 1.0 = 0.057 +- 0.058 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all KL = 0.014 +- 0.058 (in-sample avg dev_std = 0.075)
NEC for r=0.1 all L1 = 0.029 +- 0.094 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0101366
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.51
NEC for r=0.2 class 0.0 = 0.0 +- 0.060 (in-sample avg dev_std = 0.082)
NEC for r=0.2 class 1.0 = 0.058 +- 0.060 (in-sample avg dev_std = 0.082)
NEC for r=0.2 all KL = 0.015 +- 0.060 (in-sample avg dev_std = 0.082)
NEC for r=0.2 all L1 = 0.029 +- 0.095 (in-sample avg dev_std = 0.082)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100754
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.0 +- 0.058 (in-sample avg dev_std = 0.083)
NEC for r=0.4 class 1.0 = 0.057 +- 0.058 (in-sample avg dev_std = 0.083)
NEC for r=0.4 all KL = 0.015 +- 0.058 (in-sample avg dev_std = 0.083)
NEC for r=0.4 all L1 = 0.029 +- 0.094 (in-sample avg dev_std = 0.083)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099994
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.51
NEC for r=0.8 class 0.0 = 0.0 +- 0.061 (in-sample avg dev_std = 0.083)
NEC for r=0.8 class 1.0 = 0.058 +- 0.061 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all KL = 0.015 +- 0.061 (in-sample avg dev_std = 0.083)
NEC for r=0.8 all L1 = 0.03 +- 0.097 (in-sample avg dev_std = 0.083)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0326934
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.737
NEC for r=0.05 class 0.0 = 0.085 +- 0.288 (in-sample avg dev_std = 0.229)
NEC for r=0.05 class 1.0 = 0.139 +- 0.288 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all KL = 0.13 +- 0.288 (in-sample avg dev_std = 0.229)
NEC for r=0.05 all L1 = 0.111 +- 0.234 (in-sample avg dev_std = 0.229)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0418
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.727
NEC for r=0.1 class 0.0 = 0.096 +- 0.306 (in-sample avg dev_std = 0.306)
NEC for r=0.1 class 1.0 = 0.174 +- 0.306 (in-sample avg dev_std = 0.306)
NEC for r=0.1 all KL = 0.169 +- 0.306 (in-sample avg dev_std = 0.306)
NEC for r=0.1 all L1 = 0.135 +- 0.240 (in-sample avg dev_std = 0.306)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05241099999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.715
NEC for r=0.2 class 0.0 = 0.1 +- 0.316 (in-sample avg dev_std = 0.354)
NEC for r=0.2 class 1.0 = 0.208 +- 0.316 (in-sample avg dev_std = 0.354)
NEC for r=0.2 all KL = 0.202 +- 0.316 (in-sample avg dev_std = 0.354)
NEC for r=0.2 all L1 = 0.154 +- 0.245 (in-sample avg dev_std = 0.354)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06525059999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.707
NEC for r=0.4 class 0.0 = 0.102 +- 0.320 (in-sample avg dev_std = 0.399)
NEC for r=0.4 class 1.0 = 0.23 +- 0.320 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all KL = 0.225 +- 0.320 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all L1 = 0.165 +- 0.243 (in-sample avg dev_std = 0.399)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079707
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.708
NEC for r=0.8 class 0.0 = 0.104 +- 0.319 (in-sample avg dev_std = 0.417)
NEC for r=0.8 class 1.0 = 0.231 +- 0.319 (in-sample avg dev_std = 0.417)
NEC for r=0.8 all KL = 0.231 +- 0.319 (in-sample avg dev_std = 0.417)
NEC for r=0.8 all L1 = 0.167 +- 0.240 (in-sample avg dev_std = 0.417)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 04:51:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:51:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.037
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.052
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.029
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037028
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.756
SUFF_SIMPLE for r=0.05 class 0.0 = 0.85 +- 0.306 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.564 +- 0.306 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.05 all KL = 0.707 +- 0.306 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.05 all L1 = 0.691 +- 0.250 (in-sample avg dev_std = 0.462)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051755999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.754
SUFF_SIMPLE for r=0.1 class 0.0 = 0.848 +- 0.298 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.565 +- 0.298 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.1 all KL = 0.707 +- 0.298 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.1 all L1 = 0.691 +- 0.247 (in-sample avg dev_std = 0.460)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06625400000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.753
SUFF_SIMPLE for r=0.2 class 0.0 = 0.848 +- 0.303 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.562 +- 0.303 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.2 all KL = 0.704 +- 0.303 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.2 all L1 = 0.69 +- 0.250 (in-sample avg dev_std = 0.461)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07111400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.747
SUFF_SIMPLE for r=0.4 class 0.0 = 0.85 +- 0.310 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.557 +- 0.310 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.4 all KL = 0.704 +- 0.310 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.4 all L1 = 0.687 +- 0.256 (in-sample avg dev_std = 0.457)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08048400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.755
SUFF_SIMPLE for r=0.8 class 0.0 = 0.853 +- 0.304 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.589 +- 0.304 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.8 all KL = 0.741 +- 0.304 (in-sample avg dev_std = 0.384)
SUFF_SIMPLE for r=0.8 all L1 = 0.707 +- 0.263 (in-sample avg dev_std = 0.384)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009109
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.501
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.100 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.855 +- 0.100 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.05 all KL = 0.957 +- 0.100 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.05 all L1 = 0.925 +- 0.152 (in-sample avg dev_std = 0.075)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093032
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.5
SUFF_SIMPLE for r=0.1 class 0.0 = 0.996 +- 0.101 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.854 +- 0.101 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.1 all KL = 0.957 +- 0.101 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.1 all L1 = 0.925 +- 0.152 (in-sample avg dev_std = 0.076)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095222
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.5
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.100 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.855 +- 0.100 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.2 all KL = 0.957 +- 0.100 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.2 all L1 = 0.925 +- 0.151 (in-sample avg dev_std = 0.077)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096158
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.5
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.101 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.855 +- 0.101 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.4 all KL = 0.957 +- 0.101 (in-sample avg dev_std = 0.077)
SUFF_SIMPLE for r=0.4 all L1 = 0.925 +- 0.152 (in-sample avg dev_std = 0.077)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096514
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.099 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.855 +- 0.099 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.8 all KL = 0.957 +- 0.099 (in-sample avg dev_std = 0.071)
SUFF_SIMPLE for r=0.8 all L1 = 0.925 +- 0.151 (in-sample avg dev_std = 0.071)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0288752
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.593
SUFF_SIMPLE for r=0.05 class 0.0 = 0.835 +- 0.322 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.653 +- 0.322 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all KL = 0.731 +- 0.322 (in-sample avg dev_std = 0.463)
SUFF_SIMPLE for r=0.05 all L1 = 0.745 +- 0.269 (in-sample avg dev_std = 0.463)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0367006
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.591
SUFF_SIMPLE for r=0.1 class 0.0 = 0.839 +- 0.320 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.655 +- 0.320 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.1 all KL = 0.735 +- 0.320 (in-sample avg dev_std = 0.458)
SUFF_SIMPLE for r=0.1 all L1 = 0.748 +- 0.268 (in-sample avg dev_std = 0.458)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.04739840000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.591
SUFF_SIMPLE for r=0.2 class 0.0 = 0.837 +- 0.322 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.652 +- 0.322 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.2 all KL = 0.731 +- 0.322 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.2 all L1 = 0.746 +- 0.270 (in-sample avg dev_std = 0.460)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0617976
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.593
SUFF_SIMPLE for r=0.4 class 0.0 = 0.837 +- 0.324 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.661 +- 0.324 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.4 all KL = 0.739 +- 0.324 (in-sample avg dev_std = 0.443)
SUFF_SIMPLE for r=0.4 all L1 = 0.75 +- 0.273 (in-sample avg dev_std = 0.443)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07703
len(reference) = 4983
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.606
SUFF_SIMPLE for r=0.8 class 0.0 = 0.848 +- 0.324 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.69 +- 0.324 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.8 all KL = 0.772 +- 0.324 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.8 all L1 = 0.77 +- 0.280 (in-sample avg dev_std = 0.383)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037028
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.874
NEC for r=0.05 class 0.0 = 0.079 +- 0.211 (in-sample avg dev_std = 0.265)
NEC for r=0.05 class 1.0 = 0.168 +- 0.211 (in-sample avg dev_std = 0.265)
NEC for r=0.05 all KL = 0.094 +- 0.211 (in-sample avg dev_std = 0.265)
NEC for r=0.05 all L1 = 0.128 +- 0.189 (in-sample avg dev_std = 0.265)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051755999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.872
NEC for r=0.1 class 0.0 = 0.083 +- 0.212 (in-sample avg dev_std = 0.310)
NEC for r=0.1 class 1.0 = 0.179 +- 0.212 (in-sample avg dev_std = 0.310)
NEC for r=0.1 all KL = 0.107 +- 0.212 (in-sample avg dev_std = 0.310)
NEC for r=0.1 all L1 = 0.136 +- 0.182 (in-sample avg dev_std = 0.310)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06625400000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.873
NEC for r=0.2 class 0.0 = 0.084 +- 0.209 (in-sample avg dev_std = 0.337)
NEC for r=0.2 class 1.0 = 0.187 +- 0.209 (in-sample avg dev_std = 0.337)
NEC for r=0.2 all KL = 0.118 +- 0.209 (in-sample avg dev_std = 0.337)
NEC for r=0.2 all L1 = 0.141 +- 0.177 (in-sample avg dev_std = 0.337)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07111400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.873
NEC for r=0.4 class 0.0 = 0.081 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.4 class 1.0 = 0.184 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.4 all KL = 0.119 +- 0.207 (in-sample avg dev_std = 0.343)
NEC for r=0.4 all L1 = 0.138 +- 0.168 (in-sample avg dev_std = 0.343)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08048400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.877
NEC for r=0.8 class 0.0 = 0.086 +- 0.204 (in-sample avg dev_std = 0.344)
NEC for r=0.8 class 1.0 = 0.185 +- 0.204 (in-sample avg dev_std = 0.344)
NEC for r=0.8 all KL = 0.121 +- 0.204 (in-sample avg dev_std = 0.344)
NEC for r=0.8 all L1 = 0.141 +- 0.166 (in-sample avg dev_std = 0.344)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009109
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.511
NEC for r=0.05 class 0.0 = 0.003 +- 0.057 (in-sample avg dev_std = 0.070)
NEC for r=0.05 class 1.0 = 0.1 +- 0.057 (in-sample avg dev_std = 0.070)
NEC for r=0.05 all KL = 0.02 +- 0.057 (in-sample avg dev_std = 0.070)
NEC for r=0.05 all L1 = 0.052 +- 0.106 (in-sample avg dev_std = 0.070)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093032
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.512
NEC for r=0.1 class 0.0 = 0.003 +- 0.052 (in-sample avg dev_std = 0.079)
NEC for r=0.1 class 1.0 = 0.099 +- 0.052 (in-sample avg dev_std = 0.079)
NEC for r=0.1 all KL = 0.02 +- 0.052 (in-sample avg dev_std = 0.079)
NEC for r=0.1 all L1 = 0.051 +- 0.103 (in-sample avg dev_std = 0.079)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095222
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.512
NEC for r=0.2 class 0.0 = 0.003 +- 0.051 (in-sample avg dev_std = 0.083)
NEC for r=0.2 class 1.0 = 0.099 +- 0.051 (in-sample avg dev_std = 0.083)
NEC for r=0.2 all KL = 0.02 +- 0.051 (in-sample avg dev_std = 0.083)
NEC for r=0.2 all L1 = 0.051 +- 0.102 (in-sample avg dev_std = 0.083)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096158
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.511
NEC for r=0.4 class 0.0 = 0.003 +- 0.053 (in-sample avg dev_std = 0.087)
NEC for r=0.4 class 1.0 = 0.1 +- 0.053 (in-sample avg dev_std = 0.087)
NEC for r=0.4 all KL = 0.021 +- 0.053 (in-sample avg dev_std = 0.087)
NEC for r=0.4 all L1 = 0.052 +- 0.104 (in-sample avg dev_std = 0.087)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096514
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.511
NEC for r=0.8 class 0.0 = 0.003 +- 0.051 (in-sample avg dev_std = 0.090)
NEC for r=0.8 class 1.0 = 0.101 +- 0.051 (in-sample avg dev_std = 0.090)
NEC for r=0.8 all KL = 0.021 +- 0.051 (in-sample avg dev_std = 0.090)
NEC for r=0.8 all L1 = 0.052 +- 0.104 (in-sample avg dev_std = 0.090)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0288752
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.636
NEC for r=0.05 class 0.0 = 0.093 +- 0.263 (in-sample avg dev_std = 0.225)
NEC for r=0.05 class 1.0 = 0.175 +- 0.263 (in-sample avg dev_std = 0.225)
NEC for r=0.05 all KL = 0.12 +- 0.263 (in-sample avg dev_std = 0.225)
NEC for r=0.05 all L1 = 0.133 +- 0.241 (in-sample avg dev_std = 0.225)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0367006
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.627
NEC for r=0.1 class 0.0 = 0.105 +- 0.277 (in-sample avg dev_std = 0.300)
NEC for r=0.1 class 1.0 = 0.202 +- 0.277 (in-sample avg dev_std = 0.300)
NEC for r=0.1 all KL = 0.148 +- 0.277 (in-sample avg dev_std = 0.300)
NEC for r=0.1 all L1 = 0.153 +- 0.245 (in-sample avg dev_std = 0.300)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.04739840000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.617
NEC for r=0.2 class 0.0 = 0.113 +- 0.289 (in-sample avg dev_std = 0.350)
NEC for r=0.2 class 1.0 = 0.234 +- 0.289 (in-sample avg dev_std = 0.350)
NEC for r=0.2 all KL = 0.175 +- 0.289 (in-sample avg dev_std = 0.350)
NEC for r=0.2 all L1 = 0.172 +- 0.250 (in-sample avg dev_std = 0.350)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0617976
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.611
NEC for r=0.4 class 0.0 = 0.114 +- 0.289 (in-sample avg dev_std = 0.384)
NEC for r=0.4 class 1.0 = 0.249 +- 0.289 (in-sample avg dev_std = 0.384)
NEC for r=0.4 all KL = 0.19 +- 0.289 (in-sample avg dev_std = 0.384)
NEC for r=0.4 all L1 = 0.18 +- 0.245 (in-sample avg dev_std = 0.384)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07703
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.611
NEC for r=0.8 class 0.0 = 0.113 +- 0.288 (in-sample avg dev_std = 0.400)
NEC for r=0.8 class 1.0 = 0.255 +- 0.288 (in-sample avg dev_std = 0.400)
NEC for r=0.8 all KL = 0.196 +- 0.288 (in-sample avg dev_std = 0.400)
NEC for r=0.8 all L1 = 0.183 +- 0.243 (in-sample avg dev_std = 0.400)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:10:07 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:10:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.049
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.054
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.073
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.031
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.040
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.048664
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.801
SUFF_SIMPLE for r=0.05 class 0.0 = 0.888 +- 0.326 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.565 +- 0.326 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.05 all KL = 0.646 +- 0.326 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.05 all L1 = 0.709 +- 0.240 (in-sample avg dev_std = 0.521)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05382
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.806
SUFF_SIMPLE for r=0.1 class 0.0 = 0.882 +- 0.322 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.579 +- 0.322 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.1 all KL = 0.659 +- 0.322 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.1 all L1 = 0.714 +- 0.240 (in-sample avg dev_std = 0.512)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06581000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.799
SUFF_SIMPLE for r=0.2 class 0.0 = 0.883 +- 0.329 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.562 +- 0.329 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 all KL = 0.647 +- 0.329 (in-sample avg dev_std = 0.504)
SUFF_SIMPLE for r=0.2 all L1 = 0.705 +- 0.245 (in-sample avg dev_std = 0.504)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07333600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.787
SUFF_SIMPLE for r=0.4 class 0.0 = 0.886 +- 0.332 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.555 +- 0.332 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.4 all KL = 0.647 +- 0.332 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.4 all L1 = 0.703 +- 0.253 (in-sample avg dev_std = 0.498)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08033200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.784
SUFF_SIMPLE for r=0.8 class 0.0 = 0.893 +- 0.345 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.563 +- 0.345 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.8 all KL = 0.669 +- 0.345 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.8 all L1 = 0.71 +- 0.269 (in-sample avg dev_std = 0.454)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099182
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.159 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.836 +- 0.159 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.05 all KL = 0.938 +- 0.159 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.05 all L1 = 0.916 +- 0.186 (in-sample avg dev_std = 0.081)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0100374
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.499
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.159 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.836 +- 0.159 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.1 all KL = 0.938 +- 0.159 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.187 (in-sample avg dev_std = 0.075)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0100692
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.499
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.159 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.159 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.2 all KL = 0.938 +- 0.159 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.2 all L1 = 0.916 +- 0.187 (in-sample avg dev_std = 0.076)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0099902
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.5
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.158 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.836 +- 0.158 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.4 all KL = 0.938 +- 0.158 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.4 all L1 = 0.916 +- 0.186 (in-sample avg dev_std = 0.079)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.159 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.835 +- 0.159 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 all KL = 0.938 +- 0.159 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 all L1 = 0.916 +- 0.187 (in-sample avg dev_std = 0.074)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.030590999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.693
SUFF_SIMPLE for r=0.05 class 0.0 = 0.844 +- 0.351 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.694 +- 0.351 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.05 all KL = 0.675 +- 0.351 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.05 all L1 = 0.77 +- 0.264 (in-sample avg dev_std = 0.476)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0400254
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.693
SUFF_SIMPLE for r=0.1 class 0.0 = 0.845 +- 0.351 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.698 +- 0.351 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.1 all KL = 0.68 +- 0.351 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.1 all L1 = 0.772 +- 0.266 (in-sample avg dev_std = 0.468)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0519514
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.694
SUFF_SIMPLE for r=0.2 class 0.0 = 0.846 +- 0.349 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.704 +- 0.349 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.2 all KL = 0.687 +- 0.349 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.2 all L1 = 0.776 +- 0.267 (in-sample avg dev_std = 0.453)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06496379999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.694
SUFF_SIMPLE for r=0.4 class 0.0 = 0.845 +- 0.354 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.702 +- 0.354 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.4 all KL = 0.689 +- 0.354 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.4 all L1 = 0.775 +- 0.272 (in-sample avg dev_std = 0.447)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079061
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.713
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.343 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.755 +- 0.343 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.8 all KL = 0.759 +- 0.343 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.8 all L1 = 0.813 +- 0.270 (in-sample avg dev_std = 0.352)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.048664
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.916
NEC for r=0.05 class 0.0 = 0.067 +- 0.225 (in-sample avg dev_std = 0.283)
NEC for r=0.05 class 1.0 = 0.161 +- 0.225 (in-sample avg dev_std = 0.283)
NEC for r=0.05 all KL = 0.115 +- 0.225 (in-sample avg dev_std = 0.283)
NEC for r=0.05 all L1 = 0.119 +- 0.189 (in-sample avg dev_std = 0.283)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05382
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.926
NEC for r=0.1 class 0.0 = 0.066 +- 0.204 (in-sample avg dev_std = 0.310)
NEC for r=0.1 class 1.0 = 0.155 +- 0.204 (in-sample avg dev_std = 0.310)
NEC for r=0.1 all KL = 0.119 +- 0.204 (in-sample avg dev_std = 0.310)
NEC for r=0.1 all L1 = 0.115 +- 0.159 (in-sample avg dev_std = 0.310)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06581000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.931
NEC for r=0.2 class 0.0 = 0.065 +- 0.194 (in-sample avg dev_std = 0.317)
NEC for r=0.2 class 1.0 = 0.154 +- 0.194 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all KL = 0.122 +- 0.194 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all L1 = 0.114 +- 0.142 (in-sample avg dev_std = 0.317)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07333600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.925
NEC for r=0.4 class 0.0 = 0.062 +- 0.189 (in-sample avg dev_std = 0.327)
NEC for r=0.4 class 1.0 = 0.164 +- 0.189 (in-sample avg dev_std = 0.327)
NEC for r=0.4 all KL = 0.133 +- 0.189 (in-sample avg dev_std = 0.327)
NEC for r=0.4 all L1 = 0.119 +- 0.138 (in-sample avg dev_std = 0.327)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08033200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.924
NEC for r=0.8 class 0.0 = 0.065 +- 0.196 (in-sample avg dev_std = 0.341)
NEC for r=0.8 class 1.0 = 0.173 +- 0.196 (in-sample avg dev_std = 0.341)
NEC for r=0.8 all KL = 0.142 +- 0.196 (in-sample avg dev_std = 0.341)
NEC for r=0.8 all L1 = 0.125 +- 0.138 (in-sample avg dev_std = 0.341)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099182
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.509
NEC for r=0.05 class 0.0 = 0.002 +- 0.121 (in-sample avg dev_std = 0.110)
NEC for r=0.05 class 1.0 = 0.136 +- 0.121 (in-sample avg dev_std = 0.110)
NEC for r=0.05 all KL = 0.044 +- 0.121 (in-sample avg dev_std = 0.110)
NEC for r=0.05 all L1 = 0.069 +- 0.157 (in-sample avg dev_std = 0.110)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0100374
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.509
NEC for r=0.1 class 0.0 = 0.002 +- 0.122 (in-sample avg dev_std = 0.121)
NEC for r=0.1 class 1.0 = 0.138 +- 0.122 (in-sample avg dev_std = 0.121)
NEC for r=0.1 all KL = 0.046 +- 0.122 (in-sample avg dev_std = 0.121)
NEC for r=0.1 all L1 = 0.07 +- 0.158 (in-sample avg dev_std = 0.121)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0100692
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.509
NEC for r=0.2 class 0.0 = 0.002 +- 0.122 (in-sample avg dev_std = 0.127)
NEC for r=0.2 class 1.0 = 0.138 +- 0.122 (in-sample avg dev_std = 0.127)
NEC for r=0.2 all KL = 0.046 +- 0.122 (in-sample avg dev_std = 0.127)
NEC for r=0.2 all L1 = 0.071 +- 0.157 (in-sample avg dev_std = 0.127)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0099902
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.509
NEC for r=0.4 class 0.0 = 0.002 +- 0.120 (in-sample avg dev_std = 0.129)
NEC for r=0.4 class 1.0 = 0.137 +- 0.120 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all KL = 0.045 +- 0.120 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all L1 = 0.07 +- 0.156 (in-sample avg dev_std = 0.129)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.509
NEC for r=0.8 class 0.0 = 0.002 +- 0.119 (in-sample avg dev_std = 0.133)
NEC for r=0.8 class 1.0 = 0.137 +- 0.119 (in-sample avg dev_std = 0.133)
NEC for r=0.8 all KL = 0.045 +- 0.119 (in-sample avg dev_std = 0.133)
NEC for r=0.8 all L1 = 0.07 +- 0.155 (in-sample avg dev_std = 0.133)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.030590999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.739
NEC for r=0.05 class 0.0 = 0.077 +- 0.275 (in-sample avg dev_std = 0.205)
NEC for r=0.05 class 1.0 = 0.137 +- 0.275 (in-sample avg dev_std = 0.205)
NEC for r=0.05 all KL = 0.122 +- 0.275 (in-sample avg dev_std = 0.205)
NEC for r=0.05 all L1 = 0.107 +- 0.226 (in-sample avg dev_std = 0.205)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0400254
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.732
NEC for r=0.1 class 0.0 = 0.09 +- 0.297 (in-sample avg dev_std = 0.274)
NEC for r=0.1 class 1.0 = 0.171 +- 0.297 (in-sample avg dev_std = 0.274)
NEC for r=0.1 all KL = 0.159 +- 0.297 (in-sample avg dev_std = 0.274)
NEC for r=0.1 all L1 = 0.13 +- 0.237 (in-sample avg dev_std = 0.274)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0519514
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.72
NEC for r=0.2 class 0.0 = 0.098 +- 0.306 (in-sample avg dev_std = 0.329)
NEC for r=0.2 class 1.0 = 0.195 +- 0.306 (in-sample avg dev_std = 0.329)
NEC for r=0.2 all KL = 0.189 +- 0.306 (in-sample avg dev_std = 0.329)
NEC for r=0.2 all L1 = 0.146 +- 0.239 (in-sample avg dev_std = 0.329)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06496379999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.717
NEC for r=0.4 class 0.0 = 0.104 +- 0.312 (in-sample avg dev_std = 0.371)
NEC for r=0.4 class 1.0 = 0.208 +- 0.312 (in-sample avg dev_std = 0.371)
NEC for r=0.4 all KL = 0.211 +- 0.312 (in-sample avg dev_std = 0.371)
NEC for r=0.4 all L1 = 0.155 +- 0.238 (in-sample avg dev_std = 0.371)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079061
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.717
NEC for r=0.8 class 0.0 = 0.108 +- 0.314 (in-sample avg dev_std = 0.399)
NEC for r=0.8 class 1.0 = 0.215 +- 0.314 (in-sample avg dev_std = 0.399)
NEC for r=0.8 all KL = 0.224 +- 0.314 (in-sample avg dev_std = 0.399)
NEC for r=0.8 all L1 = 0.161 +- 0.234 (in-sample avg dev_std = 0.399)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:28:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:28:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.051
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.062
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.070
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.082
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.030
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.050936
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.913
SUFF_SIMPLE for r=0.05 class 0.0 = 0.898 +- 0.251 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.856 +- 0.251 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 all KL = 0.846 +- 0.251 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 all L1 = 0.875 +- 0.183 (in-sample avg dev_std = 0.352)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.062052
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.91
SUFF_SIMPLE for r=0.1 class 0.0 = 0.898 +- 0.254 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.854 +- 0.254 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.1 all KL = 0.845 +- 0.254 (in-sample avg dev_std = 0.360)
SUFF_SIMPLE for r=0.1 all L1 = 0.874 +- 0.186 (in-sample avg dev_std = 0.360)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070206
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.915
SUFF_SIMPLE for r=0.2 class 0.0 = 0.899 +- 0.253 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.853 +- 0.253 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.2 all KL = 0.845 +- 0.253 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.2 all L1 = 0.873 +- 0.179 (in-sample avg dev_std = 0.359)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.077318
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.911
SUFF_SIMPLE for r=0.4 class 0.0 = 0.897 +- 0.253 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.859 +- 0.253 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 all KL = 0.853 +- 0.253 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 all L1 = 0.876 +- 0.184 (in-sample avg dev_std = 0.344)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.082224
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.928
SUFF_SIMPLE for r=0.8 class 0.0 = 0.918 +- 0.225 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.879 +- 0.225 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 all KL = 0.895 +- 0.225 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 all L1 = 0.896 +- 0.185 (in-sample avg dev_std = 0.278)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.532
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.107 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.885 +- 0.107 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.05 all KL = 0.962 +- 0.107 (in-sample avg dev_std = 0.141)
SUFF_SIMPLE for r=0.05 all L1 = 0.942 +- 0.142 (in-sample avg dev_std = 0.141)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009300999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.532
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.107 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.885 +- 0.107 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all KL = 0.962 +- 0.107 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.1 all L1 = 0.941 +- 0.143 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094492
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.531
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.885 +- 0.106 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.2 all KL = 0.962 +- 0.106 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.2 all L1 = 0.942 +- 0.143 (in-sample avg dev_std = 0.136)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095836
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.533
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.885 +- 0.106 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.4 all KL = 0.962 +- 0.106 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.4 all L1 = 0.942 +- 0.142 (in-sample avg dev_std = 0.139)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009633
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.531
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.109 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.886 +- 0.109 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.8 all KL = 0.962 +- 0.109 (in-sample avg dev_std = 0.132)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.144 (in-sample avg dev_std = 0.132)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029973400000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.727
SUFF_SIMPLE for r=0.05 class 0.0 = 0.844 +- 0.348 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.348 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.05 all KL = 0.759 +- 0.348 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.05 all L1 = 0.838 +- 0.247 (in-sample avg dev_std = 0.435)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0369356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.725
SUFF_SIMPLE for r=0.1 class 0.0 = 0.846 +- 0.345 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.345 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.1 all KL = 0.763 +- 0.345 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.1 all L1 = 0.839 +- 0.247 (in-sample avg dev_std = 0.429)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0467624
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.726
SUFF_SIMPLE for r=0.2 class 0.0 = 0.847 +- 0.339 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.84 +- 0.339 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.2 all KL = 0.776 +- 0.339 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.2 all L1 = 0.843 +- 0.253 (in-sample avg dev_std = 0.390)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060411599999999996
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.721
SUFF_SIMPLE for r=0.4 class 0.0 = 0.847 +- 0.340 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.839 +- 0.340 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.4 all KL = 0.78 +- 0.340 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.4 all L1 = 0.843 +- 0.256 (in-sample avg dev_std = 0.380)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07727360000000001
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.705
SUFF_SIMPLE for r=0.8 class 0.0 = 0.888 +- 0.339 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.816 +- 0.339 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.8 all KL = 0.809 +- 0.339 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.8 all L1 = 0.853 +- 0.260 (in-sample avg dev_std = 0.345)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.050936
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.966
NEC for r=0.05 class 0.0 = 0.046 +- 0.113 (in-sample avg dev_std = 0.126)
NEC for r=0.05 class 1.0 = 0.036 +- 0.113 (in-sample avg dev_std = 0.126)
NEC for r=0.05 all KL = 0.029 +- 0.113 (in-sample avg dev_std = 0.126)
NEC for r=0.05 all L1 = 0.041 +- 0.108 (in-sample avg dev_std = 0.126)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.062052
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.961
NEC for r=0.1 class 0.0 = 0.046 +- 0.130 (in-sample avg dev_std = 0.169)
NEC for r=0.1 class 1.0 = 0.045 +- 0.130 (in-sample avg dev_std = 0.169)
NEC for r=0.1 all KL = 0.037 +- 0.130 (in-sample avg dev_std = 0.169)
NEC for r=0.1 all L1 = 0.045 +- 0.111 (in-sample avg dev_std = 0.169)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070206
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.961
NEC for r=0.2 class 0.0 = 0.045 +- 0.141 (in-sample avg dev_std = 0.189)
NEC for r=0.2 class 1.0 = 0.05 +- 0.141 (in-sample avg dev_std = 0.189)
NEC for r=0.2 all KL = 0.044 +- 0.141 (in-sample avg dev_std = 0.189)
NEC for r=0.2 all L1 = 0.048 +- 0.110 (in-sample avg dev_std = 0.189)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.077318
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.961
NEC for r=0.4 class 0.0 = 0.053 +- 0.148 (in-sample avg dev_std = 0.195)
NEC for r=0.4 class 1.0 = 0.047 +- 0.148 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all KL = 0.048 +- 0.148 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all L1 = 0.05 +- 0.112 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.082224
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.955
NEC for r=0.8 class 0.0 = 0.053 +- 0.156 (in-sample avg dev_std = 0.221)
NEC for r=0.8 class 1.0 = 0.055 +- 0.156 (in-sample avg dev_std = 0.221)
NEC for r=0.8 all KL = 0.058 +- 0.156 (in-sample avg dev_std = 0.221)
NEC for r=0.8 all L1 = 0.054 +- 0.114 (in-sample avg dev_std = 0.221)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.546
NEC for r=0.05 class 0.0 = 0.0 +- 0.057 (in-sample avg dev_std = 0.089)
NEC for r=0.05 class 1.0 = 0.074 +- 0.057 (in-sample avg dev_std = 0.089)
NEC for r=0.05 all KL = 0.016 +- 0.057 (in-sample avg dev_std = 0.089)
NEC for r=0.05 all L1 = 0.038 +- 0.098 (in-sample avg dev_std = 0.089)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009300999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.547
NEC for r=0.1 class 0.0 = 0.001 +- 0.053 (in-sample avg dev_std = 0.097)
NEC for r=0.1 class 1.0 = 0.074 +- 0.053 (in-sample avg dev_std = 0.097)
NEC for r=0.1 all KL = 0.017 +- 0.053 (in-sample avg dev_std = 0.097)
NEC for r=0.1 all L1 = 0.037 +- 0.094 (in-sample avg dev_std = 0.097)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094492
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.547
NEC for r=0.2 class 0.0 = 0.0 +- 0.053 (in-sample avg dev_std = 0.102)
NEC for r=0.2 class 1.0 = 0.075 +- 0.053 (in-sample avg dev_std = 0.102)
NEC for r=0.2 all KL = 0.017 +- 0.053 (in-sample avg dev_std = 0.102)
NEC for r=0.2 all L1 = 0.038 +- 0.095 (in-sample avg dev_std = 0.102)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095836
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.546
NEC for r=0.4 class 0.0 = 0.0 +- 0.055 (in-sample avg dev_std = 0.108)
NEC for r=0.4 class 1.0 = 0.077 +- 0.055 (in-sample avg dev_std = 0.108)
NEC for r=0.4 all KL = 0.018 +- 0.055 (in-sample avg dev_std = 0.108)
NEC for r=0.4 all L1 = 0.039 +- 0.096 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009633
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.547
NEC for r=0.8 class 0.0 = 0.0 +- 0.055 (in-sample avg dev_std = 0.111)
NEC for r=0.8 class 1.0 = 0.076 +- 0.055 (in-sample avg dev_std = 0.111)
NEC for r=0.8 all KL = 0.018 +- 0.055 (in-sample avg dev_std = 0.111)
NEC for r=0.8 all L1 = 0.039 +- 0.095 (in-sample avg dev_std = 0.111)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029973400000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.752
NEC for r=0.05 class 0.0 = 0.072 +- 0.228 (in-sample avg dev_std = 0.131)
NEC for r=0.05 class 1.0 = 0.064 +- 0.228 (in-sample avg dev_std = 0.131)
NEC for r=0.05 all KL = 0.072 +- 0.228 (in-sample avg dev_std = 0.131)
NEC for r=0.05 all L1 = 0.068 +- 0.198 (in-sample avg dev_std = 0.131)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0369356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.744
NEC for r=0.1 class 0.0 = 0.086 +- 0.260 (in-sample avg dev_std = 0.168)
NEC for r=0.1 class 1.0 = 0.086 +- 0.260 (in-sample avg dev_std = 0.168)
NEC for r=0.1 all KL = 0.097 +- 0.260 (in-sample avg dev_std = 0.168)
NEC for r=0.1 all L1 = 0.086 +- 0.219 (in-sample avg dev_std = 0.168)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0467624
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.743
NEC for r=0.2 class 0.0 = 0.103 +- 0.282 (in-sample avg dev_std = 0.230)
NEC for r=0.2 class 1.0 = 0.097 +- 0.282 (in-sample avg dev_std = 0.230)
NEC for r=0.2 all KL = 0.123 +- 0.282 (in-sample avg dev_std = 0.230)
NEC for r=0.2 all L1 = 0.1 +- 0.228 (in-sample avg dev_std = 0.230)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060411599999999996
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.74
NEC for r=0.4 class 0.0 = 0.111 +- 0.299 (in-sample avg dev_std = 0.302)
NEC for r=0.4 class 1.0 = 0.107 +- 0.299 (in-sample avg dev_std = 0.302)
NEC for r=0.4 all KL = 0.147 +- 0.299 (in-sample avg dev_std = 0.302)
NEC for r=0.4 all L1 = 0.109 +- 0.226 (in-sample avg dev_std = 0.302)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07727360000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.739
NEC for r=0.8 class 0.0 = 0.111 +- 0.307 (in-sample avg dev_std = 0.344)
NEC for r=0.8 class 1.0 = 0.11 +- 0.307 (in-sample avg dev_std = 0.344)
NEC for r=0.8 all KL = 0.163 +- 0.307 (in-sample avg dev_std = 0.344)
NEC for r=0.8 all L1 = 0.111 +- 0.215 (in-sample avg dev_std = 0.344)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.851, 0.852, 0.853, 0.854, 0.878], 'all_L1': [0.847, 0.85, 0.849, 0.847, 0.862]}), defaultdict(<class 'list'>, {'all_KL': [0.631, 0.641, 0.65, 0.65, 0.691], 'all_L1': [0.752, 0.758, 0.758, 0.759, 0.769]}), defaultdict(<class 'list'>, {'all_KL': [0.729, 0.728, 0.726, 0.741, 0.775], 'all_L1': [0.799, 0.797, 0.791, 0.8, 0.81]}), defaultdict(<class 'list'>, {'all_KL': [0.66, 0.655, 0.664, 0.658, 0.698], 'all_L1': [0.744, 0.742, 0.75, 0.743, 0.755]}), defaultdict(<class 'list'>, {'all_KL': [0.654, 0.654, 0.653, 0.662, 0.709], 'all_L1': [0.732, 0.733, 0.737, 0.74, 0.756]}), defaultdict(<class 'list'>, {'all_KL': [0.654, 0.657, 0.656, 0.667, 0.675], 'all_L1': [0.691, 0.691, 0.69, 0.697, 0.693]}), defaultdict(<class 'list'>, {'all_KL': [0.7, 0.693, 0.692, 0.703, 0.745], 'all_L1': [0.763, 0.758, 0.759, 0.761, 0.779]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.707, 0.704, 0.704, 0.741], 'all_L1': [0.691, 0.691, 0.69, 0.687, 0.707]}), defaultdict(<class 'list'>, {'all_KL': [0.646, 0.659, 0.647, 0.647, 0.669], 'all_L1': [0.709, 0.714, 0.705, 0.703, 0.71]}), defaultdict(<class 'list'>, {'all_KL': [0.846, 0.845, 0.845, 0.853, 0.895], 'all_L1': [0.875, 0.874, 0.873, 0.876, 0.896]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.027, 0.033, 0.034, 0.041, 0.041], 'all_L1': [0.049, 0.054, 0.056, 0.057, 0.058]}), defaultdict(<class 'list'>, {'all_KL': [0.115, 0.123, 0.137, 0.144, 0.156], 'all_L1': [0.093, 0.092, 0.096, 0.098, 0.101]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.088, 0.093, 0.086, 0.101], 'all_L1': [0.071, 0.08, 0.08, 0.072, 0.08]}), defaultdict(<class 'list'>, {'all_KL': [0.108, 0.121, 0.141, 0.141, 0.138], 'all_L1': [0.094, 0.099, 0.106, 0.103, 0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.123, 0.134, 0.155, 0.172, 0.155], 'all_L1': [0.105, 0.107, 0.118, 0.125, 0.111]}), defaultdict(<class 'list'>, {'all_KL': [0.101, 0.121, 0.129, 0.15, 0.135], 'all_L1': [0.115, 0.127, 0.132, 0.146, 0.132]}), defaultdict(<class 'list'>, {'all_KL': [0.093, 0.115, 0.132, 0.114, 0.14], 'all_L1': [0.09, 0.098, 0.106, 0.093, 0.109]}), defaultdict(<class 'list'>, {'all_KL': [0.094, 0.107, 0.118, 0.119, 0.121], 'all_L1': [0.128, 0.136, 0.141, 0.138, 0.141]}), defaultdict(<class 'list'>, {'all_KL': [0.115, 0.119, 0.122, 0.133, 0.142], 'all_L1': [0.119, 0.115, 0.114, 0.119, 0.125]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.037, 0.044, 0.048, 0.058], 'all_L1': [0.041, 0.045, 0.048, 0.05, 0.054]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.965, 0.966, 0.966, 0.966, 0.966], 'all_L1': [0.94, 0.94, 0.94, 0.941, 0.94]}), defaultdict(<class 'list'>, {'all_KL': [0.919, 0.917, 0.917, 0.918, 0.919], 'all_L1': [0.913, 0.912, 0.911, 0.911, 0.912]}), defaultdict(<class 'list'>, {'all_KL': [0.944, 0.942, 0.943, 0.943, 0.943], 'all_L1': [0.936, 0.935, 0.935, 0.935, 0.935]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.968, 0.968, 0.968, 0.969], 'all_L1': [0.955, 0.955, 0.955, 0.955, 0.956]}), defaultdict(<class 'list'>, {'all_KL': [0.946, 0.946, 0.946, 0.947, 0.947], 'all_L1': [0.925, 0.924, 0.925, 0.925, 0.925]}), defaultdict(<class 'list'>, {'all_KL': [0.973, 0.973, 0.973, 0.973, 0.973], 'all_L1': [0.957, 0.957, 0.957, 0.957, 0.957]}), defaultdict(<class 'list'>, {'all_KL': [0.972, 0.972, 0.972, 0.972, 0.972], 'all_L1': [0.96, 0.959, 0.96, 0.959, 0.96]}), defaultdict(<class 'list'>, {'all_KL': [0.957, 0.957, 0.957, 0.957, 0.957], 'all_L1': [0.925, 0.925, 0.925, 0.925, 0.925]}), defaultdict(<class 'list'>, {'all_KL': [0.938, 0.938, 0.938, 0.938, 0.938], 'all_L1': [0.916, 0.916, 0.916, 0.916, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.962, 0.962, 0.962, 0.962, 0.962], 'all_L1': [0.942, 0.941, 0.942, 0.942, 0.942]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.013, 0.014, 0.014, 0.015, 0.014], 'all_L1': [0.035, 0.037, 0.037, 0.037, 0.037]}), defaultdict(<class 'list'>, {'all_KL': [0.053, 0.055, 0.056, 0.058, 0.057], 'all_L1': [0.068, 0.069, 0.069, 0.07, 0.069]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.033, 0.036, 0.036, 0.035], 'all_L1': [0.045, 0.046, 0.047, 0.047, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.016, 0.016, 0.016, 0.017], 'all_L1': [0.029, 0.03, 0.03, 0.029, 0.03]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.028, 0.027, 0.028, 0.029], 'all_L1': [0.049, 0.051, 0.051, 0.051, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.017, 0.017, 0.016, 0.016], 'all_L1': [0.033, 0.033, 0.033, 0.033, 0.033]}), defaultdict(<class 'list'>, {'all_KL': [0.014, 0.014, 0.015, 0.015, 0.015], 'all_L1': [0.029, 0.029, 0.029, 0.029, 0.03]}), defaultdict(<class 'list'>, {'all_KL': [0.02, 0.02, 0.02, 0.021, 0.021], 'all_L1': [0.052, 0.051, 0.051, 0.052, 0.052]}), defaultdict(<class 'list'>, {'all_KL': [0.044, 0.046, 0.046, 0.045, 0.045], 'all_L1': [0.069, 0.07, 0.071, 0.07, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.016, 0.017, 0.017, 0.018, 0.018], 'all_L1': [0.038, 0.037, 0.038, 0.039, 0.039]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.806, 0.809, 0.814, 0.835, 0.88], 'all_L1': [0.841, 0.841, 0.843, 0.853, 0.877]}), defaultdict(<class 'list'>, {'all_KL': [0.625, 0.627, 0.64, 0.654, 0.701], 'all_L1': [0.778, 0.779, 0.782, 0.787, 0.802]}), defaultdict(<class 'list'>, {'all_KL': [0.714, 0.72, 0.721, 0.729, 0.736], 'all_L1': [0.794, 0.796, 0.795, 0.801, 0.798]}), defaultdict(<class 'list'>, {'all_KL': [0.619, 0.619, 0.629, 0.629, 0.628], 'all_L1': [0.735, 0.734, 0.737, 0.734, 0.709]}), defaultdict(<class 'list'>, {'all_KL': [0.614, 0.616, 0.632, 0.643, 0.648], 'all_L1': [0.728, 0.729, 0.731, 0.735, 0.718]}), defaultdict(<class 'list'>, {'all_KL': [0.692, 0.693, 0.702, 0.714, 0.747], 'all_L1': [0.765, 0.766, 0.766, 0.769, 0.786]}), defaultdict(<class 'list'>, {'all_KL': [0.674, 0.674, 0.678, 0.679, 0.718], 'all_L1': [0.763, 0.764, 0.764, 0.765, 0.784]}), defaultdict(<class 'list'>, {'all_KL': [0.731, 0.735, 0.731, 0.739, 0.772], 'all_L1': [0.745, 0.748, 0.746, 0.75, 0.77]}), defaultdict(<class 'list'>, {'all_KL': [0.675, 0.68, 0.687, 0.689, 0.759], 'all_L1': [0.77, 0.772, 0.776, 0.775, 0.813]}), defaultdict(<class 'list'>, {'all_KL': [0.759, 0.763, 0.776, 0.78, 0.809], 'all_L1': [0.838, 0.839, 0.843, 0.843, 0.853]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.063, 0.081, 0.1, 0.117, 0.136], 'all_L1': [0.072, 0.086, 0.097, 0.105, 0.11]}), defaultdict(<class 'list'>, {'all_KL': [0.122, 0.167, 0.205, 0.231, 0.255], 'all_L1': [0.093, 0.114, 0.132, 0.141, 0.15]}), defaultdict(<class 'list'>, {'all_KL': [0.098, 0.135, 0.159, 0.181, 0.195], 'all_L1': [0.089, 0.112, 0.126, 0.138, 0.143]}), defaultdict(<class 'list'>, {'all_KL': [0.134, 0.182, 0.212, 0.236, 0.254], 'all_L1': [0.11, 0.139, 0.156, 0.166, 0.173]}), defaultdict(<class 'list'>, {'all_KL': [0.143, 0.189, 0.221, 0.246, 0.263], 'all_L1': [0.122, 0.148, 0.163, 0.172, 0.177]}), defaultdict(<class 'list'>, {'all_KL': [0.117, 0.152, 0.179, 0.195, 0.211], 'all_L1': [0.11, 0.134, 0.15, 0.156, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.13, 0.169, 0.202, 0.225, 0.231], 'all_L1': [0.111, 0.135, 0.154, 0.165, 0.167]}), defaultdict(<class 'list'>, {'all_KL': [0.12, 0.148, 0.175, 0.19, 0.196], 'all_L1': [0.133, 0.153, 0.172, 0.18, 0.183]}), defaultdict(<class 'list'>, {'all_KL': [0.122, 0.159, 0.189, 0.211, 0.224], 'all_L1': [0.107, 0.13, 0.146, 0.155, 0.161]}), defaultdict(<class 'list'>, {'all_KL': [0.072, 0.097, 0.123, 0.147, 0.163], 'all_L1': [0.068, 0.086, 0.1, 0.109, 0.111]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.760 +- 0.060, 0.761 +- 0.059, 0.760 +- 0.059, 0.761 +- 0.060, 0.774 +- 0.063
suff_simple class all_KL  =  0.708 +- 0.076, 0.709 +- 0.074, 0.709 +- 0.074, 0.714 +- 0.075, 0.748 +- 0.076
[[0.8995000123977661, 0.9017500281333923, 0.9012500047683716, 0.8997499942779541, 0.909250020980835], [0.8360000252723694, 0.8414999842643738, 0.8389999866485596, 0.8392500281333923, 0.8309999704360962], [0.859499990940094, 0.8547499775886536, 0.8507500290870667, 0.856249988079071, 0.8607500195503235], [0.812250018119812, 0.8117499947547913, 0.8174999952316284, 0.8075000047683716, 0.8065000176429749], [0.8077499866485596, 0.8112499713897705, 0.8202499747276306, 0.8199999928474426, 0.8205000162124634], [0.7670000195503235, 0.7724999785423279, 0.7637500166893005, 0.7722499966621399, 0.7517499923706055], [0.8165000081062317, 0.8180000185966492, 0.8172500133514404, 0.8177499771118164, 0.8224999904632568], [0.7557500004768372, 0.7537500262260437, 0.753250002861023, 0.746999979019165, 0.7547500133514404], [0.8009999990463257, 0.8057500123977661, 0.7987499833106995, 0.7867500185966492, 0.784250020980835], [0.9132500290870667, 0.909500002861023, 0.9150000214576721, 0.9107499718666077, 0.9277499914169312]]
[[0.851, 0.852, 0.853, 0.854, 0.878], [0.631, 0.641, 0.65, 0.65, 0.691], [0.729, 0.728, 0.726, 0.741, 0.775], [0.66, 0.655, 0.664, 0.658, 0.698], [0.654, 0.654, 0.653, 0.662, 0.709], [0.654, 0.657, 0.656, 0.667, 0.675], [0.7, 0.693, 0.692, 0.703, 0.745], [0.707, 0.707, 0.704, 0.704, 0.741], [0.646, 0.659, 0.647, 0.647, 0.669], [0.846, 0.845, 0.845, 0.853, 0.895]]
suff_simple_acc_int  =  0.827 +- 0.049, 0.828 +- 0.048, 0.828 +- 0.049, 0.826 +- 0.050, 0.827 +- 0.056
nec class all_L1  =  0.090 +- 0.028, 0.095 +- 0.028, 0.100 +- 0.029, 0.100 +- 0.031, 0.101 +- 0.028
nec class all_KL  =  0.088 +- 0.033, 0.100 +- 0.034, 0.111 +- 0.039, 0.115 +- 0.041, 0.119 +- 0.038
[[0.9542499780654907, 0.9577500224113464, 0.956250011920929, 0.9574999809265137, 0.956250011920929], [0.9304999709129333, 0.9350000023841858, 0.9367499947547913, 0.937250018119812, 0.9369999766349792], [0.9462500214576721, 0.940750002861023, 0.9409999847412109, 0.9482499957084656, 0.9452499747276306], [0.9172499775886536, 0.9167500138282776, 0.9162499904632568, 0.9197499752044678, 0.9179999828338623], [0.921750009059906, 0.921500027179718, 0.9162499904632568, 0.9102500081062317, 0.9242500066757202], [0.906499981880188, 0.8987500071525574, 0.9012500047683716, 0.8922500014305115, 0.9007499814033508], [0.9150000214576721, 0.9167500138282776, 0.9147499799728394, 0.9225000143051147, 0.9125000238418579], [0.8742499947547913, 0.8715000152587891, 0.8732500076293945, 0.8730000257492065, 0.8767499923706055], [0.9160000085830688, 0.9259999990463257, 0.9312499761581421, 0.9247499704360962, 0.9240000247955322], [0.9662500023841858, 0.9612500071525574, 0.9614999890327454, 0.9607499837875366, 0.9545000195503235]]
[[0.027, 0.033, 0.034, 0.041, 0.041], [0.115, 0.123, 0.137, 0.144, 0.156], [0.072, 0.088, 0.093, 0.086, 0.101], [0.108, 0.121, 0.141, 0.141, 0.138], [0.123, 0.134, 0.155, 0.172, 0.155], [0.101, 0.121, 0.129, 0.15, 0.135], [0.093, 0.115, 0.132, 0.114, 0.14], [0.094, 0.107, 0.118, 0.119, 0.121], [0.115, 0.119, 0.122, 0.133, 0.142], [0.029, 0.037, 0.044, 0.048, 0.058]]
nec_acc_int  =  0.925 +- 0.025, 0.925 +- 0.025, 0.925 +- 0.025, 0.925 +- 0.027, 0.925 +- 0.024

Eval split val
suff_simple class all_L1  =  0.937 +- 0.016, 0.936 +- 0.016, 0.937 +- 0.016, 0.937 +- 0.016, 0.937 +- 0.016
suff_simple class all_KL  =  0.954 +- 0.016, 0.954 +- 0.017, 0.954 +- 0.017, 0.954 +- 0.017, 0.955 +- 0.017
[[0.5141749978065491, 0.5145000219345093, 0.5138000249862671, 0.5147749781608582, 0.5141249895095825], [0.5200999975204468, 0.519349992275238, 0.5196750164031982, 0.5188000202178955, 0.517799973487854], [0.5248000025749207, 0.5232750177383423, 0.5236999988555908, 0.5237500071525574, 0.5241249799728394], [0.5090749859809875, 0.5100749731063843, 0.5097749829292297, 0.5094000101089478, 0.5101249814033508], [0.5132499933242798, 0.5132750272750854, 0.5139250159263611, 0.5137749910354614, 0.5137249827384949], [0.49707499146461487, 0.49720001220703125, 0.49720001220703125, 0.49720001220703125, 0.4972749948501587], [0.5013750195503235, 0.5013250112533569, 0.5011500120162964, 0.5012249946594238, 0.5013250112533569], [0.5005000233650208, 0.5003499984741211, 0.5004000067710876, 0.4996750056743622, 0.5005999803543091], [0.49935001134872437, 0.499224990606308, 0.499099999666214, 0.4995500147342682, 0.4991999864578247], [0.5318250060081482, 0.5320249795913696, 0.5310750007629395, 0.5325250029563904, 0.5314750075340271]]
[[0.965, 0.966, 0.966, 0.966, 0.966], [0.919, 0.917, 0.917, 0.918, 0.919], [0.944, 0.942, 0.943, 0.943, 0.943], [0.968, 0.968, 0.968, 0.968, 0.969], [0.946, 0.946, 0.946, 0.947, 0.947], [0.973, 0.973, 0.973, 0.973, 0.973], [0.972, 0.972, 0.972, 0.972, 0.972], [0.957, 0.957, 0.957, 0.957, 0.957], [0.938, 0.938, 0.938, 0.938, 0.938], [0.962, 0.962, 0.962, 0.962, 0.962]]
suff_simple_acc_int  =  0.511 +- 0.011, 0.511 +- 0.011, 0.511 +- 0.011, 0.511 +- 0.011, 0.511 +- 0.011
nec class all_L1  =  0.045 +- 0.014, 0.045 +- 0.014, 0.046 +- 0.014, 0.046 +- 0.014, 0.046 +- 0.014
nec class all_KL  =  0.025 +- 0.013, 0.026 +- 0.014, 0.026 +- 0.014, 0.027 +- 0.014, 0.027 +- 0.014
[[0.5306249856948853, 0.5299999713897705, 0.5303000211715698, 0.5289750099182129, 0.5296249985694885], [0.5373499989509583, 0.5383750200271606, 0.5382750034332275, 0.5379999876022339, 0.5390750169754028], [0.5390750169754028, 0.5396999716758728, 0.5391749739646912, 0.5389500260353088, 0.5398499965667725], [0.5210000276565552, 0.5219249725341797, 0.5210750102996826, 0.5220999717712402, 0.5221250057220459], [0.5313249826431274, 0.5307000279426575, 0.5303249955177307, 0.5313500165939331, 0.5306749939918518], [0.5010250210762024, 0.5006250143051147, 0.5009250044822693, 0.5005499720573425, 0.5011749863624573], [0.5092499852180481, 0.5103999972343445, 0.5095999836921692, 0.5096250176429749, 0.5095250010490417], [0.5110999941825867, 0.5118749737739563, 0.511775016784668, 0.5114750266075134, 0.5107750296592712], [0.5092499852180481, 0.5092499852180481, 0.5088750123977661, 0.5094500184059143, 0.5094249844551086], [0.5457500219345093, 0.5472999811172485, 0.5465250015258789, 0.5462999939918518, 0.5472999811172485]]
[[0.013, 0.014, 0.014, 0.015, 0.014], [0.053, 0.055, 0.056, 0.058, 0.057], [0.032, 0.033, 0.036, 0.036, 0.035], [0.016, 0.016, 0.016, 0.016, 0.017], [0.025, 0.028, 0.027, 0.028, 0.029], [0.016, 0.017, 0.017, 0.016, 0.016], [0.014, 0.014, 0.015, 0.015, 0.015], [0.02, 0.02, 0.02, 0.021, 0.021], [0.044, 0.046, 0.046, 0.045, 0.045], [0.016, 0.017, 0.017, 0.018, 0.018]]
nec_acc_int  =  0.524 +- 0.015, 0.524 +- 0.015, 0.524 +- 0.015, 0.524 +- 0.015, 0.524 +- 0.015

Eval split test
suff_simple class all_L1  =  0.776 +- 0.037, 0.777 +- 0.037, 0.778 +- 0.037, 0.781 +- 0.039, 0.791 +- 0.049
suff_simple class all_KL  =  0.691 +- 0.060, 0.694 +- 0.061, 0.701 +- 0.058, 0.709 +- 0.061, 0.740 +- 0.070
[[0.7307884693145752, 0.7294126749038696, 0.7306883931159973, 0.7273864150047302, 0.7402300834655762], [0.6953672170639038, 0.6976936459541321, 0.6956173777580261, 0.6921653151512146, 0.6958015561103821], [0.710476279258728, 0.7138283252716064, 0.7119521498680115, 0.7118771076202393, 0.7059103846549988], [0.6658745408058167, 0.664248526096344, 0.6608715057373047, 0.6516410112380981, 0.6019763350486755], [0.6698018908500671, 0.6698769330978394, 0.6644737124443054, 0.6584200263023376, 0.6297420859336853], [0.6729287505149841, 0.6732789874076843, 0.6733039617538452, 0.6677756905555725, 0.676334798336029], [0.676155686378479, 0.6783319711685181, 0.6756553649902344, 0.677756667137146, 0.6812800765037537], [0.5932809710502625, 0.5907544493675232, 0.5907294154167175, 0.5931808948516846, 0.6063365340232849], [0.6930658221244812, 0.6927656531333923, 0.694316565990448, 0.6935661435127258, 0.712863564491272], [0.7266109585762024, 0.7249099612236023, 0.726460874080658, 0.7210326194763184, 0.7054780721664429]]
[[0.806, 0.809, 0.814, 0.835, 0.88], [0.625, 0.627, 0.64, 0.654, 0.701], [0.714, 0.72, 0.721, 0.729, 0.736], [0.619, 0.619, 0.629, 0.629, 0.628], [0.614, 0.616, 0.632, 0.643, 0.648], [0.692, 0.693, 0.702, 0.714, 0.747], [0.674, 0.674, 0.678, 0.679, 0.718], [0.731, 0.735, 0.731, 0.739, 0.772], [0.675, 0.68, 0.687, 0.689, 0.759], [0.759, 0.763, 0.776, 0.78, 0.809]]
suff_simple_acc_int  =  0.683 +- 0.037, 0.684 +- 0.038, 0.682 +- 0.038, 0.679 +- 0.038, 0.676 +- 0.045
nec class all_L1  =  0.101 +- 0.020, 0.124 +- 0.022, 0.140 +- 0.024, 0.149 +- 0.024, 0.154 +- 0.024
nec class all_KL  =  0.112 +- 0.025, 0.148 +- 0.033, 0.176 +- 0.037, 0.198 +- 0.039, 0.213 +- 0.039
[[0.7484740614891052, 0.7441965341567993, 0.7378177046775818, 0.7371923327445984, 0.739018440246582], [0.7402941584587097, 0.7308384776115417, 0.7228086590766907, 0.7179307341575623, 0.7149539589881897], [0.7619321346282959, 0.7491244673728943, 0.7381429076194763, 0.7311387062072754, 0.7324394583702087], [0.7220332026481628, 0.7115519046783447, 0.6991444826126099, 0.6945667266845703, 0.6983439922332764], [0.7160046100616455, 0.7032719850540161, 0.70017009973526, 0.6987943053245544, 0.6963177919387817], [0.7210075855255127, 0.7110766172409058, 0.6973684430122375, 0.693641185760498, 0.6964428424835205], [0.737417459487915, 0.7269111275672913, 0.715204119682312, 0.7070742249488831, 0.7076245546340942], [0.6356313824653625, 0.6272013187408447, 0.6174705028533936, 0.6114168763160706, 0.6111667156219482], [0.7393936514854431, 0.7321643233299255, 0.7199569940567017, 0.7173554301261902, 0.7170552611351013], [0.7523263692855835, 0.7437712550163269, 0.743471086025238, 0.7397938966751099, 0.7385431528091431]]
[[0.063, 0.081, 0.1, 0.117, 0.136], [0.122, 0.167, 0.205, 0.231, 0.255], [0.098, 0.135, 0.159, 0.181, 0.195], [0.134, 0.182, 0.212, 0.236, 0.254], [0.143, 0.189, 0.221, 0.246, 0.263], [0.117, 0.152, 0.179, 0.195, 0.211], [0.13, 0.169, 0.202, 0.225, 0.231], [0.12, 0.148, 0.175, 0.19, 0.196], [0.122, 0.159, 0.189, 0.211, 0.224], [0.072, 0.097, 0.123, 0.147, 0.163]]
nec_acc_int  =  0.727 +- 0.034, 0.718 +- 0.034, 0.709 +- 0.035, 0.705 +- 0.035, 0.705 +- 0.035


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.425 +- 0.016, 0.428 +- 0.016, 0.430 +- 0.016, 0.431 +- 0.016, 0.438 +- 0.018
Faith. Armon (L1)= 		  =  0.160 +- 0.044, 0.167 +- 0.043, 0.174 +- 0.045, 0.174 +- 0.048, 0.177 +- 0.043
Faith. GMean (L1)= 	  =  0.257 +- 0.034, 0.264 +- 0.033, 0.270 +- 0.033, 0.270 +- 0.035, 0.275 +- 0.031
Faith. Aritm (KL)= 		  =  0.398 +- 0.022, 0.404 +- 0.020, 0.410 +- 0.019, 0.414 +- 0.019, 0.433 +- 0.021
Faith. Armon (KL)= 		  =  0.153 +- 0.053, 0.171 +- 0.055, 0.187 +- 0.060, 0.193 +- 0.062, 0.201 +- 0.058
Faith. GMean (KL)= 	  =  0.240 +- 0.045, 0.258 +- 0.044, 0.271 +- 0.047, 0.277 +- 0.046, 0.290 +- 0.044

Eval split val
Faith. Aritm (L1)= 		  =  0.491 +- 0.003, 0.491 +- 0.003, 0.491 +- 0.003, 0.491 +- 0.002, 0.491 +- 0.002
Faith. Armon (L1)= 		  =  0.085 +- 0.025, 0.086 +- 0.026, 0.087 +- 0.026, 0.087 +- 0.026, 0.087 +- 0.025
Faith. GMean (L1)= 	  =  0.202 +- 0.030, 0.203 +- 0.030, 0.204 +- 0.030, 0.204 +- 0.030, 0.205 +- 0.029
Faith. Aritm (KL)= 		  =  0.490 +- 0.003, 0.490 +- 0.003, 0.490 +- 0.003, 0.491 +- 0.002, 0.491 +- 0.002
Faith. Armon (KL)= 		  =  0.048 +- 0.025, 0.050 +- 0.026, 0.051 +- 0.026, 0.052 +- 0.026, 0.052 +- 0.026
Faith. GMean (KL)= 	  =  0.149 +- 0.036, 0.152 +- 0.037, 0.153 +- 0.038, 0.155 +- 0.038, 0.155 +- 0.037

Eval split test
Faith. Aritm (L1)= 		  =  0.439 +- 0.010, 0.450 +- 0.008, 0.459 +- 0.008, 0.465 +- 0.008, 0.472 +- 0.015
Faith. Armon (L1)= 		  =  0.178 +- 0.030, 0.212 +- 0.033, 0.235 +- 0.034, 0.248 +- 0.033, 0.256 +- 0.033
Faith. GMean (L1)= 	  =  0.278 +- 0.022, 0.308 +- 0.023, 0.328 +- 0.023, 0.339 +- 0.021, 0.346 +- 0.021
Faith. Aritm (KL)= 		  =  0.401 +- 0.020, 0.421 +- 0.016, 0.439 +- 0.012, 0.453 +- 0.012, 0.476 +- 0.018
Faith. Armon (KL)= 		  =  0.191 +- 0.037, 0.240 +- 0.044, 0.278 +- 0.046, 0.305 +- 0.045, 0.326 +- 0.043
Faith. GMean (KL)= 	  =  0.275 +- 0.025, 0.316 +- 0.027, 0.348 +- 0.027, 0.371 +- 0.025, 0.393 +- 0.023
Computed for split load_split = id



Completed in  3:05:49.981270  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.01

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 05:47:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:47:07 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mChartInfo 0.9860 0.9860 0.9860 0.9860 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.038
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.052
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.064
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.075
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.083
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037961999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.71
SUFF_SIMPLE for r=0.05 class 0.0 = 0.582 +- 0.421 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.739 +- 0.421 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.05 all KL = 0.551 +- 0.421 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.05 all L1 = 0.669 +- 0.322 (in-sample avg dev_std = 0.470)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051508
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.709
SUFF_SIMPLE for r=0.1 class 0.0 = 0.584 +- 0.425 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.741 +- 0.425 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.1 all KL = 0.557 +- 0.425 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.1 all L1 = 0.671 +- 0.324 (in-sample avg dev_std = 0.457)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.063782
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.714
SUFF_SIMPLE for r=0.2 class 0.0 = 0.589 +- 0.424 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.751 +- 0.424 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.2 all KL = 0.572 +- 0.424 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.2 all L1 = 0.678 +- 0.327 (in-sample avg dev_std = 0.432)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075396
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.724
SUFF_SIMPLE for r=0.4 class 0.0 = 0.573 +- 0.427 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.776 +- 0.427 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.4 all KL = 0.586 +- 0.427 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.4 all L1 = 0.685 +- 0.329 (in-sample avg dev_std = 0.416)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08294800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.794
SUFF_SIMPLE for r=0.8 class 0.0 = 0.707 +- 0.407 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.857 +- 0.407 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.8 all KL = 0.74 +- 0.407 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.8 all L1 = 0.79 +- 0.324 (in-sample avg dev_std = 0.237)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085554
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.582
SUFF_SIMPLE for r=0.05 class 0.0 = 0.38 +- 0.391 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.513 +- 0.391 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.05 all KL = 0.244 +- 0.391 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.05 all L1 = 0.447 +- 0.338 (in-sample avg dev_std = 0.529)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009137600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.583
SUFF_SIMPLE for r=0.1 class 0.0 = 0.377 +- 0.391 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.518 +- 0.391 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.1 all KL = 0.244 +- 0.391 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.1 all L1 = 0.448 +- 0.338 (in-sample avg dev_std = 0.529)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009422999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.584
SUFF_SIMPLE for r=0.2 class 0.0 = 0.38 +- 0.393 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.515 +- 0.393 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.2 all KL = 0.246 +- 0.393 (in-sample avg dev_std = 0.531)
SUFF_SIMPLE for r=0.2 all L1 = 0.448 +- 0.338 (in-sample avg dev_std = 0.531)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009673600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.586
SUFF_SIMPLE for r=0.4 class 0.0 = 0.382 +- 0.401 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.527 +- 0.401 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.4 all KL = 0.259 +- 0.401 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.4 all L1 = 0.455 +- 0.345 (in-sample avg dev_std = 0.507)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097454
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.601
SUFF_SIMPLE for r=0.8 class 0.0 = 0.382 +- 0.466 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.628 +- 0.466 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.8 all KL = 0.397 +- 0.466 (in-sample avg dev_std = 0.195)
SUFF_SIMPLE for r=0.8 all L1 = 0.506 +- 0.399 (in-sample avg dev_std = 0.195)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.026340999999999996
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.594
SUFF_SIMPLE for r=0.05 class 0.0 = 0.808 +- 0.362 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.681 +- 0.362 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.05 all KL = 0.719 +- 0.362 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.05 all L1 = 0.745 +- 0.298 (in-sample avg dev_std = 0.255)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0372252
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.594
SUFF_SIMPLE for r=0.1 class 0.0 = 0.808 +- 0.361 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.689 +- 0.361 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.1 all KL = 0.723 +- 0.361 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.1 all L1 = 0.749 +- 0.296 (in-sample avg dev_std = 0.242)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.604
SUFF_SIMPLE for r=0.2 class 0.0 = 0.804 +- 0.355 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.706 +- 0.355 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.2 all KL = 0.733 +- 0.355 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.2 all L1 = 0.755 +- 0.296 (in-sample avg dev_std = 0.222)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06344580000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.612
SUFF_SIMPLE for r=0.4 class 0.0 = 0.818 +- 0.339 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.74 +- 0.339 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all KL = 0.772 +- 0.339 (in-sample avg dev_std = 0.173)
SUFF_SIMPLE for r=0.4 all L1 = 0.78 +- 0.294 (in-sample avg dev_std = 0.173)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790086
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.666
SUFF_SIMPLE for r=0.8 class 0.0 = 0.93 +- 0.234 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.842 +- 0.234 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.8 all KL = 0.905 +- 0.234 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.8 all L1 = 0.886 +- 0.228 (in-sample avg dev_std = 0.009)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037961999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.954
NEC for r=0.05 class 0.0 = 0.084 +- 0.204 (in-sample avg dev_std = 0.076)
NEC for r=0.05 class 1.0 = 0.04 +- 0.204 (in-sample avg dev_std = 0.076)
NEC for r=0.05 all KL = 0.061 +- 0.204 (in-sample avg dev_std = 0.076)
NEC for r=0.05 all L1 = 0.06 +- 0.173 (in-sample avg dev_std = 0.076)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051508
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.909
NEC for r=0.1 class 0.0 = 0.142 +- 0.296 (in-sample avg dev_std = 0.192)
NEC for r=0.1 class 1.0 = 0.069 +- 0.296 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all KL = 0.128 +- 0.296 (in-sample avg dev_std = 0.192)
NEC for r=0.1 all L1 = 0.101 +- 0.221 (in-sample avg dev_std = 0.192)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.063782
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.885
NEC for r=0.2 class 0.0 = 0.21 +- 0.338 (in-sample avg dev_std = 0.307)
NEC for r=0.2 class 1.0 = 0.091 +- 0.338 (in-sample avg dev_std = 0.307)
NEC for r=0.2 all KL = 0.19 +- 0.338 (in-sample avg dev_std = 0.307)
NEC for r=0.2 all L1 = 0.144 +- 0.246 (in-sample avg dev_std = 0.307)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075396
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.868
NEC for r=0.4 class 0.0 = 0.244 +- 0.355 (in-sample avg dev_std = 0.374)
NEC for r=0.4 class 1.0 = 0.115 +- 0.355 (in-sample avg dev_std = 0.374)
NEC for r=0.4 all KL = 0.244 +- 0.355 (in-sample avg dev_std = 0.374)
NEC for r=0.4 all L1 = 0.172 +- 0.251 (in-sample avg dev_std = 0.374)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08294800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.871
NEC for r=0.8 class 0.0 = 0.249 +- 0.352 (in-sample avg dev_std = 0.393)
NEC for r=0.8 class 1.0 = 0.114 +- 0.352 (in-sample avg dev_std = 0.393)
NEC for r=0.8 all KL = 0.25 +- 0.352 (in-sample avg dev_std = 0.393)
NEC for r=0.8 all L1 = 0.175 +- 0.248 (in-sample avg dev_std = 0.393)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085554
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.87
NEC for r=0.05 class 0.0 = 0.19 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.014 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.116 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.101 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009137600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.798
NEC for r=0.1 class 0.0 = 0.438 +- 0.440 (in-sample avg dev_std = 0.203)
NEC for r=0.1 class 1.0 = 0.068 +- 0.440 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all KL = 0.323 +- 0.440 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all L1 = 0.251 +- 0.359 (in-sample avg dev_std = 0.203)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009422999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.782
NEC for r=0.2 class 0.0 = 0.511 +- 0.465 (in-sample avg dev_std = 0.454)
NEC for r=0.2 class 1.0 = 0.093 +- 0.465 (in-sample avg dev_std = 0.454)
NEC for r=0.2 all KL = 0.44 +- 0.465 (in-sample avg dev_std = 0.454)
NEC for r=0.2 all L1 = 0.3 +- 0.345 (in-sample avg dev_std = 0.454)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009673600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.78
NEC for r=0.4 class 0.0 = 0.526 +- 0.466 (in-sample avg dev_std = 0.502)
NEC for r=0.4 class 1.0 = 0.101 +- 0.466 (in-sample avg dev_std = 0.502)
NEC for r=0.4 all KL = 0.464 +- 0.466 (in-sample avg dev_std = 0.502)
NEC for r=0.4 all L1 = 0.312 +- 0.340 (in-sample avg dev_std = 0.502)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097454
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.781
NEC for r=0.8 class 0.0 = 0.53 +- 0.464 (in-sample avg dev_std = 0.517)
NEC for r=0.8 class 1.0 = 0.103 +- 0.464 (in-sample avg dev_std = 0.517)
NEC for r=0.8 all KL = 0.473 +- 0.464 (in-sample avg dev_std = 0.517)
NEC for r=0.8 all L1 = 0.315 +- 0.337 (in-sample avg dev_std = 0.517)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.026340999999999996
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.654
NEC for r=0.05 class 0.0 = 0.036 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.072 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.054 +- 0.136 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0372252
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.654
NEC for r=0.1 class 0.0 = 0.052 +- 0.168 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.106 +- 0.168 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.053 +- 0.168 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.079 +- 0.180 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.647
NEC for r=0.2 class 0.0 = 0.081 +- 0.219 (in-sample avg dev_std = 0.053)
NEC for r=0.2 class 1.0 = 0.144 +- 0.219 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all KL = 0.089 +- 0.219 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all L1 = 0.112 +- 0.221 (in-sample avg dev_std = 0.053)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06344580000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.625
NEC for r=0.4 class 0.0 = 0.13 +- 0.274 (in-sample avg dev_std = 0.142)
NEC for r=0.4 class 1.0 = 0.183 +- 0.274 (in-sample avg dev_std = 0.142)
NEC for r=0.4 all KL = 0.143 +- 0.274 (in-sample avg dev_std = 0.142)
NEC for r=0.4 all L1 = 0.156 +- 0.255 (in-sample avg dev_std = 0.142)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.652
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790086
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.6
NEC for r=0.8 class 0.0 = 0.149 +- 0.309 (in-sample avg dev_std = 0.230)
NEC for r=0.8 class 1.0 = 0.227 +- 0.309 (in-sample avg dev_std = 0.230)
NEC for r=0.8 all KL = 0.193 +- 0.309 (in-sample avg dev_std = 0.230)
NEC for r=0.8 all L1 = 0.187 +- 0.266 (in-sample avg dev_std = 0.230)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:05:42 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:05:43 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.048
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.059
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.038
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.064
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03645400000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.777
SUFF_SIMPLE for r=0.05 class 0.0 = 0.599 +- 0.407 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.802 +- 0.407 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.05 all KL = 0.593 +- 0.407 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.05 all L1 = 0.712 +- 0.294 (in-sample avg dev_std = 0.476)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048091999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.775
SUFF_SIMPLE for r=0.1 class 0.0 = 0.599 +- 0.412 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.809 +- 0.412 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.1 all KL = 0.606 +- 0.412 (in-sample avg dev_std = 0.473)
SUFF_SIMPLE for r=0.1 all L1 = 0.716 +- 0.298 (in-sample avg dev_std = 0.473)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059421999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.782
SUFF_SIMPLE for r=0.2 class 0.0 = 0.6 +- 0.407 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.812 +- 0.407 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 all KL = 0.601 +- 0.407 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 all L1 = 0.718 +- 0.294 (in-sample avg dev_std = 0.470)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07090400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.781
SUFF_SIMPLE for r=0.4 class 0.0 = 0.599 +- 0.417 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.835 +- 0.417 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.4 all KL = 0.632 +- 0.417 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.4 all L1 = 0.73 +- 0.303 (in-sample avg dev_std = 0.451)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07983799999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.837
SUFF_SIMPLE for r=0.8 class 0.0 = 0.696 +- 0.388 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.912 +- 0.388 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.8 all KL = 0.769 +- 0.388 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.8 all L1 = 0.816 +- 0.298 (in-sample avg dev_std = 0.267)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090664
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.665
SUFF_SIMPLE for r=0.05 class 0.0 = 0.672 +- 0.421 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.624 +- 0.421 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.05 all KL = 0.531 +- 0.421 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.05 all L1 = 0.648 +- 0.318 (in-sample avg dev_std = 0.491)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.667
SUFF_SIMPLE for r=0.1 class 0.0 = 0.673 +- 0.420 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.623 +- 0.420 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.1 all KL = 0.529 +- 0.420 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.1 all L1 = 0.648 +- 0.316 (in-sample avg dev_std = 0.495)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009436599999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.665
SUFF_SIMPLE for r=0.2 class 0.0 = 0.673 +- 0.421 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.626 +- 0.421 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.2 all KL = 0.534 +- 0.421 (in-sample avg dev_std = 0.485)
SUFF_SIMPLE for r=0.2 all L1 = 0.649 +- 0.318 (in-sample avg dev_std = 0.485)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009517
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.669
SUFF_SIMPLE for r=0.4 class 0.0 = 0.679 +- 0.422 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.626 +- 0.422 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 all KL = 0.537 +- 0.422 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 all L1 = 0.652 +- 0.320 (in-sample avg dev_std = 0.474)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.687
SUFF_SIMPLE for r=0.8 class 0.0 = 0.699 +- 0.425 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.7 +- 0.425 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all KL = 0.645 +- 0.425 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all L1 = 0.7 +- 0.347 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027151400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.63
SUFF_SIMPLE for r=0.05 class 0.0 = 0.803 +- 0.367 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.692 +- 0.367 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 all KL = 0.713 +- 0.367 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.05 all L1 = 0.748 +- 0.289 (in-sample avg dev_std = 0.252)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.038323800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.627
SUFF_SIMPLE for r=0.1 class 0.0 = 0.797 +- 0.371 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.693 +- 0.371 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all KL = 0.709 +- 0.371 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all L1 = 0.746 +- 0.292 (in-sample avg dev_std = 0.244)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05034740000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.631
SUFF_SIMPLE for r=0.2 class 0.0 = 0.789 +- 0.362 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.719 +- 0.362 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.2 all KL = 0.721 +- 0.362 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.2 all L1 = 0.755 +- 0.291 (in-sample avg dev_std = 0.231)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06435620000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.653
SUFF_SIMPLE for r=0.4 class 0.0 = 0.816 +- 0.337 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.756 +- 0.337 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all KL = 0.773 +- 0.337 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.4 all L1 = 0.786 +- 0.287 (in-sample avg dev_std = 0.179)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.696
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0799668
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.712
SUFF_SIMPLE for r=0.8 class 0.0 = 0.929 +- 0.250 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.250 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all KL = 0.895 +- 0.250 (in-sample avg dev_std = 0.032)
SUFF_SIMPLE for r=0.8 all L1 = 0.882 +- 0.235 (in-sample avg dev_std = 0.032)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03645400000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.965
NEC for r=0.05 class 0.0 = 0.067 +- 0.164 (in-sample avg dev_std = 0.060)
NEC for r=0.05 class 1.0 = 0.022 +- 0.164 (in-sample avg dev_std = 0.060)
NEC for r=0.05 all KL = 0.04 +- 0.164 (in-sample avg dev_std = 0.060)
NEC for r=0.05 all L1 = 0.042 +- 0.143 (in-sample avg dev_std = 0.060)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048091999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.942
NEC for r=0.1 class 0.0 = 0.11 +- 0.244 (in-sample avg dev_std = 0.181)
NEC for r=0.1 class 1.0 = 0.043 +- 0.244 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all KL = 0.087 +- 0.244 (in-sample avg dev_std = 0.181)
NEC for r=0.1 all L1 = 0.073 +- 0.185 (in-sample avg dev_std = 0.181)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059421999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.917
NEC for r=0.2 class 0.0 = 0.179 +- 0.301 (in-sample avg dev_std = 0.274)
NEC for r=0.2 class 1.0 = 0.055 +- 0.301 (in-sample avg dev_std = 0.274)
NEC for r=0.2 all KL = 0.15 +- 0.301 (in-sample avg dev_std = 0.274)
NEC for r=0.2 all L1 = 0.11 +- 0.213 (in-sample avg dev_std = 0.274)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07090400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.898
NEC for r=0.4 class 0.0 = 0.209 +- 0.328 (in-sample avg dev_std = 0.346)
NEC for r=0.4 class 1.0 = 0.072 +- 0.328 (in-sample avg dev_std = 0.346)
NEC for r=0.4 all KL = 0.191 +- 0.328 (in-sample avg dev_std = 0.346)
NEC for r=0.4 all L1 = 0.133 +- 0.226 (in-sample avg dev_std = 0.346)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07983799999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.899
NEC for r=0.8 class 0.0 = 0.227 +- 0.333 (in-sample avg dev_std = 0.385)
NEC for r=0.8 class 1.0 = 0.082 +- 0.333 (in-sample avg dev_std = 0.385)
NEC for r=0.8 all KL = 0.222 +- 0.333 (in-sample avg dev_std = 0.385)
NEC for r=0.8 all L1 = 0.147 +- 0.220 (in-sample avg dev_std = 0.385)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090664
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.929
NEC for r=0.05 class 0.0 = 0.023 +- 0.153 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.138 +- 0.153 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.052 +- 0.153 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.081 +- 0.173 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.875
NEC for r=0.1 class 0.0 = 0.1 +- 0.291 (in-sample avg dev_std = 0.117)
NEC for r=0.1 class 1.0 = 0.185 +- 0.291 (in-sample avg dev_std = 0.117)
NEC for r=0.1 all KL = 0.145 +- 0.291 (in-sample avg dev_std = 0.117)
NEC for r=0.1 all L1 = 0.143 +- 0.248 (in-sample avg dev_std = 0.117)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009436599999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.866
NEC for r=0.2 class 0.0 = 0.145 +- 0.363 (in-sample avg dev_std = 0.340)
NEC for r=0.2 class 1.0 = 0.203 +- 0.363 (in-sample avg dev_std = 0.340)
NEC for r=0.2 all KL = 0.245 +- 0.363 (in-sample avg dev_std = 0.340)
NEC for r=0.2 all L1 = 0.174 +- 0.237 (in-sample avg dev_std = 0.340)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009517
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.865
NEC for r=0.4 class 0.0 = 0.153 +- 0.371 (in-sample avg dev_std = 0.379)
NEC for r=0.4 class 1.0 = 0.205 +- 0.371 (in-sample avg dev_std = 0.379)
NEC for r=0.4 all KL = 0.27 +- 0.371 (in-sample avg dev_std = 0.379)
NEC for r=0.4 all L1 = 0.179 +- 0.227 (in-sample avg dev_std = 0.379)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.865
NEC for r=0.8 class 0.0 = 0.156 +- 0.374 (in-sample avg dev_std = 0.391)
NEC for r=0.8 class 1.0 = 0.207 +- 0.374 (in-sample avg dev_std = 0.391)
NEC for r=0.8 all KL = 0.279 +- 0.374 (in-sample avg dev_std = 0.391)
NEC for r=0.8 all L1 = 0.181 +- 0.225 (in-sample avg dev_std = 0.391)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027151400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.691
NEC for r=0.05 class 0.0 = 0.036 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.076 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.033 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.145 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.038323800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.7
NEC for r=0.1 class 0.0 = 0.052 +- 0.178 (in-sample avg dev_std = 0.012)
NEC for r=0.1 class 1.0 = 0.111 +- 0.178 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all KL = 0.059 +- 0.178 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all L1 = 0.081 +- 0.185 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05034740000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.68
NEC for r=0.2 class 0.0 = 0.084 +- 0.223 (in-sample avg dev_std = 0.070)
NEC for r=0.2 class 1.0 = 0.133 +- 0.223 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all KL = 0.088 +- 0.223 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all L1 = 0.108 +- 0.218 (in-sample avg dev_std = 0.070)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06435620000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.659
NEC for r=0.4 class 0.0 = 0.131 +- 0.274 (in-sample avg dev_std = 0.156)
NEC for r=0.4 class 1.0 = 0.166 +- 0.274 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all KL = 0.14 +- 0.274 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all L1 = 0.148 +- 0.247 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.695
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0799668
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
NEC for r=0.8 class 0.0 = 0.154 +- 0.314 (in-sample avg dev_std = 0.234)
NEC for r=0.8 class 1.0 = 0.215 +- 0.314 (in-sample avg dev_std = 0.234)
NEC for r=0.8 all KL = 0.197 +- 0.314 (in-sample avg dev_std = 0.234)
NEC for r=0.8 all L1 = 0.184 +- 0.259 (in-sample avg dev_std = 0.234)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:23:57 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:23:57 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 77 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.048
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.062
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035300000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.724
SUFF_SIMPLE for r=0.05 class 0.0 = 0.565 +- 0.404 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.774 +- 0.404 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.05 all KL = 0.601 +- 0.404 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.05 all L1 = 0.681 +- 0.319 (in-sample avg dev_std = 0.423)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047757999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.72
SUFF_SIMPLE for r=0.1 class 0.0 = 0.572 +- 0.413 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.773 +- 0.413 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all KL = 0.608 +- 0.413 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all L1 = 0.684 +- 0.323 (in-sample avg dev_std = 0.425)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061932
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.717
SUFF_SIMPLE for r=0.2 class 0.0 = 0.566 +- 0.414 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.762 +- 0.414 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all KL = 0.596 +- 0.414 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.2 all L1 = 0.674 +- 0.326 (in-sample avg dev_std = 0.413)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071274
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.705
SUFF_SIMPLE for r=0.4 class 0.0 = 0.551 +- 0.420 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.776 +- 0.420 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 all KL = 0.606 +- 0.420 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 all L1 = 0.676 +- 0.333 (in-sample avg dev_std = 0.391)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078928
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.769
SUFF_SIMPLE for r=0.8 class 0.0 = 0.652 +- 0.404 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.867 +- 0.404 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.8 all KL = 0.745 +- 0.404 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.8 all L1 = 0.771 +- 0.334 (in-sample avg dev_std = 0.208)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008754999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.554
SUFF_SIMPLE for r=0.05 class 0.0 = 0.76 +- 0.387 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.626 +- 0.387 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.05 all KL = 0.623 +- 0.387 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.05 all L1 = 0.693 +- 0.295 (in-sample avg dev_std = 0.377)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009405799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.554
SUFF_SIMPLE for r=0.1 class 0.0 = 0.759 +- 0.386 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.626 +- 0.386 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 all KL = 0.621 +- 0.386 (in-sample avg dev_std = 0.381)
SUFF_SIMPLE for r=0.1 all L1 = 0.692 +- 0.295 (in-sample avg dev_std = 0.381)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009508800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.55
SUFF_SIMPLE for r=0.2 class 0.0 = 0.76 +- 0.389 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.622 +- 0.389 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.2 all KL = 0.619 +- 0.389 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.2 all L1 = 0.69 +- 0.296 (in-sample avg dev_std = 0.380)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009540200000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.559
SUFF_SIMPLE for r=0.4 class 0.0 = 0.763 +- 0.389 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.635 +- 0.389 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.4 all KL = 0.629 +- 0.389 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.4 all L1 = 0.698 +- 0.295 (in-sample avg dev_std = 0.366)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009659799999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.567
SUFF_SIMPLE for r=0.8 class 0.0 = 0.759 +- 0.391 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.69 +- 0.391 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.8 all KL = 0.688 +- 0.391 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.8 all L1 = 0.724 +- 0.311 (in-sample avg dev_std = 0.126)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249234
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.613
SUFF_SIMPLE for r=0.05 class 0.0 = 0.809 +- 0.361 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.697 +- 0.361 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.05 all KL = 0.723 +- 0.361 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.05 all L1 = 0.753 +- 0.295 (in-sample avg dev_std = 0.276)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03595399999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.619
SUFF_SIMPLE for r=0.1 class 0.0 = 0.811 +- 0.361 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.7 +- 0.361 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all KL = 0.727 +- 0.361 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all L1 = 0.756 +- 0.297 (in-sample avg dev_std = 0.262)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048873200000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.625
SUFF_SIMPLE for r=0.2 class 0.0 = 0.815 +- 0.351 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.727 +- 0.351 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.351 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.2 all L1 = 0.771 +- 0.293 (in-sample avg dev_std = 0.234)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06226460000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.638
SUFF_SIMPLE for r=0.4 class 0.0 = 0.822 +- 0.336 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.753 +- 0.336 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.4 all KL = 0.778 +- 0.336 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.4 all L1 = 0.788 +- 0.292 (in-sample avg dev_std = 0.188)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.68
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078543
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.693
SUFF_SIMPLE for r=0.8 class 0.0 = 0.928 +- 0.244 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.844 +- 0.244 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.8 all KL = 0.902 +- 0.244 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.8 all L1 = 0.887 +- 0.231 (in-sample avg dev_std = 0.024)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035300000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.924
NEC for r=0.05 class 0.0 = 0.122 +- 0.245 (in-sample avg dev_std = 0.054)
NEC for r=0.05 class 1.0 = 0.052 +- 0.245 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all KL = 0.081 +- 0.245 (in-sample avg dev_std = 0.054)
NEC for r=0.05 all L1 = 0.083 +- 0.211 (in-sample avg dev_std = 0.054)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047757999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.903
NEC for r=0.1 class 0.0 = 0.162 +- 0.295 (in-sample avg dev_std = 0.203)
NEC for r=0.1 class 1.0 = 0.071 +- 0.295 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all KL = 0.125 +- 0.295 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all L1 = 0.112 +- 0.233 (in-sample avg dev_std = 0.203)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061932
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.878
NEC for r=0.2 class 0.0 = 0.225 +- 0.337 (in-sample avg dev_std = 0.317)
NEC for r=0.2 class 1.0 = 0.093 +- 0.337 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all KL = 0.192 +- 0.337 (in-sample avg dev_std = 0.317)
NEC for r=0.2 all L1 = 0.152 +- 0.248 (in-sample avg dev_std = 0.317)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071274
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.861
NEC for r=0.4 class 0.0 = 0.278 +- 0.359 (in-sample avg dev_std = 0.399)
NEC for r=0.4 class 1.0 = 0.105 +- 0.359 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all KL = 0.242 +- 0.359 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all L1 = 0.182 +- 0.254 (in-sample avg dev_std = 0.399)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078928
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.844
NEC for r=0.8 class 0.0 = 0.297 +- 0.368 (in-sample avg dev_std = 0.421)
NEC for r=0.8 class 1.0 = 0.12 +- 0.368 (in-sample avg dev_std = 0.421)
NEC for r=0.8 all KL = 0.264 +- 0.368 (in-sample avg dev_std = 0.421)
NEC for r=0.8 all L1 = 0.199 +- 0.264 (in-sample avg dev_std = 0.421)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008754999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.752
NEC for r=0.05 class 0.0 = 0.04 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.054 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.082 +- 0.159 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009405799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.695
NEC for r=0.1 class 0.0 = 0.126 +- 0.307 (in-sample avg dev_std = 0.106)
NEC for r=0.1 class 1.0 = 0.177 +- 0.307 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all KL = 0.156 +- 0.307 (in-sample avg dev_std = 0.106)
NEC for r=0.1 all L1 = 0.152 +- 0.232 (in-sample avg dev_std = 0.106)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009508800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.682
NEC for r=0.2 class 0.0 = 0.169 +- 0.359 (in-sample avg dev_std = 0.300)
NEC for r=0.2 class 1.0 = 0.194 +- 0.359 (in-sample avg dev_std = 0.300)
NEC for r=0.2 all KL = 0.233 +- 0.359 (in-sample avg dev_std = 0.300)
NEC for r=0.2 all L1 = 0.181 +- 0.225 (in-sample avg dev_std = 0.300)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009540200000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.682
NEC for r=0.4 class 0.0 = 0.176 +- 0.364 (in-sample avg dev_std = 0.338)
NEC for r=0.4 class 1.0 = 0.198 +- 0.364 (in-sample avg dev_std = 0.338)
NEC for r=0.4 all KL = 0.249 +- 0.364 (in-sample avg dev_std = 0.338)
NEC for r=0.4 all L1 = 0.187 +- 0.218 (in-sample avg dev_std = 0.338)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009659799999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.68
NEC for r=0.8 class 0.0 = 0.178 +- 0.367 (in-sample avg dev_std = 0.349)
NEC for r=0.8 class 1.0 = 0.199 +- 0.367 (in-sample avg dev_std = 0.349)
NEC for r=0.8 all KL = 0.253 +- 0.367 (in-sample avg dev_std = 0.349)
NEC for r=0.8 all L1 = 0.189 +- 0.217 (in-sample avg dev_std = 0.349)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249234
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.681
NEC for r=0.05 class 0.0 = 0.036 +- 0.129 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.075 +- 0.129 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.032 +- 0.129 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.055 +- 0.144 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03595399999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.686
NEC for r=0.1 class 0.0 = 0.051 +- 0.177 (in-sample avg dev_std = 0.012)
NEC for r=0.1 class 1.0 = 0.109 +- 0.177 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all KL = 0.057 +- 0.177 (in-sample avg dev_std = 0.012)
NEC for r=0.1 all L1 = 0.08 +- 0.185 (in-sample avg dev_std = 0.012)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048873200000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.671
NEC for r=0.2 class 0.0 = 0.089 +- 0.231 (in-sample avg dev_std = 0.064)
NEC for r=0.2 class 1.0 = 0.141 +- 0.231 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all KL = 0.095 +- 0.231 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all L1 = 0.115 +- 0.226 (in-sample avg dev_std = 0.064)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06226460000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.652
NEC for r=0.4 class 0.0 = 0.129 +- 0.276 (in-sample avg dev_std = 0.156)
NEC for r=0.4 class 1.0 = 0.17 +- 0.276 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all KL = 0.14 +- 0.276 (in-sample avg dev_std = 0.156)
NEC for r=0.4 all L1 = 0.15 +- 0.252 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.679
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078543
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.634
NEC for r=0.8 class 0.0 = 0.148 +- 0.313 (in-sample avg dev_std = 0.247)
NEC for r=0.8 class 1.0 = 0.215 +- 0.313 (in-sample avg dev_std = 0.247)
NEC for r=0.8 all KL = 0.192 +- 0.313 (in-sample avg dev_std = 0.247)
NEC for r=0.8 all L1 = 0.181 +- 0.266 (in-sample avg dev_std = 0.247)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 06:42:33 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:42:33 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.060
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.048
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031674
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.739
SUFF_SIMPLE for r=0.05 class 0.0 = 0.603 +- 0.413 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.76 +- 0.413 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.05 all KL = 0.593 +- 0.413 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.05 all L1 = 0.69 +- 0.306 (in-sample avg dev_std = 0.447)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047403999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.727
SUFF_SIMPLE for r=0.1 class 0.0 = 0.597 +- 0.418 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.752 +- 0.418 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 all KL = 0.592 +- 0.418 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.1 all L1 = 0.683 +- 0.312 (in-sample avg dev_std = 0.434)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060094
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.734
SUFF_SIMPLE for r=0.2 class 0.0 = 0.607 +- 0.415 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.758 +- 0.415 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.2 all KL = 0.605 +- 0.415 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.2 all L1 = 0.69 +- 0.312 (in-sample avg dev_std = 0.416)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073904
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.745
SUFF_SIMPLE for r=0.4 class 0.0 = 0.597 +- 0.413 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.788 +- 0.413 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 all KL = 0.629 +- 0.413 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 all L1 = 0.703 +- 0.318 (in-sample avg dev_std = 0.385)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08061800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.794
SUFF_SIMPLE for r=0.8 class 0.0 = 0.632 +- 0.395 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.883 +- 0.395 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.8 all KL = 0.742 +- 0.395 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.8 all L1 = 0.771 +- 0.319 (in-sample avg dev_std = 0.223)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086018
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.577
SUFF_SIMPLE for r=0.05 class 0.0 = 0.819 +- 0.388 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.586 +- 0.388 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.05 all KL = 0.617 +- 0.388 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.05 all L1 = 0.702 +- 0.291 (in-sample avg dev_std = 0.358)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0090214
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.575
SUFF_SIMPLE for r=0.1 class 0.0 = 0.821 +- 0.389 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.584 +- 0.389 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.1 all KL = 0.616 +- 0.389 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.1 all L1 = 0.701 +- 0.293 (in-sample avg dev_std = 0.357)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0093638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.576
SUFF_SIMPLE for r=0.2 class 0.0 = 0.819 +- 0.389 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.588 +- 0.389 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.2 all KL = 0.617 +- 0.389 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.2 all L1 = 0.703 +- 0.292 (in-sample avg dev_std = 0.356)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096116
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.576
SUFF_SIMPLE for r=0.4 class 0.0 = 0.819 +- 0.390 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.59 +- 0.390 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 all KL = 0.621 +- 0.390 (in-sample avg dev_std = 0.344)
SUFF_SIMPLE for r=0.4 all L1 = 0.704 +- 0.294 (in-sample avg dev_std = 0.344)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009753
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.591
SUFF_SIMPLE for r=0.8 class 0.0 = 0.831 +- 0.379 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.641 +- 0.379 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.8 all KL = 0.69 +- 0.379 (in-sample avg dev_std = 0.115)
SUFF_SIMPLE for r=0.8 all L1 = 0.735 +- 0.304 (in-sample avg dev_std = 0.115)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024698599999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.567
SUFF_SIMPLE for r=0.05 class 0.0 = 0.845 +- 0.367 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.694 +- 0.367 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.05 all KL = 0.743 +- 0.367 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.05 all L1 = 0.77 +- 0.299 (in-sample avg dev_std = 0.278)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0358638
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.566
SUFF_SIMPLE for r=0.1 class 0.0 = 0.85 +- 0.370 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.695 +- 0.370 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.1 all KL = 0.749 +- 0.370 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.1 all L1 = 0.774 +- 0.304 (in-sample avg dev_std = 0.257)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047934199999999996
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.567
SUFF_SIMPLE for r=0.2 class 0.0 = 0.856 +- 0.369 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.704 +- 0.369 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.2 all KL = 0.757 +- 0.369 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.2 all L1 = 0.781 +- 0.304 (in-sample avg dev_std = 0.239)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06318860000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.579
SUFF_SIMPLE for r=0.4 class 0.0 = 0.858 +- 0.347 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.741 +- 0.347 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.4 all KL = 0.782 +- 0.347 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.4 all L1 = 0.8 +- 0.291 (in-sample avg dev_std = 0.204)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.627
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079252
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.635
SUFF_SIMPLE for r=0.8 class 0.0 = 0.929 +- 0.245 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.848 +- 0.245 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.903 +- 0.245 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.889 +- 0.229 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031674
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.927
NEC for r=0.05 class 0.0 = 0.111 +- 0.230 (in-sample avg dev_std = 0.007)
NEC for r=0.05 class 1.0 = 0.047 +- 0.230 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all KL = 0.069 +- 0.230 (in-sample avg dev_std = 0.007)
NEC for r=0.05 all L1 = 0.075 +- 0.196 (in-sample avg dev_std = 0.007)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047403999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.896
NEC for r=0.1 class 0.0 = 0.193 +- 0.302 (in-sample avg dev_std = 0.185)
NEC for r=0.1 class 1.0 = 0.057 +- 0.302 (in-sample avg dev_std = 0.185)
NEC for r=0.1 all KL = 0.132 +- 0.302 (in-sample avg dev_std = 0.185)
NEC for r=0.1 all L1 = 0.118 +- 0.235 (in-sample avg dev_std = 0.185)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060094
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.883
NEC for r=0.2 class 0.0 = 0.243 +- 0.338 (in-sample avg dev_std = 0.281)
NEC for r=0.2 class 1.0 = 0.068 +- 0.338 (in-sample avg dev_std = 0.281)
NEC for r=0.2 all KL = 0.18 +- 0.338 (in-sample avg dev_std = 0.281)
NEC for r=0.2 all L1 = 0.146 +- 0.251 (in-sample avg dev_std = 0.281)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073904
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.877
NEC for r=0.4 class 0.0 = 0.266 +- 0.356 (in-sample avg dev_std = 0.378)
NEC for r=0.4 class 1.0 = 0.097 +- 0.356 (in-sample avg dev_std = 0.378)
NEC for r=0.4 all KL = 0.227 +- 0.356 (in-sample avg dev_std = 0.378)
NEC for r=0.4 all L1 = 0.172 +- 0.247 (in-sample avg dev_std = 0.378)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08061800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.864
NEC for r=0.8 class 0.0 = 0.271 +- 0.359 (in-sample avg dev_std = 0.396)
NEC for r=0.8 class 1.0 = 0.113 +- 0.359 (in-sample avg dev_std = 0.396)
NEC for r=0.8 all KL = 0.247 +- 0.359 (in-sample avg dev_std = 0.396)
NEC for r=0.8 all L1 = 0.183 +- 0.253 (in-sample avg dev_std = 0.396)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086018
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.739
NEC for r=0.05 class 0.0 = 0.016 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.19 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.069 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.104 +- 0.187 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0090214
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.705
NEC for r=0.1 class 0.0 = 0.057 +- 0.270 (in-sample avg dev_std = 0.091)
NEC for r=0.1 class 1.0 = 0.249 +- 0.270 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all KL = 0.144 +- 0.270 (in-sample avg dev_std = 0.091)
NEC for r=0.1 all L1 = 0.154 +- 0.230 (in-sample avg dev_std = 0.091)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0093638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.694
NEC for r=0.2 class 0.0 = 0.09 +- 0.320 (in-sample avg dev_std = 0.282)
NEC for r=0.2 class 1.0 = 0.278 +- 0.320 (in-sample avg dev_std = 0.282)
NEC for r=0.2 all KL = 0.22 +- 0.320 (in-sample avg dev_std = 0.282)
NEC for r=0.2 all L1 = 0.185 +- 0.228 (in-sample avg dev_std = 0.282)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096116
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.693
NEC for r=0.4 class 0.0 = 0.089 +- 0.321 (in-sample avg dev_std = 0.315)
NEC for r=0.4 class 1.0 = 0.283 +- 0.321 (in-sample avg dev_std = 0.315)
NEC for r=0.4 all KL = 0.234 +- 0.321 (in-sample avg dev_std = 0.315)
NEC for r=0.4 all L1 = 0.187 +- 0.218 (in-sample avg dev_std = 0.315)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009753
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.693
NEC for r=0.8 class 0.0 = 0.091 +- 0.325 (in-sample avg dev_std = 0.324)
NEC for r=0.8 class 1.0 = 0.285 +- 0.325 (in-sample avg dev_std = 0.324)
NEC for r=0.8 all KL = 0.246 +- 0.325 (in-sample avg dev_std = 0.324)
NEC for r=0.8 all L1 = 0.189 +- 0.215 (in-sample avg dev_std = 0.324)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024698599999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.623
NEC for r=0.05 class 0.0 = 0.033 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.073 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.053 +- 0.141 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0358638
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.624
NEC for r=0.1 class 0.0 = 0.051 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.103 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.057 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.077 +- 0.183 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047934199999999996
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.615
NEC for r=0.2 class 0.0 = 0.079 +- 0.237 (in-sample avg dev_std = 0.064)
NEC for r=0.2 class 1.0 = 0.144 +- 0.237 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all KL = 0.097 +- 0.237 (in-sample avg dev_std = 0.064)
NEC for r=0.2 all L1 = 0.111 +- 0.226 (in-sample avg dev_std = 0.064)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06318860000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.595
NEC for r=0.4 class 0.0 = 0.109 +- 0.284 (in-sample avg dev_std = 0.157)
NEC for r=0.4 class 1.0 = 0.183 +- 0.284 (in-sample avg dev_std = 0.157)
NEC for r=0.4 all KL = 0.143 +- 0.284 (in-sample avg dev_std = 0.157)
NEC for r=0.4 all L1 = 0.146 +- 0.254 (in-sample avg dev_std = 0.157)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.626
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079252
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.58
NEC for r=0.8 class 0.0 = 0.125 +- 0.319 (in-sample avg dev_std = 0.240)
NEC for r=0.8 class 1.0 = 0.221 +- 0.319 (in-sample avg dev_std = 0.240)
NEC for r=0.8 all KL = 0.185 +- 0.319 (in-sample avg dev_std = 0.240)
NEC for r=0.8 all L1 = 0.173 +- 0.268 (in-sample avg dev_std = 0.240)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:01:05 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:01:05 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mChartInfo 0.9580 0.9580 0.9580 0.9580 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.045
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.069
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034804
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.753
SUFF_SIMPLE for r=0.05 class 0.0 = 0.61 +- 0.398 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.767 +- 0.398 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.05 all KL = 0.626 +- 0.398 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.05 all L1 = 0.697 +- 0.298 (in-sample avg dev_std = 0.432)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.044708
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.608 +- 0.393 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.765 +- 0.393 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.1 all KL = 0.614 +- 0.393 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.1 all L1 = 0.695 +- 0.293 (in-sample avg dev_std = 0.450)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056204000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.744
SUFF_SIMPLE for r=0.2 class 0.0 = 0.608 +- 0.396 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.764 +- 0.396 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.2 all KL = 0.615 +- 0.396 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.2 all L1 = 0.694 +- 0.297 (in-sample avg dev_std = 0.434)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06890600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.752
SUFF_SIMPLE for r=0.4 class 0.0 = 0.601 +- 0.397 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.78 +- 0.397 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.4 all KL = 0.631 +- 0.397 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.4 all L1 = 0.701 +- 0.301 (in-sample avg dev_std = 0.407)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.814
SUFF_SIMPLE for r=0.8 class 0.0 = 0.682 +- 0.366 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.885 +- 0.366 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.8 all KL = 0.774 +- 0.366 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.8 all L1 = 0.794 +- 0.295 (in-sample avg dev_std = 0.253)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086272
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.62
SUFF_SIMPLE for r=0.05 class 0.0 = 0.855 +- 0.392 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.604 +- 0.392 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.05 all KL = 0.637 +- 0.392 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.05 all L1 = 0.728 +- 0.296 (in-sample avg dev_std = 0.410)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091434
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.617
SUFF_SIMPLE for r=0.1 class 0.0 = 0.853 +- 0.394 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.603 +- 0.394 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 all KL = 0.634 +- 0.394 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.1 all L1 = 0.727 +- 0.295 (in-sample avg dev_std = 0.410)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009401000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.618
SUFF_SIMPLE for r=0.2 class 0.0 = 0.852 +- 0.394 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.607 +- 0.394 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all KL = 0.638 +- 0.394 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.2 all L1 = 0.729 +- 0.295 (in-sample avg dev_std = 0.407)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009639199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.618
SUFF_SIMPLE for r=0.4 class 0.0 = 0.851 +- 0.394 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.611 +- 0.394 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.4 all KL = 0.643 +- 0.394 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.4 all L1 = 0.73 +- 0.298 (in-sample avg dev_std = 0.394)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009715999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.636
SUFF_SIMPLE for r=0.8 class 0.0 = 0.878 +- 0.372 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.662 +- 0.372 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.8 all KL = 0.739 +- 0.372 (in-sample avg dev_std = 0.145)
SUFF_SIMPLE for r=0.8 all L1 = 0.769 +- 0.312 (in-sample avg dev_std = 0.145)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266938
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.597
SUFF_SIMPLE for r=0.05 class 0.0 = 0.824 +- 0.360 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.679 +- 0.360 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.05 all KL = 0.738 +- 0.360 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.05 all L1 = 0.753 +- 0.298 (in-sample avg dev_std = 0.278)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0373308
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.594
SUFF_SIMPLE for r=0.1 class 0.0 = 0.825 +- 0.362 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.679 +- 0.362 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.1 all KL = 0.739 +- 0.362 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.1 all L1 = 0.753 +- 0.301 (in-sample avg dev_std = 0.267)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500774
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.601
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.361 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.688 +- 0.361 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.361 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.2 all L1 = 0.759 +- 0.304 (in-sample avg dev_std = 0.244)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064822
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.597
SUFF_SIMPLE for r=0.4 class 0.0 = 0.823 +- 0.342 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.726 +- 0.342 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.4 all KL = 0.77 +- 0.342 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.4 all L1 = 0.775 +- 0.296 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.666
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0803778
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.67
SUFF_SIMPLE for r=0.8 class 0.0 = 0.91 +- 0.248 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.835 +- 0.248 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.8 all KL = 0.894 +- 0.248 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.8 all L1 = 0.873 +- 0.238 (in-sample avg dev_std = 0.014)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034804
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.933
NEC for r=0.05 class 0.0 = 0.089 +- 0.177 (in-sample avg dev_std = 0.062)
NEC for r=0.05 class 1.0 = 0.044 +- 0.177 (in-sample avg dev_std = 0.062)
NEC for r=0.05 all KL = 0.05 +- 0.177 (in-sample avg dev_std = 0.062)
NEC for r=0.05 all L1 = 0.064 +- 0.162 (in-sample avg dev_std = 0.062)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.044708
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.896
NEC for r=0.1 class 0.0 = 0.193 +- 0.282 (in-sample avg dev_std = 0.194)
NEC for r=0.1 class 1.0 = 0.064 +- 0.282 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all KL = 0.123 +- 0.282 (in-sample avg dev_std = 0.194)
NEC for r=0.1 all L1 = 0.122 +- 0.231 (in-sample avg dev_std = 0.194)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056204000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.878
NEC for r=0.2 class 0.0 = 0.253 +- 0.321 (in-sample avg dev_std = 0.304)
NEC for r=0.2 class 1.0 = 0.075 +- 0.321 (in-sample avg dev_std = 0.304)
NEC for r=0.2 all KL = 0.174 +- 0.321 (in-sample avg dev_std = 0.304)
NEC for r=0.2 all L1 = 0.154 +- 0.246 (in-sample avg dev_std = 0.304)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06890600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.876
NEC for r=0.4 class 0.0 = 0.251 +- 0.312 (in-sample avg dev_std = 0.345)
NEC for r=0.4 class 1.0 = 0.097 +- 0.312 (in-sample avg dev_std = 0.345)
NEC for r=0.4 all KL = 0.198 +- 0.312 (in-sample avg dev_std = 0.345)
NEC for r=0.4 all L1 = 0.166 +- 0.232 (in-sample avg dev_std = 0.345)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.872
NEC for r=0.8 class 0.0 = 0.252 +- 0.313 (in-sample avg dev_std = 0.384)
NEC for r=0.8 class 1.0 = 0.115 +- 0.313 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all KL = 0.218 +- 0.313 (in-sample avg dev_std = 0.384)
NEC for r=0.8 all L1 = 0.176 +- 0.231 (in-sample avg dev_std = 0.384)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086272
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.768
NEC for r=0.05 class 0.0 = 0.006 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.18 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.068 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.094 +- 0.195 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091434
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.74
NEC for r=0.1 class 0.0 = 0.024 +- 0.254 (in-sample avg dev_std = 0.105)
NEC for r=0.1 class 1.0 = 0.24 +- 0.254 (in-sample avg dev_std = 0.105)
NEC for r=0.1 all KL = 0.119 +- 0.254 (in-sample avg dev_std = 0.105)
NEC for r=0.1 all L1 = 0.133 +- 0.237 (in-sample avg dev_std = 0.105)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009401000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.728
NEC for r=0.2 class 0.0 = 0.042 +- 0.294 (in-sample avg dev_std = 0.298)
NEC for r=0.2 class 1.0 = 0.273 +- 0.294 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all KL = 0.182 +- 0.294 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all L1 = 0.158 +- 0.232 (in-sample avg dev_std = 0.298)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009639199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.728
NEC for r=0.4 class 0.0 = 0.047 +- 0.299 (in-sample avg dev_std = 0.338)
NEC for r=0.4 class 1.0 = 0.279 +- 0.299 (in-sample avg dev_std = 0.338)
NEC for r=0.4 all KL = 0.206 +- 0.299 (in-sample avg dev_std = 0.338)
NEC for r=0.4 all L1 = 0.164 +- 0.221 (in-sample avg dev_std = 0.338)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009715999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.728
NEC for r=0.8 class 0.0 = 0.049 +- 0.301 (in-sample avg dev_std = 0.351)
NEC for r=0.8 class 1.0 = 0.281 +- 0.301 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all KL = 0.216 +- 0.301 (in-sample avg dev_std = 0.351)
NEC for r=0.8 all L1 = 0.166 +- 0.216 (in-sample avg dev_std = 0.351)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266938
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.661
NEC for r=0.05 class 0.0 = 0.042 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.076 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.03 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.059 +- 0.140 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0373308
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.662
NEC for r=0.1 class 0.0 = 0.063 +- 0.170 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.111 +- 0.170 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.058 +- 0.170 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.087 +- 0.184 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500774
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.643
NEC for r=0.2 class 0.0 = 0.099 +- 0.226 (in-sample avg dev_std = 0.079)
NEC for r=0.2 class 1.0 = 0.145 +- 0.226 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.096 +- 0.226 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.122 +- 0.225 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064822
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.619
NEC for r=0.4 class 0.0 = 0.137 +- 0.276 (in-sample avg dev_std = 0.165)
NEC for r=0.4 class 1.0 = 0.185 +- 0.276 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all KL = 0.147 +- 0.276 (in-sample avg dev_std = 0.165)
NEC for r=0.4 all L1 = 0.161 +- 0.255 (in-sample avg dev_std = 0.165)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.666
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0803778
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.61
NEC for r=0.8 class 0.0 = 0.144 +- 0.300 (in-sample avg dev_std = 0.230)
NEC for r=0.8 class 1.0 = 0.217 +- 0.300 (in-sample avg dev_std = 0.230)
NEC for r=0.8 all KL = 0.176 +- 0.300 (in-sample avg dev_std = 0.230)
NEC for r=0.8 all L1 = 0.18 +- 0.263 (in-sample avg dev_std = 0.230)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:19:10 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:19:10 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.038
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.062
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.029
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.040
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037700000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.739
SUFF_SIMPLE for r=0.05 class 0.0 = 0.548 +- 0.421 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.802 +- 0.421 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.05 all KL = 0.567 +- 0.421 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.05 all L1 = 0.689 +- 0.312 (in-sample avg dev_std = 0.469)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.744
SUFF_SIMPLE for r=0.1 class 0.0 = 0.545 +- 0.417 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.809 +- 0.417 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.1 all KL = 0.579 +- 0.417 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.1 all L1 = 0.692 +- 0.314 (in-sample avg dev_std = 0.447)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06214
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.762
SUFF_SIMPLE for r=0.2 class 0.0 = 0.554 +- 0.414 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.818 +- 0.414 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.2 all KL = 0.586 +- 0.414 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.2 all L1 = 0.7 +- 0.306 (in-sample avg dev_std = 0.455)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07128799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.729
SUFF_SIMPLE for r=0.4 class 0.0 = 0.543 +- 0.424 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.82 +- 0.424 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.4 all KL = 0.593 +- 0.424 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.4 all L1 = 0.696 +- 0.322 (in-sample avg dev_std = 0.431)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.793
SUFF_SIMPLE for r=0.8 class 0.0 = 0.641 +- 0.406 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.902 +- 0.406 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.8 all KL = 0.747 +- 0.406 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.8 all L1 = 0.786 +- 0.327 (in-sample avg dev_std = 0.261)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008740800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.62
SUFF_SIMPLE for r=0.05 class 0.0 = 0.402 +- 0.419 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.614 +- 0.419 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.05 all KL = 0.309 +- 0.419 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.05 all L1 = 0.509 +- 0.348 (in-sample avg dev_std = 0.505)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.623
SUFF_SIMPLE for r=0.1 class 0.0 = 0.403 +- 0.421 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.619 +- 0.421 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.1 all KL = 0.313 +- 0.421 (in-sample avg dev_std = 0.503)
SUFF_SIMPLE for r=0.1 all L1 = 0.511 +- 0.349 (in-sample avg dev_std = 0.503)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096732
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.624
SUFF_SIMPLE for r=0.2 class 0.0 = 0.402 +- 0.424 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.625 +- 0.424 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all KL = 0.32 +- 0.424 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.2 all L1 = 0.514 +- 0.351 (in-sample avg dev_std = 0.494)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009841200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.623
SUFF_SIMPLE for r=0.4 class 0.0 = 0.403 +- 0.427 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.624 +- 0.427 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.4 all KL = 0.324 +- 0.427 (in-sample avg dev_std = 0.484)
SUFF_SIMPLE for r=0.4 all L1 = 0.514 +- 0.353 (in-sample avg dev_std = 0.484)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009777
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.632
SUFF_SIMPLE for r=0.8 class 0.0 = 0.41 +- 0.468 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.709 +- 0.468 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 all KL = 0.455 +- 0.468 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.8 all L1 = 0.561 +- 0.397 (in-sample avg dev_std = 0.179)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0287986
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.645
SUFF_SIMPLE for r=0.05 class 0.0 = 0.78 +- 0.365 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.695 +- 0.365 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.05 all KL = 0.71 +- 0.365 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.05 all L1 = 0.738 +- 0.287 (in-sample avg dev_std = 0.254)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.039788
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.65
SUFF_SIMPLE for r=0.1 class 0.0 = 0.773 +- 0.365 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.704 +- 0.365 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.1 all KL = 0.711 +- 0.365 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.1 all L1 = 0.739 +- 0.288 (in-sample avg dev_std = 0.243)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050878400000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.649
SUFF_SIMPLE for r=0.2 class 0.0 = 0.767 +- 0.355 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.726 +- 0.355 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.2 all KL = 0.719 +- 0.355 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.2 all L1 = 0.747 +- 0.287 (in-sample avg dev_std = 0.230)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0654224
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.66
SUFF_SIMPLE for r=0.4 class 0.0 = 0.797 +- 0.336 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.754 +- 0.336 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all KL = 0.767 +- 0.336 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all L1 = 0.776 +- 0.284 (in-sample avg dev_std = 0.186)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.709
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0809076
len(reference) = 4981
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.722
SUFF_SIMPLE for r=0.8 class 0.0 = 0.911 +- 0.245 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.839 +- 0.245 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all KL = 0.895 +- 0.245 (in-sample avg dev_std = 0.044)
SUFF_SIMPLE for r=0.8 all L1 = 0.875 +- 0.234 (in-sample avg dev_std = 0.044)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037700000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.931
NEC for r=0.05 class 0.0 = 0.105 +- 0.226 (in-sample avg dev_std = 0.034)
NEC for r=0.05 class 1.0 = 0.03 +- 0.226 (in-sample avg dev_std = 0.034)
NEC for r=0.05 all KL = 0.063 +- 0.226 (in-sample avg dev_std = 0.034)
NEC for r=0.05 all L1 = 0.063 +- 0.195 (in-sample avg dev_std = 0.034)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.914
NEC for r=0.1 class 0.0 = 0.166 +- 0.291 (in-sample avg dev_std = 0.200)
NEC for r=0.1 class 1.0 = 0.041 +- 0.291 (in-sample avg dev_std = 0.200)
NEC for r=0.1 all KL = 0.116 +- 0.291 (in-sample avg dev_std = 0.200)
NEC for r=0.1 all L1 = 0.097 +- 0.222 (in-sample avg dev_std = 0.200)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06214
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.878
NEC for r=0.2 class 0.0 = 0.245 +- 0.346 (in-sample avg dev_std = 0.314)
NEC for r=0.2 class 1.0 = 0.053 +- 0.346 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all KL = 0.187 +- 0.346 (in-sample avg dev_std = 0.314)
NEC for r=0.2 all L1 = 0.139 +- 0.248 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07128799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.874
NEC for r=0.4 class 0.0 = 0.276 +- 0.357 (in-sample avg dev_std = 0.374)
NEC for r=0.4 class 1.0 = 0.061 +- 0.357 (in-sample avg dev_std = 0.374)
NEC for r=0.4 all KL = 0.224 +- 0.357 (in-sample avg dev_std = 0.374)
NEC for r=0.4 all L1 = 0.157 +- 0.245 (in-sample avg dev_std = 0.374)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.867
NEC for r=0.8 class 0.0 = 0.302 +- 0.366 (in-sample avg dev_std = 0.421)
NEC for r=0.8 class 1.0 = 0.077 +- 0.366 (in-sample avg dev_std = 0.421)
NEC for r=0.8 all KL = 0.258 +- 0.366 (in-sample avg dev_std = 0.421)
NEC for r=0.8 all L1 = 0.177 +- 0.250 (in-sample avg dev_std = 0.421)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008740800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.864
NEC for r=0.05 class 0.0 = 0.191 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.029 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.12 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.109 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.779
NEC for r=0.1 class 0.0 = 0.43 +- 0.434 (in-sample avg dev_std = 0.218)
NEC for r=0.1 class 1.0 = 0.084 +- 0.434 (in-sample avg dev_std = 0.218)
NEC for r=0.1 all KL = 0.316 +- 0.434 (in-sample avg dev_std = 0.218)
NEC for r=0.1 all L1 = 0.255 +- 0.357 (in-sample avg dev_std = 0.218)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096732
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.77
NEC for r=0.2 class 0.0 = 0.485 +- 0.458 (in-sample avg dev_std = 0.468)
NEC for r=0.2 class 1.0 = 0.106 +- 0.458 (in-sample avg dev_std = 0.468)
NEC for r=0.2 all KL = 0.421 +- 0.458 (in-sample avg dev_std = 0.468)
NEC for r=0.2 all L1 = 0.294 +- 0.338 (in-sample avg dev_std = 0.468)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009841200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.771
NEC for r=0.4 class 0.0 = 0.497 +- 0.458 (in-sample avg dev_std = 0.510)
NEC for r=0.4 class 1.0 = 0.111 +- 0.458 (in-sample avg dev_std = 0.510)
NEC for r=0.4 all KL = 0.445 +- 0.458 (in-sample avg dev_std = 0.510)
NEC for r=0.4 all L1 = 0.302 +- 0.331 (in-sample avg dev_std = 0.510)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009777
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.771
NEC for r=0.8 class 0.0 = 0.504 +- 0.455 (in-sample avg dev_std = 0.526)
NEC for r=0.8 class 1.0 = 0.114 +- 0.455 (in-sample avg dev_std = 0.526)
NEC for r=0.8 all KL = 0.456 +- 0.455 (in-sample avg dev_std = 0.526)
NEC for r=0.8 all L1 = 0.307 +- 0.329 (in-sample avg dev_std = 0.526)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0287986
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.71
NEC for r=0.05 class 0.0 = 0.039 +- 0.121 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.078 +- 0.121 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.121 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.058 +- 0.139 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.039788
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.713
NEC for r=0.1 class 0.0 = 0.059 +- 0.172 (in-sample avg dev_std = 0.024)
NEC for r=0.1 class 1.0 = 0.11 +- 0.172 (in-sample avg dev_std = 0.024)
NEC for r=0.1 all KL = 0.058 +- 0.172 (in-sample avg dev_std = 0.024)
NEC for r=0.1 all L1 = 0.084 +- 0.182 (in-sample avg dev_std = 0.024)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050878400000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.696
NEC for r=0.2 class 0.0 = 0.095 +- 0.219 (in-sample avg dev_std = 0.066)
NEC for r=0.2 class 1.0 = 0.131 +- 0.219 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all KL = 0.088 +- 0.219 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all L1 = 0.113 +- 0.214 (in-sample avg dev_std = 0.066)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0654224
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.674
NEC for r=0.4 class 0.0 = 0.14 +- 0.267 (in-sample avg dev_std = 0.148)
NEC for r=0.4 class 1.0 = 0.164 +- 0.267 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all KL = 0.137 +- 0.267 (in-sample avg dev_std = 0.148)
NEC for r=0.4 all L1 = 0.152 +- 0.241 (in-sample avg dev_std = 0.148)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.708
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0809076
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 0.0 = 0.173 +- 0.310 (in-sample avg dev_std = 0.226)
NEC for r=0.8 class 1.0 = 0.208 +- 0.310 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all KL = 0.195 +- 0.310 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all L1 = 0.19 +- 0.256 (in-sample avg dev_std = 0.226)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:37:56 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:37:56 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9880 0.9880[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.040
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.049
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.059
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.028
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.038
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04007000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.774
SUFF_SIMPLE for r=0.05 class 0.0 = 0.61 +- 0.401 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.794 +- 0.401 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.05 all KL = 0.62 +- 0.401 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.05 all L1 = 0.712 +- 0.293 (in-sample avg dev_std = 0.446)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048693999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.788
SUFF_SIMPLE for r=0.1 class 0.0 = 0.616 +- 0.402 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.798 +- 0.402 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.1 all KL = 0.624 +- 0.402 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.1 all L1 = 0.717 +- 0.290 (in-sample avg dev_std = 0.441)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059098
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.79
SUFF_SIMPLE for r=0.2 class 0.0 = 0.623 +- 0.398 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.796 +- 0.398 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.2 all KL = 0.626 +- 0.398 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.2 all L1 = 0.719 +- 0.288 (in-sample avg dev_std = 0.438)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073508
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.78
SUFF_SIMPLE for r=0.4 class 0.0 = 0.613 +- 0.404 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.819 +- 0.404 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 all KL = 0.649 +- 0.404 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 all L1 = 0.727 +- 0.299 (in-sample avg dev_std = 0.400)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080304
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.851
SUFF_SIMPLE for r=0.8 class 0.0 = 0.73 +- 0.364 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.906 +- 0.364 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.8 all KL = 0.794 +- 0.364 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.8 all L1 = 0.828 +- 0.280 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092758
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.695
SUFF_SIMPLE for r=0.05 class 0.0 = 0.583 +- 0.404 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.608 +- 0.404 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.05 all KL = 0.499 +- 0.404 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.05 all L1 = 0.595 +- 0.310 (in-sample avg dev_std = 0.495)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0095294
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.695
SUFF_SIMPLE for r=0.1 class 0.0 = 0.585 +- 0.404 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.607 +- 0.404 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.1 all KL = 0.5 +- 0.404 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.1 all L1 = 0.596 +- 0.309 (in-sample avg dev_std = 0.494)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0097084
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.689
SUFF_SIMPLE for r=0.2 class 0.0 = 0.581 +- 0.404 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.605 +- 0.404 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.2 all KL = 0.498 +- 0.404 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.2 all L1 = 0.593 +- 0.311 (in-sample avg dev_std = 0.487)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0097986
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.694
SUFF_SIMPLE for r=0.4 class 0.0 = 0.586 +- 0.410 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.611 +- 0.410 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 all KL = 0.507 +- 0.410 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 all L1 = 0.599 +- 0.315 (in-sample avg dev_std = 0.474)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0098394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.719
SUFF_SIMPLE for r=0.8 class 0.0 = 0.618 +- 0.420 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.682 +- 0.420 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all KL = 0.606 +- 0.420 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.8 all L1 = 0.65 +- 0.345 (in-sample avg dev_std = 0.190)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027963400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.591
SUFF_SIMPLE for r=0.05 class 0.0 = 0.82 +- 0.357 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.682 +- 0.357 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.05 all KL = 0.73 +- 0.357 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.05 all L1 = 0.752 +- 0.294 (in-sample avg dev_std = 0.234)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0377118
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.597
SUFF_SIMPLE for r=0.1 class 0.0 = 0.817 +- 0.356 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.688 +- 0.356 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.1 all KL = 0.731 +- 0.356 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.1 all L1 = 0.753 +- 0.294 (in-sample avg dev_std = 0.220)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0494224
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.604
SUFF_SIMPLE for r=0.2 class 0.0 = 0.811 +- 0.348 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.709 +- 0.348 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.2 all KL = 0.742 +- 0.348 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.2 all L1 = 0.761 +- 0.292 (in-sample avg dev_std = 0.206)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.063401
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.62
SUFF_SIMPLE for r=0.4 class 0.0 = 0.827 +- 0.332 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.736 +- 0.332 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.4 all KL = 0.777 +- 0.332 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.4 all L1 = 0.782 +- 0.290 (in-sample avg dev_std = 0.158)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079007
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.668
SUFF_SIMPLE for r=0.8 class 0.0 = 0.928 +- 0.229 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.839 +- 0.229 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all KL = 0.905 +- 0.229 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.8 all L1 = 0.884 +- 0.226 (in-sample avg dev_std = 0.005)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04007000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.97
NEC for r=0.05 class 0.0 = 0.057 +- 0.153 (in-sample avg dev_std = 0.009)
NEC for r=0.05 class 1.0 = 0.034 +- 0.153 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all KL = 0.036 +- 0.153 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all L1 = 0.044 +- 0.134 (in-sample avg dev_std = 0.009)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048693999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.948
NEC for r=0.1 class 0.0 = 0.123 +- 0.236 (in-sample avg dev_std = 0.153)
NEC for r=0.1 class 1.0 = 0.038 +- 0.236 (in-sample avg dev_std = 0.153)
NEC for r=0.1 all KL = 0.086 +- 0.236 (in-sample avg dev_std = 0.153)
NEC for r=0.1 all L1 = 0.076 +- 0.176 (in-sample avg dev_std = 0.153)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059098
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.91
NEC for r=0.2 class 0.0 = 0.168 +- 0.284 (in-sample avg dev_std = 0.218)
NEC for r=0.2 class 1.0 = 0.064 +- 0.284 (in-sample avg dev_std = 0.218)
NEC for r=0.2 all KL = 0.128 +- 0.284 (in-sample avg dev_std = 0.218)
NEC for r=0.2 all L1 = 0.11 +- 0.220 (in-sample avg dev_std = 0.218)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073508
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.896
NEC for r=0.4 class 0.0 = 0.197 +- 0.313 (in-sample avg dev_std = 0.323)
NEC for r=0.4 class 1.0 = 0.084 +- 0.313 (in-sample avg dev_std = 0.323)
NEC for r=0.4 all KL = 0.177 +- 0.313 (in-sample avg dev_std = 0.323)
NEC for r=0.4 all L1 = 0.135 +- 0.220 (in-sample avg dev_std = 0.323)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080304
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.9
NEC for r=0.8 class 0.0 = 0.211 +- 0.313 (in-sample avg dev_std = 0.356)
NEC for r=0.8 class 1.0 = 0.089 +- 0.313 (in-sample avg dev_std = 0.356)
NEC for r=0.8 all KL = 0.198 +- 0.313 (in-sample avg dev_std = 0.356)
NEC for r=0.8 all L1 = 0.144 +- 0.213 (in-sample avg dev_std = 0.356)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092758
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.912
NEC for r=0.05 class 0.0 = 0.077 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.161 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.08 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.12 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0095294
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.885
NEC for r=0.1 class 0.0 = 0.15 +- 0.296 (in-sample avg dev_std = 0.120)
NEC for r=0.1 class 1.0 = 0.212 +- 0.296 (in-sample avg dev_std = 0.120)
NEC for r=0.1 all KL = 0.168 +- 0.296 (in-sample avg dev_std = 0.120)
NEC for r=0.1 all L1 = 0.181 +- 0.264 (in-sample avg dev_std = 0.120)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0097084
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.872
NEC for r=0.2 class 0.0 = 0.196 +- 0.355 (in-sample avg dev_std = 0.338)
NEC for r=0.2 class 1.0 = 0.226 +- 0.355 (in-sample avg dev_std = 0.338)
NEC for r=0.2 all KL = 0.264 +- 0.355 (in-sample avg dev_std = 0.338)
NEC for r=0.2 all L1 = 0.211 +- 0.249 (in-sample avg dev_std = 0.338)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0097986
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.873
NEC for r=0.4 class 0.0 = 0.201 +- 0.363 (in-sample avg dev_std = 0.373)
NEC for r=0.4 class 1.0 = 0.234 +- 0.363 (in-sample avg dev_std = 0.373)
NEC for r=0.4 all KL = 0.294 +- 0.363 (in-sample avg dev_std = 0.373)
NEC for r=0.4 all L1 = 0.218 +- 0.240 (in-sample avg dev_std = 0.373)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0098394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.874
NEC for r=0.8 class 0.0 = 0.201 +- 0.363 (in-sample avg dev_std = 0.382)
NEC for r=0.8 class 1.0 = 0.234 +- 0.363 (in-sample avg dev_std = 0.382)
NEC for r=0.8 all KL = 0.301 +- 0.363 (in-sample avg dev_std = 0.382)
NEC for r=0.8 all L1 = 0.218 +- 0.236 (in-sample avg dev_std = 0.382)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027963400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.657
NEC for r=0.05 class 0.0 = 0.036 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.074 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.055 +- 0.137 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0377118
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.66
NEC for r=0.1 class 0.0 = 0.051 +- 0.159 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.11 +- 0.159 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.052 +- 0.159 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.08 +- 0.179 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0494224
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.653
NEC for r=0.2 class 0.0 = 0.079 +- 0.216 (in-sample avg dev_std = 0.050)
NEC for r=0.2 class 1.0 = 0.148 +- 0.216 (in-sample avg dev_std = 0.050)
NEC for r=0.2 all KL = 0.088 +- 0.216 (in-sample avg dev_std = 0.050)
NEC for r=0.2 all L1 = 0.113 +- 0.219 (in-sample avg dev_std = 0.050)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.063401
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.632
NEC for r=0.4 class 0.0 = 0.12 +- 0.262 (in-sample avg dev_std = 0.129)
NEC for r=0.4 class 1.0 = 0.179 +- 0.262 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all KL = 0.132 +- 0.262 (in-sample avg dev_std = 0.129)
NEC for r=0.4 all L1 = 0.149 +- 0.247 (in-sample avg dev_std = 0.129)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079007
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.608
NEC for r=0.8 class 0.0 = 0.14 +- 0.299 (in-sample avg dev_std = 0.214)
NEC for r=0.8 class 1.0 = 0.224 +- 0.299 (in-sample avg dev_std = 0.214)
NEC for r=0.8 all KL = 0.182 +- 0.299 (in-sample avg dev_std = 0.214)
NEC for r=0.8 all L1 = 0.182 +- 0.260 (in-sample avg dev_std = 0.214)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 07:56:14 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:56:14 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.034
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03444199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.728
SUFF_SIMPLE for r=0.05 class 0.0 = 0.54 +- 0.434 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.8 +- 0.434 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.05 all KL = 0.546 +- 0.434 (in-sample avg dev_std = 0.456)
SUFF_SIMPLE for r=0.05 all L1 = 0.684 +- 0.326 (in-sample avg dev_std = 0.456)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046655999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.729
SUFF_SIMPLE for r=0.1 class 0.0 = 0.535 +- 0.434 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.805 +- 0.434 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.1 all KL = 0.55 +- 0.434 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.1 all L1 = 0.685 +- 0.328 (in-sample avg dev_std = 0.444)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.723
SUFF_SIMPLE for r=0.2 class 0.0 = 0.531 +- 0.431 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.829 +- 0.431 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.2 all KL = 0.576 +- 0.431 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.2 all L1 = 0.696 +- 0.332 (in-sample avg dev_std = 0.421)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070048
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.711
SUFF_SIMPLE for r=0.4 class 0.0 = 0.53 +- 0.444 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.845 +- 0.444 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.4 all KL = 0.599 +- 0.444 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.4 all L1 = 0.704 +- 0.344 (in-sample avg dev_std = 0.401)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080336
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.794
SUFF_SIMPLE for r=0.8 class 0.0 = 0.66 +- 0.405 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.915 +- 0.405 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.8 all KL = 0.756 +- 0.405 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.8 all L1 = 0.801 +- 0.327 (in-sample avg dev_std = 0.196)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084298
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.613
SUFF_SIMPLE for r=0.05 class 0.0 = 0.662 +- 0.458 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.544 +- 0.458 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.05 all KL = 0.402 +- 0.458 (in-sample avg dev_std = 0.541)
SUFF_SIMPLE for r=0.05 all L1 = 0.603 +- 0.350 (in-sample avg dev_std = 0.541)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0089742
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.613
SUFF_SIMPLE for r=0.1 class 0.0 = 0.665 +- 0.458 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.543 +- 0.458 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.1 all KL = 0.405 +- 0.458 (in-sample avg dev_std = 0.539)
SUFF_SIMPLE for r=0.1 all L1 = 0.603 +- 0.351 (in-sample avg dev_std = 0.539)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009020199999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.614
SUFF_SIMPLE for r=0.2 class 0.0 = 0.666 +- 0.457 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.542 +- 0.457 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.2 all KL = 0.4 +- 0.457 (in-sample avg dev_std = 0.542)
SUFF_SIMPLE for r=0.2 all L1 = 0.604 +- 0.349 (in-sample avg dev_std = 0.542)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009419400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.615
SUFF_SIMPLE for r=0.4 class 0.0 = 0.669 +- 0.462 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.549 +- 0.462 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.4 all KL = 0.421 +- 0.462 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.4 all L1 = 0.609 +- 0.354 (in-sample avg dev_std = 0.521)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658199999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.633
SUFF_SIMPLE for r=0.8 class 0.0 = 0.674 +- 0.470 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.648 +- 0.470 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.8 all KL = 0.566 +- 0.470 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.8 all L1 = 0.661 +- 0.388 (in-sample avg dev_std = 0.217)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0259716
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.624
SUFF_SIMPLE for r=0.05 class 0.0 = 0.776 +- 0.385 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.696 +- 0.385 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.05 all KL = 0.68 +- 0.385 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.05 all L1 = 0.736 +- 0.300 (in-sample avg dev_std = 0.267)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368228
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.616
SUFF_SIMPLE for r=0.1 class 0.0 = 0.769 +- 0.385 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.713 +- 0.385 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.1 all KL = 0.685 +- 0.385 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.1 all L1 = 0.741 +- 0.303 (in-sample avg dev_std = 0.255)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500588
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.61
SUFF_SIMPLE for r=0.2 class 0.0 = 0.765 +- 0.375 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.739 +- 0.375 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all KL = 0.705 +- 0.375 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all L1 = 0.752 +- 0.309 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0645058
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.622
SUFF_SIMPLE for r=0.4 class 0.0 = 0.8 +- 0.358 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.764 +- 0.358 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.4 all KL = 0.752 +- 0.358 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.4 all L1 = 0.782 +- 0.301 (in-sample avg dev_std = 0.196)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.661
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07993779999999999
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.684
SUFF_SIMPLE for r=0.8 class 0.0 = 0.932 +- 0.256 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.842 +- 0.256 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.8 all KL = 0.896 +- 0.256 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.8 all L1 = 0.887 +- 0.237 (in-sample avg dev_std = 0.024)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03444199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.929
NEC for r=0.05 class 0.0 = 0.12 +- 0.240 (in-sample avg dev_std = 0.058)
NEC for r=0.05 class 1.0 = 0.027 +- 0.240 (in-sample avg dev_std = 0.058)
NEC for r=0.05 all KL = 0.076 +- 0.240 (in-sample avg dev_std = 0.058)
NEC for r=0.05 all L1 = 0.068 +- 0.201 (in-sample avg dev_std = 0.058)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046655999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.891
NEC for r=0.1 class 0.0 = 0.201 +- 0.332 (in-sample avg dev_std = 0.230)
NEC for r=0.1 class 1.0 = 0.047 +- 0.332 (in-sample avg dev_std = 0.230)
NEC for r=0.1 all KL = 0.149 +- 0.332 (in-sample avg dev_std = 0.230)
NEC for r=0.1 all L1 = 0.116 +- 0.249 (in-sample avg dev_std = 0.230)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.872
NEC for r=0.2 class 0.0 = 0.249 +- 0.367 (in-sample avg dev_std = 0.325)
NEC for r=0.2 class 1.0 = 0.065 +- 0.367 (in-sample avg dev_std = 0.325)
NEC for r=0.2 all KL = 0.208 +- 0.367 (in-sample avg dev_std = 0.325)
NEC for r=0.2 all L1 = 0.147 +- 0.260 (in-sample avg dev_std = 0.325)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070048
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.861
NEC for r=0.4 class 0.0 = 0.286 +- 0.380 (in-sample avg dev_std = 0.385)
NEC for r=0.4 class 1.0 = 0.066 +- 0.380 (in-sample avg dev_std = 0.385)
NEC for r=0.4 all KL = 0.251 +- 0.380 (in-sample avg dev_std = 0.385)
NEC for r=0.4 all L1 = 0.164 +- 0.260 (in-sample avg dev_std = 0.385)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080336
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.868
NEC for r=0.8 class 0.0 = 0.293 +- 0.376 (in-sample avg dev_std = 0.396)
NEC for r=0.8 class 1.0 = 0.072 +- 0.376 (in-sample avg dev_std = 0.396)
NEC for r=0.8 all KL = 0.266 +- 0.376 (in-sample avg dev_std = 0.396)
NEC for r=0.8 all L1 = 0.17 +- 0.256 (in-sample avg dev_std = 0.396)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084298
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.935
NEC for r=0.05 class 0.0 = 0.052 +- 0.217 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.077 +- 0.217 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.067 +- 0.217 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.064 +- 0.192 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0089742
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.844
NEC for r=0.1 class 0.0 = 0.179 +- 0.371 (in-sample avg dev_std = 0.175)
NEC for r=0.1 class 1.0 = 0.134 +- 0.371 (in-sample avg dev_std = 0.175)
NEC for r=0.1 all KL = 0.203 +- 0.371 (in-sample avg dev_std = 0.175)
NEC for r=0.1 all L1 = 0.156 +- 0.295 (in-sample avg dev_std = 0.175)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009020199999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.823
NEC for r=0.2 class 0.0 = 0.239 +- 0.430 (in-sample avg dev_std = 0.422)
NEC for r=0.2 class 1.0 = 0.163 +- 0.430 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all KL = 0.322 +- 0.430 (in-sample avg dev_std = 0.422)
NEC for r=0.2 all L1 = 0.201 +- 0.291 (in-sample avg dev_std = 0.422)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009419400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.821
NEC for r=0.4 class 0.0 = 0.249 +- 0.437 (in-sample avg dev_std = 0.464)
NEC for r=0.4 class 1.0 = 0.172 +- 0.437 (in-sample avg dev_std = 0.464)
NEC for r=0.4 all KL = 0.351 +- 0.437 (in-sample avg dev_std = 0.464)
NEC for r=0.4 all L1 = 0.21 +- 0.287 (in-sample avg dev_std = 0.464)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658199999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.82
NEC for r=0.8 class 0.0 = 0.252 +- 0.438 (in-sample avg dev_std = 0.484)
NEC for r=0.8 class 1.0 = 0.178 +- 0.438 (in-sample avg dev_std = 0.484)
NEC for r=0.8 all KL = 0.371 +- 0.438 (in-sample avg dev_std = 0.484)
NEC for r=0.8 all L1 = 0.215 +- 0.282 (in-sample avg dev_std = 0.484)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0259716
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.668
NEC for r=0.05 class 0.0 = 0.035 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.073 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.033 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.054 +- 0.143 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368228
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.671
NEC for r=0.1 class 0.0 = 0.052 +- 0.190 (in-sample avg dev_std = 0.008)
NEC for r=0.1 class 1.0 = 0.109 +- 0.190 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all KL = 0.063 +- 0.190 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all L1 = 0.08 +- 0.191 (in-sample avg dev_std = 0.008)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500588
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.657
NEC for r=0.2 class 0.0 = 0.083 +- 0.236 (in-sample avg dev_std = 0.078)
NEC for r=0.2 class 1.0 = 0.133 +- 0.236 (in-sample avg dev_std = 0.078)
NEC for r=0.2 all KL = 0.095 +- 0.236 (in-sample avg dev_std = 0.078)
NEC for r=0.2 all L1 = 0.108 +- 0.226 (in-sample avg dev_std = 0.078)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0645058
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.635
NEC for r=0.4 class 0.0 = 0.137 +- 0.293 (in-sample avg dev_std = 0.162)
NEC for r=0.4 class 1.0 = 0.166 +- 0.293 (in-sample avg dev_std = 0.162)
NEC for r=0.4 all KL = 0.153 +- 0.293 (in-sample avg dev_std = 0.162)
NEC for r=0.4 all L1 = 0.151 +- 0.259 (in-sample avg dev_std = 0.162)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07993779999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.629
NEC for r=0.8 class 0.0 = 0.171 +- 0.333 (in-sample avg dev_std = 0.241)
NEC for r=0.8 class 1.0 = 0.216 +- 0.333 (in-sample avg dev_std = 0.241)
NEC for r=0.8 all KL = 0.221 +- 0.333 (in-sample avg dev_std = 0.241)
NEC for r=0.8 all L1 = 0.193 +- 0.273 (in-sample avg dev_std = 0.241)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 08:11:23 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:11:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.060
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03541
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.721
SUFF_SIMPLE for r=0.05 class 0.0 = 0.553 +- 0.402 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.77 +- 0.402 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.05 all KL = 0.589 +- 0.402 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.05 all L1 = 0.673 +- 0.309 (in-sample avg dev_std = 0.426)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04666200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.734
SUFF_SIMPLE for r=0.1 class 0.0 = 0.556 +- 0.405 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.785 +- 0.405 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.1 all KL = 0.609 +- 0.405 (in-sample avg dev_std = 0.405)
SUFF_SIMPLE for r=0.1 all L1 = 0.683 +- 0.312 (in-sample avg dev_std = 0.405)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059781999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.734
SUFF_SIMPLE for r=0.2 class 0.0 = 0.556 +- 0.409 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.785 +- 0.409 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all KL = 0.613 +- 0.409 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all L1 = 0.683 +- 0.316 (in-sample avg dev_std = 0.404)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070386
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.733
SUFF_SIMPLE for r=0.4 class 0.0 = 0.554 +- 0.414 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.794 +- 0.414 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.4 all KL = 0.622 +- 0.414 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.4 all L1 = 0.687 +- 0.319 (in-sample avg dev_std = 0.393)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07937000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.769
SUFF_SIMPLE for r=0.8 class 0.0 = 0.614 +- 0.401 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.87 +- 0.401 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.8 all KL = 0.733 +- 0.401 (in-sample avg dev_std = 0.194)
SUFF_SIMPLE for r=0.8 all L1 = 0.756 +- 0.331 (in-sample avg dev_std = 0.194)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090016
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.616
SUFF_SIMPLE for r=0.05 class 0.0 = 0.684 +- 0.408 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.599 +- 0.408 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.05 all KL = 0.552 +- 0.408 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.05 all L1 = 0.641 +- 0.303 (in-sample avg dev_std = 0.415)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094584
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.617
SUFF_SIMPLE for r=0.1 class 0.0 = 0.684 +- 0.409 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.599 +- 0.409 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.1 all KL = 0.552 +- 0.409 (in-sample avg dev_std = 0.413)
SUFF_SIMPLE for r=0.1 all L1 = 0.642 +- 0.304 (in-sample avg dev_std = 0.413)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095112
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.617
SUFF_SIMPLE for r=0.2 class 0.0 = 0.684 +- 0.409 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.601 +- 0.409 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.2 all KL = 0.555 +- 0.409 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.2 all L1 = 0.642 +- 0.305 (in-sample avg dev_std = 0.408)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096676
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.618
SUFF_SIMPLE for r=0.4 class 0.0 = 0.685 +- 0.409 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.604 +- 0.409 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 all KL = 0.557 +- 0.409 (in-sample avg dev_std = 0.400)
SUFF_SIMPLE for r=0.4 all L1 = 0.644 +- 0.307 (in-sample avg dev_std = 0.400)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097348
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.634
SUFF_SIMPLE for r=0.8 class 0.0 = 0.69 +- 0.416 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.671 +- 0.416 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 all KL = 0.636 +- 0.416 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 all L1 = 0.68 +- 0.330 (in-sample avg dev_std = 0.149)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266952
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.614
SUFF_SIMPLE for r=0.05 class 0.0 = 0.819 +- 0.359 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.7 +- 0.359 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 all KL = 0.738 +- 0.359 (in-sample avg dev_std = 0.246)
SUFF_SIMPLE for r=0.05 all L1 = 0.76 +- 0.292 (in-sample avg dev_std = 0.246)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0369208
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.615
SUFF_SIMPLE for r=0.1 class 0.0 = 0.822 +- 0.356 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.704 +- 0.356 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 all KL = 0.744 +- 0.356 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.1 all L1 = 0.764 +- 0.292 (in-sample avg dev_std = 0.235)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0488942
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.621
SUFF_SIMPLE for r=0.2 class 0.0 = 0.824 +- 0.348 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.725 +- 0.348 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.348 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.2 all L1 = 0.775 +- 0.289 (in-sample avg dev_std = 0.215)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0633258
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.633
SUFF_SIMPLE for r=0.4 class 0.0 = 0.831 +- 0.326 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.763 +- 0.326 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.4 all KL = 0.793 +- 0.326 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.4 all L1 = 0.798 +- 0.280 (in-sample avg dev_std = 0.178)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.686
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791104
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.696
SUFF_SIMPLE for r=0.8 class 0.0 = 0.921 +- 0.223 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.86 +- 0.223 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.8 all KL = 0.912 +- 0.223 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.8 all L1 = 0.89 +- 0.219 (in-sample avg dev_std = 0.025)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03541
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.914
NEC for r=0.05 class 0.0 = 0.178 +- 0.256 (in-sample avg dev_std = 0.045)
NEC for r=0.05 class 1.0 = 0.032 +- 0.256 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all KL = 0.089 +- 0.256 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all L1 = 0.097 +- 0.223 (in-sample avg dev_std = 0.045)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04666200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.882
NEC for r=0.1 class 0.0 = 0.234 +- 0.308 (in-sample avg dev_std = 0.203)
NEC for r=0.1 class 1.0 = 0.058 +- 0.308 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all KL = 0.142 +- 0.308 (in-sample avg dev_std = 0.203)
NEC for r=0.1 all L1 = 0.136 +- 0.251 (in-sample avg dev_std = 0.203)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059781999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.841
NEC for r=0.2 class 0.0 = 0.313 +- 0.361 (in-sample avg dev_std = 0.332)
NEC for r=0.2 class 1.0 = 0.075 +- 0.361 (in-sample avg dev_std = 0.332)
NEC for r=0.2 all KL = 0.211 +- 0.361 (in-sample avg dev_std = 0.332)
NEC for r=0.2 all L1 = 0.181 +- 0.274 (in-sample avg dev_std = 0.332)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070386
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.854
NEC for r=0.4 class 0.0 = 0.313 +- 0.358 (in-sample avg dev_std = 0.380)
NEC for r=0.4 class 1.0 = 0.093 +- 0.358 (in-sample avg dev_std = 0.380)
NEC for r=0.4 all KL = 0.234 +- 0.358 (in-sample avg dev_std = 0.380)
NEC for r=0.4 all L1 = 0.191 +- 0.262 (in-sample avg dev_std = 0.380)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07937000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.846
NEC for r=0.8 class 0.0 = 0.32 +- 0.358 (in-sample avg dev_std = 0.403)
NEC for r=0.8 class 1.0 = 0.103 +- 0.358 (in-sample avg dev_std = 0.403)
NEC for r=0.8 all KL = 0.258 +- 0.358 (in-sample avg dev_std = 0.403)
NEC for r=0.8 all L1 = 0.2 +- 0.257 (in-sample avg dev_std = 0.403)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090016
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.869
NEC for r=0.05 class 0.0 = 0.039 +- 0.158 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.115 +- 0.158 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.047 +- 0.158 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.077 +- 0.154 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094584
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.805
NEC for r=0.1 class 0.0 = 0.131 +- 0.298 (in-sample avg dev_std = 0.104)
NEC for r=0.1 class 1.0 = 0.173 +- 0.298 (in-sample avg dev_std = 0.104)
NEC for r=0.1 all KL = 0.148 +- 0.298 (in-sample avg dev_std = 0.104)
NEC for r=0.1 all L1 = 0.152 +- 0.236 (in-sample avg dev_std = 0.104)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095112
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.792
NEC for r=0.2 class 0.0 = 0.176 +- 0.356 (in-sample avg dev_std = 0.322)
NEC for r=0.2 class 1.0 = 0.193 +- 0.356 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all KL = 0.233 +- 0.356 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all L1 = 0.184 +- 0.229 (in-sample avg dev_std = 0.322)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096676
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.794
NEC for r=0.4 class 0.0 = 0.179 +- 0.362 (in-sample avg dev_std = 0.354)
NEC for r=0.4 class 1.0 = 0.196 +- 0.362 (in-sample avg dev_std = 0.354)
NEC for r=0.4 all KL = 0.251 +- 0.362 (in-sample avg dev_std = 0.354)
NEC for r=0.4 all L1 = 0.187 +- 0.217 (in-sample avg dev_std = 0.354)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097348
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.795
NEC for r=0.8 class 0.0 = 0.183 +- 0.364 (in-sample avg dev_std = 0.374)
NEC for r=0.8 class 1.0 = 0.199 +- 0.364 (in-sample avg dev_std = 0.374)
NEC for r=0.8 all KL = 0.261 +- 0.364 (in-sample avg dev_std = 0.374)
NEC for r=0.8 all L1 = 0.192 +- 0.214 (in-sample avg dev_std = 0.374)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266952
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.683
NEC for r=0.05 class 0.0 = 0.04 +- 0.112 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.066 +- 0.112 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.027 +- 0.112 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.053 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0369208
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.687
NEC for r=0.1 class 0.0 = 0.058 +- 0.162 (in-sample avg dev_std = 0.008)
NEC for r=0.1 class 1.0 = 0.099 +- 0.162 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all KL = 0.052 +- 0.162 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all L1 = 0.078 +- 0.174 (in-sample avg dev_std = 0.008)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0488942
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.673
NEC for r=0.2 class 0.0 = 0.093 +- 0.207 (in-sample avg dev_std = 0.066)
NEC for r=0.2 class 1.0 = 0.124 +- 0.207 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all KL = 0.083 +- 0.207 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all L1 = 0.108 +- 0.210 (in-sample avg dev_std = 0.066)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0633258
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.652
NEC for r=0.4 class 0.0 = 0.127 +- 0.257 (in-sample avg dev_std = 0.144)
NEC for r=0.4 class 1.0 = 0.159 +- 0.257 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all KL = 0.127 +- 0.257 (in-sample avg dev_std = 0.144)
NEC for r=0.4 all L1 = 0.143 +- 0.237 (in-sample avg dev_std = 0.144)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.685
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791104
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.626
NEC for r=0.8 class 0.0 = 0.142 +- 0.303 (in-sample avg dev_std = 0.217)
NEC for r=0.8 class 1.0 = 0.206 +- 0.303 (in-sample avg dev_std = 0.217)
NEC for r=0.8 all KL = 0.177 +- 0.303 (in-sample avg dev_std = 0.217)
NEC for r=0.8 all L1 = 0.174 +- 0.256 (in-sample avg dev_std = 0.217)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 08:26:38 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:26:38 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mChartInfo 0.9780 0.9780 0.9780 0.9780 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.039
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.057
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.038
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03925800000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.756
SUFF_SIMPLE for r=0.05 class 0.0 = 0.631 +- 0.393 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.77 +- 0.393 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.05 all KL = 0.629 +- 0.393 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.05 all L1 = 0.708 +- 0.289 (in-sample avg dev_std = 0.433)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.049506
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.749
SUFF_SIMPLE for r=0.1 class 0.0 = 0.628 +- 0.398 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.773 +- 0.398 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.1 all KL = 0.629 +- 0.398 (in-sample avg dev_std = 0.426)
SUFF_SIMPLE for r=0.1 all L1 = 0.708 +- 0.293 (in-sample avg dev_std = 0.426)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.752
SUFF_SIMPLE for r=0.2 class 0.0 = 0.622 +- 0.399 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.776 +- 0.399 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.2 all KL = 0.631 +- 0.399 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.2 all L1 = 0.707 +- 0.295 (in-sample avg dev_std = 0.431)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.068316
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.773
SUFF_SIMPLE for r=0.4 class 0.0 = 0.628 +- 0.396 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.815 +- 0.396 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.4 all KL = 0.67 +- 0.396 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.4 all L1 = 0.731 +- 0.298 (in-sample avg dev_std = 0.382)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077988
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.815
SUFF_SIMPLE for r=0.8 class 0.0 = 0.693 +- 0.375 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.891 +- 0.375 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all KL = 0.783 +- 0.375 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all L1 = 0.802 +- 0.301 (in-sample avg dev_std = 0.238)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081226
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.591
SUFF_SIMPLE for r=0.05 class 0.0 = 0.867 +- 0.348 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.729 +- 0.348 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 all KL = 0.737 +- 0.348 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 all L1 = 0.797 +- 0.250 (in-sample avg dev_std = 0.290)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0086932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.593
SUFF_SIMPLE for r=0.1 class 0.0 = 0.866 +- 0.349 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.731 +- 0.349 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 all KL = 0.738 +- 0.349 (in-sample avg dev_std = 0.294)
SUFF_SIMPLE for r=0.1 all L1 = 0.798 +- 0.249 (in-sample avg dev_std = 0.294)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091848
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.592
SUFF_SIMPLE for r=0.2 class 0.0 = 0.868 +- 0.349 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.731 +- 0.349 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.2 all KL = 0.738 +- 0.349 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.2 all L1 = 0.799 +- 0.250 (in-sample avg dev_std = 0.287)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.593
SUFF_SIMPLE for r=0.4 class 0.0 = 0.868 +- 0.349 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.731 +- 0.349 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.4 all KL = 0.741 +- 0.349 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.4 all L1 = 0.799 +- 0.251 (in-sample avg dev_std = 0.277)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.601
SUFF_SIMPLE for r=0.8 class 0.0 = 0.882 +- 0.333 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.766 +- 0.333 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all KL = 0.793 +- 0.333 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.8 all L1 = 0.824 +- 0.256 (in-sample avg dev_std = 0.093)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027093799999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.6
SUFF_SIMPLE for r=0.05 class 0.0 = 0.827 +- 0.354 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.691 +- 0.354 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.05 all KL = 0.744 +- 0.354 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.05 all L1 = 0.76 +- 0.288 (in-sample avg dev_std = 0.251)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0379552
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.601
SUFF_SIMPLE for r=0.1 class 0.0 = 0.827 +- 0.352 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.694 +- 0.352 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.1 all KL = 0.748 +- 0.352 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.1 all L1 = 0.762 +- 0.288 (in-sample avg dev_std = 0.239)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500464
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.602
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.350 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.704 +- 0.350 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.2 all KL = 0.755 +- 0.350 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.2 all L1 = 0.767 +- 0.289 (in-sample avg dev_std = 0.219)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0653638
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.617
SUFF_SIMPLE for r=0.4 class 0.0 = 0.837 +- 0.333 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.741 +- 0.333 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.333 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 all L1 = 0.789 +- 0.284 (in-sample avg dev_std = 0.176)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07935
len(reference) = 4983
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.675
SUFF_SIMPLE for r=0.8 class 0.0 = 0.921 +- 0.232 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.846 +- 0.232 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.8 all KL = 0.906 +- 0.232 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.8 all L1 = 0.884 +- 0.226 (in-sample avg dev_std = 0.009)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03925800000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.944
NEC for r=0.05 class 0.0 = 0.081 +- 0.203 (in-sample avg dev_std = 0.003)
NEC for r=0.05 class 1.0 = 0.048 +- 0.203 (in-sample avg dev_std = 0.003)
NEC for r=0.05 all KL = 0.055 +- 0.203 (in-sample avg dev_std = 0.003)
NEC for r=0.05 all L1 = 0.063 +- 0.174 (in-sample avg dev_std = 0.003)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.049506
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.921
NEC for r=0.1 class 0.0 = 0.135 +- 0.259 (in-sample avg dev_std = 0.160)
NEC for r=0.1 class 1.0 = 0.063 +- 0.259 (in-sample avg dev_std = 0.160)
NEC for r=0.1 all KL = 0.096 +- 0.259 (in-sample avg dev_std = 0.160)
NEC for r=0.1 all L1 = 0.095 +- 0.203 (in-sample avg dev_std = 0.160)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.899
NEC for r=0.2 class 0.0 = 0.197 +- 0.310 (in-sample avg dev_std = 0.287)
NEC for r=0.2 class 1.0 = 0.084 +- 0.310 (in-sample avg dev_std = 0.287)
NEC for r=0.2 all KL = 0.158 +- 0.310 (in-sample avg dev_std = 0.287)
NEC for r=0.2 all L1 = 0.134 +- 0.226 (in-sample avg dev_std = 0.287)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.068316
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.886
NEC for r=0.4 class 0.0 = 0.229 +- 0.326 (in-sample avg dev_std = 0.356)
NEC for r=0.4 class 1.0 = 0.093 +- 0.326 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all KL = 0.198 +- 0.326 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all L1 = 0.154 +- 0.223 (in-sample avg dev_std = 0.356)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077988
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.878
NEC for r=0.8 class 0.0 = 0.221 +- 0.323 (in-sample avg dev_std = 0.369)
NEC for r=0.8 class 1.0 = 0.115 +- 0.323 (in-sample avg dev_std = 0.369)
NEC for r=0.8 all KL = 0.207 +- 0.323 (in-sample avg dev_std = 0.369)
NEC for r=0.8 all L1 = 0.162 +- 0.228 (in-sample avg dev_std = 0.369)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081226
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.637
NEC for r=0.05 class 0.0 = 0.004 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.132 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.034 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.068 +- 0.139 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0086932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.641
NEC for r=0.1 class 0.0 = 0.025 +- 0.193 (in-sample avg dev_std = 0.050)
NEC for r=0.1 class 1.0 = 0.173 +- 0.193 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all KL = 0.078 +- 0.193 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all L1 = 0.099 +- 0.181 (in-sample avg dev_std = 0.050)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091848
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.64
NEC for r=0.2 class 0.0 = 0.04 +- 0.239 (in-sample avg dev_std = 0.190)
NEC for r=0.2 class 1.0 = 0.189 +- 0.239 (in-sample avg dev_std = 0.190)
NEC for r=0.2 all KL = 0.118 +- 0.239 (in-sample avg dev_std = 0.190)
NEC for r=0.2 all L1 = 0.115 +- 0.179 (in-sample avg dev_std = 0.190)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.641
NEC for r=0.4 class 0.0 = 0.039 +- 0.248 (in-sample avg dev_std = 0.210)
NEC for r=0.4 class 1.0 = 0.191 +- 0.248 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all KL = 0.131 +- 0.248 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all L1 = 0.116 +- 0.170 (in-sample avg dev_std = 0.210)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.64
NEC for r=0.8 class 0.0 = 0.04 +- 0.247 (in-sample avg dev_std = 0.218)
NEC for r=0.8 class 1.0 = 0.191 +- 0.247 (in-sample avg dev_std = 0.218)
NEC for r=0.8 all KL = 0.132 +- 0.247 (in-sample avg dev_std = 0.218)
NEC for r=0.8 all L1 = 0.116 +- 0.169 (in-sample avg dev_std = 0.218)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027093799999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.662
NEC for r=0.05 class 0.0 = 0.038 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.073 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.055 +- 0.137 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0379552
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.663
NEC for r=0.1 class 0.0 = 0.055 +- 0.160 (in-sample avg dev_std = 0.003)
NEC for r=0.1 class 1.0 = 0.106 +- 0.160 (in-sample avg dev_std = 0.003)
NEC for r=0.1 all KL = 0.052 +- 0.160 (in-sample avg dev_std = 0.003)
NEC for r=0.1 all L1 = 0.08 +- 0.176 (in-sample avg dev_std = 0.003)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500464
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.653
NEC for r=0.2 class 0.0 = 0.087 +- 0.215 (in-sample avg dev_std = 0.067)
NEC for r=0.2 class 1.0 = 0.136 +- 0.215 (in-sample avg dev_std = 0.067)
NEC for r=0.2 all KL = 0.087 +- 0.215 (in-sample avg dev_std = 0.067)
NEC for r=0.2 all L1 = 0.112 +- 0.216 (in-sample avg dev_std = 0.067)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0653638
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.635
NEC for r=0.4 class 0.0 = 0.123 +- 0.261 (in-sample avg dev_std = 0.147)
NEC for r=0.4 class 1.0 = 0.172 +- 0.261 (in-sample avg dev_std = 0.147)
NEC for r=0.4 all KL = 0.131 +- 0.261 (in-sample avg dev_std = 0.147)
NEC for r=0.4 all L1 = 0.147 +- 0.241 (in-sample avg dev_std = 0.147)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.659
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07935
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.611
NEC for r=0.8 class 0.0 = 0.139 +- 0.298 (in-sample avg dev_std = 0.226)
NEC for r=0.8 class 1.0 = 0.214 +- 0.298 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all KL = 0.174 +- 0.298 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all L1 = 0.176 +- 0.252 (in-sample avg dev_std = 0.226)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.551, 0.557, 0.572, 0.586, 0.74], 'all_L1': [0.669, 0.671, 0.678, 0.685, 0.79]}), defaultdict(<class 'list'>, {'all_KL': [0.593, 0.606, 0.601, 0.632, 0.769], 'all_L1': [0.712, 0.716, 0.718, 0.73, 0.816]}), defaultdict(<class 'list'>, {'all_KL': [0.601, 0.608, 0.596, 0.606, 0.745], 'all_L1': [0.681, 0.684, 0.674, 0.676, 0.771]}), defaultdict(<class 'list'>, {'all_KL': [0.593, 0.592, 0.605, 0.629, 0.742], 'all_L1': [0.69, 0.683, 0.69, 0.703, 0.771]}), defaultdict(<class 'list'>, {'all_KL': [0.626, 0.614, 0.615, 0.631, 0.774], 'all_L1': [0.697, 0.695, 0.694, 0.701, 0.794]}), defaultdict(<class 'list'>, {'all_KL': [0.567, 0.579, 0.586, 0.593, 0.747], 'all_L1': [0.689, 0.692, 0.7, 0.696, 0.786]}), defaultdict(<class 'list'>, {'all_KL': [0.62, 0.624, 0.626, 0.649, 0.794], 'all_L1': [0.712, 0.717, 0.719, 0.727, 0.828]}), defaultdict(<class 'list'>, {'all_KL': [0.546, 0.55, 0.576, 0.599, 0.756], 'all_L1': [0.684, 0.685, 0.696, 0.704, 0.801]}), defaultdict(<class 'list'>, {'all_KL': [0.589, 0.609, 0.613, 0.622, 0.733], 'all_L1': [0.673, 0.683, 0.683, 0.687, 0.756]}), defaultdict(<class 'list'>, {'all_KL': [0.629, 0.629, 0.631, 0.67, 0.783], 'all_L1': [0.708, 0.708, 0.707, 0.731, 0.802]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.061, 0.128, 0.19, 0.244, 0.25], 'all_L1': [0.06, 0.101, 0.144, 0.172, 0.175]}), defaultdict(<class 'list'>, {'all_KL': [0.04, 0.087, 0.15, 0.191, 0.222], 'all_L1': [0.042, 0.073, 0.11, 0.133, 0.147]}), defaultdict(<class 'list'>, {'all_KL': [0.081, 0.125, 0.192, 0.242, 0.264], 'all_L1': [0.083, 0.112, 0.152, 0.182, 0.199]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.132, 0.18, 0.227, 0.247], 'all_L1': [0.075, 0.118, 0.146, 0.172, 0.183]}), defaultdict(<class 'list'>, {'all_KL': [0.05, 0.123, 0.174, 0.198, 0.218], 'all_L1': [0.064, 0.122, 0.154, 0.166, 0.176]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.116, 0.187, 0.224, 0.258], 'all_L1': [0.063, 0.097, 0.139, 0.157, 0.177]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.086, 0.128, 0.177, 0.198], 'all_L1': [0.044, 0.076, 0.11, 0.135, 0.144]}), defaultdict(<class 'list'>, {'all_KL': [0.076, 0.149, 0.208, 0.251, 0.266], 'all_L1': [0.068, 0.116, 0.147, 0.164, 0.17]}), defaultdict(<class 'list'>, {'all_KL': [0.089, 0.142, 0.211, 0.234, 0.258], 'all_L1': [0.097, 0.136, 0.181, 0.191, 0.2]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.096, 0.158, 0.198, 0.207], 'all_L1': [0.063, 0.095, 0.134, 0.154, 0.162]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.244, 0.244, 0.246, 0.259, 0.397], 'all_L1': [0.447, 0.448, 0.448, 0.455, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.531, 0.529, 0.534, 0.537, 0.645], 'all_L1': [0.648, 0.648, 0.649, 0.652, 0.7]}), defaultdict(<class 'list'>, {'all_KL': [0.623, 0.621, 0.619, 0.629, 0.688], 'all_L1': [0.693, 0.692, 0.69, 0.698, 0.724]}), defaultdict(<class 'list'>, {'all_KL': [0.617, 0.616, 0.617, 0.621, 0.69], 'all_L1': [0.702, 0.701, 0.703, 0.704, 0.735]}), defaultdict(<class 'list'>, {'all_KL': [0.637, 0.634, 0.638, 0.643, 0.739], 'all_L1': [0.728, 0.727, 0.729, 0.73, 0.769]}), defaultdict(<class 'list'>, {'all_KL': [0.309, 0.313, 0.32, 0.324, 0.455], 'all_L1': [0.509, 0.511, 0.514, 0.514, 0.561]}), defaultdict(<class 'list'>, {'all_KL': [0.499, 0.5, 0.498, 0.507, 0.606], 'all_L1': [0.595, 0.596, 0.593, 0.599, 0.65]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.405, 0.4, 0.421, 0.566], 'all_L1': [0.603, 0.603, 0.604, 0.609, 0.661]}), defaultdict(<class 'list'>, {'all_KL': [0.552, 0.552, 0.555, 0.557, 0.636], 'all_L1': [0.641, 0.642, 0.642, 0.644, 0.68]}), defaultdict(<class 'list'>, {'all_KL': [0.737, 0.738, 0.738, 0.741, 0.793], 'all_L1': [0.797, 0.798, 0.799, 0.799, 0.824]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.116, 0.323, 0.44, 0.464, 0.473], 'all_L1': [0.101, 0.251, 0.3, 0.312, 0.315]}), defaultdict(<class 'list'>, {'all_KL': [0.052, 0.145, 0.245, 0.27, 0.279], 'all_L1': [0.081, 0.143, 0.174, 0.179, 0.181]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.156, 0.233, 0.249, 0.253], 'all_L1': [0.082, 0.152, 0.181, 0.187, 0.189]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.144, 0.22, 0.234, 0.246], 'all_L1': [0.104, 0.154, 0.185, 0.187, 0.189]}), defaultdict(<class 'list'>, {'all_KL': [0.068, 0.119, 0.182, 0.206, 0.216], 'all_L1': [0.094, 0.133, 0.158, 0.164, 0.166]}), defaultdict(<class 'list'>, {'all_KL': [0.12, 0.316, 0.421, 0.445, 0.456], 'all_L1': [0.109, 0.255, 0.294, 0.302, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.08, 0.168, 0.264, 0.294, 0.301], 'all_L1': [0.12, 0.181, 0.211, 0.218, 0.218]}), defaultdict(<class 'list'>, {'all_KL': [0.067, 0.203, 0.322, 0.351, 0.371], 'all_L1': [0.064, 0.156, 0.201, 0.21, 0.215]}), defaultdict(<class 'list'>, {'all_KL': [0.047, 0.148, 0.233, 0.251, 0.261], 'all_L1': [0.077, 0.152, 0.184, 0.187, 0.192]}), defaultdict(<class 'list'>, {'all_KL': [0.034, 0.078, 0.118, 0.131, 0.132], 'all_L1': [0.068, 0.099, 0.115, 0.116, 0.116]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.719, 0.723, 0.733, 0.772, 0.905], 'all_L1': [0.745, 0.749, 0.755, 0.78, 0.886]}), defaultdict(<class 'list'>, {'all_KL': [0.713, 0.709, 0.721, 0.773, 0.895], 'all_L1': [0.748, 0.746, 0.755, 0.786, 0.882]}), defaultdict(<class 'list'>, {'all_KL': [0.723, 0.727, 0.747, 0.778, 0.902], 'all_L1': [0.753, 0.756, 0.771, 0.788, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.743, 0.749, 0.757, 0.782, 0.903], 'all_L1': [0.77, 0.774, 0.781, 0.8, 0.889]}), defaultdict(<class 'list'>, {'all_KL': [0.738, 0.739, 0.747, 0.77, 0.894], 'all_L1': [0.753, 0.753, 0.759, 0.775, 0.873]}), defaultdict(<class 'list'>, {'all_KL': [0.71, 0.711, 0.719, 0.767, 0.895], 'all_L1': [0.738, 0.739, 0.747, 0.776, 0.875]}), defaultdict(<class 'list'>, {'all_KL': [0.73, 0.731, 0.742, 0.777, 0.905], 'all_L1': [0.752, 0.753, 0.761, 0.782, 0.884]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.685, 0.705, 0.752, 0.896], 'all_L1': [0.736, 0.741, 0.752, 0.782, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.738, 0.744, 0.758, 0.793, 0.912], 'all_L1': [0.76, 0.764, 0.775, 0.798, 0.89]}), defaultdict(<class 'list'>, {'all_KL': [0.744, 0.748, 0.755, 0.786, 0.906], 'all_L1': [0.76, 0.762, 0.767, 0.789, 0.884]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.028, 0.053, 0.089, 0.143, 0.193], 'all_L1': [0.054, 0.079, 0.112, 0.156, 0.187]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.059, 0.088, 0.14, 0.197], 'all_L1': [0.056, 0.081, 0.108, 0.148, 0.184]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.057, 0.095, 0.14, 0.192], 'all_L1': [0.055, 0.08, 0.115, 0.15, 0.181]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.057, 0.097, 0.143, 0.185], 'all_L1': [0.053, 0.077, 0.111, 0.146, 0.173]}), defaultdict(<class 'list'>, {'all_KL': [0.03, 0.058, 0.096, 0.147, 0.176], 'all_L1': [0.059, 0.087, 0.122, 0.161, 0.18]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.058, 0.088, 0.137, 0.195], 'all_L1': [0.058, 0.084, 0.113, 0.152, 0.19]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.052, 0.088, 0.132, 0.182], 'all_L1': [0.055, 0.08, 0.113, 0.149, 0.182]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.063, 0.095, 0.153, 0.221], 'all_L1': [0.054, 0.08, 0.108, 0.151, 0.193]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.052, 0.083, 0.127, 0.177], 'all_L1': [0.053, 0.078, 0.108, 0.143, 0.174]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.052, 0.087, 0.131, 0.174], 'all_L1': [0.055, 0.08, 0.112, 0.147, 0.176]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.692 +- 0.015, 0.693 +- 0.015, 0.696 +- 0.015, 0.704 +- 0.019, 0.792 +- 0.021
suff_simple class all_KL  =  0.591 +- 0.028, 0.597 +- 0.026, 0.602 +- 0.019, 0.622 +- 0.025, 0.758 +- 0.019
[[0.7095000147819519, 0.7092499732971191, 0.7137500047683716, 0.7239999771118164, 0.793749988079071], [0.7767500281333923, 0.7745000123977661, 0.7817500233650208, 0.7807499766349792, 0.8372499942779541], [0.7239999771118164, 0.7202500104904175, 0.7167500257492065, 0.7045000195503235, 0.768750011920929], [0.7392500042915344, 0.7267500162124634, 0.734250009059906, 0.7452499866485596, 0.7942500114440918], [0.753000020980835, 0.7459999918937683, 0.7437499761581421, 0.7524999976158142, 0.8140000104904175], [0.7394999861717224, 0.7437499761581421, 0.762499988079071, 0.7292500138282776, 0.7929999828338623], [0.7735000252723694, 0.7877500057220459, 0.7904999852180481, 0.7795000076293945, 0.8514999747276306], [0.7275000214576721, 0.7292500138282776, 0.7227500081062317, 0.7112500071525574, 0.7940000295639038], [0.7212499976158142, 0.734000027179718, 0.7337499856948853, 0.7332500219345093, 0.768750011920929], [0.7559999823570251, 0.7492499947547913, 0.7515000104904175, 0.7727500200271606, 0.8152499794960022]]
[[0.551, 0.557, 0.572, 0.586, 0.74], [0.593, 0.606, 0.601, 0.632, 0.769], [0.601, 0.608, 0.596, 0.606, 0.745], [0.593, 0.592, 0.605, 0.629, 0.742], [0.626, 0.614, 0.615, 0.631, 0.774], [0.567, 0.579, 0.586, 0.593, 0.747], [0.62, 0.624, 0.626, 0.649, 0.794], [0.546, 0.55, 0.576, 0.599, 0.756], [0.589, 0.609, 0.613, 0.622, 0.733], [0.629, 0.629, 0.631, 0.67, 0.783]]
suff_simple_acc_int  =  0.742 +- 0.021, 0.742 +- 0.023, 0.745 +- 0.025, 0.743 +- 0.026, 0.803 +- 0.025
nec class all_L1  =  0.066 +- 0.016, 0.105 +- 0.019, 0.142 +- 0.020, 0.163 +- 0.018, 0.173 +- 0.018
nec class all_KL  =  0.062 +- 0.016, 0.118 +- 0.021, 0.178 +- 0.025, 0.219 +- 0.024, 0.239 +- 0.024
[[0.9539999961853027, 0.909250020980835, 0.8847500085830688, 0.8677499890327454, 0.8712499737739563], [0.9649999737739563, 0.9417499899864197, 0.9167500138282776, 0.8977500200271606, 0.8987500071525574], [0.9235000014305115, 0.9027500152587891, 0.8777499794960022, 0.8607500195503235, 0.8442500233650208], [0.9265000224113464, 0.8960000276565552, 0.8834999799728394, 0.8769999742507935, 0.8644999861717224], [0.9334999918937683, 0.8962500095367432, 0.878000020980835, 0.8762500286102295, 0.8715000152587891], [0.9309999942779541, 0.9135000109672546, 0.878250002861023, 0.8737499713897705, 0.8667500019073486], [0.9704999923706055, 0.9484999775886536, 0.9097499847412109, 0.8955000042915344, 0.9004999995231628], [0.9294999837875366, 0.890749990940094, 0.871999979019165, 0.8610000014305115, 0.8679999709129333], [0.9137499928474426, 0.8822500109672546, 0.8412500023841858, 0.8542500138282776, 0.8462499976158142], [0.9440000057220459, 0.9212499856948853, 0.8985000252723694, 0.8862500190734863, 0.878000020980835]]
[[0.061, 0.128, 0.19, 0.244, 0.25], [0.04, 0.087, 0.15, 0.191, 0.222], [0.081, 0.125, 0.192, 0.242, 0.264], [0.069, 0.132, 0.18, 0.227, 0.247], [0.05, 0.123, 0.174, 0.198, 0.218], [0.063, 0.116, 0.187, 0.224, 0.258], [0.036, 0.086, 0.128, 0.177, 0.198], [0.076, 0.149, 0.208, 0.251, 0.266], [0.089, 0.142, 0.211, 0.234, 0.258], [0.055, 0.096, 0.158, 0.198, 0.207]]
nec_acc_int  =  0.939 +- 0.018, 0.910 +- 0.021, 0.884 +- 0.020, 0.875 +- 0.014, 0.871 +- 0.018

Eval split val
suff_simple class all_L1  =  0.636 +- 0.098, 0.637 +- 0.098, 0.637 +- 0.098, 0.640 +- 0.097, 0.681 +- 0.089
suff_simple class all_KL  =  0.515 +- 0.147, 0.515 +- 0.146, 0.516 +- 0.146, 0.524 +- 0.143, 0.621 +- 0.116
[[0.5818250179290771, 0.5832250118255615, 0.5841249823570251, 0.5859000086784363, 0.6007999777793884], [0.6649749875068665, 0.6671249866485596, 0.6650000214576721, 0.6694999933242798, 0.6865249872207642], [0.5540000200271606, 0.5535749793052673, 0.5504500269889832, 0.5585500001907349, 0.5670750141143799], [0.5773500204086304, 0.5753499865531921, 0.5756750106811523, 0.5755249857902527, 0.5911499857902527], [0.6195499897003174, 0.6169250011444092, 0.6181250214576721, 0.6179249882698059, 0.6355000138282776], [0.6203250288963318, 0.6232749819755554, 0.6243500113487244, 0.6230000257492065, 0.6318749785423279], [0.6949250102043152, 0.694599986076355, 0.6893249750137329, 0.6935750246047974, 0.7185999751091003], [0.6132500171661377, 0.6133249998092651, 0.6143500208854675, 0.615149974822998, 0.6328250169754028], [0.6155499815940857, 0.6168000102043152, 0.6173750162124634, 0.6180499792098999, 0.633774995803833], [0.5909500122070312, 0.5928500294685364, 0.5918999910354614, 0.5927500128746033, 0.6007750034332275]]
[[0.244, 0.244, 0.246, 0.259, 0.397], [0.531, 0.529, 0.534, 0.537, 0.645], [0.623, 0.621, 0.619, 0.629, 0.688], [0.617, 0.616, 0.617, 0.621, 0.69], [0.637, 0.634, 0.638, 0.643, 0.739], [0.309, 0.313, 0.32, 0.324, 0.455], [0.499, 0.5, 0.498, 0.507, 0.606], [0.402, 0.405, 0.4, 0.421, 0.566], [0.552, 0.552, 0.555, 0.557, 0.636], [0.737, 0.738, 0.738, 0.741, 0.793]]
suff_simple_acc_int  =  0.613 +- 0.040, 0.614 +- 0.040, 0.613 +- 0.039, 0.615 +- 0.039, 0.630 +- 0.043
nec class all_L1  =  0.090 +- 0.018, 0.168 +- 0.047, 0.200 +- 0.054, 0.206 +- 0.057, 0.209 +- 0.058
nec class all_KL  =  0.071 +- 0.027, 0.180 +- 0.076, 0.268 +- 0.095, 0.289 +- 0.099, 0.299 +- 0.101
[[0.870199978351593, 0.7979999780654907, 0.7821249961853027, 0.7795249819755554, 0.7809249758720398], [0.9294000267982483, 0.8753250241279602, 0.8655250072479248, 0.8651750087738037, 0.8646500110626221], [0.751800000667572, 0.6952750086784363, 0.6821500062942505, 0.6820499897003174, 0.6799250245094299], [0.7387999892234802, 0.7052500247955322, 0.6937500238418579, 0.6929500102996826, 0.6934249997138977], [0.7681999802589417, 0.7402250170707703, 0.7283999919891357, 0.7283750176429749, 0.7282750010490417], [0.8637999892234802, 0.7791000008583069, 0.7695500254631042, 0.7708500027656555, 0.7710250020027161], [0.9115999937057495, 0.8847000002861023, 0.8720750212669373, 0.8734750151634216, 0.8744500279426575], [0.9351999759674072, 0.8435750007629395, 0.8229749798774719, 0.8212500214576721, 0.8201000094413757], [0.8694000244140625, 0.8046000003814697, 0.7916749715805054, 0.7940250039100647, 0.7953000068664551], [0.6367999911308289, 0.6413499712944031, 0.6403999924659729, 0.6411499977111816, 0.6396999955177307]]
[[0.116, 0.323, 0.44, 0.464, 0.473], [0.052, 0.145, 0.245, 0.27, 0.279], [0.054, 0.156, 0.233, 0.249, 0.253], [0.069, 0.144, 0.22, 0.234, 0.246], [0.068, 0.119, 0.182, 0.206, 0.216], [0.12, 0.316, 0.421, 0.445, 0.456], [0.08, 0.168, 0.264, 0.294, 0.301], [0.067, 0.203, 0.322, 0.351, 0.371], [0.047, 0.148, 0.233, 0.251, 0.261], [0.034, 0.078, 0.118, 0.131, 0.132]]
nec_acc_int  =  0.828 +- 0.094, 0.777 +- 0.076, 0.765 +- 0.074, 0.765 +- 0.074, 0.765 +- 0.075

Eval split test
suff_simple class all_L1  =  0.751 +- 0.010, 0.754 +- 0.010, 0.762 +- 0.010, 0.786 +- 0.008, 0.884 +- 0.005
suff_simple class all_KL  =  0.724 +- 0.019, 0.727 +- 0.019, 0.738 +- 0.017, 0.775 +- 0.011, 0.901 +- 0.006
[[0.5941565036773682, 0.5943565964698792, 0.6036621928215027, 0.6118170619010925, 0.6656889319419861], [0.6298279166221619, 0.626801073551178, 0.6312787532806396, 0.6531168818473816, 0.7122665047645569], [0.6127676367759705, 0.6193966269493103, 0.6249749660491943, 0.638433039188385, 0.6928033828735352], [0.5673404335975647, 0.566464900970459, 0.5671902894973755, 0.5794476866722107, 0.6353790760040283], [0.5972083210945129, 0.5942315459251404, 0.6008355021476746, 0.597008228302002, 0.6698344945907593], [0.6446117758750916, 0.6500149965286255, 0.6494646668434143, 0.6604212522506714, 0.7215167880058289], [0.5905293226242065, 0.5968581438064575, 0.6044126749038696, 0.6201471090316772, 0.6678034067153931], [0.6241744756698608, 0.6156694293022156, 0.6100410223007202, 0.6217480301856995, 0.6836525201797485], [0.6136682033538818, 0.6145687699317932, 0.6209725737571716, 0.6326795816421509, 0.6960631608963013], [0.6002351641654968, 0.6014859080314636, 0.6016109585762024, 0.6165699362754822, 0.6750451326370239]]
[[0.719, 0.723, 0.733, 0.772, 0.905], [0.713, 0.709, 0.721, 0.773, 0.895], [0.723, 0.727, 0.747, 0.778, 0.902], [0.743, 0.749, 0.757, 0.782, 0.903], [0.738, 0.739, 0.747, 0.77, 0.894], [0.71, 0.711, 0.719, 0.767, 0.895], [0.73, 0.731, 0.742, 0.777, 0.905], [0.68, 0.685, 0.705, 0.752, 0.896], [0.738, 0.744, 0.758, 0.793, 0.912], [0.744, 0.748, 0.755, 0.786, 0.906]]
suff_simple_acc_int  =  0.607 +- 0.021, 0.608 +- 0.021, 0.611 +- 0.021, 0.623 +- 0.023, 0.682 +- 0.024
nec class all_L1  =  0.055 +- 0.002, 0.081 +- 0.003, 0.112 +- 0.004, 0.150 +- 0.005, 0.182 +- 0.006
nec class all_KL  =  0.030 +- 0.002, 0.056 +- 0.004, 0.091 +- 0.004, 0.139 +- 0.007, 0.189 +- 0.013
[[0.6541925072669983, 0.6544176340103149, 0.646938145160675, 0.6249499917030334, 0.6004852652549744], [0.6914148330688477, 0.6997698545455933, 0.6796827912330627, 0.6588703393936157, 0.6418851017951965], [0.6814088225364685, 0.6859616041183472, 0.6707023978233337, 0.652141273021698, 0.6337302327156067], [0.6233740448951721, 0.6235741376876831, 0.6153692007064819, 0.5953071713447571, 0.5796477794647217], [0.6607964634895325, 0.6623974442481995, 0.6426355838775635, 0.6191214919090271, 0.609765887260437], [0.7100260257720947, 0.712552547454834, 0.6960425972938538, 0.6742545366287231, 0.6630228161811829], [0.6565939784049988, 0.659795880317688, 0.6534420847892761, 0.6315789222717285, 0.6081148982048035], [0.6684010624885559, 0.6710276007652283, 0.6573694348335266, 0.6346808075904846, 0.6291775107383728], [0.6832099556922913, 0.6865369081497192, 0.6725785732269287, 0.6521162986755371, 0.6264008283615112], [0.6617971062660217, 0.663398027420044, 0.6528167128562927, 0.6347308158874512, 0.6108415126800537]]
[[0.028, 0.053, 0.089, 0.143, 0.193], [0.033, 0.059, 0.088, 0.14, 0.197], [0.032, 0.057, 0.095, 0.14, 0.192], [0.031, 0.057, 0.097, 0.143, 0.185], [0.03, 0.058, 0.096, 0.147, 0.176], [0.031, 0.058, 0.088, 0.137, 0.195], [0.028, 0.052, 0.088, 0.132, 0.182], [0.033, 0.063, 0.095, 0.153, 0.221], [0.027, 0.052, 0.083, 0.127, 0.177], [0.028, 0.052, 0.087, 0.131, 0.174]]
nec_acc_int  =  0.669 +- 0.023, 0.672 +- 0.024, 0.659 +- 0.021, 0.638 +- 0.021, 0.620 +- 0.022


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.379 +- 0.006, 0.399 +- 0.007, 0.419 +- 0.006, 0.433 +- 0.005, 0.482 +- 0.003
Faith. Armon (L1)= 		  =  0.120 +- 0.026, 0.181 +- 0.029, 0.235 +- 0.027, 0.263 +- 0.022, 0.284 +- 0.023
Faith. GMean (L1)= 	  =  0.212 +- 0.024, 0.268 +- 0.023, 0.313 +- 0.020, 0.338 +- 0.015, 0.370 +- 0.015
Faith. Aritm (KL)= 		  =  0.327 +- 0.013, 0.358 +- 0.010, 0.390 +- 0.010, 0.420 +- 0.008, 0.499 +- 0.005
Faith. Armon (KL)= 		  =  0.111 +- 0.027, 0.196 +- 0.029, 0.273 +- 0.029, 0.322 +- 0.024, 0.362 +- 0.026
Faith. GMean (KL)= 	  =  0.189 +- 0.024, 0.264 +- 0.021, 0.326 +- 0.021, 0.368 +- 0.016, 0.425 +- 0.017

Eval split val
Faith. Aritm (L1)= 		  =  0.363 +- 0.046, 0.402 +- 0.028, 0.419 +- 0.024, 0.423 +- 0.022, 0.445 +- 0.018
Faith. Armon (L1)= 		  =  0.156 +- 0.025, 0.257 +- 0.045, 0.295 +- 0.046, 0.301 +- 0.048, 0.310 +- 0.053
Faith. GMean (L1)= 	  =  0.237 +- 0.023, 0.319 +- 0.020, 0.349 +- 0.021, 0.355 +- 0.022, 0.369 +- 0.027
Faith. Aritm (KL)= 		  =  0.293 +- 0.063, 0.348 +- 0.038, 0.392 +- 0.027, 0.407 +- 0.024, 0.460 +- 0.012
Faith. Armon (KL)= 		  =  0.118 +- 0.031, 0.240 +- 0.044, 0.319 +- 0.044, 0.340 +- 0.044, 0.379 +- 0.063
Faith. GMean (KL)= 	  =  0.181 +- 0.019, 0.286 +- 0.020, 0.352 +- 0.023, 0.370 +- 0.023, 0.416 +- 0.036

Eval split test
Faith. Aritm (L1)= 		  =  0.403 +- 0.005, 0.417 +- 0.005, 0.437 +- 0.005, 0.468 +- 0.002, 0.533 +- 0.003
Faith. Armon (L1)= 		  =  0.103 +- 0.003, 0.146 +- 0.004, 0.196 +- 0.006, 0.252 +- 0.007, 0.302 +- 0.009
Faith. GMean (L1)= 	  =  0.204 +- 0.003, 0.246 +- 0.004, 0.292 +- 0.005, 0.344 +- 0.004, 0.401 +- 0.007
Faith. Aritm (KL)= 		  =  0.377 +- 0.009, 0.391 +- 0.008, 0.415 +- 0.009, 0.457 +- 0.003, 0.545 +- 0.006
Faith. Armon (KL)= 		  =  0.058 +- 0.004, 0.104 +- 0.006, 0.161 +- 0.007, 0.236 +- 0.010, 0.313 +- 0.018
Faith. GMean (KL)= 	  =  0.147 +- 0.004, 0.202 +- 0.005, 0.259 +- 0.007, 0.328 +- 0.007, 0.413 +- 0.014
Computed for split load_split = id



Completed in  2:54:51.861765  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 08:42:03 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:42:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.048
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.082
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.035
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.048
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03597
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.844
SUFF_SIMPLE for r=0.05 class 0.0 = 0.698 +- 0.395 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.933 +- 0.395 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.05 all KL = 0.753 +- 0.395 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.05 all L1 = 0.828 +- 0.298 (in-sample avg dev_std = 0.319)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047726
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.841
SUFF_SIMPLE for r=0.1 class 0.0 = 0.699 +- 0.401 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.928 +- 0.401 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all KL = 0.751 +- 0.401 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all L1 = 0.826 +- 0.300 (in-sample avg dev_std = 0.338)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061348
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.851
SUFF_SIMPLE for r=0.2 class 0.0 = 0.693 +- 0.394 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.947 +- 0.394 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.2 all KL = 0.758 +- 0.394 (in-sample avg dev_std = 0.322)
SUFF_SIMPLE for r=0.2 all L1 = 0.833 +- 0.292 (in-sample avg dev_std = 0.322)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07434
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.866
SUFF_SIMPLE for r=0.4 class 0.0 = 0.684 +- 0.384 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.978 +- 0.384 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.4 all KL = 0.783 +- 0.384 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.4 all L1 = 0.847 +- 0.286 (in-sample avg dev_std = 0.288)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.915
SUFF_SIMPLE for r=0.8 class 0.0 = 0.797 +- 0.314 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.995 +- 0.314 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all KL = 0.871 +- 0.314 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all L1 = 0.906 +- 0.236 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080328
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.678
SUFF_SIMPLE for r=0.05 class 0.0 = 0.668 +- 0.389 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.948 +- 0.389 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.05 all KL = 0.773 +- 0.389 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.05 all L1 = 0.809 +- 0.319 (in-sample avg dev_std = 0.096)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0085574
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.678
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.389 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.947 +- 0.389 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.1 all KL = 0.773 +- 0.389 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.1 all L1 = 0.808 +- 0.319 (in-sample avg dev_std = 0.096)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091202
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.678
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.389 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.947 +- 0.389 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.2 all KL = 0.772 +- 0.389 (in-sample avg dev_std = 0.099)
SUFF_SIMPLE for r=0.2 all L1 = 0.808 +- 0.319 (in-sample avg dev_std = 0.099)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094654
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.678
SUFF_SIMPLE for r=0.4 class 0.0 = 0.668 +- 0.388 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.948 +- 0.388 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.4 all KL = 0.773 +- 0.388 (in-sample avg dev_std = 0.093)
SUFF_SIMPLE for r=0.4 all L1 = 0.809 +- 0.319 (in-sample avg dev_std = 0.093)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096952
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.682
SUFF_SIMPLE for r=0.8 class 0.0 = 0.677 +- 0.384 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.948 +- 0.384 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all KL = 0.78 +- 0.384 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all L1 = 0.814 +- 0.317 (in-sample avg dev_std = 0.052)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0258052
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.733
SUFF_SIMPLE for r=0.05 class 0.0 = 0.864 +- 0.383 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.582 +- 0.383 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 all KL = 0.697 +- 0.383 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 all L1 = 0.725 +- 0.319 (in-sample avg dev_std = 0.297)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0353
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.748
SUFF_SIMPLE for r=0.1 class 0.0 = 0.854 +- 0.375 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.62 +- 0.375 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.1 all KL = 0.711 +- 0.375 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.1 all L1 = 0.738 +- 0.310 (in-sample avg dev_std = 0.285)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0475984
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.766
SUFF_SIMPLE for r=0.2 class 0.0 = 0.85 +- 0.351 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.681 +- 0.351 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.351 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all L1 = 0.767 +- 0.294 (in-sample avg dev_std = 0.268)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.061493200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.785
SUFF_SIMPLE for r=0.4 class 0.0 = 0.854 +- 0.326 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.734 +- 0.326 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all KL = 0.785 +- 0.326 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.4 all L1 = 0.795 +- 0.279 (in-sample avg dev_std = 0.258)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.832
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0785986
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.83
SUFF_SIMPLE for r=0.8 class 0.0 = 0.951 +- 0.248 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.773 +- 0.248 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.8 all KL = 0.88 +- 0.248 (in-sample avg dev_std = 0.159)
SUFF_SIMPLE for r=0.8 all L1 = 0.863 +- 0.237 (in-sample avg dev_std = 0.159)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03597
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.994
NEC for r=0.05 class 0.0 = 0.017 +- 0.080 (in-sample avg dev_std = 0.006)
NEC for r=0.05 class 1.0 = 0.008 +- 0.080 (in-sample avg dev_std = 0.006)
NEC for r=0.05 all KL = 0.013 +- 0.080 (in-sample avg dev_std = 0.006)
NEC for r=0.05 all L1 = 0.012 +- 0.065 (in-sample avg dev_std = 0.006)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047726
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.987
NEC for r=0.1 class 0.0 = 0.042 +- 0.124 (in-sample avg dev_std = 0.061)
NEC for r=0.1 class 1.0 = 0.005 +- 0.124 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all KL = 0.027 +- 0.124 (in-sample avg dev_std = 0.061)
NEC for r=0.1 all L1 = 0.021 +- 0.094 (in-sample avg dev_std = 0.061)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061348
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.967
NEC for r=0.2 class 0.0 = 0.089 +- 0.219 (in-sample avg dev_std = 0.171)
NEC for r=0.2 class 1.0 = 0.012 +- 0.219 (in-sample avg dev_std = 0.171)
NEC for r=0.2 all KL = 0.072 +- 0.219 (in-sample avg dev_std = 0.171)
NEC for r=0.2 all L1 = 0.047 +- 0.149 (in-sample avg dev_std = 0.171)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07434
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.955
NEC for r=0.4 class 0.0 = 0.118 +- 0.253 (in-sample avg dev_std = 0.210)
NEC for r=0.4 class 1.0 = 0.018 +- 0.253 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all KL = 0.103 +- 0.253 (in-sample avg dev_std = 0.210)
NEC for r=0.4 all L1 = 0.062 +- 0.170 (in-sample avg dev_std = 0.210)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.955
NEC for r=0.8 class 0.0 = 0.125 +- 0.272 (in-sample avg dev_std = 0.272)
NEC for r=0.8 class 1.0 = 0.025 +- 0.272 (in-sample avg dev_std = 0.272)
NEC for r=0.8 all KL = 0.123 +- 0.272 (in-sample avg dev_std = 0.272)
NEC for r=0.8 all L1 = 0.07 +- 0.167 (in-sample avg dev_std = 0.272)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080328
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.831
NEC for r=0.05 class 0.0 = 0.037 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.033 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.035 +- 0.114 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0085574
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.768
NEC for r=0.1 class 0.0 = 0.164 +- 0.296 (in-sample avg dev_std = 0.099)
NEC for r=0.1 class 1.0 = 0.044 +- 0.296 (in-sample avg dev_std = 0.099)
NEC for r=0.1 all KL = 0.12 +- 0.296 (in-sample avg dev_std = 0.099)
NEC for r=0.1 all L1 = 0.103 +- 0.232 (in-sample avg dev_std = 0.099)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091202
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.761
NEC for r=0.2 class 0.0 = 0.195 +- 0.333 (in-sample avg dev_std = 0.241)
NEC for r=0.2 class 1.0 = 0.046 +- 0.333 (in-sample avg dev_std = 0.241)
NEC for r=0.2 all KL = 0.157 +- 0.333 (in-sample avg dev_std = 0.241)
NEC for r=0.2 all L1 = 0.12 +- 0.239 (in-sample avg dev_std = 0.241)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094654
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.762
NEC for r=0.4 class 0.0 = 0.2 +- 0.340 (in-sample avg dev_std = 0.270)
NEC for r=0.4 class 1.0 = 0.046 +- 0.340 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all KL = 0.166 +- 0.340 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all L1 = 0.123 +- 0.238 (in-sample avg dev_std = 0.270)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096952
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.762
NEC for r=0.8 class 0.0 = 0.2 +- 0.341 (in-sample avg dev_std = 0.274)
NEC for r=0.8 class 1.0 = 0.047 +- 0.341 (in-sample avg dev_std = 0.274)
NEC for r=0.8 all KL = 0.169 +- 0.341 (in-sample avg dev_std = 0.274)
NEC for r=0.8 all L1 = 0.123 +- 0.237 (in-sample avg dev_std = 0.274)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0258052
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.835
NEC for r=0.05 class 0.0 = 0.024 +- 0.162 (in-sample avg dev_std = 0.055)
NEC for r=0.05 class 1.0 = 0.142 +- 0.162 (in-sample avg dev_std = 0.055)
NEC for r=0.05 all KL = 0.054 +- 0.162 (in-sample avg dev_std = 0.055)
NEC for r=0.05 all L1 = 0.082 +- 0.178 (in-sample avg dev_std = 0.055)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0353
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.831
NEC for r=0.1 class 0.0 = 0.033 +- 0.193 (in-sample avg dev_std = 0.124)
NEC for r=0.1 class 1.0 = 0.174 +- 0.193 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all KL = 0.077 +- 0.193 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all L1 = 0.103 +- 0.200 (in-sample avg dev_std = 0.124)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0475984
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.82
NEC for r=0.2 class 0.0 = 0.055 +- 0.223 (in-sample avg dev_std = 0.178)
NEC for r=0.2 class 1.0 = 0.188 +- 0.223 (in-sample avg dev_std = 0.178)
NEC for r=0.2 all KL = 0.102 +- 0.223 (in-sample avg dev_std = 0.178)
NEC for r=0.2 all L1 = 0.12 +- 0.213 (in-sample avg dev_std = 0.178)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.061493200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.8
NEC for r=0.4 class 0.0 = 0.094 +- 0.261 (in-sample avg dev_std = 0.214)
NEC for r=0.4 class 1.0 = 0.195 +- 0.261 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all KL = 0.136 +- 0.261 (in-sample avg dev_std = 0.214)
NEC for r=0.4 all L1 = 0.144 +- 0.232 (in-sample avg dev_std = 0.214)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.831
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0785986
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.768
NEC for r=0.8 class 0.0 = 0.116 +- 0.326 (in-sample avg dev_std = 0.252)
NEC for r=0.8 class 1.0 = 0.278 +- 0.326 (in-sample avg dev_std = 0.252)
NEC for r=0.8 all KL = 0.205 +- 0.326 (in-sample avg dev_std = 0.252)
NEC for r=0.8 all L1 = 0.196 +- 0.275 (in-sample avg dev_std = 0.252)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 08:57:01 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:57:01 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 54 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.023
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.032
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032861999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.877
SUFF_SIMPLE for r=0.05 class 0.0 = 0.708 +- 0.405 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.987 +- 0.405 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.05 all KL = 0.779 +- 0.405 (in-sample avg dev_std = 0.406)
SUFF_SIMPLE for r=0.05 all L1 = 0.862 +- 0.273 (in-sample avg dev_std = 0.406)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041794
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.878
SUFF_SIMPLE for r=0.1 class 0.0 = 0.71 +- 0.403 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.987 +- 0.403 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.1 all KL = 0.785 +- 0.403 (in-sample avg dev_std = 0.388)
SUFF_SIMPLE for r=0.1 all L1 = 0.863 +- 0.274 (in-sample avg dev_std = 0.388)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.051998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.869
SUFF_SIMPLE for r=0.2 class 0.0 = 0.708 +- 0.396 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.987 +- 0.396 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.2 all KL = 0.797 +- 0.396 (in-sample avg dev_std = 0.358)
SUFF_SIMPLE for r=0.2 all L1 = 0.862 +- 0.284 (in-sample avg dev_std = 0.358)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064676
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.873
SUFF_SIMPLE for r=0.4 class 0.0 = 0.699 +- 0.398 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.997 +- 0.398 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.4 all KL = 0.794 +- 0.398 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.4 all L1 = 0.864 +- 0.279 (in-sample avg dev_std = 0.371)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078292
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.921
SUFF_SIMPLE for r=0.8 class 0.0 = 0.819 +- 0.317 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.317 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.8 all KL = 0.882 +- 0.317 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.8 all L1 = 0.919 +- 0.229 (in-sample avg dev_std = 0.255)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086458
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.75
SUFF_SIMPLE for r=0.05 class 0.0 = 0.562 +- 0.436 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.05 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.05 all L1 = 0.78 +- 0.373 (in-sample avg dev_std = 0.118)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092028
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.75
SUFF_SIMPLE for r=0.1 class 0.0 = 0.562 +- 0.436 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.1 all L1 = 0.78 +- 0.373 (in-sample avg dev_std = 0.118)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009534
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.75
SUFF_SIMPLE for r=0.2 class 0.0 = 0.561 +- 0.436 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.2 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.2 all L1 = 0.78 +- 0.374 (in-sample avg dev_std = 0.113)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009619800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.75
SUFF_SIMPLE for r=0.4 class 0.0 = 0.561 +- 0.436 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.4 all L1 = 0.78 +- 0.374 (in-sample avg dev_std = 0.107)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009695400000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.751
SUFF_SIMPLE for r=0.8 class 0.0 = 0.566 +- 0.434 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.995 +- 0.434 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.8 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.063)
SUFF_SIMPLE for r=0.8 all L1 = 0.783 +- 0.373 (in-sample avg dev_std = 0.063)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0230524
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.849
SUFF_SIMPLE for r=0.05 class 0.0 = 0.882 +- 0.327 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.882 +- 0.327 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 all KL = 0.833 +- 0.327 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.05 all L1 = 0.882 +- 0.249 (in-sample avg dev_std = 0.272)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0324914
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.851
SUFF_SIMPLE for r=0.1 class 0.0 = 0.883 +- 0.327 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.883 +- 0.327 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.1 all KL = 0.836 +- 0.327 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.1 all L1 = 0.883 +- 0.249 (in-sample avg dev_std = 0.273)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0442574
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.851
SUFF_SIMPLE for r=0.2 class 0.0 = 0.885 +- 0.324 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.886 +- 0.324 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all KL = 0.839 +- 0.324 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.2 all L1 = 0.885 +- 0.248 (in-sample avg dev_std = 0.266)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0599838
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.852
SUFF_SIMPLE for r=0.4 class 0.0 = 0.885 +- 0.320 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.89 +- 0.320 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.4 all KL = 0.848 +- 0.320 (in-sample avg dev_std = 0.252)
SUFF_SIMPLE for r=0.4 all L1 = 0.887 +- 0.250 (in-sample avg dev_std = 0.252)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.897
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0767382
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.899
SUFF_SIMPLE for r=0.8 class 0.0 = 0.966 +- 0.244 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.895 +- 0.244 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.8 all KL = 0.917 +- 0.244 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.8 all L1 = 0.931 +- 0.201 (in-sample avg dev_std = 0.180)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032861999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.992
NEC for r=0.05 class 0.0 = 0.019 +- 0.107 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.107 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.012 +- 0.107 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.082 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041794
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.989
NEC for r=0.1 class 0.0 = 0.028 +- 0.140 (in-sample avg dev_std = 0.124)
NEC for r=0.1 class 1.0 = 0.0 +- 0.140 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all KL = 0.022 +- 0.140 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all L1 = 0.013 +- 0.089 (in-sample avg dev_std = 0.124)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.051998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.972
NEC for r=0.2 class 0.0 = 0.075 +- 0.235 (in-sample avg dev_std = 0.210)
NEC for r=0.2 class 1.0 = 0.0 +- 0.235 (in-sample avg dev_std = 0.210)
NEC for r=0.2 all KL = 0.064 +- 0.235 (in-sample avg dev_std = 0.210)
NEC for r=0.2 all L1 = 0.033 +- 0.138 (in-sample avg dev_std = 0.210)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064676
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.968
NEC for r=0.4 class 0.0 = 0.096 +- 0.274 (in-sample avg dev_std = 0.269)
NEC for r=0.4 class 1.0 = 0.0 +- 0.274 (in-sample avg dev_std = 0.269)
NEC for r=0.4 all KL = 0.091 +- 0.274 (in-sample avg dev_std = 0.269)
NEC for r=0.4 all L1 = 0.043 +- 0.144 (in-sample avg dev_std = 0.269)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078292
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.965
NEC for r=0.8 class 0.0 = 0.104 +- 0.285 (in-sample avg dev_std = 0.275)
NEC for r=0.8 class 1.0 = 0.002 +- 0.285 (in-sample avg dev_std = 0.275)
NEC for r=0.8 all KL = 0.104 +- 0.285 (in-sample avg dev_std = 0.275)
NEC for r=0.8 all L1 = 0.047 +- 0.148 (in-sample avg dev_std = 0.275)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086458
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.982
NEC for r=0.05 class 0.0 = 0.032 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.004 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.022 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.018 +- 0.119 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092028
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.898
NEC for r=0.1 class 0.0 = 0.191 +- 0.326 (in-sample avg dev_std = 0.180)
NEC for r=0.1 class 1.0 = 0.005 +- 0.326 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all KL = 0.125 +- 0.326 (in-sample avg dev_std = 0.180)
NEC for r=0.1 all L1 = 0.097 +- 0.261 (in-sample avg dev_std = 0.180)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009534
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.883
NEC for r=0.2 class 0.0 = 0.27 +- 0.409 (in-sample avg dev_std = 0.417)
NEC for r=0.2 class 1.0 = 0.005 +- 0.409 (in-sample avg dev_std = 0.417)
NEC for r=0.2 all KL = 0.224 +- 0.409 (in-sample avg dev_std = 0.417)
NEC for r=0.2 all L1 = 0.136 +- 0.266 (in-sample avg dev_std = 0.417)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009619800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.887
NEC for r=0.4 class 0.0 = 0.271 +- 0.415 (in-sample avg dev_std = 0.440)
NEC for r=0.4 class 1.0 = 0.005 +- 0.415 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all KL = 0.233 +- 0.415 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all L1 = 0.137 +- 0.260 (in-sample avg dev_std = 0.440)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009695400000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.885
NEC for r=0.8 class 0.0 = 0.279 +- 0.418 (in-sample avg dev_std = 0.452)
NEC for r=0.8 class 1.0 = 0.005 +- 0.418 (in-sample avg dev_std = 0.452)
NEC for r=0.8 all KL = 0.237 +- 0.418 (in-sample avg dev_std = 0.452)
NEC for r=0.8 all L1 = 0.141 +- 0.263 (in-sample avg dev_std = 0.452)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0230524
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.904
NEC for r=0.05 class 0.0 = 0.015 +- 0.151 (in-sample avg dev_std = 0.067)
NEC for r=0.05 class 1.0 = 0.057 +- 0.151 (in-sample avg dev_std = 0.067)
NEC for r=0.05 all KL = 0.033 +- 0.151 (in-sample avg dev_std = 0.067)
NEC for r=0.05 all L1 = 0.036 +- 0.143 (in-sample avg dev_std = 0.067)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0324914
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.901
NEC for r=0.1 class 0.0 = 0.02 +- 0.171 (in-sample avg dev_std = 0.133)
NEC for r=0.1 class 1.0 = 0.063 +- 0.171 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all KL = 0.044 +- 0.171 (in-sample avg dev_std = 0.133)
NEC for r=0.1 all L1 = 0.041 +- 0.148 (in-sample avg dev_std = 0.133)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0442574
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.888
NEC for r=0.2 class 0.0 = 0.039 +- 0.207 (in-sample avg dev_std = 0.163)
NEC for r=0.2 class 1.0 = 0.069 +- 0.207 (in-sample avg dev_std = 0.163)
NEC for r=0.2 all KL = 0.064 +- 0.207 (in-sample avg dev_std = 0.163)
NEC for r=0.2 all L1 = 0.054 +- 0.171 (in-sample avg dev_std = 0.163)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0599838
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.868
NEC for r=0.4 class 0.0 = 0.073 +- 0.246 (in-sample avg dev_std = 0.192)
NEC for r=0.4 class 1.0 = 0.069 +- 0.246 (in-sample avg dev_std = 0.192)
NEC for r=0.4 all KL = 0.09 +- 0.246 (in-sample avg dev_std = 0.192)
NEC for r=0.4 all L1 = 0.071 +- 0.198 (in-sample avg dev_std = 0.192)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.896
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0767382
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.865
NEC for r=0.8 class 0.0 = 0.078 +- 0.260 (in-sample avg dev_std = 0.221)
NEC for r=0.8 class 1.0 = 0.075 +- 0.260 (in-sample avg dev_std = 0.221)
NEC for r=0.8 all KL = 0.105 +- 0.260 (in-sample avg dev_std = 0.221)
NEC for r=0.8 all L1 = 0.077 +- 0.200 (in-sample avg dev_std = 0.221)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 09:12:16 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:12:16 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.042
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.058
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04221000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.89
SUFF_SIMPLE for r=0.05 class 0.0 = 0.732 +- 0.394 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.988 +- 0.394 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.05 all KL = 0.792 +- 0.394 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.05 all L1 = 0.874 +- 0.258 (in-sample avg dev_std = 0.394)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04986
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.887
SUFF_SIMPLE for r=0.1 class 0.0 = 0.726 +- 0.392 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.992 +- 0.392 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 all KL = 0.795 +- 0.392 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 all L1 = 0.873 +- 0.263 (in-sample avg dev_std = 0.382)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.058192
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.881
SUFF_SIMPLE for r=0.2 class 0.0 = 0.72 +- 0.394 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.394 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.2 all KL = 0.796 +- 0.394 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.2 all L1 = 0.869 +- 0.270 (in-sample avg dev_std = 0.386)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06778400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.881
SUFF_SIMPLE for r=0.4 class 0.0 = 0.722 +- 0.392 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.992 +- 0.392 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.4 all KL = 0.8 +- 0.392 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.4 all L1 = 0.872 +- 0.270 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077462
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.934
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.293 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.997 +- 0.293 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all KL = 0.901 +- 0.293 (in-sample avg dev_std = 0.238)
SUFF_SIMPLE for r=0.8 all L1 = 0.932 +- 0.213 (in-sample avg dev_std = 0.238)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084326
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.749
SUFF_SIMPLE for r=0.05 class 0.0 = 0.56 +- 0.437 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.05 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.104)
SUFF_SIMPLE for r=0.05 all L1 = 0.777 +- 0.376 (in-sample avg dev_std = 0.104)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091108
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.749
SUFF_SIMPLE for r=0.1 class 0.0 = 0.559 +- 0.437 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.1 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.1 all L1 = 0.776 +- 0.377 (in-sample avg dev_std = 0.097)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094056
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.749
SUFF_SIMPLE for r=0.2 class 0.0 = 0.559 +- 0.437 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.2 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.097)
SUFF_SIMPLE for r=0.2 all L1 = 0.776 +- 0.377 (in-sample avg dev_std = 0.097)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009528199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.75
SUFF_SIMPLE for r=0.4 class 0.0 = 0.56 +- 0.437 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.108)
SUFF_SIMPLE for r=0.4 all L1 = 0.777 +- 0.376 (in-sample avg dev_std = 0.108)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096482
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.752
SUFF_SIMPLE for r=0.8 class 0.0 = 0.566 +- 0.434 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.434 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.8 all KL = 0.745 +- 0.434 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.8 all L1 = 0.78 +- 0.375 (in-sample avg dev_std = 0.075)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024804399999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.892
SUFF_SIMPLE for r=0.05 class 0.0 = 0.876 +- 0.293 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.293 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.05 all KL = 0.852 +- 0.293 (in-sample avg dev_std = 0.256)
SUFF_SIMPLE for r=0.05 all L1 = 0.893 +- 0.224 (in-sample avg dev_std = 0.256)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0359612
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.891
SUFF_SIMPLE for r=0.1 class 0.0 = 0.877 +- 0.288 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.914 +- 0.288 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all KL = 0.862 +- 0.288 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.1 all L1 = 0.895 +- 0.227 (in-sample avg dev_std = 0.244)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.049202800000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.893
SUFF_SIMPLE for r=0.2 class 0.0 = 0.878 +- 0.284 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.925 +- 0.284 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.2 all KL = 0.874 +- 0.284 (in-sample avg dev_std = 0.230)
SUFF_SIMPLE for r=0.2 all L1 = 0.901 +- 0.226 (in-sample avg dev_std = 0.230)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06235260000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.896
SUFF_SIMPLE for r=0.4 class 0.0 = 0.881 +- 0.278 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.932 +- 0.278 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all KL = 0.885 +- 0.278 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all L1 = 0.906 +- 0.225 (in-sample avg dev_std = 0.211)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07781400000000001
len(reference) = 4981
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.948
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.178 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.941 +- 0.178 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.8 all KL = 0.952 +- 0.178 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.8 all L1 = 0.955 +- 0.152 (in-sample avg dev_std = 0.136)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04221000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
NEC for r=0.05 class 0.0 = 0.008 +- 0.065 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.065 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.005 +- 0.065 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.004 +- 0.055 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04986
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.993
NEC for r=0.1 class 0.0 = 0.021 +- 0.129 (in-sample avg dev_std = 0.130)
NEC for r=0.1 class 1.0 = 0.0 +- 0.129 (in-sample avg dev_std = 0.130)
NEC for r=0.1 all KL = 0.018 +- 0.129 (in-sample avg dev_std = 0.130)
NEC for r=0.1 all L1 = 0.009 +- 0.070 (in-sample avg dev_std = 0.130)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.058192
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.982
NEC for r=0.2 class 0.0 = 0.051 +- 0.197 (in-sample avg dev_std = 0.176)
NEC for r=0.2 class 1.0 = 0.0 +- 0.197 (in-sample avg dev_std = 0.176)
NEC for r=0.2 all KL = 0.046 +- 0.197 (in-sample avg dev_std = 0.176)
NEC for r=0.2 all L1 = 0.023 +- 0.109 (in-sample avg dev_std = 0.176)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06778400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.971
NEC for r=0.4 class 0.0 = 0.089 +- 0.268 (in-sample avg dev_std = 0.261)
NEC for r=0.4 class 1.0 = 0.0 +- 0.268 (in-sample avg dev_std = 0.261)
NEC for r=0.4 all KL = 0.092 +- 0.268 (in-sample avg dev_std = 0.261)
NEC for r=0.4 all L1 = 0.04 +- 0.130 (in-sample avg dev_std = 0.261)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077462
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.967
NEC for r=0.8 class 0.0 = 0.099 +- 0.278 (in-sample avg dev_std = 0.276)
NEC for r=0.8 class 1.0 = 0.001 +- 0.278 (in-sample avg dev_std = 0.276)
NEC for r=0.8 all KL = 0.103 +- 0.278 (in-sample avg dev_std = 0.276)
NEC for r=0.8 all L1 = 0.045 +- 0.139 (in-sample avg dev_std = 0.276)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084326
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.979
NEC for r=0.05 class 0.0 = 0.039 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.01 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.029 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.024 +- 0.137 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091108
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.884
NEC for r=0.1 class 0.0 = 0.22 +- 0.347 (in-sample avg dev_std = 0.191)
NEC for r=0.1 class 1.0 = 0.01 +- 0.347 (in-sample avg dev_std = 0.191)
NEC for r=0.1 all KL = 0.144 +- 0.347 (in-sample avg dev_std = 0.191)
NEC for r=0.1 all L1 = 0.114 +- 0.280 (in-sample avg dev_std = 0.191)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094056
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.875
NEC for r=0.2 class 0.0 = 0.283 +- 0.410 (in-sample avg dev_std = 0.414)
NEC for r=0.2 class 1.0 = 0.01 +- 0.410 (in-sample avg dev_std = 0.414)
NEC for r=0.2 all KL = 0.225 +- 0.410 (in-sample avg dev_std = 0.414)
NEC for r=0.2 all L1 = 0.145 +- 0.280 (in-sample avg dev_std = 0.414)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009528199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.878
NEC for r=0.4 class 0.0 = 0.289 +- 0.419 (in-sample avg dev_std = 0.446)
NEC for r=0.4 class 1.0 = 0.01 +- 0.419 (in-sample avg dev_std = 0.446)
NEC for r=0.4 all KL = 0.24 +- 0.419 (in-sample avg dev_std = 0.446)
NEC for r=0.4 all L1 = 0.149 +- 0.274 (in-sample avg dev_std = 0.446)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096482
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.874
NEC for r=0.8 class 0.0 = 0.298 +- 0.423 (in-sample avg dev_std = 0.456)
NEC for r=0.8 class 1.0 = 0.01 +- 0.423 (in-sample avg dev_std = 0.456)
NEC for r=0.8 all KL = 0.244 +- 0.423 (in-sample avg dev_std = 0.456)
NEC for r=0.8 all L1 = 0.153 +- 0.277 (in-sample avg dev_std = 0.456)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024804399999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.965
NEC for r=0.05 class 0.0 = 0.011 +- 0.112 (in-sample avg dev_std = 0.048)
NEC for r=0.05 class 1.0 = 0.028 +- 0.112 (in-sample avg dev_std = 0.048)
NEC for r=0.05 all KL = 0.018 +- 0.112 (in-sample avg dev_std = 0.048)
NEC for r=0.05 all L1 = 0.02 +- 0.102 (in-sample avg dev_std = 0.048)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0359612
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.96
NEC for r=0.1 class 0.0 = 0.017 +- 0.129 (in-sample avg dev_std = 0.101)
NEC for r=0.1 class 1.0 = 0.035 +- 0.129 (in-sample avg dev_std = 0.101)
NEC for r=0.1 all KL = 0.026 +- 0.129 (in-sample avg dev_std = 0.101)
NEC for r=0.1 all L1 = 0.026 +- 0.113 (in-sample avg dev_std = 0.101)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.049202800000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.949
NEC for r=0.2 class 0.0 = 0.034 +- 0.164 (in-sample avg dev_std = 0.130)
NEC for r=0.2 class 1.0 = 0.042 +- 0.164 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all KL = 0.042 +- 0.164 (in-sample avg dev_std = 0.130)
NEC for r=0.2 all L1 = 0.038 +- 0.138 (in-sample avg dev_std = 0.130)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06235260000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.93
NEC for r=0.4 class 0.0 = 0.071 +- 0.218 (in-sample avg dev_std = 0.160)
NEC for r=0.4 class 1.0 = 0.043 +- 0.218 (in-sample avg dev_std = 0.160)
NEC for r=0.4 all KL = 0.069 +- 0.218 (in-sample avg dev_std = 0.160)
NEC for r=0.4 all L1 = 0.057 +- 0.176 (in-sample avg dev_std = 0.160)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07781400000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.926
NEC for r=0.8 class 0.0 = 0.084 +- 0.239 (in-sample avg dev_std = 0.200)
NEC for r=0.8 class 1.0 = 0.05 +- 0.239 (in-sample avg dev_std = 0.200)
NEC for r=0.8 all KL = 0.089 +- 0.239 (in-sample avg dev_std = 0.200)
NEC for r=0.8 all L1 = 0.067 +- 0.184 (in-sample avg dev_std = 0.200)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 09:27:31 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:27:31 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.046
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.057
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.035
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.839
SUFF_SIMPLE for r=0.05 class 0.0 = 0.651 +- 0.423 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.971 +- 0.423 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.05 all KL = 0.759 +- 0.423 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.05 all L1 = 0.828 +- 0.312 (in-sample avg dev_std = 0.395)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046182
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.84
SUFF_SIMPLE for r=0.1 class 0.0 = 0.652 +- 0.418 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.977 +- 0.418 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.1 all KL = 0.767 +- 0.418 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.1 all L1 = 0.832 +- 0.310 (in-sample avg dev_std = 0.385)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05686
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.842
SUFF_SIMPLE for r=0.2 class 0.0 = 0.644 +- 0.407 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.407 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.407 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.2 all L1 = 0.84 +- 0.312 (in-sample avg dev_std = 0.352)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06764400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.855
SUFF_SIMPLE for r=0.4 class 0.0 = 0.67 +- 0.399 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.399 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.4 all KL = 0.798 +- 0.399 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.4 all L1 = 0.853 +- 0.299 (in-sample avg dev_std = 0.354)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0786
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.886
SUFF_SIMPLE for r=0.8 class 0.0 = 0.748 +- 0.350 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.350 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 all KL = 0.854 +- 0.350 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.8 all L1 = 0.887 +- 0.276 (in-sample avg dev_std = 0.251)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008801999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.727
SUFF_SIMPLE for r=0.05 class 0.0 = 0.584 +- 0.433 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.433 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.05 all KL = 0.747 +- 0.433 (in-sample avg dev_std = 0.025)
SUFF_SIMPLE for r=0.05 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.025)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094696
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.727
SUFF_SIMPLE for r=0.1 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.1 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.1 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.022)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.727
SUFF_SIMPLE for r=0.2 class 0.0 = 0.584 +- 0.433 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.433 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.433 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.2 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.022)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096582
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.727
SUFF_SIMPLE for r=0.4 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.4 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.4 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.030)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097536
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.587 +- 0.433 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.433 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.8 all KL = 0.749 +- 0.433 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.8 all L1 = 0.794 +- 0.359 (in-sample avg dev_std = 0.022)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0250228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.891
SUFF_SIMPLE for r=0.05 class 0.0 = 0.873 +- 0.363 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.363 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.05 all KL = 0.809 +- 0.363 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.05 all L1 = 0.881 +- 0.248 (in-sample avg dev_std = 0.244)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.034944399999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.895
SUFF_SIMPLE for r=0.1 class 0.0 = 0.874 +- 0.331 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.93 +- 0.331 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 all KL = 0.849 +- 0.331 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.1 all L1 = 0.901 +- 0.238 (in-sample avg dev_std = 0.203)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461592
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.9
SUFF_SIMPLE for r=0.2 class 0.0 = 0.88 +- 0.299 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.96 +- 0.299 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.2 all KL = 0.883 +- 0.299 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.2 all L1 = 0.92 +- 0.227 (in-sample avg dev_std = 0.166)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060563
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.908
SUFF_SIMPLE for r=0.4 class 0.0 = 0.889 +- 0.269 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.984 +- 0.269 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all KL = 0.908 +- 0.269 (in-sample avg dev_std = 0.160)
SUFF_SIMPLE for r=0.4 all L1 = 0.936 +- 0.208 (in-sample avg dev_std = 0.160)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.973
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769859999999999
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.951
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.161 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.161 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 all KL = 0.97 +- 0.161 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 all L1 = 0.977 +- 0.127 (in-sample avg dev_std = 0.074)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.978
NEC for r=0.05 class 0.0 = 0.052 +- 0.170 (in-sample avg dev_std = 0.071)
NEC for r=0.05 class 1.0 = 0.0 +- 0.170 (in-sample avg dev_std = 0.071)
NEC for r=0.05 all KL = 0.031 +- 0.170 (in-sample avg dev_std = 0.071)
NEC for r=0.05 all L1 = 0.023 +- 0.132 (in-sample avg dev_std = 0.071)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046182
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.953
NEC for r=0.1 class 0.0 = 0.11 +- 0.258 (in-sample avg dev_std = 0.205)
NEC for r=0.1 class 1.0 = 0.0 +- 0.258 (in-sample avg dev_std = 0.205)
NEC for r=0.1 all KL = 0.075 +- 0.258 (in-sample avg dev_std = 0.205)
NEC for r=0.1 all L1 = 0.049 +- 0.179 (in-sample avg dev_std = 0.205)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05686
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.942
NEC for r=0.2 class 0.0 = 0.156 +- 0.315 (in-sample avg dev_std = 0.299)
NEC for r=0.2 class 1.0 = 0.0 +- 0.315 (in-sample avg dev_std = 0.299)
NEC for r=0.2 all KL = 0.124 +- 0.315 (in-sample avg dev_std = 0.299)
NEC for r=0.2 all L1 = 0.07 +- 0.194 (in-sample avg dev_std = 0.299)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06764400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.946
NEC for r=0.4 class 0.0 = 0.156 +- 0.328 (in-sample avg dev_std = 0.332)
NEC for r=0.4 class 1.0 = 0.003 +- 0.328 (in-sample avg dev_std = 0.332)
NEC for r=0.4 all KL = 0.144 +- 0.328 (in-sample avg dev_std = 0.332)
NEC for r=0.4 all L1 = 0.071 +- 0.180 (in-sample avg dev_std = 0.332)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0786
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.948
NEC for r=0.8 class 0.0 = 0.158 +- 0.332 (in-sample avg dev_std = 0.348)
NEC for r=0.8 class 1.0 = 0.001 +- 0.332 (in-sample avg dev_std = 0.348)
NEC for r=0.8 all KL = 0.152 +- 0.332 (in-sample avg dev_std = 0.348)
NEC for r=0.8 all L1 = 0.071 +- 0.173 (in-sample avg dev_std = 0.348)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008801999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.878
NEC for r=0.05 class 0.0 = 0.148 +- 0.290 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.001 +- 0.290 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.097 +- 0.290 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.074 +- 0.232 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094696
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.779
NEC for r=0.1 class 0.0 = 0.332 +- 0.404 (in-sample avg dev_std = 0.144)
NEC for r=0.1 class 1.0 = 0.001 +- 0.404 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all KL = 0.211 +- 0.404 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all L1 = 0.166 +- 0.327 (in-sample avg dev_std = 0.144)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.77
NEC for r=0.2 class 0.0 = 0.373 +- 0.429 (in-sample avg dev_std = 0.316)
NEC for r=0.2 class 1.0 = 0.001 +- 0.429 (in-sample avg dev_std = 0.316)
NEC for r=0.2 all KL = 0.249 +- 0.429 (in-sample avg dev_std = 0.316)
NEC for r=0.2 all L1 = 0.186 +- 0.331 (in-sample avg dev_std = 0.316)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096582
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.768
NEC for r=0.4 class 0.0 = 0.377 +- 0.431 (in-sample avg dev_std = 0.328)
NEC for r=0.4 class 1.0 = 0.001 +- 0.431 (in-sample avg dev_std = 0.328)
NEC for r=0.4 all KL = 0.251 +- 0.431 (in-sample avg dev_std = 0.328)
NEC for r=0.4 all L1 = 0.188 +- 0.332 (in-sample avg dev_std = 0.328)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097536
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.771
NEC for r=0.8 class 0.0 = 0.375 +- 0.430 (in-sample avg dev_std = 0.340)
NEC for r=0.8 class 1.0 = 0.001 +- 0.430 (in-sample avg dev_std = 0.340)
NEC for r=0.8 all KL = 0.25 +- 0.430 (in-sample avg dev_std = 0.340)
NEC for r=0.8 all L1 = 0.187 +- 0.331 (in-sample avg dev_std = 0.340)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0250228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.965
NEC for r=0.05 class 0.0 = 0.016 +- 0.095 (in-sample avg dev_std = 0.025)
NEC for r=0.05 class 1.0 = 0.002 +- 0.095 (in-sample avg dev_std = 0.025)
NEC for r=0.05 all KL = 0.01 +- 0.095 (in-sample avg dev_std = 0.025)
NEC for r=0.05 all L1 = 0.009 +- 0.082 (in-sample avg dev_std = 0.025)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.034944399999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.962
NEC for r=0.1 class 0.0 = 0.024 +- 0.121 (in-sample avg dev_std = 0.043)
NEC for r=0.1 class 1.0 = 0.003 +- 0.121 (in-sample avg dev_std = 0.043)
NEC for r=0.1 all KL = 0.017 +- 0.121 (in-sample avg dev_std = 0.043)
NEC for r=0.1 all L1 = 0.014 +- 0.099 (in-sample avg dev_std = 0.043)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461592
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.947
NEC for r=0.2 class 0.0 = 0.047 +- 0.168 (in-sample avg dev_std = 0.053)
NEC for r=0.2 class 1.0 = 0.004 +- 0.168 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all KL = 0.033 +- 0.168 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all L1 = 0.026 +- 0.139 (in-sample avg dev_std = 0.053)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060563
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.933
NEC for r=0.4 class 0.0 = 0.074 +- 0.215 (in-sample avg dev_std = 0.119)
NEC for r=0.4 class 1.0 = 0.005 +- 0.215 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all KL = 0.055 +- 0.215 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all L1 = 0.04 +- 0.169 (in-sample avg dev_std = 0.119)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769859999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.924
NEC for r=0.8 class 0.0 = 0.088 +- 0.284 (in-sample avg dev_std = 0.175)
NEC for r=0.8 class 1.0 = 0.047 +- 0.284 (in-sample avg dev_std = 0.175)
NEC for r=0.8 all KL = 0.102 +- 0.284 (in-sample avg dev_std = 0.175)
NEC for r=0.8 all L1 = 0.068 +- 0.202 (in-sample avg dev_std = 0.175)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 09:42:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:42:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.034
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.033142
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.874
SUFF_SIMPLE for r=0.05 class 0.0 = 0.703 +- 0.396 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.991 +- 0.396 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.05 all KL = 0.787 +- 0.396 (in-sample avg dev_std = 0.366)
SUFF_SIMPLE for r=0.05 all L1 = 0.863 +- 0.276 (in-sample avg dev_std = 0.366)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04718000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.879
SUFF_SIMPLE for r=0.1 class 0.0 = 0.71 +- 0.392 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.994 +- 0.392 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 all KL = 0.797 +- 0.392 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.1 all L1 = 0.868 +- 0.274 (in-sample avg dev_std = 0.364)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061318000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.882
SUFF_SIMPLE for r=0.2 class 0.0 = 0.719 +- 0.391 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.996 +- 0.391 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.2 all KL = 0.8 +- 0.391 (in-sample avg dev_std = 0.367)
SUFF_SIMPLE for r=0.2 all L1 = 0.872 +- 0.268 (in-sample avg dev_std = 0.367)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07402600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.878
SUFF_SIMPLE for r=0.4 class 0.0 = 0.714 +- 0.386 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.386 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 all KL = 0.809 +- 0.386 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 all L1 = 0.872 +- 0.276 (in-sample avg dev_std = 0.346)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.934
SUFF_SIMPLE for r=0.8 class 0.0 = 0.851 +- 0.285 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.285 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all KL = 0.908 +- 0.285 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.8 all L1 = 0.933 +- 0.214 (in-sample avg dev_std = 0.229)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008237000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.756
SUFF_SIMPLE for r=0.05 class 0.0 = 0.565 +- 0.487 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.444 +- 0.487 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.05 all L1 = 0.504 +- 0.418 (in-sample avg dev_std = 0.179)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.008912799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.756
SUFF_SIMPLE for r=0.1 class 0.0 = 0.565 +- 0.487 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.444 +- 0.487 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.1 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.177)
SUFF_SIMPLE for r=0.1 all L1 = 0.504 +- 0.418 (in-sample avg dev_std = 0.177)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009259
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.756
SUFF_SIMPLE for r=0.2 class 0.0 = 0.565 +- 0.487 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.444 +- 0.487 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.2 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.179)
SUFF_SIMPLE for r=0.2 all L1 = 0.504 +- 0.418 (in-sample avg dev_std = 0.179)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009552199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.756
SUFF_SIMPLE for r=0.4 class 0.0 = 0.565 +- 0.487 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.4 all L1 = 0.504 +- 0.418 (in-sample avg dev_std = 0.174)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097164
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.758
SUFF_SIMPLE for r=0.8 class 0.0 = 0.572 +- 0.487 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.444 +- 0.487 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.8 all KL = 0.435 +- 0.487 (in-sample avg dev_std = 0.126)
SUFF_SIMPLE for r=0.8 all L1 = 0.507 +- 0.419 (in-sample avg dev_std = 0.126)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249308
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.791
SUFF_SIMPLE for r=0.05 class 0.0 = 0.884 +- 0.314 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.865 +- 0.314 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all KL = 0.815 +- 0.314 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all L1 = 0.875 +- 0.240 (in-sample avg dev_std = 0.264)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0338566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.791
SUFF_SIMPLE for r=0.1 class 0.0 = 0.884 +- 0.317 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.873 +- 0.317 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 all KL = 0.826 +- 0.317 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 all L1 = 0.878 +- 0.243 (in-sample avg dev_std = 0.266)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0458186
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.791
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.314 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.88 +- 0.314 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.2 all KL = 0.838 +- 0.314 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.2 all L1 = 0.883 +- 0.245 (in-sample avg dev_std = 0.257)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0598442
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.793
SUFF_SIMPLE for r=0.4 class 0.0 = 0.887 +- 0.315 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.884 +- 0.315 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.4 all KL = 0.849 +- 0.315 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.4 all L1 = 0.886 +- 0.247 (in-sample avg dev_std = 0.253)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.83
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0774122
len(reference) = 4980
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.84
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.232 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.897 +- 0.232 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.8 all KL = 0.923 +- 0.232 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.8 all L1 = 0.933 +- 0.194 (in-sample avg dev_std = 0.163)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.033142
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.005 +- 0.048 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.048 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.003 +- 0.048 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04718000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.989
NEC for r=0.1 class 0.0 = 0.028 +- 0.136 (in-sample avg dev_std = 0.095)
NEC for r=0.1 class 1.0 = 0.0 +- 0.136 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all KL = 0.022 +- 0.136 (in-sample avg dev_std = 0.095)
NEC for r=0.1 all L1 = 0.012 +- 0.087 (in-sample avg dev_std = 0.095)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061318000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.966
NEC for r=0.2 class 0.0 = 0.085 +- 0.238 (in-sample avg dev_std = 0.195)
NEC for r=0.2 class 1.0 = 0.0 +- 0.238 (in-sample avg dev_std = 0.195)
NEC for r=0.2 all KL = 0.067 +- 0.238 (in-sample avg dev_std = 0.195)
NEC for r=0.2 all L1 = 0.038 +- 0.152 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07402600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.959
NEC for r=0.4 class 0.0 = 0.109 +- 0.272 (in-sample avg dev_std = 0.248)
NEC for r=0.4 class 1.0 = 0.0 +- 0.272 (in-sample avg dev_std = 0.248)
NEC for r=0.4 all KL = 0.092 +- 0.272 (in-sample avg dev_std = 0.248)
NEC for r=0.4 all L1 = 0.049 +- 0.163 (in-sample avg dev_std = 0.248)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.961
NEC for r=0.8 class 0.0 = 0.111 +- 0.287 (in-sample avg dev_std = 0.280)
NEC for r=0.8 class 1.0 = 0.002 +- 0.287 (in-sample avg dev_std = 0.280)
NEC for r=0.8 all KL = 0.105 +- 0.287 (in-sample avg dev_std = 0.280)
NEC for r=0.8 all L1 = 0.051 +- 0.156 (in-sample avg dev_std = 0.280)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008237000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.95
NEC for r=0.05 class 0.0 = 0.002 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.479 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.278 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.242 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.008912799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.95
NEC for r=0.1 class 0.0 = 0.089 +- 0.473 (in-sample avg dev_std = 0.146)
NEC for r=0.1 class 1.0 = 0.551 +- 0.473 (in-sample avg dev_std = 0.146)
NEC for r=0.1 all KL = 0.375 +- 0.473 (in-sample avg dev_std = 0.146)
NEC for r=0.1 all L1 = 0.322 +- 0.406 (in-sample avg dev_std = 0.146)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009259
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.934
NEC for r=0.2 class 0.0 = 0.155 +- 0.480 (in-sample avg dev_std = 0.355)
NEC for r=0.2 class 1.0 = 0.553 +- 0.480 (in-sample avg dev_std = 0.355)
NEC for r=0.2 all KL = 0.462 +- 0.480 (in-sample avg dev_std = 0.355)
NEC for r=0.2 all L1 = 0.355 +- 0.391 (in-sample avg dev_std = 0.355)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009552199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.933
NEC for r=0.4 class 0.0 = 0.164 +- 0.479 (in-sample avg dev_std = 0.379)
NEC for r=0.4 class 1.0 = 0.553 +- 0.479 (in-sample avg dev_std = 0.379)
NEC for r=0.4 all KL = 0.478 +- 0.479 (in-sample avg dev_std = 0.379)
NEC for r=0.4 all L1 = 0.36 +- 0.387 (in-sample avg dev_std = 0.379)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097164
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.932
NEC for r=0.8 class 0.0 = 0.169 +- 0.479 (in-sample avg dev_std = 0.390)
NEC for r=0.8 class 1.0 = 0.553 +- 0.479 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all KL = 0.485 +- 0.479 (in-sample avg dev_std = 0.390)
NEC for r=0.8 all L1 = 0.362 +- 0.385 (in-sample avg dev_std = 0.390)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249308
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.835
NEC for r=0.05 class 0.0 = 0.015 +- 0.129 (in-sample avg dev_std = 0.016)
NEC for r=0.05 class 1.0 = 0.045 +- 0.129 (in-sample avg dev_std = 0.016)
NEC for r=0.05 all KL = 0.024 +- 0.129 (in-sample avg dev_std = 0.016)
NEC for r=0.05 all L1 = 0.03 +- 0.123 (in-sample avg dev_std = 0.016)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0338566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.833
NEC for r=0.1 class 0.0 = 0.02 +- 0.153 (in-sample avg dev_std = 0.097)
NEC for r=0.1 class 1.0 = 0.055 +- 0.153 (in-sample avg dev_std = 0.097)
NEC for r=0.1 all KL = 0.035 +- 0.153 (in-sample avg dev_std = 0.097)
NEC for r=0.1 all L1 = 0.037 +- 0.137 (in-sample avg dev_std = 0.097)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0458186
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.822
NEC for r=0.2 class 0.0 = 0.043 +- 0.200 (in-sample avg dev_std = 0.145)
NEC for r=0.2 class 1.0 = 0.065 +- 0.200 (in-sample avg dev_std = 0.145)
NEC for r=0.2 all KL = 0.059 +- 0.200 (in-sample avg dev_std = 0.145)
NEC for r=0.2 all L1 = 0.054 +- 0.168 (in-sample avg dev_std = 0.145)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0598442
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.804
NEC for r=0.4 class 0.0 = 0.072 +- 0.232 (in-sample avg dev_std = 0.175)
NEC for r=0.4 class 1.0 = 0.063 +- 0.232 (in-sample avg dev_std = 0.175)
NEC for r=0.4 all KL = 0.08 +- 0.232 (in-sample avg dev_std = 0.175)
NEC for r=0.4 all L1 = 0.067 +- 0.190 (in-sample avg dev_std = 0.175)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.828
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0774122
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.8
NEC for r=0.8 class 0.0 = 0.079 +- 0.247 (in-sample avg dev_std = 0.196)
NEC for r=0.8 class 1.0 = 0.073 +- 0.247 (in-sample avg dev_std = 0.196)
NEC for r=0.8 all KL = 0.101 +- 0.247 (in-sample avg dev_std = 0.196)
NEC for r=0.8 all L1 = 0.076 +- 0.193 (in-sample avg dev_std = 0.196)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 09:57:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:57:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.046
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.059
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034836
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.821
SUFF_SIMPLE for r=0.05 class 0.0 = 0.629 +- 0.419 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.908 +- 0.419 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all KL = 0.668 +- 0.419 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all L1 = 0.784 +- 0.297 (in-sample avg dev_std = 0.434)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045554000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.814
SUFF_SIMPLE for r=0.1 class 0.0 = 0.617 +- 0.419 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.908 +- 0.419 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 all KL = 0.66 +- 0.419 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 all L1 = 0.778 +- 0.301 (in-sample avg dev_std = 0.424)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059278000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.826
SUFF_SIMPLE for r=0.2 class 0.0 = 0.622 +- 0.413 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.935 +- 0.413 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 all KL = 0.693 +- 0.413 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 all L1 = 0.795 +- 0.298 (in-sample avg dev_std = 0.393)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070852
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.839
SUFF_SIMPLE for r=0.4 class 0.0 = 0.624 +- 0.408 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.961 +- 0.408 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.4 all KL = 0.719 +- 0.408 (in-sample avg dev_std = 0.348)
SUFF_SIMPLE for r=0.4 all L1 = 0.81 +- 0.295 (in-sample avg dev_std = 0.348)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.887
SUFF_SIMPLE for r=0.8 class 0.0 = 0.736 +- 0.349 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.979 +- 0.349 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 all KL = 0.824 +- 0.349 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 all L1 = 0.87 +- 0.266 (in-sample avg dev_std = 0.199)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085098
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.631
SUFF_SIMPLE for r=0.05 class 0.0 = 0.357 +- 0.458 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.919 +- 0.458 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all KL = 0.561 +- 0.458 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.05 all L1 = 0.64 +- 0.386 (in-sample avg dev_std = 0.227)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091046
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.632
SUFF_SIMPLE for r=0.1 class 0.0 = 0.358 +- 0.458 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.919 +- 0.458 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 all KL = 0.563 +- 0.458 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 all L1 = 0.641 +- 0.387 (in-sample avg dev_std = 0.223)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009589
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.632
SUFF_SIMPLE for r=0.2 class 0.0 = 0.359 +- 0.457 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.919 +- 0.457 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all KL = 0.563 +- 0.457 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all L1 = 0.641 +- 0.387 (in-sample avg dev_std = 0.226)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009715600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.631
SUFF_SIMPLE for r=0.4 class 0.0 = 0.36 +- 0.458 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.918 +- 0.458 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.4 all KL = 0.564 +- 0.458 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.4 all L1 = 0.641 +- 0.387 (in-sample avg dev_std = 0.218)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009750400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.644
SUFF_SIMPLE for r=0.8 class 0.0 = 0.399 +- 0.455 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.919 +- 0.455 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all KL = 0.607 +- 0.455 (in-sample avg dev_std = 0.094)
SUFF_SIMPLE for r=0.8 all L1 = 0.661 +- 0.391 (in-sample avg dev_std = 0.094)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.025713
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.623
SUFF_SIMPLE for r=0.05 class 0.0 = 0.837 +- 0.413 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.594 +- 0.413 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.05 all KL = 0.658 +- 0.413 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.05 all L1 = 0.717 +- 0.333 (in-sample avg dev_std = 0.314)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0365034
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.626
SUFF_SIMPLE for r=0.1 class 0.0 = 0.824 +- 0.406 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.63 +- 0.406 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.1 all KL = 0.675 +- 0.406 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.1 all L1 = 0.728 +- 0.331 (in-sample avg dev_std = 0.291)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0490452
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.642
SUFF_SIMPLE for r=0.2 class 0.0 = 0.818 +- 0.392 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.685 +- 0.392 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.2 all KL = 0.705 +- 0.392 (in-sample avg dev_std = 0.267)
SUFF_SIMPLE for r=0.2 all L1 = 0.753 +- 0.320 (in-sample avg dev_std = 0.267)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0634418
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.652
SUFF_SIMPLE for r=0.4 class 0.0 = 0.824 +- 0.374 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.733 +- 0.374 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all KL = 0.745 +- 0.374 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all L1 = 0.779 +- 0.310 (in-sample avg dev_std = 0.236)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918420000000001
len(reference) = 4980
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.696
SUFF_SIMPLE for r=0.8 class 0.0 = 0.937 +- 0.286 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.787 +- 0.286 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all KL = 0.86 +- 0.286 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all L1 = 0.863 +- 0.250 (in-sample avg dev_std = 0.112)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034836
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.99
NEC for r=0.05 class 0.0 = 0.051 +- 0.134 (in-sample avg dev_std = 0.040)
NEC for r=0.05 class 1.0 = 0.007 +- 0.134 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all KL = 0.029 +- 0.134 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all L1 = 0.027 +- 0.111 (in-sample avg dev_std = 0.040)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045554000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.975
NEC for r=0.1 class 0.0 = 0.079 +- 0.199 (in-sample avg dev_std = 0.120)
NEC for r=0.1 class 1.0 = 0.012 +- 0.199 (in-sample avg dev_std = 0.120)
NEC for r=0.1 all KL = 0.058 +- 0.199 (in-sample avg dev_std = 0.120)
NEC for r=0.1 all L1 = 0.042 +- 0.140 (in-sample avg dev_std = 0.120)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059278000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.956
NEC for r=0.2 class 0.0 = 0.125 +- 0.262 (in-sample avg dev_std = 0.209)
NEC for r=0.2 class 1.0 = 0.014 +- 0.262 (in-sample avg dev_std = 0.209)
NEC for r=0.2 all KL = 0.101 +- 0.262 (in-sample avg dev_std = 0.209)
NEC for r=0.2 all L1 = 0.064 +- 0.169 (in-sample avg dev_std = 0.209)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070852
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.941
NEC for r=0.4 class 0.0 = 0.161 +- 0.291 (in-sample avg dev_std = 0.258)
NEC for r=0.4 class 1.0 = 0.018 +- 0.291 (in-sample avg dev_std = 0.258)
NEC for r=0.4 all KL = 0.134 +- 0.291 (in-sample avg dev_std = 0.258)
NEC for r=0.4 all L1 = 0.082 +- 0.191 (in-sample avg dev_std = 0.258)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.943
NEC for r=0.8 class 0.0 = 0.16 +- 0.298 (in-sample avg dev_std = 0.300)
NEC for r=0.8 class 1.0 = 0.027 +- 0.298 (in-sample avg dev_std = 0.300)
NEC for r=0.8 all KL = 0.149 +- 0.298 (in-sample avg dev_std = 0.300)
NEC for r=0.8 all L1 = 0.086 +- 0.182 (in-sample avg dev_std = 0.300)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085098
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.893
NEC for r=0.05 class 0.0 = 0.165 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.072 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.12 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.118 +- 0.241 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091046
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.799
NEC for r=0.1 class 0.0 = 0.348 +- 0.388 (in-sample avg dev_std = 0.127)
NEC for r=0.1 class 1.0 = 0.08 +- 0.388 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all KL = 0.254 +- 0.388 (in-sample avg dev_std = 0.127)
NEC for r=0.1 all L1 = 0.213 +- 0.323 (in-sample avg dev_std = 0.127)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009589
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.781
NEC for r=0.2 class 0.0 = 0.399 +- 0.413 (in-sample avg dev_std = 0.291)
NEC for r=0.2 class 1.0 = 0.083 +- 0.413 (in-sample avg dev_std = 0.291)
NEC for r=0.2 all KL = 0.306 +- 0.413 (in-sample avg dev_std = 0.291)
NEC for r=0.2 all L1 = 0.24 +- 0.326 (in-sample avg dev_std = 0.291)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009715600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.782
NEC for r=0.4 class 0.0 = 0.407 +- 0.417 (in-sample avg dev_std = 0.328)
NEC for r=0.4 class 1.0 = 0.082 +- 0.417 (in-sample avg dev_std = 0.328)
NEC for r=0.4 all KL = 0.318 +- 0.417 (in-sample avg dev_std = 0.328)
NEC for r=0.4 all L1 = 0.243 +- 0.323 (in-sample avg dev_std = 0.328)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009750400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.779
NEC for r=0.8 class 0.0 = 0.414 +- 0.419 (in-sample avg dev_std = 0.342)
NEC for r=0.8 class 1.0 = 0.083 +- 0.419 (in-sample avg dev_std = 0.342)
NEC for r=0.8 all KL = 0.325 +- 0.419 (in-sample avg dev_std = 0.342)
NEC for r=0.8 all L1 = 0.247 +- 0.323 (in-sample avg dev_std = 0.342)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.025713
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.668
NEC for r=0.05 class 0.0 = 0.031 +- 0.161 (in-sample avg dev_std = 0.033)
NEC for r=0.05 class 1.0 = 0.108 +- 0.161 (in-sample avg dev_std = 0.033)
NEC for r=0.05 all KL = 0.05 +- 0.161 (in-sample avg dev_std = 0.033)
NEC for r=0.05 all L1 = 0.069 +- 0.165 (in-sample avg dev_std = 0.033)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0365034
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.675
NEC for r=0.1 class 0.0 = 0.043 +- 0.215 (in-sample avg dev_std = 0.089)
NEC for r=0.1 class 1.0 = 0.145 +- 0.215 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all KL = 0.083 +- 0.215 (in-sample avg dev_std = 0.089)
NEC for r=0.1 all L1 = 0.094 +- 0.201 (in-sample avg dev_std = 0.089)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0490452
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.667
NEC for r=0.2 class 0.0 = 0.069 +- 0.257 (in-sample avg dev_std = 0.136)
NEC for r=0.2 class 1.0 = 0.167 +- 0.257 (in-sample avg dev_std = 0.136)
NEC for r=0.2 all KL = 0.117 +- 0.257 (in-sample avg dev_std = 0.136)
NEC for r=0.2 all L1 = 0.117 +- 0.227 (in-sample avg dev_std = 0.136)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0634418
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.646
NEC for r=0.4 class 0.0 = 0.114 +- 0.307 (in-sample avg dev_std = 0.191)
NEC for r=0.4 class 1.0 = 0.188 +- 0.307 (in-sample avg dev_std = 0.191)
NEC for r=0.4 all KL = 0.164 +- 0.307 (in-sample avg dev_std = 0.191)
NEC for r=0.4 all L1 = 0.15 +- 0.260 (in-sample avg dev_std = 0.191)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.657
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918420000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.63
NEC for r=0.8 class 0.0 = 0.136 +- 0.354 (in-sample avg dev_std = 0.261)
NEC for r=0.8 class 1.0 = 0.253 +- 0.354 (in-sample avg dev_std = 0.261)
NEC for r=0.8 all KL = 0.226 +- 0.354 (in-sample avg dev_std = 0.261)
NEC for r=0.8 all L1 = 0.194 +- 0.288 (in-sample avg dev_std = 0.261)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 10:13:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:13:03 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.045
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.072
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.035
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032502
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.804
SUFF_SIMPLE for r=0.05 class 0.0 = 0.6 +- 0.427 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.921 +- 0.427 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.05 all KL = 0.668 +- 0.427 (in-sample avg dev_std = 0.394)
SUFF_SIMPLE for r=0.05 all L1 = 0.778 +- 0.316 (in-sample avg dev_std = 0.394)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045287999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.807
SUFF_SIMPLE for r=0.1 class 0.0 = 0.611 +- 0.423 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.922 +- 0.423 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 all KL = 0.676 +- 0.423 (in-sample avg dev_std = 0.382)
SUFF_SIMPLE for r=0.1 all L1 = 0.783 +- 0.312 (in-sample avg dev_std = 0.382)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055628
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.82
SUFF_SIMPLE for r=0.2 class 0.0 = 0.592 +- 0.420 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.958 +- 0.420 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.2 all KL = 0.695 +- 0.420 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.2 all L1 = 0.794 +- 0.309 (in-sample avg dev_std = 0.377)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.072182
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.812
SUFF_SIMPLE for r=0.4 class 0.0 = 0.584 +- 0.423 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.961 +- 0.423 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 all KL = 0.704 +- 0.423 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 all L1 = 0.793 +- 0.318 (in-sample avg dev_std = 0.346)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.875
SUFF_SIMPLE for r=0.8 class 0.0 = 0.696 +- 0.372 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.983 +- 0.372 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.8 all KL = 0.792 +- 0.372 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.8 all L1 = 0.855 +- 0.278 (in-sample avg dev_std = 0.227)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008719999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.712
SUFF_SIMPLE for r=0.05 class 0.0 = 0.449 +- 0.457 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.573 +- 0.457 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all KL = 0.369 +- 0.457 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all L1 = 0.512 +- 0.378 (in-sample avg dev_std = 0.425)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093566
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.713
SUFF_SIMPLE for r=0.1 class 0.0 = 0.448 +- 0.458 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.572 +- 0.458 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.1 all KL = 0.367 +- 0.458 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.1 all L1 = 0.511 +- 0.378 (in-sample avg dev_std = 0.420)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095666
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.713
SUFF_SIMPLE for r=0.2 class 0.0 = 0.448 +- 0.458 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.573 +- 0.458 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.2 all KL = 0.366 +- 0.458 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.2 all L1 = 0.511 +- 0.377 (in-sample avg dev_std = 0.424)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.713
SUFF_SIMPLE for r=0.4 class 0.0 = 0.45 +- 0.459 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.572 +- 0.459 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.4 all KL = 0.37 +- 0.459 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.4 all L1 = 0.512 +- 0.379 (in-sample avg dev_std = 0.415)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009791999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.746
SUFF_SIMPLE for r=0.8 class 0.0 = 0.546 +- 0.477 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.577 +- 0.477 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 all KL = 0.466 +- 0.477 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.8 all L1 = 0.562 +- 0.404 (in-sample avg dev_std = 0.200)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0257466
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.597
SUFF_SIMPLE for r=0.05 class 0.0 = 0.807 +- 0.428 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.625 +- 0.428 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.05 all KL = 0.607 +- 0.428 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.05 all L1 = 0.717 +- 0.340 (in-sample avg dev_std = 0.354)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035068600000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.603
SUFF_SIMPLE for r=0.1 class 0.0 = 0.801 +- 0.423 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.658 +- 0.423 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all KL = 0.621 +- 0.423 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all L1 = 0.73 +- 0.334 (in-sample avg dev_std = 0.338)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0466994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.617
SUFF_SIMPLE for r=0.2 class 0.0 = 0.792 +- 0.413 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.718 +- 0.413 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.2 all KL = 0.657 +- 0.413 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.2 all L1 = 0.755 +- 0.325 (in-sample avg dev_std = 0.320)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0622812
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.625
SUFF_SIMPLE for r=0.4 class 0.0 = 0.805 +- 0.395 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.78 +- 0.395 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all KL = 0.71 +- 0.395 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.4 all L1 = 0.793 +- 0.307 (in-sample avg dev_std = 0.290)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828580000000002
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.684
SUFF_SIMPLE for r=0.8 class 0.0 = 0.924 +- 0.307 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.84 +- 0.307 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.8 all KL = 0.857 +- 0.307 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.8 all L1 = 0.883 +- 0.245 (in-sample avg dev_std = 0.176)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032502
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.983
NEC for r=0.05 class 0.0 = 0.043 +- 0.135 (in-sample avg dev_std = 0.045)
NEC for r=0.05 class 1.0 = 0.012 +- 0.135 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all KL = 0.027 +- 0.135 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all L1 = 0.026 +- 0.116 (in-sample avg dev_std = 0.045)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045287999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.961
NEC for r=0.1 class 0.0 = 0.108 +- 0.235 (in-sample avg dev_std = 0.137)
NEC for r=0.1 class 1.0 = 0.011 +- 0.235 (in-sample avg dev_std = 0.137)
NEC for r=0.1 all KL = 0.074 +- 0.235 (in-sample avg dev_std = 0.137)
NEC for r=0.1 all L1 = 0.054 +- 0.172 (in-sample avg dev_std = 0.137)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055628
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.923
NEC for r=0.2 class 0.0 = 0.175 +- 0.305 (in-sample avg dev_std = 0.220)
NEC for r=0.2 class 1.0 = 0.024 +- 0.305 (in-sample avg dev_std = 0.220)
NEC for r=0.2 all KL = 0.131 +- 0.305 (in-sample avg dev_std = 0.220)
NEC for r=0.2 all L1 = 0.091 +- 0.223 (in-sample avg dev_std = 0.220)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.072182
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.921
NEC for r=0.4 class 0.0 = 0.193 +- 0.324 (in-sample avg dev_std = 0.280)
NEC for r=0.4 class 1.0 = 0.026 +- 0.324 (in-sample avg dev_std = 0.280)
NEC for r=0.4 all KL = 0.159 +- 0.324 (in-sample avg dev_std = 0.280)
NEC for r=0.4 all L1 = 0.101 +- 0.221 (in-sample avg dev_std = 0.280)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.924
NEC for r=0.8 class 0.0 = 0.203 +- 0.329 (in-sample avg dev_std = 0.317)
NEC for r=0.8 class 1.0 = 0.022 +- 0.329 (in-sample avg dev_std = 0.317)
NEC for r=0.8 all KL = 0.166 +- 0.329 (in-sample avg dev_std = 0.317)
NEC for r=0.8 all L1 = 0.103 +- 0.218 (in-sample avg dev_std = 0.317)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008719999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.829
NEC for r=0.05 class 0.0 = 0.019 +- 0.295 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.189 +- 0.295 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.123 +- 0.295 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.104 +- 0.248 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093566
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.858
NEC for r=0.1 class 0.0 = 0.089 +- 0.399 (in-sample avg dev_std = 0.136)
NEC for r=0.1 class 1.0 = 0.293 +- 0.399 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all KL = 0.242 +- 0.399 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all L1 = 0.192 +- 0.326 (in-sample avg dev_std = 0.136)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095666
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.858
NEC for r=0.2 class 0.0 = 0.132 +- 0.435 (in-sample avg dev_std = 0.356)
NEC for r=0.2 class 1.0 = 0.323 +- 0.435 (in-sample avg dev_std = 0.356)
NEC for r=0.2 all KL = 0.329 +- 0.435 (in-sample avg dev_std = 0.356)
NEC for r=0.2 all L1 = 0.228 +- 0.326 (in-sample avg dev_std = 0.356)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.859
NEC for r=0.4 class 0.0 = 0.14 +- 0.440 (in-sample avg dev_std = 0.394)
NEC for r=0.4 class 1.0 = 0.33 +- 0.440 (in-sample avg dev_std = 0.394)
NEC for r=0.4 all KL = 0.359 +- 0.440 (in-sample avg dev_std = 0.394)
NEC for r=0.4 all L1 = 0.236 +- 0.320 (in-sample avg dev_std = 0.394)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009791999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.854
NEC for r=0.8 class 0.0 = 0.143 +- 0.442 (in-sample avg dev_std = 0.413)
NEC for r=0.8 class 1.0 = 0.329 +- 0.442 (in-sample avg dev_std = 0.413)
NEC for r=0.8 all KL = 0.37 +- 0.442 (in-sample avg dev_std = 0.413)
NEC for r=0.8 all L1 = 0.237 +- 0.316 (in-sample avg dev_std = 0.413)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0257466
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.666
NEC for r=0.05 class 0.0 = 0.033 +- 0.174 (in-sample avg dev_std = 0.042)
NEC for r=0.05 class 1.0 = 0.079 +- 0.174 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all KL = 0.049 +- 0.174 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all L1 = 0.055 +- 0.163 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035068600000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.672
NEC for r=0.1 class 0.0 = 0.047 +- 0.233 (in-sample avg dev_std = 0.125)
NEC for r=0.1 class 1.0 = 0.112 +- 0.233 (in-sample avg dev_std = 0.125)
NEC for r=0.1 all KL = 0.084 +- 0.233 (in-sample avg dev_std = 0.125)
NEC for r=0.1 all L1 = 0.079 +- 0.199 (in-sample avg dev_std = 0.125)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0466994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.659
NEC for r=0.2 class 0.0 = 0.079 +- 0.287 (in-sample avg dev_std = 0.191)
NEC for r=0.2 class 1.0 = 0.135 +- 0.287 (in-sample avg dev_std = 0.191)
NEC for r=0.2 all KL = 0.13 +- 0.287 (in-sample avg dev_std = 0.191)
NEC for r=0.2 all L1 = 0.107 +- 0.230 (in-sample avg dev_std = 0.191)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0622812
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.635
NEC for r=0.4 class 0.0 = 0.129 +- 0.333 (in-sample avg dev_std = 0.245)
NEC for r=0.4 class 1.0 = 0.156 +- 0.333 (in-sample avg dev_std = 0.245)
NEC for r=0.4 all KL = 0.187 +- 0.333 (in-sample avg dev_std = 0.245)
NEC for r=0.4 all L1 = 0.142 +- 0.262 (in-sample avg dev_std = 0.245)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828580000000002
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.613
NEC for r=0.8 class 0.0 = 0.164 +- 0.385 (in-sample avg dev_std = 0.303)
NEC for r=0.8 class 1.0 = 0.234 +- 0.385 (in-sample avg dev_std = 0.303)
NEC for r=0.8 all KL = 0.27 +- 0.385 (in-sample avg dev_std = 0.303)
NEC for r=0.8 all L1 = 0.198 +- 0.303 (in-sample avg dev_std = 0.303)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 10:28:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:28:30 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.069
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.024
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.034
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034603999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.919
SUFF_SIMPLE for r=0.05 class 0.0 = 0.81 +- 0.358 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.974 +- 0.358 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all KL = 0.825 +- 0.358 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.05 all L1 = 0.901 +- 0.227 (in-sample avg dev_std = 0.333)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046728
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.911
SUFF_SIMPLE for r=0.1 class 0.0 = 0.812 +- 0.360 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.969 +- 0.360 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all KL = 0.819 +- 0.360 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all L1 = 0.899 +- 0.231 (in-sample avg dev_std = 0.335)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056165999999999994
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.912
SUFF_SIMPLE for r=0.2 class 0.0 = 0.796 +- 0.360 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.983 +- 0.360 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.2 all KL = 0.827 +- 0.360 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.2 all L1 = 0.9 +- 0.235 (in-sample avg dev_std = 0.335)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06944800000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.923
SUFF_SIMPLE for r=0.4 class 0.0 = 0.81 +- 0.347 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.991 +- 0.347 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.4 all KL = 0.84 +- 0.347 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.220 (in-sample avg dev_std = 0.320)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.968
SUFF_SIMPLE for r=0.8 class 0.0 = 0.926 +- 0.220 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.996 +- 0.220 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.220 (in-sample avg dev_std = 0.169)
SUFF_SIMPLE for r=0.8 all L1 = 0.965 +- 0.152 (in-sample avg dev_std = 0.169)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0079212
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.799
SUFF_SIMPLE for r=0.05 class 0.0 = 0.651 +- 0.468 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.363 +- 0.468 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.05 all KL = 0.381 +- 0.468 (in-sample avg dev_std = 0.364)
SUFF_SIMPLE for r=0.05 all L1 = 0.506 +- 0.383 (in-sample avg dev_std = 0.364)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0087958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.801
SUFF_SIMPLE for r=0.1 class 0.0 = 0.652 +- 0.468 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.363 +- 0.468 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.1 all KL = 0.381 +- 0.468 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.1 all L1 = 0.506 +- 0.383 (in-sample avg dev_std = 0.372)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094218
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.8
SUFF_SIMPLE for r=0.2 class 0.0 = 0.652 +- 0.468 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.363 +- 0.468 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.2 all KL = 0.382 +- 0.468 (in-sample avg dev_std = 0.363)
SUFF_SIMPLE for r=0.2 all L1 = 0.506 +- 0.383 (in-sample avg dev_std = 0.363)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009572
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.8
SUFF_SIMPLE for r=0.4 class 0.0 = 0.653 +- 0.468 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.363 +- 0.468 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.4 all KL = 0.382 +- 0.468 (in-sample avg dev_std = 0.362)
SUFF_SIMPLE for r=0.4 all L1 = 0.507 +- 0.383 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.00968
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.818
SUFF_SIMPLE for r=0.8 class 0.0 = 0.717 +- 0.480 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.364 +- 0.480 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.8 all KL = 0.443 +- 0.480 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.8 all L1 = 0.539 +- 0.402 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0240774
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.747
SUFF_SIMPLE for r=0.05 class 0.0 = 0.877 +- 0.405 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.799 +- 0.405 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 all KL = 0.73 +- 0.405 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.05 all L1 = 0.839 +- 0.270 (in-sample avg dev_std = 0.324)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.033907799999999995
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.755
SUFF_SIMPLE for r=0.1 class 0.0 = 0.874 +- 0.388 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.83 +- 0.388 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 all KL = 0.765 +- 0.388 (in-sample avg dev_std = 0.302)
SUFF_SIMPLE for r=0.1 all L1 = 0.852 +- 0.272 (in-sample avg dev_std = 0.302)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.76
SUFF_SIMPLE for r=0.2 class 0.0 = 0.878 +- 0.366 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.863 +- 0.366 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 all KL = 0.804 +- 0.366 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.2 all L1 = 0.871 +- 0.266 (in-sample avg dev_std = 0.278)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0606546
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.763
SUFF_SIMPLE for r=0.4 class 0.0 = 0.884 +- 0.349 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.884 +- 0.349 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.4 all KL = 0.83 +- 0.349 (in-sample avg dev_std = 0.274)
SUFF_SIMPLE for r=0.4 all L1 = 0.884 +- 0.257 (in-sample avg dev_std = 0.274)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.799
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07728800000000001
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.817
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.252 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.905 +- 0.252 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.8 all KL = 0.923 +- 0.252 (in-sample avg dev_std = 0.139)
SUFF_SIMPLE for r=0.8 all L1 = 0.938 +- 0.203 (in-sample avg dev_std = 0.139)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034603999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046728
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  1.0
NEC for r=0.1 class 0.0 = 0.0 +- 0.003 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.0 +- 0.003 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.0 +- 0.003 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056165999999999994
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.994
NEC for r=0.2 class 0.0 = 0.015 +- 0.102 (in-sample avg dev_std = 0.070)
NEC for r=0.2 class 1.0 = 0.001 +- 0.102 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all KL = 0.014 +- 0.102 (in-sample avg dev_std = 0.070)
NEC for r=0.2 all L1 = 0.007 +- 0.064 (in-sample avg dev_std = 0.070)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06944800000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.984
NEC for r=0.4 class 0.0 = 0.04 +- 0.179 (in-sample avg dev_std = 0.171)
NEC for r=0.4 class 1.0 = 0.004 +- 0.179 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all KL = 0.039 +- 0.179 (in-sample avg dev_std = 0.171)
NEC for r=0.4 all L1 = 0.02 +- 0.103 (in-sample avg dev_std = 0.171)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.983
NEC for r=0.8 class 0.0 = 0.046 +- 0.208 (in-sample avg dev_std = 0.202)
NEC for r=0.8 class 1.0 = 0.009 +- 0.208 (in-sample avg dev_std = 0.202)
NEC for r=0.8 all KL = 0.06 +- 0.208 (in-sample avg dev_std = 0.202)
NEC for r=0.8 all L1 = 0.026 +- 0.104 (in-sample avg dev_std = 0.202)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0079212
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.822
NEC for r=0.05 class 0.0 = 0.0 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.394 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.24 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.199 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0087958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.914
NEC for r=0.1 class 0.0 = 0.011 +- 0.458 (in-sample avg dev_std = 0.148)
NEC for r=0.1 class 1.0 = 0.559 +- 0.458 (in-sample avg dev_std = 0.148)
NEC for r=0.1 all KL = 0.348 +- 0.458 (in-sample avg dev_std = 0.148)
NEC for r=0.1 all L1 = 0.287 +- 0.381 (in-sample avg dev_std = 0.148)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094218
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.912
NEC for r=0.2 class 0.0 = 0.032 +- 0.466 (in-sample avg dev_std = 0.310)
NEC for r=0.2 class 1.0 = 0.579 +- 0.466 (in-sample avg dev_std = 0.310)
NEC for r=0.2 all KL = 0.402 +- 0.466 (in-sample avg dev_std = 0.310)
NEC for r=0.2 all L1 = 0.307 +- 0.373 (in-sample avg dev_std = 0.310)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009572
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.915
NEC for r=0.4 class 0.0 = 0.035 +- 0.465 (in-sample avg dev_std = 0.336)
NEC for r=0.4 class 1.0 = 0.585 +- 0.465 (in-sample avg dev_std = 0.336)
NEC for r=0.4 all KL = 0.416 +- 0.465 (in-sample avg dev_std = 0.336)
NEC for r=0.4 all L1 = 0.312 +- 0.371 (in-sample avg dev_std = 0.336)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.00968
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.915
NEC for r=0.8 class 0.0 = 0.037 +- 0.467 (in-sample avg dev_std = 0.345)
NEC for r=0.8 class 1.0 = 0.588 +- 0.467 (in-sample avg dev_std = 0.345)
NEC for r=0.8 all KL = 0.419 +- 0.467 (in-sample avg dev_std = 0.345)
NEC for r=0.8 all L1 = 0.315 +- 0.372 (in-sample avg dev_std = 0.345)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0240774
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.807
NEC for r=0.05 class 0.0 = 0.01 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.04 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.024 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.025 +- 0.125 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.033907799999999995
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.807
NEC for r=0.1 class 0.0 = 0.016 +- 0.175 (in-sample avg dev_std = 0.093)
NEC for r=0.1 class 1.0 = 0.054 +- 0.175 (in-sample avg dev_std = 0.093)
NEC for r=0.1 all KL = 0.041 +- 0.175 (in-sample avg dev_std = 0.093)
NEC for r=0.1 all L1 = 0.035 +- 0.148 (in-sample avg dev_std = 0.093)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.797
NEC for r=0.2 class 0.0 = 0.032 +- 0.217 (in-sample avg dev_std = 0.152)
NEC for r=0.2 class 1.0 = 0.063 +- 0.217 (in-sample avg dev_std = 0.152)
NEC for r=0.2 all KL = 0.062 +- 0.217 (in-sample avg dev_std = 0.152)
NEC for r=0.2 all L1 = 0.048 +- 0.169 (in-sample avg dev_std = 0.152)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0606546
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.776
NEC for r=0.4 class 0.0 = 0.069 +- 0.269 (in-sample avg dev_std = 0.197)
NEC for r=0.4 class 1.0 = 0.071 +- 0.269 (in-sample avg dev_std = 0.197)
NEC for r=0.4 all KL = 0.098 +- 0.269 (in-sample avg dev_std = 0.197)
NEC for r=0.4 all L1 = 0.07 +- 0.205 (in-sample avg dev_std = 0.197)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.798
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07728800000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.766
NEC for r=0.8 class 0.0 = 0.085 +- 0.327 (in-sample avg dev_std = 0.247)
NEC for r=0.8 class 1.0 = 0.112 +- 0.327 (in-sample avg dev_std = 0.247)
NEC for r=0.8 all KL = 0.156 +- 0.327 (in-sample avg dev_std = 0.247)
NEC for r=0.8 all L1 = 0.099 +- 0.226 (in-sample avg dev_std = 0.247)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 10:43:24 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:43:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.034
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.044
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.069
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.903
SUFF_SIMPLE for r=0.05 class 0.0 = 0.795 +- 0.371 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.962 +- 0.371 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.05 all KL = 0.812 +- 0.371 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.05 all L1 = 0.888 +- 0.247 (in-sample avg dev_std = 0.334)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043786
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.896
SUFF_SIMPLE for r=0.1 class 0.0 = 0.795 +- 0.370 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.957 +- 0.370 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.1 all KL = 0.807 +- 0.370 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.1 all L1 = 0.885 +- 0.251 (in-sample avg dev_std = 0.311)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055574
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.9
SUFF_SIMPLE for r=0.2 class 0.0 = 0.78 +- 0.363 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.981 +- 0.363 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.2 all KL = 0.822 +- 0.363 (in-sample avg dev_std = 0.298)
SUFF_SIMPLE for r=0.2 all L1 = 0.891 +- 0.248 (in-sample avg dev_std = 0.298)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06853200000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.91
SUFF_SIMPLE for r=0.4 class 0.0 = 0.795 +- 0.342 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.342 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all KL = 0.852 +- 0.342 (in-sample avg dev_std = 0.276)
SUFF_SIMPLE for r=0.4 all L1 = 0.905 +- 0.240 (in-sample avg dev_std = 0.276)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07941600000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.962
SUFF_SIMPLE for r=0.8 class 0.0 = 0.911 +- 0.230 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.230 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.230 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.8 all L1 = 0.96 +- 0.163 (in-sample avg dev_std = 0.149)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086168
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.775
SUFF_SIMPLE for r=0.05 class 0.0 = 0.711 +- 0.456 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.364 +- 0.456 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 all KL = 0.384 +- 0.456 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 all L1 = 0.537 +- 0.381 (in-sample avg dev_std = 0.371)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009078600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.777
SUFF_SIMPLE for r=0.1 class 0.0 = 0.714 +- 0.457 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.365 +- 0.457 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.1 all KL = 0.386 +- 0.457 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.1 all L1 = 0.538 +- 0.381 (in-sample avg dev_std = 0.375)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094518
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.777
SUFF_SIMPLE for r=0.2 class 0.0 = 0.715 +- 0.457 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.365 +- 0.457 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.2 all KL = 0.386 +- 0.457 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.2 all L1 = 0.538 +- 0.381 (in-sample avg dev_std = 0.370)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096226
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.776
SUFF_SIMPLE for r=0.4 class 0.0 = 0.716 +- 0.457 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.365 +- 0.457 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.4 all KL = 0.387 +- 0.457 (in-sample avg dev_std = 0.370)
SUFF_SIMPLE for r=0.4 all L1 = 0.539 +- 0.381 (in-sample avg dev_std = 0.370)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.802
SUFF_SIMPLE for r=0.8 class 0.0 = 0.789 +- 0.472 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.366 +- 0.472 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.8 all KL = 0.459 +- 0.472 (in-sample avg dev_std = 0.174)
SUFF_SIMPLE for r=0.8 all L1 = 0.576 +- 0.399 (in-sample avg dev_std = 0.174)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0267322
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.698
SUFF_SIMPLE for r=0.05 class 0.0 = 0.878 +- 0.416 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.713 +- 0.416 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.05 all KL = 0.707 +- 0.416 (in-sample avg dev_std = 0.349)
SUFF_SIMPLE for r=0.05 all L1 = 0.797 +- 0.311 (in-sample avg dev_std = 0.349)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035812000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.706
SUFF_SIMPLE for r=0.1 class 0.0 = 0.869 +- 0.400 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.764 +- 0.400 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 all KL = 0.74 +- 0.400 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 all L1 = 0.817 +- 0.303 (in-sample avg dev_std = 0.312)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048664400000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.722
SUFF_SIMPLE for r=0.2 class 0.0 = 0.877 +- 0.372 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.372 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.372 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.2 all L1 = 0.85 +- 0.281 (in-sample avg dev_std = 0.288)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.062375
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.739
SUFF_SIMPLE for r=0.4 class 0.0 = 0.883 +- 0.344 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.872 +- 0.344 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.4 all KL = 0.828 +- 0.344 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.4 all L1 = 0.878 +- 0.260 (in-sample avg dev_std = 0.279)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.771
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0787262
len(reference) = 4988
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.785
SUFF_SIMPLE for r=0.8 class 0.0 = 0.965 +- 0.255 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.897 +- 0.255 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all KL = 0.915 +- 0.255 (in-sample avg dev_std = 0.140)
SUFF_SIMPLE for r=0.8 all L1 = 0.931 +- 0.206 (in-sample avg dev_std = 0.140)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.024 (in-sample avg dev_std = 0.019)
NEC for r=0.05 class 1.0 = 0.001 +- 0.024 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all KL = 0.001 +- 0.024 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all L1 = 0.001 +- 0.010 (in-sample avg dev_std = 0.019)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043786
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.995
NEC for r=0.1 class 0.0 = 0.011 +- 0.094 (in-sample avg dev_std = 0.035)
NEC for r=0.1 class 1.0 = 0.004 +- 0.094 (in-sample avg dev_std = 0.035)
NEC for r=0.1 all KL = 0.012 +- 0.094 (in-sample avg dev_std = 0.035)
NEC for r=0.1 all L1 = 0.007 +- 0.064 (in-sample avg dev_std = 0.035)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055574
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.981
NEC for r=0.2 class 0.0 = 0.041 +- 0.165 (in-sample avg dev_std = 0.112)
NEC for r=0.2 class 1.0 = 0.005 +- 0.165 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all KL = 0.034 +- 0.165 (in-sample avg dev_std = 0.112)
NEC for r=0.2 all L1 = 0.021 +- 0.115 (in-sample avg dev_std = 0.112)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06853200000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.979
NEC for r=0.4 class 0.0 = 0.055 +- 0.204 (in-sample avg dev_std = 0.182)
NEC for r=0.4 class 1.0 = 0.004 +- 0.204 (in-sample avg dev_std = 0.182)
NEC for r=0.4 all KL = 0.053 +- 0.204 (in-sample avg dev_std = 0.182)
NEC for r=0.4 all L1 = 0.027 +- 0.119 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07941600000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.975
NEC for r=0.8 class 0.0 = 0.061 +- 0.227 (in-sample avg dev_std = 0.210)
NEC for r=0.8 class 1.0 = 0.009 +- 0.227 (in-sample avg dev_std = 0.210)
NEC for r=0.8 all KL = 0.069 +- 0.227 (in-sample avg dev_std = 0.210)
NEC for r=0.8 all L1 = 0.032 +- 0.121 (in-sample avg dev_std = 0.210)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086168
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.733
NEC for r=0.05 class 0.0 = 0.0 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.33 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.208 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.166 +- 0.315 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009078600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.845
NEC for r=0.1 class 0.0 = 0.005 +- 0.453 (in-sample avg dev_std = 0.144)
NEC for r=0.1 class 1.0 = 0.533 +- 0.453 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all KL = 0.343 +- 0.453 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all L1 = 0.271 +- 0.374 (in-sample avg dev_std = 0.144)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094518
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.846
NEC for r=0.2 class 0.0 = 0.019 +- 0.463 (in-sample avg dev_std = 0.305)
NEC for r=0.2 class 1.0 = 0.559 +- 0.463 (in-sample avg dev_std = 0.305)
NEC for r=0.2 all KL = 0.392 +- 0.463 (in-sample avg dev_std = 0.305)
NEC for r=0.2 all L1 = 0.291 +- 0.368 (in-sample avg dev_std = 0.305)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096226
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.848
NEC for r=0.4 class 0.0 = 0.021 +- 0.462 (in-sample avg dev_std = 0.341)
NEC for r=0.4 class 1.0 = 0.567 +- 0.462 (in-sample avg dev_std = 0.341)
NEC for r=0.4 all KL = 0.407 +- 0.462 (in-sample avg dev_std = 0.341)
NEC for r=0.4 all L1 = 0.296 +- 0.366 (in-sample avg dev_std = 0.341)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.846
NEC for r=0.8 class 0.0 = 0.021 +- 0.462 (in-sample avg dev_std = 0.354)
NEC for r=0.8 class 1.0 = 0.566 +- 0.462 (in-sample avg dev_std = 0.354)
NEC for r=0.8 all KL = 0.408 +- 0.462 (in-sample avg dev_std = 0.354)
NEC for r=0.8 all L1 = 0.296 +- 0.365 (in-sample avg dev_std = 0.354)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0267322
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.776
NEC for r=0.05 class 0.0 = 0.015 +- 0.146 (in-sample avg dev_std = 0.002)
NEC for r=0.05 class 1.0 = 0.051 +- 0.146 (in-sample avg dev_std = 0.002)
NEC for r=0.05 all KL = 0.032 +- 0.146 (in-sample avg dev_std = 0.002)
NEC for r=0.05 all L1 = 0.033 +- 0.136 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035812000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.782
NEC for r=0.1 class 0.0 = 0.022 +- 0.197 (in-sample avg dev_std = 0.102)
NEC for r=0.1 class 1.0 = 0.074 +- 0.197 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all KL = 0.053 +- 0.197 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all L1 = 0.048 +- 0.168 (in-sample avg dev_std = 0.102)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048664400000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.77
NEC for r=0.2 class 0.0 = 0.042 +- 0.241 (in-sample avg dev_std = 0.180)
NEC for r=0.2 class 1.0 = 0.086 +- 0.241 (in-sample avg dev_std = 0.180)
NEC for r=0.2 all KL = 0.081 +- 0.241 (in-sample avg dev_std = 0.180)
NEC for r=0.2 all L1 = 0.063 +- 0.190 (in-sample avg dev_std = 0.180)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.062375
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.752
NEC for r=0.4 class 0.0 = 0.074 +- 0.277 (in-sample avg dev_std = 0.220)
NEC for r=0.4 class 1.0 = 0.09 +- 0.277 (in-sample avg dev_std = 0.220)
NEC for r=0.4 all KL = 0.112 +- 0.277 (in-sample avg dev_std = 0.220)
NEC for r=0.4 all L1 = 0.082 +- 0.212 (in-sample avg dev_std = 0.220)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.771
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0787262
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.721
NEC for r=0.8 class 0.0 = 0.089 +- 0.343 (in-sample avg dev_std = 0.264)
NEC for r=0.8 class 1.0 = 0.169 +- 0.343 (in-sample avg dev_std = 0.264)
NEC for r=0.8 all KL = 0.183 +- 0.343 (in-sample avg dev_std = 0.264)
NEC for r=0.8 all L1 = 0.129 +- 0.259 (in-sample avg dev_std = 0.264)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 10:58:21 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:58:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.041
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.007
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.008
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.008
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.007
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.020
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.027
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.035
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.048
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.067


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03554
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.891
SUFF_SIMPLE for r=0.05 class 0.0 = 0.737 +- 0.386 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.994 +- 0.386 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.05 all KL = 0.8 +- 0.386 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.05 all L1 = 0.879 +- 0.257 (in-sample avg dev_std = 0.346)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04098
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.89
SUFF_SIMPLE for r=0.1 class 0.0 = 0.74 +- 0.380 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.994 +- 0.380 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all KL = 0.808 +- 0.380 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.1 all L1 = 0.881 +- 0.260 (in-sample avg dev_std = 0.335)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047308
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.892
SUFF_SIMPLE for r=0.2 class 0.0 = 0.745 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.996 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.2 all KL = 0.813 +- 0.378 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.2 all L1 = 0.884 +- 0.257 (in-sample avg dev_std = 0.327)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.065416
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.89
SUFF_SIMPLE for r=0.4 class 0.0 = 0.741 +- 0.376 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.376 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.4 all KL = 0.816 +- 0.376 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.4 all L1 = 0.884 +- 0.260 (in-sample avg dev_std = 0.313)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07919200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.955
SUFF_SIMPLE for r=0.8 class 0.0 = 0.894 +- 0.250 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.250 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all KL = 0.928 +- 0.250 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.8 all L1 = 0.952 +- 0.180 (in-sample avg dev_std = 0.143)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0074828
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.754
SUFF_SIMPLE for r=0.05 class 0.0 = 0.563 +- 0.435 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.05 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.05 all L1 = 0.782 +- 0.372 (in-sample avg dev_std = 0.156)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0081988
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.753
SUFF_SIMPLE for r=0.1 class 0.0 = 0.562 +- 0.435 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.1 all L1 = 0.782 +- 0.373 (in-sample avg dev_std = 0.152)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0085554
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.753
SUFF_SIMPLE for r=0.2 class 0.0 = 0.562 +- 0.435 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.2 all L1 = 0.782 +- 0.373 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0083568
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.753
SUFF_SIMPLE for r=0.4 class 0.0 = 0.562 +- 0.435 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.997 +- 0.435 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.435 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.4 all L1 = 0.781 +- 0.372 (in-sample avg dev_std = 0.153)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0065260000000000006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.926
SUFF_SIMPLE for r=0.8 class 0.0 = 0.913 +- 0.270 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.952 +- 0.270 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 all KL = 0.918 +- 0.270 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 all L1 = 0.933 +- 0.227 (in-sample avg dev_std = 0.010)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.019841
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.908
SUFF_SIMPLE for r=0.05 class 0.0 = 0.885 +- 0.270 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.987 +- 0.270 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.05 all KL = 0.911 +- 0.270 (in-sample avg dev_std = 0.143)
SUFF_SIMPLE for r=0.05 all L1 = 0.936 +- 0.212 (in-sample avg dev_std = 0.143)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0268306
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.908
SUFF_SIMPLE for r=0.1 class 0.0 = 0.884 +- 0.273 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.986 +- 0.273 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 all KL = 0.91 +- 0.273 (in-sample avg dev_std = 0.146)
SUFF_SIMPLE for r=0.1 all L1 = 0.935 +- 0.214 (in-sample avg dev_std = 0.146)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0347138
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.906
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.284 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.977 +- 0.284 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 all KL = 0.897 +- 0.284 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.2 all L1 = 0.931 +- 0.213 (in-sample avg dev_std = 0.185)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0477758
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.87
SUFF_SIMPLE for r=0.4 class 0.0 = 0.908 +- 0.348 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.876 +- 0.348 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.4 all KL = 0.835 +- 0.348 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.4 all L1 = 0.892 +- 0.254 (in-sample avg dev_std = 0.273)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06650260000000001
len(reference) = 4977
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.668
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.461 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.488 +- 0.461 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.688 +- 0.461 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.731 +- 0.398 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03554
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04098
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.995
NEC for r=0.1 class 0.0 = 0.012 +- 0.092 (in-sample avg dev_std = 0.060)
NEC for r=0.1 class 1.0 = 0.0 +- 0.092 (in-sample avg dev_std = 0.060)
NEC for r=0.1 all KL = 0.01 +- 0.092 (in-sample avg dev_std = 0.060)
NEC for r=0.1 all L1 = 0.005 +- 0.059 (in-sample avg dev_std = 0.060)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047308
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.984
NEC for r=0.2 class 0.0 = 0.046 +- 0.184 (in-sample avg dev_std = 0.162)
NEC for r=0.2 class 1.0 = 0.001 +- 0.184 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all KL = 0.042 +- 0.184 (in-sample avg dev_std = 0.162)
NEC for r=0.2 all L1 = 0.021 +- 0.107 (in-sample avg dev_std = 0.162)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.065416
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.975
NEC for r=0.4 class 0.0 = 0.071 +- 0.226 (in-sample avg dev_std = 0.198)
NEC for r=0.4 class 1.0 = 0.001 +- 0.226 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all KL = 0.063 +- 0.226 (in-sample avg dev_std = 0.198)
NEC for r=0.4 all L1 = 0.032 +- 0.130 (in-sample avg dev_std = 0.198)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07919200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.971
NEC for r=0.8 class 0.0 = 0.084 +- 0.251 (in-sample avg dev_std = 0.228)
NEC for r=0.8 class 1.0 = 0.001 +- 0.251 (in-sample avg dev_std = 0.228)
NEC for r=0.8 all KL = 0.081 +- 0.251 (in-sample avg dev_std = 0.228)
NEC for r=0.8 all L1 = 0.038 +- 0.136 (in-sample avg dev_std = 0.228)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0074828
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.987
NEC for r=0.05 class 0.0 = 0.023 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.002 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.015 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.013 +- 0.100 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0081988
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.929
NEC for r=0.1 class 0.0 = 0.136 +- 0.281 (in-sample avg dev_std = 0.174)
NEC for r=0.1 class 1.0 = 0.002 +- 0.281 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all KL = 0.089 +- 0.281 (in-sample avg dev_std = 0.174)
NEC for r=0.1 all L1 = 0.069 +- 0.223 (in-sample avg dev_std = 0.174)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0085554
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.914
NEC for r=0.2 class 0.0 = 0.214 +- 0.383 (in-sample avg dev_std = 0.405)
NEC for r=0.2 class 1.0 = 0.003 +- 0.383 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all KL = 0.193 +- 0.383 (in-sample avg dev_std = 0.405)
NEC for r=0.2 all L1 = 0.108 +- 0.231 (in-sample avg dev_std = 0.405)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0083568
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.917
NEC for r=0.4 class 0.0 = 0.22 +- 0.396 (in-sample avg dev_std = 0.431)
NEC for r=0.4 class 1.0 = 0.003 +- 0.396 (in-sample avg dev_std = 0.431)
NEC for r=0.4 all KL = 0.214 +- 0.396 (in-sample avg dev_std = 0.431)
NEC for r=0.4 all L1 = 0.11 +- 0.222 (in-sample avg dev_std = 0.431)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0065260000000000006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.912
NEC for r=0.8 class 0.0 = 0.234 +- 0.405 (in-sample avg dev_std = 0.447)
NEC for r=0.8 class 1.0 = 0.002 +- 0.405 (in-sample avg dev_std = 0.447)
NEC for r=0.8 all KL = 0.226 +- 0.405 (in-sample avg dev_std = 0.447)
NEC for r=0.8 all L1 = 0.117 +- 0.226 (in-sample avg dev_std = 0.447)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.019841
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.971
NEC for r=0.05 class 0.0 = 0.01 +- 0.070 (in-sample avg dev_std = 0.014)
NEC for r=0.05 class 1.0 = 0.0 +- 0.070 (in-sample avg dev_std = 0.014)
NEC for r=0.05 all KL = 0.006 +- 0.070 (in-sample avg dev_std = 0.014)
NEC for r=0.05 all L1 = 0.005 +- 0.060 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0268306
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.967
NEC for r=0.1 class 0.0 = 0.018 +- 0.095 (in-sample avg dev_std = 0.024)
NEC for r=0.1 class 1.0 = 0.0 +- 0.095 (in-sample avg dev_std = 0.024)
NEC for r=0.1 all KL = 0.011 +- 0.095 (in-sample avg dev_std = 0.024)
NEC for r=0.1 all L1 = 0.009 +- 0.079 (in-sample avg dev_std = 0.024)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0347138
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.955
NEC for r=0.2 class 0.0 = 0.039 +- 0.148 (in-sample avg dev_std = 0.042)
NEC for r=0.2 class 1.0 = 0.0 +- 0.148 (in-sample avg dev_std = 0.042)
NEC for r=0.2 all KL = 0.025 +- 0.148 (in-sample avg dev_std = 0.042)
NEC for r=0.2 all L1 = 0.02 +- 0.123 (in-sample avg dev_std = 0.042)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0477758
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.936
NEC for r=0.4 class 0.0 = 0.072 +- 0.204 (in-sample avg dev_std = 0.081)
NEC for r=0.4 class 1.0 = 0.0 +- 0.204 (in-sample avg dev_std = 0.081)
NEC for r=0.4 all KL = 0.046 +- 0.204 (in-sample avg dev_std = 0.081)
NEC for r=0.4 all L1 = 0.036 +- 0.166 (in-sample avg dev_std = 0.081)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.975
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06650260000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.934
NEC for r=0.8 class 0.0 = 0.076 +- 0.214 (in-sample avg dev_std = 0.104)
NEC for r=0.8 class 1.0 = 0.003 +- 0.214 (in-sample avg dev_std = 0.104)
NEC for r=0.8 all KL = 0.052 +- 0.214 (in-sample avg dev_std = 0.104)
NEC for r=0.8 all L1 = 0.04 +- 0.172 (in-sample avg dev_std = 0.104)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.753, 0.751, 0.758, 0.783, 0.871], 'all_L1': [0.828, 0.826, 0.833, 0.847, 0.906]}), defaultdict(<class 'list'>, {'all_KL': [0.779, 0.785, 0.797, 0.794, 0.882], 'all_L1': [0.862, 0.863, 0.862, 0.864, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.792, 0.795, 0.796, 0.8, 0.901], 'all_L1': [0.874, 0.873, 0.869, 0.872, 0.932]}), defaultdict(<class 'list'>, {'all_KL': [0.759, 0.767, 0.786, 0.798, 0.854], 'all_L1': [0.828, 0.832, 0.84, 0.853, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.787, 0.797, 0.8, 0.809, 0.908], 'all_L1': [0.863, 0.868, 0.872, 0.872, 0.933]}), defaultdict(<class 'list'>, {'all_KL': [0.668, 0.66, 0.693, 0.719, 0.824], 'all_L1': [0.784, 0.778, 0.795, 0.81, 0.87]}), defaultdict(<class 'list'>, {'all_KL': [0.668, 0.676, 0.695, 0.704, 0.792], 'all_L1': [0.778, 0.783, 0.794, 0.793, 0.855]}), defaultdict(<class 'list'>, {'all_KL': [0.825, 0.819, 0.827, 0.84, 0.945], 'all_L1': [0.901, 0.899, 0.9, 0.91, 0.965]}), defaultdict(<class 'list'>, {'all_KL': [0.812, 0.807, 0.822, 0.852, 0.939], 'all_L1': [0.888, 0.885, 0.891, 0.905, 0.96]}), defaultdict(<class 'list'>, {'all_KL': [0.8, 0.808, 0.813, 0.816, 0.928], 'all_L1': [0.879, 0.881, 0.884, 0.884, 0.952]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.013, 0.027, 0.072, 0.103, 0.123], 'all_L1': [0.012, 0.021, 0.047, 0.062, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.022, 0.064, 0.091, 0.104], 'all_L1': [0.009, 0.013, 0.033, 0.043, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.018, 0.046, 0.092, 0.103], 'all_L1': [0.004, 0.009, 0.023, 0.04, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.075, 0.124, 0.144, 0.152], 'all_L1': [0.023, 0.049, 0.07, 0.071, 0.071]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.022, 0.067, 0.092, 0.105], 'all_L1': [0.002, 0.012, 0.038, 0.049, 0.051]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.058, 0.101, 0.134, 0.149], 'all_L1': [0.027, 0.042, 0.064, 0.082, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.074, 0.131, 0.159, 0.166], 'all_L1': [0.026, 0.054, 0.091, 0.101, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.0, 0.014, 0.039, 0.06], 'all_L1': [0.0, 0.0, 0.007, 0.02, 0.026]}), defaultdict(<class 'list'>, {'all_KL': [0.001, 0.012, 0.034, 0.053, 0.069], 'all_L1': [0.001, 0.007, 0.021, 0.027, 0.032]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.01, 0.042, 0.063, 0.081], 'all_L1': [0.0, 0.005, 0.021, 0.032, 0.038]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.773, 0.773, 0.772, 0.773, 0.78], 'all_L1': [0.809, 0.808, 0.808, 0.809, 0.814]}), defaultdict(<class 'list'>, {'all_KL': [0.744, 0.744, 0.744, 0.744, 0.747], 'all_L1': [0.78, 0.78, 0.78, 0.78, 0.783]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.741, 0.741, 0.741, 0.745], 'all_L1': [0.777, 0.776, 0.776, 0.777, 0.78]}), defaultdict(<class 'list'>, {'all_KL': [0.747, 0.747, 0.747, 0.747, 0.749], 'all_L1': [0.793, 0.793, 0.793, 0.793, 0.794]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.429, 0.429, 0.429, 0.435], 'all_L1': [0.504, 0.504, 0.504, 0.504, 0.507]}), defaultdict(<class 'list'>, {'all_KL': [0.561, 0.563, 0.563, 0.564, 0.607], 'all_L1': [0.64, 0.641, 0.641, 0.641, 0.661]}), defaultdict(<class 'list'>, {'all_KL': [0.369, 0.367, 0.366, 0.37, 0.466], 'all_L1': [0.512, 0.511, 0.511, 0.512, 0.562]}), defaultdict(<class 'list'>, {'all_KL': [0.381, 0.381, 0.382, 0.382, 0.443], 'all_L1': [0.506, 0.506, 0.506, 0.507, 0.539]}), defaultdict(<class 'list'>, {'all_KL': [0.384, 0.386, 0.386, 0.387, 0.459], 'all_L1': [0.537, 0.538, 0.538, 0.539, 0.576]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.745, 0.745, 0.744, 0.918], 'all_L1': [0.782, 0.782, 0.782, 0.781, 0.933]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.031, 0.12, 0.157, 0.166, 0.169], 'all_L1': [0.035, 0.103, 0.12, 0.123, 0.123]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.125, 0.224, 0.233, 0.237], 'all_L1': [0.018, 0.097, 0.136, 0.137, 0.141]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.144, 0.225, 0.24, 0.244], 'all_L1': [0.024, 0.114, 0.145, 0.149, 0.153]}), defaultdict(<class 'list'>, {'all_KL': [0.097, 0.211, 0.249, 0.251, 0.25], 'all_L1': [0.074, 0.166, 0.186, 0.188, 0.187]}), defaultdict(<class 'list'>, {'all_KL': [0.278, 0.375, 0.462, 0.478, 0.485], 'all_L1': [0.242, 0.322, 0.355, 0.36, 0.362]}), defaultdict(<class 'list'>, {'all_KL': [0.12, 0.254, 0.306, 0.318, 0.325], 'all_L1': [0.118, 0.213, 0.24, 0.243, 0.247]}), defaultdict(<class 'list'>, {'all_KL': [0.123, 0.242, 0.329, 0.359, 0.37], 'all_L1': [0.104, 0.192, 0.228, 0.236, 0.237]}), defaultdict(<class 'list'>, {'all_KL': [0.24, 0.348, 0.402, 0.416, 0.419], 'all_L1': [0.199, 0.287, 0.307, 0.312, 0.315]}), defaultdict(<class 'list'>, {'all_KL': [0.208, 0.343, 0.392, 0.407, 0.408], 'all_L1': [0.166, 0.271, 0.291, 0.296, 0.296]}), defaultdict(<class 'list'>, {'all_KL': [0.015, 0.089, 0.193, 0.214, 0.226], 'all_L1': [0.013, 0.069, 0.108, 0.11, 0.117]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.697, 0.711, 0.747, 0.785, 0.88], 'all_L1': [0.725, 0.738, 0.767, 0.795, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.833, 0.836, 0.839, 0.848, 0.917], 'all_L1': [0.882, 0.883, 0.885, 0.887, 0.931]}), defaultdict(<class 'list'>, {'all_KL': [0.852, 0.862, 0.874, 0.885, 0.952], 'all_L1': [0.893, 0.895, 0.901, 0.906, 0.955]}), defaultdict(<class 'list'>, {'all_KL': [0.809, 0.849, 0.883, 0.908, 0.97], 'all_L1': [0.881, 0.901, 0.92, 0.936, 0.977]}), defaultdict(<class 'list'>, {'all_KL': [0.815, 0.826, 0.838, 0.849, 0.923], 'all_L1': [0.875, 0.878, 0.883, 0.886, 0.933]}), defaultdict(<class 'list'>, {'all_KL': [0.658, 0.675, 0.705, 0.745, 0.86], 'all_L1': [0.717, 0.728, 0.753, 0.779, 0.863]}), defaultdict(<class 'list'>, {'all_KL': [0.607, 0.621, 0.657, 0.71, 0.857], 'all_L1': [0.717, 0.73, 0.755, 0.793, 0.883]}), defaultdict(<class 'list'>, {'all_KL': [0.73, 0.765, 0.804, 0.83, 0.923], 'all_L1': [0.839, 0.852, 0.871, 0.884, 0.938]}), defaultdict(<class 'list'>, {'all_KL': [0.707, 0.74, 0.786, 0.828, 0.915], 'all_L1': [0.797, 0.817, 0.85, 0.878, 0.931]}), defaultdict(<class 'list'>, {'all_KL': [0.911, 0.91, 0.897, 0.835, 0.688], 'all_L1': [0.936, 0.935, 0.931, 0.892, 0.731]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.054, 0.077, 0.102, 0.136, 0.205], 'all_L1': [0.082, 0.103, 0.12, 0.144, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.044, 0.064, 0.09, 0.105], 'all_L1': [0.036, 0.041, 0.054, 0.071, 0.077]}), defaultdict(<class 'list'>, {'all_KL': [0.018, 0.026, 0.042, 0.069, 0.089], 'all_L1': [0.02, 0.026, 0.038, 0.057, 0.067]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.017, 0.033, 0.055, 0.102], 'all_L1': [0.009, 0.014, 0.026, 0.04, 0.068]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.035, 0.059, 0.08, 0.101], 'all_L1': [0.03, 0.037, 0.054, 0.067, 0.076]}), defaultdict(<class 'list'>, {'all_KL': [0.05, 0.083, 0.117, 0.164, 0.226], 'all_L1': [0.069, 0.094, 0.117, 0.15, 0.194]}), defaultdict(<class 'list'>, {'all_KL': [0.049, 0.084, 0.13, 0.187, 0.27], 'all_L1': [0.055, 0.079, 0.107, 0.142, 0.198]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.041, 0.062, 0.098, 0.156], 'all_L1': [0.025, 0.035, 0.048, 0.07, 0.099]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.053, 0.081, 0.112, 0.183], 'all_L1': [0.033, 0.048, 0.063, 0.082, 0.129]}), defaultdict(<class 'list'>, {'all_KL': [0.006, 0.011, 0.025, 0.046, 0.052], 'all_L1': [0.005, 0.009, 0.02, 0.036, 0.04]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.848 +- 0.040, 0.849 +- 0.040, 0.854 +- 0.036, 0.861 +- 0.035, 0.918 +- 0.036
suff_simple class all_KL  =  0.764 +- 0.052, 0.766 +- 0.053, 0.779 +- 0.046, 0.791 +- 0.045, 0.884 +- 0.048
[[0.843999981880188, 0.840749979019165, 0.8514999747276306, 0.8662499785423279, 0.9152500033378601], [0.8772500157356262, 0.878250002861023, 0.8687499761581421, 0.8727499842643738, 0.9210000038146973], [0.8899999856948853, 0.8872500061988831, 0.8807500004768372, 0.8805000185966492, 0.934249997138977], [0.8389999866485596, 0.840499997138977, 0.8420000076293945, 0.8554999828338623, 0.8855000138282776], [0.8737499713897705, 0.8787500262260437, 0.8824999928474426, 0.878250002861023, 0.9340000152587891], [0.8205000162124634, 0.8144999742507935, 0.8257499933242798, 0.8392500281333923, 0.8867499828338623], [0.8040000200271606, 0.8072500228881836, 0.8202499747276306, 0.8119999766349792, 0.875], [0.9185000061988831, 0.9114999771118164, 0.9117500185966492, 0.9225000143051147, 0.9677500128746033], [0.9027500152587891, 0.8964999914169312, 0.8995000123977661, 0.909500002861023, 0.9624999761581421], [0.890500009059906, 0.8899999856948853, 0.8920000195503235, 0.890250027179718, 0.9545000195503235]]
[[0.753, 0.751, 0.758, 0.783, 0.871], [0.779, 0.785, 0.797, 0.794, 0.882], [0.792, 0.795, 0.796, 0.8, 0.901], [0.759, 0.767, 0.786, 0.798, 0.854], [0.787, 0.797, 0.8, 0.809, 0.908], [0.668, 0.66, 0.693, 0.719, 0.824], [0.668, 0.676, 0.695, 0.704, 0.792], [0.825, 0.819, 0.827, 0.84, 0.945], [0.812, 0.807, 0.822, 0.852, 0.939], [0.8, 0.808, 0.813, 0.816, 0.928]]
suff_simple_acc_int  =  0.866 +- 0.035, 0.865 +- 0.034, 0.867 +- 0.030, 0.873 +- 0.031, 0.924 +- 0.031
nec class all_L1  =  0.010 +- 0.010, 0.021 +- 0.019, 0.042 +- 0.025, 0.053 +- 0.025, 0.057 +- 0.024
nec class all_KL  =  0.012 +- 0.012, 0.032 +- 0.026, 0.070 +- 0.037, 0.097 +- 0.037, 0.111 +- 0.034
[[0.9940000176429749, 0.9872499704360962, 0.9674999713897705, 0.9545000195503235, 0.9547500014305115], [0.9919999837875366, 0.9892500042915344, 0.972000002861023, 0.9677500128746033, 0.9649999737739563], [0.9959999918937683, 0.9932500123977661, 0.9815000295639038, 0.9712499976158142, 0.9670000076293945], [0.9777500033378601, 0.953499972820282, 0.9415000081062317, 0.9462500214576721, 0.9482499957084656], [0.9980000257492065, 0.9890000224113464, 0.9660000205039978, 0.9585000276565552, 0.9610000252723694], [0.9900000095367432, 0.9754999876022339, 0.9564999938011169, 0.9409999847412109, 0.9434999823570251], [0.9827499985694885, 0.9612500071525574, 0.9225000143051147, 0.9207500219345093, 0.9242500066757202], [1.0, 1.0, 0.9944999814033508, 0.984250009059906, 0.9827499985694885], [1.0, 0.9952499866485596, 0.981249988079071, 0.9787499904632568, 0.9754999876022339], [1.0, 0.9950000047683716, 0.984250009059906, 0.9750000238418579, 0.9714999794960022]]
[[0.013, 0.027, 0.072, 0.103, 0.123], [0.012, 0.022, 0.064, 0.091, 0.104], [0.005, 0.018, 0.046, 0.092, 0.103], [0.031, 0.075, 0.124, 0.144, 0.152], [0.003, 0.022, 0.067, 0.092, 0.105], [0.029, 0.058, 0.101, 0.134, 0.149], [0.027, 0.074, 0.131, 0.159, 0.166], [0.0, 0.0, 0.014, 0.039, 0.06], [0.001, 0.012, 0.034, 0.053, 0.069], [0.0, 0.01, 0.042, 0.063, 0.081]]
nec_acc_int  =  0.993 +- 0.007, 0.984 +- 0.015, 0.967 +- 0.021, 0.960 +- 0.019, 0.959 +- 0.016

Eval split val
suff_simple class all_L1  =  0.664 +- 0.130, 0.664 +- 0.129, 0.664 +- 0.129, 0.664 +- 0.129, 0.695 +- 0.137
suff_simple class all_KL  =  0.587 +- 0.170, 0.588 +- 0.170, 0.587 +- 0.170, 0.588 +- 0.170, 0.635 +- 0.166
[[0.6779999732971191, 0.6776750087738037, 0.6782249808311462, 0.6779000163078308, 0.6819499731063843], [0.7504000067710876, 0.7503499984741211, 0.749875009059906, 0.7495250105857849, 0.75142502784729], [0.7492750287055969, 0.7488999962806702, 0.7488499879837036, 0.7495750188827515, 0.7524499893188477], [0.7269999980926514, 0.7270249724388123, 0.7270249724388123, 0.7270749807357788, 0.7283999919891357], [0.7560750246047974, 0.7558249831199646, 0.7561249732971191, 0.7557500004768372, 0.7578499913215637], [0.6310250163078308, 0.6315249800682068, 0.6317499876022339, 0.6307500004768372, 0.643975019454956], [0.7124750018119812, 0.7129499912261963, 0.7128250002861023, 0.7130749821662903, 0.7456499934196472], [0.7989749908447266, 0.8009999990463257, 0.8004249930381775, 0.8004000186920166, 0.8181250095367432], [0.7751749753952026, 0.7771750092506409, 0.7770500183105469, 0.7763000130653381, 0.8015000224113464], [0.7536749839782715, 0.753125011920929, 0.7526999711990356, 0.7527499794960022, 0.9259750247001648]]
[[0.773, 0.773, 0.772, 0.773, 0.78], [0.744, 0.744, 0.744, 0.744, 0.747], [0.741, 0.741, 0.741, 0.741, 0.745], [0.747, 0.747, 0.747, 0.747, 0.749], [0.429, 0.429, 0.429, 0.429, 0.435], [0.561, 0.563, 0.563, 0.564, 0.607], [0.369, 0.367, 0.366, 0.37, 0.466], [0.381, 0.381, 0.382, 0.382, 0.443], [0.384, 0.386, 0.386, 0.387, 0.459], [0.745, 0.745, 0.745, 0.744, 0.918]]
suff_simple_acc_int  =  0.733 +- 0.046, 0.734 +- 0.047, 0.733 +- 0.047, 0.733 +- 0.047, 0.761 +- 0.073
nec class all_L1  =  0.099 +- 0.077, 0.183 +- 0.084, 0.212 +- 0.082, 0.215 +- 0.083, 0.218 +- 0.082
nec class all_KL  =  0.116 +- 0.092, 0.225 +- 0.099, 0.294 +- 0.096, 0.308 +- 0.098, 0.313 +- 0.098
[[0.8309999704360962, 0.7684749960899353, 0.7610499858856201, 0.7618250250816345, 0.7621250152587891], [0.9819999933242798, 0.8983250260353088, 0.8830749988555908, 0.8866750001907349, 0.8845750093460083], [0.9789999723434448, 0.8841750025749207, 0.875374972820282, 0.8783249855041504, 0.8741000294685364], [0.8784000277519226, 0.7787250280380249, 0.7698500156402588, 0.7681750059127808, 0.7706500291824341], [0.9502000212669373, 0.94964998960495, 0.933899998664856, 0.9325500130653381, 0.932075023651123], [0.892799973487854, 0.7991750240325928, 0.7810750007629395, 0.7822999954223633, 0.7792750000953674], [0.829200029373169, 0.8578500151634216, 0.8575500249862671, 0.8586000204086304, 0.8542749881744385], [0.8220000267028809, 0.9137499928474426, 0.911899983882904, 0.9148499965667725, 0.9153749942779541], [0.7329999804496765, 0.8445749878883362, 0.8460749983787537, 0.847599983215332, 0.8455749750137329], [0.9869999885559082, 0.9292250275611877, 0.9136750102043152, 0.9171749949455261, 0.9122499823570251]]
[[0.031, 0.12, 0.157, 0.166, 0.169], [0.022, 0.125, 0.224, 0.233, 0.237], [0.029, 0.144, 0.225, 0.24, 0.244], [0.097, 0.211, 0.249, 0.251, 0.25], [0.278, 0.375, 0.462, 0.478, 0.485], [0.12, 0.254, 0.306, 0.318, 0.325], [0.123, 0.242, 0.329, 0.359, 0.37], [0.24, 0.348, 0.402, 0.416, 0.419], [0.208, 0.343, 0.392, 0.407, 0.408], [0.015, 0.089, 0.193, 0.214, 0.226]]
nec_acc_int  =  0.888 +- 0.081, 0.862 +- 0.061, 0.853 +- 0.060, 0.855 +- 0.060, 0.853 +- 0.060

Eval split test
suff_simple class all_L1  =  0.826 +- 0.078, 0.836 +- 0.074, 0.852 +- 0.065, 0.864 +- 0.051, 0.901 +- 0.067
suff_simple class all_KL  =  0.762 +- 0.091, 0.779 +- 0.087, 0.803 +- 0.076, 0.822 +- 0.057, 0.889 +- 0.075
[[0.7325395345687866, 0.7477236390113831, 0.7656343579292297, 0.7851210832595825, 0.8299989700317383], [0.8493596315383911, 0.8511607050895691, 0.851460874080658, 0.8520112037658691, 0.8986995220184326], [0.8922853469848633, 0.8909845948219299, 0.8928857445716858, 0.8963378071784973, 0.9481780529022217], [0.8905343413352966, 0.8950120210647583, 0.8996147513389587, 0.90799480676651, 0.9509986042976379], [0.7911997437477112, 0.7912247180938721, 0.7907494306564331, 0.7926255464553833, 0.839809238910675], [0.6225735545158386, 0.6261506676673889, 0.6416850090026855, 0.6522413492202759, 0.6964357495307922], [0.5974584817886353, 0.6029117703437805, 0.6165449023246765, 0.6254252791404724, 0.6843041777610779], [0.7469981908798218, 0.7552281618118286, 0.7602311372756958, 0.7634580731391907, 0.8167135119438171], [0.6981939077377319, 0.7057734727859497, 0.7216579914093018, 0.7387682795524597, 0.7845579385757446], [0.9083449840545654, 0.9075445532798767, 0.9059935808181763, 0.8699469566345215, 0.667671263217926]]
[[0.697, 0.711, 0.747, 0.785, 0.88], [0.833, 0.836, 0.839, 0.848, 0.917], [0.852, 0.862, 0.874, 0.885, 0.952], [0.809, 0.849, 0.883, 0.908, 0.97], [0.815, 0.826, 0.838, 0.849, 0.923], [0.658, 0.675, 0.705, 0.745, 0.86], [0.607, 0.621, 0.657, 0.71, 0.857], [0.73, 0.765, 0.804, 0.83, 0.923], [0.707, 0.74, 0.786, 0.828, 0.915], [0.911, 0.91, 0.897, 0.835, 0.688]]
suff_simple_acc_int  =  0.773 +- 0.107, 0.777 +- 0.104, 0.785 +- 0.099, 0.788 +- 0.092, 0.812 +- 0.099
nec class all_L1  =  0.036 +- 0.024, 0.049 +- 0.031, 0.065 +- 0.035, 0.086 +- 0.041, 0.114 +- 0.058
nec class all_KL  =  0.030 +- 0.016, 0.047 +- 0.025, 0.071 +- 0.034, 0.104 +- 0.044, 0.149 +- 0.067
[[0.8349759578704834, 0.8305233120918274, 0.8201420903205872, 0.799554705619812, 0.7681108713150024], [0.9039673805236816, 0.901090681552887, 0.8880828619003296, 0.8679957985877991, 0.8647438287734985], [0.9646788239479065, 0.9601510763168335, 0.9491444826126099, 0.9296578168869019, 0.9261306524276733], [0.9648038744926453, 0.9618521332740784, 0.9468681216239929, 0.9328346848487854, 0.9239794015884399], [0.8350009918212891, 0.8334751129150391, 0.8218681216239929, 0.8036571741104126, 0.7999049425125122], [0.6680758595466614, 0.674554705619812, 0.6669251322746277, 0.6458125114440918, 0.6304782629013062], [0.6655493378639221, 0.6715028882026672, 0.6593706011772156, 0.6350060105323792, 0.6133930087089539], [0.80748450756073, 0.8072343468666077, 0.7974284291267395, 0.7755153179168701, 0.7657594680786133], [0.7758654952049255, 0.7815939784049988, 0.7702121138572693, 0.7519011497497559, 0.7213828563690186], [0.9707324504852295, 0.9674054384231567, 0.9545227289199829, 0.9359115362167358, 0.9340354204177856]]
[[0.054, 0.077, 0.102, 0.136, 0.205], [0.033, 0.044, 0.064, 0.09, 0.105], [0.018, 0.026, 0.042, 0.069, 0.089], [0.01, 0.017, 0.033, 0.055, 0.102], [0.024, 0.035, 0.059, 0.08, 0.101], [0.05, 0.083, 0.117, 0.164, 0.226], [0.049, 0.084, 0.13, 0.187, 0.27], [0.024, 0.041, 0.062, 0.098, 0.156], [0.032, 0.053, 0.081, 0.112, 0.183], [0.006, 0.011, 0.025, 0.046, 0.052]]
nec_acc_int  =  0.839 +- 0.108, 0.839 +- 0.105, 0.827 +- 0.104, 0.808 +- 0.105, 0.795 +- 0.112


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.429 +- 0.015, 0.435 +- 0.012, 0.448 +- 0.008, 0.457 +- 0.007, 0.487 +- 0.007
Faith. Armon (L1)= 		  =  0.020 +- 0.020, 0.041 +- 0.035, 0.078 +- 0.045, 0.098 +- 0.043, 0.106 +- 0.041
Faith. GMean (L1)= 	  =  0.074 +- 0.054, 0.116 +- 0.062, 0.178 +- 0.054, 0.206 +- 0.045, 0.223 +- 0.042
Faith. Aritm (KL)= 		  =  0.388 +- 0.021, 0.399 +- 0.018, 0.424 +- 0.014, 0.444 +- 0.012, 0.498 +- 0.009
Faith. Armon (KL)= 		  =  0.023 +- 0.023, 0.059 +- 0.046, 0.124 +- 0.060, 0.170 +- 0.058, 0.195 +- 0.052
Faith. GMean (KL)= 	  =  0.076 +- 0.054, 0.137 +- 0.067, 0.222 +- 0.059, 0.270 +- 0.049, 0.308 +- 0.041

Eval split val
Faith. Aritm (L1)= 		  =  0.382 +- 0.035, 0.424 +- 0.034, 0.438 +- 0.033, 0.440 +- 0.032, 0.456 +- 0.033
Faith. Armon (L1)= 		  =  0.155 +- 0.105, 0.267 +- 0.088, 0.302 +- 0.076, 0.306 +- 0.076, 0.312 +- 0.076
Faith. GMean (L1)= 	  =  0.224 +- 0.084, 0.330 +- 0.054, 0.359 +- 0.042, 0.363 +- 0.042, 0.373 +- 0.038
Faith. Aritm (KL)= 		  =  0.352 +- 0.051, 0.406 +- 0.048, 0.441 +- 0.047, 0.448 +- 0.044, 0.474 +- 0.042
Faith. Armon (KL)= 		  =  0.164 +- 0.107, 0.292 +- 0.078, 0.360 +- 0.049, 0.372 +- 0.045, 0.390 +- 0.050
Faith. GMean (KL)= 	  =  0.221 +- 0.078, 0.340 +- 0.046, 0.396 +- 0.031, 0.406 +- 0.028, 0.428 +- 0.025

Eval split test
Faith. Aritm (L1)= 		  =  0.431 +- 0.029, 0.442 +- 0.022, 0.458 +- 0.015, 0.475 +- 0.008, 0.507 +- 0.042
Faith. Armon (L1)= 		  =  0.068 +- 0.042, 0.089 +- 0.053, 0.117 +- 0.058, 0.153 +- 0.065, 0.198 +- 0.088
Faith. GMean (L1)= 	  =  0.160 +- 0.052, 0.188 +- 0.057, 0.223 +- 0.055, 0.263 +- 0.056, 0.311 +- 0.079
Faith. Aritm (KL)= 		  =  0.396 +- 0.039, 0.413 +- 0.032, 0.437 +- 0.021, 0.463 +- 0.012, 0.519 +- 0.052
Faith. Armon (KL)= 		  =  0.057 +- 0.029, 0.087 +- 0.044, 0.128 +- 0.054, 0.180 +- 0.066, 0.249 +- 0.096
Faith. GMean (KL)= 	  =  0.142 +- 0.037, 0.181 +- 0.045, 0.230 +- 0.046, 0.283 +- 0.051, 0.355 +- 0.083
Computed for split load_split = id



Completed in  2:31:11.429125  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GL-GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 11:13:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:13:19 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.052
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.063
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.076
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.037
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.046
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052486000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.921
SUFF_SIMPLE for r=0.05 class 0.0 = 0.81 +- 0.341 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.974 +- 0.341 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.05 all KL = 0.83 +- 0.341 (in-sample avg dev_std = 0.375)
SUFF_SIMPLE for r=0.05 all L1 = 0.901 +- 0.218 (in-sample avg dev_std = 0.375)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06340000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.928
SUFF_SIMPLE for r=0.1 class 0.0 = 0.827 +- 0.316 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.985 +- 0.316 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.1 all KL = 0.86 +- 0.316 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.1 all L1 = 0.915 +- 0.212 (in-sample avg dev_std = 0.317)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07078
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.923
SUFF_SIMPLE for r=0.2 class 0.0 = 0.817 +- 0.319 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.988 +- 0.319 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.2 all KL = 0.857 +- 0.319 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.2 all L1 = 0.911 +- 0.218 (in-sample avg dev_std = 0.319)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075792
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.932
SUFF_SIMPLE for r=0.4 class 0.0 = 0.828 +- 0.305 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.994 +- 0.305 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.4 all KL = 0.871 +- 0.305 (in-sample avg dev_std = 0.289)
SUFF_SIMPLE for r=0.4 all L1 = 0.92 +- 0.210 (in-sample avg dev_std = 0.289)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077492
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.979
SUFF_SIMPLE for r=0.8 class 0.0 = 0.94 +- 0.184 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.184 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.8 all KL = 0.958 +- 0.184 (in-sample avg dev_std = 0.155)
SUFF_SIMPLE for r=0.8 all L1 = 0.973 +- 0.126 (in-sample avg dev_std = 0.155)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089806
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.759
SUFF_SIMPLE for r=0.05 class 0.0 = 0.574 +- 0.434 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.434 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.05 all L1 = 0.789 +- 0.363 (in-sample avg dev_std = 0.176)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009006400000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.76
SUFF_SIMPLE for r=0.1 class 0.0 = 0.574 +- 0.434 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.434 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.1 all L1 = 0.789 +- 0.363 (in-sample avg dev_std = 0.182)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.008993000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.76
SUFF_SIMPLE for r=0.2 class 0.0 = 0.575 +- 0.434 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.434 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.2 all L1 = 0.789 +- 0.362 (in-sample avg dev_std = 0.184)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0089888
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.758
SUFF_SIMPLE for r=0.4 class 0.0 = 0.574 +- 0.434 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.434 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 all L1 = 0.788 +- 0.363 (in-sample avg dev_std = 0.175)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0089886
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.766
SUFF_SIMPLE for r=0.8 class 0.0 = 0.59 +- 0.427 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.427 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 all KL = 0.756 +- 0.427 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 all L1 = 0.796 +- 0.359 (in-sample avg dev_std = 0.098)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0372566
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.909
SUFF_SIMPLE for r=0.05 class 0.0 = 0.88 +- 0.297 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.958 +- 0.297 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.05 all KL = 0.884 +- 0.297 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.05 all L1 = 0.919 +- 0.227 (in-sample avg dev_std = 0.229)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0461748
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.912
SUFF_SIMPLE for r=0.1 class 0.0 = 0.882 +- 0.284 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.969 +- 0.284 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.1 all KL = 0.897 +- 0.284 (in-sample avg dev_std = 0.188)
SUFF_SIMPLE for r=0.1 all L1 = 0.925 +- 0.224 (in-sample avg dev_std = 0.188)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0563976
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.912
SUFF_SIMPLE for r=0.2 class 0.0 = 0.88 +- 0.277 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.976 +- 0.277 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.2 all KL = 0.902 +- 0.277 (in-sample avg dev_std = 0.164)
SUFF_SIMPLE for r=0.2 all L1 = 0.927 +- 0.223 (in-sample avg dev_std = 0.164)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0679408
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.913
SUFF_SIMPLE for r=0.4 class 0.0 = 0.889 +- 0.277 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.965 +- 0.277 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all KL = 0.894 +- 0.277 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all L1 = 0.927 +- 0.215 (in-sample avg dev_std = 0.190)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08047760000000001
len(reference) = 4977
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.846
SUFF_SIMPLE for r=0.8 class 0.0 = 0.978 +- 0.349 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.77 +- 0.349 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all KL = 0.855 +- 0.349 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.8 all L1 = 0.875 +- 0.301 (in-sample avg dev_std = 0.015)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052486000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.999
NEC for r=0.05 class 0.0 = 0.003 +- 0.044 (in-sample avg dev_std = 0.045)
NEC for r=0.05 class 1.0 = 0.0 +- 0.044 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all L1 = 0.001 +- 0.031 (in-sample avg dev_std = 0.045)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06340000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.996
NEC for r=0.1 class 0.0 = 0.01 +- 0.075 (in-sample avg dev_std = 0.064)
NEC for r=0.1 class 1.0 = 0.0 +- 0.075 (in-sample avg dev_std = 0.064)
NEC for r=0.1 all KL = 0.007 +- 0.075 (in-sample avg dev_std = 0.064)
NEC for r=0.1 all L1 = 0.004 +- 0.048 (in-sample avg dev_std = 0.064)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07078
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.991
NEC for r=0.2 class 0.0 = 0.024 +- 0.129 (in-sample avg dev_std = 0.111)
NEC for r=0.2 class 1.0 = 0.004 +- 0.129 (in-sample avg dev_std = 0.111)
NEC for r=0.2 all KL = 0.022 +- 0.129 (in-sample avg dev_std = 0.111)
NEC for r=0.2 all L1 = 0.013 +- 0.084 (in-sample avg dev_std = 0.111)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075792
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.983
NEC for r=0.4 class 0.0 = 0.031 +- 0.151 (in-sample avg dev_std = 0.125)
NEC for r=0.4 class 1.0 = 0.01 +- 0.151 (in-sample avg dev_std = 0.125)
NEC for r=0.4 all KL = 0.031 +- 0.151 (in-sample avg dev_std = 0.125)
NEC for r=0.4 all L1 = 0.019 +- 0.108 (in-sample avg dev_std = 0.125)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077492
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.984
NEC for r=0.8 class 0.0 = 0.04 +- 0.176 (in-sample avg dev_std = 0.189)
NEC for r=0.8 class 1.0 = 0.007 +- 0.176 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all KL = 0.043 +- 0.176 (in-sample avg dev_std = 0.189)
NEC for r=0.8 all L1 = 0.022 +- 0.100 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089806
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.994
NEC for r=0.05 class 0.0 = 0.013 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.008 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.006 +- 0.066 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009006400000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.945
NEC for r=0.1 class 0.0 = 0.118 +- 0.256 (in-sample avg dev_std = 0.139)
NEC for r=0.1 class 1.0 = 0.001 +- 0.256 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all KL = 0.08 +- 0.256 (in-sample avg dev_std = 0.139)
NEC for r=0.1 all L1 = 0.059 +- 0.195 (in-sample avg dev_std = 0.139)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.008993000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.931
NEC for r=0.2 class 0.0 = 0.18 +- 0.328 (in-sample avg dev_std = 0.339)
NEC for r=0.2 class 1.0 = 0.001 +- 0.328 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all KL = 0.156 +- 0.328 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all L1 = 0.09 +- 0.202 (in-sample avg dev_std = 0.339)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0089888
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.93
NEC for r=0.4 class 0.0 = 0.194 +- 0.342 (in-sample avg dev_std = 0.375)
NEC for r=0.4 class 1.0 = 0.001 +- 0.342 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all KL = 0.178 +- 0.342 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all L1 = 0.096 +- 0.198 (in-sample avg dev_std = 0.375)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0089886
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.932
NEC for r=0.8 class 0.0 = 0.192 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=0.8 class 1.0 = 0.001 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=0.8 all KL = 0.181 +- 0.342 (in-sample avg dev_std = 0.380)
NEC for r=0.8 all L1 = 0.096 +- 0.193 (in-sample avg dev_std = 0.380)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0372566
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.981
NEC for r=0.05 class 0.0 = 0.009 +- 0.068 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.001 +- 0.068 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.006 +- 0.068 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0461748
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.977
NEC for r=0.1 class 0.0 = 0.015 +- 0.094 (in-sample avg dev_std = 0.014)
NEC for r=0.1 class 1.0 = 0.002 +- 0.094 (in-sample avg dev_std = 0.014)
NEC for r=0.1 all KL = 0.01 +- 0.094 (in-sample avg dev_std = 0.014)
NEC for r=0.1 all L1 = 0.009 +- 0.081 (in-sample avg dev_std = 0.014)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0563976
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.97
NEC for r=0.2 class 0.0 = 0.029 +- 0.131 (in-sample avg dev_std = 0.034)
NEC for r=0.2 class 1.0 = 0.003 +- 0.131 (in-sample avg dev_std = 0.034)
NEC for r=0.2 all KL = 0.019 +- 0.131 (in-sample avg dev_std = 0.034)
NEC for r=0.2 all L1 = 0.016 +- 0.111 (in-sample avg dev_std = 0.034)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0679408
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.946
NEC for r=0.4 class 0.0 = 0.069 +- 0.202 (in-sample avg dev_std = 0.077)
NEC for r=0.4 class 1.0 = 0.005 +- 0.202 (in-sample avg dev_std = 0.077)
NEC for r=0.4 all KL = 0.046 +- 0.202 (in-sample avg dev_std = 0.077)
NEC for r=0.4 all L1 = 0.037 +- 0.168 (in-sample avg dev_std = 0.077)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08047760000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.938
NEC for r=0.8 class 0.0 = 0.08 +- 0.232 (in-sample avg dev_std = 0.153)
NEC for r=0.8 class 1.0 = 0.014 +- 0.232 (in-sample avg dev_std = 0.153)
NEC for r=0.8 all KL = 0.063 +- 0.232 (in-sample avg dev_std = 0.153)
NEC for r=0.8 all L1 = 0.047 +- 0.183 (in-sample avg dev_std = 0.153)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 11:29:23 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:29:23 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.057
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.067
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.067
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.927
SUFF_SIMPLE for r=0.05 class 0.0 = 0.896 +- 0.344 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.904 +- 0.344 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.05 all KL = 0.811 +- 0.344 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.05 all L1 = 0.901 +- 0.200 (in-sample avg dev_std = 0.422)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06731000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.928
SUFF_SIMPLE for r=0.1 class 0.0 = 0.891 +- 0.335 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.915 +- 0.335 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.1 all KL = 0.816 +- 0.335 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.1 all L1 = 0.905 +- 0.198 (in-sample avg dev_std = 0.402)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070602
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.938
SUFF_SIMPLE for r=0.2 class 0.0 = 0.901 +- 0.323 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.927 +- 0.323 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.2 all KL = 0.838 +- 0.323 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.2 all L1 = 0.916 +- 0.188 (in-sample avg dev_std = 0.383)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076564
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.934
SUFF_SIMPLE for r=0.4 class 0.0 = 0.912 +- 0.313 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.923 +- 0.313 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.4 all KL = 0.847 +- 0.313 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.194 (in-sample avg dev_std = 0.338)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080314
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.984
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.148 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.986 +- 0.148 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all KL = 0.975 +- 0.148 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.8 all L1 = 0.983 +- 0.106 (in-sample avg dev_std = 0.112)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0098826
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.879
SUFF_SIMPLE for r=0.05 class 0.0 = 0.751 +- 0.403 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.918 +- 0.403 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.05 all KL = 0.696 +- 0.403 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.05 all L1 = 0.836 +- 0.239 (in-sample avg dev_std = 0.549)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0098832
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.878
SUFF_SIMPLE for r=0.1 class 0.0 = 0.751 +- 0.402 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.916 +- 0.402 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.1 all KL = 0.691 +- 0.402 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.1 all L1 = 0.834 +- 0.239 (in-sample avg dev_std = 0.552)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009895000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.875
SUFF_SIMPLE for r=0.2 class 0.0 = 0.747 +- 0.405 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.916 +- 0.405 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.2 all KL = 0.691 +- 0.405 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.2 all L1 = 0.832 +- 0.243 (in-sample avg dev_std = 0.551)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098774
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.875
SUFF_SIMPLE for r=0.4 class 0.0 = 0.749 +- 0.405 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.917 +- 0.405 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.4 all KL = 0.698 +- 0.405 (in-sample avg dev_std = 0.546)
SUFF_SIMPLE for r=0.4 all L1 = 0.833 +- 0.246 (in-sample avg dev_std = 0.546)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877799999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.888
SUFF_SIMPLE for r=0.8 class 0.0 = 0.838 +- 0.343 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.942 +- 0.343 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.8 all KL = 0.851 +- 0.343 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.8 all L1 = 0.89 +- 0.267 (in-sample avg dev_std = 0.261)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035289999999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.907
SUFF_SIMPLE for r=0.05 class 0.0 = 0.886 +- 0.325 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.924 +- 0.325 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.05 all KL = 0.855 +- 0.325 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.05 all L1 = 0.905 +- 0.234 (in-sample avg dev_std = 0.307)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042921799999999996
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.909
SUFF_SIMPLE for r=0.1 class 0.0 = 0.889 +- 0.314 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.935 +- 0.314 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.1 all KL = 0.87 +- 0.314 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.1 all L1 = 0.912 +- 0.232 (in-sample avg dev_std = 0.272)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053993000000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.917
SUFF_SIMPLE for r=0.2 class 0.0 = 0.895 +- 0.296 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.949 +- 0.296 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.2 all KL = 0.888 +- 0.296 (in-sample avg dev_std = 0.225)
SUFF_SIMPLE for r=0.2 all L1 = 0.921 +- 0.226 (in-sample avg dev_std = 0.225)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0670826
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.925
SUFF_SIMPLE for r=0.4 class 0.0 = 0.914 +- 0.279 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.948 +- 0.279 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all KL = 0.905 +- 0.279 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.4 all L1 = 0.93 +- 0.218 (in-sample avg dev_std = 0.186)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0801148
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.94
SUFF_SIMPLE for r=0.8 class 0.0 = 0.986 +- 0.229 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.916 +- 0.229 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.8 all KL = 0.944 +- 0.229 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.8 all L1 = 0.952 +- 0.197 (in-sample avg dev_std = 0.041)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.991
NEC for r=0.05 class 0.0 = 0.007 +- 0.100 (in-sample avg dev_std = 0.052)
NEC for r=0.05 class 1.0 = 0.01 +- 0.100 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all KL = 0.011 +- 0.100 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all L1 = 0.009 +- 0.084 (in-sample avg dev_std = 0.052)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06731000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.985
NEC for r=0.1 class 0.0 = 0.01 +- 0.153 (in-sample avg dev_std = 0.140)
NEC for r=0.1 class 1.0 = 0.022 +- 0.153 (in-sample avg dev_std = 0.140)
NEC for r=0.1 all KL = 0.026 +- 0.153 (in-sample avg dev_std = 0.140)
NEC for r=0.1 all L1 = 0.017 +- 0.105 (in-sample avg dev_std = 0.140)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070602
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.979
NEC for r=0.2 class 0.0 = 0.013 +- 0.190 (in-sample avg dev_std = 0.188)
NEC for r=0.2 class 1.0 = 0.036 +- 0.190 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all KL = 0.044 +- 0.190 (in-sample avg dev_std = 0.188)
NEC for r=0.2 all L1 = 0.026 +- 0.121 (in-sample avg dev_std = 0.188)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076564
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.971
NEC for r=0.4 class 0.0 = 0.027 +- 0.221 (in-sample avg dev_std = 0.230)
NEC for r=0.4 class 1.0 = 0.043 +- 0.221 (in-sample avg dev_std = 0.230)
NEC for r=0.4 all KL = 0.066 +- 0.221 (in-sample avg dev_std = 0.230)
NEC for r=0.4 all L1 = 0.036 +- 0.134 (in-sample avg dev_std = 0.230)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080314
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.971
NEC for r=0.8 class 0.0 = 0.037 +- 0.247 (in-sample avg dev_std = 0.295)
NEC for r=0.8 class 1.0 = 0.049 +- 0.247 (in-sample avg dev_std = 0.295)
NEC for r=0.8 all KL = 0.093 +- 0.247 (in-sample avg dev_std = 0.295)
NEC for r=0.8 all L1 = 0.044 +- 0.127 (in-sample avg dev_std = 0.295)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0098826
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.992
NEC for r=0.05 class 0.0 = 0.012 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.001 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.008 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.007 +- 0.074 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0098832
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.975
NEC for r=0.1 class 0.0 = 0.037 +- 0.173 (in-sample avg dev_std = 0.124)
NEC for r=0.1 class 1.0 = 0.012 +- 0.173 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all KL = 0.033 +- 0.173 (in-sample avg dev_std = 0.124)
NEC for r=0.1 all L1 = 0.024 +- 0.133 (in-sample avg dev_std = 0.124)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009895000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.971
NEC for r=0.2 class 0.0 = 0.066 +- 0.252 (in-sample avg dev_std = 0.292)
NEC for r=0.2 class 1.0 = 0.02 +- 0.252 (in-sample avg dev_std = 0.292)
NEC for r=0.2 all KL = 0.092 +- 0.252 (in-sample avg dev_std = 0.292)
NEC for r=0.2 all L1 = 0.043 +- 0.127 (in-sample avg dev_std = 0.292)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098774
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.975
NEC for r=0.4 class 0.0 = 0.06 +- 0.246 (in-sample avg dev_std = 0.296)
NEC for r=0.4 class 1.0 = 0.023 +- 0.246 (in-sample avg dev_std = 0.296)
NEC for r=0.4 all KL = 0.101 +- 0.246 (in-sample avg dev_std = 0.296)
NEC for r=0.4 all L1 = 0.041 +- 0.106 (in-sample avg dev_std = 0.296)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877799999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.974
NEC for r=0.8 class 0.0 = 0.065 +- 0.250 (in-sample avg dev_std = 0.303)
NEC for r=0.8 class 1.0 = 0.021 +- 0.250 (in-sample avg dev_std = 0.303)
NEC for r=0.8 all KL = 0.107 +- 0.250 (in-sample avg dev_std = 0.303)
NEC for r=0.8 all L1 = 0.043 +- 0.106 (in-sample avg dev_std = 0.303)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035289999999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.983
NEC for r=0.05 class 0.0 = 0.009 +- 0.105 (in-sample avg dev_std = 0.010)
NEC for r=0.05 class 1.0 = 0.01 +- 0.105 (in-sample avg dev_std = 0.010)
NEC for r=0.05 all KL = 0.011 +- 0.105 (in-sample avg dev_std = 0.010)
NEC for r=0.05 all L1 = 0.01 +- 0.090 (in-sample avg dev_std = 0.010)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042921799999999996
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.981
NEC for r=0.1 class 0.0 = 0.011 +- 0.116 (in-sample avg dev_std = 0.030)
NEC for r=0.1 class 1.0 = 0.013 +- 0.116 (in-sample avg dev_std = 0.030)
NEC for r=0.1 all KL = 0.014 +- 0.116 (in-sample avg dev_std = 0.030)
NEC for r=0.1 all L1 = 0.012 +- 0.099 (in-sample avg dev_std = 0.030)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053993000000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.972
NEC for r=0.2 class 0.0 = 0.019 +- 0.154 (in-sample avg dev_std = 0.056)
NEC for r=0.2 class 1.0 = 0.022 +- 0.154 (in-sample avg dev_std = 0.056)
NEC for r=0.2 all KL = 0.025 +- 0.154 (in-sample avg dev_std = 0.056)
NEC for r=0.2 all L1 = 0.021 +- 0.129 (in-sample avg dev_std = 0.056)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0670826
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.951
NEC for r=0.4 class 0.0 = 0.043 +- 0.216 (in-sample avg dev_std = 0.119)
NEC for r=0.4 class 1.0 = 0.038 +- 0.216 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all KL = 0.053 +- 0.216 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all L1 = 0.041 +- 0.174 (in-sample avg dev_std = 0.119)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0801148
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.939
NEC for r=0.8 class 0.0 = 0.071 +- 0.269 (in-sample avg dev_std = 0.248)
NEC for r=0.8 class 1.0 = 0.049 +- 0.269 (in-sample avg dev_std = 0.248)
NEC for r=0.8 all KL = 0.092 +- 0.269 (in-sample avg dev_std = 0.248)
NEC for r=0.8 all L1 = 0.06 +- 0.191 (in-sample avg dev_std = 0.248)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 11:44:59 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:45:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.056
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.059
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.082
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.085
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.053
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.055805999999999994
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.91
SUFF_SIMPLE for r=0.05 class 0.0 = 0.855 +- 0.345 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.898 +- 0.345 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.05 all KL = 0.791 +- 0.345 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.05 all L1 = 0.879 +- 0.219 (in-sample avg dev_std = 0.466)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.058688000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.909
SUFF_SIMPLE for r=0.1 class 0.0 = 0.86 +- 0.335 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.902 +- 0.335 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.1 all KL = 0.8 +- 0.335 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.1 all L1 = 0.883 +- 0.219 (in-sample avg dev_std = 0.433)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07193599999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.909
SUFF_SIMPLE for r=0.2 class 0.0 = 0.854 +- 0.337 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.906 +- 0.337 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.2 all KL = 0.801 +- 0.337 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.2 all L1 = 0.883 +- 0.220 (in-sample avg dev_std = 0.430)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.081944
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.924
SUFF_SIMPLE for r=0.4 class 0.0 = 0.863 +- 0.314 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.944 +- 0.314 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.4 all KL = 0.848 +- 0.314 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.4 all L1 = 0.908 +- 0.209 (in-sample avg dev_std = 0.365)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085276
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.966
SUFF_SIMPLE for r=0.8 class 0.0 = 0.934 +- 0.211 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.986 +- 0.211 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.211 (in-sample avg dev_std = 0.199)
SUFF_SIMPLE for r=0.8 all L1 = 0.963 +- 0.153 (in-sample avg dev_std = 0.199)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0100756
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.754
SUFF_SIMPLE for r=0.05 class 0.0 = 0.644 +- 0.407 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.994 +- 0.407 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.05 all KL = 0.765 +- 0.407 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.05 all L1 = 0.821 +- 0.319 (in-sample avg dev_std = 0.356)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010077599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.753
SUFF_SIMPLE for r=0.1 class 0.0 = 0.644 +- 0.407 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.995 +- 0.407 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all KL = 0.766 +- 0.407 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.1 all L1 = 0.821 +- 0.320 (in-sample avg dev_std = 0.352)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010061
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.755
SUFF_SIMPLE for r=0.2 class 0.0 = 0.645 +- 0.407 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.996 +- 0.407 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all KL = 0.766 +- 0.407 (in-sample avg dev_std = 0.357)
SUFF_SIMPLE for r=0.2 all L1 = 0.822 +- 0.319 (in-sample avg dev_std = 0.357)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100376
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.755
SUFF_SIMPLE for r=0.4 class 0.0 = 0.646 +- 0.406 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.406 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.4 all KL = 0.766 +- 0.406 (in-sample avg dev_std = 0.354)
SUFF_SIMPLE for r=0.4 all L1 = 0.822 +- 0.318 (in-sample avg dev_std = 0.354)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010035800000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.767
SUFF_SIMPLE for r=0.8 class 0.0 = 0.696 +- 0.380 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.996 +- 0.380 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.8 all KL = 0.81 +- 0.380 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.8 all L1 = 0.847 +- 0.313 (in-sample avg dev_std = 0.176)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0321112
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.91
SUFF_SIMPLE for r=0.05 class 0.0 = 0.888 +- 0.312 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.926 +- 0.312 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.05 all KL = 0.864 +- 0.312 (in-sample avg dev_std = 0.307)
SUFF_SIMPLE for r=0.05 all L1 = 0.907 +- 0.232 (in-sample avg dev_std = 0.307)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041798
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.909
SUFF_SIMPLE for r=0.1 class 0.0 = 0.89 +- 0.306 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.93 +- 0.306 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 all KL = 0.874 +- 0.306 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.235 (in-sample avg dev_std = 0.266)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053203
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.908
SUFF_SIMPLE for r=0.2 class 0.0 = 0.892 +- 0.300 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.936 +- 0.300 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.300 (in-sample avg dev_std = 0.224)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.238 (in-sample avg dev_std = 0.224)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066414
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.917
SUFF_SIMPLE for r=0.4 class 0.0 = 0.913 +- 0.279 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.94 +- 0.279 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all KL = 0.906 +- 0.279 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all L1 = 0.926 +- 0.228 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080014
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.959
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.185 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.953 +- 0.185 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.8 all KL = 0.964 +- 0.185 (in-sample avg dev_std = 0.050)
SUFF_SIMPLE for r=0.8 all L1 = 0.969 +- 0.159 (in-sample avg dev_std = 0.050)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.055805999999999994
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.991
NEC for r=0.05 class 0.0 = 0.007 +- 0.098 (in-sample avg dev_std = 0.047)
NEC for r=0.05 class 1.0 = 0.009 +- 0.098 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all KL = 0.01 +- 0.098 (in-sample avg dev_std = 0.047)
NEC for r=0.05 all L1 = 0.008 +- 0.082 (in-sample avg dev_std = 0.047)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.058688000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.979
NEC for r=0.1 class 0.0 = 0.03 +- 0.160 (in-sample avg dev_std = 0.125)
NEC for r=0.1 class 1.0 = 0.015 +- 0.160 (in-sample avg dev_std = 0.125)
NEC for r=0.1 all KL = 0.029 +- 0.160 (in-sample avg dev_std = 0.125)
NEC for r=0.1 all L1 = 0.021 +- 0.123 (in-sample avg dev_std = 0.125)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07193599999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.976
NEC for r=0.2 class 0.0 = 0.039 +- 0.184 (in-sample avg dev_std = 0.187)
NEC for r=0.2 class 1.0 = 0.019 +- 0.184 (in-sample avg dev_std = 0.187)
NEC for r=0.2 all KL = 0.043 +- 0.184 (in-sample avg dev_std = 0.187)
NEC for r=0.2 all L1 = 0.028 +- 0.127 (in-sample avg dev_std = 0.187)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.081944
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.96
NEC for r=0.4 class 0.0 = 0.041 +- 0.236 (in-sample avg dev_std = 0.270)
NEC for r=0.4 class 1.0 = 0.057 +- 0.236 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all KL = 0.085 +- 0.236 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all L1 = 0.05 +- 0.156 (in-sample avg dev_std = 0.270)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085276
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.965
NEC for r=0.8 class 0.0 = 0.054 +- 0.246 (in-sample avg dev_std = 0.330)
NEC for r=0.8 class 1.0 = 0.053 +- 0.246 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all KL = 0.103 +- 0.246 (in-sample avg dev_std = 0.330)
NEC for r=0.8 all L1 = 0.054 +- 0.137 (in-sample avg dev_std = 0.330)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0100756
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.908
NEC for r=0.05 class 0.0 = 0.041 +- 0.151 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.001 +- 0.151 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.025 +- 0.151 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.02 +- 0.126 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010077599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.867
NEC for r=0.1 class 0.0 = 0.119 +- 0.256 (in-sample avg dev_std = 0.150)
NEC for r=0.1 class 1.0 = 0.002 +- 0.256 (in-sample avg dev_std = 0.150)
NEC for r=0.1 all KL = 0.077 +- 0.256 (in-sample avg dev_std = 0.150)
NEC for r=0.1 all L1 = 0.06 +- 0.206 (in-sample avg dev_std = 0.150)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010061
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.861
NEC for r=0.2 class 0.0 = 0.176 +- 0.314 (in-sample avg dev_std = 0.370)
NEC for r=0.2 class 1.0 = 0.003 +- 0.314 (in-sample avg dev_std = 0.370)
NEC for r=0.2 all KL = 0.146 +- 0.314 (in-sample avg dev_std = 0.370)
NEC for r=0.2 all L1 = 0.089 +- 0.203 (in-sample avg dev_std = 0.370)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100376
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.861
NEC for r=0.4 class 0.0 = 0.186 +- 0.321 (in-sample avg dev_std = 0.401)
NEC for r=0.4 class 1.0 = 0.004 +- 0.321 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all KL = 0.163 +- 0.321 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all L1 = 0.094 +- 0.196 (in-sample avg dev_std = 0.401)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010035800000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.863
NEC for r=0.8 class 0.0 = 0.183 +- 0.319 (in-sample avg dev_std = 0.403)
NEC for r=0.8 class 1.0 = 0.003 +- 0.319 (in-sample avg dev_std = 0.403)
NEC for r=0.8 all KL = 0.163 +- 0.319 (in-sample avg dev_std = 0.403)
NEC for r=0.8 all L1 = 0.092 +- 0.191 (in-sample avg dev_std = 0.403)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0321112
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.979
NEC for r=0.05 class 0.0 = 0.007 +- 0.108 (in-sample avg dev_std = 0.021)
NEC for r=0.05 class 1.0 = 0.014 +- 0.108 (in-sample avg dev_std = 0.021)
NEC for r=0.05 all KL = 0.012 +- 0.108 (in-sample avg dev_std = 0.021)
NEC for r=0.05 all L1 = 0.011 +- 0.093 (in-sample avg dev_std = 0.021)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041798
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.976
NEC for r=0.1 class 0.0 = 0.01 +- 0.130 (in-sample avg dev_std = 0.038)
NEC for r=0.1 class 1.0 = 0.02 +- 0.130 (in-sample avg dev_std = 0.038)
NEC for r=0.1 all KL = 0.018 +- 0.130 (in-sample avg dev_std = 0.038)
NEC for r=0.1 all L1 = 0.015 +- 0.111 (in-sample avg dev_std = 0.038)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053203
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.969
NEC for r=0.2 class 0.0 = 0.017 +- 0.158 (in-sample avg dev_std = 0.042)
NEC for r=0.2 class 1.0 = 0.028 +- 0.158 (in-sample avg dev_std = 0.042)
NEC for r=0.2 all KL = 0.026 +- 0.158 (in-sample avg dev_std = 0.042)
NEC for r=0.2 all L1 = 0.022 +- 0.135 (in-sample avg dev_std = 0.042)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066414
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.948
NEC for r=0.4 class 0.0 = 0.044 +- 0.221 (in-sample avg dev_std = 0.114)
NEC for r=0.4 class 1.0 = 0.044 +- 0.221 (in-sample avg dev_std = 0.114)
NEC for r=0.4 all KL = 0.055 +- 0.221 (in-sample avg dev_std = 0.114)
NEC for r=0.4 all L1 = 0.044 +- 0.182 (in-sample avg dev_std = 0.114)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080014
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.94
NEC for r=0.8 class 0.0 = 0.068 +- 0.264 (in-sample avg dev_std = 0.256)
NEC for r=0.8 class 1.0 = 0.057 +- 0.264 (in-sample avg dev_std = 0.256)
NEC for r=0.8 all KL = 0.091 +- 0.264 (in-sample avg dev_std = 0.256)
NEC for r=0.8 all L1 = 0.062 +- 0.194 (in-sample avg dev_std = 0.256)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 12:00:36 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:00:36 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.057
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.065
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.075
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056974000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.91
SUFF_SIMPLE for r=0.05 class 0.0 = 0.917 +- 0.315 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.837 +- 0.315 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.05 all KL = 0.795 +- 0.315 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.05 all L1 = 0.873 +- 0.207 (in-sample avg dev_std = 0.461)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06515399999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.908
SUFF_SIMPLE for r=0.1 class 0.0 = 0.914 +- 0.310 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.839 +- 0.310 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.1 all KL = 0.794 +- 0.310 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.1 all L1 = 0.872 +- 0.208 (in-sample avg dev_std = 0.453)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071744
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.905
SUFF_SIMPLE for r=0.2 class 0.0 = 0.907 +- 0.316 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.841 +- 0.316 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.2 all KL = 0.794 +- 0.316 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.2 all L1 = 0.87 +- 0.213 (in-sample avg dev_std = 0.439)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07501000000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.906
SUFF_SIMPLE for r=0.4 class 0.0 = 0.916 +- 0.307 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.852 +- 0.307 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 all KL = 0.817 +- 0.307 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 all L1 = 0.88 +- 0.219 (in-sample avg dev_std = 0.386)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078934
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.948
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.231 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.915 +- 0.231 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.8 all KL = 0.927 +- 0.231 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.8 all L1 = 0.945 +- 0.181 (in-sample avg dev_std = 0.191)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.662
SUFF_SIMPLE for r=0.05 class 0.0 = 0.942 +- 0.399 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.496 +- 0.399 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.05 all KL = 0.619 +- 0.399 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.05 all L1 = 0.717 +- 0.290 (in-sample avg dev_std = 0.599)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009945599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.663
SUFF_SIMPLE for r=0.1 class 0.0 = 0.946 +- 0.400 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.494 +- 0.400 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.1 all KL = 0.621 +- 0.400 (in-sample avg dev_std = 0.597)
SUFF_SIMPLE for r=0.1 all L1 = 0.718 +- 0.290 (in-sample avg dev_std = 0.597)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009889
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.659
SUFF_SIMPLE for r=0.2 class 0.0 = 0.939 +- 0.400 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.493 +- 0.400 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.2 all KL = 0.615 +- 0.400 (in-sample avg dev_std = 0.599)
SUFF_SIMPLE for r=0.2 all L1 = 0.714 +- 0.292 (in-sample avg dev_std = 0.599)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.66
SUFF_SIMPLE for r=0.4 class 0.0 = 0.942 +- 0.400 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.496 +- 0.400 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.4 all KL = 0.62 +- 0.400 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.4 all L1 = 0.717 +- 0.293 (in-sample avg dev_std = 0.592)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.649
SUFF_SIMPLE for r=0.8 class 0.0 = 0.977 +- 0.408 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.551 +- 0.408 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.8 all KL = 0.73 +- 0.408 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.8 all L1 = 0.763 +- 0.346 (in-sample avg dev_std = 0.253)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0331508
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.908
SUFF_SIMPLE for r=0.05 class 0.0 = 0.891 +- 0.308 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.905 +- 0.308 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.05 all KL = 0.858 +- 0.308 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.05 all L1 = 0.898 +- 0.237 (in-sample avg dev_std = 0.308)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.905
SUFF_SIMPLE for r=0.1 class 0.0 = 0.899 +- 0.305 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.902 +- 0.305 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 all KL = 0.867 +- 0.305 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 all L1 = 0.901 +- 0.241 (in-sample avg dev_std = 0.268)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0508582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.906
SUFF_SIMPLE for r=0.2 class 0.0 = 0.908 +- 0.293 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.293 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all KL = 0.881 +- 0.293 (in-sample avg dev_std = 0.226)
SUFF_SIMPLE for r=0.2 all L1 = 0.909 +- 0.236 (in-sample avg dev_std = 0.226)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0630722
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.905
SUFF_SIMPLE for r=0.4 class 0.0 = 0.914 +- 0.294 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.903 +- 0.294 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 all KL = 0.885 +- 0.294 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 all L1 = 0.909 +- 0.242 (in-sample avg dev_std = 0.193)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0781998
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.892
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.297 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.834 +- 0.297 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.8 all KL = 0.897 +- 0.297 (in-sample avg dev_std = 0.026)
SUFF_SIMPLE for r=0.8 all L1 = 0.909 +- 0.259 (in-sample avg dev_std = 0.026)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056974000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
NEC for r=0.05 class 0.0 = 0.004 +- 0.063 (in-sample avg dev_std = 0.002)
NEC for r=0.05 class 1.0 = 0.004 +- 0.063 (in-sample avg dev_std = 0.002)
NEC for r=0.05 all KL = 0.004 +- 0.063 (in-sample avg dev_std = 0.002)
NEC for r=0.05 all L1 = 0.004 +- 0.055 (in-sample avg dev_std = 0.002)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06515399999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.991
NEC for r=0.1 class 0.0 = 0.006 +- 0.097 (in-sample avg dev_std = 0.077)
NEC for r=0.1 class 1.0 = 0.014 +- 0.097 (in-sample avg dev_std = 0.077)
NEC for r=0.1 all KL = 0.014 +- 0.097 (in-sample avg dev_std = 0.077)
NEC for r=0.1 all L1 = 0.01 +- 0.076 (in-sample avg dev_std = 0.077)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071744
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.981
NEC for r=0.2 class 0.0 = 0.01 +- 0.146 (in-sample avg dev_std = 0.122)
NEC for r=0.2 class 1.0 = 0.03 +- 0.146 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all KL = 0.028 +- 0.146 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all L1 = 0.021 +- 0.112 (in-sample avg dev_std = 0.122)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07501000000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.971
NEC for r=0.4 class 0.0 = 0.022 +- 0.184 (in-sample avg dev_std = 0.175)
NEC for r=0.4 class 1.0 = 0.041 +- 0.184 (in-sample avg dev_std = 0.175)
NEC for r=0.4 all KL = 0.046 +- 0.184 (in-sample avg dev_std = 0.175)
NEC for r=0.4 all L1 = 0.033 +- 0.139 (in-sample avg dev_std = 0.175)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078934
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.974
NEC for r=0.8 class 0.0 = 0.02 +- 0.193 (in-sample avg dev_std = 0.256)
NEC for r=0.8 class 1.0 = 0.053 +- 0.193 (in-sample avg dev_std = 0.256)
NEC for r=0.8 all KL = 0.064 +- 0.193 (in-sample avg dev_std = 0.256)
NEC for r=0.8 all L1 = 0.039 +- 0.121 (in-sample avg dev_std = 0.256)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.813
NEC for r=0.05 class 0.0 = 0.001 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.149 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.076 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.075 +- 0.214 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009945599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.699
NEC for r=0.1 class 0.0 = 0.004 +- 0.369 (in-sample avg dev_std = 0.197)
NEC for r=0.1 class 1.0 = 0.379 +- 0.369 (in-sample avg dev_std = 0.197)
NEC for r=0.1 all KL = 0.211 +- 0.369 (in-sample avg dev_std = 0.197)
NEC for r=0.1 all L1 = 0.193 +- 0.317 (in-sample avg dev_std = 0.197)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009889
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.687
NEC for r=0.2 class 0.0 = 0.006 +- 0.388 (in-sample avg dev_std = 0.459)
NEC for r=0.2 class 1.0 = 0.458 +- 0.388 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all KL = 0.288 +- 0.388 (in-sample avg dev_std = 0.459)
NEC for r=0.2 all L1 = 0.234 +- 0.301 (in-sample avg dev_std = 0.459)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.69
NEC for r=0.4 class 0.0 = 0.008 +- 0.387 (in-sample avg dev_std = 0.500)
NEC for r=0.4 class 1.0 = 0.465 +- 0.387 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all KL = 0.301 +- 0.387 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all L1 = 0.238 +- 0.293 (in-sample avg dev_std = 0.500)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.691
NEC for r=0.8 class 0.0 = 0.007 +- 0.388 (in-sample avg dev_std = 0.508)
NEC for r=0.8 class 1.0 = 0.467 +- 0.388 (in-sample avg dev_std = 0.508)
NEC for r=0.8 all KL = 0.302 +- 0.388 (in-sample avg dev_std = 0.508)
NEC for r=0.8 all L1 = 0.239 +- 0.292 (in-sample avg dev_std = 0.508)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0331508
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.972
NEC for r=0.05 class 0.0 = 0.008 +- 0.121 (in-sample avg dev_std = 0.023)
NEC for r=0.05 class 1.0 = 0.023 +- 0.121 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all KL = 0.017 +- 0.121 (in-sample avg dev_std = 0.023)
NEC for r=0.05 all L1 = 0.016 +- 0.106 (in-sample avg dev_std = 0.023)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.97
NEC for r=0.1 class 0.0 = 0.012 +- 0.144 (in-sample avg dev_std = 0.047)
NEC for r=0.1 class 1.0 = 0.031 +- 0.144 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all KL = 0.024 +- 0.144 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all L1 = 0.022 +- 0.125 (in-sample avg dev_std = 0.047)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0508582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.963
NEC for r=0.2 class 0.0 = 0.022 +- 0.181 (in-sample avg dev_std = 0.069)
NEC for r=0.2 class 1.0 = 0.045 +- 0.181 (in-sample avg dev_std = 0.069)
NEC for r=0.2 all KL = 0.038 +- 0.181 (in-sample avg dev_std = 0.069)
NEC for r=0.2 all L1 = 0.033 +- 0.156 (in-sample avg dev_std = 0.069)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0630722
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.946
NEC for r=0.4 class 0.0 = 0.044 +- 0.229 (in-sample avg dev_std = 0.113)
NEC for r=0.4 class 1.0 = 0.06 +- 0.229 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all KL = 0.062 +- 0.229 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all L1 = 0.052 +- 0.193 (in-sample avg dev_std = 0.113)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.979
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0781998
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.939
NEC for r=0.8 class 0.0 = 0.066 +- 0.265 (in-sample avg dev_std = 0.246)
NEC for r=0.8 class 1.0 = 0.074 +- 0.265 (in-sample avg dev_std = 0.246)
NEC for r=0.8 all KL = 0.095 +- 0.265 (in-sample avg dev_std = 0.246)
NEC for r=0.8 all L1 = 0.07 +- 0.204 (in-sample avg dev_std = 0.246)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 12:16:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:16:48 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.058
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.068
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.077
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.081
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.044
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.055
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.067
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057848
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.929
SUFF_SIMPLE for r=0.05 class 0.0 = 0.839 +- 0.322 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.967 +- 0.322 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all KL = 0.844 +- 0.322 (in-sample avg dev_std = 0.376)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.205 (in-sample avg dev_std = 0.376)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06810000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.929
SUFF_SIMPLE for r=0.1 class 0.0 = 0.849 +- 0.319 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.961 +- 0.319 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.1 all KL = 0.843 +- 0.319 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.1 all L1 = 0.911 +- 0.201 (in-sample avg dev_std = 0.356)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07681600000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.927
SUFF_SIMPLE for r=0.2 class 0.0 = 0.843 +- 0.319 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.964 +- 0.319 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.2 all KL = 0.844 +- 0.319 (in-sample avg dev_std = 0.356)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.206 (in-sample avg dev_std = 0.356)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08120999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.931
SUFF_SIMPLE for r=0.4 class 0.0 = 0.832 +- 0.314 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.985 +- 0.314 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.4 all KL = 0.857 +- 0.314 (in-sample avg dev_std = 0.340)
SUFF_SIMPLE for r=0.4 all L1 = 0.916 +- 0.203 (in-sample avg dev_std = 0.340)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.083534
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.968
SUFF_SIMPLE for r=0.8 class 0.0 = 0.939 +- 0.209 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.986 +- 0.209 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.8 all KL = 0.949 +- 0.209 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.8 all L1 = 0.965 +- 0.149 (in-sample avg dev_std = 0.186)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092894
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.818
SUFF_SIMPLE for r=0.05 class 0.0 = 0.709 +- 0.398 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.987 +- 0.398 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all KL = 0.761 +- 0.398 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.05 all L1 = 0.849 +- 0.267 (in-sample avg dev_std = 0.434)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092764
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.819
SUFF_SIMPLE for r=0.1 class 0.0 = 0.71 +- 0.398 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.988 +- 0.398 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.1 all KL = 0.761 +- 0.398 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.1 all L1 = 0.85 +- 0.266 (in-sample avg dev_std = 0.433)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009251599999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.819
SUFF_SIMPLE for r=0.2 class 0.0 = 0.71 +- 0.398 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.988 +- 0.398 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.2 all KL = 0.762 +- 0.398 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.2 all L1 = 0.85 +- 0.266 (in-sample avg dev_std = 0.433)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0092452
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.815
SUFF_SIMPLE for r=0.4 class 0.0 = 0.707 +- 0.399 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.986 +- 0.399 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.4 all KL = 0.76 +- 0.399 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.4 all L1 = 0.848 +- 0.269 (in-sample avg dev_std = 0.431)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0092438
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.84
SUFF_SIMPLE for r=0.8 class 0.0 = 0.797 +- 0.335 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.992 +- 0.335 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.8 all KL = 0.859 +- 0.335 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.8 all L1 = 0.896 +- 0.259 (in-sample avg dev_std = 0.191)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035731200000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.906
SUFF_SIMPLE for r=0.05 class 0.0 = 0.881 +- 0.319 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.933 +- 0.319 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 all KL = 0.857 +- 0.319 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 all L1 = 0.907 +- 0.231 (in-sample avg dev_std = 0.297)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0443548
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.906
SUFF_SIMPLE for r=0.1 class 0.0 = 0.881 +- 0.308 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.945 +- 0.308 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.1 all KL = 0.873 +- 0.308 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.1 all L1 = 0.913 +- 0.232 (in-sample avg dev_std = 0.251)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05519400000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.908
SUFF_SIMPLE for r=0.2 class 0.0 = 0.883 +- 0.298 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.953 +- 0.298 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.2 all KL = 0.883 +- 0.298 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.231 (in-sample avg dev_std = 0.215)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0674132
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.913
SUFF_SIMPLE for r=0.4 class 0.0 = 0.892 +- 0.288 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.956 +- 0.288 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all KL = 0.891 +- 0.288 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all L1 = 0.924 +- 0.221 (in-sample avg dev_std = 0.215)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0811432
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.873
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.322 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.812 +- 0.322 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.8 all KL = 0.882 +- 0.322 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.8 all L1 = 0.898 +- 0.278 (in-sample avg dev_std = 0.027)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057848
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.0 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.003 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06810000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.998
NEC for r=0.1 class 0.0 = 0.002 +- 0.056 (in-sample avg dev_std = 0.033)
NEC for r=0.1 class 1.0 = 0.003 +- 0.056 (in-sample avg dev_std = 0.033)
NEC for r=0.1 all KL = 0.004 +- 0.056 (in-sample avg dev_std = 0.033)
NEC for r=0.1 all L1 = 0.003 +- 0.041 (in-sample avg dev_std = 0.033)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07681600000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.988
NEC for r=0.2 class 0.0 = 0.018 +- 0.135 (in-sample avg dev_std = 0.125)
NEC for r=0.2 class 1.0 = 0.01 +- 0.135 (in-sample avg dev_std = 0.125)
NEC for r=0.2 all KL = 0.024 +- 0.135 (in-sample avg dev_std = 0.125)
NEC for r=0.2 all L1 = 0.014 +- 0.088 (in-sample avg dev_std = 0.125)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08120999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.983
NEC for r=0.4 class 0.0 = 0.03 +- 0.174 (in-sample avg dev_std = 0.190)
NEC for r=0.4 class 1.0 = 0.016 +- 0.174 (in-sample avg dev_std = 0.190)
NEC for r=0.4 all KL = 0.043 +- 0.174 (in-sample avg dev_std = 0.190)
NEC for r=0.4 all L1 = 0.023 +- 0.103 (in-sample avg dev_std = 0.190)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.083534
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.982
NEC for r=0.8 class 0.0 = 0.035 +- 0.186 (in-sample avg dev_std = 0.215)
NEC for r=0.8 class 1.0 = 0.019 +- 0.186 (in-sample avg dev_std = 0.215)
NEC for r=0.8 all KL = 0.055 +- 0.186 (in-sample avg dev_std = 0.215)
NEC for r=0.8 all L1 = 0.026 +- 0.099 (in-sample avg dev_std = 0.215)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092894
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.937
NEC for r=0.05 class 0.0 = 0.014 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.001 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.008 +- 0.078 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092764
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.917
NEC for r=0.1 class 0.0 = 0.056 +- 0.188 (in-sample avg dev_std = 0.098)
NEC for r=0.1 class 1.0 = 0.003 +- 0.188 (in-sample avg dev_std = 0.098)
NEC for r=0.1 all KL = 0.04 +- 0.188 (in-sample avg dev_std = 0.098)
NEC for r=0.1 all L1 = 0.03 +- 0.143 (in-sample avg dev_std = 0.098)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009251599999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.913
NEC for r=0.2 class 0.0 = 0.091 +- 0.249 (in-sample avg dev_std = 0.278)
NEC for r=0.2 class 1.0 = 0.004 +- 0.249 (in-sample avg dev_std = 0.278)
NEC for r=0.2 all KL = 0.094 +- 0.249 (in-sample avg dev_std = 0.278)
NEC for r=0.2 all L1 = 0.047 +- 0.134 (in-sample avg dev_std = 0.278)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0092452
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.913
NEC for r=0.4 class 0.0 = 0.097 +- 0.254 (in-sample avg dev_std = 0.299)
NEC for r=0.4 class 1.0 = 0.004 +- 0.254 (in-sample avg dev_std = 0.299)
NEC for r=0.4 all KL = 0.11 +- 0.254 (in-sample avg dev_std = 0.299)
NEC for r=0.4 all L1 = 0.05 +- 0.124 (in-sample avg dev_std = 0.299)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0092438
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.913
NEC for r=0.8 class 0.0 = 0.099 +- 0.255 (in-sample avg dev_std = 0.303)
NEC for r=0.8 class 1.0 = 0.003 +- 0.255 (in-sample avg dev_std = 0.303)
NEC for r=0.8 all KL = 0.113 +- 0.255 (in-sample avg dev_std = 0.303)
NEC for r=0.8 all L1 = 0.051 +- 0.122 (in-sample avg dev_std = 0.303)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035731200000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.982
NEC for r=0.05 class 0.0 = 0.006 +- 0.087 (in-sample avg dev_std = 0.034)
NEC for r=0.05 class 1.0 = 0.007 +- 0.087 (in-sample avg dev_std = 0.034)
NEC for r=0.05 all KL = 0.008 +- 0.087 (in-sample avg dev_std = 0.034)
NEC for r=0.05 all L1 = 0.007 +- 0.074 (in-sample avg dev_std = 0.034)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0443548
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.978
NEC for r=0.1 class 0.0 = 0.011 +- 0.113 (in-sample avg dev_std = 0.059)
NEC for r=0.1 class 1.0 = 0.011 +- 0.113 (in-sample avg dev_std = 0.059)
NEC for r=0.1 all KL = 0.014 +- 0.113 (in-sample avg dev_std = 0.059)
NEC for r=0.1 all L1 = 0.011 +- 0.092 (in-sample avg dev_std = 0.059)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05519400000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.972
NEC for r=0.2 class 0.0 = 0.024 +- 0.142 (in-sample avg dev_std = 0.079)
NEC for r=0.2 class 1.0 = 0.01 +- 0.142 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all KL = 0.023 +- 0.142 (in-sample avg dev_std = 0.079)
NEC for r=0.2 all L1 = 0.017 +- 0.113 (in-sample avg dev_std = 0.079)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0674132
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.95
NEC for r=0.4 class 0.0 = 0.062 +- 0.208 (in-sample avg dev_std = 0.115)
NEC for r=0.4 class 1.0 = 0.013 +- 0.208 (in-sample avg dev_std = 0.115)
NEC for r=0.4 all KL = 0.05 +- 0.208 (in-sample avg dev_std = 0.115)
NEC for r=0.4 all L1 = 0.038 +- 0.167 (in-sample avg dev_std = 0.115)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0811432
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.936
NEC for r=0.8 class 0.0 = 0.076 +- 0.259 (in-sample avg dev_std = 0.212)
NEC for r=0.8 class 1.0 = 0.037 +- 0.259 (in-sample avg dev_std = 0.212)
NEC for r=0.8 all KL = 0.083 +- 0.259 (in-sample avg dev_std = 0.212)
NEC for r=0.8 all L1 = 0.057 +- 0.193 (in-sample avg dev_std = 0.212)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 12:32:44 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:32:44 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.054
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.034
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05356
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.93
SUFF_SIMPLE for r=0.05 class 0.0 = 0.91 +- 0.314 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.901 +- 0.314 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.05 all KL = 0.828 +- 0.314 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.05 all L1 = 0.905 +- 0.192 (in-sample avg dev_std = 0.411)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05660000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.923
SUFF_SIMPLE for r=0.1 class 0.0 = 0.915 +- 0.321 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.884 +- 0.321 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.1 all KL = 0.819 +- 0.321 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.1 all L1 = 0.898 +- 0.202 (in-sample avg dev_std = 0.415)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065534
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.916
SUFF_SIMPLE for r=0.2 class 0.0 = 0.903 +- 0.326 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.882 +- 0.326 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.2 all KL = 0.81 +- 0.326 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.2 all L1 = 0.892 +- 0.210 (in-sample avg dev_std = 0.415)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.074154
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.932
SUFF_SIMPLE for r=0.4 class 0.0 = 0.914 +- 0.293 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.923 +- 0.293 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.4 all KL = 0.868 +- 0.293 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.4 all L1 = 0.919 +- 0.201 (in-sample avg dev_std = 0.324)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.982
SUFF_SIMPLE for r=0.8 class 0.0 = 0.976 +- 0.153 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.984 +- 0.153 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all KL = 0.973 +- 0.153 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all L1 = 0.981 +- 0.113 (in-sample avg dev_std = 0.133)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009666999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.827
SUFF_SIMPLE for r=0.05 class 0.0 = 0.894 +- 0.365 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.701 +- 0.365 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.05 all KL = 0.644 +- 0.365 (in-sample avg dev_std = 0.608)
SUFF_SIMPLE for r=0.05 all L1 = 0.797 +- 0.217 (in-sample avg dev_std = 0.608)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0096274
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.823
SUFF_SIMPLE for r=0.1 class 0.0 = 0.89 +- 0.367 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.697 +- 0.367 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.1 all KL = 0.638 +- 0.367 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.1 all L1 = 0.793 +- 0.218 (in-sample avg dev_std = 0.614)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096334
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.822
SUFF_SIMPLE for r=0.2 class 0.0 = 0.886 +- 0.368 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.696 +- 0.368 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.2 all KL = 0.635 +- 0.368 (in-sample avg dev_std = 0.615)
SUFF_SIMPLE for r=0.2 all L1 = 0.79 +- 0.220 (in-sample avg dev_std = 0.615)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009627600000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.824
SUFF_SIMPLE for r=0.4 class 0.0 = 0.893 +- 0.367 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.699 +- 0.367 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.4 all KL = 0.645 +- 0.367 (in-sample avg dev_std = 0.606)
SUFF_SIMPLE for r=0.4 all L1 = 0.796 +- 0.221 (in-sample avg dev_std = 0.606)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.831
SUFF_SIMPLE for r=0.8 class 0.0 = 0.938 +- 0.351 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.787 +- 0.351 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 all KL = 0.824 +- 0.351 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 all L1 = 0.862 +- 0.283 (in-sample avg dev_std = 0.269)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03395360000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.913
SUFF_SIMPLE for r=0.05 class 0.0 = 0.893 +- 0.318 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.916 +- 0.318 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.05 all KL = 0.859 +- 0.318 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.05 all L1 = 0.904 +- 0.235 (in-sample avg dev_std = 0.308)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042783
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.915
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.307 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.92 +- 0.307 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.1 all KL = 0.875 +- 0.307 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.1 all L1 = 0.911 +- 0.235 (in-sample avg dev_std = 0.258)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052482400000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.912
SUFF_SIMPLE for r=0.2 class 0.0 = 0.902 +- 0.301 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.925 +- 0.301 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.2 all KL = 0.884 +- 0.301 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.2 all L1 = 0.913 +- 0.240 (in-sample avg dev_std = 0.218)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06523179999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.921
SUFF_SIMPLE for r=0.4 class 0.0 = 0.92 +- 0.286 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.926 +- 0.286 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all KL = 0.901 +- 0.286 (in-sample avg dev_std = 0.168)
SUFF_SIMPLE for r=0.4 all L1 = 0.923 +- 0.233 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07869480000000001
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.915
SUFF_SIMPLE for r=0.8 class 0.0 = 0.986 +- 0.274 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.87 +- 0.274 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.8 all KL = 0.917 +- 0.274 (in-sample avg dev_std = 0.022)
SUFF_SIMPLE for r=0.8 all L1 = 0.928 +- 0.237 (in-sample avg dev_std = 0.022)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05356
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.004 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05660000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.993
NEC for r=0.1 class 0.0 = 0.011 +- 0.089 (in-sample avg dev_std = 0.066)
NEC for r=0.1 class 1.0 = 0.003 +- 0.089 (in-sample avg dev_std = 0.066)
NEC for r=0.1 all KL = 0.009 +- 0.089 (in-sample avg dev_std = 0.066)
NEC for r=0.1 all L1 = 0.007 +- 0.070 (in-sample avg dev_std = 0.066)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065534
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.995
NEC for r=0.2 class 0.0 = 0.01 +- 0.088 (in-sample avg dev_std = 0.101)
NEC for r=0.2 class 1.0 = 0.004 +- 0.088 (in-sample avg dev_std = 0.101)
NEC for r=0.2 all KL = 0.012 +- 0.088 (in-sample avg dev_std = 0.101)
NEC for r=0.2 all L1 = 0.006 +- 0.052 (in-sample avg dev_std = 0.101)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.074154
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.984
NEC for r=0.4 class 0.0 = 0.02 +- 0.169 (in-sample avg dev_std = 0.203)
NEC for r=0.4 class 1.0 = 0.025 +- 0.169 (in-sample avg dev_std = 0.203)
NEC for r=0.4 all KL = 0.043 +- 0.169 (in-sample avg dev_std = 0.203)
NEC for r=0.4 all L1 = 0.023 +- 0.099 (in-sample avg dev_std = 0.203)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.979
NEC for r=0.8 class 0.0 = 0.024 +- 0.196 (in-sample avg dev_std = 0.244)
NEC for r=0.8 class 1.0 = 0.037 +- 0.196 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all KL = 0.061 +- 0.196 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all L1 = 0.031 +- 0.108 (in-sample avg dev_std = 0.244)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009666999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.964
NEC for r=0.05 class 0.0 = 0.006 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.004 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.005 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0096274
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.952
NEC for r=0.1 class 0.0 = 0.012 +- 0.137 (in-sample avg dev_std = 0.102)
NEC for r=0.1 class 1.0 = 0.023 +- 0.137 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all KL = 0.023 +- 0.137 (in-sample avg dev_std = 0.102)
NEC for r=0.1 all L1 = 0.018 +- 0.108 (in-sample avg dev_std = 0.102)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096334
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.942
NEC for r=0.2 class 0.0 = 0.023 +- 0.215 (in-sample avg dev_std = 0.269)
NEC for r=0.2 class 1.0 = 0.056 +- 0.215 (in-sample avg dev_std = 0.269)
NEC for r=0.2 all KL = 0.074 +- 0.215 (in-sample avg dev_std = 0.269)
NEC for r=0.2 all L1 = 0.04 +- 0.122 (in-sample avg dev_std = 0.269)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009627600000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.944
NEC for r=0.4 class 0.0 = 0.023 +- 0.205 (in-sample avg dev_std = 0.274)
NEC for r=0.4 class 1.0 = 0.056 +- 0.205 (in-sample avg dev_std = 0.274)
NEC for r=0.4 all KL = 0.078 +- 0.205 (in-sample avg dev_std = 0.274)
NEC for r=0.4 all L1 = 0.039 +- 0.107 (in-sample avg dev_std = 0.274)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.943
NEC for r=0.8 class 0.0 = 0.026 +- 0.210 (in-sample avg dev_std = 0.283)
NEC for r=0.8 class 1.0 = 0.057 +- 0.210 (in-sample avg dev_std = 0.283)
NEC for r=0.8 all KL = 0.084 +- 0.210 (in-sample avg dev_std = 0.283)
NEC for r=0.8 all L1 = 0.042 +- 0.108 (in-sample avg dev_std = 0.283)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03395360000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.98
NEC for r=0.05 class 0.0 = 0.008 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.01 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.087 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042783
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.979
NEC for r=0.1 class 0.0 = 0.011 +- 0.119 (in-sample avg dev_std = 0.015)
NEC for r=0.1 class 1.0 = 0.015 +- 0.119 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all KL = 0.015 +- 0.119 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all L1 = 0.013 +- 0.103 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052482400000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.972
NEC for r=0.2 class 0.0 = 0.017 +- 0.155 (in-sample avg dev_std = 0.024)
NEC for r=0.2 class 1.0 = 0.026 +- 0.155 (in-sample avg dev_std = 0.024)
NEC for r=0.2 all KL = 0.025 +- 0.155 (in-sample avg dev_std = 0.024)
NEC for r=0.2 all L1 = 0.022 +- 0.134 (in-sample avg dev_std = 0.024)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06523179999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.952
NEC for r=0.4 class 0.0 = 0.042 +- 0.218 (in-sample avg dev_std = 0.100)
NEC for r=0.4 class 1.0 = 0.044 +- 0.218 (in-sample avg dev_std = 0.100)
NEC for r=0.4 all KL = 0.053 +- 0.218 (in-sample avg dev_std = 0.100)
NEC for r=0.4 all L1 = 0.043 +- 0.181 (in-sample avg dev_std = 0.100)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07869480000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.939
NEC for r=0.8 class 0.0 = 0.065 +- 0.267 (in-sample avg dev_std = 0.240)
NEC for r=0.8 class 1.0 = 0.062 +- 0.267 (in-sample avg dev_std = 0.240)
NEC for r=0.8 all KL = 0.091 +- 0.267 (in-sample avg dev_std = 0.240)
NEC for r=0.8 all L1 = 0.064 +- 0.199 (in-sample avg dev_std = 0.240)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 12:48:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 12:48:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.057
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.059
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.011
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.011
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057002000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.82
SUFF_SIMPLE for r=0.05 class 0.0 = 0.962 +- 0.423 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.633 +- 0.423 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 all KL = 0.646 +- 0.423 (in-sample avg dev_std = 0.584)
SUFF_SIMPLE for r=0.05 all L1 = 0.78 +- 0.288 (in-sample avg dev_std = 0.584)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05931
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.824
SUFF_SIMPLE for r=0.1 class 0.0 = 0.957 +- 0.420 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.656 +- 0.420 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.1 all KL = 0.67 +- 0.420 (in-sample avg dev_std = 0.552)
SUFF_SIMPLE for r=0.1 all L1 = 0.79 +- 0.293 (in-sample avg dev_std = 0.552)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.825
SUFF_SIMPLE for r=0.2 class 0.0 = 0.964 +- 0.420 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.653 +- 0.420 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.2 all KL = 0.674 +- 0.420 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.2 all L1 = 0.792 +- 0.293 (in-sample avg dev_std = 0.545)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076754
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.83
SUFF_SIMPLE for r=0.4 class 0.0 = 0.979 +- 0.414 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.674 +- 0.414 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 all KL = 0.715 +- 0.414 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.4 all L1 = 0.81 +- 0.299 (in-sample avg dev_std = 0.474)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079788
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.905
SUFF_SIMPLE for r=0.8 class 0.0 = 0.987 +- 0.316 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.316 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all KL = 0.876 +- 0.316 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.8 all L1 = 0.906 +- 0.250 (in-sample avg dev_std = 0.232)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010604599999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.798
SUFF_SIMPLE for r=0.05 class 0.0 = 0.943 +- 0.398 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.546 +- 0.398 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.05 all KL = 0.593 +- 0.398 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.05 all L1 = 0.743 +- 0.270 (in-sample avg dev_std = 0.655)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010598999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.799
SUFF_SIMPLE for r=0.1 class 0.0 = 0.943 +- 0.399 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.549 +- 0.399 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.1 all KL = 0.594 +- 0.399 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.1 all L1 = 0.744 +- 0.270 (in-sample avg dev_std = 0.655)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010568200000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.799
SUFF_SIMPLE for r=0.2 class 0.0 = 0.941 +- 0.398 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.554 +- 0.398 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.2 all KL = 0.597 +- 0.398 (in-sample avg dev_std = 0.649)
SUFF_SIMPLE for r=0.2 all L1 = 0.746 +- 0.271 (in-sample avg dev_std = 0.649)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01055
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.797
SUFF_SIMPLE for r=0.4 class 0.0 = 0.941 +- 0.401 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.554 +- 0.401 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.4 all KL = 0.6 +- 0.401 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.4 all L1 = 0.746 +- 0.275 (in-sample avg dev_std = 0.643)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0105494
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.819
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.384 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.693 +- 0.384 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 all KL = 0.789 +- 0.384 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.8 all L1 = 0.831 +- 0.317 (in-sample avg dev_std = 0.279)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0329248
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.866
SUFF_SIMPLE for r=0.05 class 0.0 = 0.927 +- 0.376 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.785 +- 0.376 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.05 all KL = 0.794 +- 0.376 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.05 all L1 = 0.857 +- 0.280 (in-sample avg dev_std = 0.377)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0423122
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.87
SUFF_SIMPLE for r=0.1 class 0.0 = 0.924 +- 0.366 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.806 +- 0.366 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.1 all KL = 0.813 +- 0.366 (in-sample avg dev_std = 0.325)
SUFF_SIMPLE for r=0.1 all L1 = 0.865 +- 0.281 (in-sample avg dev_std = 0.325)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053900199999999995
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.878
SUFF_SIMPLE for r=0.2 class 0.0 = 0.923 +- 0.356 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.822 +- 0.356 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.2 all KL = 0.831 +- 0.356 (in-sample avg dev_std = 0.280)
SUFF_SIMPLE for r=0.2 all L1 = 0.873 +- 0.282 (in-sample avg dev_std = 0.280)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0656808
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.884
SUFF_SIMPLE for r=0.4 class 0.0 = 0.956 +- 0.335 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.822 +- 0.335 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.4 all KL = 0.857 +- 0.335 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.4 all L1 = 0.889 +- 0.272 (in-sample avg dev_std = 0.216)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.981
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791548
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.901
SUFF_SIMPLE for r=0.8 class 0.0 = 0.993 +- 0.295 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.837 +- 0.295 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.8 all KL = 0.903 +- 0.295 (in-sample avg dev_std = 0.043)
SUFF_SIMPLE for r=0.8 all L1 = 0.916 +- 0.254 (in-sample avg dev_std = 0.043)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057002000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.979
NEC for r=0.05 class 0.0 = 0.0 +- 0.150 (in-sample avg dev_std = 0.043)
NEC for r=0.05 class 1.0 = 0.036 +- 0.150 (in-sample avg dev_std = 0.043)
NEC for r=0.05 all KL = 0.024 +- 0.150 (in-sample avg dev_std = 0.043)
NEC for r=0.05 all L1 = 0.02 +- 0.127 (in-sample avg dev_std = 0.043)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05931
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.967
NEC for r=0.1 class 0.0 = 0.003 +- 0.198 (in-sample avg dev_std = 0.144)
NEC for r=0.1 class 1.0 = 0.056 +- 0.198 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all KL = 0.045 +- 0.198 (in-sample avg dev_std = 0.144)
NEC for r=0.1 all L1 = 0.033 +- 0.151 (in-sample avg dev_std = 0.144)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.945
NEC for r=0.2 class 0.0 = 0.001 +- 0.258 (in-sample avg dev_std = 0.232)
NEC for r=0.2 class 1.0 = 0.104 +- 0.258 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all KL = 0.086 +- 0.258 (in-sample avg dev_std = 0.232)
NEC for r=0.2 all L1 = 0.058 +- 0.191 (in-sample avg dev_std = 0.232)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076754
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.934
NEC for r=0.4 class 0.0 = 0.009 +- 0.300 (in-sample avg dev_std = 0.331)
NEC for r=0.4 class 1.0 = 0.134 +- 0.300 (in-sample avg dev_std = 0.331)
NEC for r=0.4 all KL = 0.126 +- 0.300 (in-sample avg dev_std = 0.331)
NEC for r=0.4 all L1 = 0.078 +- 0.203 (in-sample avg dev_std = 0.331)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079788
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.927
NEC for r=0.8 class 0.0 = 0.008 +- 0.331 (in-sample avg dev_std = 0.407)
NEC for r=0.8 class 1.0 = 0.166 +- 0.331 (in-sample avg dev_std = 0.407)
NEC for r=0.8 all KL = 0.165 +- 0.331 (in-sample avg dev_std = 0.407)
NEC for r=0.8 all L1 = 0.096 +- 0.206 (in-sample avg dev_std = 0.407)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010604599999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.992
NEC for r=0.05 class 0.0 = 0.002 +- 0.089 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.013 +- 0.089 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.008 +- 0.089 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.007 +- 0.078 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010598999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.956
NEC for r=0.1 class 0.0 = 0.009 +- 0.214 (in-sample avg dev_std = 0.146)
NEC for r=0.1 class 1.0 = 0.076 +- 0.214 (in-sample avg dev_std = 0.146)
NEC for r=0.1 all KL = 0.053 +- 0.214 (in-sample avg dev_std = 0.146)
NEC for r=0.1 all L1 = 0.042 +- 0.174 (in-sample avg dev_std = 0.146)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010568200000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.948
NEC for r=0.2 class 0.0 = 0.016 +- 0.266 (in-sample avg dev_std = 0.332)
NEC for r=0.2 class 1.0 = 0.116 +- 0.266 (in-sample avg dev_std = 0.332)
NEC for r=0.2 all KL = 0.111 +- 0.266 (in-sample avg dev_std = 0.332)
NEC for r=0.2 all L1 = 0.067 +- 0.172 (in-sample avg dev_std = 0.332)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01055
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.949
NEC for r=0.4 class 0.0 = 0.021 +- 0.272 (in-sample avg dev_std = 0.366)
NEC for r=0.4 class 1.0 = 0.121 +- 0.272 (in-sample avg dev_std = 0.366)
NEC for r=0.4 all KL = 0.129 +- 0.272 (in-sample avg dev_std = 0.366)
NEC for r=0.4 all L1 = 0.072 +- 0.161 (in-sample avg dev_std = 0.366)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0105494
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.948
NEC for r=0.8 class 0.0 = 0.025 +- 0.276 (in-sample avg dev_std = 0.385)
NEC for r=0.8 class 1.0 = 0.126 +- 0.276 (in-sample avg dev_std = 0.385)
NEC for r=0.8 all KL = 0.143 +- 0.276 (in-sample avg dev_std = 0.385)
NEC for r=0.8 all L1 = 0.076 +- 0.155 (in-sample avg dev_std = 0.385)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0329248
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.966
NEC for r=0.05 class 0.0 = 0.004 +- 0.147 (in-sample avg dev_std = 0.016)
NEC for r=0.05 class 1.0 = 0.037 +- 0.147 (in-sample avg dev_std = 0.016)
NEC for r=0.05 all KL = 0.023 +- 0.147 (in-sample avg dev_std = 0.016)
NEC for r=0.05 all L1 = 0.02 +- 0.128 (in-sample avg dev_std = 0.016)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0423122
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.959
NEC for r=0.1 class 0.0 = 0.005 +- 0.179 (in-sample avg dev_std = 0.038)
NEC for r=0.1 class 1.0 = 0.054 +- 0.179 (in-sample avg dev_std = 0.038)
NEC for r=0.1 all KL = 0.034 +- 0.179 (in-sample avg dev_std = 0.038)
NEC for r=0.1 all L1 = 0.029 +- 0.154 (in-sample avg dev_std = 0.038)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053900199999999995
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.945
NEC for r=0.2 class 0.0 = 0.009 +- 0.224 (in-sample avg dev_std = 0.066)
NEC for r=0.2 class 1.0 = 0.084 +- 0.224 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all KL = 0.055 +- 0.224 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all L1 = 0.046 +- 0.190 (in-sample avg dev_std = 0.066)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0656808
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.924
NEC for r=0.4 class 0.0 = 0.017 +- 0.277 (in-sample avg dev_std = 0.169)
NEC for r=0.4 class 1.0 = 0.125 +- 0.277 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all KL = 0.09 +- 0.277 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all L1 = 0.071 +- 0.224 (in-sample avg dev_std = 0.169)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791548
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.908
NEC for r=0.8 class 0.0 = 0.043 +- 0.331 (in-sample avg dev_std = 0.318)
NEC for r=0.8 class 1.0 = 0.164 +- 0.331 (in-sample avg dev_std = 0.318)
NEC for r=0.8 all KL = 0.148 +- 0.331 (in-sample avg dev_std = 0.318)
NEC for r=0.8 all L1 = 0.103 +- 0.245 (in-sample avg dev_std = 0.318)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 13:04:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:04:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.044
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.068
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.076
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.029
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044073999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.883
SUFF_SIMPLE for r=0.05 class 0.0 = 0.928 +- 0.357 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.775 +- 0.357 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.05 all KL = 0.745 +- 0.357 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.05 all L1 = 0.843 +- 0.236 (in-sample avg dev_std = 0.523)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057314
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.873
SUFF_SIMPLE for r=0.1 class 0.0 = 0.921 +- 0.366 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.765 +- 0.366 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 all KL = 0.734 +- 0.366 (in-sample avg dev_std = 0.525)
SUFF_SIMPLE for r=0.1 all L1 = 0.834 +- 0.245 (in-sample avg dev_std = 0.525)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.068084
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.888
SUFF_SIMPLE for r=0.2 class 0.0 = 0.93 +- 0.349 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.789 +- 0.349 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.2 all KL = 0.76 +- 0.349 (in-sample avg dev_std = 0.490)
SUFF_SIMPLE for r=0.2 all L1 = 0.852 +- 0.234 (in-sample avg dev_std = 0.490)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07598400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.889
SUFF_SIMPLE for r=0.4 class 0.0 = 0.947 +- 0.349 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.8 +- 0.349 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.4 all KL = 0.796 +- 0.349 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.4 all L1 = 0.865 +- 0.245 (in-sample avg dev_std = 0.432)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.941
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.260 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.9 +- 0.260 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.8 all KL = 0.913 +- 0.260 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.8 all L1 = 0.936 +- 0.198 (in-sample avg dev_std = 0.244)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.595
SUFF_SIMPLE for r=0.05 class 0.0 = 0.98 +- 0.424 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.53 +- 0.424 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.05 all KL = 0.68 +- 0.424 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.05 all L1 = 0.753 +- 0.333 (in-sample avg dev_std = 0.502)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093206
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.597
SUFF_SIMPLE for r=0.1 class 0.0 = 0.979 +- 0.423 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.532 +- 0.423 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all KL = 0.68 +- 0.423 (in-sample avg dev_std = 0.506)
SUFF_SIMPLE for r=0.1 all L1 = 0.754 +- 0.331 (in-sample avg dev_std = 0.506)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094224
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.596
SUFF_SIMPLE for r=0.2 class 0.0 = 0.979 +- 0.423 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.533 +- 0.423 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.2 all KL = 0.681 +- 0.423 (in-sample avg dev_std = 0.497)
SUFF_SIMPLE for r=0.2 all L1 = 0.754 +- 0.332 (in-sample avg dev_std = 0.497)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094386
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.599
SUFF_SIMPLE for r=0.4 class 0.0 = 0.981 +- 0.422 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.537 +- 0.422 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.4 all KL = 0.686 +- 0.422 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.4 all L1 = 0.757 +- 0.332 (in-sample avg dev_std = 0.494)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0094424
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.587
SUFF_SIMPLE for r=0.8 class 0.0 = 0.994 +- 0.414 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.576 +- 0.414 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all KL = 0.752 +- 0.414 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.8 all L1 = 0.783 +- 0.357 (in-sample avg dev_std = 0.189)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029376999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.902
SUFF_SIMPLE for r=0.05 class 0.0 = 0.889 +- 0.321 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.899 +- 0.321 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.05 all KL = 0.849 +- 0.321 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.05 all L1 = 0.894 +- 0.242 (in-sample avg dev_std = 0.331)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0362364
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.901
SUFF_SIMPLE for r=0.1 class 0.0 = 0.898 +- 0.317 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.897 +- 0.317 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 all KL = 0.861 +- 0.317 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 all L1 = 0.898 +- 0.246 (in-sample avg dev_std = 0.287)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.046014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.898
SUFF_SIMPLE for r=0.2 class 0.0 = 0.902 +- 0.309 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.905 +- 0.309 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all KL = 0.874 +- 0.309 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.2 all L1 = 0.903 +- 0.248 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05965340000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.904
SUFF_SIMPLE for r=0.4 class 0.0 = 0.919 +- 0.298 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.904 +- 0.298 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all KL = 0.889 +- 0.298 (in-sample avg dev_std = 0.190)
SUFF_SIMPLE for r=0.4 all L1 = 0.912 +- 0.245 (in-sample avg dev_std = 0.190)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0769752
len(reference) = 4955
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.956
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.192 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.946 +- 0.192 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 all KL = 0.961 +- 0.192 (in-sample avg dev_std = 0.035)
SUFF_SIMPLE for r=0.8 all L1 = 0.966 +- 0.166 (in-sample avg dev_std = 0.035)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044073999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.0 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.003 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.044 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057314
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.988
NEC for r=0.1 class 0.0 = 0.001 +- 0.120 (in-sample avg dev_std = 0.103)
NEC for r=0.1 class 1.0 = 0.023 +- 0.120 (in-sample avg dev_std = 0.103)
NEC for r=0.1 all KL = 0.018 +- 0.120 (in-sample avg dev_std = 0.103)
NEC for r=0.1 all L1 = 0.013 +- 0.093 (in-sample avg dev_std = 0.103)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.068084
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.983
NEC for r=0.2 class 0.0 = 0.003 +- 0.156 (in-sample avg dev_std = 0.177)
NEC for r=0.2 class 1.0 = 0.04 +- 0.156 (in-sample avg dev_std = 0.177)
NEC for r=0.2 all KL = 0.036 +- 0.156 (in-sample avg dev_std = 0.177)
NEC for r=0.2 all L1 = 0.024 +- 0.107 (in-sample avg dev_std = 0.177)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07598400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.968
NEC for r=0.4 class 0.0 = 0.018 +- 0.207 (in-sample avg dev_std = 0.252)
NEC for r=0.4 class 1.0 = 0.061 +- 0.207 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all KL = 0.066 +- 0.207 (in-sample avg dev_std = 0.252)
NEC for r=0.4 all L1 = 0.042 +- 0.141 (in-sample avg dev_std = 0.252)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.967
NEC for r=0.8 class 0.0 = 0.019 +- 0.220 (in-sample avg dev_std = 0.296)
NEC for r=0.8 class 1.0 = 0.072 +- 0.220 (in-sample avg dev_std = 0.296)
NEC for r=0.8 all KL = 0.084 +- 0.220 (in-sample avg dev_std = 0.296)
NEC for r=0.8 all L1 = 0.049 +- 0.135 (in-sample avg dev_std = 0.296)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.716
NEC for r=0.05 class 0.0 = 0.0 +- 0.296 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.188 +- 0.296 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.105 +- 0.296 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.095 +- 0.261 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093206
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.626
NEC for r=0.1 class 0.0 = 0.001 +- 0.385 (in-sample avg dev_std = 0.163)
NEC for r=0.1 class 1.0 = 0.353 +- 0.385 (in-sample avg dev_std = 0.163)
NEC for r=0.1 all KL = 0.202 +- 0.385 (in-sample avg dev_std = 0.163)
NEC for r=0.1 all L1 = 0.178 +- 0.333 (in-sample avg dev_std = 0.163)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094224
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.616
NEC for r=0.2 class 0.0 = 0.002 +- 0.406 (in-sample avg dev_std = 0.396)
NEC for r=0.2 class 1.0 = 0.415 +- 0.406 (in-sample avg dev_std = 0.396)
NEC for r=0.2 all KL = 0.261 +- 0.406 (in-sample avg dev_std = 0.396)
NEC for r=0.2 all L1 = 0.21 +- 0.328 (in-sample avg dev_std = 0.396)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094386
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.618
NEC for r=0.4 class 0.0 = 0.001 +- 0.409 (in-sample avg dev_std = 0.434)
NEC for r=0.4 class 1.0 = 0.424 +- 0.409 (in-sample avg dev_std = 0.434)
NEC for r=0.4 all KL = 0.271 +- 0.409 (in-sample avg dev_std = 0.434)
NEC for r=0.4 all L1 = 0.214 +- 0.325 (in-sample avg dev_std = 0.434)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0094424
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.618
NEC for r=0.8 class 0.0 = 0.001 +- 0.409 (in-sample avg dev_std = 0.447)
NEC for r=0.8 class 1.0 = 0.428 +- 0.409 (in-sample avg dev_std = 0.447)
NEC for r=0.8 all KL = 0.274 +- 0.409 (in-sample avg dev_std = 0.447)
NEC for r=0.8 all L1 = 0.216 +- 0.324 (in-sample avg dev_std = 0.447)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029376999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.98
NEC for r=0.05 class 0.0 = 0.007 +- 0.103 (in-sample avg dev_std = 0.010)
NEC for r=0.05 class 1.0 = 0.012 +- 0.103 (in-sample avg dev_std = 0.010)
NEC for r=0.05 all KL = 0.011 +- 0.103 (in-sample avg dev_std = 0.010)
NEC for r=0.05 all L1 = 0.01 +- 0.090 (in-sample avg dev_std = 0.010)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0362364
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.977
NEC for r=0.1 class 0.0 = 0.011 +- 0.121 (in-sample avg dev_std = 0.025)
NEC for r=0.1 class 1.0 = 0.017 +- 0.121 (in-sample avg dev_std = 0.025)
NEC for r=0.1 all KL = 0.016 +- 0.121 (in-sample avg dev_std = 0.025)
NEC for r=0.1 all L1 = 0.014 +- 0.105 (in-sample avg dev_std = 0.025)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.046014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.965
NEC for r=0.2 class 0.0 = 0.018 +- 0.162 (in-sample avg dev_std = 0.034)
NEC for r=0.2 class 1.0 = 0.031 +- 0.162 (in-sample avg dev_std = 0.034)
NEC for r=0.2 all KL = 0.028 +- 0.162 (in-sample avg dev_std = 0.034)
NEC for r=0.2 all L1 = 0.025 +- 0.140 (in-sample avg dev_std = 0.034)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05965340000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.943
NEC for r=0.4 class 0.0 = 0.039 +- 0.227 (in-sample avg dev_std = 0.126)
NEC for r=0.4 class 1.0 = 0.058 +- 0.227 (in-sample avg dev_std = 0.126)
NEC for r=0.4 all KL = 0.06 +- 0.227 (in-sample avg dev_std = 0.126)
NEC for r=0.4 all L1 = 0.048 +- 0.189 (in-sample avg dev_std = 0.126)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0769752
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.937
NEC for r=0.8 class 0.0 = 0.059 +- 0.264 (in-sample avg dev_std = 0.261)
NEC for r=0.8 class 1.0 = 0.073 +- 0.264 (in-sample avg dev_std = 0.261)
NEC for r=0.8 all KL = 0.094 +- 0.264 (in-sample avg dev_std = 0.261)
NEC for r=0.8 all L1 = 0.066 +- 0.197 (in-sample avg dev_std = 0.261)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 13:20:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:20:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.048
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.058
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.065
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.075
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.011
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.011
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.033
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.043
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.058
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04773600000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.899
SUFF_SIMPLE for r=0.05 class 0.0 = 0.885 +- 0.331 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.84 +- 0.331 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.05 all KL = 0.766 +- 0.331 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.05 all L1 = 0.86 +- 0.214 (in-sample avg dev_std = 0.487)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057894
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.896
SUFF_SIMPLE for r=0.1 class 0.0 = 0.875 +- 0.339 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.854 +- 0.339 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.1 all KL = 0.779 +- 0.339 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.1 all L1 = 0.863 +- 0.227 (in-sample avg dev_std = 0.460)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065108
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.886
SUFF_SIMPLE for r=0.2 class 0.0 = 0.871 +- 0.348 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.847 +- 0.348 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all KL = 0.777 +- 0.348 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all L1 = 0.858 +- 0.240 (in-sample avg dev_std = 0.452)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07490999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.908
SUFF_SIMPLE for r=0.4 class 0.0 = 0.902 +- 0.320 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.874 +- 0.320 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 all KL = 0.825 +- 0.320 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 all L1 = 0.887 +- 0.225 (in-sample avg dev_std = 0.385)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08053
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.955
SUFF_SIMPLE for r=0.8 class 0.0 = 0.954 +- 0.231 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.948 +- 0.231 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.8 all KL = 0.932 +- 0.231 (in-sample avg dev_std = 0.208)
SUFF_SIMPLE for r=0.8 all L1 = 0.95 +- 0.176 (in-sample avg dev_std = 0.208)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010719800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.764
SUFF_SIMPLE for r=0.05 class 0.0 = 0.78 +- 0.349 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.939 +- 0.349 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.05 all KL = 0.769 +- 0.349 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.05 all L1 = 0.86 +- 0.224 (in-sample avg dev_std = 0.450)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0107042
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.761
SUFF_SIMPLE for r=0.1 class 0.0 = 0.777 +- 0.351 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.937 +- 0.351 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.1 all KL = 0.766 +- 0.351 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.1 all L1 = 0.858 +- 0.227 (in-sample avg dev_std = 0.452)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010694
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.763
SUFF_SIMPLE for r=0.2 class 0.0 = 0.778 +- 0.350 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.937 +- 0.350 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all KL = 0.766 +- 0.350 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all L1 = 0.858 +- 0.225 (in-sample avg dev_std = 0.452)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.764
SUFF_SIMPLE for r=0.4 class 0.0 = 0.783 +- 0.349 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.938 +- 0.349 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.4 all KL = 0.774 +- 0.349 (in-sample avg dev_std = 0.445)
SUFF_SIMPLE for r=0.4 all L1 = 0.861 +- 0.226 (in-sample avg dev_std = 0.445)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.779
SUFF_SIMPLE for r=0.8 class 0.0 = 0.85 +- 0.306 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.964 +- 0.306 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.8 all KL = 0.877 +- 0.306 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.8 all L1 = 0.907 +- 0.239 (in-sample avg dev_std = 0.185)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024968
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.82
SUFF_SIMPLE for r=0.05 class 0.0 = 0.91 +- 0.386 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.666 +- 0.386 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.05 all KL = 0.697 +- 0.386 (in-sample avg dev_std = 0.486)
SUFF_SIMPLE for r=0.05 all L1 = 0.79 +- 0.291 (in-sample avg dev_std = 0.486)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03285
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.829
SUFF_SIMPLE for r=0.1 class 0.0 = 0.902 +- 0.380 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.704 +- 0.380 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.1 all KL = 0.719 +- 0.380 (in-sample avg dev_std = 0.453)
SUFF_SIMPLE for r=0.1 all L1 = 0.804 +- 0.288 (in-sample avg dev_std = 0.453)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043273200000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.837
SUFF_SIMPLE for r=0.2 class 0.0 = 0.894 +- 0.373 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.737 +- 0.373 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 all KL = 0.737 +- 0.373 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 all L1 = 0.816 +- 0.284 (in-sample avg dev_std = 0.429)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0580568
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.841
SUFF_SIMPLE for r=0.4 class 0.0 = 0.899 +- 0.377 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.75 +- 0.377 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.4 all KL = 0.752 +- 0.377 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.4 all L1 = 0.826 +- 0.283 (in-sample avg dev_std = 0.439)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0773802
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.808
SUFF_SIMPLE for r=0.8 class 0.0 = 0.981 +- 0.384 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.693 +- 0.384 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.8 all KL = 0.815 +- 0.384 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.8 all L1 = 0.838 +- 0.333 (in-sample avg dev_std = 0.069)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04773600000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.988
NEC for r=0.05 class 0.0 = 0.0 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.019 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.012 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.01 +- 0.094 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057894
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.976
NEC for r=0.1 class 0.0 = 0.009 +- 0.164 (in-sample avg dev_std = 0.113)
NEC for r=0.1 class 1.0 = 0.036 +- 0.164 (in-sample avg dev_std = 0.113)
NEC for r=0.1 all KL = 0.03 +- 0.164 (in-sample avg dev_std = 0.113)
NEC for r=0.1 all L1 = 0.024 +- 0.132 (in-sample avg dev_std = 0.113)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065108
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.974
NEC for r=0.2 class 0.0 = 0.011 +- 0.178 (in-sample avg dev_std = 0.167)
NEC for r=0.2 class 1.0 = 0.042 +- 0.178 (in-sample avg dev_std = 0.167)
NEC for r=0.2 all KL = 0.041 +- 0.178 (in-sample avg dev_std = 0.167)
NEC for r=0.2 all L1 = 0.028 +- 0.129 (in-sample avg dev_std = 0.167)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07490999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.966
NEC for r=0.4 class 0.0 = 0.016 +- 0.215 (in-sample avg dev_std = 0.245)
NEC for r=0.4 class 1.0 = 0.062 +- 0.215 (in-sample avg dev_std = 0.245)
NEC for r=0.4 all KL = 0.066 +- 0.215 (in-sample avg dev_std = 0.245)
NEC for r=0.4 all L1 = 0.042 +- 0.146 (in-sample avg dev_std = 0.245)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08053
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.96
NEC for r=0.8 class 0.0 = 0.03 +- 0.240 (in-sample avg dev_std = 0.331)
NEC for r=0.8 class 1.0 = 0.083 +- 0.240 (in-sample avg dev_std = 0.331)
NEC for r=0.8 all KL = 0.103 +- 0.240 (in-sample avg dev_std = 0.331)
NEC for r=0.8 all L1 = 0.059 +- 0.146 (in-sample avg dev_std = 0.331)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010719800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.855
NEC for r=0.05 class 0.0 = 0.009 +- 0.097 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.007 +- 0.097 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.097 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.008 +- 0.081 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0107042
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.842
NEC for r=0.1 class 0.0 = 0.034 +- 0.164 (in-sample avg dev_std = 0.096)
NEC for r=0.1 class 1.0 = 0.016 +- 0.164 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all KL = 0.031 +- 0.164 (in-sample avg dev_std = 0.096)
NEC for r=0.1 all L1 = 0.025 +- 0.131 (in-sample avg dev_std = 0.096)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010694
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.837
NEC for r=0.2 class 0.0 = 0.059 +- 0.212 (in-sample avg dev_std = 0.263)
NEC for r=0.2 class 1.0 = 0.025 +- 0.212 (in-sample avg dev_std = 0.263)
NEC for r=0.2 all KL = 0.072 +- 0.212 (in-sample avg dev_std = 0.263)
NEC for r=0.2 all L1 = 0.042 +- 0.128 (in-sample avg dev_std = 0.263)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.837
NEC for r=0.4 class 0.0 = 0.06 +- 0.210 (in-sample avg dev_std = 0.285)
NEC for r=0.4 class 1.0 = 0.03 +- 0.210 (in-sample avg dev_std = 0.285)
NEC for r=0.4 all KL = 0.086 +- 0.210 (in-sample avg dev_std = 0.285)
NEC for r=0.4 all L1 = 0.045 +- 0.112 (in-sample avg dev_std = 0.285)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.837
NEC for r=0.8 class 0.0 = 0.061 +- 0.206 (in-sample avg dev_std = 0.293)
NEC for r=0.8 class 1.0 = 0.032 +- 0.206 (in-sample avg dev_std = 0.293)
NEC for r=0.8 all KL = 0.091 +- 0.206 (in-sample avg dev_std = 0.293)
NEC for r=0.8 all L1 = 0.046 +- 0.106 (in-sample avg dev_std = 0.293)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024968
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.975
NEC for r=0.05 class 0.0 = 0.01 +- 0.131 (in-sample avg dev_std = 0.052)
NEC for r=0.05 class 1.0 = 0.022 +- 0.131 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all KL = 0.018 +- 0.131 (in-sample avg dev_std = 0.052)
NEC for r=0.05 all L1 = 0.016 +- 0.112 (in-sample avg dev_std = 0.052)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03285
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.966
NEC for r=0.1 class 0.0 = 0.013 +- 0.168 (in-sample avg dev_std = 0.109)
NEC for r=0.1 class 1.0 = 0.039 +- 0.168 (in-sample avg dev_std = 0.109)
NEC for r=0.1 all KL = 0.032 +- 0.168 (in-sample avg dev_std = 0.109)
NEC for r=0.1 all L1 = 0.026 +- 0.139 (in-sample avg dev_std = 0.109)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043273200000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.953
NEC for r=0.2 class 0.0 = 0.021 +- 0.208 (in-sample avg dev_std = 0.174)
NEC for r=0.2 class 1.0 = 0.061 +- 0.208 (in-sample avg dev_std = 0.174)
NEC for r=0.2 all KL = 0.053 +- 0.208 (in-sample avg dev_std = 0.174)
NEC for r=0.2 all L1 = 0.041 +- 0.164 (in-sample avg dev_std = 0.174)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0580568
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.928
NEC for r=0.4 class 0.0 = 0.053 +- 0.267 (in-sample avg dev_std = 0.245)
NEC for r=0.4 class 1.0 = 0.09 +- 0.267 (in-sample avg dev_std = 0.245)
NEC for r=0.4 all KL = 0.097 +- 0.267 (in-sample avg dev_std = 0.245)
NEC for r=0.4 all L1 = 0.071 +- 0.205 (in-sample avg dev_std = 0.245)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0773802
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.889
NEC for r=0.8 class 0.0 = 0.072 +- 0.334 (in-sample avg dev_std = 0.363)
NEC for r=0.8 class 1.0 = 0.181 +- 0.334 (in-sample avg dev_std = 0.363)
NEC for r=0.8 all KL = 0.18 +- 0.334 (in-sample avg dev_std = 0.363)
NEC for r=0.8 all L1 = 0.126 +- 0.250 (in-sample avg dev_std = 0.363)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 13:36:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:36:09 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.058
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.067
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.053
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057756
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.757
SUFF_SIMPLE for r=0.05 class 0.0 = 0.952 +- 0.444 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.496 +- 0.444 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.05 all KL = 0.505 +- 0.444 (in-sample avg dev_std = 0.668)
SUFF_SIMPLE for r=0.05 all L1 = 0.699 +- 0.302 (in-sample avg dev_std = 0.668)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06705199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.744
SUFF_SIMPLE for r=0.1 class 0.0 = 0.947 +- 0.440 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.479 +- 0.440 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.1 all KL = 0.489 +- 0.440 (in-sample avg dev_std = 0.666)
SUFF_SIMPLE for r=0.1 all L1 = 0.688 +- 0.305 (in-sample avg dev_std = 0.666)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07347
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.762
SUFF_SIMPLE for r=0.2 class 0.0 = 0.954 +- 0.438 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.508 +- 0.438 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.2 all KL = 0.512 +- 0.438 (in-sample avg dev_std = 0.640)
SUFF_SIMPLE for r=0.2 all L1 = 0.707 +- 0.300 (in-sample avg dev_std = 0.640)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.079888
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.765
SUFF_SIMPLE for r=0.4 class 0.0 = 0.96 +- 0.442 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.525 +- 0.442 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.4 all KL = 0.545 +- 0.442 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.4 all L1 = 0.719 +- 0.309 (in-sample avg dev_std = 0.601)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08387799999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.843
SUFF_SIMPLE for r=0.8 class 0.0 = 0.994 +- 0.392 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.712 +- 0.392 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.8 all KL = 0.771 +- 0.392 (in-sample avg dev_std = 0.316)
SUFF_SIMPLE for r=0.8 all L1 = 0.838 +- 0.300 (in-sample avg dev_std = 0.316)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0093914
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.524
SUFF_SIMPLE for r=0.05 class 0.0 = 0.991 +- 0.446 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.316 +- 0.446 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.05 all KL = 0.608 +- 0.446 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.05 all L1 = 0.651 +- 0.389 (in-sample avg dev_std = 0.312)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.525
SUFF_SIMPLE for r=0.1 class 0.0 = 0.993 +- 0.446 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.316 +- 0.446 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.1 all KL = 0.611 +- 0.446 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.1 all L1 = 0.652 +- 0.389 (in-sample avg dev_std = 0.308)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009567
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.524
SUFF_SIMPLE for r=0.2 class 0.0 = 0.993 +- 0.446 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.316 +- 0.446 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all KL = 0.609 +- 0.446 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.2 all L1 = 0.651 +- 0.389 (in-sample avg dev_std = 0.314)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602800000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.524
SUFF_SIMPLE for r=0.4 class 0.0 = 0.993 +- 0.447 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.317 +- 0.447 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.4 all KL = 0.611 +- 0.447 (in-sample avg dev_std = 0.303)
SUFF_SIMPLE for r=0.4 all L1 = 0.652 +- 0.390 (in-sample avg dev_std = 0.303)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096094
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.528
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.444 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.346 +- 0.444 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all KL = 0.639 +- 0.444 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.8 all L1 = 0.668 +- 0.394 (in-sample avg dev_std = 0.133)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034668399999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.784
SUFF_SIMPLE for r=0.05 class 0.0 = 0.957 +- 0.432 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.58 +- 0.432 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.05 all KL = 0.637 +- 0.432 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.05 all L1 = 0.771 +- 0.306 (in-sample avg dev_std = 0.524)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042652800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.788
SUFF_SIMPLE for r=0.1 class 0.0 = 0.958 +- 0.428 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.594 +- 0.428 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.1 all KL = 0.651 +- 0.428 (in-sample avg dev_std = 0.496)
SUFF_SIMPLE for r=0.1 all L1 = 0.778 +- 0.305 (in-sample avg dev_std = 0.496)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0529322
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.787
SUFF_SIMPLE for r=0.2 class 0.0 = 0.952 +- 0.427 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.607 +- 0.427 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.2 all KL = 0.661 +- 0.427 (in-sample avg dev_std = 0.469)
SUFF_SIMPLE for r=0.2 all L1 = 0.782 +- 0.309 (in-sample avg dev_std = 0.469)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06489980000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.797
SUFF_SIMPLE for r=0.4 class 0.0 = 0.953 +- 0.428 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.619 +- 0.428 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.4 all KL = 0.683 +- 0.428 (in-sample avg dev_std = 0.436)
SUFF_SIMPLE for r=0.4 all L1 = 0.788 +- 0.314 (in-sample avg dev_std = 0.436)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0789312
len(reference) = 4975
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.818
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.381 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.697 +- 0.381 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.8 all KL = 0.817 +- 0.381 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.8 all L1 = 0.845 +- 0.324 (in-sample avg dev_std = 0.136)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057756
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.979
NEC for r=0.05 class 0.0 = 0.001 +- 0.146 (in-sample avg dev_std = 0.051)
NEC for r=0.05 class 1.0 = 0.035 +- 0.146 (in-sample avg dev_std = 0.051)
NEC for r=0.05 all KL = 0.023 +- 0.146 (in-sample avg dev_std = 0.051)
NEC for r=0.05 all L1 = 0.019 +- 0.122 (in-sample avg dev_std = 0.051)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06705199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.963
NEC for r=0.1 class 0.0 = 0.001 +- 0.216 (in-sample avg dev_std = 0.172)
NEC for r=0.1 class 1.0 = 0.071 +- 0.216 (in-sample avg dev_std = 0.172)
NEC for r=0.1 all KL = 0.056 +- 0.216 (in-sample avg dev_std = 0.172)
NEC for r=0.1 all L1 = 0.04 +- 0.161 (in-sample avg dev_std = 0.172)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07347
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.946
NEC for r=0.2 class 0.0 = 0.002 +- 0.288 (in-sample avg dev_std = 0.305)
NEC for r=0.2 class 1.0 = 0.124 +- 0.288 (in-sample avg dev_std = 0.305)
NEC for r=0.2 all KL = 0.123 +- 0.288 (in-sample avg dev_std = 0.305)
NEC for r=0.2 all L1 = 0.069 +- 0.180 (in-sample avg dev_std = 0.305)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.079888
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.933
NEC for r=0.4 class 0.0 = 0.012 +- 0.327 (in-sample avg dev_std = 0.387)
NEC for r=0.4 class 1.0 = 0.158 +- 0.327 (in-sample avg dev_std = 0.387)
NEC for r=0.4 all KL = 0.181 +- 0.327 (in-sample avg dev_std = 0.387)
NEC for r=0.4 all L1 = 0.093 +- 0.187 (in-sample avg dev_std = 0.387)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08387799999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.921
NEC for r=0.8 class 0.0 = 0.016 +- 0.353 (in-sample avg dev_std = 0.454)
NEC for r=0.8 class 1.0 = 0.192 +- 0.353 (in-sample avg dev_std = 0.454)
NEC for r=0.8 all KL = 0.227 +- 0.353 (in-sample avg dev_std = 0.454)
NEC for r=0.8 all L1 = 0.113 +- 0.195 (in-sample avg dev_std = 0.454)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0093914
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.662
NEC for r=0.05 class 0.0 = 0.0 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.455 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.243 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.229 +- 0.341 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.575
NEC for r=0.1 class 0.0 = 0.001 +- 0.427 (in-sample avg dev_std = 0.136)
NEC for r=0.1 class 1.0 = 0.584 +- 0.427 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all KL = 0.319 +- 0.427 (in-sample avg dev_std = 0.136)
NEC for r=0.1 all L1 = 0.295 +- 0.378 (in-sample avg dev_std = 0.136)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009567
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.563
NEC for r=0.2 class 0.0 = 0.004 +- 0.439 (in-sample avg dev_std = 0.377)
NEC for r=0.2 class 1.0 = 0.643 +- 0.439 (in-sample avg dev_std = 0.377)
NEC for r=0.2 all KL = 0.376 +- 0.439 (in-sample avg dev_std = 0.377)
NEC for r=0.2 all L1 = 0.326 +- 0.372 (in-sample avg dev_std = 0.377)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602800000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.562
NEC for r=0.4 class 0.0 = 0.003 +- 0.441 (in-sample avg dev_std = 0.401)
NEC for r=0.4 class 1.0 = 0.652 +- 0.441 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all KL = 0.379 +- 0.441 (in-sample avg dev_std = 0.401)
NEC for r=0.4 all L1 = 0.33 +- 0.373 (in-sample avg dev_std = 0.401)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096094
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.563
NEC for r=0.8 class 0.0 = 0.003 +- 0.441 (in-sample avg dev_std = 0.409)
NEC for r=0.8 class 1.0 = 0.652 +- 0.441 (in-sample avg dev_std = 0.409)
NEC for r=0.8 all KL = 0.38 +- 0.441 (in-sample avg dev_std = 0.409)
NEC for r=0.8 all L1 = 0.33 +- 0.372 (in-sample avg dev_std = 0.409)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034668399999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.952
NEC for r=0.05 class 0.0 = 0.005 +- 0.189 (in-sample avg dev_std = 0.027)
NEC for r=0.05 class 1.0 = 0.067 +- 0.189 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all KL = 0.04 +- 0.189 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all L1 = 0.035 +- 0.164 (in-sample avg dev_std = 0.027)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042652800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.936
NEC for r=0.1 class 0.0 = 0.009 +- 0.241 (in-sample avg dev_std = 0.132)
NEC for r=0.1 class 1.0 = 0.102 +- 0.241 (in-sample avg dev_std = 0.132)
NEC for r=0.1 all KL = 0.067 +- 0.241 (in-sample avg dev_std = 0.132)
NEC for r=0.1 all L1 = 0.055 +- 0.199 (in-sample avg dev_std = 0.132)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0529322
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.912
NEC for r=0.2 class 0.0 = 0.014 +- 0.294 (in-sample avg dev_std = 0.206)
NEC for r=0.2 class 1.0 = 0.147 +- 0.294 (in-sample avg dev_std = 0.206)
NEC for r=0.2 all KL = 0.105 +- 0.294 (in-sample avg dev_std = 0.206)
NEC for r=0.2 all L1 = 0.079 +- 0.229 (in-sample avg dev_std = 0.206)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06489980000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.882
NEC for r=0.4 class 0.0 = 0.025 +- 0.346 (in-sample avg dev_std = 0.292)
NEC for r=0.4 class 1.0 = 0.208 +- 0.346 (in-sample avg dev_std = 0.292)
NEC for r=0.4 all KL = 0.169 +- 0.346 (in-sample avg dev_std = 0.292)
NEC for r=0.4 all L1 = 0.115 +- 0.256 (in-sample avg dev_std = 0.292)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.969
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0789312
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.854
NEC for r=0.8 class 0.0 = 0.038 +- 0.390 (in-sample avg dev_std = 0.429)
NEC for r=0.8 class 1.0 = 0.277 +- 0.390 (in-sample avg dev_std = 0.429)
NEC for r=0.8 all KL = 0.251 +- 0.390 (in-sample avg dev_std = 0.429)
NEC for r=0.8 all L1 = 0.156 +- 0.270 (in-sample avg dev_std = 0.429)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.83, 0.86, 0.857, 0.871, 0.958], 'all_L1': [0.901, 0.915, 0.911, 0.92, 0.973]}), defaultdict(<class 'list'>, {'all_KL': [0.811, 0.816, 0.838, 0.847, 0.975], 'all_L1': [0.901, 0.905, 0.916, 0.918, 0.983]}), defaultdict(<class 'list'>, {'all_KL': [0.791, 0.8, 0.801, 0.848, 0.945], 'all_L1': [0.879, 0.883, 0.883, 0.908, 0.963]}), defaultdict(<class 'list'>, {'all_KL': [0.795, 0.794, 0.794, 0.817, 0.927], 'all_L1': [0.873, 0.872, 0.87, 0.88, 0.945]}), defaultdict(<class 'list'>, {'all_KL': [0.844, 0.843, 0.844, 0.857, 0.949], 'all_L1': [0.91, 0.911, 0.91, 0.916, 0.965]}), defaultdict(<class 'list'>, {'all_KL': [0.828, 0.819, 0.81, 0.868, 0.973], 'all_L1': [0.905, 0.898, 0.892, 0.919, 0.981]}), defaultdict(<class 'list'>, {'all_KL': [0.646, 0.67, 0.674, 0.715, 0.876], 'all_L1': [0.78, 0.79, 0.792, 0.81, 0.906]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.734, 0.76, 0.796, 0.913], 'all_L1': [0.843, 0.834, 0.852, 0.865, 0.936]}), defaultdict(<class 'list'>, {'all_KL': [0.766, 0.779, 0.777, 0.825, 0.932], 'all_L1': [0.86, 0.863, 0.858, 0.887, 0.95]}), defaultdict(<class 'list'>, {'all_KL': [0.505, 0.489, 0.512, 0.545, 0.771], 'all_L1': [0.699, 0.688, 0.707, 0.719, 0.838]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.002, 0.007, 0.022, 0.031, 0.043], 'all_L1': [0.001, 0.004, 0.013, 0.019, 0.022]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.026, 0.044, 0.066, 0.093], 'all_L1': [0.009, 0.017, 0.026, 0.036, 0.044]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.029, 0.043, 0.085, 0.103], 'all_L1': [0.008, 0.021, 0.028, 0.05, 0.054]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.014, 0.028, 0.046, 0.064], 'all_L1': [0.004, 0.01, 0.021, 0.033, 0.039]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.004, 0.024, 0.043, 0.055], 'all_L1': [0.002, 0.003, 0.014, 0.023, 0.026]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.009, 0.012, 0.043, 0.061], 'all_L1': [0.002, 0.007, 0.006, 0.023, 0.031]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.045, 0.086, 0.126, 0.165], 'all_L1': [0.02, 0.033, 0.058, 0.078, 0.096]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.018, 0.036, 0.066, 0.084], 'all_L1': [0.002, 0.013, 0.024, 0.042, 0.049]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.03, 0.041, 0.066, 0.103], 'all_L1': [0.01, 0.024, 0.028, 0.042, 0.059]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.056, 0.123, 0.181, 0.227], 'all_L1': [0.019, 0.04, 0.069, 0.093, 0.113]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.747, 0.747, 0.747, 0.747, 0.756], 'all_L1': [0.789, 0.789, 0.789, 0.788, 0.796]}), defaultdict(<class 'list'>, {'all_KL': [0.696, 0.691, 0.691, 0.698, 0.851], 'all_L1': [0.836, 0.834, 0.832, 0.833, 0.89]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.766, 0.766, 0.766, 0.81], 'all_L1': [0.821, 0.821, 0.822, 0.822, 0.847]}), defaultdict(<class 'list'>, {'all_KL': [0.619, 0.621, 0.615, 0.62, 0.73], 'all_L1': [0.717, 0.718, 0.714, 0.717, 0.763]}), defaultdict(<class 'list'>, {'all_KL': [0.761, 0.761, 0.762, 0.76, 0.859], 'all_L1': [0.849, 0.85, 0.85, 0.848, 0.896]}), defaultdict(<class 'list'>, {'all_KL': [0.644, 0.638, 0.635, 0.645, 0.824], 'all_L1': [0.797, 0.793, 0.79, 0.796, 0.862]}), defaultdict(<class 'list'>, {'all_KL': [0.593, 0.594, 0.597, 0.6, 0.789], 'all_L1': [0.743, 0.744, 0.746, 0.746, 0.831]}), defaultdict(<class 'list'>, {'all_KL': [0.68, 0.68, 0.681, 0.686, 0.752], 'all_L1': [0.753, 0.754, 0.754, 0.757, 0.783]}), defaultdict(<class 'list'>, {'all_KL': [0.769, 0.766, 0.766, 0.774, 0.877], 'all_L1': [0.86, 0.858, 0.858, 0.861, 0.907]}), defaultdict(<class 'list'>, {'all_KL': [0.608, 0.611, 0.609, 0.611, 0.639], 'all_L1': [0.651, 0.652, 0.651, 0.652, 0.668]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.008, 0.08, 0.156, 0.178, 0.181], 'all_L1': [0.006, 0.059, 0.09, 0.096, 0.096]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.033, 0.092, 0.101, 0.107], 'all_L1': [0.007, 0.024, 0.043, 0.041, 0.043]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.077, 0.146, 0.163, 0.163], 'all_L1': [0.02, 0.06, 0.089, 0.094, 0.092]}), defaultdict(<class 'list'>, {'all_KL': [0.076, 0.211, 0.288, 0.301, 0.302], 'all_L1': [0.075, 0.193, 0.234, 0.238, 0.239]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.04, 0.094, 0.11, 0.113], 'all_L1': [0.008, 0.03, 0.047, 0.05, 0.051]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.023, 0.074, 0.078, 0.084], 'all_L1': [0.005, 0.018, 0.04, 0.039, 0.042]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.053, 0.111, 0.129, 0.143], 'all_L1': [0.007, 0.042, 0.067, 0.072, 0.076]}), defaultdict(<class 'list'>, {'all_KL': [0.105, 0.202, 0.261, 0.271, 0.274], 'all_L1': [0.095, 0.178, 0.21, 0.214, 0.216]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.031, 0.072, 0.086, 0.091], 'all_L1': [0.008, 0.025, 0.042, 0.045, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.243, 0.319, 0.376, 0.379, 0.38], 'all_L1': [0.229, 0.295, 0.326, 0.33, 0.33]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.884, 0.897, 0.902, 0.894, 0.855], 'all_L1': [0.919, 0.925, 0.927, 0.927, 0.875]}), defaultdict(<class 'list'>, {'all_KL': [0.855, 0.87, 0.888, 0.905, 0.944], 'all_L1': [0.905, 0.912, 0.921, 0.93, 0.952]}), defaultdict(<class 'list'>, {'all_KL': [0.864, 0.874, 0.884, 0.906, 0.964], 'all_L1': [0.907, 0.91, 0.914, 0.926, 0.969]}), defaultdict(<class 'list'>, {'all_KL': [0.858, 0.867, 0.881, 0.885, 0.897], 'all_L1': [0.898, 0.901, 0.909, 0.909, 0.909]}), defaultdict(<class 'list'>, {'all_KL': [0.857, 0.873, 0.883, 0.891, 0.882], 'all_L1': [0.907, 0.913, 0.918, 0.924, 0.898]}), defaultdict(<class 'list'>, {'all_KL': [0.859, 0.875, 0.884, 0.901, 0.917], 'all_L1': [0.904, 0.911, 0.913, 0.923, 0.928]}), defaultdict(<class 'list'>, {'all_KL': [0.794, 0.813, 0.831, 0.857, 0.903], 'all_L1': [0.857, 0.865, 0.873, 0.889, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.849, 0.861, 0.874, 0.889, 0.961], 'all_L1': [0.894, 0.898, 0.903, 0.912, 0.966]}), defaultdict(<class 'list'>, {'all_KL': [0.697, 0.719, 0.737, 0.752, 0.815], 'all_L1': [0.79, 0.804, 0.816, 0.826, 0.838]}), defaultdict(<class 'list'>, {'all_KL': [0.637, 0.651, 0.661, 0.683, 0.817], 'all_L1': [0.771, 0.778, 0.782, 0.788, 0.845]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.006, 0.01, 0.019, 0.046, 0.063], 'all_L1': [0.005, 0.009, 0.016, 0.037, 0.047]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.014, 0.025, 0.053, 0.092], 'all_L1': [0.01, 0.012, 0.021, 0.041, 0.06]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.018, 0.026, 0.055, 0.091], 'all_L1': [0.011, 0.015, 0.022, 0.044, 0.062]}), defaultdict(<class 'list'>, {'all_KL': [0.017, 0.024, 0.038, 0.062, 0.095], 'all_L1': [0.016, 0.022, 0.033, 0.052, 0.07]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.014, 0.023, 0.05, 0.083], 'all_L1': [0.007, 0.011, 0.017, 0.038, 0.057]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.015, 0.025, 0.053, 0.091], 'all_L1': [0.009, 0.013, 0.022, 0.043, 0.064]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.034, 0.055, 0.09, 0.148], 'all_L1': [0.02, 0.029, 0.046, 0.071, 0.103]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.016, 0.028, 0.06, 0.094], 'all_L1': [0.01, 0.014, 0.025, 0.048, 0.066]}), defaultdict(<class 'list'>, {'all_KL': [0.018, 0.032, 0.053, 0.097, 0.18], 'all_L1': [0.016, 0.026, 0.041, 0.071, 0.126]}), defaultdict(<class 'list'>, {'all_KL': [0.04, 0.067, 0.105, 0.169, 0.251], 'all_L1': [0.035, 0.055, 0.079, 0.115, 0.156]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.855 +- 0.064, 0.856 +- 0.067, 0.859 +- 0.062, 0.874 +- 0.061, 0.944 +- 0.042
suff_simple class all_KL  =  0.756 +- 0.100, 0.760 +- 0.104, 0.767 +- 0.098, 0.799 +- 0.095, 0.922 +- 0.058
[[0.9207500219345093, 0.9277499914169312, 0.9232500195503235, 0.9315000176429749, 0.9785000085830688], [0.9265000224113464, 0.9277499914169312, 0.9375, 0.9337499737739563, 0.984000027179718], [0.909500002861023, 0.909250020980835, 0.9085000157356262, 0.9244999885559082, 0.9660000205039978], [0.9097499847412109, 0.9077500104904175, 0.9045000076293945, 0.9057499766349792, 0.9480000138282776], [0.9294999837875366, 0.9292500019073486, 0.9272500276565552, 0.9312499761581421, 0.9677500128746033], [0.9304999709129333, 0.9229999780654907, 0.9162499904632568, 0.9315000176429749, 0.9819999933242798], [0.8199999928474426, 0.8237500190734863, 0.8245000243186951, 0.8299999833106995, 0.9045000076293945], [0.8832499980926514, 0.8734999895095825, 0.8877500295639038, 0.8892499804496765, 0.9412500262260437], [0.8987500071525574, 0.8960000276565552, 0.8862500190734863, 0.9082499742507935, 0.9552500247955322], [0.7572500109672546, 0.7437499761581421, 0.7617499828338623, 0.7647500038146973, 0.8432499766349792]]
[[0.83, 0.86, 0.857, 0.871, 0.958], [0.811, 0.816, 0.838, 0.847, 0.975], [0.791, 0.8, 0.801, 0.848, 0.945], [0.795, 0.794, 0.794, 0.817, 0.927], [0.844, 0.843, 0.844, 0.857, 0.949], [0.828, 0.819, 0.81, 0.868, 0.973], [0.646, 0.67, 0.674, 0.715, 0.876], [0.745, 0.734, 0.76, 0.796, 0.913], [0.766, 0.779, 0.777, 0.825, 0.932], [0.505, 0.489, 0.512, 0.545, 0.771]]
suff_simple_acc_int  =  0.889 +- 0.054, 0.886 +- 0.057, 0.888 +- 0.052, 0.895 +- 0.053, 0.947 +- 0.041
nec class all_L1  =  0.008 +- 0.007, 0.017 +- 0.012, 0.029 +- 0.019, 0.044 +- 0.023, 0.053 +- 0.028
nec class all_KL  =  0.009 +- 0.008, 0.024 +- 0.016, 0.046 +- 0.032, 0.075 +- 0.044, 0.100 +- 0.054
[[0.9987499713897705, 0.9962499737739563, 0.9907500147819519, 0.9829999804496765, 0.984250009059906], [0.9907500147819519, 0.984749972820282, 0.9787499904632568, 0.9714999794960022, 0.9707499742507935], [0.9909999966621399, 0.9789999723434448, 0.9762499928474426, 0.9597499966621399, 0.9645000100135803], [0.9959999918937683, 0.9912499785423279, 0.981249988079071, 0.9710000157356262, 0.9742500185966492], [0.9980000257492065, 0.9977499842643738, 0.987500011920929, 0.9827499985694885, 0.9822499752044678], [0.9980000257492065, 0.9932500123977661, 0.9952499866485596, 0.9837499856948853, 0.9787499904632568], [0.9785000085830688, 0.9670000076293945, 0.9447500109672546, 0.934249997138977, 0.9272500276565552], [0.9980000257492065, 0.9877499938011169, 0.9832500219345093, 0.9682499766349792, 0.9670000076293945], [0.9879999756813049, 0.9757500290870667, 0.9739999771118164, 0.9662500023841858, 0.9595000147819519], [0.9794999957084656, 0.9632499814033508, 0.9459999799728394, 0.9330000281333923, 0.9207500219345093]]
[[0.002, 0.007, 0.022, 0.031, 0.043], [0.011, 0.026, 0.044, 0.066, 0.093], [0.01, 0.029, 0.043, 0.085, 0.103], [0.004, 0.014, 0.028, 0.046, 0.064], [0.002, 0.004, 0.024, 0.043, 0.055], [0.002, 0.009, 0.012, 0.043, 0.061], [0.024, 0.045, 0.086, 0.126, 0.165], [0.002, 0.018, 0.036, 0.066, 0.084], [0.012, 0.03, 0.041, 0.066, 0.103], [0.023, 0.056, 0.123, 0.181, 0.227]]
nec_acc_int  =  0.992 +- 0.007, 0.984 +- 0.011, 0.976 +- 0.016, 0.965 +- 0.018, 0.963 +- 0.021

Eval split val
suff_simple class all_L1  =  0.782 +- 0.062, 0.781 +- 0.062, 0.781 +- 0.062, 0.782 +- 0.062, 0.824 +- 0.070
suff_simple class all_KL  =  0.688 +- 0.066, 0.688 +- 0.065, 0.687 +- 0.066, 0.691 +- 0.065, 0.789 +- 0.068
[[0.7591249942779541, 0.759850025177002, 0.7603750228881836, 0.7584750056266785, 0.7658500075340271], [0.8785499930381775, 0.8778499960899353, 0.8752999901771545, 0.8749499917030334, 0.8880000114440918], [0.7538999915122986, 0.7531750202178955, 0.7548750042915344, 0.7551249861717224, 0.7674750089645386], [0.6616500020027161, 0.6630749702453613, 0.6592000126838684, 0.6596249938011169, 0.6490749716758728], [0.8177000284194946, 0.8188250064849854, 0.8186749815940857, 0.8153250217437744, 0.8395000100135803], [0.8266500234603882, 0.8234249949455261, 0.8215749859809875, 0.8244500160217285, 0.8305500149726868], [0.7975000143051147, 0.7988749742507935, 0.7989500164985657, 0.797124981880188, 0.8193749785423279], [0.5954999923706055, 0.5971249938011169, 0.5961499810218811, 0.598924994468689, 0.5873500108718872], [0.7642999887466431, 0.7614499926567078, 0.7630749940872192, 0.7642999887466431, 0.7792750000953674], [0.5239999890327454, 0.5246750116348267, 0.524275004863739, 0.5236750245094299, 0.527999997138977]]
[[0.747, 0.747, 0.747, 0.747, 0.756], [0.696, 0.691, 0.691, 0.698, 0.851], [0.765, 0.766, 0.766, 0.766, 0.81], [0.619, 0.621, 0.615, 0.62, 0.73], [0.761, 0.761, 0.762, 0.76, 0.859], [0.644, 0.638, 0.635, 0.645, 0.824], [0.593, 0.594, 0.597, 0.6, 0.789], [0.68, 0.68, 0.681, 0.686, 0.752], [0.769, 0.766, 0.766, 0.774, 0.877], [0.608, 0.611, 0.609, 0.611, 0.639]]
suff_simple_acc_int  =  0.738 +- 0.105, 0.738 +- 0.105, 0.737 +- 0.105, 0.737 +- 0.104, 0.745 +- 0.112
nec class all_L1  =  0.046 +- 0.068, 0.092 +- 0.090, 0.119 +- 0.096, 0.122 +- 0.097, 0.123 +- 0.096
nec class all_KL  =  0.050 +- 0.072, 0.107 +- 0.096, 0.167 +- 0.100, 0.180 +- 0.098, 0.184 +- 0.096
[[0.9941999912261963, 0.9446750283241272, 0.9311749935150146, 0.9301999807357788, 0.9319249987602234], [0.9923999905586243, 0.9753749966621399, 0.9711250066757202, 0.9746749997138977, 0.9738249778747559], [0.907800018787384, 0.8674749732017517, 0.8610000014305115, 0.8607749938964844, 0.8634999990463257], [0.8131999969482422, 0.6986250281333923, 0.687250018119812, 0.6904749870300293, 0.6914250254631042], [0.9368000030517578, 0.9168000221252441, 0.9130250215530396, 0.9129999876022339, 0.9133250117301941], [0.9642000198364258, 0.9522250294685364, 0.9416750073432922, 0.9440249800682068, 0.9426500201225281], [0.991599977016449, 0.9555000066757202, 0.9480500221252441, 0.9492250084877014, 0.948324978351593], [0.7161999940872192, 0.6264749765396118, 0.6164000034332275, 0.6177999973297119, 0.6178500056266785], [0.855400025844574, 0.8417500257492065, 0.836899995803833, 0.8373249769210815, 0.8371999859809875], [0.6615999937057495, 0.5747249722480774, 0.5634499788284302, 0.5621500015258789, 0.5631499886512756]]
[[0.008, 0.08, 0.156, 0.178, 0.181], [0.008, 0.033, 0.092, 0.101, 0.107], [0.025, 0.077, 0.146, 0.163, 0.163], [0.076, 0.211, 0.288, 0.301, 0.302], [0.01, 0.04, 0.094, 0.11, 0.113], [0.005, 0.023, 0.074, 0.078, 0.084], [0.008, 0.053, 0.111, 0.129, 0.143], [0.105, 0.202, 0.261, 0.271, 0.274], [0.01, 0.031, 0.072, 0.086, 0.091], [0.243, 0.319, 0.376, 0.379, 0.38]]
nec_acc_int  =  0.883 +- 0.113, 0.835 +- 0.141, 0.827 +- 0.142, 0.828 +- 0.142, 0.828 +- 0.142

Eval split test
suff_simple class all_L1  =  0.875 +- 0.050, 0.882 +- 0.048, 0.888 +- 0.047, 0.895 +- 0.046, 0.910 +- 0.044
suff_simple class all_KL  =  0.815 +- 0.078, 0.830 +- 0.077, 0.843 +- 0.076, 0.856 +- 0.072, 0.895 +- 0.051
[[0.9088202714920044, 0.9120472073554993, 0.9116719961166382, 0.9126225709915161, 0.845564603805542], [0.9073694348335266, 0.9089953899383545, 0.9170502424240112, 0.9250800609588623, 0.939607560634613], [0.9098458886146545, 0.9085951447486877, 0.90799480676651, 0.9165499210357666, 0.959269642829895], [0.9081198573112488, 0.9051430821418762, 0.9060686230659485, 0.9050180315971375, 0.8916282057762146], [0.9062687754631042, 0.9064688682556152, 0.9080448150634766, 0.9132229089736938, 0.872668445110321], [0.9128727316856384, 0.9146487712860107, 0.9122223258018494, 0.9213528037071228, 0.914817214012146], [0.86581951379776, 0.8704472780227661, 0.8783270120620728, 0.8843305706977844, 0.9012946486473083], [0.9020912647247314, 0.900615394115448, 0.8983640074729919, 0.904392659664154, 0.9557769894599915], [0.8195667266845703, 0.8291224837303162, 0.8367770910263062, 0.8409295678138733, 0.8084697723388672], [0.7835701704025269, 0.7884730696678162, 0.7868471145629883, 0.7967530488967896, 0.8184673190116882]]
[[0.884, 0.897, 0.902, 0.894, 0.855], [0.855, 0.87, 0.888, 0.905, 0.944], [0.864, 0.874, 0.884, 0.906, 0.964], [0.858, 0.867, 0.881, 0.885, 0.897], [0.857, 0.873, 0.883, 0.891, 0.882], [0.859, 0.875, 0.884, 0.901, 0.917], [0.794, 0.813, 0.831, 0.857, 0.903], [0.849, 0.861, 0.874, 0.889, 0.961], [0.697, 0.719, 0.737, 0.752, 0.815], [0.637, 0.651, 0.661, 0.683, 0.817]]
suff_simple_acc_int  =  0.882 +- 0.043, 0.884 +- 0.041, 0.886 +- 0.040, 0.892 +- 0.039, 0.891 +- 0.051
nec class all_L1  =  0.014 +- 0.008, 0.021 +- 0.013, 0.032 +- 0.018, 0.056 +- 0.023, 0.081 +- 0.034
nec class all_KL  =  0.016 +- 0.009, 0.024 +- 0.016, 0.040 +- 0.025, 0.074 +- 0.036, 0.119 +- 0.055
[[0.9805883765220642, 0.9774364829063416, 0.9696817994117737, 0.9456424117088318, 0.9382379651069641], [0.9832149147987366, 0.9812637567520142, 0.971532940864563, 0.9506203532218933, 0.9392385482788086], [0.9789623618125916, 0.9763107895851135, 0.968606173992157, 0.9481939077377319, 0.9398139119148254], [0.9724584817886353, 0.9704822897911072, 0.9632028937339783, 0.9461176991462708, 0.938538134098053], [0.9817390441894531, 0.9778116941452026, 0.9720332026481628, 0.9495697617530823, 0.9363368153572083], [0.9797878861427307, 0.9788873195648193, 0.9718581438064575, 0.9517460465431213, 0.9393386244773865], [0.9658545255661011, 0.9594506621360779, 0.9454922676086426, 0.9244296550750732, 0.9078696966171265], [0.9804132580757141, 0.9769611954689026, 0.9649789929389954, 0.9427156448364258, 0.9367120265960693], [0.9749349355697632, 0.9659045338630676, 0.9527716636657715, 0.9278317093849182, 0.8894336819648743], [0.9518961310386658, 0.9362117052078247, 0.9122223258018494, 0.8821542859077454, 0.8544877171516418]]
[[0.006, 0.01, 0.019, 0.046, 0.063], [0.011, 0.014, 0.025, 0.053, 0.092], [0.012, 0.018, 0.026, 0.055, 0.091], [0.017, 0.024, 0.038, 0.062, 0.095], [0.008, 0.014, 0.023, 0.05, 0.083], [0.01, 0.015, 0.025, 0.053, 0.091], [0.023, 0.034, 0.055, 0.09, 0.148], [0.011, 0.016, 0.028, 0.06, 0.094], [0.018, 0.032, 0.053, 0.097, 0.18], [0.04, 0.067, 0.105, 0.169, 0.251]]
nec_acc_int  =  0.975 +- 0.009, 0.970 +- 0.013, 0.959 +- 0.018, 0.937 +- 0.020, 0.922 +- 0.028


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.431 +- 0.029, 0.437 +- 0.029, 0.444 +- 0.023, 0.459 +- 0.020, 0.499 +- 0.010
Faith. Armon (L1)= 		  =  0.015 +- 0.013, 0.033 +- 0.022, 0.055 +- 0.034, 0.082 +- 0.040, 0.099 +- 0.049
Faith. GMean (L1)= 	  =  0.072 +- 0.032, 0.112 +- 0.038, 0.147 +- 0.043, 0.188 +- 0.041, 0.216 +- 0.051
Faith. Aritm (KL)= 		  =  0.383 +- 0.047, 0.392 +- 0.045, 0.406 +- 0.035, 0.437 +- 0.028, 0.511 +- 0.013
Faith. Armon (KL)= 		  =  0.018 +- 0.016, 0.045 +- 0.029, 0.083 +- 0.051, 0.132 +- 0.063, 0.174 +- 0.079
Faith. GMean (KL)= 	  =  0.073 +- 0.031, 0.123 +- 0.038, 0.174 +- 0.044, 0.233 +- 0.047, 0.292 +- 0.064

Eval split val
Faith. Aritm (L1)= 		  =  0.414 +- 0.019, 0.437 +- 0.024, 0.450 +- 0.025, 0.452 +- 0.026, 0.474 +- 0.019
Faith. Armon (L1)= 		  =  0.076 +- 0.103, 0.149 +- 0.126, 0.189 +- 0.126, 0.193 +- 0.127, 0.197 +- 0.127
Faith. GMean (L1)= 	  =  0.146 +- 0.105, 0.236 +- 0.108, 0.278 +- 0.100, 0.283 +- 0.101, 0.292 +- 0.100
Faith. Aritm (KL)= 		  =  0.369 +- 0.036, 0.397 +- 0.043, 0.427 +- 0.045, 0.435 +- 0.044, 0.486 +- 0.020
Faith. Armon (KL)= 		  =  0.081 +- 0.105, 0.167 +- 0.126, 0.252 +- 0.114, 0.269 +- 0.110, 0.282 +- 0.110
Faith. GMean (KL)= 	  =  0.146 +- 0.104, 0.244 +- 0.105, 0.323 +- 0.087, 0.338 +- 0.083, 0.364 +- 0.078

Eval split test
Faith. Aritm (L1)= 		  =  0.445 +- 0.022, 0.451 +- 0.018, 0.460 +- 0.016, 0.476 +- 0.013, 0.495 +- 0.017
Faith. Armon (L1)= 		  =  0.027 +- 0.016, 0.040 +- 0.024, 0.061 +- 0.033, 0.104 +- 0.038, 0.147 +- 0.054
Faith. GMean (L1)= 	  =  0.105 +- 0.026, 0.128 +- 0.033, 0.162 +- 0.037, 0.219 +- 0.034, 0.266 +- 0.047
Faith. Aritm (KL)= 		  =  0.415 +- 0.035, 0.427 +- 0.031, 0.441 +- 0.027, 0.465 +- 0.020, 0.507 +- 0.023
Faith. Armon (KL)= 		  =  0.030 +- 0.018, 0.047 +- 0.029, 0.074 +- 0.042, 0.132 +- 0.054, 0.204 +- 0.077
Faith. GMean (KL)= 	  =  0.107 +- 0.024, 0.134 +- 0.032, 0.174 +- 0.039, 0.243 +- 0.040, 0.318 +- 0.061
Computed for split load_split = id



Completed in  2:38:44.764351  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN simple_concept2temperature TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 13:52:09 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 01:52:10 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.047
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.058
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.067
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.040
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.064
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046784000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.607
SUFF_SIMPLE for r=0.05 class 0.0 = 0.765 +- 0.382 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.374 +- 0.382 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.05 all KL = 0.473 +- 0.382 (in-sample avg dev_std = 0.540)
SUFF_SIMPLE for r=0.05 all L1 = 0.549 +- 0.305 (in-sample avg dev_std = 0.540)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05810800000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.598
SUFF_SIMPLE for r=0.1 class 0.0 = 0.766 +- 0.384 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.356 +- 0.384 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.1 all KL = 0.463 +- 0.384 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.1 all L1 = 0.539 +- 0.306 (in-sample avg dev_std = 0.533)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.067458
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.599
SUFF_SIMPLE for r=0.2 class 0.0 = 0.765 +- 0.390 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.376 +- 0.390 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 all KL = 0.481 +- 0.390 (in-sample avg dev_std = 0.510)
SUFF_SIMPLE for r=0.2 all L1 = 0.549 +- 0.313 (in-sample avg dev_std = 0.510)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076612
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.604
SUFF_SIMPLE for r=0.4 class 0.0 = 0.786 +- 0.405 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.375 +- 0.405 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.4 all KL = 0.5 +- 0.405 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.4 all L1 = 0.558 +- 0.327 (in-sample avg dev_std = 0.468)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08117
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.671
SUFF_SIMPLE for r=0.8 class 0.0 = 0.857 +- 0.405 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.468 +- 0.405 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.8 all KL = 0.622 +- 0.405 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.8 all L1 = 0.642 +- 0.342 (in-sample avg dev_std = 0.272)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.176 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.841 +- 0.176 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.05 all KL = 0.936 +- 0.176 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.05 all L1 = 0.919 +- 0.196 (in-sample avg dev_std = 0.036)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009281000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.1 all KL = 0.936 +- 0.177 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.1 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.030)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009344400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.2 all KL = 0.935 +- 0.177 (in-sample avg dev_std = 0.036)
SUFF_SIMPLE for r=0.2 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.036)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095086
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.177 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.841 +- 0.177 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.4 all KL = 0.936 +- 0.177 (in-sample avg dev_std = 0.031)
SUFF_SIMPLE for r=0.4 all L1 = 0.919 +- 0.197 (in-sample avg dev_std = 0.031)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0095604
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.176 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.842 +- 0.176 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.8 all KL = 0.936 +- 0.176 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.8 all L1 = 0.919 +- 0.196 (in-sample avg dev_std = 0.006)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032958
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.672
SUFF_SIMPLE for r=0.05 class 0.0 = 0.714 +- 0.365 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.65 +- 0.365 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all KL = 0.625 +- 0.365 (in-sample avg dev_std = 0.442)
SUFF_SIMPLE for r=0.05 all L1 = 0.682 +- 0.286 (in-sample avg dev_std = 0.442)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0404916
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.668
SUFF_SIMPLE for r=0.1 class 0.0 = 0.699 +- 0.369 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.665 +- 0.369 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.1 all KL = 0.633 +- 0.369 (in-sample avg dev_std = 0.407)
SUFF_SIMPLE for r=0.1 all L1 = 0.682 +- 0.297 (in-sample avg dev_std = 0.407)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050537
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.664
SUFF_SIMPLE for r=0.2 class 0.0 = 0.701 +- 0.375 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.673 +- 0.375 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.2 all KL = 0.649 +- 0.375 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.2 all L1 = 0.687 +- 0.308 (in-sample avg dev_std = 0.372)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06428500000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.665
SUFF_SIMPLE for r=0.4 class 0.0 = 0.726 +- 0.377 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.675 +- 0.377 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.4 all KL = 0.675 +- 0.377 (in-sample avg dev_std = 0.327)
SUFF_SIMPLE for r=0.4 all L1 = 0.701 +- 0.316 (in-sample avg dev_std = 0.327)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.764
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0798366
len(reference) = 4977
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.719
SUFF_SIMPLE for r=0.8 class 0.0 = 0.836 +- 0.317 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.772 +- 0.317 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.8 all KL = 0.81 +- 0.317 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.8 all L1 = 0.804 +- 0.279 (in-sample avg dev_std = 0.170)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046784000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.894
NEC for r=0.05 class 0.0 = 0.097 +- 0.242 (in-sample avg dev_std = 0.069)
NEC for r=0.05 class 1.0 = 0.195 +- 0.242 (in-sample avg dev_std = 0.069)
NEC for r=0.05 all KL = 0.121 +- 0.242 (in-sample avg dev_std = 0.069)
NEC for r=0.05 all L1 = 0.151 +- 0.230 (in-sample avg dev_std = 0.069)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05810800000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.828
NEC for r=0.1 class 0.0 = 0.116 +- 0.313 (in-sample avg dev_std = 0.217)
NEC for r=0.1 class 1.0 = 0.304 +- 0.313 (in-sample avg dev_std = 0.217)
NEC for r=0.1 all KL = 0.207 +- 0.313 (in-sample avg dev_std = 0.217)
NEC for r=0.1 all L1 = 0.22 +- 0.275 (in-sample avg dev_std = 0.217)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.067458
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.803
NEC for r=0.2 class 0.0 = 0.139 +- 0.319 (in-sample avg dev_std = 0.344)
NEC for r=0.2 class 1.0 = 0.354 +- 0.319 (in-sample avg dev_std = 0.344)
NEC for r=0.2 all KL = 0.265 +- 0.319 (in-sample avg dev_std = 0.344)
NEC for r=0.2 all L1 = 0.258 +- 0.271 (in-sample avg dev_std = 0.344)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076612
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.773
NEC for r=0.4 class 0.0 = 0.166 +- 0.332 (in-sample avg dev_std = 0.438)
NEC for r=0.4 class 1.0 = 0.41 +- 0.332 (in-sample avg dev_std = 0.438)
NEC for r=0.4 all KL = 0.335 +- 0.332 (in-sample avg dev_std = 0.438)
NEC for r=0.4 all L1 = 0.301 +- 0.268 (in-sample avg dev_std = 0.438)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08117
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.777
NEC for r=0.8 class 0.0 = 0.167 +- 0.328 (in-sample avg dev_std = 0.477)
NEC for r=0.8 class 1.0 = 0.412 +- 0.328 (in-sample avg dev_std = 0.477)
NEC for r=0.8 all KL = 0.342 +- 0.328 (in-sample avg dev_std = 0.477)
NEC for r=0.8 all L1 = 0.302 +- 0.257 (in-sample avg dev_std = 0.477)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.513
NEC for r=0.05 class 0.0 = 0.002 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.037 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.063 +- 0.155 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009281000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.002 +- 0.160 (in-sample avg dev_std = 0.016)
NEC for r=0.1 class 1.0 = 0.149 +- 0.160 (in-sample avg dev_std = 0.016)
NEC for r=0.1 all KL = 0.057 +- 0.160 (in-sample avg dev_std = 0.016)
NEC for r=0.1 all L1 = 0.076 +- 0.186 (in-sample avg dev_std = 0.016)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009344400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.499
NEC for r=0.2 class 0.0 = 0.002 +- 0.166 (in-sample avg dev_std = 0.069)
NEC for r=0.2 class 1.0 = 0.155 +- 0.166 (in-sample avg dev_std = 0.069)
NEC for r=0.2 all KL = 0.061 +- 0.166 (in-sample avg dev_std = 0.069)
NEC for r=0.2 all L1 = 0.079 +- 0.190 (in-sample avg dev_std = 0.069)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095086
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.499
NEC for r=0.4 class 0.0 = 0.002 +- 0.166 (in-sample avg dev_std = 0.075)
NEC for r=0.4 class 1.0 = 0.155 +- 0.166 (in-sample avg dev_std = 0.075)
NEC for r=0.4 all KL = 0.061 +- 0.166 (in-sample avg dev_std = 0.075)
NEC for r=0.4 all L1 = 0.079 +- 0.190 (in-sample avg dev_std = 0.075)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0095604
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.002 +- 0.166 (in-sample avg dev_std = 0.079)
NEC for r=0.8 class 1.0 = 0.154 +- 0.166 (in-sample avg dev_std = 0.079)
NEC for r=0.8 all KL = 0.061 +- 0.166 (in-sample avg dev_std = 0.079)
NEC for r=0.8 all L1 = 0.079 +- 0.190 (in-sample avg dev_std = 0.079)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032958
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.742
NEC for r=0.05 class 0.0 = 0.083 +- 0.210 (in-sample avg dev_std = 0.040)
NEC for r=0.05 class 1.0 = 0.097 +- 0.210 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all KL = 0.076 +- 0.210 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all L1 = 0.09 +- 0.198 (in-sample avg dev_std = 0.040)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0404916
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.736
NEC for r=0.1 class 0.0 = 0.115 +- 0.255 (in-sample avg dev_std = 0.110)
NEC for r=0.1 class 1.0 = 0.137 +- 0.255 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all KL = 0.115 +- 0.255 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all L1 = 0.126 +- 0.232 (in-sample avg dev_std = 0.110)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050537
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.725
NEC for r=0.2 class 0.0 = 0.152 +- 0.301 (in-sample avg dev_std = 0.183)
NEC for r=0.2 class 1.0 = 0.184 +- 0.301 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all KL = 0.168 +- 0.301 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all L1 = 0.167 +- 0.262 (in-sample avg dev_std = 0.183)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06428500000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.698
NEC for r=0.4 class 0.0 = 0.189 +- 0.334 (in-sample avg dev_std = 0.268)
NEC for r=0.4 class 1.0 = 0.232 +- 0.334 (in-sample avg dev_std = 0.268)
NEC for r=0.4 all KL = 0.224 +- 0.334 (in-sample avg dev_std = 0.268)
NEC for r=0.4 all L1 = 0.21 +- 0.284 (in-sample avg dev_std = 0.268)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0798366
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.697
NEC for r=0.8 class 0.0 = 0.233 +- 0.355 (in-sample avg dev_std = 0.383)
NEC for r=0.8 class 1.0 = 0.264 +- 0.355 (in-sample avg dev_std = 0.383)
NEC for r=0.8 all KL = 0.291 +- 0.355 (in-sample avg dev_std = 0.383)
NEC for r=0.8 all L1 = 0.249 +- 0.283 (in-sample avg dev_std = 0.383)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 14:08:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:08:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.055
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.064
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.079
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.083
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.067
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.054596
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.54
SUFF_SIMPLE for r=0.05 class 0.0 = 0.769 +- 0.407 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.269 +- 0.407 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all KL = 0.371 +- 0.407 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all L1 = 0.492 +- 0.317 (in-sample avg dev_std = 0.567)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06373
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.545
SUFF_SIMPLE for r=0.1 class 0.0 = 0.776 +- 0.415 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.275 +- 0.415 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.1 all KL = 0.383 +- 0.415 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.1 all L1 = 0.499 +- 0.322 (in-sample avg dev_std = 0.549)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071076
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.544
SUFF_SIMPLE for r=0.2 class 0.0 = 0.775 +- 0.420 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.282 +- 0.420 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.2 all KL = 0.39 +- 0.420 (in-sample avg dev_std = 0.535)
SUFF_SIMPLE for r=0.2 all L1 = 0.502 +- 0.330 (in-sample avg dev_std = 0.535)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07916399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.543
SUFF_SIMPLE for r=0.4 class 0.0 = 0.781 +- 0.419 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.279 +- 0.419 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.4 all KL = 0.395 +- 0.419 (in-sample avg dev_std = 0.517)
SUFF_SIMPLE for r=0.4 all L1 = 0.503 +- 0.332 (in-sample avg dev_std = 0.517)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08348399999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.603
SUFF_SIMPLE for r=0.8 class 0.0 = 0.825 +- 0.441 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.393 +- 0.441 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all KL = 0.509 +- 0.441 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.8 all L1 = 0.586 +- 0.365 (in-sample avg dev_std = 0.312)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009916000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.5
SUFF_SIMPLE for r=0.05 class 0.0 = 0.993 +- 0.241 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.809 +- 0.241 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all KL = 0.905 +- 0.241 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all L1 = 0.901 +- 0.229 (in-sample avg dev_std = 0.134)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0099
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.5
SUFF_SIMPLE for r=0.1 class 0.0 = 0.992 +- 0.242 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.809 +- 0.242 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.1 all KL = 0.904 +- 0.242 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.1 all L1 = 0.9 +- 0.229 (in-sample avg dev_std = 0.136)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010028
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.501
SUFF_SIMPLE for r=0.2 class 0.0 = 0.993 +- 0.242 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.809 +- 0.242 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.2 all KL = 0.904 +- 0.242 (in-sample avg dev_std = 0.138)
SUFF_SIMPLE for r=0.2 all L1 = 0.9 +- 0.229 (in-sample avg dev_std = 0.138)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009947800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.5
SUFF_SIMPLE for r=0.4 class 0.0 = 0.993 +- 0.242 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.809 +- 0.242 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 all KL = 0.904 +- 0.242 (in-sample avg dev_std = 0.133)
SUFF_SIMPLE for r=0.4 all L1 = 0.9 +- 0.230 (in-sample avg dev_std = 0.133)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099608
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.234 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.814 +- 0.234 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all KL = 0.913 +- 0.234 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.8 all L1 = 0.904 +- 0.229 (in-sample avg dev_std = 0.052)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0332188
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.627
SUFF_SIMPLE for r=0.05 class 0.0 = 0.695 +- 0.424 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.458 +- 0.424 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.05 all KL = 0.393 +- 0.424 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.05 all L1 = 0.578 +- 0.325 (in-sample avg dev_std = 0.549)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042681000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.629
SUFF_SIMPLE for r=0.1 class 0.0 = 0.699 +- 0.429 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.461 +- 0.429 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.1 all KL = 0.403 +- 0.429 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.1 all L1 = 0.581 +- 0.330 (in-sample avg dev_std = 0.537)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05388720000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.624
SUFF_SIMPLE for r=0.2 class 0.0 = 0.706 +- 0.437 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.456 +- 0.437 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.2 all KL = 0.418 +- 0.437 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.2 all L1 = 0.583 +- 0.337 (in-sample avg dev_std = 0.526)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06665940000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.617
SUFF_SIMPLE for r=0.4 class 0.0 = 0.712 +- 0.444 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.468 +- 0.444 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.4 all KL = 0.439 +- 0.444 (in-sample avg dev_std = 0.498)
SUFF_SIMPLE for r=0.4 all L1 = 0.591 +- 0.346 (in-sample avg dev_std = 0.498)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08023759999999999
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.65
SUFF_SIMPLE for r=0.8 class 0.0 = 0.76 +- 0.459 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.578 +- 0.459 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 all KL = 0.585 +- 0.459 (in-sample avg dev_std = 0.278)
SUFF_SIMPLE for r=0.8 all L1 = 0.67 +- 0.370 (in-sample avg dev_std = 0.278)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.054596
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.798
NEC for r=0.05 class 0.0 = 0.126 +- 0.379 (in-sample avg dev_std = 0.083)
NEC for r=0.05 class 1.0 = 0.316 +- 0.379 (in-sample avg dev_std = 0.083)
NEC for r=0.05 all KL = 0.251 +- 0.379 (in-sample avg dev_std = 0.083)
NEC for r=0.05 all L1 = 0.232 +- 0.325 (in-sample avg dev_std = 0.083)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06373
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.743
NEC for r=0.1 class 0.0 = 0.159 +- 0.414 (in-sample avg dev_std = 0.311)
NEC for r=0.1 class 1.0 = 0.415 +- 0.414 (in-sample avg dev_std = 0.311)
NEC for r=0.1 all KL = 0.358 +- 0.414 (in-sample avg dev_std = 0.311)
NEC for r=0.1 all L1 = 0.301 +- 0.333 (in-sample avg dev_std = 0.311)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071076
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.693
NEC for r=0.2 class 0.0 = 0.175 +- 0.418 (in-sample avg dev_std = 0.453)
NEC for r=0.2 class 1.0 = 0.519 +- 0.418 (in-sample avg dev_std = 0.453)
NEC for r=0.2 all KL = 0.469 +- 0.418 (in-sample avg dev_std = 0.453)
NEC for r=0.2 all L1 = 0.365 +- 0.322 (in-sample avg dev_std = 0.453)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07916399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.688
NEC for r=0.4 class 0.0 = 0.195 +- 0.400 (in-sample avg dev_std = 0.539)
NEC for r=0.4 class 1.0 = 0.54 +- 0.400 (in-sample avg dev_std = 0.539)
NEC for r=0.4 all KL = 0.513 +- 0.400 (in-sample avg dev_std = 0.539)
NEC for r=0.4 all L1 = 0.386 +- 0.301 (in-sample avg dev_std = 0.539)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08348399999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.689
NEC for r=0.8 class 0.0 = 0.179 +- 0.402 (in-sample avg dev_std = 0.580)
NEC for r=0.8 class 1.0 = 0.559 +- 0.402 (in-sample avg dev_std = 0.580)
NEC for r=0.8 all KL = 0.526 +- 0.402 (in-sample avg dev_std = 0.580)
NEC for r=0.8 all L1 = 0.39 +- 0.297 (in-sample avg dev_std = 0.580)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009916000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.003 +- 0.209 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.168 +- 0.209 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.074 +- 0.209 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.086 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0099
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.504
NEC for r=0.1 class 0.0 = 0.003 +- 0.228 (in-sample avg dev_std = 0.044)
NEC for r=0.1 class 1.0 = 0.183 +- 0.228 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all KL = 0.084 +- 0.228 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all L1 = 0.094 +- 0.225 (in-sample avg dev_std = 0.044)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010028
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.504
NEC for r=0.2 class 0.0 = 0.005 +- 0.236 (in-sample avg dev_std = 0.132)
NEC for r=0.2 class 1.0 = 0.188 +- 0.236 (in-sample avg dev_std = 0.132)
NEC for r=0.2 all KL = 0.092 +- 0.236 (in-sample avg dev_std = 0.132)
NEC for r=0.2 all L1 = 0.097 +- 0.226 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009947800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.504
NEC for r=0.4 class 0.0 = 0.005 +- 0.236 (in-sample avg dev_std = 0.145)
NEC for r=0.4 class 1.0 = 0.188 +- 0.236 (in-sample avg dev_std = 0.145)
NEC for r=0.4 all KL = 0.092 +- 0.236 (in-sample avg dev_std = 0.145)
NEC for r=0.4 all L1 = 0.097 +- 0.225 (in-sample avg dev_std = 0.145)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099608
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.505
NEC for r=0.8 class 0.0 = 0.005 +- 0.236 (in-sample avg dev_std = 0.148)
NEC for r=0.8 class 1.0 = 0.188 +- 0.236 (in-sample avg dev_std = 0.148)
NEC for r=0.8 all KL = 0.093 +- 0.236 (in-sample avg dev_std = 0.148)
NEC for r=0.8 all L1 = 0.097 +- 0.224 (in-sample avg dev_std = 0.148)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0332188
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.735
NEC for r=0.05 class 0.0 = 0.11 +- 0.335 (in-sample avg dev_std = 0.089)
NEC for r=0.05 class 1.0 = 0.145 +- 0.335 (in-sample avg dev_std = 0.089)
NEC for r=0.05 all KL = 0.151 +- 0.335 (in-sample avg dev_std = 0.089)
NEC for r=0.05 all L1 = 0.127 +- 0.272 (in-sample avg dev_std = 0.089)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042681000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.716
NEC for r=0.1 class 0.0 = 0.155 +- 0.397 (in-sample avg dev_std = 0.226)
NEC for r=0.1 class 1.0 = 0.226 +- 0.397 (in-sample avg dev_std = 0.226)
NEC for r=0.1 all KL = 0.243 +- 0.397 (in-sample avg dev_std = 0.226)
NEC for r=0.1 all L1 = 0.19 +- 0.311 (in-sample avg dev_std = 0.226)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05388720000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.681
NEC for r=0.2 class 0.0 = 0.203 +- 0.432 (in-sample avg dev_std = 0.356)
NEC for r=0.2 class 1.0 = 0.317 +- 0.432 (in-sample avg dev_std = 0.356)
NEC for r=0.2 all KL = 0.352 +- 0.432 (in-sample avg dev_std = 0.356)
NEC for r=0.2 all L1 = 0.259 +- 0.332 (in-sample avg dev_std = 0.356)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06665940000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.663
NEC for r=0.4 class 0.0 = 0.232 +- 0.432 (in-sample avg dev_std = 0.474)
NEC for r=0.4 class 1.0 = 0.38 +- 0.432 (in-sample avg dev_std = 0.474)
NEC for r=0.4 all KL = 0.445 +- 0.432 (in-sample avg dev_std = 0.474)
NEC for r=0.4 all L1 = 0.305 +- 0.324 (in-sample avg dev_std = 0.474)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08023759999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.663
NEC for r=0.8 class 0.0 = 0.234 +- 0.424 (in-sample avg dev_std = 0.525)
NEC for r=0.8 class 1.0 = 0.406 +- 0.424 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all KL = 0.49 +- 0.424 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all L1 = 0.319 +- 0.310 (in-sample avg dev_std = 0.525)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 14:23:38 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:23:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.052
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.060
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.085
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052216000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.56
SUFF_SIMPLE for r=0.05 class 0.0 = 0.809 +- 0.410 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.289 +- 0.410 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.05 all KL = 0.422 +- 0.410 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.05 all L1 = 0.521 +- 0.318 (in-sample avg dev_std = 0.545)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.060155999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.559
SUFF_SIMPLE for r=0.1 class 0.0 = 0.802 +- 0.408 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.296 +- 0.408 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.1 all KL = 0.424 +- 0.408 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.317 (in-sample avg dev_std = 0.550)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07136200000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.564
SUFF_SIMPLE for r=0.2 class 0.0 = 0.817 +- 0.413 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.296 +- 0.413 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.2 all KL = 0.435 +- 0.413 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.2 all L1 = 0.528 +- 0.324 (in-sample avg dev_std = 0.530)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07992999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.56
SUFF_SIMPLE for r=0.4 class 0.0 = 0.817 +- 0.416 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.297 +- 0.416 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.4 all KL = 0.442 +- 0.416 (in-sample avg dev_std = 0.492)
SUFF_SIMPLE for r=0.4 all L1 = 0.529 +- 0.331 (in-sample avg dev_std = 0.492)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085024
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.609
SUFF_SIMPLE for r=0.8 class 0.0 = 0.837 +- 0.429 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.415 +- 0.429 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.8 all KL = 0.55 +- 0.429 (in-sample avg dev_std = 0.300)
SUFF_SIMPLE for r=0.8 all L1 = 0.603 +- 0.356 (in-sample avg dev_std = 0.300)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009889
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.217 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.848 +- 0.217 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.05 all KL = 0.926 +- 0.217 (in-sample avg dev_std = 0.096)
SUFF_SIMPLE for r=0.05 all L1 = 0.921 +- 0.212 (in-sample avg dev_std = 0.096)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010015000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
SUFF_SIMPLE for r=0.1 class 0.0 = 0.994 +- 0.218 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.847 +- 0.218 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.218 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.1 all L1 = 0.92 +- 0.213 (in-sample avg dev_std = 0.092)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010157000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.217 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.848 +- 0.217 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.217 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.2 all L1 = 0.921 +- 0.211 (in-sample avg dev_std = 0.103)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
SUFF_SIMPLE for r=0.4 class 0.0 = 0.996 +- 0.216 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.848 +- 0.216 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.4 all KL = 0.927 +- 0.216 (in-sample avg dev_std = 0.084)
SUFF_SIMPLE for r=0.4 all L1 = 0.921 +- 0.212 (in-sample avg dev_std = 0.084)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099502
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.212 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.851 +- 0.212 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all KL = 0.93 +- 0.212 (in-sample avg dev_std = 0.030)
SUFF_SIMPLE for r=0.8 all L1 = 0.923 +- 0.210 (in-sample avg dev_std = 0.030)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0345068
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.643
SUFF_SIMPLE for r=0.05 class 0.0 = 0.708 +- 0.400 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.472 +- 0.400 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.05 all KL = 0.46 +- 0.400 (in-sample avg dev_std = 0.511)
SUFF_SIMPLE for r=0.05 all L1 = 0.591 +- 0.312 (in-sample avg dev_std = 0.511)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043183799999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.645
SUFF_SIMPLE for r=0.1 class 0.0 = 0.715 +- 0.404 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.472 +- 0.404 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.1 all KL = 0.473 +- 0.404 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.1 all L1 = 0.595 +- 0.320 (in-sample avg dev_std = 0.495)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0541518
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.639
SUFF_SIMPLE for r=0.2 class 0.0 = 0.719 +- 0.408 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.472 +- 0.408 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.2 all KL = 0.48 +- 0.408 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.2 all L1 = 0.597 +- 0.326 (in-sample avg dev_std = 0.480)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661512
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.633
SUFF_SIMPLE for r=0.4 class 0.0 = 0.722 +- 0.418 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.469 +- 0.418 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.4 all KL = 0.487 +- 0.418 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.4 all L1 = 0.597 +- 0.332 (in-sample avg dev_std = 0.467)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0795928
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.642
SUFF_SIMPLE for r=0.8 class 0.0 = 0.769 +- 0.433 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.552 +- 0.433 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 all KL = 0.613 +- 0.433 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 all L1 = 0.662 +- 0.361 (in-sample avg dev_std = 0.209)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052216000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.832
NEC for r=0.05 class 0.0 = 0.101 +- 0.328 (in-sample avg dev_std = 0.069)
NEC for r=0.05 class 1.0 = 0.271 +- 0.328 (in-sample avg dev_std = 0.069)
NEC for r=0.05 all KL = 0.195 +- 0.328 (in-sample avg dev_std = 0.069)
NEC for r=0.05 all L1 = 0.195 +- 0.289 (in-sample avg dev_std = 0.069)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.060155999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.746
NEC for r=0.1 class 0.0 = 0.137 +- 0.380 (in-sample avg dev_std = 0.263)
NEC for r=0.1 class 1.0 = 0.386 +- 0.380 (in-sample avg dev_std = 0.263)
NEC for r=0.1 all KL = 0.303 +- 0.380 (in-sample avg dev_std = 0.263)
NEC for r=0.1 all L1 = 0.275 +- 0.318 (in-sample avg dev_std = 0.263)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07136200000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.729
NEC for r=0.2 class 0.0 = 0.149 +- 0.384 (in-sample avg dev_std = 0.426)
NEC for r=0.2 class 1.0 = 0.456 +- 0.384 (in-sample avg dev_std = 0.426)
NEC for r=0.2 all KL = 0.376 +- 0.384 (in-sample avg dev_std = 0.426)
NEC for r=0.2 all L1 = 0.319 +- 0.305 (in-sample avg dev_std = 0.426)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07992999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.701
NEC for r=0.4 class 0.0 = 0.16 +- 0.385 (in-sample avg dev_std = 0.494)
NEC for r=0.4 class 1.0 = 0.503 +- 0.385 (in-sample avg dev_std = 0.494)
NEC for r=0.4 all KL = 0.438 +- 0.385 (in-sample avg dev_std = 0.494)
NEC for r=0.4 all L1 = 0.35 +- 0.299 (in-sample avg dev_std = 0.494)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085024
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.703
NEC for r=0.8 class 0.0 = 0.162 +- 0.381 (in-sample avg dev_std = 0.557)
NEC for r=0.8 class 1.0 = 0.527 +- 0.381 (in-sample avg dev_std = 0.557)
NEC for r=0.8 all KL = 0.465 +- 0.381 (in-sample avg dev_std = 0.557)
NEC for r=0.8 all L1 = 0.364 +- 0.283 (in-sample avg dev_std = 0.557)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009889
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.517
NEC for r=0.05 class 0.0 = 0.005 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.052 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.064 +- 0.180 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010015000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.507
NEC for r=0.1 class 0.0 = 0.006 +- 0.202 (in-sample avg dev_std = 0.047)
NEC for r=0.1 class 1.0 = 0.141 +- 0.202 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all KL = 0.066 +- 0.202 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all L1 = 0.074 +- 0.201 (in-sample avg dev_std = 0.047)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010157000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.504
NEC for r=0.2 class 0.0 = 0.005 +- 0.210 (in-sample avg dev_std = 0.131)
NEC for r=0.2 class 1.0 = 0.147 +- 0.210 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all KL = 0.071 +- 0.210 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all L1 = 0.077 +- 0.204 (in-sample avg dev_std = 0.131)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.504
NEC for r=0.4 class 0.0 = 0.006 +- 0.211 (in-sample avg dev_std = 0.134)
NEC for r=0.4 class 1.0 = 0.148 +- 0.211 (in-sample avg dev_std = 0.134)
NEC for r=0.4 all KL = 0.072 +- 0.211 (in-sample avg dev_std = 0.134)
NEC for r=0.4 all L1 = 0.077 +- 0.204 (in-sample avg dev_std = 0.134)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099502
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.504
NEC for r=0.8 class 0.0 = 0.005 +- 0.210 (in-sample avg dev_std = 0.136)
NEC for r=0.8 class 1.0 = 0.148 +- 0.210 (in-sample avg dev_std = 0.136)
NEC for r=0.8 all KL = 0.072 +- 0.210 (in-sample avg dev_std = 0.136)
NEC for r=0.8 all L1 = 0.077 +- 0.204 (in-sample avg dev_std = 0.136)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0345068
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.767
NEC for r=0.05 class 0.0 = 0.113 +- 0.295 (in-sample avg dev_std = 0.073)
NEC for r=0.05 class 1.0 = 0.131 +- 0.295 (in-sample avg dev_std = 0.073)
NEC for r=0.05 all KL = 0.132 +- 0.295 (in-sample avg dev_std = 0.073)
NEC for r=0.05 all L1 = 0.122 +- 0.246 (in-sample avg dev_std = 0.073)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043183799999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.747
NEC for r=0.1 class 0.0 = 0.162 +- 0.354 (in-sample avg dev_std = 0.189)
NEC for r=0.1 class 1.0 = 0.212 +- 0.354 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all KL = 0.215 +- 0.354 (in-sample avg dev_std = 0.189)
NEC for r=0.1 all L1 = 0.187 +- 0.291 (in-sample avg dev_std = 0.189)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0541518
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.71
NEC for r=0.2 class 0.0 = 0.204 +- 0.387 (in-sample avg dev_std = 0.298)
NEC for r=0.2 class 1.0 = 0.298 +- 0.387 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all KL = 0.302 +- 0.387 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all L1 = 0.25 +- 0.316 (in-sample avg dev_std = 0.298)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661512
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.687
NEC for r=0.4 class 0.0 = 0.224 +- 0.393 (in-sample avg dev_std = 0.408)
NEC for r=0.4 class 1.0 = 0.355 +- 0.393 (in-sample avg dev_std = 0.408)
NEC for r=0.4 all KL = 0.368 +- 0.393 (in-sample avg dev_std = 0.408)
NEC for r=0.4 all L1 = 0.289 +- 0.314 (in-sample avg dev_std = 0.408)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0795928
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.683
NEC for r=0.8 class 0.0 = 0.229 +- 0.387 (in-sample avg dev_std = 0.463)
NEC for r=0.8 class 1.0 = 0.373 +- 0.387 (in-sample avg dev_std = 0.463)
NEC for r=0.8 all KL = 0.395 +- 0.387 (in-sample avg dev_std = 0.463)
NEC for r=0.8 all L1 = 0.3 +- 0.303 (in-sample avg dev_std = 0.463)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 14:39:23 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:39:23 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.050
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.072
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.041
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.049656000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.538
SUFF_SIMPLE for r=0.05 class 0.0 = 0.819 +- 0.422 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.247 +- 0.422 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.05 all KL = 0.422 +- 0.422 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.05 all L1 = 0.502 +- 0.334 (in-sample avg dev_std = 0.494)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.056898
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.533
SUFF_SIMPLE for r=0.1 class 0.0 = 0.815 +- 0.424 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.248 +- 0.424 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.1 all KL = 0.425 +- 0.424 (in-sample avg dev_std = 0.487)
SUFF_SIMPLE for r=0.1 all L1 = 0.501 +- 0.337 (in-sample avg dev_std = 0.487)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06566799999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.522
SUFF_SIMPLE for r=0.2 class 0.0 = 0.822 +- 0.428 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.236 +- 0.428 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.2 all KL = 0.425 +- 0.428 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.2 all L1 = 0.497 +- 0.342 (in-sample avg dev_std = 0.472)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07182599999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.526
SUFF_SIMPLE for r=0.4 class 0.0 = 0.836 +- 0.434 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.248 +- 0.434 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.4 all KL = 0.446 +- 0.434 (in-sample avg dev_std = 0.414)
SUFF_SIMPLE for r=0.4 all L1 = 0.51 +- 0.352 (in-sample avg dev_std = 0.414)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.573
SUFF_SIMPLE for r=0.8 class 0.0 = 0.853 +- 0.441 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.317 +- 0.441 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 all KL = 0.51 +- 0.441 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.8 all L1 = 0.556 +- 0.366 (in-sample avg dev_std = 0.269)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0097578
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.014)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009645
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.009)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009702800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.2 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.012)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009762
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.4 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.013)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097938
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0322302
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.574
SUFF_SIMPLE for r=0.05 class 0.0 = 0.664 +- 0.406 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.361 +- 0.406 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.05 all KL = 0.384 +- 0.406 (in-sample avg dev_std = 0.592)
SUFF_SIMPLE for r=0.05 all L1 = 0.515 +- 0.326 (in-sample avg dev_std = 0.592)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0411626
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.574
SUFF_SIMPLE for r=0.1 class 0.0 = 0.679 +- 0.415 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.361 +- 0.415 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.1 all KL = 0.403 +- 0.415 (in-sample avg dev_std = 0.563)
SUFF_SIMPLE for r=0.1 all L1 = 0.522 +- 0.336 (in-sample avg dev_std = 0.563)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05165940000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.572
SUFF_SIMPLE for r=0.2 class 0.0 = 0.691 +- 0.424 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.363 +- 0.424 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.2 all KL = 0.42 +- 0.424 (in-sample avg dev_std = 0.550)
SUFF_SIMPLE for r=0.2 all L1 = 0.529 +- 0.344 (in-sample avg dev_std = 0.550)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0649006
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.546
SUFF_SIMPLE for r=0.4 class 0.0 = 0.7 +- 0.433 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.343 +- 0.433 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.4 all KL = 0.424 +- 0.433 (in-sample avg dev_std = 0.521)
SUFF_SIMPLE for r=0.4 all L1 = 0.524 +- 0.354 (in-sample avg dev_std = 0.521)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0788566
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.557
SUFF_SIMPLE for r=0.8 class 0.0 = 0.733 +- 0.465 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.422 +- 0.465 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.8 all KL = 0.516 +- 0.465 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.8 all L1 = 0.579 +- 0.394 (in-sample avg dev_std = 0.245)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.049656000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.808
NEC for r=0.05 class 0.0 = 0.093 +- 0.357 (in-sample avg dev_std = 0.029)
NEC for r=0.05 class 1.0 = 0.304 +- 0.357 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all KL = 0.205 +- 0.357 (in-sample avg dev_std = 0.029)
NEC for r=0.05 all L1 = 0.21 +- 0.315 (in-sample avg dev_std = 0.029)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.056898
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.739
NEC for r=0.1 class 0.0 = 0.122 +- 0.403 (in-sample avg dev_std = 0.275)
NEC for r=0.1 class 1.0 = 0.429 +- 0.403 (in-sample avg dev_std = 0.275)
NEC for r=0.1 all KL = 0.314 +- 0.403 (in-sample avg dev_std = 0.275)
NEC for r=0.1 all L1 = 0.292 +- 0.336 (in-sample avg dev_std = 0.275)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06566799999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.691
NEC for r=0.2 class 0.0 = 0.132 +- 0.414 (in-sample avg dev_std = 0.436)
NEC for r=0.2 class 1.0 = 0.544 +- 0.414 (in-sample avg dev_std = 0.436)
NEC for r=0.2 all KL = 0.412 +- 0.414 (in-sample avg dev_std = 0.436)
NEC for r=0.2 all L1 = 0.361 +- 0.330 (in-sample avg dev_std = 0.436)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07182599999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.689
NEC for r=0.4 class 0.0 = 0.141 +- 0.404 (in-sample avg dev_std = 0.528)
NEC for r=0.4 class 1.0 = 0.558 +- 0.404 (in-sample avg dev_std = 0.528)
NEC for r=0.4 all KL = 0.446 +- 0.404 (in-sample avg dev_std = 0.528)
NEC for r=0.4 all L1 = 0.372 +- 0.312 (in-sample avg dev_std = 0.528)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.675
NEC for r=0.8 class 0.0 = 0.148 +- 0.401 (in-sample avg dev_std = 0.581)
NEC for r=0.8 class 1.0 = 0.59 +- 0.401 (in-sample avg dev_std = 0.581)
NEC for r=0.8 all KL = 0.485 +- 0.401 (in-sample avg dev_std = 0.581)
NEC for r=0.8 all L1 = 0.393 +- 0.304 (in-sample avg dev_std = 0.581)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0097578
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.001 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.093 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.033 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.047 +- 0.148 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009645
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.001 +- 0.159 (in-sample avg dev_std = 0.011)
NEC for r=0.1 class 1.0 = 0.108 +- 0.159 (in-sample avg dev_std = 0.011)
NEC for r=0.1 all KL = 0.045 +- 0.159 (in-sample avg dev_std = 0.011)
NEC for r=0.1 all L1 = 0.055 +- 0.170 (in-sample avg dev_std = 0.011)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009702800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.001 +- 0.162 (in-sample avg dev_std = 0.044)
NEC for r=0.2 class 1.0 = 0.109 +- 0.162 (in-sample avg dev_std = 0.044)
NEC for r=0.2 all KL = 0.046 +- 0.162 (in-sample avg dev_std = 0.044)
NEC for r=0.2 all L1 = 0.055 +- 0.171 (in-sample avg dev_std = 0.044)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009762
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.001 +- 0.162 (in-sample avg dev_std = 0.049)
NEC for r=0.4 class 1.0 = 0.109 +- 0.162 (in-sample avg dev_std = 0.049)
NEC for r=0.4 all KL = 0.046 +- 0.162 (in-sample avg dev_std = 0.049)
NEC for r=0.4 all L1 = 0.055 +- 0.171 (in-sample avg dev_std = 0.049)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097938
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
NEC for r=0.8 class 0.0 = 0.001 +- 0.162 (in-sample avg dev_std = 0.051)
NEC for r=0.8 class 1.0 = 0.109 +- 0.162 (in-sample avg dev_std = 0.051)
NEC for r=0.8 all KL = 0.046 +- 0.162 (in-sample avg dev_std = 0.051)
NEC for r=0.8 all L1 = 0.055 +- 0.171 (in-sample avg dev_std = 0.051)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0322302
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.702
NEC for r=0.05 class 0.0 = 0.117 +- 0.357 (in-sample avg dev_std = 0.121)
NEC for r=0.05 class 1.0 = 0.198 +- 0.357 (in-sample avg dev_std = 0.121)
NEC for r=0.05 all KL = 0.175 +- 0.357 (in-sample avg dev_std = 0.121)
NEC for r=0.05 all L1 = 0.157 +- 0.305 (in-sample avg dev_std = 0.121)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0411626
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.669
NEC for r=0.1 class 0.0 = 0.172 +- 0.412 (in-sample avg dev_std = 0.294)
NEC for r=0.1 class 1.0 = 0.31 +- 0.412 (in-sample avg dev_std = 0.294)
NEC for r=0.1 all KL = 0.282 +- 0.412 (in-sample avg dev_std = 0.294)
NEC for r=0.1 all L1 = 0.24 +- 0.343 (in-sample avg dev_std = 0.294)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05165940000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.638
NEC for r=0.2 class 0.0 = 0.217 +- 0.426 (in-sample avg dev_std = 0.428)
NEC for r=0.2 class 1.0 = 0.403 +- 0.426 (in-sample avg dev_std = 0.428)
NEC for r=0.2 all KL = 0.379 +- 0.426 (in-sample avg dev_std = 0.428)
NEC for r=0.2 all L1 = 0.309 +- 0.348 (in-sample avg dev_std = 0.428)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0649006
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.625
NEC for r=0.4 class 0.0 = 0.239 +- 0.419 (in-sample avg dev_std = 0.516)
NEC for r=0.4 class 1.0 = 0.451 +- 0.419 (in-sample avg dev_std = 0.516)
NEC for r=0.4 all KL = 0.436 +- 0.419 (in-sample avg dev_std = 0.516)
NEC for r=0.4 all L1 = 0.344 +- 0.337 (in-sample avg dev_std = 0.516)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0788566
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.641
NEC for r=0.8 class 0.0 = 0.251 +- 0.410 (in-sample avg dev_std = 0.565)
NEC for r=0.8 class 1.0 = 0.467 +- 0.410 (in-sample avg dev_std = 0.565)
NEC for r=0.8 all KL = 0.471 +- 0.410 (in-sample avg dev_std = 0.565)
NEC for r=0.8 all L1 = 0.358 +- 0.323 (in-sample avg dev_std = 0.565)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 14:55:32 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 02:55:32 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.056
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.063
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.074
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.053
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056016
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.512
SUFF_SIMPLE for r=0.05 class 0.0 = 0.82 +- 0.420 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.225 +- 0.420 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 all KL = 0.418 +- 0.420 (in-sample avg dev_std = 0.477)
SUFF_SIMPLE for r=0.05 all L1 = 0.49 +- 0.334 (in-sample avg dev_std = 0.477)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06277200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.525
SUFF_SIMPLE for r=0.1 class 0.0 = 0.828 +- 0.422 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.232 +- 0.422 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.1 all KL = 0.43 +- 0.422 (in-sample avg dev_std = 0.468)
SUFF_SIMPLE for r=0.1 all L1 = 0.498 +- 0.337 (in-sample avg dev_std = 0.468)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07413400000000002
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.524
SUFF_SIMPLE for r=0.2 class 0.0 = 0.822 +- 0.420 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.232 +- 0.420 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 all KL = 0.428 +- 0.420 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 all L1 = 0.495 +- 0.337 (in-sample avg dev_std = 0.470)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07953199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.521
SUFF_SIMPLE for r=0.4 class 0.0 = 0.827 +- 0.426 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.237 +- 0.426 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.426 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.4 all L1 = 0.5 +- 0.344 (in-sample avg dev_std = 0.429)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08368199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.571
SUFF_SIMPLE for r=0.8 class 0.0 = 0.849 +- 0.439 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.323 +- 0.439 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.8 all KL = 0.517 +- 0.439 (in-sample avg dev_std = 0.249)
SUFF_SIMPLE for r=0.8 all L1 = 0.558 +- 0.367 (in-sample avg dev_std = 0.249)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009431400000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.05 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.012)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.017)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009599600000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.011)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096322
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.4 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.210 (in-sample avg dev_std = 0.014)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03302859999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.585
SUFF_SIMPLE for r=0.05 class 0.0 = 0.678 +- 0.408 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.346 +- 0.408 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.05 all KL = 0.406 +- 0.408 (in-sample avg dev_std = 0.574)
SUFF_SIMPLE for r=0.05 all L1 = 0.514 +- 0.329 (in-sample avg dev_std = 0.574)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0427978
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.587
SUFF_SIMPLE for r=0.1 class 0.0 = 0.69 +- 0.416 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.352 +- 0.416 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.1 all KL = 0.429 +- 0.416 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.1 all L1 = 0.523 +- 0.338 (in-sample avg dev_std = 0.557)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052964599999999994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.576
SUFF_SIMPLE for r=0.2 class 0.0 = 0.697 +- 0.421 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.352 +- 0.421 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.2 all KL = 0.446 +- 0.421 (in-sample avg dev_std = 0.536)
SUFF_SIMPLE for r=0.2 all L1 = 0.527 +- 0.348 (in-sample avg dev_std = 0.536)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066387
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.557
SUFF_SIMPLE for r=0.4 class 0.0 = 0.703 +- 0.428 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.356 +- 0.428 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.4 all KL = 0.458 +- 0.428 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.4 all L1 = 0.531 +- 0.356 (in-sample avg dev_std = 0.513)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.759
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08038319999999999
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.568
SUFF_SIMPLE for r=0.8 class 0.0 = 0.729 +- 0.454 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.423 +- 0.454 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.8 all KL = 0.532 +- 0.454 (in-sample avg dev_std = 0.253)
SUFF_SIMPLE for r=0.8 all L1 = 0.577 +- 0.393 (in-sample avg dev_std = 0.253)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056016
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.783
NEC for r=0.05 class 0.0 = 0.085 +- 0.373 (in-sample avg dev_std = 0.040)
NEC for r=0.05 class 1.0 = 0.353 +- 0.373 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all KL = 0.236 +- 0.373 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all L1 = 0.234 +- 0.324 (in-sample avg dev_std = 0.040)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06277200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.71
NEC for r=0.1 class 0.0 = 0.111 +- 0.412 (in-sample avg dev_std = 0.303)
NEC for r=0.1 class 1.0 = 0.483 +- 0.412 (in-sample avg dev_std = 0.303)
NEC for r=0.1 all KL = 0.341 +- 0.412 (in-sample avg dev_std = 0.303)
NEC for r=0.1 all L1 = 0.317 +- 0.343 (in-sample avg dev_std = 0.303)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07413400000000002
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.673
NEC for r=0.2 class 0.0 = 0.127 +- 0.414 (in-sample avg dev_std = 0.436)
NEC for r=0.2 class 1.0 = 0.561 +- 0.414 (in-sample avg dev_std = 0.436)
NEC for r=0.2 all KL = 0.416 +- 0.414 (in-sample avg dev_std = 0.436)
NEC for r=0.2 all L1 = 0.368 +- 0.333 (in-sample avg dev_std = 0.436)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07953199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.652
NEC for r=0.4 class 0.0 = 0.139 +- 0.405 (in-sample avg dev_std = 0.531)
NEC for r=0.4 class 1.0 = 0.613 +- 0.405 (in-sample avg dev_std = 0.531)
NEC for r=0.4 all KL = 0.474 +- 0.405 (in-sample avg dev_std = 0.531)
NEC for r=0.4 all L1 = 0.402 +- 0.315 (in-sample avg dev_std = 0.531)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08368199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.651
NEC for r=0.8 class 0.0 = 0.139 +- 0.404 (in-sample avg dev_std = 0.591)
NEC for r=0.8 class 1.0 = 0.636 +- 0.404 (in-sample avg dev_std = 0.591)
NEC for r=0.8 all KL = 0.499 +- 0.404 (in-sample avg dev_std = 0.591)
NEC for r=0.8 all L1 = 0.414 +- 0.304 (in-sample avg dev_std = 0.591)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009431400000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.003 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.152 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.055 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.078 +- 0.184 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.003 +- 0.191 (in-sample avg dev_std = 0.018)
NEC for r=0.1 class 1.0 = 0.173 +- 0.191 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all KL = 0.071 +- 0.191 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all L1 = 0.088 +- 0.206 (in-sample avg dev_std = 0.018)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009599600000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.003 +- 0.194 (in-sample avg dev_std = 0.062)
NEC for r=0.2 class 1.0 = 0.175 +- 0.194 (in-sample avg dev_std = 0.062)
NEC for r=0.2 all KL = 0.074 +- 0.194 (in-sample avg dev_std = 0.062)
NEC for r=0.2 all L1 = 0.09 +- 0.208 (in-sample avg dev_std = 0.062)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096322
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.003 +- 0.195 (in-sample avg dev_std = 0.058)
NEC for r=0.4 class 1.0 = 0.175 +- 0.195 (in-sample avg dev_std = 0.058)
NEC for r=0.4 all KL = 0.073 +- 0.195 (in-sample avg dev_std = 0.058)
NEC for r=0.4 all L1 = 0.09 +- 0.208 (in-sample avg dev_std = 0.058)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.003 +- 0.194 (in-sample avg dev_std = 0.068)
NEC for r=0.8 class 1.0 = 0.175 +- 0.194 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all KL = 0.074 +- 0.194 (in-sample avg dev_std = 0.068)
NEC for r=0.8 all L1 = 0.09 +- 0.208 (in-sample avg dev_std = 0.068)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03302859999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.691
NEC for r=0.05 class 0.0 = 0.122 +- 0.362 (in-sample avg dev_std = 0.117)
NEC for r=0.05 class 1.0 = 0.235 +- 0.362 (in-sample avg dev_std = 0.117)
NEC for r=0.05 all KL = 0.187 +- 0.362 (in-sample avg dev_std = 0.117)
NEC for r=0.05 all L1 = 0.178 +- 0.316 (in-sample avg dev_std = 0.117)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0427978
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.656
NEC for r=0.1 class 0.0 = 0.173 +- 0.411 (in-sample avg dev_std = 0.294)
NEC for r=0.1 class 1.0 = 0.352 +- 0.411 (in-sample avg dev_std = 0.294)
NEC for r=0.1 all KL = 0.289 +- 0.411 (in-sample avg dev_std = 0.294)
NEC for r=0.1 all L1 = 0.261 +- 0.350 (in-sample avg dev_std = 0.294)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052964599999999994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.627
NEC for r=0.2 class 0.0 = 0.218 +- 0.425 (in-sample avg dev_std = 0.450)
NEC for r=0.2 class 1.0 = 0.44 +- 0.425 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all KL = 0.383 +- 0.425 (in-sample avg dev_std = 0.450)
NEC for r=0.2 all L1 = 0.327 +- 0.349 (in-sample avg dev_std = 0.450)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066387
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.621
NEC for r=0.4 class 0.0 = 0.233 +- 0.417 (in-sample avg dev_std = 0.535)
NEC for r=0.4 class 1.0 = 0.482 +- 0.417 (in-sample avg dev_std = 0.535)
NEC for r=0.4 all KL = 0.433 +- 0.417 (in-sample avg dev_std = 0.535)
NEC for r=0.4 all L1 = 0.356 +- 0.334 (in-sample avg dev_std = 0.535)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.758
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08038319999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.631
NEC for r=0.8 class 0.0 = 0.251 +- 0.413 (in-sample avg dev_std = 0.585)
NEC for r=0.8 class 1.0 = 0.5 +- 0.413 (in-sample avg dev_std = 0.585)
NEC for r=0.8 all KL = 0.475 +- 0.413 (in-sample avg dev_std = 0.585)
NEC for r=0.8 all L1 = 0.374 +- 0.321 (in-sample avg dev_std = 0.585)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 15:12:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:12:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.042
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.051
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.062
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.031
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.039
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.042006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.465
SUFF_SIMPLE for r=0.05 class 0.0 = 0.835 +- 0.422 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.19 +- 0.422 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.05 all KL = 0.437 +- 0.422 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.05 all L1 = 0.477 +- 0.359 (in-sample avg dev_std = 0.257)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051398000000000006
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.465
SUFF_SIMPLE for r=0.1 class 0.0 = 0.835 +- 0.424 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.188 +- 0.424 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 all KL = 0.437 +- 0.424 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 all L1 = 0.476 +- 0.358 (in-sample avg dev_std = 0.268)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.062258
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.472
SUFF_SIMPLE for r=0.2 class 0.0 = 0.836 +- 0.422 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.194 +- 0.422 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.2 all KL = 0.444 +- 0.422 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.2 all L1 = 0.48 +- 0.358 (in-sample avg dev_std = 0.262)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071108
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.462
SUFF_SIMPLE for r=0.4 class 0.0 = 0.838 +- 0.429 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.189 +- 0.429 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.4 all KL = 0.447 +- 0.429 (in-sample avg dev_std = 0.222)
SUFF_SIMPLE for r=0.4 all L1 = 0.478 +- 0.365 (in-sample avg dev_std = 0.222)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078322
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.5
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.434 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.242 +- 0.434 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.8 all KL = 0.489 +- 0.434 (in-sample avg dev_std = 0.121)
SUFF_SIMPLE for r=0.8 all L1 = 0.514 +- 0.373 (in-sample avg dev_std = 0.121)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090484
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009418
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009648400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00977
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097698
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0306144
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.59
SUFF_SIMPLE for r=0.05 class 0.0 = 0.701 +- 0.391 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.4 +- 0.391 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all KL = 0.451 +- 0.391 (in-sample avg dev_std = 0.567)
SUFF_SIMPLE for r=0.05 all L1 = 0.552 +- 0.322 (in-sample avg dev_std = 0.567)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0393344
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.586
SUFF_SIMPLE for r=0.1 class 0.0 = 0.709 +- 0.398 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.403 +- 0.398 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.1 all KL = 0.469 +- 0.398 (in-sample avg dev_std = 0.557)
SUFF_SIMPLE for r=0.1 all L1 = 0.557 +- 0.329 (in-sample avg dev_std = 0.557)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0511508
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.586
SUFF_SIMPLE for r=0.2 class 0.0 = 0.716 +- 0.403 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.408 +- 0.403 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.2 all KL = 0.489 +- 0.403 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.2 all L1 = 0.563 +- 0.336 (in-sample avg dev_std = 0.543)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0650544
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.58
SUFF_SIMPLE for r=0.4 class 0.0 = 0.719 +- 0.409 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.411 +- 0.409 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.4 all KL = 0.503 +- 0.409 (in-sample avg dev_std = 0.529)
SUFF_SIMPLE for r=0.4 all L1 = 0.567 +- 0.344 (in-sample avg dev_std = 0.529)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790352
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.606
SUFF_SIMPLE for r=0.8 class 0.0 = 0.761 +- 0.436 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.513 +- 0.436 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.8 all KL = 0.607 +- 0.436 (in-sample avg dev_std = 0.319)
SUFF_SIMPLE for r=0.8 all L1 = 0.638 +- 0.376 (in-sample avg dev_std = 0.319)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.042006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.734
NEC for r=0.05 class 0.0 = 0.118 +- 0.364 (in-sample avg dev_std = 0.066)
NEC for r=0.05 class 1.0 = 0.426 +- 0.364 (in-sample avg dev_std = 0.066)
NEC for r=0.05 all KL = 0.271 +- 0.364 (in-sample avg dev_std = 0.066)
NEC for r=0.05 all L1 = 0.288 +- 0.330 (in-sample avg dev_std = 0.066)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051398000000000006
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.645
NEC for r=0.1 class 0.0 = 0.141 +- 0.398 (in-sample avg dev_std = 0.261)
NEC for r=0.1 class 1.0 = 0.574 +- 0.398 (in-sample avg dev_std = 0.261)
NEC for r=0.1 all KL = 0.39 +- 0.398 (in-sample avg dev_std = 0.261)
NEC for r=0.1 all L1 = 0.381 +- 0.343 (in-sample avg dev_std = 0.261)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.062258
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.6
NEC for r=0.2 class 0.0 = 0.156 +- 0.403 (in-sample avg dev_std = 0.358)
NEC for r=0.2 class 1.0 = 0.649 +- 0.403 (in-sample avg dev_std = 0.358)
NEC for r=0.2 all KL = 0.455 +- 0.403 (in-sample avg dev_std = 0.358)
NEC for r=0.2 all L1 = 0.429 +- 0.343 (in-sample avg dev_std = 0.358)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071108
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.578
NEC for r=0.4 class 0.0 = 0.154 +- 0.400 (in-sample avg dev_std = 0.442)
NEC for r=0.4 class 1.0 = 0.699 +- 0.400 (in-sample avg dev_std = 0.442)
NEC for r=0.4 all KL = 0.494 +- 0.400 (in-sample avg dev_std = 0.442)
NEC for r=0.4 all L1 = 0.456 +- 0.333 (in-sample avg dev_std = 0.442)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078322
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.585
NEC for r=0.8 class 0.0 = 0.152 +- 0.396 (in-sample avg dev_std = 0.483)
NEC for r=0.8 class 1.0 = 0.703 +- 0.396 (in-sample avg dev_std = 0.483)
NEC for r=0.8 all KL = 0.5 +- 0.396 (in-sample avg dev_std = 0.483)
NEC for r=0.8 all L1 = 0.457 +- 0.325 (in-sample avg dev_std = 0.483)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090484
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.001 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.086 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.044 +- 0.127 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009418
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009648400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.004)
NEC for r=0.2 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.004)
NEC for r=0.2 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00977
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.005)
NEC for r=0.4 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.005)
NEC for r=0.4 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.005)
NEC for r=0.4 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.005)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097698
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.008)
NEC for r=0.8 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.008)
NEC for r=0.8 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.008)
NEC for r=0.8 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.008)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0306144
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.701
NEC for r=0.05 class 0.0 = 0.112 +- 0.329 (in-sample avg dev_std = 0.107)
NEC for r=0.05 class 1.0 = 0.196 +- 0.329 (in-sample avg dev_std = 0.107)
NEC for r=0.05 all KL = 0.154 +- 0.329 (in-sample avg dev_std = 0.107)
NEC for r=0.05 all L1 = 0.154 +- 0.294 (in-sample avg dev_std = 0.107)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0393344
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.673
NEC for r=0.1 class 0.0 = 0.162 +- 0.385 (in-sample avg dev_std = 0.285)
NEC for r=0.1 class 1.0 = 0.303 +- 0.385 (in-sample avg dev_std = 0.285)
NEC for r=0.1 all KL = 0.248 +- 0.385 (in-sample avg dev_std = 0.285)
NEC for r=0.1 all L1 = 0.232 +- 0.332 (in-sample avg dev_std = 0.285)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0511508
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.639
NEC for r=0.2 class 0.0 = 0.196 +- 0.398 (in-sample avg dev_std = 0.424)
NEC for r=0.2 class 1.0 = 0.401 +- 0.398 (in-sample avg dev_std = 0.424)
NEC for r=0.2 all KL = 0.336 +- 0.398 (in-sample avg dev_std = 0.424)
NEC for r=0.2 all L1 = 0.297 +- 0.337 (in-sample avg dev_std = 0.424)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0650544
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.623
NEC for r=0.4 class 0.0 = 0.213 +- 0.386 (in-sample avg dev_std = 0.521)
NEC for r=0.4 class 1.0 = 0.451 +- 0.386 (in-sample avg dev_std = 0.521)
NEC for r=0.4 all KL = 0.389 +- 0.386 (in-sample avg dev_std = 0.521)
NEC for r=0.4 all L1 = 0.331 +- 0.321 (in-sample avg dev_std = 0.521)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790352
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.634
NEC for r=0.8 class 0.0 = 0.232 +- 0.380 (in-sample avg dev_std = 0.565)
NEC for r=0.8 class 1.0 = 0.461 +- 0.380 (in-sample avg dev_std = 0.565)
NEC for r=0.8 all KL = 0.427 +- 0.380 (in-sample avg dev_std = 0.565)
NEC for r=0.8 all L1 = 0.345 +- 0.307 (in-sample avg dev_std = 0.565)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 15:29:05 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:29:05 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.054
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.065
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.053778
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.525
SUFF_SIMPLE for r=0.05 class 0.0 = 0.862 +- 0.428 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.231 +- 0.428 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.05 all KL = 0.446 +- 0.428 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.05 all L1 = 0.512 +- 0.347 (in-sample avg dev_std = 0.462)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06461199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.525
SUFF_SIMPLE for r=0.1 class 0.0 = 0.867 +- 0.432 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.229 +- 0.432 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.1 all KL = 0.449 +- 0.432 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.1 all L1 = 0.514 +- 0.351 (in-sample avg dev_std = 0.454)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07291999999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.525
SUFF_SIMPLE for r=0.2 class 0.0 = 0.867 +- 0.431 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.238 +- 0.431 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.2 all KL = 0.457 +- 0.431 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.2 all L1 = 0.518 +- 0.352 (in-sample avg dev_std = 0.433)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076572
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.519
SUFF_SIMPLE for r=0.4 class 0.0 = 0.863 +- 0.433 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.233 +- 0.433 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all KL = 0.451 +- 0.433 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all L1 = 0.514 +- 0.352 (in-sample avg dev_std = 0.428)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080766
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.581
SUFF_SIMPLE for r=0.8 class 0.0 = 0.883 +- 0.433 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.335 +- 0.433 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.8 all KL = 0.537 +- 0.433 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.8 all L1 = 0.579 +- 0.364 (in-sample avg dev_std = 0.263)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0102602
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.05 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.152 (in-sample avg dev_std = 0.010)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010405000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.152 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0101366
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.2 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.008)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.152 (in-sample avg dev_std = 0.008)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100754
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.009)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.152 (in-sample avg dev_std = 0.009)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099994
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0326934
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.585
SUFF_SIMPLE for r=0.05 class 0.0 = 0.72 +- 0.419 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.382 +- 0.419 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.05 all KL = 0.439 +- 0.419 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.05 all L1 = 0.553 +- 0.336 (in-sample avg dev_std = 0.549)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0418
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.585
SUFF_SIMPLE for r=0.1 class 0.0 = 0.721 +- 0.421 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.382 +- 0.421 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.1 all KL = 0.441 +- 0.421 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.1 all L1 = 0.553 +- 0.338 (in-sample avg dev_std = 0.543)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05241099999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.584
SUFF_SIMPLE for r=0.2 class 0.0 = 0.723 +- 0.422 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.385 +- 0.422 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.2 all KL = 0.447 +- 0.422 (in-sample avg dev_std = 0.530)
SUFF_SIMPLE for r=0.2 all L1 = 0.556 +- 0.340 (in-sample avg dev_std = 0.530)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06525059999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.586
SUFF_SIMPLE for r=0.4 class 0.0 = 0.721 +- 0.424 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.395 +- 0.424 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.4 all KL = 0.454 +- 0.424 (in-sample avg dev_std = 0.514)
SUFF_SIMPLE for r=0.4 all L1 = 0.56 +- 0.343 (in-sample avg dev_std = 0.514)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079707
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.613
SUFF_SIMPLE for r=0.8 class 0.0 = 0.768 +- 0.449 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.51 +- 0.449 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.8 all KL = 0.582 +- 0.449 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.8 all L1 = 0.64 +- 0.372 (in-sample avg dev_std = 0.306)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.053778
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.795
NEC for r=0.05 class 0.0 = 0.082 +- 0.350 (in-sample avg dev_std = 0.040)
NEC for r=0.05 class 1.0 = 0.328 +- 0.350 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all KL = 0.212 +- 0.350 (in-sample avg dev_std = 0.040)
NEC for r=0.05 all L1 = 0.218 +- 0.308 (in-sample avg dev_std = 0.040)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06461199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.716
NEC for r=0.1 class 0.0 = 0.089 +- 0.401 (in-sample avg dev_std = 0.268)
NEC for r=0.1 class 1.0 = 0.469 +- 0.401 (in-sample avg dev_std = 0.268)
NEC for r=0.1 all KL = 0.32 +- 0.401 (in-sample avg dev_std = 0.268)
NEC for r=0.1 all L1 = 0.3 +- 0.335 (in-sample avg dev_std = 0.268)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07291999999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.688
NEC for r=0.2 class 0.0 = 0.11 +- 0.398 (in-sample avg dev_std = 0.416)
NEC for r=0.2 class 1.0 = 0.534 +- 0.398 (in-sample avg dev_std = 0.416)
NEC for r=0.2 all KL = 0.391 +- 0.398 (in-sample avg dev_std = 0.416)
NEC for r=0.2 all L1 = 0.344 +- 0.322 (in-sample avg dev_std = 0.416)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076572
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.681
NEC for r=0.4 class 0.0 = 0.109 +- 0.393 (in-sample avg dev_std = 0.498)
NEC for r=0.4 class 1.0 = 0.575 +- 0.393 (in-sample avg dev_std = 0.498)
NEC for r=0.4 all KL = 0.433 +- 0.393 (in-sample avg dev_std = 0.498)
NEC for r=0.4 all L1 = 0.367 +- 0.310 (in-sample avg dev_std = 0.498)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080766
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.669
NEC for r=0.8 class 0.0 = 0.119 +- 0.397 (in-sample avg dev_std = 0.547)
NEC for r=0.8 class 1.0 = 0.602 +- 0.397 (in-sample avg dev_std = 0.547)
NEC for r=0.8 all KL = 0.464 +- 0.397 (in-sample avg dev_std = 0.547)
NEC for r=0.8 all L1 = 0.386 +- 0.307 (in-sample avg dev_std = 0.547)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0102602
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.0 +- 0.114 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.082 +- 0.114 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.029 +- 0.114 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.041 +- 0.138 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010405000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.001 +- 0.134 (in-sample avg dev_std = 0.018)
NEC for r=0.1 class 1.0 = 0.089 +- 0.134 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all KL = 0.035 +- 0.134 (in-sample avg dev_std = 0.018)
NEC for r=0.1 all L1 = 0.045 +- 0.151 (in-sample avg dev_std = 0.018)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0101366
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.136 (in-sample avg dev_std = 0.028)
NEC for r=0.2 class 1.0 = 0.09 +- 0.136 (in-sample avg dev_std = 0.028)
NEC for r=0.2 all KL = 0.036 +- 0.136 (in-sample avg dev_std = 0.028)
NEC for r=0.2 all L1 = 0.045 +- 0.151 (in-sample avg dev_std = 0.028)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100754
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.001 +- 0.135 (in-sample avg dev_std = 0.033)
NEC for r=0.4 class 1.0 = 0.089 +- 0.135 (in-sample avg dev_std = 0.033)
NEC for r=0.4 all KL = 0.036 +- 0.135 (in-sample avg dev_std = 0.033)
NEC for r=0.4 all L1 = 0.045 +- 0.151 (in-sample avg dev_std = 0.033)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099994
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.135 (in-sample avg dev_std = 0.034)
NEC for r=0.8 class 1.0 = 0.089 +- 0.135 (in-sample avg dev_std = 0.034)
NEC for r=0.8 all KL = 0.036 +- 0.135 (in-sample avg dev_std = 0.034)
NEC for r=0.8 all L1 = 0.045 +- 0.151 (in-sample avg dev_std = 0.034)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0326934
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.721
NEC for r=0.05 class 0.0 = 0.113 +- 0.340 (in-sample avg dev_std = 0.099)
NEC for r=0.05 class 1.0 = 0.191 +- 0.340 (in-sample avg dev_std = 0.099)
NEC for r=0.05 all KL = 0.164 +- 0.340 (in-sample avg dev_std = 0.099)
NEC for r=0.05 all L1 = 0.151 +- 0.291 (in-sample avg dev_std = 0.099)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0418
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.693
NEC for r=0.1 class 0.0 = 0.162 +- 0.396 (in-sample avg dev_std = 0.265)
NEC for r=0.1 class 1.0 = 0.291 +- 0.396 (in-sample avg dev_std = 0.265)
NEC for r=0.1 all KL = 0.261 +- 0.396 (in-sample avg dev_std = 0.265)
NEC for r=0.1 all L1 = 0.226 +- 0.327 (in-sample avg dev_std = 0.265)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05241099999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.655
NEC for r=0.2 class 0.0 = 0.201 +- 0.418 (in-sample avg dev_std = 0.406)
NEC for r=0.2 class 1.0 = 0.403 +- 0.418 (in-sample avg dev_std = 0.406)
NEC for r=0.2 all KL = 0.371 +- 0.418 (in-sample avg dev_std = 0.406)
NEC for r=0.2 all L1 = 0.301 +- 0.337 (in-sample avg dev_std = 0.406)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06525059999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.632
NEC for r=0.4 class 0.0 = 0.215 +- 0.408 (in-sample avg dev_std = 0.497)
NEC for r=0.4 class 1.0 = 0.463 +- 0.408 (in-sample avg dev_std = 0.497)
NEC for r=0.4 all KL = 0.435 +- 0.408 (in-sample avg dev_std = 0.497)
NEC for r=0.4 all L1 = 0.337 +- 0.325 (in-sample avg dev_std = 0.497)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079707
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.633
NEC for r=0.8 class 0.0 = 0.221 +- 0.399 (in-sample avg dev_std = 0.539)
NEC for r=0.8 class 1.0 = 0.474 +- 0.399 (in-sample avg dev_std = 0.539)
NEC for r=0.8 all KL = 0.456 +- 0.399 (in-sample avg dev_std = 0.539)
NEC for r=0.8 all L1 = 0.346 +- 0.316 (in-sample avg dev_std = 0.539)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 15:45:56 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 03:45:56 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.037
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.052
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.029
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037028
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.468
SUFF_SIMPLE for r=0.05 class 0.0 = 0.787 +- 0.396 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.21 +- 0.396 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.05 all KL = 0.458 +- 0.396 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.05 all L1 = 0.467 +- 0.337 (in-sample avg dev_std = 0.228)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051755999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.468
SUFF_SIMPLE for r=0.1 class 0.0 = 0.785 +- 0.396 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.21 +- 0.396 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 all KL = 0.457 +- 0.396 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 all L1 = 0.466 +- 0.337 (in-sample avg dev_std = 0.227)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06625400000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.471
SUFF_SIMPLE for r=0.2 class 0.0 = 0.788 +- 0.397 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.212 +- 0.397 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.2 all KL = 0.461 +- 0.397 (in-sample avg dev_std = 0.212)
SUFF_SIMPLE for r=0.2 all L1 = 0.469 +- 0.338 (in-sample avg dev_std = 0.212)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07111400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.472
SUFF_SIMPLE for r=0.4 class 0.0 = 0.784 +- 0.396 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.218 +- 0.396 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all KL = 0.464 +- 0.396 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.4 all L1 = 0.47 +- 0.339 (in-sample avg dev_std = 0.184)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08048400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.495
SUFF_SIMPLE for r=0.8 class 0.0 = 0.791 +- 0.396 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.25 +- 0.396 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 all KL = 0.491 +- 0.396 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 all L1 = 0.491 +- 0.342 (in-sample avg dev_std = 0.134)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009109
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093032
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095222
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096158
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096514
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0288246
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.54
SUFF_SIMPLE for r=0.05 class 0.0 = 0.699 +- 0.372 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.405 +- 0.372 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.05 all KL = 0.555 +- 0.372 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.05 all L1 = 0.554 +- 0.319 (in-sample avg dev_std = 0.402)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0367006
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.541
SUFF_SIMPLE for r=0.1 class 0.0 = 0.698 +- 0.373 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.403 +- 0.373 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.1 all KL = 0.555 +- 0.373 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.1 all L1 = 0.552 +- 0.320 (in-sample avg dev_std = 0.402)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.04739840000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.537
SUFF_SIMPLE for r=0.2 class 0.0 = 0.7 +- 0.378 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.404 +- 0.378 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.2 all KL = 0.559 +- 0.378 (in-sample avg dev_std = 0.392)
SUFF_SIMPLE for r=0.2 all L1 = 0.554 +- 0.323 (in-sample avg dev_std = 0.392)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0617976
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.54
SUFF_SIMPLE for r=0.4 class 0.0 = 0.701 +- 0.380 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.413 +- 0.380 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 all KL = 0.567 +- 0.380 (in-sample avg dev_std = 0.385)
SUFF_SIMPLE for r=0.4 all L1 = 0.558 +- 0.325 (in-sample avg dev_std = 0.385)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07703
len(reference) = 4983
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.578
SUFF_SIMPLE for r=0.8 class 0.0 = 0.744 +- 0.387 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.502 +- 0.387 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.8 all KL = 0.65 +- 0.387 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.8 all L1 = 0.624 +- 0.341 (in-sample avg dev_std = 0.205)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037028
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.731
NEC for r=0.05 class 0.0 = 0.159 +- 0.328 (in-sample avg dev_std = 0.042)
NEC for r=0.05 class 1.0 = 0.429 +- 0.328 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all KL = 0.247 +- 0.328 (in-sample avg dev_std = 0.042)
NEC for r=0.05 all L1 = 0.309 +- 0.303 (in-sample avg dev_std = 0.042)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051755999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.632
NEC for r=0.1 class 0.0 = 0.187 +- 0.363 (in-sample avg dev_std = 0.219)
NEC for r=0.1 class 1.0 = 0.575 +- 0.363 (in-sample avg dev_std = 0.219)
NEC for r=0.1 all KL = 0.369 +- 0.363 (in-sample avg dev_std = 0.219)
NEC for r=0.1 all L1 = 0.402 +- 0.319 (in-sample avg dev_std = 0.219)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06625400000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.607
NEC for r=0.2 class 0.0 = 0.191 +- 0.366 (in-sample avg dev_std = 0.322)
NEC for r=0.2 class 1.0 = 0.635 +- 0.366 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all KL = 0.423 +- 0.366 (in-sample avg dev_std = 0.322)
NEC for r=0.2 all L1 = 0.437 +- 0.317 (in-sample avg dev_std = 0.322)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07111400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.595
NEC for r=0.4 class 0.0 = 0.195 +- 0.362 (in-sample avg dev_std = 0.391)
NEC for r=0.4 class 1.0 = 0.663 +- 0.362 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all KL = 0.453 +- 0.362 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all L1 = 0.454 +- 0.308 (in-sample avg dev_std = 0.391)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08048400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.59
NEC for r=0.8 class 0.0 = 0.197 +- 0.363 (in-sample avg dev_std = 0.417)
NEC for r=0.8 class 1.0 = 0.672 +- 0.363 (in-sample avg dev_std = 0.417)
NEC for r=0.8 all KL = 0.461 +- 0.363 (in-sample avg dev_std = 0.417)
NEC for r=0.8 all L1 = 0.46 +- 0.306 (in-sample avg dev_std = 0.417)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009109
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.004 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.152 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.048 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.079 +- 0.161 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093032
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.005 +- 0.142 (in-sample avg dev_std = 0.002)
NEC for r=0.1 class 1.0 = 0.166 +- 0.142 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all KL = 0.06 +- 0.142 (in-sample avg dev_std = 0.002)
NEC for r=0.1 all L1 = 0.086 +- 0.177 (in-sample avg dev_std = 0.002)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095222
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.005 +- 0.144 (in-sample avg dev_std = 0.014)
NEC for r=0.2 class 1.0 = 0.166 +- 0.144 (in-sample avg dev_std = 0.014)
NEC for r=0.2 all KL = 0.061 +- 0.144 (in-sample avg dev_std = 0.014)
NEC for r=0.2 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.014)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096158
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.005 +- 0.145 (in-sample avg dev_std = 0.012)
NEC for r=0.4 class 1.0 = 0.167 +- 0.145 (in-sample avg dev_std = 0.012)
NEC for r=0.4 all KL = 0.061 +- 0.145 (in-sample avg dev_std = 0.012)
NEC for r=0.4 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.012)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096514
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.005 +- 0.145 (in-sample avg dev_std = 0.015)
NEC for r=0.8 class 1.0 = 0.166 +- 0.145 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all KL = 0.061 +- 0.145 (in-sample avg dev_std = 0.015)
NEC for r=0.8 all L1 = 0.086 +- 0.178 (in-sample avg dev_std = 0.015)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0288246
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.633
NEC for r=0.05 class 0.0 = 0.127 +- 0.304 (in-sample avg dev_std = 0.071)
NEC for r=0.05 class 1.0 = 0.244 +- 0.304 (in-sample avg dev_std = 0.071)
NEC for r=0.05 all KL = 0.156 +- 0.304 (in-sample avg dev_std = 0.071)
NEC for r=0.05 all L1 = 0.185 +- 0.285 (in-sample avg dev_std = 0.071)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0367006
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.612
NEC for r=0.1 class 0.0 = 0.173 +- 0.347 (in-sample avg dev_std = 0.190)
NEC for r=0.1 class 1.0 = 0.33 +- 0.347 (in-sample avg dev_std = 0.190)
NEC for r=0.1 all KL = 0.225 +- 0.347 (in-sample avg dev_std = 0.190)
NEC for r=0.1 all L1 = 0.251 +- 0.313 (in-sample avg dev_std = 0.190)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.04739840000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.575
NEC for r=0.2 class 0.0 = 0.216 +- 0.373 (in-sample avg dev_std = 0.326)
NEC for r=0.2 class 1.0 = 0.434 +- 0.373 (in-sample avg dev_std = 0.326)
NEC for r=0.2 all KL = 0.309 +- 0.373 (in-sample avg dev_std = 0.326)
NEC for r=0.2 all L1 = 0.324 +- 0.325 (in-sample avg dev_std = 0.326)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0617976
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.56
NEC for r=0.4 class 0.0 = 0.238 +- 0.368 (in-sample avg dev_std = 0.433)
NEC for r=0.4 class 1.0 = 0.479 +- 0.368 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all KL = 0.354 +- 0.368 (in-sample avg dev_std = 0.433)
NEC for r=0.4 all L1 = 0.357 +- 0.313 (in-sample avg dev_std = 0.433)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07703
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.56
NEC for r=0.8 class 0.0 = 0.239 +- 0.357 (in-sample avg dev_std = 0.469)
NEC for r=0.8 class 1.0 = 0.49 +- 0.357 (in-sample avg dev_std = 0.469)
NEC for r=0.8 all KL = 0.369 +- 0.357 (in-sample avg dev_std = 0.469)
NEC for r=0.8 all L1 = 0.363 +- 0.302 (in-sample avg dev_std = 0.469)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 16:02:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:02:19 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.049
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.054
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.073
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.031
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.040
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.048664
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.486
SUFF_SIMPLE for r=0.05 class 0.0 = 0.81 +- 0.420 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.201 +- 0.420 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all KL = 0.407 +- 0.420 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.05 all L1 = 0.472 +- 0.339 (in-sample avg dev_std = 0.425)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05382
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.494
SUFF_SIMPLE for r=0.1 class 0.0 = 0.809 +- 0.419 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.205 +- 0.419 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all KL = 0.409 +- 0.419 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all L1 = 0.474 +- 0.339 (in-sample avg dev_std = 0.416)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06581000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.481
SUFF_SIMPLE for r=0.2 class 0.0 = 0.801 +- 0.421 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.201 +- 0.421 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 all KL = 0.406 +- 0.421 (in-sample avg dev_std = 0.395)
SUFF_SIMPLE for r=0.2 all L1 = 0.469 +- 0.343 (in-sample avg dev_std = 0.395)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07333600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.491
SUFF_SIMPLE for r=0.4 class 0.0 = 0.817 +- 0.427 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.212 +- 0.427 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.4 all KL = 0.427 +- 0.427 (in-sample avg dev_std = 0.368)
SUFF_SIMPLE for r=0.4 all L1 = 0.482 +- 0.350 (in-sample avg dev_std = 0.368)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08033200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.508
SUFF_SIMPLE for r=0.8 class 0.0 = 0.849 +- 0.440 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.256 +- 0.440 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 all KL = 0.479 +- 0.440 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.8 all L1 = 0.52 +- 0.369 (in-sample avg dev_std = 0.209)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099182
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.011)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.011)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0100374
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0100692
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.002)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.002)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0099902
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.030590999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.61
SUFF_SIMPLE for r=0.05 class 0.0 = 0.703 +- 0.390 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.426 +- 0.390 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.05 all KL = 0.419 +- 0.390 (in-sample avg dev_std = 0.553)
SUFF_SIMPLE for r=0.05 all L1 = 0.566 +- 0.308 (in-sample avg dev_std = 0.553)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0400254
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.607
SUFF_SIMPLE for r=0.1 class 0.0 = 0.707 +- 0.397 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.426 +- 0.397 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.1 all KL = 0.428 +- 0.397 (in-sample avg dev_std = 0.538)
SUFF_SIMPLE for r=0.1 all L1 = 0.568 +- 0.315 (in-sample avg dev_std = 0.538)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0519514
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.615
SUFF_SIMPLE for r=0.2 class 0.0 = 0.711 +- 0.410 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.442 +- 0.410 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.2 all KL = 0.45 +- 0.410 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.2 all L1 = 0.578 +- 0.326 (in-sample avg dev_std = 0.516)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06496379999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.61
SUFF_SIMPLE for r=0.4 class 0.0 = 0.721 +- 0.420 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.443 +- 0.420 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.4 all KL = 0.465 +- 0.420 (in-sample avg dev_std = 0.494)
SUFF_SIMPLE for r=0.4 all L1 = 0.583 +- 0.336 (in-sample avg dev_std = 0.494)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079061
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.671
SUFF_SIMPLE for r=0.8 class 0.0 = 0.773 +- 0.430 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.587 +- 0.430 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.8 all KL = 0.621 +- 0.430 (in-sample avg dev_std = 0.293)
SUFF_SIMPLE for r=0.8 all L1 = 0.681 +- 0.351 (in-sample avg dev_std = 0.293)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.048664
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.77
NEC for r=0.05 class 0.0 = 0.118 +- 0.371 (in-sample avg dev_std = 0.060)
NEC for r=0.05 class 1.0 = 0.384 +- 0.371 (in-sample avg dev_std = 0.060)
NEC for r=0.05 all KL = 0.264 +- 0.371 (in-sample avg dev_std = 0.060)
NEC for r=0.05 all L1 = 0.265 +- 0.326 (in-sample avg dev_std = 0.060)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05382
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.695
NEC for r=0.1 class 0.0 = 0.139 +- 0.395 (in-sample avg dev_std = 0.285)
NEC for r=0.1 class 1.0 = 0.52 +- 0.395 (in-sample avg dev_std = 0.285)
NEC for r=0.1 all KL = 0.376 +- 0.395 (in-sample avg dev_std = 0.285)
NEC for r=0.1 all L1 = 0.35 +- 0.333 (in-sample avg dev_std = 0.285)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06581000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.647
NEC for r=0.2 class 0.0 = 0.153 +- 0.400 (in-sample avg dev_std = 0.409)
NEC for r=0.2 class 1.0 = 0.606 +- 0.400 (in-sample avg dev_std = 0.409)
NEC for r=0.2 all KL = 0.453 +- 0.400 (in-sample avg dev_std = 0.409)
NEC for r=0.2 all L1 = 0.404 +- 0.326 (in-sample avg dev_std = 0.409)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07333600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.628
NEC for r=0.4 class 0.0 = 0.157 +- 0.396 (in-sample avg dev_std = 0.500)
NEC for r=0.4 class 1.0 = 0.657 +- 0.396 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all KL = 0.502 +- 0.396 (in-sample avg dev_std = 0.500)
NEC for r=0.4 all L1 = 0.434 +- 0.314 (in-sample avg dev_std = 0.500)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08033200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.621
NEC for r=0.8 class 0.0 = 0.16 +- 0.399 (in-sample avg dev_std = 0.545)
NEC for r=0.8 class 1.0 = 0.675 +- 0.399 (in-sample avg dev_std = 0.545)
NEC for r=0.8 all KL = 0.522 +- 0.399 (in-sample avg dev_std = 0.545)
NEC for r=0.8 all L1 = 0.445 +- 0.308 (in-sample avg dev_std = 0.545)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099182
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.002 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.165 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.062 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.084 +- 0.189 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0100374
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.005)
NEC for r=0.1 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.005)
NEC for r=0.1 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.005)
NEC for r=0.1 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.005)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0100692
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.015)
NEC for r=0.2 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.015)
NEC for r=0.2 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.015)
NEC for r=0.2 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.015)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0099902
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.014)
NEC for r=0.4 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.014)
NEC for r=0.4 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.014)
NEC for r=0.4 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.014)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.011)
NEC for r=0.8 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.011)
NEC for r=0.8 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.011)
NEC for r=0.8 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.011)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.030590999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.73
NEC for r=0.05 class 0.0 = 0.103 +- 0.317 (in-sample avg dev_std = 0.092)
NEC for r=0.05 class 1.0 = 0.178 +- 0.317 (in-sample avg dev_std = 0.092)
NEC for r=0.05 all KL = 0.151 +- 0.317 (in-sample avg dev_std = 0.092)
NEC for r=0.05 all L1 = 0.14 +- 0.272 (in-sample avg dev_std = 0.092)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0400254
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.71
NEC for r=0.1 class 0.0 = 0.149 +- 0.377 (in-sample avg dev_std = 0.229)
NEC for r=0.1 class 1.0 = 0.269 +- 0.377 (in-sample avg dev_std = 0.229)
NEC for r=0.1 all KL = 0.242 +- 0.377 (in-sample avg dev_std = 0.229)
NEC for r=0.1 all L1 = 0.208 +- 0.310 (in-sample avg dev_std = 0.229)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0519514
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.677
NEC for r=0.2 class 0.0 = 0.191 +- 0.408 (in-sample avg dev_std = 0.364)
NEC for r=0.2 class 1.0 = 0.366 +- 0.408 (in-sample avg dev_std = 0.364)
NEC for r=0.2 all KL = 0.346 +- 0.408 (in-sample avg dev_std = 0.364)
NEC for r=0.2 all L1 = 0.278 +- 0.326 (in-sample avg dev_std = 0.364)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06496379999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.655
NEC for r=0.4 class 0.0 = 0.211 +- 0.403 (in-sample avg dev_std = 0.456)
NEC for r=0.4 class 1.0 = 0.418 +- 0.403 (in-sample avg dev_std = 0.456)
NEC for r=0.4 all KL = 0.411 +- 0.403 (in-sample avg dev_std = 0.456)
NEC for r=0.4 all L1 = 0.313 +- 0.319 (in-sample avg dev_std = 0.456)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079061
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.648
NEC for r=0.8 class 0.0 = 0.231 +- 0.382 (in-sample avg dev_std = 0.525)
NEC for r=0.8 class 1.0 = 0.447 +- 0.382 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all KL = 0.466 +- 0.382 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all L1 = 0.337 +- 0.298 (in-sample avg dev_std = 0.525)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 16:18:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:18:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.051
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.062
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.070
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.082
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.030
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.050936
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.666
SUFF_SIMPLE for r=0.05 class 0.0 = 0.733 +- 0.385 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.475 +- 0.385 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.05 all KL = 0.46 +- 0.385 (in-sample avg dev_std = 0.643)
SUFF_SIMPLE for r=0.05 all L1 = 0.59 +- 0.291 (in-sample avg dev_std = 0.643)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.062052
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.672
SUFF_SIMPLE for r=0.1 class 0.0 = 0.729 +- 0.379 (in-sample avg dev_std = 0.636)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.48 +- 0.379 (in-sample avg dev_std = 0.636)
SUFF_SIMPLE for r=0.1 all KL = 0.46 +- 0.379 (in-sample avg dev_std = 0.636)
SUFF_SIMPLE for r=0.1 all L1 = 0.591 +- 0.288 (in-sample avg dev_std = 0.636)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070206
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.661
SUFF_SIMPLE for r=0.2 class 0.0 = 0.732 +- 0.387 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.473 +- 0.387 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.2 all KL = 0.468 +- 0.387 (in-sample avg dev_std = 0.612)
SUFF_SIMPLE for r=0.2 all L1 = 0.589 +- 0.297 (in-sample avg dev_std = 0.612)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.077318
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.644
SUFF_SIMPLE for r=0.4 class 0.0 = 0.728 +- 0.403 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.485 +- 0.403 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.4 all KL = 0.492 +- 0.403 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.4 all L1 = 0.593 +- 0.315 (in-sample avg dev_std = 0.551)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.082224
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.757
SUFF_SIMPLE for r=0.8 class 0.0 = 0.867 +- 0.400 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.61 +- 0.400 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.8 all KL = 0.69 +- 0.400 (in-sample avg dev_std = 0.311)
SUFF_SIMPLE for r=0.8 all L1 = 0.724 +- 0.331 (in-sample avg dev_std = 0.311)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.206 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.836 +- 0.206 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.05 all KL = 0.926 +- 0.206 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.05 all L1 = 0.916 +- 0.211 (in-sample avg dev_std = 0.078)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009300999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.206 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.836 +- 0.206 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.206 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.1 all L1 = 0.916 +- 0.211 (in-sample avg dev_std = 0.076)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094492
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.206 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.206 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.206 (in-sample avg dev_std = 0.076)
SUFF_SIMPLE for r=0.2 all L1 = 0.916 +- 0.211 (in-sample avg dev_std = 0.076)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095836
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.499
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.206 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.835 +- 0.206 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.4 all KL = 0.927 +- 0.206 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.4 all L1 = 0.916 +- 0.211 (in-sample avg dev_std = 0.074)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009633
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.204 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.204 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.8 all KL = 0.929 +- 0.204 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.8 all L1 = 0.918 +- 0.210 (in-sample avg dev_std = 0.024)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029973400000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.67
SUFF_SIMPLE for r=0.05 class 0.0 = 0.713 +- 0.392 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.67 +- 0.392 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.05 all KL = 0.56 +- 0.392 (in-sample avg dev_std = 0.572)
SUFF_SIMPLE for r=0.05 all L1 = 0.692 +- 0.301 (in-sample avg dev_std = 0.572)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0369356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.663
SUFF_SIMPLE for r=0.1 class 0.0 = 0.698 +- 0.394 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.69 +- 0.394 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.1 all KL = 0.576 +- 0.394 (in-sample avg dev_std = 0.533)
SUFF_SIMPLE for r=0.1 all L1 = 0.694 +- 0.311 (in-sample avg dev_std = 0.533)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0467624
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.657
SUFF_SIMPLE for r=0.2 class 0.0 = 0.691 +- 0.402 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.686 +- 0.402 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.2 all KL = 0.576 +- 0.402 (in-sample avg dev_std = 0.505)
SUFF_SIMPLE for r=0.2 all L1 = 0.688 +- 0.320 (in-sample avg dev_std = 0.505)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060411599999999996
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.649
SUFF_SIMPLE for r=0.4 class 0.0 = 0.705 +- 0.415 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.665 +- 0.415 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.4 all KL = 0.584 +- 0.415 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.4 all L1 = 0.685 +- 0.331 (in-sample avg dev_std = 0.476)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07727360000000001
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.649
SUFF_SIMPLE for r=0.8 class 0.0 = 0.839 +- 0.408 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.704 +- 0.408 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.8 all KL = 0.74 +- 0.408 (in-sample avg dev_std = 0.204)
SUFF_SIMPLE for r=0.8 all L1 = 0.772 +- 0.344 (in-sample avg dev_std = 0.204)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.050936
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.93
NEC for r=0.05 class 0.0 = 0.077 +- 0.209 (in-sample avg dev_std = 0.045)
NEC for r=0.05 class 1.0 = 0.106 +- 0.209 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all KL = 0.077 +- 0.209 (in-sample avg dev_std = 0.045)
NEC for r=0.05 all L1 = 0.093 +- 0.202 (in-sample avg dev_std = 0.045)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.062052
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.895
NEC for r=0.1 class 0.0 = 0.109 +- 0.285 (in-sample avg dev_std = 0.217)
NEC for r=0.1 class 1.0 = 0.181 +- 0.285 (in-sample avg dev_std = 0.217)
NEC for r=0.1 all KL = 0.15 +- 0.285 (in-sample avg dev_std = 0.217)
NEC for r=0.1 all L1 = 0.149 +- 0.246 (in-sample avg dev_std = 0.217)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070206
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.852
NEC for r=0.2 class 0.0 = 0.144 +- 0.333 (in-sample avg dev_std = 0.339)
NEC for r=0.2 class 1.0 = 0.235 +- 0.333 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all KL = 0.224 +- 0.333 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all L1 = 0.194 +- 0.267 (in-sample avg dev_std = 0.339)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.077318
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.817
NEC for r=0.4 class 0.0 = 0.168 +- 0.348 (in-sample avg dev_std = 0.460)
NEC for r=0.4 class 1.0 = 0.289 +- 0.348 (in-sample avg dev_std = 0.460)
NEC for r=0.4 all KL = 0.294 +- 0.348 (in-sample avg dev_std = 0.460)
NEC for r=0.4 all L1 = 0.235 +- 0.265 (in-sample avg dev_std = 0.460)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.082224
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.832
NEC for r=0.8 class 0.0 = 0.163 +- 0.342 (in-sample avg dev_std = 0.504)
NEC for r=0.8 class 1.0 = 0.304 +- 0.342 (in-sample avg dev_std = 0.504)
NEC for r=0.8 all KL = 0.316 +- 0.342 (in-sample avg dev_std = 0.504)
NEC for r=0.8 all L1 = 0.241 +- 0.248 (in-sample avg dev_std = 0.504)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.529
NEC for r=0.05 class 0.0 = 0.001 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.116 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.038 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.059 +- 0.158 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009300999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.51
NEC for r=0.1 class 0.0 = 0.001 +- 0.176 (in-sample avg dev_std = 0.031)
NEC for r=0.1 class 1.0 = 0.145 +- 0.176 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.059 +- 0.176 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.074 +- 0.192 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094492
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.507
NEC for r=0.2 class 0.0 = 0.002 +- 0.190 (in-sample avg dev_std = 0.122)
NEC for r=0.2 class 1.0 = 0.157 +- 0.190 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all KL = 0.069 +- 0.190 (in-sample avg dev_std = 0.122)
NEC for r=0.2 all L1 = 0.08 +- 0.199 (in-sample avg dev_std = 0.122)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095836
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.507
NEC for r=0.4 class 0.0 = 0.002 +- 0.192 (in-sample avg dev_std = 0.137)
NEC for r=0.4 class 1.0 = 0.158 +- 0.192 (in-sample avg dev_std = 0.137)
NEC for r=0.4 all KL = 0.071 +- 0.192 (in-sample avg dev_std = 0.137)
NEC for r=0.4 all L1 = 0.081 +- 0.199 (in-sample avg dev_std = 0.137)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009633
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.507
NEC for r=0.8 class 0.0 = 0.002 +- 0.190 (in-sample avg dev_std = 0.135)
NEC for r=0.8 class 1.0 = 0.157 +- 0.190 (in-sample avg dev_std = 0.135)
NEC for r=0.8 all KL = 0.07 +- 0.190 (in-sample avg dev_std = 0.135)
NEC for r=0.8 all L1 = 0.08 +- 0.198 (in-sample avg dev_std = 0.135)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029973400000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.749
NEC for r=0.05 class 0.0 = 0.08 +- 0.244 (in-sample avg dev_std = 0.059)
NEC for r=0.05 class 1.0 = 0.077 +- 0.244 (in-sample avg dev_std = 0.059)
NEC for r=0.05 all KL = 0.079 +- 0.244 (in-sample avg dev_std = 0.059)
NEC for r=0.05 all L1 = 0.079 +- 0.219 (in-sample avg dev_std = 0.059)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0369356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.741
NEC for r=0.1 class 0.0 = 0.112 +- 0.298 (in-sample avg dev_std = 0.157)
NEC for r=0.1 class 1.0 = 0.115 +- 0.298 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all KL = 0.123 +- 0.298 (in-sample avg dev_std = 0.157)
NEC for r=0.1 all L1 = 0.113 +- 0.255 (in-sample avg dev_std = 0.157)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0467624
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.736
NEC for r=0.2 class 0.0 = 0.163 +- 0.353 (in-sample avg dev_std = 0.261)
NEC for r=0.2 class 1.0 = 0.16 +- 0.353 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all KL = 0.193 +- 0.353 (in-sample avg dev_std = 0.261)
NEC for r=0.2 all L1 = 0.162 +- 0.289 (in-sample avg dev_std = 0.261)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060411599999999996
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.7
NEC for r=0.4 class 0.0 = 0.206 +- 0.383 (in-sample avg dev_std = 0.355)
NEC for r=0.4 class 1.0 = 0.215 +- 0.383 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all KL = 0.271 +- 0.383 (in-sample avg dev_std = 0.355)
NEC for r=0.4 all L1 = 0.211 +- 0.307 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07727360000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.7
NEC for r=0.8 class 0.0 = 0.238 +- 0.383 (in-sample avg dev_std = 0.482)
NEC for r=0.8 class 1.0 = 0.231 +- 0.383 (in-sample avg dev_std = 0.482)
NEC for r=0.8 all KL = 0.329 +- 0.383 (in-sample avg dev_std = 0.482)
NEC for r=0.8 all L1 = 0.235 +- 0.292 (in-sample avg dev_std = 0.482)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.473, 0.463, 0.481, 0.5, 0.622], 'all_L1': [0.549, 0.539, 0.549, 0.558, 0.642]}), defaultdict(<class 'list'>, {'all_KL': [0.371, 0.383, 0.39, 0.395, 0.509], 'all_L1': [0.492, 0.499, 0.502, 0.503, 0.586]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.424, 0.435, 0.442, 0.55], 'all_L1': [0.521, 0.522, 0.528, 0.529, 0.603]}), defaultdict(<class 'list'>, {'all_KL': [0.422, 0.425, 0.425, 0.446, 0.51], 'all_L1': [0.502, 0.501, 0.497, 0.51, 0.556]}), defaultdict(<class 'list'>, {'all_KL': [0.418, 0.43, 0.428, 0.441, 0.517], 'all_L1': [0.49, 0.498, 0.495, 0.5, 0.558]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.437, 0.444, 0.447, 0.489], 'all_L1': [0.477, 0.476, 0.48, 0.478, 0.514]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.449, 0.457, 0.451, 0.537], 'all_L1': [0.512, 0.514, 0.518, 0.514, 0.579]}), defaultdict(<class 'list'>, {'all_KL': [0.458, 0.457, 0.461, 0.464, 0.491], 'all_L1': [0.467, 0.466, 0.469, 0.47, 0.491]}), defaultdict(<class 'list'>, {'all_KL': [0.407, 0.409, 0.406, 0.427, 0.479], 'all_L1': [0.472, 0.474, 0.469, 0.482, 0.52]}), defaultdict(<class 'list'>, {'all_KL': [0.46, 0.46, 0.468, 0.492, 0.69], 'all_L1': [0.59, 0.591, 0.589, 0.593, 0.724]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.121, 0.207, 0.265, 0.335, 0.342], 'all_L1': [0.151, 0.22, 0.258, 0.301, 0.302]}), defaultdict(<class 'list'>, {'all_KL': [0.251, 0.358, 0.469, 0.513, 0.526], 'all_L1': [0.232, 0.301, 0.365, 0.386, 0.39]}), defaultdict(<class 'list'>, {'all_KL': [0.195, 0.303, 0.376, 0.438, 0.465], 'all_L1': [0.195, 0.275, 0.319, 0.35, 0.364]}), defaultdict(<class 'list'>, {'all_KL': [0.205, 0.314, 0.412, 0.446, 0.485], 'all_L1': [0.21, 0.292, 0.361, 0.372, 0.393]}), defaultdict(<class 'list'>, {'all_KL': [0.236, 0.341, 0.416, 0.474, 0.499], 'all_L1': [0.234, 0.317, 0.368, 0.402, 0.414]}), defaultdict(<class 'list'>, {'all_KL': [0.271, 0.39, 0.455, 0.494, 0.5], 'all_L1': [0.288, 0.381, 0.429, 0.456, 0.457]}), defaultdict(<class 'list'>, {'all_KL': [0.212, 0.32, 0.391, 0.433, 0.464], 'all_L1': [0.218, 0.3, 0.344, 0.367, 0.386]}), defaultdict(<class 'list'>, {'all_KL': [0.247, 0.369, 0.423, 0.453, 0.461], 'all_L1': [0.309, 0.402, 0.437, 0.454, 0.46]}), defaultdict(<class 'list'>, {'all_KL': [0.264, 0.376, 0.453, 0.502, 0.522], 'all_L1': [0.265, 0.35, 0.404, 0.434, 0.445]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.15, 0.224, 0.294, 0.316], 'all_L1': [0.093, 0.149, 0.194, 0.235, 0.241]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.936, 0.936, 0.935, 0.936, 0.936], 'all_L1': [0.919, 0.919, 0.919, 0.919, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.905, 0.904, 0.904, 0.904, 0.913], 'all_L1': [0.901, 0.9, 0.9, 0.9, 0.904]}), defaultdict(<class 'list'>, {'all_KL': [0.926, 0.926, 0.926, 0.927, 0.93], 'all_L1': [0.921, 0.92, 0.921, 0.921, 0.923]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.953, 0.953, 0.953, 0.953], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.926, 0.926, 0.926, 0.926, 0.926], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.968, 0.968, 0.968, 0.968], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.964, 0.964, 0.964, 0.964], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.939, 0.939, 0.939, 0.939, 0.939], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.934, 0.934, 0.934, 0.934, 0.934], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.926, 0.926, 0.926, 0.927, 0.929], 'all_L1': [0.916, 0.916, 0.916, 0.916, 0.918]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.037, 0.057, 0.061, 0.061, 0.061], 'all_L1': [0.063, 0.076, 0.079, 0.079, 0.079]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.084, 0.092, 0.092, 0.093], 'all_L1': [0.086, 0.094, 0.097, 0.097, 0.097]}), defaultdict(<class 'list'>, {'all_KL': [0.052, 0.066, 0.071, 0.072, 0.072], 'all_L1': [0.064, 0.074, 0.077, 0.077, 0.077]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.045, 0.046, 0.046, 0.046], 'all_L1': [0.047, 0.055, 0.055, 0.055, 0.055]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.071, 0.074, 0.073, 0.074], 'all_L1': [0.078, 0.088, 0.09, 0.09, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.032, 0.032, 0.032, 0.032], 'all_L1': [0.044, 0.046, 0.046, 0.046, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.035, 0.036, 0.036, 0.036], 'all_L1': [0.041, 0.045, 0.045, 0.045, 0.045]}), defaultdict(<class 'list'>, {'all_KL': [0.048, 0.06, 0.061, 0.061, 0.061], 'all_L1': [0.079, 0.086, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.062, 0.066, 0.066, 0.066, 0.066], 'all_L1': [0.084, 0.086, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.038, 0.059, 0.069, 0.071, 0.07], 'all_L1': [0.059, 0.074, 0.08, 0.081, 0.08]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.625, 0.633, 0.649, 0.675, 0.81], 'all_L1': [0.682, 0.682, 0.687, 0.701, 0.804]}), defaultdict(<class 'list'>, {'all_KL': [0.393, 0.403, 0.418, 0.439, 0.585], 'all_L1': [0.578, 0.581, 0.583, 0.591, 0.67]}), defaultdict(<class 'list'>, {'all_KL': [0.46, 0.473, 0.48, 0.487, 0.613], 'all_L1': [0.591, 0.595, 0.597, 0.597, 0.662]}), defaultdict(<class 'list'>, {'all_KL': [0.384, 0.403, 0.42, 0.424, 0.516], 'all_L1': [0.515, 0.522, 0.529, 0.524, 0.579]}), defaultdict(<class 'list'>, {'all_KL': [0.406, 0.429, 0.446, 0.458, 0.532], 'all_L1': [0.514, 0.523, 0.527, 0.531, 0.577]}), defaultdict(<class 'list'>, {'all_KL': [0.451, 0.469, 0.489, 0.503, 0.607], 'all_L1': [0.552, 0.557, 0.563, 0.567, 0.638]}), defaultdict(<class 'list'>, {'all_KL': [0.439, 0.441, 0.447, 0.454, 0.582], 'all_L1': [0.553, 0.553, 0.556, 0.56, 0.64]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.555, 0.559, 0.567, 0.65], 'all_L1': [0.554, 0.552, 0.554, 0.558, 0.624]}), defaultdict(<class 'list'>, {'all_KL': [0.419, 0.428, 0.45, 0.465, 0.621], 'all_L1': [0.566, 0.568, 0.578, 0.583, 0.681]}), defaultdict(<class 'list'>, {'all_KL': [0.56, 0.576, 0.576, 0.584, 0.74], 'all_L1': [0.692, 0.694, 0.688, 0.685, 0.772]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.076, 0.115, 0.168, 0.224, 0.291], 'all_L1': [0.09, 0.126, 0.167, 0.21, 0.249]}), defaultdict(<class 'list'>, {'all_KL': [0.151, 0.243, 0.352, 0.445, 0.49], 'all_L1': [0.127, 0.19, 0.259, 0.305, 0.319]}), defaultdict(<class 'list'>, {'all_KL': [0.132, 0.215, 0.302, 0.368, 0.395], 'all_L1': [0.122, 0.187, 0.25, 0.289, 0.3]}), defaultdict(<class 'list'>, {'all_KL': [0.175, 0.282, 0.379, 0.436, 0.471], 'all_L1': [0.157, 0.24, 0.309, 0.344, 0.358]}), defaultdict(<class 'list'>, {'all_KL': [0.187, 0.289, 0.383, 0.433, 0.475], 'all_L1': [0.178, 0.261, 0.327, 0.356, 0.374]}), defaultdict(<class 'list'>, {'all_KL': [0.154, 0.248, 0.336, 0.389, 0.427], 'all_L1': [0.154, 0.232, 0.297, 0.331, 0.345]}), defaultdict(<class 'list'>, {'all_KL': [0.164, 0.261, 0.371, 0.435, 0.456], 'all_L1': [0.151, 0.226, 0.301, 0.337, 0.346]}), defaultdict(<class 'list'>, {'all_KL': [0.156, 0.225, 0.309, 0.354, 0.369], 'all_L1': [0.185, 0.251, 0.324, 0.357, 0.363]}), defaultdict(<class 'list'>, {'all_KL': [0.151, 0.242, 0.346, 0.411, 0.466], 'all_L1': [0.14, 0.208, 0.278, 0.313, 0.337]}), defaultdict(<class 'list'>, {'all_KL': [0.079, 0.123, 0.193, 0.271, 0.329], 'all_L1': [0.079, 0.113, 0.162, 0.211, 0.235]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.507 +- 0.036, 0.508 +- 0.035, 0.510 +- 0.036, 0.514 +- 0.036, 0.577 +- 0.065
suff_simple class all_KL  =  0.431 +- 0.028, 0.434 +- 0.024, 0.440 +- 0.027, 0.451 +- 0.029, 0.539 +- 0.064
[[0.6072499752044678, 0.5977500081062317, 0.5987499952316284, 0.6035000085830688, 0.6707500219345093], [0.5404999852180481, 0.5450000166893005, 0.543749988079071, 0.5427500009536743, 0.6032500267028809], [0.5602499842643738, 0.559499979019165, 0.5637500286102295, 0.5602499842643738, 0.609499990940094], [0.5379999876022339, 0.5327500104904175, 0.5222499966621399, 0.5264999866485596, 0.5727499723434448], [0.5115000009536743, 0.5249999761581421, 0.5239999890327454, 0.5210000276565552, 0.5705000162124634], [0.4650000035762787, 0.4650000035762787, 0.4717499911785126, 0.4622499942779541, 0.500249981880188], [0.5249999761581421, 0.5247499942779541, 0.5254999995231628, 0.5189999938011169, 0.5805000066757202], [0.4675000011920929, 0.4684999883174896, 0.47099998593330383, 0.4715000092983246, 0.4945000112056732], [0.48625001311302185, 0.49424999952316284, 0.4807499945163727, 0.49149999022483826, 0.5082499980926514], [0.6660000085830688, 0.672249972820282, 0.6607499718666077, 0.643750011920929, 0.7570000290870667]]
[[0.473, 0.463, 0.481, 0.5, 0.622], [0.371, 0.383, 0.39, 0.395, 0.509], [0.422, 0.424, 0.435, 0.442, 0.55], [0.422, 0.425, 0.425, 0.446, 0.51], [0.418, 0.43, 0.428, 0.441, 0.517], [0.437, 0.437, 0.444, 0.447, 0.489], [0.446, 0.449, 0.457, 0.451, 0.537], [0.458, 0.457, 0.461, 0.464, 0.491], [0.407, 0.409, 0.406, 0.427, 0.479], [0.46, 0.46, 0.468, 0.492, 0.69]]
suff_simple_acc_int  =  0.537 +- 0.060, 0.538 +- 0.059, 0.536 +- 0.057, 0.534 +- 0.054, 0.587 +- 0.077
nec class all_L1  =  0.219 +- 0.060, 0.299 +- 0.070, 0.348 +- 0.072, 0.376 +- 0.065, 0.385 +- 0.066
nec class all_KL  =  0.208 +- 0.060, 0.313 +- 0.073, 0.388 +- 0.077, 0.438 +- 0.068, 0.458 +- 0.068
[[0.8939999938011169, 0.827750027179718, 0.8034999966621399, 0.7727500200271606, 0.7770000100135803], [0.7982500195503235, 0.7427499890327454, 0.6930000185966492, 0.6875, 0.6892499923706055], [0.8317499756813049, 0.7462499737739563, 0.7287499904632568, 0.7005000114440918, 0.702750027179718], [0.8077499866485596, 0.7392500042915344, 0.690750002861023, 0.6892499923706055, 0.6747499704360962], [0.7832499742507935, 0.7102500200271606, 0.6727499961853027, 0.6520000100135803, 0.6507499814033508], [0.734000027179718, 0.6449999809265137, 0.6002500057220459, 0.578249990940094, 0.5845000147819519], [0.7947499752044678, 0.715749979019165, 0.6884999871253967, 0.6812499761581421, 0.6685000061988831], [0.7307500243186951, 0.6320000290870667, 0.6065000295639038, 0.5952500104904175, 0.5897499918937683], [0.7695000171661377, 0.6945000290870667, 0.6470000147819519, 0.6284999847412109, 0.6207500100135803], [0.9297500252723694, 0.8947499990463257, 0.8517500162124634, 0.8174999952316284, 0.8324999809265137]]
[[0.121, 0.207, 0.265, 0.335, 0.342], [0.251, 0.358, 0.469, 0.513, 0.526], [0.195, 0.303, 0.376, 0.438, 0.465], [0.205, 0.314, 0.412, 0.446, 0.485], [0.236, 0.341, 0.416, 0.474, 0.499], [0.271, 0.39, 0.455, 0.494, 0.5], [0.212, 0.32, 0.391, 0.433, 0.464], [0.247, 0.369, 0.423, 0.453, 0.461], [0.264, 0.376, 0.453, 0.502, 0.522], [0.077, 0.15, 0.224, 0.294, 0.316]]
nec_acc_int  =  0.807 +- 0.060, 0.735 +- 0.075, 0.698 +- 0.076, 0.680 +- 0.070, 0.679 +- 0.074

Eval split val
suff_simple class all_L1  =  0.925 +- 0.018, 0.924 +- 0.018, 0.925 +- 0.018, 0.925 +- 0.018, 0.925 +- 0.017
suff_simple class all_KL  =  0.938 +- 0.018, 0.938 +- 0.018, 0.938 +- 0.018, 0.938 +- 0.018, 0.939 +- 0.016
[[0.4966000020503998, 0.4966000020503998, 0.4965749979019165, 0.49662500619888306, 0.4970499873161316], [0.5002250075340271, 0.4997499883174896, 0.5006999969482422, 0.5001749992370605, 0.5006999969482422], [0.49822500348091125, 0.49729999899864197, 0.4984999895095825, 0.498075008392334, 0.4994249939918518], [0.4961250126361847, 0.4960249960422516, 0.4959999918937683, 0.49605000019073486, 0.4959999918937683], [0.4960249960422516, 0.49597498774528503, 0.49605000019073486, 0.49607500433921814, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4960249960422516, 0.49605000019073486, 0.4960249960422516, 0.49605000019073486, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.49605000019073486, 0.4960249960422516, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.49810001254081726, 0.4978500008583069, 0.498324990272522, 0.49867498874664307, 0.4988749921321869]]
[[0.936, 0.936, 0.935, 0.936, 0.936], [0.905, 0.904, 0.904, 0.904, 0.913], [0.926, 0.926, 0.926, 0.927, 0.93], [0.953, 0.953, 0.953, 0.953, 0.953], [0.926, 0.926, 0.926, 0.926, 0.926], [0.968, 0.968, 0.968, 0.968, 0.968], [0.964, 0.964, 0.964, 0.964, 0.964], [0.939, 0.939, 0.939, 0.939, 0.939], [0.934, 0.934, 0.934, 0.934, 0.934], [0.926, 0.926, 0.926, 0.927, 0.929]]
suff_simple_acc_int  =  0.497 +- 0.001, 0.497 +- 0.001, 0.497 +- 0.002, 0.497 +- 0.001, 0.497 +- 0.002
nec class all_L1  =  0.065 +- 0.016, 0.072 +- 0.017, 0.074 +- 0.018, 0.074 +- 0.018, 0.074 +- 0.018
nec class all_KL  =  0.046 +- 0.014, 0.057 +- 0.015, 0.061 +- 0.017, 0.061 +- 0.017, 0.061 +- 0.018
[[0.5127999782562256, 0.5010499954223633, 0.4993250072002411, 0.49912500381469727, 0.49970000982284546], [0.5138000249862671, 0.5039250254631042, 0.5035250186920166, 0.5041750073432922, 0.5047749876976013], [0.5171999931335449, 0.5071750283241272, 0.5041249990463257, 0.5039499998092651, 0.5041750073432922], [0.5058000087738037, 0.49707499146461487, 0.49729999899864197, 0.49709999561309814, 0.4973999857902527], [0.5073999762535095, 0.4982999861240387, 0.49787500500679016, 0.4974749982357025, 0.4978500008583069], [0.4968000054359436, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4960249960422516], [0.4991999864578247, 0.49662500619888306, 0.49627500772476196, 0.4966750144958496, 0.4964999854564667], [0.4991999864578247, 0.4959999918937683, 0.4960249960422516, 0.4960249960422516, 0.49605000019073486], [0.4986000061035156, 0.49619999527931213, 0.4961000084877014, 0.4961000084877014, 0.4959999918937683], [0.5285999774932861, 0.5095250010490417, 0.5068749785423279, 0.5065000057220459, 0.5070250034332275]]
[[0.037, 0.057, 0.061, 0.061, 0.061], [0.074, 0.084, 0.092, 0.092, 0.093], [0.052, 0.066, 0.071, 0.072, 0.072], [0.033, 0.045, 0.046, 0.046, 0.046], [0.055, 0.071, 0.074, 0.073, 0.074], [0.028, 0.032, 0.032, 0.032, 0.032], [0.029, 0.035, 0.036, 0.036, 0.036], [0.048, 0.06, 0.061, 0.061, 0.061], [0.062, 0.066, 0.066, 0.066, 0.066], [0.038, 0.059, 0.069, 0.071, 0.07]]
nec_acc_int  =  0.508 +- 0.010, 0.500 +- 0.005, 0.499 +- 0.004, 0.499 +- 0.004, 0.500 +- 0.004

Eval split test
suff_simple class all_L1  =  0.580 +- 0.058, 0.583 +- 0.057, 0.586 +- 0.055, 0.590 +- 0.056, 0.665 +- 0.070
suff_simple class all_KL  =  0.469 +- 0.078, 0.481 +- 0.076, 0.493 +- 0.073, 0.506 +- 0.075, 0.626 +- 0.085
[[0.6723284125328064, 0.6683260202407837, 0.6637482643127441, 0.6652241349220276, 0.7191079258918762], [0.6265759468078613, 0.6291024684906006, 0.6243746280670166, 0.6169952154159546, 0.6498796343803406], [0.6431859135627747, 0.6449869871139526, 0.6390834450721741, 0.6327546238899231, 0.6420443058013916], [0.5744696855545044, 0.5736691951751709, 0.5718181133270264, 0.5456523895263672, 0.5570074319839478], [0.5850260257720947, 0.5872023105621338, 0.5760956406593323, 0.5570341944694519, 0.5682708024978638], [0.5898538827896118, 0.5862767696380615, 0.5863768458366394, 0.5801730751991272, 0.6060819029808044], [0.5847508311271667, 0.5846508145332336, 0.5837002396583557, 0.5858514904975891, 0.612861156463623], [0.5395737290382385, 0.5407744646072388, 0.537447452545166, 0.5400740504264832, 0.5783413648605347], [0.6101911067962646, 0.6069391369819641, 0.6145937442779541, 0.6102161407470703, 0.6711885929107666], [0.6700520515441895, 0.6633229851722717, 0.6574194431304932, 0.6490394473075867, 0.6488528251647949]]
[[0.625, 0.633, 0.649, 0.675, 0.81], [0.393, 0.403, 0.418, 0.439, 0.585], [0.46, 0.473, 0.48, 0.487, 0.613], [0.384, 0.403, 0.42, 0.424, 0.516], [0.406, 0.429, 0.446, 0.458, 0.532], [0.451, 0.469, 0.489, 0.503, 0.607], [0.439, 0.441, 0.447, 0.454, 0.582], [0.555, 0.555, 0.559, 0.567, 0.65], [0.419, 0.428, 0.45, 0.465, 0.621], [0.56, 0.576, 0.576, 0.584, 0.74]]
suff_simple_acc_int  =  0.610 +- 0.041, 0.609 +- 0.040, 0.605 +- 0.039, 0.598 +- 0.041, 0.625 +- 0.048
nec class all_L1  =  0.138 +- 0.033, 0.203 +- 0.048, 0.267 +- 0.057, 0.305 +- 0.052, 0.323 +- 0.045
nec class all_KL  =  0.143 +- 0.035, 0.224 +- 0.057, 0.314 +- 0.072, 0.377 +- 0.072, 0.417 +- 0.065
[[0.7419451475143433, 0.7360416054725647, 0.7246097922325134, 0.6983439922332764, 0.6967430710792542], [0.7348909378051758, 0.7159045338630676, 0.6808084845542908, 0.6626476049423218, 0.6630978584289551], [0.7666599750518799, 0.7467730641365051, 0.7096007466316223, 0.6870372295379639, 0.6834350824356079], [0.7020712494850159, 0.669426679611206, 0.6376826167106628, 0.6251250505447388, 0.6412847638130188], [0.6912397146224976, 0.6562937498092651, 0.627451479434967, 0.6205723285675049, 0.6307034492492676], [0.7008705139160156, 0.6726035475730896, 0.638908326625824, 0.6231238842010498, 0.6343055963516235], [0.7213578224182129, 0.6926906108856201, 0.654592752456665, 0.6317540407180786, 0.6327546238899231], [0.6334800720214844, 0.6119421720504761, 0.5748949646949768, 0.5601110458374023, 0.5600110292434692], [0.7296878099441528, 0.7103261947631836, 0.676630973815918, 0.6548929214477539, 0.648339033126831], [0.7494747042655945, 0.7409695982933044, 0.7360166311264038, 0.7002201080322266, 0.7001450657844543]]
[[0.076, 0.115, 0.168, 0.224, 0.291], [0.151, 0.243, 0.352, 0.445, 0.49], [0.132, 0.215, 0.302, 0.368, 0.395], [0.175, 0.282, 0.379, 0.436, 0.471], [0.187, 0.289, 0.383, 0.433, 0.475], [0.154, 0.248, 0.336, 0.389, 0.427], [0.164, 0.261, 0.371, 0.435, 0.456], [0.156, 0.225, 0.309, 0.354, 0.369], [0.151, 0.242, 0.346, 0.411, 0.466], [0.079, 0.123, 0.193, 0.271, 0.329]]
nec_acc_int  =  0.717 +- 0.036, 0.695 +- 0.041, 0.666 +- 0.047, 0.646 +- 0.041, 0.649 +- 0.039


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.363 +- 0.013, 0.403 +- 0.019, 0.429 +- 0.018, 0.445 +- 0.015, 0.481 +- 0.005
Faith. Armon (L1)= 		  =  0.299 +- 0.059, 0.368 +- 0.054, 0.406 +- 0.047, 0.428 +- 0.037, 0.453 +- 0.036
Faith. GMean (L1)= 	  =  0.328 +- 0.040, 0.385 +- 0.038, 0.417 +- 0.033, 0.436 +- 0.026, 0.467 +- 0.020
Faith. Aritm (KL)= 		  =  0.320 +- 0.025, 0.373 +- 0.032, 0.414 +- 0.030, 0.444 +- 0.022, 0.499 +- 0.012
Faith. Armon (KL)= 		  =  0.273 +- 0.060, 0.356 +- 0.055, 0.405 +- 0.044, 0.439 +- 0.029, 0.487 +- 0.027
Faith. GMean (KL)= 	  =  0.294 +- 0.045, 0.364 +- 0.044, 0.410 +- 0.037, 0.442 +- 0.026, 0.493 +- 0.018

Eval split val
Faith. Aritm (L1)= 		  =  0.495 +- 0.003, 0.498 +- 0.002, 0.499 +- 0.001, 0.499 +- 0.001, 0.500 +- 0.000
Faith. Armon (L1)= 		  =  0.120 +- 0.028, 0.134 +- 0.029, 0.137 +- 0.031, 0.137 +- 0.031, 0.137 +- 0.031
Faith. GMean (L1)= 	  =  0.242 +- 0.029, 0.256 +- 0.029, 0.259 +- 0.031, 0.260 +- 0.031, 0.259 +- 0.031
Faith. Aritm (KL)= 		  =  0.492 +- 0.005, 0.498 +- 0.003, 0.499 +- 0.001, 0.499 +- 0.001, 0.500 +- 0.001
Faith. Armon (KL)= 		  =  0.087 +- 0.026, 0.108 +- 0.027, 0.114 +- 0.031, 0.114 +- 0.031, 0.114 +- 0.031
Faith. GMean (KL)= 	  =  0.204 +- 0.031, 0.230 +- 0.030, 0.236 +- 0.033, 0.236 +- 0.033, 0.237 +- 0.034

Eval split test
Faith. Aritm (L1)= 		  =  0.359 +- 0.016, 0.393 +- 0.007, 0.427 +- 0.005, 0.447 +- 0.006, 0.494 +- 0.016
Faith. Armon (L1)= 		  =  0.220 +- 0.041, 0.295 +- 0.050, 0.360 +- 0.050, 0.396 +- 0.039, 0.429 +- 0.032
Faith. GMean (L1)= 	  =  0.279 +- 0.024, 0.339 +- 0.029, 0.391 +- 0.029, 0.420 +- 0.021, 0.460 +- 0.015
Faith. Aritm (KL)= 		  =  0.306 +- 0.027, 0.353 +- 0.018, 0.404 +- 0.014, 0.441 +- 0.010, 0.521 +- 0.018
Faith. Armon (KL)= 		  =  0.213 +- 0.040, 0.296 +- 0.050, 0.371 +- 0.048, 0.420 +- 0.035, 0.491 +- 0.031
Faith. GMean (KL)= 	  =  0.253 +- 0.024, 0.321 +- 0.030, 0.386 +- 0.029, 0.430 +- 0.020, 0.505 +- 0.018
Computed for split load_split = id



Completed in  2:43:00.860912  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.05

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 16:35:15 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:35:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 87 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 87...
[0m[1;37mINFO[0m: [1mCheckpoint 87: 
-----------------------------------
Train ACCURACY: 0.9868
Train Loss: 0.0344
ID Validation ACCURACY: 0.9940
ID Validation Loss: 0.0199
ID Test ACCURACY: 0.9860
ID Test Loss: 0.0461
OOD Validation ACCURACY: 0.9940
OOD Validation Loss: 0.0199
OOD Test ACCURACY: 0.9860
OOD Test Loss: 0.0461

[0m[1;37mINFO[0m: [1mChartInfo 0.9860 0.9860 0.9860 0.9860 0.9940 0.9940[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.038
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.052
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.064
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.075
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.083
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037961999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.572
SUFF_SIMPLE for r=0.05 class 0.0 = 0.565 +- 0.393 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.505 +- 0.393 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 all KL = 0.366 +- 0.393 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 all L1 = 0.532 +- 0.304 (in-sample avg dev_std = 0.474)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051508
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.587
SUFF_SIMPLE for r=0.1 class 0.0 = 0.562 +- 0.392 (in-sample avg dev_std = 0.481)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.512 +- 0.392 (in-sample avg dev_std = 0.481)
SUFF_SIMPLE for r=0.1 all KL = 0.366 +- 0.392 (in-sample avg dev_std = 0.481)
SUFF_SIMPLE for r=0.1 all L1 = 0.534 +- 0.304 (in-sample avg dev_std = 0.481)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.063782
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.592
SUFF_SIMPLE for r=0.2 class 0.0 = 0.555 +- 0.402 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.534 +- 0.402 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.2 all KL = 0.389 +- 0.402 (in-sample avg dev_std = 0.451)
SUFF_SIMPLE for r=0.2 all L1 = 0.543 +- 0.311 (in-sample avg dev_std = 0.451)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075396
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.598
SUFF_SIMPLE for r=0.4 class 0.0 = 0.544 +- 0.424 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.587 +- 0.424 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.4 all KL = 0.44 +- 0.424 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.4 all L1 = 0.568 +- 0.335 (in-sample avg dev_std = 0.404)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08294800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.74
SUFF_SIMPLE for r=0.8 class 0.0 = 0.675 +- 0.429 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.811 +- 0.429 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.707 +- 0.429 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.751 +- 0.358 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085554
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.504
SUFF_SIMPLE for r=0.05 class 0.0 = 0.691 +- 0.444 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.156 +- 0.444 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 all KL = 0.306 +- 0.444 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.05 all L1 = 0.421 +- 0.385 (in-sample avg dev_std = 0.240)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009137600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.502
SUFF_SIMPLE for r=0.1 class 0.0 = 0.691 +- 0.445 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.155 +- 0.445 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all KL = 0.307 +- 0.445 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.1 all L1 = 0.42 +- 0.385 (in-sample avg dev_std = 0.237)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009422999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.502
SUFF_SIMPLE for r=0.2 class 0.0 = 0.691 +- 0.447 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.156 +- 0.447 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.2 all KL = 0.311 +- 0.447 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.2 all L1 = 0.422 +- 0.387 (in-sample avg dev_std = 0.232)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009673600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.503
SUFF_SIMPLE for r=0.4 class 0.0 = 0.694 +- 0.450 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.158 +- 0.450 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.4 all KL = 0.317 +- 0.450 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.4 all L1 = 0.424 +- 0.389 (in-sample avg dev_std = 0.205)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097454
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.587
SUFF_SIMPLE for r=0.8 class 0.0 = 0.407 +- 0.466 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.586 +- 0.466 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.396 +- 0.466 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.497 +- 0.403 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.026340999999999996
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.583
SUFF_SIMPLE for r=0.05 class 0.0 = 0.766 +- 0.392 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.392 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.05 all KL = 0.627 +- 0.392 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.05 all L1 = 0.675 +- 0.312 (in-sample avg dev_std = 0.258)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0372252
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.586
SUFF_SIMPLE for r=0.1 class 0.0 = 0.761 +- 0.390 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.598 +- 0.390 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 all KL = 0.633 +- 0.390 (in-sample avg dev_std = 0.240)
SUFF_SIMPLE for r=0.1 all L1 = 0.68 +- 0.312 (in-sample avg dev_std = 0.240)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.594
SUFF_SIMPLE for r=0.2 class 0.0 = 0.747 +- 0.389 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.632 +- 0.389 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.2 all KL = 0.649 +- 0.389 (in-sample avg dev_std = 0.219)
SUFF_SIMPLE for r=0.2 all L1 = 0.69 +- 0.315 (in-sample avg dev_std = 0.219)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06344580000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.61
SUFF_SIMPLE for r=0.4 class 0.0 = 0.775 +- 0.382 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.671 +- 0.382 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all KL = 0.703 +- 0.382 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all L1 = 0.724 +- 0.324 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790086
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.666
SUFF_SIMPLE for r=0.8 class 0.0 = 0.93 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.839 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.904 +- 0.235 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.885 +- 0.228 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.994
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037961999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.952
NEC for r=0.05 class 0.0 = 0.087 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.04 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.062 +- 0.206 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.061 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.994
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051508
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.863
NEC for r=0.1 class 0.0 = 0.21 +- 0.336 (in-sample avg dev_std = 0.046)
NEC for r=0.1 class 1.0 = 0.081 +- 0.336 (in-sample avg dev_std = 0.046)
NEC for r=0.1 all KL = 0.158 +- 0.336 (in-sample avg dev_std = 0.046)
NEC for r=0.1 all L1 = 0.139 +- 0.278 (in-sample avg dev_std = 0.046)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.994
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.063782
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.78
NEC for r=0.2 class 0.0 = 0.339 +- 0.414 (in-sample avg dev_std = 0.245)
NEC for r=0.2 class 1.0 = 0.147 +- 0.414 (in-sample avg dev_std = 0.245)
NEC for r=0.2 all KL = 0.28 +- 0.414 (in-sample avg dev_std = 0.245)
NEC for r=0.2 all L1 = 0.233 +- 0.332 (in-sample avg dev_std = 0.245)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.994
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075396
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.721
NEC for r=0.4 class 0.0 = 0.397 +- 0.432 (in-sample avg dev_std = 0.382)
NEC for r=0.4 class 1.0 = 0.225 +- 0.432 (in-sample avg dev_std = 0.382)
NEC for r=0.4 all KL = 0.387 +- 0.432 (in-sample avg dev_std = 0.382)
NEC for r=0.4 all L1 = 0.301 +- 0.338 (in-sample avg dev_std = 0.382)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.994
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08294800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.708
NEC for r=0.8 class 0.0 = 0.425 +- 0.421 (in-sample avg dev_std = 0.450)
NEC for r=0.8 class 1.0 = 0.255 +- 0.421 (in-sample avg dev_std = 0.450)
NEC for r=0.8 all KL = 0.442 +- 0.421 (in-sample avg dev_std = 0.450)
NEC for r=0.8 all L1 = 0.331 +- 0.324 (in-sample avg dev_std = 0.450)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.849
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085554
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.87
NEC for r=0.05 class 0.0 = 0.19 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.014 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.116 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.101 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.849
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009137600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.78
NEC for r=0.1 class 0.0 = 0.47 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.078 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.336 +- 0.446 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.272 +- 0.375 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.849
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009422999999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.598
NEC for r=0.2 class 0.0 = 0.622 +- 0.464 (in-sample avg dev_std = 0.203)
NEC for r=0.2 class 1.0 = 0.373 +- 0.464 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all KL = 0.61 +- 0.464 (in-sample avg dev_std = 0.203)
NEC for r=0.2 all L1 = 0.497 +- 0.398 (in-sample avg dev_std = 0.203)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.849
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009673600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.584
NEC for r=0.4 class 0.0 = 0.619 +- 0.416 (in-sample avg dev_std = 0.471)
NEC for r=0.4 class 1.0 = 0.465 +- 0.416 (in-sample avg dev_std = 0.471)
NEC for r=0.4 all KL = 0.72 +- 0.416 (in-sample avg dev_std = 0.471)
NEC for r=0.4 all L1 = 0.541 +- 0.354 (in-sample avg dev_std = 0.471)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.849
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097454
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.582
NEC for r=0.8 class 0.0 = 0.624 +- 0.395 (in-sample avg dev_std = 0.524)
NEC for r=0.8 class 1.0 = 0.482 +- 0.395 (in-sample avg dev_std = 0.524)
NEC for r=0.8 all KL = 0.751 +- 0.395 (in-sample avg dev_std = 0.524)
NEC for r=0.8 all L1 = 0.552 +- 0.340 (in-sample avg dev_std = 0.524)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.652
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.026340999999999996
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.654
NEC for r=0.05 class 0.0 = 0.036 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.072 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.054 +- 0.136 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.652
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0372252
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.654
NEC for r=0.1 class 0.0 = 0.052 +- 0.168 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.107 +- 0.168 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.054 +- 0.168 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.079 +- 0.180 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.652
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.665
NEC for r=0.2 class 0.0 = 0.082 +- 0.250 (in-sample avg dev_std = 0.011)
NEC for r=0.2 class 1.0 = 0.177 +- 0.250 (in-sample avg dev_std = 0.011)
NEC for r=0.2 all KL = 0.109 +- 0.250 (in-sample avg dev_std = 0.011)
NEC for r=0.2 all L1 = 0.129 +- 0.242 (in-sample avg dev_std = 0.011)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.652
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06344580000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.626
NEC for r=0.4 class 0.0 = 0.161 +- 0.322 (in-sample avg dev_std = 0.104)
NEC for r=0.4 class 1.0 = 0.228 +- 0.322 (in-sample avg dev_std = 0.104)
NEC for r=0.4 all KL = 0.189 +- 0.322 (in-sample avg dev_std = 0.104)
NEC for r=0.4 all L1 = 0.194 +- 0.290 (in-sample avg dev_std = 0.104)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.652
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790086
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.599
NEC for r=0.8 class 0.0 = 0.194 +- 0.356 (in-sample avg dev_std = 0.228)
NEC for r=0.8 class 1.0 = 0.3 +- 0.356 (in-sample avg dev_std = 0.228)
NEC for r=0.8 all KL = 0.269 +- 0.356 (in-sample avg dev_std = 0.228)
NEC for r=0.8 all L1 = 0.246 +- 0.296 (in-sample avg dev_std = 0.228)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 16:52:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 04:52:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 89 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 89...
[0m[1;37mINFO[0m: [1mCheckpoint 89: 
-----------------------------------
Train ACCURACY: 0.9952
Train Loss: 0.0252
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0215
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0308
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0215
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0308

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.048
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.059
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.038
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.064
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03645400000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.632
SUFF_SIMPLE for r=0.05 class 0.0 = 0.535 +- 0.390 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.598 +- 0.390 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.05 all KL = 0.402 +- 0.390 (in-sample avg dev_std = 0.476)
SUFF_SIMPLE for r=0.05 all L1 = 0.57 +- 0.295 (in-sample avg dev_std = 0.476)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048091999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.654
SUFF_SIMPLE for r=0.1 class 0.0 = 0.527 +- 0.387 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.614 +- 0.387 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.1 all KL = 0.41 +- 0.387 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.1 all L1 = 0.575 +- 0.296 (in-sample avg dev_std = 0.460)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059421999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.653
SUFF_SIMPLE for r=0.2 class 0.0 = 0.514 +- 0.397 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.64 +- 0.397 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 all KL = 0.431 +- 0.397 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 all L1 = 0.584 +- 0.304 (in-sample avg dev_std = 0.447)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07090400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.658
SUFF_SIMPLE for r=0.4 class 0.0 = 0.545 +- 0.431 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.683 +- 0.431 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.4 all KL = 0.507 +- 0.431 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.4 all L1 = 0.621 +- 0.334 (in-sample avg dev_std = 0.393)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07983799999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.778
SUFF_SIMPLE for r=0.8 class 0.0 = 0.642 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.887 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.747 +- 0.411 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.777 +- 0.342 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090664
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.531
SUFF_SIMPLE for r=0.05 class 0.0 = 0.87 +- 0.443 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.317 +- 0.443 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.05 all KL = 0.475 +- 0.443 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.05 all L1 = 0.591 +- 0.361 (in-sample avg dev_std = 0.427)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.534
SUFF_SIMPLE for r=0.1 class 0.0 = 0.868 +- 0.442 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.322 +- 0.442 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.1 all KL = 0.477 +- 0.442 (in-sample avg dev_std = 0.431)
SUFF_SIMPLE for r=0.1 all L1 = 0.593 +- 0.360 (in-sample avg dev_std = 0.431)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009436599999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.533
SUFF_SIMPLE for r=0.2 class 0.0 = 0.872 +- 0.444 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.319 +- 0.444 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.2 all KL = 0.484 +- 0.444 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.2 all L1 = 0.593 +- 0.362 (in-sample avg dev_std = 0.420)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095174
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.529
SUFF_SIMPLE for r=0.4 class 0.0 = 0.872 +- 0.446 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.325 +- 0.446 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.4 all KL = 0.498 +- 0.446 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.4 all L1 = 0.596 +- 0.369 (in-sample avg dev_std = 0.373)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.665
SUFF_SIMPLE for r=0.8 class 0.0 = 0.701 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.692 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.654 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.697 +- 0.356 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027151400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.617
SUFF_SIMPLE for r=0.05 class 0.0 = 0.748 +- 0.402 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.571 +- 0.402 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all KL = 0.599 +- 0.402 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.05 all L1 = 0.661 +- 0.308 (in-sample avg dev_std = 0.264)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.038323800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.618
SUFF_SIMPLE for r=0.1 class 0.0 = 0.728 +- 0.405 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.594 +- 0.405 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.1 all KL = 0.599 +- 0.405 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.1 all L1 = 0.662 +- 0.313 (in-sample avg dev_std = 0.242)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05034740000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.622
SUFF_SIMPLE for r=0.2 class 0.0 = 0.724 +- 0.398 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.633 +- 0.398 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all KL = 0.627 +- 0.398 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all L1 = 0.679 +- 0.320 (in-sample avg dev_std = 0.220)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06435620000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.651
SUFF_SIMPLE for r=0.4 class 0.0 = 0.772 +- 0.384 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.675 +- 0.384 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 all KL = 0.698 +- 0.384 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 all L1 = 0.724 +- 0.324 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.696
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0799668
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.717
SUFF_SIMPLE for r=0.8 class 0.0 = 0.929 +- 0.257 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.257 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.889 +- 0.257 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.876 +- 0.240 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03645400000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.964
NEC for r=0.05 class 0.0 = 0.069 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.022 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.04 +- 0.167 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.043 +- 0.147 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048091999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.91
NEC for r=0.1 class 0.0 = 0.154 +- 0.280 (in-sample avg dev_std = 0.050)
NEC for r=0.1 class 1.0 = 0.054 +- 0.280 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all KL = 0.11 +- 0.280 (in-sample avg dev_std = 0.050)
NEC for r=0.1 all L1 = 0.099 +- 0.234 (in-sample avg dev_std = 0.050)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059421999999999996
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.839
NEC for r=0.2 class 0.0 = 0.294 +- 0.386 (in-sample avg dev_std = 0.277)
NEC for r=0.2 class 1.0 = 0.095 +- 0.386 (in-sample avg dev_std = 0.277)
NEC for r=0.2 all KL = 0.233 +- 0.386 (in-sample avg dev_std = 0.277)
NEC for r=0.2 all L1 = 0.184 +- 0.292 (in-sample avg dev_std = 0.277)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07090400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.793
NEC for r=0.4 class 0.0 = 0.372 +- 0.416 (in-sample avg dev_std = 0.391)
NEC for r=0.4 class 1.0 = 0.136 +- 0.416 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all KL = 0.324 +- 0.416 (in-sample avg dev_std = 0.391)
NEC for r=0.4 all L1 = 0.241 +- 0.308 (in-sample avg dev_std = 0.391)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07983799999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.781
NEC for r=0.8 class 0.0 = 0.395 +- 0.412 (in-sample avg dev_std = 0.465)
NEC for r=0.8 class 1.0 = 0.181 +- 0.412 (in-sample avg dev_std = 0.465)
NEC for r=0.8 all KL = 0.386 +- 0.412 (in-sample avg dev_std = 0.465)
NEC for r=0.8 all L1 = 0.276 +- 0.298 (in-sample avg dev_std = 0.465)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.923
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090664
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.929
NEC for r=0.05 class 0.0 = 0.023 +- 0.153 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.138 +- 0.153 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.052 +- 0.153 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.081 +- 0.173 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.923
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.869
NEC for r=0.1 class 0.0 = 0.11 +- 0.300 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.188 +- 0.300 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.15 +- 0.300 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.149 +- 0.259 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.923
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009436599999999998
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.683
NEC for r=0.2 class 0.0 = 0.301 +- 0.428 (in-sample avg dev_std = 0.194)
NEC for r=0.2 class 1.0 = 0.308 +- 0.428 (in-sample avg dev_std = 0.194)
NEC for r=0.2 all KL = 0.361 +- 0.428 (in-sample avg dev_std = 0.194)
NEC for r=0.2 all L1 = 0.305 +- 0.349 (in-sample avg dev_std = 0.194)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.923
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095174
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.666
NEC for r=0.4 class 0.0 = 0.319 +- 0.427 (in-sample avg dev_std = 0.439)
NEC for r=0.4 class 1.0 = 0.369 +- 0.427 (in-sample avg dev_std = 0.439)
NEC for r=0.4 all KL = 0.449 +- 0.427 (in-sample avg dev_std = 0.439)
NEC for r=0.4 all L1 = 0.344 +- 0.328 (in-sample avg dev_std = 0.439)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.923
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.668
NEC for r=0.8 class 0.0 = 0.323 +- 0.421 (in-sample avg dev_std = 0.488)
NEC for r=0.8 class 1.0 = 0.381 +- 0.421 (in-sample avg dev_std = 0.488)
NEC for r=0.8 all KL = 0.472 +- 0.421 (in-sample avg dev_std = 0.488)
NEC for r=0.8 all L1 = 0.352 +- 0.317 (in-sample avg dev_std = 0.488)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.695
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027151400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.691
NEC for r=0.05 class 0.0 = 0.036 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.076 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.033 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.145 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.695
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.038323800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.701
NEC for r=0.1 class 0.0 = 0.051 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.113 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.059 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.082 +- 0.186 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.695
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05034740000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.702
NEC for r=0.2 class 0.0 = 0.085 +- 0.260 (in-sample avg dev_std = 0.035)
NEC for r=0.2 class 1.0 = 0.173 +- 0.260 (in-sample avg dev_std = 0.035)
NEC for r=0.2 all KL = 0.113 +- 0.260 (in-sample avg dev_std = 0.035)
NEC for r=0.2 all L1 = 0.128 +- 0.244 (in-sample avg dev_std = 0.035)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.695
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06435620000000002
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.663
NEC for r=0.4 class 0.0 = 0.157 +- 0.317 (in-sample avg dev_std = 0.107)
NEC for r=0.4 class 1.0 = 0.214 +- 0.317 (in-sample avg dev_std = 0.107)
NEC for r=0.4 all KL = 0.182 +- 0.317 (in-sample avg dev_std = 0.107)
NEC for r=0.4 all L1 = 0.185 +- 0.283 (in-sample avg dev_std = 0.107)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.695
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0799668
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.627
NEC for r=0.8 class 0.0 = 0.212 +- 0.365 (in-sample avg dev_std = 0.236)
NEC for r=0.8 class 1.0 = 0.287 +- 0.365 (in-sample avg dev_std = 0.236)
NEC for r=0.8 all KL = 0.286 +- 0.365 (in-sample avg dev_std = 0.236)
NEC for r=0.8 all L1 = 0.249 +- 0.291 (in-sample avg dev_std = 0.236)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 17:08:51 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:08:51 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 77 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 77...
[0m[1;37mINFO[0m: [1mCheckpoint 77: 
-----------------------------------
Train ACCURACY: 0.9888
Train Loss: 0.0367
ID Validation ACCURACY: 0.9900
ID Validation Loss: 0.0348
ID Test ACCURACY: 0.9900
ID Test Loss: 0.0351
OOD Validation ACCURACY: 0.9900
OOD Validation Loss: 0.0348
OOD Test ACCURACY: 0.9900
OOD Test Loss: 0.0351

[0m[1;37mINFO[0m: [1mChartInfo 0.9900 0.9900 0.9900 0.9900 0.9900 0.9900[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.048
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.062
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035300000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.618
SUFF_SIMPLE for r=0.05 class 0.0 = 0.563 +- 0.387 (in-sample avg dev_std = 0.483)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.571 +- 0.387 (in-sample avg dev_std = 0.483)
SUFF_SIMPLE for r=0.05 all KL = 0.437 +- 0.387 (in-sample avg dev_std = 0.483)
SUFF_SIMPLE for r=0.05 all L1 = 0.568 +- 0.298 (in-sample avg dev_std = 0.483)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047757999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.613
SUFF_SIMPLE for r=0.1 class 0.0 = 0.563 +- 0.392 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.571 +- 0.392 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.1 all KL = 0.439 +- 0.392 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.1 all L1 = 0.567 +- 0.301 (in-sample avg dev_std = 0.465)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061932
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.637
SUFF_SIMPLE for r=0.2 class 0.0 = 0.549 +- 0.397 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.599 +- 0.397 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all KL = 0.454 +- 0.397 (in-sample avg dev_std = 0.452)
SUFF_SIMPLE for r=0.2 all L1 = 0.577 +- 0.308 (in-sample avg dev_std = 0.452)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071274
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.646
SUFF_SIMPLE for r=0.4 class 0.0 = 0.549 +- 0.418 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.663 +- 0.418 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.4 all KL = 0.519 +- 0.418 (in-sample avg dev_std = 0.373)
SUFF_SIMPLE for r=0.4 all L1 = 0.612 +- 0.330 (in-sample avg dev_std = 0.373)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078928
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.736
SUFF_SIMPLE for r=0.8 class 0.0 = 0.633 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.728 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.749 +- 0.354 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008754999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.5
SUFF_SIMPLE for r=0.05 class 0.0 = 0.97 +- 0.401 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.422 +- 0.401 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all KL = 0.665 +- 0.401 (in-sample avg dev_std = 0.178)
SUFF_SIMPLE for r=0.05 all L1 = 0.694 +- 0.356 (in-sample avg dev_std = 0.178)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009405799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.5
SUFF_SIMPLE for r=0.1 class 0.0 = 0.97 +- 0.401 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.421 +- 0.401 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all KL = 0.667 +- 0.401 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.1 all L1 = 0.694 +- 0.356 (in-sample avg dev_std = 0.176)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009508800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.499
SUFF_SIMPLE for r=0.2 class 0.0 = 0.971 +- 0.401 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.421 +- 0.401 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.2 all KL = 0.668 +- 0.401 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.2 all L1 = 0.694 +- 0.356 (in-sample avg dev_std = 0.170)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009540200000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.5
SUFF_SIMPLE for r=0.4 class 0.0 = 0.974 +- 0.399 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.422 +- 0.399 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.4 all KL = 0.674 +- 0.399 (in-sample avg dev_std = 0.152)
SUFF_SIMPLE for r=0.4 all L1 = 0.696 +- 0.357 (in-sample avg dev_std = 0.152)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009659799999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.559
SUFF_SIMPLE for r=0.8 class 0.0 = 0.77 +- 0.390 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.676 +- 0.390 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.692 +- 0.390 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.722 +- 0.318 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249234
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.605
SUFF_SIMPLE for r=0.05 class 0.0 = 0.773 +- 0.394 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.579 +- 0.394 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.05 all KL = 0.625 +- 0.394 (in-sample avg dev_std = 0.284)
SUFF_SIMPLE for r=0.05 all L1 = 0.677 +- 0.315 (in-sample avg dev_std = 0.284)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03595399999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.615
SUFF_SIMPLE for r=0.1 class 0.0 = 0.766 +- 0.395 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.606 +- 0.395 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.1 all KL = 0.637 +- 0.395 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.1 all L1 = 0.687 +- 0.318 (in-sample avg dev_std = 0.263)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048873200000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.618
SUFF_SIMPLE for r=0.2 class 0.0 = 0.762 +- 0.391 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.645 +- 0.391 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.2 all KL = 0.663 +- 0.391 (in-sample avg dev_std = 0.231)
SUFF_SIMPLE for r=0.2 all L1 = 0.704 +- 0.324 (in-sample avg dev_std = 0.231)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06226460000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.639
SUFF_SIMPLE for r=0.4 class 0.0 = 0.777 +- 0.383 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.682 +- 0.383 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.4 all KL = 0.708 +- 0.383 (in-sample avg dev_std = 0.180)
SUFF_SIMPLE for r=0.4 all L1 = 0.73 +- 0.325 (in-sample avg dev_std = 0.180)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.68
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078543
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.696
SUFF_SIMPLE for r=0.8 class 0.0 = 0.928 +- 0.249 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.835 +- 0.249 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.897 +- 0.249 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.882 +- 0.235 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035300000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.922
NEC for r=0.05 class 0.0 = 0.124 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.052 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.081 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.084 +- 0.213 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047757999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.864
NEC for r=0.1 class 0.0 = 0.22 +- 0.325 (in-sample avg dev_std = 0.013)
NEC for r=0.1 class 1.0 = 0.081 +- 0.325 (in-sample avg dev_std = 0.013)
NEC for r=0.1 all KL = 0.148 +- 0.325 (in-sample avg dev_std = 0.013)
NEC for r=0.1 all L1 = 0.143 +- 0.278 (in-sample avg dev_std = 0.013)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061932
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.789
NEC for r=0.2 class 0.0 = 0.338 +- 0.399 (in-sample avg dev_std = 0.250)
NEC for r=0.2 class 1.0 = 0.134 +- 0.399 (in-sample avg dev_std = 0.250)
NEC for r=0.2 all KL = 0.259 +- 0.399 (in-sample avg dev_std = 0.250)
NEC for r=0.2 all L1 = 0.225 +- 0.322 (in-sample avg dev_std = 0.250)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071274
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.737
NEC for r=0.4 class 0.0 = 0.431 +- 0.418 (in-sample avg dev_std = 0.368)
NEC for r=0.4 class 1.0 = 0.181 +- 0.418 (in-sample avg dev_std = 0.368)
NEC for r=0.4 all KL = 0.35 +- 0.418 (in-sample avg dev_std = 0.368)
NEC for r=0.4 all L1 = 0.292 +- 0.331 (in-sample avg dev_std = 0.368)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078928
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.717
NEC for r=0.8 class 0.0 = 0.427 +- 0.411 (in-sample avg dev_std = 0.432)
NEC for r=0.8 class 1.0 = 0.241 +- 0.411 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all KL = 0.407 +- 0.411 (in-sample avg dev_std = 0.432)
NEC for r=0.8 all L1 = 0.324 +- 0.320 (in-sample avg dev_std = 0.432)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.797
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008754999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.752
NEC for r=0.05 class 0.0 = 0.04 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.054 +- 0.180 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.082 +- 0.159 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.797
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009405799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.688
NEC for r=0.1 class 0.0 = 0.135 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.183 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.162 +- 0.312 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.159 +- 0.242 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.797
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009508800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.566
NEC for r=0.2 class 0.0 = 0.24 +- 0.391 (in-sample avg dev_std = 0.127)
NEC for r=0.2 class 1.0 = 0.31 +- 0.391 (in-sample avg dev_std = 0.127)
NEC for r=0.2 all KL = 0.311 +- 0.391 (in-sample avg dev_std = 0.127)
NEC for r=0.2 all L1 = 0.275 +- 0.312 (in-sample avg dev_std = 0.127)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.797
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009540200000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.553
NEC for r=0.4 class 0.0 = 0.237 +- 0.391 (in-sample avg dev_std = 0.333)
NEC for r=0.4 class 1.0 = 0.366 +- 0.391 (in-sample avg dev_std = 0.333)
NEC for r=0.4 all KL = 0.363 +- 0.391 (in-sample avg dev_std = 0.333)
NEC for r=0.4 all L1 = 0.302 +- 0.302 (in-sample avg dev_std = 0.333)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.797
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009659799999999998
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.554
NEC for r=0.8 class 0.0 = 0.238 +- 0.386 (in-sample avg dev_std = 0.381)
NEC for r=0.8 class 1.0 = 0.375 +- 0.386 (in-sample avg dev_std = 0.381)
NEC for r=0.8 all KL = 0.378 +- 0.386 (in-sample avg dev_std = 0.381)
NEC for r=0.8 all L1 = 0.307 +- 0.294 (in-sample avg dev_std = 0.381)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.679
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249234
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.681
NEC for r=0.05 class 0.0 = 0.036 +- 0.129 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.075 +- 0.129 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.032 +- 0.129 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.055 +- 0.144 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.679
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03595399999999999
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.687
NEC for r=0.1 class 0.0 = 0.051 +- 0.179 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.112 +- 0.179 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.058 +- 0.179 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.081 +- 0.186 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.679
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048873200000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.686
NEC for r=0.2 class 0.0 = 0.09 +- 0.258 (in-sample avg dev_std = 0.026)
NEC for r=0.2 class 1.0 = 0.172 +- 0.258 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all KL = 0.114 +- 0.258 (in-sample avg dev_std = 0.026)
NEC for r=0.2 all L1 = 0.13 +- 0.246 (in-sample avg dev_std = 0.026)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.679
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06226460000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.65
NEC for r=0.4 class 0.0 = 0.163 +- 0.320 (in-sample avg dev_std = 0.124)
NEC for r=0.4 class 1.0 = 0.213 +- 0.320 (in-sample avg dev_std = 0.124)
NEC for r=0.4 all KL = 0.185 +- 0.320 (in-sample avg dev_std = 0.124)
NEC for r=0.4 all L1 = 0.187 +- 0.288 (in-sample avg dev_std = 0.124)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.679
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078543
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.627
NEC for r=0.8 class 0.0 = 0.189 +- 0.356 (in-sample avg dev_std = 0.248)
NEC for r=0.8 class 1.0 = 0.283 +- 0.356 (in-sample avg dev_std = 0.248)
NEC for r=0.8 all KL = 0.263 +- 0.356 (in-sample avg dev_std = 0.248)
NEC for r=0.8 all L1 = 0.236 +- 0.296 (in-sample avg dev_std = 0.248)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 17:26:03 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:26:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 0.9898
Train Loss: 0.0441
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0486
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0525
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0486
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0525

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.060
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.048
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031674
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.615
SUFF_SIMPLE for r=0.05 class 0.0 = 0.603 +- 0.409 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.545 +- 0.409 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all KL = 0.446 +- 0.409 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all L1 = 0.571 +- 0.311 (in-sample avg dev_std = 0.440)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047403999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.601
SUFF_SIMPLE for r=0.1 class 0.0 = 0.61 +- 0.412 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.53 +- 0.412 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 all KL = 0.442 +- 0.412 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 all L1 = 0.566 +- 0.315 (in-sample avg dev_std = 0.424)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060094
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.609
SUFF_SIMPLE for r=0.2 class 0.0 = 0.617 +- 0.420 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.542 +- 0.420 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.2 all KL = 0.458 +- 0.420 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.2 all L1 = 0.575 +- 0.321 (in-sample avg dev_std = 0.415)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073904
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.642
SUFF_SIMPLE for r=0.4 class 0.0 = 0.588 +- 0.425 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.632 +- 0.425 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.4 all KL = 0.519 +- 0.425 (in-sample avg dev_std = 0.333)
SUFF_SIMPLE for r=0.4 all L1 = 0.612 +- 0.336 (in-sample avg dev_std = 0.333)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08061800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.738
SUFF_SIMPLE for r=0.8 class 0.0 = 0.597 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.841 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.707 +- 0.417 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.732 +- 0.350 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086018
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.504
SUFF_SIMPLE for r=0.05 class 0.0 = 0.959 +- 0.388 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.487 +- 0.388 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.05 all KL = 0.685 +- 0.388 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.05 all L1 = 0.721 +- 0.337 (in-sample avg dev_std = 0.200)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0090214
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.505
SUFF_SIMPLE for r=0.1 class 0.0 = 0.96 +- 0.389 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.487 +- 0.389 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all KL = 0.685 +- 0.389 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all L1 = 0.722 +- 0.337 (in-sample avg dev_std = 0.196)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0093638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.504
SUFF_SIMPLE for r=0.2 class 0.0 = 0.961 +- 0.388 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.487 +- 0.388 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all KL = 0.687 +- 0.388 (in-sample avg dev_std = 0.192)
SUFF_SIMPLE for r=0.2 all L1 = 0.722 +- 0.338 (in-sample avg dev_std = 0.192)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096116
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.504
SUFF_SIMPLE for r=0.4 class 0.0 = 0.962 +- 0.387 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.491 +- 0.387 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.4 all KL = 0.694 +- 0.387 (in-sample avg dev_std = 0.170)
SUFF_SIMPLE for r=0.4 all L1 = 0.724 +- 0.338 (in-sample avg dev_std = 0.170)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009753
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.58
SUFF_SIMPLE for r=0.8 class 0.0 = 0.833 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.636 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.694 +- 0.380 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.733 +- 0.310 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024698599999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.556
SUFF_SIMPLE for r=0.05 class 0.0 = 0.83 +- 0.389 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.625 +- 0.389 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.05 all KL = 0.685 +- 0.389 (in-sample avg dev_std = 0.286)
SUFF_SIMPLE for r=0.05 all L1 = 0.729 +- 0.311 (in-sample avg dev_std = 0.286)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0358638
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.555
SUFF_SIMPLE for r=0.1 class 0.0 = 0.842 +- 0.394 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.629 +- 0.394 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.1 all KL = 0.698 +- 0.394 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.1 all L1 = 0.737 +- 0.317 (in-sample avg dev_std = 0.271)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047934199999999996
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.556
SUFF_SIMPLE for r=0.2 class 0.0 = 0.837 +- 0.396 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.649 +- 0.396 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.2 all KL = 0.706 +- 0.396 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.2 all L1 = 0.744 +- 0.319 (in-sample avg dev_std = 0.242)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06318860000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.583
SUFF_SIMPLE for r=0.4 class 0.0 = 0.825 +- 0.385 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.692 +- 0.385 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 all KL = 0.73 +- 0.385 (in-sample avg dev_std = 0.175)
SUFF_SIMPLE for r=0.4 all L1 = 0.759 +- 0.318 (in-sample avg dev_std = 0.175)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.627
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079252
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.635
SUFF_SIMPLE for r=0.8 class 0.0 = 0.929 +- 0.245 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.848 +- 0.245 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.903 +- 0.245 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.889 +- 0.229 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031674
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.926
NEC for r=0.05 class 0.0 = 0.111 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.048 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.07 +- 0.230 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.076 +- 0.196 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047403999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.859
NEC for r=0.1 class 0.0 = 0.247 +- 0.329 (in-sample avg dev_std = 0.042)
NEC for r=0.1 class 1.0 = 0.071 +- 0.329 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all KL = 0.154 +- 0.329 (in-sample avg dev_std = 0.042)
NEC for r=0.1 all L1 = 0.15 +- 0.278 (in-sample avg dev_std = 0.042)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060094
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.794
NEC for r=0.2 class 0.0 = 0.343 +- 0.397 (in-sample avg dev_std = 0.239)
NEC for r=0.2 class 1.0 = 0.126 +- 0.397 (in-sample avg dev_std = 0.239)
NEC for r=0.2 all KL = 0.258 +- 0.397 (in-sample avg dev_std = 0.239)
NEC for r=0.2 all L1 = 0.223 +- 0.317 (in-sample avg dev_std = 0.239)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073904
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.767
NEC for r=0.4 class 0.0 = 0.399 +- 0.413 (in-sample avg dev_std = 0.346)
NEC for r=0.4 class 1.0 = 0.188 +- 0.413 (in-sample avg dev_std = 0.346)
NEC for r=0.4 all KL = 0.346 +- 0.413 (in-sample avg dev_std = 0.346)
NEC for r=0.4 all L1 = 0.282 +- 0.319 (in-sample avg dev_std = 0.346)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08061800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.732
NEC for r=0.8 class 0.0 = 0.405 +- 0.414 (in-sample avg dev_std = 0.423)
NEC for r=0.8 class 1.0 = 0.239 +- 0.414 (in-sample avg dev_std = 0.423)
NEC for r=0.8 all KL = 0.405 +- 0.414 (in-sample avg dev_std = 0.423)
NEC for r=0.8 all L1 = 0.313 +- 0.313 (in-sample avg dev_std = 0.423)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.74
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086018
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.739
NEC for r=0.05 class 0.0 = 0.016 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.19 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.069 +- 0.182 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.104 +- 0.187 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.74
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0090214
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.702
NEC for r=0.1 class 0.0 = 0.061 +- 0.275 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.252 +- 0.275 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.147 +- 0.275 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.157 +- 0.236 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.74
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0093638
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.585
NEC for r=0.2 class 0.0 = 0.172 +- 0.381 (in-sample avg dev_std = 0.131)
NEC for r=0.2 class 1.0 = 0.367 +- 0.381 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all KL = 0.316 +- 0.381 (in-sample avg dev_std = 0.131)
NEC for r=0.2 all L1 = 0.27 +- 0.306 (in-sample avg dev_std = 0.131)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.74
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096116
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.574
NEC for r=0.4 class 0.0 = 0.176 +- 0.390 (in-sample avg dev_std = 0.318)
NEC for r=0.4 class 1.0 = 0.413 +- 0.390 (in-sample avg dev_std = 0.318)
NEC for r=0.4 all KL = 0.373 +- 0.390 (in-sample avg dev_std = 0.318)
NEC for r=0.4 all L1 = 0.295 +- 0.299 (in-sample avg dev_std = 0.318)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.74
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009753
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.572
NEC for r=0.8 class 0.0 = 0.182 +- 0.389 (in-sample avg dev_std = 0.359)
NEC for r=0.8 class 1.0 = 0.417 +- 0.389 (in-sample avg dev_std = 0.359)
NEC for r=0.8 all KL = 0.383 +- 0.389 (in-sample avg dev_std = 0.359)
NEC for r=0.8 all L1 = 0.3 +- 0.294 (in-sample avg dev_std = 0.359)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.626
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024698599999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.623
NEC for r=0.05 class 0.0 = 0.033 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.073 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.123 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.053 +- 0.141 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.626
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0358638
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.624
NEC for r=0.1 class 0.0 = 0.052 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.103 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.057 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.077 +- 0.183 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.626
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047934199999999996
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.624
NEC for r=0.2 class 0.0 = 0.08 +- 0.252 (in-sample avg dev_std = 0.001)
NEC for r=0.2 class 1.0 = 0.159 +- 0.252 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all KL = 0.106 +- 0.252 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all L1 = 0.119 +- 0.236 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.626
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06318860000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.595
NEC for r=0.4 class 0.0 = 0.136 +- 0.329 (in-sample avg dev_std = 0.123)
NEC for r=0.4 class 1.0 = 0.224 +- 0.329 (in-sample avg dev_std = 0.123)
NEC for r=0.4 all KL = 0.185 +- 0.329 (in-sample avg dev_std = 0.123)
NEC for r=0.4 all L1 = 0.179 +- 0.287 (in-sample avg dev_std = 0.123)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.626
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079252
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.566
NEC for r=0.8 class 0.0 = 0.145 +- 0.370 (in-sample avg dev_std = 0.244)
NEC for r=0.8 class 1.0 = 0.303 +- 0.370 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all KL = 0.248 +- 0.370 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all L1 = 0.223 +- 0.305 (in-sample avg dev_std = 0.244)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 17:42:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:42:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 0.9718
Train Loss: 0.0708
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0692
ID Test ACCURACY: 0.9580
ID Test Loss: 0.0971
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0692
OOD Test ACCURACY: 0.9580
OOD Test Loss: 0.0971

[0m[1;37mINFO[0m: [1mChartInfo 0.9580 0.9580 0.9580 0.9580 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.045
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.069
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034804
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.612
SUFF_SIMPLE for r=0.05 class 0.0 = 0.577 +- 0.397 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.546 +- 0.397 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.05 all KL = 0.45 +- 0.397 (in-sample avg dev_std = 0.438)
SUFF_SIMPLE for r=0.05 all L1 = 0.56 +- 0.301 (in-sample avg dev_std = 0.438)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.044708
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.608
SUFF_SIMPLE for r=0.1 class 0.0 = 0.575 +- 0.397 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.553 +- 0.397 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.1 all KL = 0.455 +- 0.397 (in-sample avg dev_std = 0.422)
SUFF_SIMPLE for r=0.1 all L1 = 0.562 +- 0.305 (in-sample avg dev_std = 0.422)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056204000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.604
SUFF_SIMPLE for r=0.2 class 0.0 = 0.582 +- 0.407 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.56 +- 0.407 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.2 all KL = 0.463 +- 0.407 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.2 all L1 = 0.57 +- 0.312 (in-sample avg dev_std = 0.403)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06890600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.635
SUFF_SIMPLE for r=0.4 class 0.0 = 0.565 +- 0.413 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.635 +- 0.413 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.4 all KL = 0.52 +- 0.413 (in-sample avg dev_std = 0.335)
SUFF_SIMPLE for r=0.4 all L1 = 0.603 +- 0.326 (in-sample avg dev_std = 0.335)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.754
SUFF_SIMPLE for r=0.8 class 0.0 = 0.636 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.856 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.749 +- 0.388 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.758 +- 0.335 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086272
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.514
SUFF_SIMPLE for r=0.05 class 0.0 = 0.938 +- 0.422 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.459 +- 0.422 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.05 all KL = 0.637 +- 0.422 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.05 all L1 = 0.697 +- 0.354 (in-sample avg dev_std = 0.277)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091434
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.514
SUFF_SIMPLE for r=0.1 class 0.0 = 0.938 +- 0.422 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.457 +- 0.422 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.1 all KL = 0.637 +- 0.422 (in-sample avg dev_std = 0.272)
SUFF_SIMPLE for r=0.1 all L1 = 0.696 +- 0.356 (in-sample avg dev_std = 0.272)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009401000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.515
SUFF_SIMPLE for r=0.2 class 0.0 = 0.938 +- 0.421 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.461 +- 0.421 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.2 all KL = 0.639 +- 0.421 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.2 all L1 = 0.697 +- 0.355 (in-sample avg dev_std = 0.265)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009639199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.515
SUFF_SIMPLE for r=0.4 class 0.0 = 0.942 +- 0.418 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.464 +- 0.418 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.4 all KL = 0.653 +- 0.418 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.4 all L1 = 0.701 +- 0.358 (in-sample avg dev_std = 0.229)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009715999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.624
SUFF_SIMPLE for r=0.8 class 0.0 = 0.872 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.659 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.739 +- 0.376 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.764 +- 0.321 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266938
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.58
SUFF_SIMPLE for r=0.05 class 0.0 = 0.799 +- 0.397 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.558 +- 0.397 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.05 all KL = 0.649 +- 0.397 (in-sample avg dev_std = 0.299)
SUFF_SIMPLE for r=0.05 all L1 = 0.68 +- 0.323 (in-sample avg dev_std = 0.299)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0373308
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.579
SUFF_SIMPLE for r=0.1 class 0.0 = 0.808 +- 0.400 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.557 +- 0.400 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 all KL = 0.656 +- 0.400 (in-sample avg dev_std = 0.283)
SUFF_SIMPLE for r=0.1 all L1 = 0.684 +- 0.329 (in-sample avg dev_std = 0.283)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500774
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.588
SUFF_SIMPLE for r=0.2 class 0.0 = 0.799 +- 0.401 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.577 +- 0.401 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.2 all KL = 0.66 +- 0.401 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.2 all L1 = 0.689 +- 0.330 (in-sample avg dev_std = 0.258)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064822
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.593
SUFF_SIMPLE for r=0.4 class 0.0 = 0.778 +- 0.385 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.659 +- 0.385 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all KL = 0.7 +- 0.385 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.4 all L1 = 0.719 +- 0.325 (in-sample avg dev_std = 0.215)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.666
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0803778
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.671
SUFF_SIMPLE for r=0.8 class 0.0 = 0.91 +- 0.250 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.831 +- 0.250 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.892 +- 0.250 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.871 +- 0.239 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034804
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.932
NEC for r=0.05 class 0.0 = 0.09 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.045 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.05 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.065 +- 0.165 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.044708
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.861
NEC for r=0.1 class 0.0 = 0.241 +- 0.314 (in-sample avg dev_std = 0.047)
NEC for r=0.1 class 1.0 = 0.08 +- 0.314 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all KL = 0.147 +- 0.314 (in-sample avg dev_std = 0.047)
NEC for r=0.1 all L1 = 0.152 +- 0.273 (in-sample avg dev_std = 0.047)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056204000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.793
NEC for r=0.2 class 0.0 = 0.361 +- 0.385 (in-sample avg dev_std = 0.242)
NEC for r=0.2 class 1.0 = 0.12 +- 0.385 (in-sample avg dev_std = 0.242)
NEC for r=0.2 all KL = 0.248 +- 0.385 (in-sample avg dev_std = 0.242)
NEC for r=0.2 all L1 = 0.228 +- 0.314 (in-sample avg dev_std = 0.242)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06890600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.766
NEC for r=0.4 class 0.0 = 0.408 +- 0.398 (in-sample avg dev_std = 0.358)
NEC for r=0.4 class 1.0 = 0.189 +- 0.398 (in-sample avg dev_std = 0.358)
NEC for r=0.4 all KL = 0.339 +- 0.398 (in-sample avg dev_std = 0.358)
NEC for r=0.4 all L1 = 0.286 +- 0.308 (in-sample avg dev_std = 0.358)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828800000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.728
NEC for r=0.8 class 0.0 = 0.393 +- 0.398 (in-sample avg dev_std = 0.427)
NEC for r=0.8 class 1.0 = 0.253 +- 0.398 (in-sample avg dev_std = 0.427)
NEC for r=0.8 all KL = 0.397 +- 0.398 (in-sample avg dev_std = 0.427)
NEC for r=0.8 all L1 = 0.316 +- 0.300 (in-sample avg dev_std = 0.427)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.791
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086272
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.768
NEC for r=0.05 class 0.0 = 0.006 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.18 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.068 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.094 +- 0.195 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.791
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091434
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.738
NEC for r=0.1 class 0.0 = 0.025 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.241 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.12 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.134 +- 0.244 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.791
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009401000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.638
NEC for r=0.2 class 0.0 = 0.12 +- 0.373 (in-sample avg dev_std = 0.148)
NEC for r=0.2 class 1.0 = 0.343 +- 0.373 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all KL = 0.266 +- 0.373 (in-sample avg dev_std = 0.148)
NEC for r=0.2 all L1 = 0.232 +- 0.311 (in-sample avg dev_std = 0.148)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.791
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009639199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.618
NEC for r=0.4 class 0.0 = 0.143 +- 0.394 (in-sample avg dev_std = 0.364)
NEC for r=0.4 class 1.0 = 0.388 +- 0.394 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all KL = 0.348 +- 0.394 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all L1 = 0.267 +- 0.302 (in-sample avg dev_std = 0.364)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.791
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009715999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.617
NEC for r=0.8 class 0.0 = 0.148 +- 0.396 (in-sample avg dev_std = 0.411)
NEC for r=0.8 class 1.0 = 0.398 +- 0.396 (in-sample avg dev_std = 0.411)
NEC for r=0.8 all KL = 0.366 +- 0.396 (in-sample avg dev_std = 0.411)
NEC for r=0.8 all L1 = 0.274 +- 0.297 (in-sample avg dev_std = 0.411)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.666
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266938
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.661
NEC for r=0.05 class 0.0 = 0.042 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.076 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.03 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.059 +- 0.140 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.666
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0373308
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.662
NEC for r=0.1 class 0.0 = 0.063 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.111 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.058 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.087 +- 0.184 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.666
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500774
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.66
NEC for r=0.2 class 0.0 = 0.102 +- 0.258 (in-sample avg dev_std = 0.023)
NEC for r=0.2 class 1.0 = 0.175 +- 0.258 (in-sample avg dev_std = 0.023)
NEC for r=0.2 all KL = 0.116 +- 0.258 (in-sample avg dev_std = 0.023)
NEC for r=0.2 all L1 = 0.138 +- 0.247 (in-sample avg dev_std = 0.023)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.666
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064822
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.623
NEC for r=0.4 class 0.0 = 0.166 +- 0.322 (in-sample avg dev_std = 0.151)
NEC for r=0.4 class 1.0 = 0.23 +- 0.322 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all KL = 0.191 +- 0.322 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all L1 = 0.197 +- 0.287 (in-sample avg dev_std = 0.151)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.666
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0803778
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.597
NEC for r=0.8 class 0.0 = 0.171 +- 0.361 (in-sample avg dev_std = 0.252)
NEC for r=0.8 class 1.0 = 0.313 +- 0.361 (in-sample avg dev_std = 0.252)
NEC for r=0.8 all KL = 0.253 +- 0.361 (in-sample avg dev_std = 0.252)
NEC for r=0.8 all L1 = 0.241 +- 0.303 (in-sample avg dev_std = 0.252)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 17:59:30 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 05:59:30 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9910
Train Loss: 0.0398
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0312
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0530
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0312
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0530

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.038
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.062
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.029
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.040
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037700000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.61
SUFF_SIMPLE for r=0.05 class 0.0 = 0.507 +- 0.393 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.593 +- 0.393 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.05 all KL = 0.38 +- 0.393 (in-sample avg dev_std = 0.472)
SUFF_SIMPLE for r=0.05 all L1 = 0.555 +- 0.300 (in-sample avg dev_std = 0.472)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.626
SUFF_SIMPLE for r=0.1 class 0.0 = 0.502 +- 0.401 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.622 +- 0.401 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.1 all KL = 0.407 +- 0.401 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.1 all L1 = 0.568 +- 0.307 (in-sample avg dev_std = 0.441)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06214
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.651
SUFF_SIMPLE for r=0.2 class 0.0 = 0.492 +- 0.398 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.647 +- 0.398 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.2 all KL = 0.413 +- 0.398 (in-sample avg dev_std = 0.435)
SUFF_SIMPLE for r=0.2 all L1 = 0.578 +- 0.305 (in-sample avg dev_std = 0.435)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07128799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.639
SUFF_SIMPLE for r=0.4 class 0.0 = 0.513 +- 0.424 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.682 +- 0.424 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 all KL = 0.475 +- 0.424 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 all L1 = 0.606 +- 0.330 (in-sample avg dev_std = 0.386)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.738
SUFF_SIMPLE for r=0.8 class 0.0 = 0.606 +- 0.422 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.872 +- 0.422 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.726 +- 0.422 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.753 +- 0.359 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008740800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.525
SUFF_SIMPLE for r=0.05 class 0.0 = 0.665 +- 0.413 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.215 +- 0.413 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.05 all KL = 0.267 +- 0.413 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.05 all L1 = 0.438 +- 0.357 (in-sample avg dev_std = 0.427)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.527
SUFF_SIMPLE for r=0.1 class 0.0 = 0.666 +- 0.414 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.217 +- 0.414 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 all KL = 0.27 +- 0.414 (in-sample avg dev_std = 0.424)
SUFF_SIMPLE for r=0.1 all L1 = 0.44 +- 0.358 (in-sample avg dev_std = 0.424)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096732
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.526
SUFF_SIMPLE for r=0.2 class 0.0 = 0.667 +- 0.416 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.217 +- 0.416 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.2 all KL = 0.272 +- 0.416 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.2 all L1 = 0.44 +- 0.360 (in-sample avg dev_std = 0.416)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009841200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.524
SUFF_SIMPLE for r=0.4 class 0.0 = 0.67 +- 0.427 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.225 +- 0.427 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.4 all KL = 0.293 +- 0.427 (in-sample avg dev_std = 0.365)
SUFF_SIMPLE for r=0.4 all L1 = 0.446 +- 0.369 (in-sample avg dev_std = 0.365)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009777
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.623
SUFF_SIMPLE for r=0.8 class 0.0 = 0.426 +- 0.468 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.677 +- 0.468 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.453 +- 0.468 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.553 +- 0.401 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0287986
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.635
SUFF_SIMPLE for r=0.05 class 0.0 = 0.722 +- 0.397 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.57 +- 0.397 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.05 all KL = 0.588 +- 0.397 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.05 all L1 = 0.647 +- 0.302 (in-sample avg dev_std = 0.261)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.039788
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.63
SUFF_SIMPLE for r=0.1 class 0.0 = 0.698 +- 0.395 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.603 +- 0.395 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.1 all KL = 0.592 +- 0.395 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.1 all L1 = 0.651 +- 0.306 (in-sample avg dev_std = 0.247)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050878400000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.633
SUFF_SIMPLE for r=0.2 class 0.0 = 0.693 +- 0.390 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.638 +- 0.390 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all KL = 0.617 +- 0.390 (in-sample avg dev_std = 0.220)
SUFF_SIMPLE for r=0.2 all L1 = 0.666 +- 0.315 (in-sample avg dev_std = 0.220)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0654224
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.653
SUFF_SIMPLE for r=0.4 class 0.0 = 0.747 +- 0.383 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.667 +- 0.383 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 all KL = 0.683 +- 0.383 (in-sample avg dev_std = 0.163)
SUFF_SIMPLE for r=0.4 all L1 = 0.708 +- 0.320 (in-sample avg dev_std = 0.163)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.709
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0809076
len(reference) = 4981
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.735
SUFF_SIMPLE for r=0.8 class 0.0 = 0.909 +- 0.264 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.812 +- 0.264 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all KL = 0.879 +- 0.264 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.8 all L1 = 0.861 +- 0.247 (in-sample avg dev_std = 0.001)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037700000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.93
NEC for r=0.05 class 0.0 = 0.105 +- 0.226 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.03 +- 0.226 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.063 +- 0.226 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.064 +- 0.196 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.874
NEC for r=0.1 class 0.0 = 0.212 +- 0.317 (in-sample avg dev_std = 0.011)
NEC for r=0.1 class 1.0 = 0.052 +- 0.317 (in-sample avg dev_std = 0.011)
NEC for r=0.1 all KL = 0.134 +- 0.317 (in-sample avg dev_std = 0.011)
NEC for r=0.1 all L1 = 0.123 +- 0.268 (in-sample avg dev_std = 0.011)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06214
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.796
NEC for r=0.2 class 0.0 = 0.368 +- 0.406 (in-sample avg dev_std = 0.287)
NEC for r=0.2 class 1.0 = 0.089 +- 0.406 (in-sample avg dev_std = 0.287)
NEC for r=0.2 all KL = 0.26 +- 0.406 (in-sample avg dev_std = 0.287)
NEC for r=0.2 all L1 = 0.214 +- 0.319 (in-sample avg dev_std = 0.287)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07128799999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.748
NEC for r=0.4 class 0.0 = 0.428 +- 0.424 (in-sample avg dev_std = 0.375)
NEC for r=0.4 class 1.0 = 0.144 +- 0.424 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all KL = 0.35 +- 0.424 (in-sample avg dev_std = 0.375)
NEC for r=0.4 all L1 = 0.271 +- 0.326 (in-sample avg dev_std = 0.375)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.757
NEC for r=0.8 class 0.0 = 0.456 +- 0.414 (in-sample avg dev_std = 0.458)
NEC for r=0.8 class 1.0 = 0.185 +- 0.414 (in-sample avg dev_std = 0.458)
NEC for r=0.8 all KL = 0.421 +- 0.414 (in-sample avg dev_std = 0.458)
NEC for r=0.8 all L1 = 0.306 +- 0.310 (in-sample avg dev_std = 0.458)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008740800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.864
NEC for r=0.05 class 0.0 = 0.191 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.029 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.12 +- 0.286 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.109 +- 0.249 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093672
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.764
NEC for r=0.1 class 0.0 = 0.455 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.092 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.326 +- 0.439 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.272 +- 0.372 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096732
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.632
NEC for r=0.2 class 0.0 = 0.588 +- 0.469 (in-sample avg dev_std = 0.175)
NEC for r=0.2 class 1.0 = 0.288 +- 0.469 (in-sample avg dev_std = 0.175)
NEC for r=0.2 all KL = 0.543 +- 0.469 (in-sample avg dev_std = 0.175)
NEC for r=0.2 all L1 = 0.437 +- 0.397 (in-sample avg dev_std = 0.175)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009841200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.623
NEC for r=0.4 class 0.0 = 0.594 +- 0.442 (in-sample avg dev_std = 0.443)
NEC for r=0.4 class 1.0 = 0.366 +- 0.442 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all KL = 0.648 +- 0.442 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all L1 = 0.479 +- 0.364 (in-sample avg dev_std = 0.443)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009777
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.626
NEC for r=0.8 class 0.0 = 0.595 +- 0.423 (in-sample avg dev_std = 0.494)
NEC for r=0.8 class 1.0 = 0.377 +- 0.423 (in-sample avg dev_std = 0.494)
NEC for r=0.8 all KL = 0.682 +- 0.423 (in-sample avg dev_std = 0.494)
NEC for r=0.8 all L1 = 0.485 +- 0.351 (in-sample avg dev_std = 0.494)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.708
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0287986
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.71
NEC for r=0.05 class 0.0 = 0.039 +- 0.121 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.078 +- 0.121 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.121 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.058 +- 0.139 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.708
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.039788
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.716
NEC for r=0.1 class 0.0 = 0.06 +- 0.178 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.119 +- 0.178 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.062 +- 0.178 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.089 +- 0.187 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.708
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050878400000000004
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.715
NEC for r=0.2 class 0.0 = 0.099 +- 0.254 (in-sample avg dev_std = 0.046)
NEC for r=0.2 class 1.0 = 0.171 +- 0.254 (in-sample avg dev_std = 0.046)
NEC for r=0.2 all KL = 0.114 +- 0.254 (in-sample avg dev_std = 0.046)
NEC for r=0.2 all L1 = 0.134 +- 0.240 (in-sample avg dev_std = 0.046)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.708
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0654224
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.674
NEC for r=0.4 class 0.0 = 0.176 +- 0.314 (in-sample avg dev_std = 0.118)
NEC for r=0.4 class 1.0 = 0.212 +- 0.314 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all KL = 0.186 +- 0.314 (in-sample avg dev_std = 0.118)
NEC for r=0.4 all L1 = 0.194 +- 0.279 (in-sample avg dev_std = 0.118)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.708
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0809076
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.647
NEC for r=0.8 class 0.0 = 0.235 +- 0.357 (in-sample avg dev_std = 0.234)
NEC for r=0.8 class 1.0 = 0.276 +- 0.357 (in-sample avg dev_std = 0.234)
NEC for r=0.8 all KL = 0.283 +- 0.357 (in-sample avg dev_std = 0.234)
NEC for r=0.8 all L1 = 0.255 +- 0.288 (in-sample avg dev_std = 0.234)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 18:18:01 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:18:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 90 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 90...
[0m[1;37mINFO[0m: [1mCheckpoint 90: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0298
ID Validation ACCURACY: 0.9880
ID Validation Loss: 0.0315
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0329
OOD Validation ACCURACY: 0.9880
OOD Validation Loss: 0.0315
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0329

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9880 0.9880[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.040
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.049
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.059
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.028
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.038
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04007000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.622
SUFF_SIMPLE for r=0.05 class 0.0 = 0.534 +- 0.389 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.592 +- 0.389 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.05 all KL = 0.437 +- 0.389 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.05 all L1 = 0.566 +- 0.299 (in-sample avg dev_std = 0.433)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048693999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.633
SUFF_SIMPLE for r=0.1 class 0.0 = 0.541 +- 0.395 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.594 +- 0.395 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all KL = 0.442 +- 0.395 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all L1 = 0.57 +- 0.301 (in-sample avg dev_std = 0.427)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059098
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.655
SUFF_SIMPLE for r=0.2 class 0.0 = 0.526 +- 0.396 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.636 +- 0.396 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 all KL = 0.471 +- 0.396 (in-sample avg dev_std = 0.393)
SUFF_SIMPLE for r=0.2 all L1 = 0.587 +- 0.308 (in-sample avg dev_std = 0.393)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073508
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.644
SUFF_SIMPLE for r=0.4 class 0.0 = 0.547 +- 0.420 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.654 +- 0.420 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.4 all KL = 0.514 +- 0.420 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.4 all L1 = 0.606 +- 0.328 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080304
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.802
SUFF_SIMPLE for r=0.8 class 0.0 = 0.673 +- 0.390 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.881 +- 0.390 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.764 +- 0.390 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.789 +- 0.323 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092758
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.531
SUFF_SIMPLE for r=0.05 class 0.0 = 0.785 +- 0.418 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.269 +- 0.418 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.05 all KL = 0.42 +- 0.418 (in-sample avg dev_std = 0.417)
SUFF_SIMPLE for r=0.05 all L1 = 0.525 +- 0.353 (in-sample avg dev_std = 0.417)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0095294
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.529
SUFF_SIMPLE for r=0.1 class 0.0 = 0.786 +- 0.418 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.269 +- 0.418 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.1 all KL = 0.424 +- 0.418 (in-sample avg dev_std = 0.408)
SUFF_SIMPLE for r=0.1 all L1 = 0.526 +- 0.355 (in-sample avg dev_std = 0.408)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0097084
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.529
SUFF_SIMPLE for r=0.2 class 0.0 = 0.786 +- 0.418 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.27 +- 0.418 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all KL = 0.423 +- 0.418 (in-sample avg dev_std = 0.404)
SUFF_SIMPLE for r=0.2 all L1 = 0.526 +- 0.355 (in-sample avg dev_std = 0.404)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0097986
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.533
SUFF_SIMPLE for r=0.4 class 0.0 = 0.792 +- 0.424 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.28 +- 0.424 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.4 all KL = 0.445 +- 0.424 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.4 all L1 = 0.534 +- 0.362 (in-sample avg dev_std = 0.355)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0098394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.698
SUFF_SIMPLE for r=0.8 class 0.0 = 0.612 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.672 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.607 +- 0.423 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.642 +- 0.355 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027963400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.585
SUFF_SIMPLE for r=0.05 class 0.0 = 0.768 +- 0.391 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.592 +- 0.391 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.05 all KL = 0.638 +- 0.391 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.05 all L1 = 0.681 +- 0.311 (in-sample avg dev_std = 0.235)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0377118
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.589
SUFF_SIMPLE for r=0.1 class 0.0 = 0.754 +- 0.391 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.617 +- 0.391 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 all KL = 0.644 +- 0.391 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.1 all L1 = 0.686 +- 0.311 (in-sample avg dev_std = 0.223)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0494224
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.603
SUFF_SIMPLE for r=0.2 class 0.0 = 0.752 +- 0.383 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.645 +- 0.383 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all KL = 0.662 +- 0.383 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all L1 = 0.699 +- 0.312 (in-sample avg dev_std = 0.200)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.063401
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.619
SUFF_SIMPLE for r=0.4 class 0.0 = 0.786 +- 0.376 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.668 +- 0.376 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.4 all KL = 0.709 +- 0.376 (in-sample avg dev_std = 0.148)
SUFF_SIMPLE for r=0.4 all L1 = 0.728 +- 0.320 (in-sample avg dev_std = 0.148)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079007
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.668
SUFF_SIMPLE for r=0.8 class 0.0 = 0.928 +- 0.229 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.837 +- 0.229 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.905 +- 0.229 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.883 +- 0.226 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04007000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.97
NEC for r=0.05 class 0.0 = 0.057 +- 0.153 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.034 +- 0.153 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.036 +- 0.153 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.044 +- 0.134 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.048693999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.912
NEC for r=0.1 class 0.0 = 0.179 +- 0.276 (in-sample avg dev_std = 0.014)
NEC for r=0.1 class 1.0 = 0.046 +- 0.276 (in-sample avg dev_std = 0.014)
NEC for r=0.1 all KL = 0.112 +- 0.276 (in-sample avg dev_std = 0.014)
NEC for r=0.1 all L1 = 0.105 +- 0.228 (in-sample avg dev_std = 0.014)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059098
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.817
NEC for r=0.2 class 0.0 = 0.311 +- 0.388 (in-sample avg dev_std = 0.254)
NEC for r=0.2 class 1.0 = 0.112 +- 0.388 (in-sample avg dev_std = 0.254)
NEC for r=0.2 all KL = 0.242 +- 0.388 (in-sample avg dev_std = 0.254)
NEC for r=0.2 all L1 = 0.2 +- 0.302 (in-sample avg dev_std = 0.254)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.073508
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.777
NEC for r=0.4 class 0.0 = 0.378 +- 0.410 (in-sample avg dev_std = 0.362)
NEC for r=0.4 class 1.0 = 0.152 +- 0.410 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all KL = 0.315 +- 0.410 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all L1 = 0.253 +- 0.311 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080304
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.773
NEC for r=0.8 class 0.0 = 0.38 +- 0.405 (in-sample avg dev_std = 0.439)
NEC for r=0.8 class 1.0 = 0.206 +- 0.405 (in-sample avg dev_std = 0.439)
NEC for r=0.8 all KL = 0.377 +- 0.405 (in-sample avg dev_std = 0.439)
NEC for r=0.8 all L1 = 0.283 +- 0.293 (in-sample avg dev_std = 0.439)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.902
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092758
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.912
NEC for r=0.05 class 0.0 = 0.077 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.161 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.08 +- 0.186 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.12 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.902
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0095294
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.879
NEC for r=0.1 class 0.0 = 0.158 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.214 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.172 +- 0.303 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.186 +- 0.273 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.902
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0097084
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.713
NEC for r=0.2 class 0.0 = 0.381 +- 0.420 (in-sample avg dev_std = 0.198)
NEC for r=0.2 class 1.0 = 0.32 +- 0.420 (in-sample avg dev_std = 0.198)
NEC for r=0.2 all KL = 0.395 +- 0.420 (in-sample avg dev_std = 0.198)
NEC for r=0.2 all L1 = 0.351 +- 0.346 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.902
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0097986
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.694
NEC for r=0.4 class 0.0 = 0.41 +- 0.415 (in-sample avg dev_std = 0.441)
NEC for r=0.4 class 1.0 = 0.379 +- 0.415 (in-sample avg dev_std = 0.441)
NEC for r=0.4 all KL = 0.48 +- 0.415 (in-sample avg dev_std = 0.441)
NEC for r=0.4 all L1 = 0.394 +- 0.321 (in-sample avg dev_std = 0.441)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.902
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0098394
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.692
NEC for r=0.8 class 0.0 = 0.415 +- 0.404 (in-sample avg dev_std = 0.484)
NEC for r=0.8 class 1.0 = 0.393 +- 0.404 (in-sample avg dev_std = 0.484)
NEC for r=0.8 all KL = 0.498 +- 0.404 (in-sample avg dev_std = 0.484)
NEC for r=0.8 all L1 = 0.404 +- 0.312 (in-sample avg dev_std = 0.484)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.653
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027963400000000003
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.657
NEC for r=0.05 class 0.0 = 0.036 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.074 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.110 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.055 +- 0.137 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.653
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0377118
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.66
NEC for r=0.1 class 0.0 = 0.051 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.11 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.052 +- 0.159 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.08 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.653
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0494224
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.671
NEC for r=0.2 class 0.0 = 0.08 +- 0.245 (in-sample avg dev_std = 0.007)
NEC for r=0.2 class 1.0 = 0.18 +- 0.245 (in-sample avg dev_std = 0.007)
NEC for r=0.2 all KL = 0.108 +- 0.245 (in-sample avg dev_std = 0.007)
NEC for r=0.2 all L1 = 0.129 +- 0.239 (in-sample avg dev_std = 0.007)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.653
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.063401
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.638
NEC for r=0.4 class 0.0 = 0.144 +- 0.311 (in-sample avg dev_std = 0.091)
NEC for r=0.4 class 1.0 = 0.229 +- 0.311 (in-sample avg dev_std = 0.091)
NEC for r=0.4 all KL = 0.177 +- 0.311 (in-sample avg dev_std = 0.091)
NEC for r=0.4 all L1 = 0.186 +- 0.283 (in-sample avg dev_std = 0.091)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.653
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079007
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.605
NEC for r=0.8 class 0.0 = 0.19 +- 0.351 (in-sample avg dev_std = 0.204)
NEC for r=0.8 class 1.0 = 0.296 +- 0.351 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all KL = 0.261 +- 0.351 (in-sample avg dev_std = 0.204)
NEC for r=0.8 all L1 = 0.242 +- 0.294 (in-sample avg dev_std = 0.204)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 18:36:34 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:36:35 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9912
Train Loss: 0.0222
ID Validation ACCURACY: 0.9920
ID Validation Loss: 0.0180
ID Test ACCURACY: 0.9920
ID Test Loss: 0.0294
OOD Validation ACCURACY: 0.9920
OOD Validation Loss: 0.0180
OOD Test ACCURACY: 0.9920
OOD Test Loss: 0.0294

[0m[1;37mINFO[0m: [1mChartInfo 0.9920 0.9920 0.9920 0.9920 0.9920 0.9920[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.034
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03444199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.603
SUFF_SIMPLE for r=0.05 class 0.0 = 0.492 +- 0.390 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.577 +- 0.390 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.05 all KL = 0.322 +- 0.390 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.05 all L1 = 0.539 +- 0.301 (in-sample avg dev_std = 0.493)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046655999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.624
SUFF_SIMPLE for r=0.1 class 0.0 = 0.485 +- 0.404 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.617 +- 0.404 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.1 all KL = 0.354 +- 0.404 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.1 all L1 = 0.559 +- 0.311 (in-sample avg dev_std = 0.465)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.605
SUFF_SIMPLE for r=0.2 class 0.0 = 0.462 +- 0.408 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.669 +- 0.408 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 all KL = 0.389 +- 0.408 (in-sample avg dev_std = 0.447)
SUFF_SIMPLE for r=0.2 all L1 = 0.576 +- 0.329 (in-sample avg dev_std = 0.447)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070048
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.612
SUFF_SIMPLE for r=0.4 class 0.0 = 0.502 +- 0.446 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.685 +- 0.446 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.4 all KL = 0.458 +- 0.446 (in-sample avg dev_std = 0.359)
SUFF_SIMPLE for r=0.4 all L1 = 0.603 +- 0.353 (in-sample avg dev_std = 0.359)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080336
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.758
SUFF_SIMPLE for r=0.8 class 0.0 = 0.64 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.74 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.778 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084298
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.513
SUFF_SIMPLE for r=0.05 class 0.0 = 0.916 +- 0.479 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.221 +- 0.479 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 all KL = 0.45 +- 0.479 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 all L1 = 0.565 +- 0.398 (in-sample avg dev_std = 0.352)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0089742
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.512
SUFF_SIMPLE for r=0.1 class 0.0 = 0.916 +- 0.479 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.22 +- 0.479 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.1 all KL = 0.451 +- 0.479 (in-sample avg dev_std = 0.347)
SUFF_SIMPLE for r=0.1 all L1 = 0.566 +- 0.399 (in-sample avg dev_std = 0.347)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009020199999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.514
SUFF_SIMPLE for r=0.2 class 0.0 = 0.917 +- 0.479 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.223 +- 0.479 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.2 all KL = 0.452 +- 0.479 (in-sample avg dev_std = 0.343)
SUFF_SIMPLE for r=0.2 all L1 = 0.567 +- 0.399 (in-sample avg dev_std = 0.343)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009419400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.513
SUFF_SIMPLE for r=0.4 class 0.0 = 0.919 +- 0.481 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.227 +- 0.481 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 all KL = 0.467 +- 0.481 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.4 all L1 = 0.57 +- 0.404 (in-sample avg dev_std = 0.305)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658199999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.616
SUFF_SIMPLE for r=0.8 class 0.0 = 0.693 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.623 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.579 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.658 +- 0.398 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0259716
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.617
SUFF_SIMPLE for r=0.05 class 0.0 = 0.699 +- 0.416 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.596 +- 0.416 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.05 all KL = 0.56 +- 0.416 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.05 all L1 = 0.648 +- 0.318 (in-sample avg dev_std = 0.271)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368228
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.6
SUFF_SIMPLE for r=0.1 class 0.0 = 0.679 +- 0.413 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.638 +- 0.413 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.1 all KL = 0.58 +- 0.413 (in-sample avg dev_std = 0.259)
SUFF_SIMPLE for r=0.1 all L1 = 0.659 +- 0.331 (in-sample avg dev_std = 0.259)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500588
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.599
SUFF_SIMPLE for r=0.2 class 0.0 = 0.683 +- 0.412 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.663 +- 0.412 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 all KL = 0.607 +- 0.412 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 all L1 = 0.673 +- 0.340 (in-sample avg dev_std = 0.237)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0645058
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.626
SUFF_SIMPLE for r=0.4 class 0.0 = 0.753 +- 0.402 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.678 +- 0.402 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.67 +- 0.402 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.716 +- 0.335 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.661
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07993779999999999
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.687
SUFF_SIMPLE for r=0.8 class 0.0 = 0.932 +- 0.263 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.832 +- 0.263 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.889 +- 0.263 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.882 +- 0.242 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.992
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03444199999999999
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.928
NEC for r=0.05 class 0.0 = 0.122 +- 0.240 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.027 +- 0.240 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.076 +- 0.240 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.069 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.992
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046655999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.853
NEC for r=0.1 class 0.0 = 0.247 +- 0.353 (in-sample avg dev_std = 0.032)
NEC for r=0.1 class 1.0 = 0.055 +- 0.353 (in-sample avg dev_std = 0.032)
NEC for r=0.1 all KL = 0.166 +- 0.353 (in-sample avg dev_std = 0.032)
NEC for r=0.1 all L1 = 0.141 +- 0.290 (in-sample avg dev_std = 0.032)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.992
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.060906
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.773
NEC for r=0.2 class 0.0 = 0.362 +- 0.418 (in-sample avg dev_std = 0.229)
NEC for r=0.2 class 1.0 = 0.111 +- 0.418 (in-sample avg dev_std = 0.229)
NEC for r=0.2 all KL = 0.273 +- 0.418 (in-sample avg dev_std = 0.229)
NEC for r=0.2 all L1 = 0.223 +- 0.339 (in-sample avg dev_std = 0.229)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.992
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070048
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.727
NEC for r=0.4 class 0.0 = 0.44 +- 0.446 (in-sample avg dev_std = 0.364)
NEC for r=0.4 class 1.0 = 0.155 +- 0.446 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all KL = 0.376 +- 0.446 (in-sample avg dev_std = 0.364)
NEC for r=0.4 all L1 = 0.282 +- 0.345 (in-sample avg dev_std = 0.364)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.992
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080336
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.725
NEC for r=0.8 class 0.0 = 0.461 +- 0.435 (in-sample avg dev_std = 0.442)
NEC for r=0.8 class 1.0 = 0.202 +- 0.435 (in-sample avg dev_std = 0.442)
NEC for r=0.8 all KL = 0.457 +- 0.435 (in-sample avg dev_std = 0.442)
NEC for r=0.8 all L1 = 0.318 +- 0.329 (in-sample avg dev_std = 0.442)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.959
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084298
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.935
NEC for r=0.05 class 0.0 = 0.052 +- 0.217 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.077 +- 0.217 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.067 +- 0.217 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.064 +- 0.192 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.959
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0089742
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.826
NEC for r=0.1 class 0.0 = 0.194 +- 0.375 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.139 +- 0.375 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.206 +- 0.375 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.166 +- 0.310 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.959
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009020199999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.634
NEC for r=0.2 class 0.0 = 0.326 +- 0.470 (in-sample avg dev_std = 0.217)
NEC for r=0.2 class 1.0 = 0.347 +- 0.470 (in-sample avg dev_std = 0.217)
NEC for r=0.2 all KL = 0.431 +- 0.470 (in-sample avg dev_std = 0.217)
NEC for r=0.2 all L1 = 0.337 +- 0.388 (in-sample avg dev_std = 0.217)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.959
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009419400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.614
NEC for r=0.4 class 0.0 = 0.33 +- 0.467 (in-sample avg dev_std = 0.478)
NEC for r=0.4 class 1.0 = 0.436 +- 0.467 (in-sample avg dev_std = 0.478)
NEC for r=0.4 all KL = 0.552 +- 0.467 (in-sample avg dev_std = 0.478)
NEC for r=0.4 all L1 = 0.383 +- 0.363 (in-sample avg dev_std = 0.478)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.959
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658199999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.616
NEC for r=0.8 class 0.0 = 0.334 +- 0.459 (in-sample avg dev_std = 0.537)
NEC for r=0.8 class 1.0 = 0.455 +- 0.459 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all KL = 0.594 +- 0.459 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all L1 = 0.395 +- 0.350 (in-sample avg dev_std = 0.537)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.66
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0259716
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.668
NEC for r=0.05 class 0.0 = 0.035 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.073 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.033 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.054 +- 0.143 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.66
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368228
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.671
NEC for r=0.1 class 0.0 = 0.052 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.111 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.064 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.081 +- 0.192 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.66
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500588
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.679
NEC for r=0.2 class 0.0 = 0.083 +- 0.271 (in-sample avg dev_std = 0.031)
NEC for r=0.2 class 1.0 = 0.169 +- 0.271 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all KL = 0.118 +- 0.271 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all L1 = 0.126 +- 0.251 (in-sample avg dev_std = 0.031)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.66
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0645058
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.639
NEC for r=0.4 class 0.0 = 0.167 +- 0.339 (in-sample avg dev_std = 0.130)
NEC for r=0.4 class 1.0 = 0.215 +- 0.339 (in-sample avg dev_std = 0.130)
NEC for r=0.4 all KL = 0.201 +- 0.339 (in-sample avg dev_std = 0.130)
NEC for r=0.4 all L1 = 0.191 +- 0.295 (in-sample avg dev_std = 0.130)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07993779999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.61
NEC for r=0.8 class 0.0 = 0.236 +- 0.378 (in-sample avg dev_std = 0.244)
NEC for r=0.8 class 1.0 = 0.268 +- 0.378 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all KL = 0.301 +- 0.378 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all L1 = 0.252 +- 0.309 (in-sample avg dev_std = 0.244)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 18:55:21 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 06:55:21 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9865
Train Loss: 0.0472
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0524
ID Test ACCURACY: 0.9880
ID Test Loss: 0.0595
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0524
OOD Test ACCURACY: 0.9880
OOD Test Loss: 0.0595

[0m[1;37mINFO[0m: [1mChartInfo 0.9880 0.9880 0.9880 0.9880 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.060
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.070
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03541
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.601
SUFF_SIMPLE for r=0.05 class 0.0 = 0.557 +- 0.395 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.552 +- 0.395 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all KL = 0.431 +- 0.395 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.05 all L1 = 0.554 +- 0.300 (in-sample avg dev_std = 0.440)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04666200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.618
SUFF_SIMPLE for r=0.1 class 0.0 = 0.558 +- 0.404 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.573 +- 0.404 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.1 all KL = 0.452 +- 0.404 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.1 all L1 = 0.566 +- 0.307 (in-sample avg dev_std = 0.428)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059781999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.617
SUFF_SIMPLE for r=0.2 class 0.0 = 0.556 +- 0.407 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.59 +- 0.407 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.2 all KL = 0.464 +- 0.407 (in-sample avg dev_std = 0.409)
SUFF_SIMPLE for r=0.2 all L1 = 0.575 +- 0.315 (in-sample avg dev_std = 0.409)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070386
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.636
SUFF_SIMPLE for r=0.4 class 0.0 = 0.532 +- 0.422 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.643 +- 0.422 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.4 all KL = 0.508 +- 0.422 (in-sample avg dev_std = 0.350)
SUFF_SIMPLE for r=0.4 all L1 = 0.593 +- 0.331 (in-sample avg dev_std = 0.350)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07937000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.589 +- 0.418 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.418 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.705 +- 0.418 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.727 +- 0.351 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090016
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.511
SUFF_SIMPLE for r=0.05 class 0.0 = 0.916 +- 0.429 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.298 +- 0.429 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.05 all KL = 0.543 +- 0.429 (in-sample avg dev_std = 0.265)
SUFF_SIMPLE for r=0.05 all L1 = 0.604 +- 0.367 (in-sample avg dev_std = 0.265)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094584
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.51
SUFF_SIMPLE for r=0.1 class 0.0 = 0.917 +- 0.429 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.298 +- 0.429 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all KL = 0.546 +- 0.429 (in-sample avg dev_std = 0.262)
SUFF_SIMPLE for r=0.1 all L1 = 0.605 +- 0.368 (in-sample avg dev_std = 0.262)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095112
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.51
SUFF_SIMPLE for r=0.2 class 0.0 = 0.917 +- 0.429 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.299 +- 0.429 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.2 all KL = 0.547 +- 0.429 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.2 all L1 = 0.606 +- 0.368 (in-sample avg dev_std = 0.258)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096676
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.511
SUFF_SIMPLE for r=0.4 class 0.0 = 0.921 +- 0.430 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.299 +- 0.430 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.4 all KL = 0.554 +- 0.430 (in-sample avg dev_std = 0.232)
SUFF_SIMPLE for r=0.4 all L1 = 0.607 +- 0.370 (in-sample avg dev_std = 0.232)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097348
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.62
SUFF_SIMPLE for r=0.8 class 0.0 = 0.691 +- 0.418 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.654 +- 0.418 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.632 +- 0.418 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.672 +- 0.338 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266952
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.599
SUFF_SIMPLE for r=0.05 class 0.0 = 0.79 +- 0.396 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.572 +- 0.396 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.05 all KL = 0.637 +- 0.396 (in-sample avg dev_std = 0.255)
SUFF_SIMPLE for r=0.05 all L1 = 0.682 +- 0.316 (in-sample avg dev_std = 0.255)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368964
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.608
SUFF_SIMPLE for r=0.1 class 0.0 = 0.795 +- 0.394 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.588 +- 0.394 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.1 all KL = 0.654 +- 0.394 (in-sample avg dev_std = 0.228)
SUFF_SIMPLE for r=0.1 all L1 = 0.693 +- 0.319 (in-sample avg dev_std = 0.228)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0488506
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.616
SUFF_SIMPLE for r=0.2 class 0.0 = 0.785 +- 0.389 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.63 +- 0.389 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all KL = 0.674 +- 0.389 (in-sample avg dev_std = 0.209)
SUFF_SIMPLE for r=0.2 all L1 = 0.708 +- 0.319 (in-sample avg dev_std = 0.209)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0633258
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.63
SUFF_SIMPLE for r=0.4 class 0.0 = 0.787 +- 0.377 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.685 +- 0.377 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 all KL = 0.717 +- 0.377 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.4 all L1 = 0.737 +- 0.319 (in-sample avg dev_std = 0.154)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.686
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791104
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.699
SUFF_SIMPLE for r=0.8 class 0.0 = 0.92 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.853 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.908 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.887 +- 0.221 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03541
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.912
NEC for r=0.05 class 0.0 = 0.18 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.032 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.09 +- 0.258 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.098 +- 0.224 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04666200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.841
NEC for r=0.1 class 0.0 = 0.291 +- 0.337 (in-sample avg dev_std = 0.031)
NEC for r=0.1 class 1.0 = 0.074 +- 0.337 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.17 +- 0.337 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.171 +- 0.290 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059781999999999995
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.761
NEC for r=0.2 class 0.0 = 0.403 +- 0.406 (in-sample avg dev_std = 0.240)
NEC for r=0.2 class 1.0 = 0.128 +- 0.406 (in-sample avg dev_std = 0.240)
NEC for r=0.2 all KL = 0.274 +- 0.406 (in-sample avg dev_std = 0.240)
NEC for r=0.2 all L1 = 0.251 +- 0.329 (in-sample avg dev_std = 0.240)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070386
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.756
NEC for r=0.4 class 0.0 = 0.442 +- 0.409 (in-sample avg dev_std = 0.332)
NEC for r=0.4 class 1.0 = 0.155 +- 0.409 (in-sample avg dev_std = 0.332)
NEC for r=0.4 all KL = 0.327 +- 0.409 (in-sample avg dev_std = 0.332)
NEC for r=0.4 all L1 = 0.283 +- 0.323 (in-sample avg dev_std = 0.332)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07937000000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.733
NEC for r=0.8 class 0.0 = 0.447 +- 0.411 (in-sample avg dev_std = 0.407)
NEC for r=0.8 class 1.0 = 0.221 +- 0.411 (in-sample avg dev_std = 0.407)
NEC for r=0.8 all KL = 0.396 +- 0.411 (in-sample avg dev_std = 0.407)
NEC for r=0.8 all L1 = 0.321 +- 0.315 (in-sample avg dev_std = 0.407)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.898
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090016
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.869
NEC for r=0.05 class 0.0 = 0.039 +- 0.158 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.115 +- 0.158 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.047 +- 0.158 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.077 +- 0.154 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.898
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094584
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.797
NEC for r=0.1 class 0.0 = 0.142 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.177 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.156 +- 0.306 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.159 +- 0.247 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.898
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095112
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.63
NEC for r=0.2 class 0.0 = 0.31 +- 0.414 (in-sample avg dev_std = 0.155)
NEC for r=0.2 class 1.0 = 0.331 +- 0.414 (in-sample avg dev_std = 0.155)
NEC for r=0.2 all KL = 0.365 +- 0.414 (in-sample avg dev_std = 0.155)
NEC for r=0.2 all L1 = 0.321 +- 0.328 (in-sample avg dev_std = 0.155)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.898
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096676
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.617
NEC for r=0.4 class 0.0 = 0.309 +- 0.413 (in-sample avg dev_std = 0.368)
NEC for r=0.4 class 1.0 = 0.393 +- 0.413 (in-sample avg dev_std = 0.368)
NEC for r=0.4 all KL = 0.43 +- 0.413 (in-sample avg dev_std = 0.368)
NEC for r=0.4 all L1 = 0.351 +- 0.312 (in-sample avg dev_std = 0.368)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.898
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097348
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.617
NEC for r=0.8 class 0.0 = 0.316 +- 0.409 (in-sample avg dev_std = 0.411)
NEC for r=0.8 class 1.0 = 0.4 +- 0.409 (in-sample avg dev_std = 0.411)
NEC for r=0.8 all KL = 0.447 +- 0.409 (in-sample avg dev_std = 0.411)
NEC for r=0.8 all L1 = 0.358 +- 0.304 (in-sample avg dev_std = 0.411)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.685
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0266952
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.683
NEC for r=0.05 class 0.0 = 0.04 +- 0.112 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.066 +- 0.112 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.027 +- 0.112 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.053 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.685
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0368964
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.687
NEC for r=0.1 class 0.0 = 0.058 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.1 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.052 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.079 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.685
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0488506
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.69
NEC for r=0.2 class 0.0 = 0.094 +- 0.236 (in-sample avg dev_std = 0.024)
NEC for r=0.2 class 1.0 = 0.155 +- 0.236 (in-sample avg dev_std = 0.024)
NEC for r=0.2 all KL = 0.102 +- 0.236 (in-sample avg dev_std = 0.024)
NEC for r=0.2 all L1 = 0.125 +- 0.232 (in-sample avg dev_std = 0.024)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.685
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0633258
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.653
NEC for r=0.4 class 0.0 = 0.158 +- 0.303 (in-sample avg dev_std = 0.113)
NEC for r=0.4 class 1.0 = 0.202 +- 0.303 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all KL = 0.171 +- 0.303 (in-sample avg dev_std = 0.113)
NEC for r=0.4 all L1 = 0.18 +- 0.275 (in-sample avg dev_std = 0.113)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.685
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791104
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.614
NEC for r=0.8 class 0.0 = 0.177 +- 0.353 (in-sample avg dev_std = 0.222)
NEC for r=0.8 class 1.0 = 0.286 +- 0.353 (in-sample avg dev_std = 0.222)
NEC for r=0.8 all KL = 0.25 +- 0.353 (in-sample avg dev_std = 0.222)
NEC for r=0.8 all L1 = 0.231 +- 0.291 (in-sample avg dev_std = 0.222)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 19:13:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:13:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 91 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 91...
[0m[1;37mINFO[0m: [1mCheckpoint 91: 
-----------------------------------
Train ACCURACY: 0.9830
Train Loss: 0.0549
ID Validation ACCURACY: 0.9820
ID Validation Loss: 0.0538
ID Test ACCURACY: 0.9780
ID Test Loss: 0.0652
OOD Validation ACCURACY: 0.9820
OOD Validation Loss: 0.0538
OOD Test ACCURACY: 0.9780
OOD Test Loss: 0.0652

[0m[1;37mINFO[0m: [1mChartInfo 0.9780 0.9780 0.9780 0.9780 0.9820 0.9820[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.039
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.057
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.038
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.050
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03925800000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.614
SUFF_SIMPLE for r=0.05 class 0.0 = 0.588 +- 0.391 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.558 +- 0.391 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.05 all KL = 0.465 +- 0.391 (in-sample avg dev_std = 0.430)
SUFF_SIMPLE for r=0.05 all L1 = 0.571 +- 0.297 (in-sample avg dev_std = 0.430)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.049504000000000006
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.604
SUFF_SIMPLE for r=0.1 class 0.0 = 0.587 +- 0.396 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.559 +- 0.396 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.1 all KL = 0.467 +- 0.396 (in-sample avg dev_std = 0.423)
SUFF_SIMPLE for r=0.1 all L1 = 0.571 +- 0.301 (in-sample avg dev_std = 0.423)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.618
SUFF_SIMPLE for r=0.2 class 0.0 = 0.592 +- 0.401 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.572 +- 0.401 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.2 all KL = 0.481 +- 0.401 (in-sample avg dev_std = 0.411)
SUFF_SIMPLE for r=0.2 all L1 = 0.581 +- 0.305 (in-sample avg dev_std = 0.411)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.068316
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.662
SUFF_SIMPLE for r=0.4 class 0.0 = 0.587 +- 0.411 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.666 +- 0.411 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 all KL = 0.553 +- 0.411 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.4 all L1 = 0.63 +- 0.322 (in-sample avg dev_std = 0.346)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077988
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.764
SUFF_SIMPLE for r=0.8 class 0.0 = 0.647 +- 0.392 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.868 +- 0.392 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.76 +- 0.392 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.769 +- 0.334 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081226
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.515
SUFF_SIMPLE for r=0.05 class 0.0 = 0.937 +- 0.342 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.681 +- 0.342 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.05 all KL = 0.764 +- 0.342 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.05 all L1 = 0.808 +- 0.276 (in-sample avg dev_std = 0.247)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0086932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.516
SUFF_SIMPLE for r=0.1 class 0.0 = 0.937 +- 0.341 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.681 +- 0.341 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.1 all KL = 0.767 +- 0.341 (in-sample avg dev_std = 0.242)
SUFF_SIMPLE for r=0.1 all L1 = 0.808 +- 0.277 (in-sample avg dev_std = 0.242)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091848
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.513
SUFF_SIMPLE for r=0.2 class 0.0 = 0.936 +- 0.340 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.68 +- 0.340 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 all KL = 0.768 +- 0.340 (in-sample avg dev_std = 0.237)
SUFF_SIMPLE for r=0.2 all L1 = 0.807 +- 0.279 (in-sample avg dev_std = 0.237)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.513
SUFF_SIMPLE for r=0.4 class 0.0 = 0.941 +- 0.335 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.682 +- 0.335 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.4 all KL = 0.777 +- 0.335 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.4 all L1 = 0.811 +- 0.280 (in-sample avg dev_std = 0.205)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.598
SUFF_SIMPLE for r=0.8 class 0.0 = 0.877 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.765 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.789 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.82 +- 0.262 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027093799999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.588
SUFF_SIMPLE for r=0.05 class 0.0 = 0.797 +- 0.390 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.579 +- 0.390 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.05 all KL = 0.653 +- 0.390 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.05 all L1 = 0.689 +- 0.311 (in-sample avg dev_std = 0.250)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0379552
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.59
SUFF_SIMPLE for r=0.1 class 0.0 = 0.797 +- 0.390 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.587 +- 0.390 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 all KL = 0.662 +- 0.390 (in-sample avg dev_std = 0.227)
SUFF_SIMPLE for r=0.1 all L1 = 0.693 +- 0.313 (in-sample avg dev_std = 0.227)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500464
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.598
SUFF_SIMPLE for r=0.2 class 0.0 = 0.791 +- 0.388 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.616 +- 0.388 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.2 all KL = 0.676 +- 0.388 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.2 all L1 = 0.704 +- 0.314 (in-sample avg dev_std = 0.211)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0653638
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.619
SUFF_SIMPLE for r=0.4 class 0.0 = 0.796 +- 0.381 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.664 +- 0.381 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all KL = 0.715 +- 0.381 (in-sample avg dev_std = 0.156)
SUFF_SIMPLE for r=0.4 all L1 = 0.731 +- 0.319 (in-sample avg dev_std = 0.156)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.66
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07935
len(reference) = 4983
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.675
SUFF_SIMPLE for r=0.8 class 0.0 = 0.921 +- 0.232 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.844 +- 0.232 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.905 +- 0.232 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.883 +- 0.226 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.982
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03925800000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.944
NEC for r=0.05 class 0.0 = 0.081 +- 0.203 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.048 +- 0.203 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.055 +- 0.203 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.063 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.982
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.049504000000000006
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.894
NEC for r=0.1 class 0.0 = 0.167 +- 0.279 (in-sample avg dev_std = 0.017)
NEC for r=0.1 class 1.0 = 0.077 +- 0.279 (in-sample avg dev_std = 0.017)
NEC for r=0.1 all KL = 0.111 +- 0.279 (in-sample avg dev_std = 0.017)
NEC for r=0.1 all L1 = 0.117 +- 0.238 (in-sample avg dev_std = 0.017)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.982
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056652
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.817
NEC for r=0.2 class 0.0 = 0.304 +- 0.377 (in-sample avg dev_std = 0.244)
NEC for r=0.2 class 1.0 = 0.123 +- 0.377 (in-sample avg dev_std = 0.244)
NEC for r=0.2 all KL = 0.228 +- 0.377 (in-sample avg dev_std = 0.244)
NEC for r=0.2 all L1 = 0.204 +- 0.296 (in-sample avg dev_std = 0.244)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.982
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.068316
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.774
NEC for r=0.4 class 0.0 = 0.375 +- 0.401 (in-sample avg dev_std = 0.356)
NEC for r=0.4 class 1.0 = 0.169 +- 0.401 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all KL = 0.305 +- 0.401 (in-sample avg dev_std = 0.356)
NEC for r=0.4 all L1 = 0.261 +- 0.307 (in-sample avg dev_std = 0.356)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.982
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077988
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.747
NEC for r=0.8 class 0.0 = 0.37 +- 0.403 (in-sample avg dev_std = 0.427)
NEC for r=0.8 class 1.0 = 0.238 +- 0.403 (in-sample avg dev_std = 0.427)
NEC for r=0.8 all KL = 0.378 +- 0.403 (in-sample avg dev_std = 0.427)
NEC for r=0.8 all L1 = 0.297 +- 0.294 (in-sample avg dev_std = 0.427)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.615
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0081226
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.637
NEC for r=0.05 class 0.0 = 0.004 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.132 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.034 +- 0.109 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.068 +- 0.139 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.615
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0086932
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.644
NEC for r=0.1 class 0.0 = 0.026 +- 0.203 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.178 +- 0.203 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.083 +- 0.203 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.103 +- 0.187 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.615
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091848
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.605
NEC for r=0.2 class 0.0 = 0.115 +- 0.329 (in-sample avg dev_std = 0.095)
NEC for r=0.2 class 1.0 = 0.238 +- 0.329 (in-sample avg dev_std = 0.095)
NEC for r=0.2 all KL = 0.208 +- 0.329 (in-sample avg dev_std = 0.095)
NEC for r=0.2 all L1 = 0.177 +- 0.256 (in-sample avg dev_std = 0.095)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.615
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.594
NEC for r=0.4 class 0.0 = 0.129 +- 0.347 (in-sample avg dev_std = 0.259)
NEC for r=0.4 class 1.0 = 0.264 +- 0.347 (in-sample avg dev_std = 0.259)
NEC for r=0.4 all KL = 0.252 +- 0.347 (in-sample avg dev_std = 0.259)
NEC for r=0.4 all L1 = 0.197 +- 0.252 (in-sample avg dev_std = 0.259)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.615
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.591
NEC for r=0.8 class 0.0 = 0.133 +- 0.348 (in-sample avg dev_std = 0.287)
NEC for r=0.8 class 1.0 = 0.269 +- 0.348 (in-sample avg dev_std = 0.287)
NEC for r=0.8 all KL = 0.261 +- 0.348 (in-sample avg dev_std = 0.287)
NEC for r=0.8 all L1 = 0.202 +- 0.250 (in-sample avg dev_std = 0.287)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.659
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.027093799999999998
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.662
NEC for r=0.05 class 0.0 = 0.038 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.073 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.055 +- 0.137 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.659
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0379552
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.663
NEC for r=0.1 class 0.0 = 0.055 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.106 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.052 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.081 +- 0.176 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.659
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0500464
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.668
NEC for r=0.2 class 0.0 = 0.09 +- 0.244 (in-sample avg dev_std = 0.012)
NEC for r=0.2 class 1.0 = 0.165 +- 0.244 (in-sample avg dev_std = 0.012)
NEC for r=0.2 all KL = 0.106 +- 0.244 (in-sample avg dev_std = 0.012)
NEC for r=0.2 all L1 = 0.127 +- 0.236 (in-sample avg dev_std = 0.012)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.659
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0653638
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.637
NEC for r=0.4 class 0.0 = 0.151 +- 0.309 (in-sample avg dev_std = 0.114)
NEC for r=0.4 class 1.0 = 0.22 +- 0.309 (in-sample avg dev_std = 0.114)
NEC for r=0.4 all KL = 0.176 +- 0.309 (in-sample avg dev_std = 0.114)
NEC for r=0.4 all L1 = 0.185 +- 0.278 (in-sample avg dev_std = 0.114)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.659
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07935
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.603
NEC for r=0.8 class 0.0 = 0.172 +- 0.349 (in-sample avg dev_std = 0.224)
NEC for r=0.8 class 1.0 = 0.297 +- 0.349 (in-sample avg dev_std = 0.224)
NEC for r=0.8 all KL = 0.245 +- 0.349 (in-sample avg dev_std = 0.224)
NEC for r=0.8 all L1 = 0.234 +- 0.288 (in-sample avg dev_std = 0.224)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.366, 0.366, 0.389, 0.44, 0.707], 'all_L1': [0.532, 0.534, 0.543, 0.568, 0.751]}), defaultdict(<class 'list'>, {'all_KL': [0.402, 0.41, 0.431, 0.507, 0.747], 'all_L1': [0.57, 0.575, 0.584, 0.621, 0.777]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.439, 0.454, 0.519, 0.728], 'all_L1': [0.568, 0.567, 0.577, 0.612, 0.749]}), defaultdict(<class 'list'>, {'all_KL': [0.446, 0.442, 0.458, 0.519, 0.707], 'all_L1': [0.571, 0.566, 0.575, 0.612, 0.732]}), defaultdict(<class 'list'>, {'all_KL': [0.45, 0.455, 0.463, 0.52, 0.749], 'all_L1': [0.56, 0.562, 0.57, 0.603, 0.758]}), defaultdict(<class 'list'>, {'all_KL': [0.38, 0.407, 0.413, 0.475, 0.726], 'all_L1': [0.555, 0.568, 0.578, 0.606, 0.753]}), defaultdict(<class 'list'>, {'all_KL': [0.437, 0.442, 0.471, 0.514, 0.764], 'all_L1': [0.566, 0.57, 0.587, 0.606, 0.789]}), defaultdict(<class 'list'>, {'all_KL': [0.322, 0.354, 0.389, 0.458, 0.74], 'all_L1': [0.539, 0.559, 0.576, 0.603, 0.778]}), defaultdict(<class 'list'>, {'all_KL': [0.431, 0.452, 0.464, 0.508, 0.705], 'all_L1': [0.554, 0.566, 0.575, 0.593, 0.727]}), defaultdict(<class 'list'>, {'all_KL': [0.465, 0.467, 0.481, 0.553, 0.76], 'all_L1': [0.571, 0.571, 0.581, 0.63, 0.769]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.062, 0.158, 0.28, 0.387, 0.442], 'all_L1': [0.061, 0.139, 0.233, 0.301, 0.331]}), defaultdict(<class 'list'>, {'all_KL': [0.04, 0.11, 0.233, 0.324, 0.386], 'all_L1': [0.043, 0.099, 0.184, 0.241, 0.276]}), defaultdict(<class 'list'>, {'all_KL': [0.081, 0.148, 0.259, 0.35, 0.407], 'all_L1': [0.084, 0.143, 0.225, 0.292, 0.324]}), defaultdict(<class 'list'>, {'all_KL': [0.07, 0.154, 0.258, 0.346, 0.405], 'all_L1': [0.076, 0.15, 0.223, 0.282, 0.313]}), defaultdict(<class 'list'>, {'all_KL': [0.05, 0.147, 0.248, 0.339, 0.397], 'all_L1': [0.065, 0.152, 0.228, 0.286, 0.316]}), defaultdict(<class 'list'>, {'all_KL': [0.063, 0.134, 0.26, 0.35, 0.421], 'all_L1': [0.064, 0.123, 0.214, 0.271, 0.306]}), defaultdict(<class 'list'>, {'all_KL': [0.036, 0.112, 0.242, 0.315, 0.377], 'all_L1': [0.044, 0.105, 0.2, 0.253, 0.283]}), defaultdict(<class 'list'>, {'all_KL': [0.076, 0.166, 0.273, 0.376, 0.457], 'all_L1': [0.069, 0.141, 0.223, 0.282, 0.318]}), defaultdict(<class 'list'>, {'all_KL': [0.09, 0.17, 0.274, 0.327, 0.396], 'all_L1': [0.098, 0.171, 0.251, 0.283, 0.321]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.111, 0.228, 0.305, 0.378], 'all_L1': [0.063, 0.117, 0.204, 0.261, 0.297]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.306, 0.307, 0.311, 0.317, 0.396], 'all_L1': [0.421, 0.42, 0.422, 0.424, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.475, 0.477, 0.484, 0.498, 0.654], 'all_L1': [0.591, 0.593, 0.593, 0.596, 0.697]}), defaultdict(<class 'list'>, {'all_KL': [0.665, 0.667, 0.668, 0.674, 0.692], 'all_L1': [0.694, 0.694, 0.694, 0.696, 0.722]}), defaultdict(<class 'list'>, {'all_KL': [0.685, 0.685, 0.687, 0.694, 0.694], 'all_L1': [0.721, 0.722, 0.722, 0.724, 0.733]}), defaultdict(<class 'list'>, {'all_KL': [0.637, 0.637, 0.639, 0.653, 0.739], 'all_L1': [0.697, 0.696, 0.697, 0.701, 0.764]}), defaultdict(<class 'list'>, {'all_KL': [0.267, 0.27, 0.272, 0.293, 0.453], 'all_L1': [0.438, 0.44, 0.44, 0.446, 0.553]}), defaultdict(<class 'list'>, {'all_KL': [0.42, 0.424, 0.423, 0.445, 0.607], 'all_L1': [0.525, 0.526, 0.526, 0.534, 0.642]}), defaultdict(<class 'list'>, {'all_KL': [0.45, 0.451, 0.452, 0.467, 0.579], 'all_L1': [0.565, 0.566, 0.567, 0.57, 0.658]}), defaultdict(<class 'list'>, {'all_KL': [0.543, 0.546, 0.547, 0.554, 0.632], 'all_L1': [0.604, 0.605, 0.606, 0.607, 0.672]}), defaultdict(<class 'list'>, {'all_KL': [0.764, 0.767, 0.768, 0.777, 0.789], 'all_L1': [0.808, 0.808, 0.807, 0.811, 0.82]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.116, 0.336, 0.61, 0.72, 0.751], 'all_L1': [0.101, 0.272, 0.497, 0.541, 0.552]}), defaultdict(<class 'list'>, {'all_KL': [0.052, 0.15, 0.361, 0.449, 0.472], 'all_L1': [0.081, 0.149, 0.305, 0.344, 0.352]}), defaultdict(<class 'list'>, {'all_KL': [0.054, 0.162, 0.311, 0.363, 0.378], 'all_L1': [0.082, 0.159, 0.275, 0.302, 0.307]}), defaultdict(<class 'list'>, {'all_KL': [0.069, 0.147, 0.316, 0.373, 0.383], 'all_L1': [0.104, 0.157, 0.27, 0.295, 0.3]}), defaultdict(<class 'list'>, {'all_KL': [0.068, 0.12, 0.266, 0.348, 0.366], 'all_L1': [0.094, 0.134, 0.232, 0.267, 0.274]}), defaultdict(<class 'list'>, {'all_KL': [0.12, 0.326, 0.543, 0.648, 0.682], 'all_L1': [0.109, 0.272, 0.437, 0.479, 0.485]}), defaultdict(<class 'list'>, {'all_KL': [0.08, 0.172, 0.395, 0.48, 0.498], 'all_L1': [0.12, 0.186, 0.351, 0.394, 0.404]}), defaultdict(<class 'list'>, {'all_KL': [0.067, 0.206, 0.431, 0.552, 0.594], 'all_L1': [0.064, 0.166, 0.337, 0.383, 0.395]}), defaultdict(<class 'list'>, {'all_KL': [0.047, 0.156, 0.365, 0.43, 0.447], 'all_L1': [0.077, 0.159, 0.321, 0.351, 0.358]}), defaultdict(<class 'list'>, {'all_KL': [0.034, 0.083, 0.208, 0.252, 0.261], 'all_L1': [0.068, 0.103, 0.177, 0.197, 0.202]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.627, 0.633, 0.649, 0.703, 0.904], 'all_L1': [0.675, 0.68, 0.69, 0.724, 0.885]}), defaultdict(<class 'list'>, {'all_KL': [0.599, 0.599, 0.627, 0.698, 0.889], 'all_L1': [0.661, 0.662, 0.679, 0.724, 0.876]}), defaultdict(<class 'list'>, {'all_KL': [0.625, 0.637, 0.663, 0.708, 0.897], 'all_L1': [0.677, 0.687, 0.704, 0.73, 0.882]}), defaultdict(<class 'list'>, {'all_KL': [0.685, 0.698, 0.706, 0.73, 0.903], 'all_L1': [0.729, 0.737, 0.744, 0.759, 0.889]}), defaultdict(<class 'list'>, {'all_KL': [0.649, 0.656, 0.66, 0.7, 0.892], 'all_L1': [0.68, 0.684, 0.689, 0.719, 0.871]}), defaultdict(<class 'list'>, {'all_KL': [0.588, 0.592, 0.617, 0.683, 0.879], 'all_L1': [0.647, 0.651, 0.666, 0.708, 0.861]}), defaultdict(<class 'list'>, {'all_KL': [0.638, 0.644, 0.662, 0.709, 0.905], 'all_L1': [0.681, 0.686, 0.699, 0.728, 0.883]}), defaultdict(<class 'list'>, {'all_KL': [0.56, 0.58, 0.607, 0.67, 0.889], 'all_L1': [0.648, 0.659, 0.673, 0.716, 0.882]}), defaultdict(<class 'list'>, {'all_KL': [0.637, 0.654, 0.674, 0.717, 0.908], 'all_L1': [0.682, 0.693, 0.708, 0.737, 0.887]}), defaultdict(<class 'list'>, {'all_KL': [0.653, 0.662, 0.676, 0.715, 0.905], 'all_L1': [0.689, 0.693, 0.704, 0.731, 0.883]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.028, 0.054, 0.109, 0.189, 0.269], 'all_L1': [0.054, 0.079, 0.129, 0.194, 0.246]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.059, 0.113, 0.182, 0.286], 'all_L1': [0.056, 0.082, 0.128, 0.185, 0.249]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.058, 0.114, 0.185, 0.263], 'all_L1': [0.055, 0.081, 0.13, 0.187, 0.236]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.057, 0.106, 0.185, 0.248], 'all_L1': [0.053, 0.077, 0.119, 0.179, 0.223]}), defaultdict(<class 'list'>, {'all_KL': [0.03, 0.058, 0.116, 0.191, 0.253], 'all_L1': [0.059, 0.087, 0.138, 0.197, 0.241]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.062, 0.114, 0.186, 0.283], 'all_L1': [0.058, 0.089, 0.134, 0.194, 0.255]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.052, 0.108, 0.177, 0.261], 'all_L1': [0.055, 0.08, 0.129, 0.186, 0.242]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.064, 0.118, 0.201, 0.301], 'all_L1': [0.054, 0.081, 0.126, 0.191, 0.252]}), defaultdict(<class 'list'>, {'all_KL': [0.027, 0.052, 0.102, 0.171, 0.25], 'all_L1': [0.053, 0.079, 0.125, 0.18, 0.231]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.052, 0.106, 0.176, 0.245], 'all_L1': [0.055, 0.081, 0.127, 0.185, 0.234]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.559 +- 0.013, 0.564 +- 0.011, 0.575 +- 0.011, 0.605 +- 0.016, 0.758 +- 0.019
suff_simple class all_KL  =  0.414 +- 0.043, 0.423 +- 0.036, 0.441 +- 0.032, 0.501 +- 0.032, 0.733 +- 0.021
[[0.5720000267028809, 0.5867499709129333, 0.5924999713897705, 0.5982499718666077, 0.7400000095367432], [0.6324999928474426, 0.6537500023841858, 0.6527500152587891, 0.6575000286102295, 0.777999997138977], [0.6184999942779541, 0.6127499938011169, 0.637499988079071, 0.6457499861717224, 0.7360000014305115], [0.6152499914169312, 0.6007500290870667, 0.609000027179718, 0.6417499780654907, 0.7379999756813049], [0.6122499704360962, 0.6082500219345093, 0.6039999723434448, 0.6349999904632568, 0.7540000081062317], [0.6100000143051147, 0.6255000233650208, 0.6514999866485596, 0.6389999985694885, 0.7379999756813049], [0.6222500205039978, 0.6332499980926514, 0.6549999713897705, 0.6439999938011169, 0.8019999861717224], [0.6027500033378601, 0.6242499947547913, 0.6052500009536743, 0.6115000247955322, 0.7580000162124634], [0.6014999747276306, 0.6175000071525574, 0.6172500252723694, 0.6357499957084656, 0.7279999852180481], [0.6140000224113464, 0.6037499904632568, 0.6175000071525574, 0.6617500185966492, 0.7639999985694885]]
[[0.366, 0.366, 0.389, 0.44, 0.707], [0.402, 0.41, 0.431, 0.507, 0.747], [0.437, 0.439, 0.454, 0.519, 0.728], [0.446, 0.442, 0.458, 0.519, 0.707], [0.45, 0.455, 0.463, 0.52, 0.749], [0.38, 0.407, 0.413, 0.475, 0.726], [0.437, 0.442, 0.471, 0.514, 0.764], [0.322, 0.354, 0.389, 0.458, 0.74], [0.431, 0.452, 0.464, 0.508, 0.705], [0.465, 0.467, 0.481, 0.553, 0.76]]
suff_simple_acc_int  =  0.610 +- 0.015, 0.617 +- 0.018, 0.624 +- 0.022, 0.637 +- 0.018, 0.754 +- 0.022
nec class all_L1  =  0.067 +- 0.016, 0.134 +- 0.021, 0.218 +- 0.018, 0.275 +- 0.018, 0.309 +- 0.017
nec class all_KL  =  0.062 +- 0.017, 0.141 +- 0.022, 0.256 +- 0.017, 0.342 +- 0.024, 0.407 +- 0.025
[[0.9520000219345093, 0.8627499938011169, 0.7795000076293945, 0.7210000157356262, 0.7080000042915344], [0.9639999866485596, 0.9097499847412109, 0.8387500047683716, 0.7932500243186951, 0.781000018119812], [0.921999990940094, 0.8640000224113464, 0.7887499928474426, 0.7367500066757202, 0.7170000076293945], [0.9259999990463257, 0.8585000038146973, 0.7944999933242798, 0.7674999833106995, 0.7315000295639038], [0.9319999814033508, 0.8607500195503235, 0.7932500243186951, 0.765500009059906, 0.7277500033378601], [0.9300000071525574, 0.8740000128746033, 0.7957500219345093, 0.7484999895095825, 0.7570000290870667], [0.9700000286102295, 0.9117500185966492, 0.8165000081062317, 0.7770000100135803, 0.7727500200271606], [0.9279999732971191, 0.8532500267028809, 0.7732499837875366, 0.7272499799728394, 0.7250000238418579], [0.9120000004768372, 0.840749979019165, 0.7612500190734863, 0.7559999823570251, 0.7332500219345093], [0.9440000057220459, 0.8939999938011169, 0.8167499899864197, 0.7735000252723694, 0.746999979019165]]
[[0.062, 0.158, 0.28, 0.387, 0.442], [0.04, 0.11, 0.233, 0.324, 0.386], [0.081, 0.148, 0.259, 0.35, 0.407], [0.07, 0.154, 0.258, 0.346, 0.405], [0.05, 0.147, 0.248, 0.339, 0.397], [0.063, 0.134, 0.26, 0.35, 0.421], [0.036, 0.112, 0.242, 0.315, 0.377], [0.076, 0.166, 0.273, 0.376, 0.457], [0.09, 0.17, 0.274, 0.327, 0.396], [0.055, 0.111, 0.228, 0.305, 0.378]]
nec_acc_int  =  0.938 +- 0.018, 0.873 +- 0.023, 0.796 +- 0.022, 0.757 +- 0.022, 0.740 +- 0.023

Eval split val
suff_simple class all_L1  =  0.606 +- 0.119, 0.607 +- 0.118, 0.607 +- 0.118, 0.611 +- 0.118, 0.676 +- 0.091
suff_simple class all_KL  =  0.521 +- 0.158, 0.523 +- 0.157, 0.525 +- 0.157, 0.537 +- 0.154, 0.623 +- 0.116
[[0.5037000179290771, 0.501800000667572, 0.5022500157356262, 0.5028499960899353, 0.5866000056266785], [0.5313249826431274, 0.5337250232696533, 0.5328999757766724, 0.5286499857902527, 0.6646000146865845], [0.5000749826431274, 0.4997749924659729, 0.4994249939918518, 0.5001000165939331, 0.5590000152587891], [0.5041000247001648, 0.5046499967575073, 0.5037999749183655, 0.5041499733924866, 0.5802000164985657], [0.5141249895095825, 0.5142499804496765, 0.515375018119812, 0.5153999924659729, 0.6241999864578247], [0.5254499912261963, 0.5267999768257141, 0.5256999731063843, 0.5240499973297119, 0.623199999332428], [0.5309000015258789, 0.5289000272750854, 0.5293750166893005, 0.5333999991416931, 0.6980000138282776], [0.5134000182151794, 0.5123999714851379, 0.51357501745224, 0.5129500031471252, 0.6164000034332275], [0.5107250213623047, 0.5098749995231628, 0.5099499821662903, 0.5105999708175659, 0.6197999715805054], [0.515250027179718, 0.5158500075340271, 0.5134999752044678, 0.513450026512146, 0.597599983215332]]
[[0.306, 0.307, 0.311, 0.317, 0.396], [0.475, 0.477, 0.484, 0.498, 0.654], [0.665, 0.667, 0.668, 0.674, 0.692], [0.685, 0.685, 0.687, 0.694, 0.694], [0.637, 0.637, 0.639, 0.653, 0.739], [0.267, 0.27, 0.272, 0.293, 0.453], [0.42, 0.424, 0.423, 0.445, 0.607], [0.45, 0.451, 0.452, 0.467, 0.579], [0.543, 0.546, 0.547, 0.554, 0.632], [0.764, 0.767, 0.768, 0.777, 0.789]]
suff_simple_acc_int  =  0.515 +- 0.011, 0.515 +- 0.011, 0.515 +- 0.011, 0.515 +- 0.011, 0.617 +- 0.039
nec class all_L1  =  0.090 +- 0.018, 0.176 +- 0.052, 0.320 +- 0.089, 0.355 +- 0.096, 0.363 +- 0.097
nec class all_KL  =  0.071 +- 0.027, 0.186 +- 0.079, 0.381 +- 0.116, 0.462 +- 0.136, 0.483 +- 0.145
[[0.870199978351593, 0.7803999781608582, 0.5978999733924866, 0.5841000080108643, 0.5819500088691711], [0.9294000267982483, 0.8687999844551086, 0.6826500296592712, 0.6656500101089478, 0.6681749820709229], [0.751800000667572, 0.6876000165939331, 0.5659999847412109, 0.5533000230789185, 0.5544999837875366], [0.7387999892234802, 0.7016000151634216, 0.585224986076355, 0.5741000175476074, 0.5724999904632568], [0.7681999802589417, 0.7376000285148621, 0.637624979019165, 0.6176499724388123, 0.6171249747276306], [0.8637999892234802, 0.7635999917984009, 0.6324999928474426, 0.6227499842643738, 0.6259499788284302], [0.9115999937057495, 0.8791999816894531, 0.7131249904632568, 0.6943249702453613, 0.6921749711036682], [0.9351999759674072, 0.826200008392334, 0.634024977684021, 0.6144499778747559, 0.6155999898910522], [0.8694000244140625, 0.7973999977111816, 0.6298999786376953, 0.616599977016449, 0.6165249943733215], [0.6367999911308289, 0.6444000005722046, 0.6046249866485596, 0.5943999886512756, 0.5909000039100647]]
[[0.116, 0.336, 0.61, 0.72, 0.751], [0.052, 0.15, 0.361, 0.449, 0.472], [0.054, 0.162, 0.311, 0.363, 0.378], [0.069, 0.147, 0.316, 0.373, 0.383], [0.068, 0.12, 0.266, 0.348, 0.366], [0.12, 0.326, 0.543, 0.648, 0.682], [0.08, 0.172, 0.395, 0.48, 0.498], [0.067, 0.206, 0.431, 0.552, 0.594], [0.047, 0.156, 0.365, 0.43, 0.447], [0.034, 0.083, 0.208, 0.252, 0.261]]
nec_acc_int  =  0.828 +- 0.094, 0.769 +- 0.073, 0.628 +- 0.042, 0.614 +- 0.040, 0.614 +- 0.040

Eval split test
suff_simple class all_L1  =  0.677 +- 0.022, 0.683 +- 0.023, 0.696 +- 0.021, 0.728 +- 0.013, 0.880 +- 0.008
suff_simple class all_KL  =  0.626 +- 0.034, 0.636 +- 0.034, 0.654 +- 0.028, 0.703 +- 0.016, 0.897 +- 0.009
[[0.5826746225357056, 0.5862767696380615, 0.5941064357757568, 0.6103912591934204, 0.6656638383865356], [0.6174705028533936, 0.6178707480430603, 0.6215229034423828, 0.6511406898498535, 0.71660977602005], [0.6048378944396973, 0.6154192686080933, 0.6181208491325378, 0.6386831998825073, 0.6956870555877686], [0.5560586452484131, 0.5547328591346741, 0.5560586452484131, 0.5830998420715332, 0.6353790760040283], [0.579622745513916, 0.5786221623420715, 0.5882529616355896, 0.5931808948516846, 0.6708124279975891], [0.6353561878204346, 0.6296277642250061, 0.6330047845840454, 0.6530418395996094, 0.7345914244651794], [0.584625780582428, 0.5889283418655396, 0.6027616858482361, 0.6187462210655212, 0.6678034067153931], [0.6167450547218323, 0.5999850034713745, 0.5985841751098633, 0.6258755326271057, 0.6867856383323669], [0.5986841917037964, 0.607514500617981, 0.616294801235199, 0.6303032040596008, 0.6986960768699646], [0.5879027247428894, 0.5902791619300842, 0.5983589887619019, 0.6189714074134827, 0.6752960085868835]]
[[0.627, 0.633, 0.649, 0.703, 0.904], [0.599, 0.599, 0.627, 0.698, 0.889], [0.625, 0.637, 0.663, 0.708, 0.897], [0.685, 0.698, 0.706, 0.73, 0.903], [0.649, 0.656, 0.66, 0.7, 0.892], [0.588, 0.592, 0.617, 0.683, 0.879], [0.638, 0.644, 0.662, 0.709, 0.905], [0.56, 0.58, 0.607, 0.67, 0.889], [0.637, 0.654, 0.674, 0.717, 0.908], [0.653, 0.662, 0.676, 0.715, 0.905]]
suff_simple_acc_int  =  0.596 +- 0.022, 0.597 +- 0.021, 0.603 +- 0.020, 0.622 +- 0.022, 0.685 +- 0.027
nec class all_L1  =  0.055 +- 0.002, 0.082 +- 0.003, 0.129 +- 0.005, 0.188 +- 0.006, 0.241 +- 0.010
nec class all_KL  =  0.030 +- 0.002, 0.057 +- 0.004, 0.111 +- 0.005, 0.184 +- 0.008, 0.266 +- 0.018
[[0.6541925072669983, 0.654392659664154, 0.6653242111206055, 0.6262507438659668, 0.5987592339515686], [0.6914148330688477, 0.7008205056190491, 0.702246367931366, 0.6631228923797607, 0.6272763609886169], [0.6814088225364685, 0.6866119503974915, 0.6861867308616638, 0.649864912033081, 0.6267009973526001], [0.6233740448951721, 0.6235741376876831, 0.6237742900848389, 0.5947068333625793, 0.566464900970459], [0.6607964634895325, 0.6623974442481995, 0.6596457958221436, 0.6225735545158386, 0.596532940864563], [0.7100260257720947, 0.7164298295974731, 0.7153792381286621, 0.6744796633720398, 0.6471132636070251], [0.6565939784049988, 0.659795880317688, 0.671427845954895, 0.6375575065612793, 0.6050630211830139], [0.6684010624885559, 0.6712027192115784, 0.6788823008537292, 0.6391584873199463, 0.6102411150932312], [0.6832099556922913, 0.6866119503974915, 0.6896137595176697, 0.6533420085906982, 0.6137682795524597], [0.6617971062660217, 0.663398027420044, 0.6684260368347168, 0.6368821263313293, 0.6030368208885193]]
[[0.028, 0.054, 0.109, 0.189, 0.269], [0.033, 0.059, 0.113, 0.182, 0.286], [0.032, 0.058, 0.114, 0.185, 0.263], [0.031, 0.057, 0.106, 0.185, 0.248], [0.03, 0.058, 0.116, 0.191, 0.253], [0.031, 0.062, 0.114, 0.186, 0.283], [0.028, 0.052, 0.108, 0.177, 0.261], [0.033, 0.064, 0.118, 0.201, 0.301], [0.027, 0.052, 0.102, 0.171, 0.25], [0.028, 0.052, 0.106, 0.176, 0.245]]
nec_acc_int  =  0.669 +- 0.023, 0.673 +- 0.025, 0.676 +- 0.024, 0.640 +- 0.021, 0.609 +- 0.021


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.313 +- 0.010, 0.349 +- 0.010, 0.397 +- 0.008, 0.440 +- 0.007, 0.533 +- 0.008
Faith. Armon (L1)= 		  =  0.119 +- 0.025, 0.216 +- 0.028, 0.316 +- 0.018, 0.378 +- 0.015, 0.438 +- 0.016
Faith. GMean (L1)= 	  =  0.192 +- 0.023, 0.274 +- 0.022, 0.354 +- 0.013, 0.408 +- 0.011, 0.483 +- 0.011
Faith. Aritm (KL)= 		  =  0.238 +- 0.022, 0.282 +- 0.018, 0.348 +- 0.013, 0.422 +- 0.008, 0.570 +- 0.012
Faith. Armon (KL)= 		  =  0.107 +- 0.025, 0.210 +- 0.024, 0.322 +- 0.011, 0.405 +- 0.010, 0.522 +- 0.019
Faith. GMean (KL)= 	  =  0.159 +- 0.022, 0.243 +- 0.019, 0.335 +- 0.011, 0.413 +- 0.008, 0.546 +- 0.015

Eval split val
Faith. Aritm (L1)= 		  =  0.348 +- 0.056, 0.391 +- 0.037, 0.464 +- 0.020, 0.483 +- 0.016, 0.519 +- 0.005
Faith. Armon (L1)= 		  =  0.155 +- 0.024, 0.261 +- 0.043, 0.399 +- 0.046, 0.427 +- 0.044, 0.455 +- 0.058
Faith. GMean (L1)= 	  =  0.230 +- 0.024, 0.317 +- 0.018, 0.429 +- 0.022, 0.453 +- 0.021, 0.485 +- 0.034
Faith. Aritm (KL)= 		  =  0.296 +- 0.068, 0.354 +- 0.048, 0.453 +- 0.032, 0.499 +- 0.023, 0.553 +- 0.018
Faith. Armon (KL)= 		  =  0.118 +- 0.031, 0.247 +- 0.046, 0.404 +- 0.035, 0.456 +- 0.037, 0.513 +- 0.050
Faith. GMean (KL)= 	  =  0.182 +- 0.019, 0.293 +- 0.024, 0.427 +- 0.025, 0.477 +- 0.023, 0.533 +- 0.034

Eval split test
Faith. Aritm (L1)= 		  =  0.366 +- 0.011, 0.382 +- 0.010, 0.412 +- 0.009, 0.458 +- 0.005, 0.560 +- 0.004
Faith. Armon (L1)= 		  =  0.102 +- 0.003, 0.146 +- 0.005, 0.217 +- 0.006, 0.298 +- 0.006, 0.378 +- 0.011
Faith. GMean (L1)= 	  =  0.193 +- 0.003, 0.236 +- 0.004, 0.299 +- 0.004, 0.370 +- 0.004, 0.460 +- 0.008
Faith. Aritm (KL)= 		  =  0.328 +- 0.016, 0.346 +- 0.016, 0.382 +- 0.013, 0.444 +- 0.006, 0.581 +- 0.006
Faith. Armon (KL)= 		  =  0.057 +- 0.004, 0.104 +- 0.006, 0.189 +- 0.006, 0.292 +- 0.009, 0.410 +- 0.020
Faith. GMean (KL)= 	  =  0.137 +- 0.004, 0.190 +- 0.005, 0.269 +- 0.004, 0.360 +- 0.006, 0.488 +- 0.014
Computed for split load_split = id



Completed in  2:56:17.328148  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 19:31:37 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:31:38 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0013
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0013
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.048
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.082
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.035
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.048
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03597
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.719
SUFF_SIMPLE for r=0.05 class 0.0 = 0.626 +- 0.447 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.822 +- 0.447 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.05 all KL = 0.667 +- 0.447 (in-sample avg dev_std = 0.215)
SUFF_SIMPLE for r=0.05 all L1 = 0.735 +- 0.373 (in-sample avg dev_std = 0.215)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047726
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.73
SUFF_SIMPLE for r=0.1 class 0.0 = 0.602 +- 0.442 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.86 +- 0.442 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.1 all KL = 0.679 +- 0.442 (in-sample avg dev_std = 0.185)
SUFF_SIMPLE for r=0.1 all L1 = 0.745 +- 0.367 (in-sample avg dev_std = 0.185)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061348
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.763
SUFF_SIMPLE for r=0.2 class 0.0 = 0.586 +- 0.428 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.92 +- 0.428 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.2 all KL = 0.711 +- 0.428 (in-sample avg dev_std = 0.165)
SUFF_SIMPLE for r=0.2 all L1 = 0.771 +- 0.355 (in-sample avg dev_std = 0.165)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07434
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.789
SUFF_SIMPLE for r=0.4 class 0.0 = 0.567 +- 0.413 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.978 +- 0.413 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.4 all KL = 0.748 +- 0.413 (in-sample avg dev_std = 0.110)
SUFF_SIMPLE for r=0.4 all L1 = 0.795 +- 0.348 (in-sample avg dev_std = 0.110)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.876
SUFF_SIMPLE for r=0.8 class 0.0 = 0.735 +- 0.339 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.997 +- 0.339 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.854 +- 0.339 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.88 +- 0.283 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080328
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.674
SUFF_SIMPLE for r=0.05 class 0.0 = 0.654 +- 0.388 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.944 +- 0.388 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.05 all KL = 0.761 +- 0.388 (in-sample avg dev_std = 0.007)
SUFF_SIMPLE for r=0.05 all L1 = 0.8 +- 0.322 (in-sample avg dev_std = 0.007)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0085574
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.674
SUFF_SIMPLE for r=0.1 class 0.0 = 0.654 +- 0.388 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.944 +- 0.388 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all KL = 0.761 +- 0.388 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all L1 = 0.8 +- 0.322 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091202
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.674
SUFF_SIMPLE for r=0.2 class 0.0 = 0.654 +- 0.388 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.944 +- 0.388 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.2 all KL = 0.761 +- 0.388 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.2 all L1 = 0.8 +- 0.322 (in-sample avg dev_std = 0.006)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094654
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.674
SUFF_SIMPLE for r=0.4 class 0.0 = 0.654 +- 0.388 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.944 +- 0.388 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.4 all KL = 0.761 +- 0.388 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.4 all L1 = 0.8 +- 0.322 (in-sample avg dev_std = 0.005)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096952
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.679
SUFF_SIMPLE for r=0.8 class 0.0 = 0.672 +- 0.385 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.948 +- 0.385 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.777 +- 0.385 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.811 +- 0.319 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0258052
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.712
SUFF_SIMPLE for r=0.05 class 0.0 = 0.84 +- 0.418 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.479 +- 0.418 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.05 all KL = 0.616 +- 0.418 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.05 all L1 = 0.661 +- 0.340 (in-sample avg dev_std = 0.305)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0353
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.74
SUFF_SIMPLE for r=0.1 class 0.0 = 0.809 +- 0.407 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.564 +- 0.407 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.1 all KL = 0.649 +- 0.407 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.1 all L1 = 0.688 +- 0.333 (in-sample avg dev_std = 0.292)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0475984
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.757
SUFF_SIMPLE for r=0.2 class 0.0 = 0.793 +- 0.392 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.634 +- 0.392 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.2 all KL = 0.683 +- 0.392 (in-sample avg dev_std = 0.281)
SUFF_SIMPLE for r=0.2 all L1 = 0.715 +- 0.324 (in-sample avg dev_std = 0.281)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.061493200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.777
SUFF_SIMPLE for r=0.4 class 0.0 = 0.802 +- 0.373 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.691 +- 0.373 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.4 all KL = 0.726 +- 0.373 (in-sample avg dev_std = 0.257)
SUFF_SIMPLE for r=0.4 all L1 = 0.747 +- 0.314 (in-sample avg dev_std = 0.257)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.832
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0785986
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.844
SUFF_SIMPLE for r=0.8 class 0.0 = 0.951 +- 0.277 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.742 +- 0.277 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.8 all KL = 0.863 +- 0.277 (in-sample avg dev_std = 0.087)
SUFF_SIMPLE for r=0.8 all L1 = 0.847 +- 0.261 (in-sample avg dev_std = 0.087)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03597
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.994
NEC for r=0.05 class 0.0 = 0.018 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.008 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.014 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.013 +- 0.067 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.047726
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.97
NEC for r=0.1 class 0.0 = 0.082 +- 0.188 (in-sample avg dev_std = 0.007)
NEC for r=0.1 class 1.0 = 0.005 +- 0.188 (in-sample avg dev_std = 0.007)
NEC for r=0.1 all KL = 0.049 +- 0.188 (in-sample avg dev_std = 0.007)
NEC for r=0.1 all L1 = 0.039 +- 0.148 (in-sample avg dev_std = 0.007)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061348
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.904
NEC for r=0.2 class 0.0 = 0.216 +- 0.322 (in-sample avg dev_std = 0.182)
NEC for r=0.2 class 1.0 = 0.014 +- 0.322 (in-sample avg dev_std = 0.182)
NEC for r=0.2 all KL = 0.142 +- 0.322 (in-sample avg dev_std = 0.182)
NEC for r=0.2 all L1 = 0.104 +- 0.247 (in-sample avg dev_std = 0.182)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07434
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.863
NEC for r=0.4 class 0.0 = 0.299 +- 0.376 (in-sample avg dev_std = 0.268)
NEC for r=0.4 class 1.0 = 0.025 +- 0.376 (in-sample avg dev_std = 0.268)
NEC for r=0.4 all KL = 0.203 +- 0.376 (in-sample avg dev_std = 0.268)
NEC for r=0.4 all L1 = 0.147 +- 0.287 (in-sample avg dev_std = 0.268)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.845
NEC for r=0.8 class 0.0 = 0.311 +- 0.397 (in-sample avg dev_std = 0.311)
NEC for r=0.8 class 1.0 = 0.061 +- 0.397 (in-sample avg dev_std = 0.311)
NEC for r=0.8 all KL = 0.248 +- 0.397 (in-sample avg dev_std = 0.311)
NEC for r=0.8 all L1 = 0.173 +- 0.298 (in-sample avg dev_std = 0.311)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.839
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0080328
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.831
NEC for r=0.05 class 0.0 = 0.037 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.033 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.140 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.035 +- 0.114 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.839
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0085574
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.757
NEC for r=0.1 class 0.0 = 0.18 +- 0.305 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.044 +- 0.305 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.127 +- 0.305 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.111 +- 0.246 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.839
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0091202
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.681
NEC for r=0.2 class 0.0 = 0.324 +- 0.384 (in-sample avg dev_std = 0.059)
NEC for r=0.2 class 1.0 = 0.051 +- 0.384 (in-sample avg dev_std = 0.059)
NEC for r=0.2 all KL = 0.22 +- 0.384 (in-sample avg dev_std = 0.059)
NEC for r=0.2 all L1 = 0.187 +- 0.317 (in-sample avg dev_std = 0.059)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.839
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094654
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.678
NEC for r=0.4 class 0.0 = 0.332 +- 0.388 (in-sample avg dev_std = 0.093)
NEC for r=0.4 class 1.0 = 0.053 +- 0.388 (in-sample avg dev_std = 0.093)
NEC for r=0.4 all KL = 0.227 +- 0.388 (in-sample avg dev_std = 0.093)
NEC for r=0.4 all L1 = 0.191 +- 0.319 (in-sample avg dev_std = 0.093)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.839
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096952
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.678
NEC for r=0.8 class 0.0 = 0.332 +- 0.388 (in-sample avg dev_std = 0.096)
NEC for r=0.8 class 1.0 = 0.052 +- 0.388 (in-sample avg dev_std = 0.096)
NEC for r=0.8 all KL = 0.227 +- 0.388 (in-sample avg dev_std = 0.096)
NEC for r=0.8 all L1 = 0.191 +- 0.319 (in-sample avg dev_std = 0.096)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.831
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0258052
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.837
NEC for r=0.05 class 0.0 = 0.024 +- 0.164 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.146 +- 0.164 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.055 +- 0.164 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.084 +- 0.181 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.831
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0353
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.843
NEC for r=0.1 class 0.0 = 0.033 +- 0.221 (in-sample avg dev_std = 0.063)
NEC for r=0.1 class 1.0 = 0.208 +- 0.221 (in-sample avg dev_std = 0.063)
NEC for r=0.1 all KL = 0.094 +- 0.221 (in-sample avg dev_std = 0.063)
NEC for r=0.1 all L1 = 0.12 +- 0.226 (in-sample avg dev_std = 0.063)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.831
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0475984
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.831
NEC for r=0.2 class 0.0 = 0.055 +- 0.260 (in-sample avg dev_std = 0.166)
NEC for r=0.2 class 1.0 = 0.236 +- 0.260 (in-sample avg dev_std = 0.166)
NEC for r=0.2 all KL = 0.129 +- 0.260 (in-sample avg dev_std = 0.166)
NEC for r=0.2 all L1 = 0.144 +- 0.244 (in-sample avg dev_std = 0.166)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.831
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.061493200000000005
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.798
NEC for r=0.4 class 0.0 = 0.119 +- 0.308 (in-sample avg dev_std = 0.229)
NEC for r=0.4 class 1.0 = 0.249 +- 0.308 (in-sample avg dev_std = 0.229)
NEC for r=0.4 all KL = 0.183 +- 0.308 (in-sample avg dev_std = 0.229)
NEC for r=0.4 all L1 = 0.184 +- 0.269 (in-sample avg dev_std = 0.229)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.831
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0785986
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.756
NEC for r=0.8 class 0.0 = 0.15 +- 0.362 (in-sample avg dev_std = 0.273)
NEC for r=0.8 class 1.0 = 0.342 +- 0.362 (in-sample avg dev_std = 0.273)
NEC for r=0.8 all KL = 0.266 +- 0.362 (in-sample avg dev_std = 0.273)
NEC for r=0.8 all L1 = 0.245 +- 0.303 (in-sample avg dev_std = 0.273)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 19:48:27 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 07:48:27 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 54 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 54...
[0m[1;37mINFO[0m: [1mCheckpoint 54: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.023
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.032
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.044
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032861999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.791
SUFF_SIMPLE for r=0.05 class 0.0 = 0.593 +- 0.418 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.985 +- 0.418 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.05 all KL = 0.77 +- 0.418 (in-sample avg dev_std = 0.207)
SUFF_SIMPLE for r=0.05 all L1 = 0.81 +- 0.350 (in-sample avg dev_std = 0.207)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041794
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.791
SUFF_SIMPLE for r=0.1 class 0.0 = 0.593 +- 0.419 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.984 +- 0.419 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all KL = 0.771 +- 0.419 (in-sample avg dev_std = 0.196)
SUFF_SIMPLE for r=0.1 all L1 = 0.809 +- 0.352 (in-sample avg dev_std = 0.196)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.051998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.791
SUFF_SIMPLE for r=0.2 class 0.0 = 0.595 +- 0.416 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.989 +- 0.416 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.2 all KL = 0.777 +- 0.416 (in-sample avg dev_std = 0.184)
SUFF_SIMPLE for r=0.2 all L1 = 0.813 +- 0.350 (in-sample avg dev_std = 0.184)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064676
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.793
SUFF_SIMPLE for r=0.4 class 0.0 = 0.591 +- 0.410 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.410 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.4 all KL = 0.785 +- 0.410 (in-sample avg dev_std = 0.147)
SUFF_SIMPLE for r=0.4 all L1 = 0.817 +- 0.350 (in-sample avg dev_std = 0.147)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078292
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.874
SUFF_SIMPLE for r=0.8 class 0.0 = 0.75 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.867 +- 0.338 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.889 +- 0.286 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086458
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.559 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.779 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092028
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.559 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.779 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009534
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.559 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.779 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009619800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.746
SUFF_SIMPLE for r=0.4 class 0.0 = 0.559 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.779 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009695400000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.749
SUFF_SIMPLE for r=0.8 class 0.0 = 0.564 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.995 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.782 +- 0.374 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0230524
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.831
SUFF_SIMPLE for r=0.05 class 0.0 = 0.835 +- 0.381 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.842 +- 0.381 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all KL = 0.775 +- 0.381 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all L1 = 0.838 +- 0.293 (in-sample avg dev_std = 0.323)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0324914
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.833
SUFF_SIMPLE for r=0.1 class 0.0 = 0.836 +- 0.378 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.848 +- 0.378 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 all KL = 0.782 +- 0.378 (in-sample avg dev_std = 0.312)
SUFF_SIMPLE for r=0.1 all L1 = 0.842 +- 0.292 (in-sample avg dev_std = 0.312)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0442574
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.834
SUFF_SIMPLE for r=0.2 class 0.0 = 0.837 +- 0.378 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.85 +- 0.378 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 all KL = 0.788 +- 0.378 (in-sample avg dev_std = 0.305)
SUFF_SIMPLE for r=0.2 all L1 = 0.843 +- 0.294 (in-sample avg dev_std = 0.305)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0599838
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.836
SUFF_SIMPLE for r=0.4 class 0.0 = 0.839 +- 0.374 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.854 +- 0.374 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 all KL = 0.799 +- 0.374 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 all L1 = 0.846 +- 0.296 (in-sample avg dev_std = 0.287)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.897
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0767382
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.913
SUFF_SIMPLE for r=0.8 class 0.0 = 0.966 +- 0.267 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.877 +- 0.267 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.8 all KL = 0.91 +- 0.267 (in-sample avg dev_std = 0.118)
SUFF_SIMPLE for r=0.8 all L1 = 0.922 +- 0.227 (in-sample avg dev_std = 0.118)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032861999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.992
NEC for r=0.05 class 0.0 = 0.019 +- 0.107 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.107 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.012 +- 0.107 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.082 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041794
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.973
NEC for r=0.1 class 0.0 = 0.056 +- 0.170 (in-sample avg dev_std = 0.041)
NEC for r=0.1 class 1.0 = 0.0 +- 0.170 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all KL = 0.03 +- 0.170 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all L1 = 0.025 +- 0.142 (in-sample avg dev_std = 0.041)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.051998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.936
NEC for r=0.2 class 0.0 = 0.147 +- 0.290 (in-sample avg dev_std = 0.229)
NEC for r=0.2 class 1.0 = 0.0 +- 0.290 (in-sample avg dev_std = 0.229)
NEC for r=0.2 all KL = 0.095 +- 0.290 (in-sample avg dev_std = 0.229)
NEC for r=0.2 all L1 = 0.065 +- 0.211 (in-sample avg dev_std = 0.229)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.064676
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.891
NEC for r=0.4 class 0.0 = 0.26 +- 0.378 (in-sample avg dev_std = 0.336)
NEC for r=0.4 class 1.0 = 0.001 +- 0.378 (in-sample avg dev_std = 0.336)
NEC for r=0.4 all KL = 0.18 +- 0.378 (in-sample avg dev_std = 0.336)
NEC for r=0.4 all L1 = 0.117 +- 0.261 (in-sample avg dev_std = 0.336)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078292
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.881
NEC for r=0.8 class 0.0 = 0.285 +- 0.397 (in-sample avg dev_std = 0.376)
NEC for r=0.8 class 1.0 = 0.006 +- 0.397 (in-sample avg dev_std = 0.376)
NEC for r=0.8 all KL = 0.208 +- 0.397 (in-sample avg dev_std = 0.376)
NEC for r=0.8 all L1 = 0.13 +- 0.268 (in-sample avg dev_std = 0.376)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086458
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.982
NEC for r=0.05 class 0.0 = 0.032 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.004 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.022 +- 0.143 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.018 +- 0.119 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092028
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.879
NEC for r=0.1 class 0.0 = 0.213 +- 0.331 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.005 +- 0.331 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.128 +- 0.331 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.108 +- 0.282 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009534
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.75
NEC for r=0.2 class 0.0 = 0.436 +- 0.435 (in-sample avg dev_std = 0.077)
NEC for r=0.2 class 1.0 = 0.005 +- 0.435 (in-sample avg dev_std = 0.077)
NEC for r=0.2 all KL = 0.254 +- 0.435 (in-sample avg dev_std = 0.077)
NEC for r=0.2 all L1 = 0.218 +- 0.373 (in-sample avg dev_std = 0.077)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009619800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.75
NEC for r=0.4 class 0.0 = 0.438 +- 0.436 (in-sample avg dev_std = 0.115)
NEC for r=0.4 class 1.0 = 0.005 +- 0.436 (in-sample avg dev_std = 0.115)
NEC for r=0.4 all KL = 0.256 +- 0.436 (in-sample avg dev_std = 0.115)
NEC for r=0.4 all L1 = 0.22 +- 0.373 (in-sample avg dev_std = 0.115)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009695400000000002
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.75
NEC for r=0.8 class 0.0 = 0.438 +- 0.436 (in-sample avg dev_std = 0.117)
NEC for r=0.8 class 1.0 = 0.005 +- 0.436 (in-sample avg dev_std = 0.117)
NEC for r=0.8 all KL = 0.256 +- 0.436 (in-sample avg dev_std = 0.117)
NEC for r=0.8 all L1 = 0.22 +- 0.374 (in-sample avg dev_std = 0.117)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.896
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0230524
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.907
NEC for r=0.05 class 0.0 = 0.015 +- 0.154 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.062 +- 0.154 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.034 +- 0.154 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.038 +- 0.149 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.896
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0324914
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.911
NEC for r=0.1 class 0.0 = 0.02 +- 0.202 (in-sample avg dev_std = 0.085)
NEC for r=0.1 class 1.0 = 0.086 +- 0.202 (in-sample avg dev_std = 0.085)
NEC for r=0.1 all KL = 0.056 +- 0.202 (in-sample avg dev_std = 0.085)
NEC for r=0.1 all L1 = 0.053 +- 0.182 (in-sample avg dev_std = 0.085)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.896
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0442574
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.897
NEC for r=0.2 class 0.0 = 0.039 +- 0.245 (in-sample avg dev_std = 0.174)
NEC for r=0.2 class 1.0 = 0.099 +- 0.245 (in-sample avg dev_std = 0.174)
NEC for r=0.2 all KL = 0.082 +- 0.245 (in-sample avg dev_std = 0.174)
NEC for r=0.2 all L1 = 0.069 +- 0.202 (in-sample avg dev_std = 0.174)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.896
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0599838
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.863
NEC for r=0.4 class 0.0 = 0.092 +- 0.301 (in-sample avg dev_std = 0.221)
NEC for r=0.4 class 1.0 = 0.108 +- 0.301 (in-sample avg dev_std = 0.221)
NEC for r=0.4 all KL = 0.13 +- 0.301 (in-sample avg dev_std = 0.221)
NEC for r=0.4 all L1 = 0.1 +- 0.239 (in-sample avg dev_std = 0.221)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.896
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0767382
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.851
NEC for r=0.8 class 0.0 = 0.116 +- 0.325 (in-sample avg dev_std = 0.266)
NEC for r=0.8 class 1.0 = 0.114 +- 0.325 (in-sample avg dev_std = 0.266)
NEC for r=0.8 all KL = 0.162 +- 0.325 (in-sample avg dev_std = 0.266)
NEC for r=0.8 all L1 = 0.115 +- 0.248 (in-sample avg dev_std = 0.266)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 20:05:01 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:05:01 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.042
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.050
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.058
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04221000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.791
SUFF_SIMPLE for r=0.05 class 0.0 = 0.596 +- 0.418 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.974 +- 0.418 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all KL = 0.759 +- 0.418 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.05 all L1 = 0.806 +- 0.348 (in-sample avg dev_std = 0.214)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04986
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.799
SUFF_SIMPLE for r=0.1 class 0.0 = 0.6 +- 0.411 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.991 +- 0.411 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.1 all KL = 0.779 +- 0.411 (in-sample avg dev_std = 0.205)
SUFF_SIMPLE for r=0.1 all L1 = 0.817 +- 0.345 (in-sample avg dev_std = 0.205)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.058192
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.796
SUFF_SIMPLE for r=0.2 class 0.0 = 0.597 +- 0.413 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.994 +- 0.413 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 all KL = 0.781 +- 0.413 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.2 all L1 = 0.817 +- 0.347 (in-sample avg dev_std = 0.210)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06778400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.794
SUFF_SIMPLE for r=0.4 class 0.0 = 0.596 +- 0.413 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.413 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 all KL = 0.781 +- 0.413 (in-sample avg dev_std = 0.193)
SUFF_SIMPLE for r=0.4 all L1 = 0.816 +- 0.349 (in-sample avg dev_std = 0.193)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077462
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.894
SUFF_SIMPLE for r=0.8 class 0.0 = 0.792 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.997 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.885 +- 0.317 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.905 +- 0.266 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084326
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.558 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.776 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091108
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.558 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.776 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094056
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.558 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.776 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009528199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.746
SUFF_SIMPLE for r=0.4 class 0.0 = 0.558 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.99 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.741 +- 0.437 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.776 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096482
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.75
SUFF_SIMPLE for r=0.8 class 0.0 = 0.565 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.99 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.745 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.779 +- 0.376 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024804399999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.85
SUFF_SIMPLE for r=0.05 class 0.0 = 0.828 +- 0.334 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.875 +- 0.334 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.05 all KL = 0.801 +- 0.334 (in-sample avg dev_std = 0.288)
SUFF_SIMPLE for r=0.05 all L1 = 0.851 +- 0.266 (in-sample avg dev_std = 0.288)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0359612
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.85
SUFF_SIMPLE for r=0.1 class 0.0 = 0.828 +- 0.332 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.884 +- 0.332 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all KL = 0.813 +- 0.332 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all L1 = 0.856 +- 0.268 (in-sample avg dev_std = 0.279)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.049202800000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.852
SUFF_SIMPLE for r=0.2 class 0.0 = 0.829 +- 0.331 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.892 +- 0.331 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all KL = 0.823 +- 0.331 (in-sample avg dev_std = 0.269)
SUFF_SIMPLE for r=0.2 all L1 = 0.86 +- 0.269 (in-sample avg dev_std = 0.269)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06235260000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.858
SUFF_SIMPLE for r=0.4 class 0.0 = 0.837 +- 0.323 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.903 +- 0.323 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all KL = 0.843 +- 0.323 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all L1 = 0.869 +- 0.268 (in-sample avg dev_std = 0.236)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07781400000000001
len(reference) = 4981
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.938
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.195 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.927 +- 0.195 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.8 all KL = 0.948 +- 0.195 (in-sample avg dev_std = 0.070)
SUFF_SIMPLE for r=0.8 all L1 = 0.948 +- 0.174 (in-sample avg dev_std = 0.070)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04221000000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
NEC for r=0.05 class 0.0 = 0.008 +- 0.065 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.065 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.005 +- 0.065 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.004 +- 0.055 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04986
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.978
NEC for r=0.1 class 0.0 = 0.045 +- 0.152 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.152 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.025 +- 0.152 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.02 +- 0.127 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.058192
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.944
NEC for r=0.2 class 0.0 = 0.133 +- 0.282 (in-sample avg dev_std = 0.234)
NEC for r=0.2 class 1.0 = 0.0 +- 0.282 (in-sample avg dev_std = 0.234)
NEC for r=0.2 all KL = 0.091 +- 0.282 (in-sample avg dev_std = 0.234)
NEC for r=0.2 all L1 = 0.059 +- 0.195 (in-sample avg dev_std = 0.234)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06778400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.894
NEC for r=0.4 class 0.0 = 0.256 +- 0.377 (in-sample avg dev_std = 0.351)
NEC for r=0.4 class 1.0 = 0.001 +- 0.377 (in-sample avg dev_std = 0.351)
NEC for r=0.4 all KL = 0.181 +- 0.377 (in-sample avg dev_std = 0.351)
NEC for r=0.4 all L1 = 0.115 +- 0.256 (in-sample avg dev_std = 0.351)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077462
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.887
NEC for r=0.8 class 0.0 = 0.278 +- 0.393 (in-sample avg dev_std = 0.385)
NEC for r=0.8 class 1.0 = 0.005 +- 0.393 (in-sample avg dev_std = 0.385)
NEC for r=0.8 all KL = 0.207 +- 0.393 (in-sample avg dev_std = 0.385)
NEC for r=0.8 all L1 = 0.127 +- 0.262 (in-sample avg dev_std = 0.385)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.995
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0084326
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.979
NEC for r=0.05 class 0.0 = 0.039 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.01 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.029 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.024 +- 0.137 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.995
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091108
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.862
NEC for r=0.1 class 0.0 = 0.246 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.01 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.15 +- 0.353 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.127 +- 0.301 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.995
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094056
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.75
NEC for r=0.2 class 0.0 = 0.439 +- 0.436 (in-sample avg dev_std = 0.073)
NEC for r=0.2 class 1.0 = 0.01 +- 0.436 (in-sample avg dev_std = 0.073)
NEC for r=0.2 all KL = 0.258 +- 0.436 (in-sample avg dev_std = 0.073)
NEC for r=0.2 all L1 = 0.223 +- 0.376 (in-sample avg dev_std = 0.073)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.995
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009528199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.749
NEC for r=0.4 class 0.0 = 0.44 +- 0.437 (in-sample avg dev_std = 0.098)
NEC for r=0.4 class 1.0 = 0.01 +- 0.437 (in-sample avg dev_std = 0.098)
NEC for r=0.4 all KL = 0.259 +- 0.437 (in-sample avg dev_std = 0.098)
NEC for r=0.4 all L1 = 0.223 +- 0.376 (in-sample avg dev_std = 0.098)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.995
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096482
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.749
NEC for r=0.8 class 0.0 = 0.44 +- 0.437 (in-sample avg dev_std = 0.103)
NEC for r=0.8 class 1.0 = 0.01 +- 0.437 (in-sample avg dev_std = 0.103)
NEC for r=0.8 all KL = 0.259 +- 0.437 (in-sample avg dev_std = 0.103)
NEC for r=0.8 all L1 = 0.223 +- 0.376 (in-sample avg dev_std = 0.103)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.977
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024804399999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.963
NEC for r=0.05 class 0.0 = 0.011 +- 0.116 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.031 +- 0.116 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.019 +- 0.116 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.021 +- 0.107 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.977
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0359612
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.954
NEC for r=0.1 class 0.0 = 0.017 +- 0.148 (in-sample avg dev_std = 0.058)
NEC for r=0.1 class 1.0 = 0.049 +- 0.148 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all KL = 0.031 +- 0.148 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all L1 = 0.033 +- 0.134 (in-sample avg dev_std = 0.058)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.977
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.049202800000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.939
NEC for r=0.2 class 0.0 = 0.034 +- 0.190 (in-sample avg dev_std = 0.147)
NEC for r=0.2 class 1.0 = 0.068 +- 0.190 (in-sample avg dev_std = 0.147)
NEC for r=0.2 all KL = 0.055 +- 0.190 (in-sample avg dev_std = 0.147)
NEC for r=0.2 all L1 = 0.051 +- 0.162 (in-sample avg dev_std = 0.147)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.977
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06235260000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.91
NEC for r=0.4 class 0.0 = 0.087 +- 0.248 (in-sample avg dev_std = 0.184)
NEC for r=0.4 class 1.0 = 0.071 +- 0.248 (in-sample avg dev_std = 0.184)
NEC for r=0.4 all KL = 0.093 +- 0.248 (in-sample avg dev_std = 0.184)
NEC for r=0.4 all L1 = 0.079 +- 0.207 (in-sample avg dev_std = 0.184)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.977
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07781400000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.895
NEC for r=0.8 class 0.0 = 0.123 +- 0.285 (in-sample avg dev_std = 0.235)
NEC for r=0.8 class 1.0 = 0.078 +- 0.285 (in-sample avg dev_std = 0.235)
NEC for r=0.8 all KL = 0.131 +- 0.285 (in-sample avg dev_std = 0.235)
NEC for r=0.8 all L1 = 0.101 +- 0.226 (in-sample avg dev_std = 0.235)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 20:22:04 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:22:04 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 83 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 83...
[0m[1;37mINFO[0m: [1mCheckpoint 83: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.046
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.057
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.035
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.763
SUFF_SIMPLE for r=0.05 class 0.0 = 0.6 +- 0.446 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.913 +- 0.446 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.05 all KL = 0.715 +- 0.446 (in-sample avg dev_std = 0.186)
SUFF_SIMPLE for r=0.05 all L1 = 0.774 +- 0.363 (in-sample avg dev_std = 0.186)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046182
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.789
SUFF_SIMPLE for r=0.1 class 0.0 = 0.608 +- 0.419 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.968 +- 0.419 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.1 all KL = 0.767 +- 0.419 (in-sample avg dev_std = 0.114)
SUFF_SIMPLE for r=0.1 all L1 = 0.807 +- 0.352 (in-sample avg dev_std = 0.114)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05686
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.792
SUFF_SIMPLE for r=0.2 class 0.0 = 0.592 +- 0.409 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.409 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.2 all KL = 0.786 +- 0.409 (in-sample avg dev_std = 0.088)
SUFF_SIMPLE for r=0.2 all L1 = 0.817 +- 0.351 (in-sample avg dev_std = 0.088)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06764400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.795
SUFF_SIMPLE for r=0.4 class 0.0 = 0.602 +- 0.405 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.405 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.4 all KL = 0.794 +- 0.405 (in-sample avg dev_std = 0.075)
SUFF_SIMPLE for r=0.4 all L1 = 0.822 +- 0.349 (in-sample avg dev_std = 0.075)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0786
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.854
SUFF_SIMPLE for r=0.8 class 0.0 = 0.713 +- 0.355 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.355 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.85 +- 0.355 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.872 +- 0.306 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008801999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.727
SUFF_SIMPLE for r=0.05 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094696
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.727
SUFF_SIMPLE for r=0.1 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.727
SUFF_SIMPLE for r=0.2 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096582
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.727
SUFF_SIMPLE for r=0.4 class 0.0 = 0.584 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.999 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.747 +- 0.434 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.793 +- 0.360 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097536
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.728
SUFF_SIMPLE for r=0.8 class 0.0 = 0.587 +- 0.433 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.433 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.749 +- 0.433 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.794 +- 0.360 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0250228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.853
SUFF_SIMPLE for r=0.05 class 0.0 = 0.825 +- 0.396 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.859 +- 0.396 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.05 all KL = 0.74 +- 0.396 (in-sample avg dev_std = 0.292)
SUFF_SIMPLE for r=0.05 all L1 = 0.842 +- 0.275 (in-sample avg dev_std = 0.292)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.034944399999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.859
SUFF_SIMPLE for r=0.1 class 0.0 = 0.825 +- 0.373 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.905 +- 0.373 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.1 all KL = 0.79 +- 0.373 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.1 all L1 = 0.864 +- 0.272 (in-sample avg dev_std = 0.247)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461592
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.864
SUFF_SIMPLE for r=0.2 class 0.0 = 0.831 +- 0.350 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.936 +- 0.350 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 all KL = 0.824 +- 0.350 (in-sample avg dev_std = 0.217)
SUFF_SIMPLE for r=0.2 all L1 = 0.883 +- 0.264 (in-sample avg dev_std = 0.217)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060563
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.87
SUFF_SIMPLE for r=0.4 class 0.0 = 0.84 +- 0.331 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.958 +- 0.331 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all KL = 0.852 +- 0.331 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.4 all L1 = 0.898 +- 0.254 (in-sample avg dev_std = 0.206)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.973
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769859999999999
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.946
SUFF_SIMPLE for r=0.8 class 0.0 = 0.964 +- 0.172 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.983 +- 0.172 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 all KL = 0.967 +- 0.172 (in-sample avg dev_std = 0.057)
SUFF_SIMPLE for r=0.8 all L1 = 0.973 +- 0.140 (in-sample avg dev_std = 0.057)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.031996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.976
NEC for r=0.05 class 0.0 = 0.054 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.031 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.024 +- 0.137 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046182
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.924
NEC for r=0.1 class 0.0 = 0.148 +- 0.266 (in-sample avg dev_std = 0.031)
NEC for r=0.1 class 1.0 = 0.0 +- 0.266 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.078 +- 0.266 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.066 +- 0.227 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05686
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.876
NEC for r=0.2 class 0.0 = 0.269 +- 0.364 (in-sample avg dev_std = 0.250)
NEC for r=0.2 class 1.0 = 0.0 +- 0.364 (in-sample avg dev_std = 0.250)
NEC for r=0.2 all KL = 0.16 +- 0.364 (in-sample avg dev_std = 0.250)
NEC for r=0.2 all L1 = 0.12 +- 0.282 (in-sample avg dev_std = 0.250)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06764400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.849
NEC for r=0.4 class 0.0 = 0.333 +- 0.400 (in-sample avg dev_std = 0.325)
NEC for r=0.4 class 1.0 = 0.003 +- 0.400 (in-sample avg dev_std = 0.325)
NEC for r=0.4 all KL = 0.206 +- 0.400 (in-sample avg dev_std = 0.325)
NEC for r=0.4 all L1 = 0.15 +- 0.303 (in-sample avg dev_std = 0.325)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0786
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.848
NEC for r=0.8 class 0.0 = 0.334 +- 0.411 (in-sample avg dev_std = 0.373)
NEC for r=0.8 class 1.0 = 0.017 +- 0.411 (in-sample avg dev_std = 0.373)
NEC for r=0.8 all KL = 0.223 +- 0.411 (in-sample avg dev_std = 0.373)
NEC for r=0.8 all L1 = 0.158 +- 0.303 (in-sample avg dev_std = 0.373)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.957
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008801999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.878
NEC for r=0.05 class 0.0 = 0.148 +- 0.290 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.001 +- 0.290 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.097 +- 0.290 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.074 +- 0.232 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.957
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0094696
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.77
NEC for r=0.1 class 0.0 = 0.343 +- 0.406 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.001 +- 0.406 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.213 +- 0.406 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.171 +- 0.334 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.957
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094348
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.727
NEC for r=0.2 class 0.0 = 0.416 +- 0.434 (in-sample avg dev_std = 0.018)
NEC for r=0.2 class 1.0 = 0.001 +- 0.434 (in-sample avg dev_std = 0.018)
NEC for r=0.2 all KL = 0.253 +- 0.434 (in-sample avg dev_std = 0.018)
NEC for r=0.2 all L1 = 0.207 +- 0.360 (in-sample avg dev_std = 0.018)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.957
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096582
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.727
NEC for r=0.4 class 0.0 = 0.416 +- 0.433 (in-sample avg dev_std = 0.028)
NEC for r=0.4 class 1.0 = 0.001 +- 0.433 (in-sample avg dev_std = 0.028)
NEC for r=0.4 all KL = 0.253 +- 0.433 (in-sample avg dev_std = 0.028)
NEC for r=0.4 all L1 = 0.207 +- 0.360 (in-sample avg dev_std = 0.028)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.957
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097536
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.727
NEC for r=0.8 class 0.0 = 0.416 +- 0.434 (in-sample avg dev_std = 0.032)
NEC for r=0.8 class 1.0 = 0.001 +- 0.434 (in-sample avg dev_std = 0.032)
NEC for r=0.8 all KL = 0.253 +- 0.434 (in-sample avg dev_std = 0.032)
NEC for r=0.8 all L1 = 0.207 +- 0.360 (in-sample avg dev_std = 0.032)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0250228
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.965
NEC for r=0.05 class 0.0 = 0.016 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.002 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.083 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.034944399999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.96
NEC for r=0.1 class 0.0 = 0.024 +- 0.128 (in-sample avg dev_std = 0.036)
NEC for r=0.1 class 1.0 = 0.006 +- 0.128 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all KL = 0.018 +- 0.128 (in-sample avg dev_std = 0.036)
NEC for r=0.1 all L1 = 0.015 +- 0.106 (in-sample avg dev_std = 0.036)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461592
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.945
NEC for r=0.2 class 0.0 = 0.047 +- 0.180 (in-sample avg dev_std = 0.074)
NEC for r=0.2 class 1.0 = 0.01 +- 0.180 (in-sample avg dev_std = 0.074)
NEC for r=0.2 all KL = 0.038 +- 0.180 (in-sample avg dev_std = 0.074)
NEC for r=0.2 all L1 = 0.029 +- 0.144 (in-sample avg dev_std = 0.074)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060563
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.915
NEC for r=0.4 class 0.0 = 0.097 +- 0.251 (in-sample avg dev_std = 0.119)
NEC for r=0.4 class 1.0 = 0.016 +- 0.251 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all KL = 0.078 +- 0.251 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all L1 = 0.057 +- 0.199 (in-sample avg dev_std = 0.119)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769859999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.898
NEC for r=0.8 class 0.0 = 0.125 +- 0.321 (in-sample avg dev_std = 0.198)
NEC for r=0.8 class 1.0 = 0.059 +- 0.321 (in-sample avg dev_std = 0.198)
NEC for r=0.8 all KL = 0.141 +- 0.321 (in-sample avg dev_std = 0.198)
NEC for r=0.8 all L1 = 0.092 +- 0.234 (in-sample avg dev_std = 0.198)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 20:39:03 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:39:03 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 81 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 81...
[0m[1;37mINFO[0m: [1mCheckpoint 81: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.061
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.034
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.033142
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.783
SUFF_SIMPLE for r=0.05 class 0.0 = 0.592 +- 0.417 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.97 +- 0.417 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.05 all KL = 0.753 +- 0.417 (in-sample avg dev_std = 0.150)
SUFF_SIMPLE for r=0.05 all L1 = 0.802 +- 0.351 (in-sample avg dev_std = 0.150)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04718000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.792
SUFF_SIMPLE for r=0.1 class 0.0 = 0.591 +- 0.414 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.989 +- 0.414 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.1 all KL = 0.775 +- 0.414 (in-sample avg dev_std = 0.158)
SUFF_SIMPLE for r=0.1 all L1 = 0.812 +- 0.351 (in-sample avg dev_std = 0.158)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061318000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.792
SUFF_SIMPLE for r=0.2 class 0.0 = 0.595 +- 0.412 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.994 +- 0.412 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all KL = 0.784 +- 0.412 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.2 all L1 = 0.816 +- 0.351 (in-sample avg dev_std = 0.154)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07402600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.793
SUFF_SIMPLE for r=0.4 class 0.0 = 0.59 +- 0.411 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.411 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.411 (in-sample avg dev_std = 0.153)
SUFF_SIMPLE for r=0.4 all L1 = 0.817 +- 0.351 (in-sample avg dev_std = 0.153)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.898
SUFF_SIMPLE for r=0.8 class 0.0 = 0.798 +- 0.308 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.308 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.892 +- 0.308 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.261 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008237000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.558 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.5 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.008912799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.558 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.5 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009259
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.558 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.5 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009552199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.746
SUFF_SIMPLE for r=0.4 class 0.0 = 0.558 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.429 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.5 +- 0.420 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097164
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.751
SUFF_SIMPLE for r=0.8 class 0.0 = 0.566 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.443 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.434 +- 0.487 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.504 +- 0.421 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249308
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.781
SUFF_SIMPLE for r=0.05 class 0.0 = 0.835 +- 0.379 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.802 +- 0.379 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all KL = 0.736 +- 0.379 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all L1 = 0.819 +- 0.290 (in-sample avg dev_std = 0.323)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0338566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.781
SUFF_SIMPLE for r=0.1 class 0.0 = 0.836 +- 0.380 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.815 +- 0.380 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.1 all KL = 0.754 +- 0.380 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.1 all L1 = 0.826 +- 0.294 (in-sample avg dev_std = 0.313)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0458186
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.781
SUFF_SIMPLE for r=0.2 class 0.0 = 0.837 +- 0.382 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.382 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 all KL = 0.768 +- 0.382 (in-sample avg dev_std = 0.308)
SUFF_SIMPLE for r=0.2 all L1 = 0.83 +- 0.297 (in-sample avg dev_std = 0.308)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0598442
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.783
SUFF_SIMPLE for r=0.4 class 0.0 = 0.842 +- 0.378 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.832 +- 0.378 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.378 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all L1 = 0.837 +- 0.299 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.83
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0774122
len(reference) = 4980
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.864
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.269 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.86 +- 0.269 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.8 all KL = 0.904 +- 0.269 (in-sample avg dev_std = 0.081)
SUFF_SIMPLE for r=0.8 all L1 = 0.915 +- 0.232 (in-sample avg dev_std = 0.081)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.033142
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.005 +- 0.048 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.048 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.003 +- 0.048 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04718000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.971
NEC for r=0.1 class 0.0 = 0.06 +- 0.177 (in-sample avg dev_std = 0.055)
NEC for r=0.1 class 1.0 = 0.0 +- 0.177 (in-sample avg dev_std = 0.055)
NEC for r=0.1 all KL = 0.034 +- 0.177 (in-sample avg dev_std = 0.055)
NEC for r=0.1 all L1 = 0.027 +- 0.144 (in-sample avg dev_std = 0.055)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.061318000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.914
NEC for r=0.2 class 0.0 = 0.198 +- 0.326 (in-sample avg dev_std = 0.251)
NEC for r=0.2 class 1.0 = 0.0 +- 0.326 (in-sample avg dev_std = 0.251)
NEC for r=0.2 all KL = 0.127 +- 0.326 (in-sample avg dev_std = 0.251)
NEC for r=0.2 all L1 = 0.088 +- 0.240 (in-sample avg dev_std = 0.251)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07402600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.878
NEC for r=0.4 class 0.0 = 0.278 +- 0.381 (in-sample avg dev_std = 0.324)
NEC for r=0.4 class 1.0 = 0.003 +- 0.381 (in-sample avg dev_std = 0.324)
NEC for r=0.4 all KL = 0.186 +- 0.381 (in-sample avg dev_std = 0.324)
NEC for r=0.4 all L1 = 0.126 +- 0.276 (in-sample avg dev_std = 0.324)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.872
NEC for r=0.8 class 0.0 = 0.291 +- 0.394 (in-sample avg dev_std = 0.359)
NEC for r=0.8 class 1.0 = 0.01 +- 0.394 (in-sample avg dev_std = 0.359)
NEC for r=0.8 all KL = 0.203 +- 0.394 (in-sample avg dev_std = 0.359)
NEC for r=0.8 all L1 = 0.135 +- 0.280 (in-sample avg dev_std = 0.359)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.682
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008237000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.95
NEC for r=0.05 class 0.0 = 0.002 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.479 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.278 +- 0.437 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.242 +- 0.378 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.682
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.008912799999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.938
NEC for r=0.1 class 0.0 = 0.111 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.556 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.384 +- 0.476 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.335 +- 0.413 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.682
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009259
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.759
NEC for r=0.2 class 0.0 = 0.426 +- 0.487 (in-sample avg dev_std = 0.120)
NEC for r=0.2 class 1.0 = 0.557 +- 0.487 (in-sample avg dev_std = 0.120)
NEC for r=0.2 all KL = 0.565 +- 0.487 (in-sample avg dev_std = 0.120)
NEC for r=0.2 all L1 = 0.492 +- 0.419 (in-sample avg dev_std = 0.120)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.682
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009552199999999999
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.757
NEC for r=0.4 class 0.0 = 0.434 +- 0.487 (in-sample avg dev_std = 0.172)
NEC for r=0.4 class 1.0 = 0.557 +- 0.487 (in-sample avg dev_std = 0.172)
NEC for r=0.4 all KL = 0.57 +- 0.487 (in-sample avg dev_std = 0.172)
NEC for r=0.4 all L1 = 0.496 +- 0.418 (in-sample avg dev_std = 0.172)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.682
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097164
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.755
NEC for r=0.8 class 0.0 = 0.436 +- 0.487 (in-sample avg dev_std = 0.171)
NEC for r=0.8 class 1.0 = 0.557 +- 0.487 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all KL = 0.571 +- 0.487 (in-sample avg dev_std = 0.171)
NEC for r=0.8 all L1 = 0.497 +- 0.418 (in-sample avg dev_std = 0.171)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.828
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0249308
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.835
NEC for r=0.05 class 0.0 = 0.015 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.045 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.025 +- 0.130 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.03 +- 0.124 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.828
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0338566
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.844
NEC for r=0.1 class 0.0 = 0.02 +- 0.178 (in-sample avg dev_std = 0.041)
NEC for r=0.1 class 1.0 = 0.074 +- 0.178 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all KL = 0.046 +- 0.178 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all L1 = 0.047 +- 0.164 (in-sample avg dev_std = 0.041)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.828
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0458186
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.833
NEC for r=0.2 class 0.0 = 0.043 +- 0.239 (in-sample avg dev_std = 0.152)
NEC for r=0.2 class 1.0 = 0.099 +- 0.239 (in-sample avg dev_std = 0.152)
NEC for r=0.2 all KL = 0.08 +- 0.239 (in-sample avg dev_std = 0.152)
NEC for r=0.2 all L1 = 0.07 +- 0.201 (in-sample avg dev_std = 0.152)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.828
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0598442
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.802
NEC for r=0.4 class 0.0 = 0.089 +- 0.287 (in-sample avg dev_std = 0.207)
NEC for r=0.4 class 1.0 = 0.107 +- 0.287 (in-sample avg dev_std = 0.207)
NEC for r=0.4 all KL = 0.122 +- 0.287 (in-sample avg dev_std = 0.207)
NEC for r=0.4 all L1 = 0.098 +- 0.234 (in-sample avg dev_std = 0.207)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.828
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0774122
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.789
NEC for r=0.8 class 0.0 = 0.117 +- 0.312 (in-sample avg dev_std = 0.251)
NEC for r=0.8 class 1.0 = 0.12 +- 0.312 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all KL = 0.165 +- 0.312 (in-sample avg dev_std = 0.251)
NEC for r=0.8 all L1 = 0.118 +- 0.244 (in-sample avg dev_std = 0.251)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 20:56:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 08:56:00 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 88 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 88...
[0m[1;37mINFO[0m: [1mCheckpoint 88: 
-----------------------------------
Train ACCURACY: 0.9998
Train Loss: 0.0038
ID Validation ACCURACY: 0.9980
ID Validation Loss: 0.0053
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0046
OOD Validation ACCURACY: 0.9980
OOD Validation Loss: 0.0053
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0046

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 0.9980 0.9980[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.046
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.059
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034836
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.66
SUFF_SIMPLE for r=0.05 class 0.0 = 0.507 +- 0.459 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.788 +- 0.459 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.05 all KL = 0.549 +- 0.459 (in-sample avg dev_std = 0.377)
SUFF_SIMPLE for r=0.05 all L1 = 0.663 +- 0.372 (in-sample avg dev_std = 0.377)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045554000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.673
SUFF_SIMPLE for r=0.1 class 0.0 = 0.477 +- 0.458 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.837 +- 0.458 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 all KL = 0.572 +- 0.458 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.1 all L1 = 0.677 +- 0.373 (in-sample avg dev_std = 0.331)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059278000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.692
SUFF_SIMPLE for r=0.2 class 0.0 = 0.461 +- 0.458 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.89 +- 0.458 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.2 all KL = 0.611 +- 0.458 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.2 all L1 = 0.699 +- 0.373 (in-sample avg dev_std = 0.297)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070852
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.709
SUFF_SIMPLE for r=0.4 class 0.0 = 0.434 +- 0.455 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.955 +- 0.455 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.4 all KL = 0.653 +- 0.455 (in-sample avg dev_std = 0.244)
SUFF_SIMPLE for r=0.4 all L1 = 0.722 +- 0.375 (in-sample avg dev_std = 0.244)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.824
SUFF_SIMPLE for r=0.8 class 0.0 = 0.648 +- 0.384 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.976 +- 0.384 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.792 +- 0.384 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.83 +- 0.318 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085098
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.504
SUFF_SIMPLE for r=0.05 class 0.0 = 0.174 +- 0.478 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.92 +- 0.478 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 all KL = 0.501 +- 0.478 (in-sample avg dev_std = 0.020)
SUFF_SIMPLE for r=0.05 all L1 = 0.55 +- 0.413 (in-sample avg dev_std = 0.020)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091046
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.504
SUFF_SIMPLE for r=0.1 class 0.0 = 0.174 +- 0.478 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.92 +- 0.478 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.1 all KL = 0.501 +- 0.478 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.1 all L1 = 0.55 +- 0.413 (in-sample avg dev_std = 0.017)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009589
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.504
SUFF_SIMPLE for r=0.2 class 0.0 = 0.174 +- 0.478 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.92 +- 0.478 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.2 all KL = 0.501 +- 0.478 (in-sample avg dev_std = 0.019)
SUFF_SIMPLE for r=0.2 all L1 = 0.55 +- 0.413 (in-sample avg dev_std = 0.019)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009715600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.504
SUFF_SIMPLE for r=0.4 class 0.0 = 0.174 +- 0.478 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.92 +- 0.478 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.4 all KL = 0.501 +- 0.478 (in-sample avg dev_std = 0.015)
SUFF_SIMPLE for r=0.4 all L1 = 0.55 +- 0.413 (in-sample avg dev_std = 0.015)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009750400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.629
SUFF_SIMPLE for r=0.8 class 0.0 = 0.375 +- 0.458 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.92 +- 0.458 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.594 +- 0.458 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.649 +- 0.394 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.025713
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.63
SUFF_SIMPLE for r=0.05 class 0.0 = 0.803 +- 0.440 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.479 +- 0.440 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.05 all KL = 0.572 +- 0.440 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.05 all L1 = 0.643 +- 0.360 (in-sample avg dev_std = 0.317)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0365034
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.638
SUFF_SIMPLE for r=0.1 class 0.0 = 0.771 +- 0.436 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.537 +- 0.436 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.1 all KL = 0.588 +- 0.436 (in-sample avg dev_std = 0.295)
SUFF_SIMPLE for r=0.1 all L1 = 0.655 +- 0.360 (in-sample avg dev_std = 0.295)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0490452
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.648
SUFF_SIMPLE for r=0.2 class 0.0 = 0.739 +- 0.432 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.606 +- 0.432 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 all KL = 0.612 +- 0.432 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 all L1 = 0.673 +- 0.358 (in-sample avg dev_std = 0.273)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0634418
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.667
SUFF_SIMPLE for r=0.4 class 0.0 = 0.76 +- 0.421 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.653 +- 0.421 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.4 all KL = 0.661 +- 0.421 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.4 all L1 = 0.707 +- 0.354 (in-sample avg dev_std = 0.234)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918420000000001
len(reference) = 4980
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.711
SUFF_SIMPLE for r=0.8 class 0.0 = 0.937 +- 0.301 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.768 +- 0.301 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.8 all KL = 0.849 +- 0.301 (in-sample avg dev_std = 0.068)
SUFF_SIMPLE for r=0.8 all L1 = 0.854 +- 0.264 (in-sample avg dev_std = 0.068)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.998
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034836
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.99
NEC for r=0.05 class 0.0 = 0.051 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.007 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.027 +- 0.112 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.998
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045554000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.954
NEC for r=0.1 class 0.0 = 0.12 +- 0.234 (in-sample avg dev_std = 0.009)
NEC for r=0.1 class 1.0 = 0.012 +- 0.234 (in-sample avg dev_std = 0.009)
NEC for r=0.1 all KL = 0.077 +- 0.234 (in-sample avg dev_std = 0.009)
NEC for r=0.1 all L1 = 0.06 +- 0.184 (in-sample avg dev_std = 0.009)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.998
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.059278000000000004
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.893
NEC for r=0.2 class 0.0 = 0.272 +- 0.352 (in-sample avg dev_std = 0.217)
NEC for r=0.2 class 1.0 = 0.014 +- 0.352 (in-sample avg dev_std = 0.217)
NEC for r=0.2 all KL = 0.181 +- 0.352 (in-sample avg dev_std = 0.217)
NEC for r=0.2 all L1 = 0.129 +- 0.261 (in-sample avg dev_std = 0.217)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.998
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.070852
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.837
NEC for r=0.4 class 0.0 = 0.373 +- 0.403 (in-sample avg dev_std = 0.325)
NEC for r=0.4 class 1.0 = 0.033 +- 0.403 (in-sample avg dev_std = 0.325)
NEC for r=0.4 all KL = 0.268 +- 0.403 (in-sample avg dev_std = 0.325)
NEC for r=0.4 all L1 = 0.185 +- 0.295 (in-sample avg dev_std = 0.325)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.998
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.837
NEC for r=0.8 class 0.0 = 0.358 +- 0.407 (in-sample avg dev_std = 0.378)
NEC for r=0.8 class 1.0 = 0.066 +- 0.407 (in-sample avg dev_std = 0.378)
NEC for r=0.8 all KL = 0.299 +- 0.407 (in-sample avg dev_std = 0.378)
NEC for r=0.8 all L1 = 0.196 +- 0.289 (in-sample avg dev_std = 0.378)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0085098
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.893
NEC for r=0.05 class 0.0 = 0.165 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.072 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.12 +- 0.264 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.118 +- 0.241 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0091046
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.781
NEC for r=0.1 class 0.0 = 0.374 +- 0.397 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.08 +- 0.397 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.265 +- 0.397 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.226 +- 0.335 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009589
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.642
NEC for r=0.2 class 0.0 = 0.602 +- 0.454 (in-sample avg dev_std = 0.092)
NEC for r=0.2 class 1.0 = 0.08 +- 0.454 (in-sample avg dev_std = 0.092)
NEC for r=0.2 all KL = 0.392 +- 0.454 (in-sample avg dev_std = 0.092)
NEC for r=0.2 all L1 = 0.339 +- 0.392 (in-sample avg dev_std = 0.092)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009715600000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.631
NEC for r=0.4 class 0.0 = 0.639 +- 0.458 (in-sample avg dev_std = 0.206)
NEC for r=0.4 class 1.0 = 0.081 +- 0.458 (in-sample avg dev_std = 0.206)
NEC for r=0.4 all KL = 0.433 +- 0.458 (in-sample avg dev_std = 0.206)
NEC for r=0.4 all L1 = 0.358 +- 0.388 (in-sample avg dev_std = 0.206)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009750400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.631
NEC for r=0.8 class 0.0 = 0.642 +- 0.458 (in-sample avg dev_std = 0.224)
NEC for r=0.8 class 1.0 = 0.081 +- 0.458 (in-sample avg dev_std = 0.224)
NEC for r=0.8 all KL = 0.437 +- 0.458 (in-sample avg dev_std = 0.224)
NEC for r=0.8 all L1 = 0.359 +- 0.387 (in-sample avg dev_std = 0.224)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.657
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.025713
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.669
NEC for r=0.05 class 0.0 = 0.031 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.111 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.052 +- 0.163 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.071 +- 0.167 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.657
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0365034
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.682
NEC for r=0.1 class 0.0 = 0.044 +- 0.227 (in-sample avg dev_std = 0.053)
NEC for r=0.1 class 1.0 = 0.165 +- 0.227 (in-sample avg dev_std = 0.053)
NEC for r=0.1 all KL = 0.093 +- 0.227 (in-sample avg dev_std = 0.053)
NEC for r=0.1 all L1 = 0.103 +- 0.213 (in-sample avg dev_std = 0.053)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.657
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0490452
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.692
NEC for r=0.2 class 0.0 = 0.069 +- 0.292 (in-sample avg dev_std = 0.119)
NEC for r=0.2 class 1.0 = 0.218 +- 0.292 (in-sample avg dev_std = 0.119)
NEC for r=0.2 all KL = 0.148 +- 0.292 (in-sample avg dev_std = 0.119)
NEC for r=0.2 all L1 = 0.143 +- 0.255 (in-sample avg dev_std = 0.119)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.657
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0634418
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.663
NEC for r=0.4 class 0.0 = 0.143 +- 0.355 (in-sample avg dev_std = 0.195)
NEC for r=0.4 class 1.0 = 0.255 +- 0.355 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all KL = 0.223 +- 0.355 (in-sample avg dev_std = 0.195)
NEC for r=0.4 all L1 = 0.198 +- 0.298 (in-sample avg dev_std = 0.195)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.657
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07918420000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.637
NEC for r=0.8 class 0.0 = 0.177 +- 0.397 (in-sample avg dev_std = 0.278)
NEC for r=0.8 class 1.0 = 0.337 +- 0.397 (in-sample avg dev_std = 0.278)
NEC for r=0.8 all KL = 0.304 +- 0.397 (in-sample avg dev_std = 0.278)
NEC for r=0.8 all L1 = 0.256 +- 0.324 (in-sample avg dev_std = 0.278)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 21:13:02 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:13:02 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 66 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 66...
[0m[1;37mINFO[0m: [1mCheckpoint 66: 
-----------------------------------
Train ACCURACY: 0.9972
Train Loss: 0.0102
ID Validation ACCURACY: 0.9960
ID Validation Loss: 0.0090
ID Test ACCURACY: 0.9960
ID Test Loss: 0.0138
OOD Validation ACCURACY: 0.9960
OOD Validation Loss: 0.0090
OOD Test ACCURACY: 0.9960
OOD Test Loss: 0.0138

[0m[1;37mINFO[0m: [1mChartInfo 0.9960 0.9960 0.9960 0.9960 0.9960 0.9960[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.045
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.072
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.026
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.035
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032502
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.637
SUFF_SIMPLE for r=0.05 class 0.0 = 0.453 +- 0.477 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.813 +- 0.477 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all KL = 0.555 +- 0.477 (in-sample avg dev_std = 0.323)
SUFF_SIMPLE for r=0.05 all L1 = 0.652 +- 0.390 (in-sample avg dev_std = 0.323)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045287999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.676
SUFF_SIMPLE for r=0.1 class 0.0 = 0.457 +- 0.460 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.87 +- 0.460 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 all KL = 0.589 +- 0.460 (in-sample avg dev_std = 0.314)
SUFF_SIMPLE for r=0.1 all L1 = 0.686 +- 0.378 (in-sample avg dev_std = 0.314)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055628
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.697
SUFF_SIMPLE for r=0.2 class 0.0 = 0.421 +- 0.459 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.941 +- 0.459 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 all KL = 0.633 +- 0.459 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 all L1 = 0.709 +- 0.379 (in-sample avg dev_std = 0.273)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.072182
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.689
SUFF_SIMPLE for r=0.4 class 0.0 = 0.404 +- 0.463 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.953 +- 0.463 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all KL = 0.644 +- 0.463 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.4 all L1 = 0.708 +- 0.387 (in-sample avg dev_std = 0.236)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.802
SUFF_SIMPLE for r=0.8 class 0.0 = 0.579 +- 0.409 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.985 +- 0.409 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.756 +- 0.409 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.804 +- 0.337 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008719999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.505
SUFF_SIMPLE for r=0.05 class 0.0 = 0.138 +- 0.427 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.565 +- 0.427 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.05 all KL = 0.263 +- 0.427 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.05 all L1 = 0.353 +- 0.363 (in-sample avg dev_std = 0.052)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093566
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.505
SUFF_SIMPLE for r=0.1 class 0.0 = 0.138 +- 0.427 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.565 +- 0.427 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.1 all KL = 0.263 +- 0.427 (in-sample avg dev_std = 0.048)
SUFF_SIMPLE for r=0.1 all L1 = 0.353 +- 0.363 (in-sample avg dev_std = 0.048)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095666
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.505
SUFF_SIMPLE for r=0.2 class 0.0 = 0.138 +- 0.427 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.565 +- 0.427 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.2 all KL = 0.263 +- 0.427 (in-sample avg dev_std = 0.059)
SUFF_SIMPLE for r=0.2 all L1 = 0.353 +- 0.363 (in-sample avg dev_std = 0.059)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.505
SUFF_SIMPLE for r=0.4 class 0.0 = 0.138 +- 0.427 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.565 +- 0.427 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.4 all KL = 0.263 +- 0.427 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.4 all L1 = 0.353 +- 0.363 (in-sample avg dev_std = 0.054)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009791999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.717
SUFF_SIMPLE for r=0.8 class 0.0 = 0.498 +- 0.477 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.572 +- 0.477 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.449 +- 0.477 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.535 +- 0.410 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0257466
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.59
SUFF_SIMPLE for r=0.05 class 0.0 = 0.777 +- 0.447 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.497 +- 0.447 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.05 all KL = 0.499 +- 0.447 (in-sample avg dev_std = 0.369)
SUFF_SIMPLE for r=0.05 all L1 = 0.639 +- 0.360 (in-sample avg dev_std = 0.369)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035068600000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.603
SUFF_SIMPLE for r=0.1 class 0.0 = 0.742 +- 0.446 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.565 +- 0.446 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.1 all KL = 0.52 +- 0.446 (in-sample avg dev_std = 0.346)
SUFF_SIMPLE for r=0.1 all L1 = 0.654 +- 0.359 (in-sample avg dev_std = 0.346)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0466994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.609
SUFF_SIMPLE for r=0.2 class 0.0 = 0.706 +- 0.445 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.643 +- 0.445 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.2 all KL = 0.553 +- 0.445 (in-sample avg dev_std = 0.317)
SUFF_SIMPLE for r=0.2 all L1 = 0.675 +- 0.359 (in-sample avg dev_std = 0.317)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06228140000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.628
SUFF_SIMPLE for r=0.4 class 0.0 = 0.732 +- 0.439 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.703 +- 0.439 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 all KL = 0.618 +- 0.439 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.4 all L1 = 0.717 +- 0.351 (in-sample avg dev_std = 0.287)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828580000000002
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.691
SUFF_SIMPLE for r=0.8 class 0.0 = 0.922 +- 0.313 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.313 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 all KL = 0.847 +- 0.313 (in-sample avg dev_std = 0.098)
SUFF_SIMPLE for r=0.8 all L1 = 0.873 +- 0.259 (in-sample avg dev_std = 0.098)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.996
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032502
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.982
NEC for r=0.05 class 0.0 = 0.045 +- 0.138 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.012 +- 0.138 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.138 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.026 +- 0.119 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.996
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.045287999999999995
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.938
NEC for r=0.1 class 0.0 = 0.156 +- 0.272 (in-sample avg dev_std = 0.032)
NEC for r=0.1 class 1.0 = 0.013 +- 0.272 (in-sample avg dev_std = 0.032)
NEC for r=0.1 all KL = 0.099 +- 0.272 (in-sample avg dev_std = 0.032)
NEC for r=0.1 all L1 = 0.076 +- 0.215 (in-sample avg dev_std = 0.032)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.996
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055628
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.854
NEC for r=0.2 class 0.0 = 0.324 +- 0.384 (in-sample avg dev_std = 0.215)
NEC for r=0.2 class 1.0 = 0.028 +- 0.384 (in-sample avg dev_std = 0.215)
NEC for r=0.2 all KL = 0.22 +- 0.384 (in-sample avg dev_std = 0.215)
NEC for r=0.2 all L1 = 0.16 +- 0.297 (in-sample avg dev_std = 0.215)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.996
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.072182
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.817
NEC for r=0.4 class 0.0 = 0.403 +- 0.416 (in-sample avg dev_std = 0.299)
NEC for r=0.4 class 1.0 = 0.034 +- 0.416 (in-sample avg dev_std = 0.299)
NEC for r=0.4 all KL = 0.281 +- 0.416 (in-sample avg dev_std = 0.299)
NEC for r=0.4 all L1 = 0.198 +- 0.317 (in-sample avg dev_std = 0.299)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.996
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.081064
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.801
NEC for r=0.8 class 0.0 = 0.403 +- 0.429 (in-sample avg dev_std = 0.377)
NEC for r=0.8 class 1.0 = 0.073 +- 0.429 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all KL = 0.33 +- 0.429 (in-sample avg dev_std = 0.377)
NEC for r=0.8 all L1 = 0.22 +- 0.316 (in-sample avg dev_std = 0.377)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.757
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.008719999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.829
NEC for r=0.05 class 0.0 = 0.019 +- 0.295 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.189 +- 0.295 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.123 +- 0.295 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.104 +- 0.248 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.757
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093566
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.86
NEC for r=0.1 class 0.0 = 0.102 +- 0.406 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.306 +- 0.406 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.252 +- 0.406 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.205 +- 0.339 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.757
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095666
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.737
NEC for r=0.2 class 0.0 = 0.466 +- 0.477 (in-sample avg dev_std = 0.210)
NEC for r=0.2 class 1.0 = 0.42 +- 0.477 (in-sample avg dev_std = 0.210)
NEC for r=0.2 all KL = 0.541 +- 0.477 (in-sample avg dev_std = 0.210)
NEC for r=0.2 all L1 = 0.443 +- 0.403 (in-sample avg dev_std = 0.210)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.757
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098564
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.709
NEC for r=0.4 class 0.0 = 0.549 +- 0.461 (in-sample avg dev_std = 0.392)
NEC for r=0.4 class 1.0 = 0.426 +- 0.461 (in-sample avg dev_std = 0.392)
NEC for r=0.4 all KL = 0.622 +- 0.461 (in-sample avg dev_std = 0.392)
NEC for r=0.4 all L1 = 0.487 +- 0.382 (in-sample avg dev_std = 0.392)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.757
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009791999999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.714
NEC for r=0.8 class 0.0 = 0.55 +- 0.458 (in-sample avg dev_std = 0.420)
NEC for r=0.8 class 1.0 = 0.428 +- 0.458 (in-sample avg dev_std = 0.420)
NEC for r=0.8 all KL = 0.631 +- 0.458 (in-sample avg dev_std = 0.420)
NEC for r=0.8 all L1 = 0.488 +- 0.378 (in-sample avg dev_std = 0.420)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.658
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0257466
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.666
NEC for r=0.05 class 0.0 = 0.033 +- 0.174 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.079 +- 0.174 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.049 +- 0.174 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.056 +- 0.164 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.658
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035068600000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.675
NEC for r=0.1 class 0.0 = 0.049 +- 0.239 (in-sample avg dev_std = 0.068)
NEC for r=0.1 class 1.0 = 0.122 +- 0.239 (in-sample avg dev_std = 0.068)
NEC for r=0.1 all KL = 0.089 +- 0.239 (in-sample avg dev_std = 0.068)
NEC for r=0.1 all L1 = 0.085 +- 0.210 (in-sample avg dev_std = 0.068)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.658
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0466994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.678
NEC for r=0.2 class 0.0 = 0.083 +- 0.316 (in-sample avg dev_std = 0.172)
NEC for r=0.2 class 1.0 = 0.169 +- 0.316 (in-sample avg dev_std = 0.172)
NEC for r=0.2 all KL = 0.154 +- 0.316 (in-sample avg dev_std = 0.172)
NEC for r=0.2 all L1 = 0.126 +- 0.255 (in-sample avg dev_std = 0.172)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.658
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06228140000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.648
NEC for r=0.4 class 0.0 = 0.162 +- 0.380 (in-sample avg dev_std = 0.255)
NEC for r=0.4 class 1.0 = 0.209 +- 0.380 (in-sample avg dev_std = 0.255)
NEC for r=0.4 all KL = 0.247 +- 0.380 (in-sample avg dev_std = 0.255)
NEC for r=0.4 all L1 = 0.185 +- 0.299 (in-sample avg dev_std = 0.255)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.658
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07828580000000002
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.61
NEC for r=0.8 class 0.0 = 0.218 +- 0.421 (in-sample avg dev_std = 0.333)
NEC for r=0.8 class 1.0 = 0.305 +- 0.421 (in-sample avg dev_std = 0.333)
NEC for r=0.8 all KL = 0.367 +- 0.421 (in-sample avg dev_std = 0.333)
NEC for r=0.8 all L1 = 0.261 +- 0.331 (in-sample avg dev_std = 0.333)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 21:29:48 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:29:49 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 79 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 79...
[0m[1;37mINFO[0m: [1mCheckpoint 79: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0000
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0000
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0000
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0000
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0000

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.047
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.069
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.008
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.024
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.034
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.061
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034603999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.8
SUFF_SIMPLE for r=0.05 class 0.0 = 0.629 +- 0.437 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.936 +- 0.437 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.05 all KL = 0.726 +- 0.437 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.05 all L1 = 0.799 +- 0.336 (in-sample avg dev_std = 0.304)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046728
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.804
SUFF_SIMPLE for r=0.1 class 0.0 = 0.626 +- 0.423 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.962 +- 0.423 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 all KL = 0.756 +- 0.423 (in-sample avg dev_std = 0.287)
SUFF_SIMPLE for r=0.1 all L1 = 0.812 +- 0.337 (in-sample avg dev_std = 0.287)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056165999999999994
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.805
SUFF_SIMPLE for r=0.2 class 0.0 = 0.619 +- 0.416 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.982 +- 0.416 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all KL = 0.777 +- 0.416 (in-sample avg dev_std = 0.264)
SUFF_SIMPLE for r=0.2 all L1 = 0.82 +- 0.340 (in-sample avg dev_std = 0.264)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06944800000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.821
SUFF_SIMPLE for r=0.4 class 0.0 = 0.628 +- 0.407 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.994 +- 0.407 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 all KL = 0.786 +- 0.407 (in-sample avg dev_std = 0.261)
SUFF_SIMPLE for r=0.4 all L1 = 0.831 +- 0.330 (in-sample avg dev_std = 0.261)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.938
SUFF_SIMPLE for r=0.8 class 0.0 = 0.874 +- 0.250 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.250 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.931 +- 0.250 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.209 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0079212
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.732
SUFF_SIMPLE for r=0.05 class 0.0 = 0.574 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.361 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.37 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.467 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0087958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.732
SUFF_SIMPLE for r=0.1 class 0.0 = 0.574 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.361 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.37 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.467 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094218
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.732
SUFF_SIMPLE for r=0.2 class 0.0 = 0.574 +- 0.470 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.361 +- 0.470 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.2 all KL = 0.37 +- 0.470 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.2 all L1 = 0.467 +- 0.395 (in-sample avg dev_std = 0.004)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009572
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.732
SUFF_SIMPLE for r=0.4 class 0.0 = 0.574 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.361 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.37 +- 0.470 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.467 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.00968
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.794
SUFF_SIMPLE for r=0.8 class 0.0 = 0.683 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.363 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.433 +- 0.481 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.522 +- 0.405 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0240774
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.742
SUFF_SIMPLE for r=0.05 class 0.0 = 0.828 +- 0.436 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.749 +- 0.436 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 all KL = 0.673 +- 0.436 (in-sample avg dev_std = 0.352)
SUFF_SIMPLE for r=0.05 all L1 = 0.789 +- 0.310 (in-sample avg dev_std = 0.352)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.033907799999999995
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.752
SUFF_SIMPLE for r=0.1 class 0.0 = 0.825 +- 0.426 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.778 +- 0.426 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.1 all KL = 0.709 +- 0.426 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.1 all L1 = 0.802 +- 0.316 (in-sample avg dev_std = 0.330)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.753
SUFF_SIMPLE for r=0.2 class 0.0 = 0.827 +- 0.412 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.812 +- 0.412 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.2 all KL = 0.746 +- 0.412 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.2 all L1 = 0.82 +- 0.313 (in-sample avg dev_std = 0.313)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0606546
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.76
SUFF_SIMPLE for r=0.4 class 0.0 = 0.838 +- 0.395 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.838 +- 0.395 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all KL = 0.785 +- 0.395 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all L1 = 0.838 +- 0.309 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.799
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07728800000000001
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.833
SUFF_SIMPLE for r=0.8 class 0.0 = 0.971 +- 0.270 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.88 +- 0.270 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.8 all KL = 0.912 +- 0.270 (in-sample avg dev_std = 0.027)
SUFF_SIMPLE for r=0.8 all L1 = 0.926 +- 0.228 (in-sample avg dev_std = 0.027)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034603999999999996
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.046728
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.994
NEC for r=0.1 class 0.0 = 0.012 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.0 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.006 +- 0.077 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.005 +- 0.067 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.056165999999999994
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.972
NEC for r=0.2 class 0.0 = 0.071 +- 0.214 (in-sample avg dev_std = 0.169)
NEC for r=0.2 class 1.0 = 0.0 +- 0.214 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all KL = 0.052 +- 0.214 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all L1 = 0.032 +- 0.141 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06944800000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.936
NEC for r=0.4 class 0.0 = 0.159 +- 0.317 (in-sample avg dev_std = 0.270)
NEC for r=0.4 class 1.0 = 0.004 +- 0.317 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all KL = 0.126 +- 0.317 (in-sample avg dev_std = 0.270)
NEC for r=0.4 all L1 = 0.073 +- 0.205 (in-sample avg dev_std = 0.270)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079006
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.916
NEC for r=0.8 class 0.0 = 0.18 +- 0.360 (in-sample avg dev_std = 0.336)
NEC for r=0.8 class 1.0 = 0.034 +- 0.360 (in-sample avg dev_std = 0.336)
NEC for r=0.8 all KL = 0.178 +- 0.360 (in-sample avg dev_std = 0.336)
NEC for r=0.8 all L1 = 0.099 +- 0.227 (in-sample avg dev_std = 0.336)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.619
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0079212
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.822
NEC for r=0.05 class 0.0 = 0.0 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.394 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.24 +- 0.404 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.199 +- 0.337 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.619
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0087958
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.931
NEC for r=0.1 class 0.0 = 0.013 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.582 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.355 +- 0.463 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.3 +- 0.389 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.619
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094218
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.817
NEC for r=0.2 class 0.0 = 0.288 +- 0.480 (in-sample avg dev_std = 0.195)
NEC for r=0.2 class 1.0 = 0.635 +- 0.480 (in-sample avg dev_std = 0.195)
NEC for r=0.2 all KL = 0.561 +- 0.480 (in-sample avg dev_std = 0.195)
NEC for r=0.2 all L1 = 0.463 +- 0.401 (in-sample avg dev_std = 0.195)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.619
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009572
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.801
NEC for r=0.4 class 0.0 = 0.342 +- 0.468 (in-sample avg dev_std = 0.347)
NEC for r=0.4 class 1.0 = 0.637 +- 0.468 (in-sample avg dev_std = 0.347)
NEC for r=0.4 all KL = 0.615 +- 0.468 (in-sample avg dev_std = 0.347)
NEC for r=0.4 all L1 = 0.491 +- 0.385 (in-sample avg dev_std = 0.347)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.619
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.00968
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.8
NEC for r=0.8 class 0.0 = 0.348 +- 0.467 (in-sample avg dev_std = 0.364)
NEC for r=0.8 class 1.0 = 0.637 +- 0.467 (in-sample avg dev_std = 0.364)
NEC for r=0.8 all KL = 0.62 +- 0.467 (in-sample avg dev_std = 0.364)
NEC for r=0.8 all L1 = 0.494 +- 0.383 (in-sample avg dev_std = 0.364)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.798
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0240774
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.807
NEC for r=0.05 class 0.0 = 0.01 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.04 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.024 +- 0.132 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.025 +- 0.125 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.798
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.033907799999999995
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.814
NEC for r=0.1 class 0.0 = 0.016 +- 0.190 (in-sample avg dev_std = 0.006)
NEC for r=0.1 class 1.0 = 0.064 +- 0.190 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all KL = 0.046 +- 0.190 (in-sample avg dev_std = 0.006)
NEC for r=0.1 all L1 = 0.04 +- 0.163 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.798
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0461622
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.811
NEC for r=0.2 class 0.0 = 0.032 +- 0.244 (in-sample avg dev_std = 0.125)
NEC for r=0.2 class 1.0 = 0.086 +- 0.244 (in-sample avg dev_std = 0.125)
NEC for r=0.2 all KL = 0.074 +- 0.244 (in-sample avg dev_std = 0.125)
NEC for r=0.2 all L1 = 0.059 +- 0.197 (in-sample avg dev_std = 0.125)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.798
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0606546
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.779
NEC for r=0.4 class 0.0 = 0.081 +- 0.311 (in-sample avg dev_std = 0.219)
NEC for r=0.4 class 1.0 = 0.104 +- 0.311 (in-sample avg dev_std = 0.219)
NEC for r=0.4 all KL = 0.126 +- 0.311 (in-sample avg dev_std = 0.219)
NEC for r=0.4 all L1 = 0.093 +- 0.240 (in-sample avg dev_std = 0.219)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.798
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07728800000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.756
NEC for r=0.8 class 0.0 = 0.123 +- 0.378 (in-sample avg dev_std = 0.297)
NEC for r=0.8 class 1.0 = 0.154 +- 0.378 (in-sample avg dev_std = 0.297)
NEC for r=0.8 all KL = 0.217 +- 0.378 (in-sample avg dev_std = 0.297)
NEC for r=0.8 all L1 = 0.138 +- 0.267 (in-sample avg dev_std = 0.297)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 21:46:50 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 09:46:50 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 92 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 92...
[0m[1;37mINFO[0m: [1mCheckpoint 92: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0002
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0002
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0002
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0002
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0002

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.034
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.044
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.069
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.027
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.049
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.769
SUFF_SIMPLE for r=0.05 class 0.0 = 0.648 +- 0.445 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.874 +- 0.445 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.05 all KL = 0.702 +- 0.445 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.05 all L1 = 0.773 +- 0.355 (in-sample avg dev_std = 0.285)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043786
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.772
SUFF_SIMPLE for r=0.1 class 0.0 = 0.627 +- 0.436 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.915 +- 0.436 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.1 all KL = 0.731 +- 0.436 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.1 all L1 = 0.787 +- 0.356 (in-sample avg dev_std = 0.245)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055574
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.805
SUFF_SIMPLE for r=0.2 class 0.0 = 0.617 +- 0.414 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.981 +- 0.414 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.2 all KL = 0.772 +- 0.414 (in-sample avg dev_std = 0.241)
SUFF_SIMPLE for r=0.2 all L1 = 0.819 +- 0.339 (in-sample avg dev_std = 0.241)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06853200000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.813
SUFF_SIMPLE for r=0.4 class 0.0 = 0.617 +- 0.411 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.995 +- 0.411 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.4 all KL = 0.783 +- 0.411 (in-sample avg dev_std = 0.250)
SUFF_SIMPLE for r=0.4 all L1 = 0.826 +- 0.334 (in-sample avg dev_std = 0.250)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07941600000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.936
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.255 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.255 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.926 +- 0.255 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.941 +- 0.211 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086168
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.704
SUFF_SIMPLE for r=0.05 class 0.0 = 0.622 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.362 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.364 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.491 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009078600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.704
SUFF_SIMPLE for r=0.1 class 0.0 = 0.622 +- 0.453 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.362 +- 0.453 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.1 all KL = 0.364 +- 0.453 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.1 all L1 = 0.491 +- 0.395 (in-sample avg dev_std = 0.010)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094518
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.704
SUFF_SIMPLE for r=0.2 class 0.0 = 0.622 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.362 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.364 +- 0.453 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.491 +- 0.395 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096226
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.704
SUFF_SIMPLE for r=0.4 class 0.0 = 0.622 +- 0.453 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.362 +- 0.453 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.4 all KL = 0.364 +- 0.453 (in-sample avg dev_std = 0.012)
SUFF_SIMPLE for r=0.4 all L1 = 0.491 +- 0.395 (in-sample avg dev_std = 0.012)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.782
SUFF_SIMPLE for r=0.8 class 0.0 = 0.758 +- 0.471 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.364 +- 0.471 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.447 +- 0.471 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.56 +- 0.403 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0267322
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.69
SUFF_SIMPLE for r=0.05 class 0.0 = 0.834 +- 0.446 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.665 +- 0.446 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 all KL = 0.647 +- 0.446 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.05 all L1 = 0.75 +- 0.337 (in-sample avg dev_std = 0.371)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035812000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.704
SUFF_SIMPLE for r=0.1 class 0.0 = 0.82 +- 0.434 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.726 +- 0.434 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 all KL = 0.687 +- 0.434 (in-sample avg dev_std = 0.332)
SUFF_SIMPLE for r=0.1 all L1 = 0.774 +- 0.335 (in-sample avg dev_std = 0.332)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048664400000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.719
SUFF_SIMPLE for r=0.2 class 0.0 = 0.828 +- 0.413 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.788 +- 0.413 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.2 all KL = 0.737 +- 0.413 (in-sample avg dev_std = 0.304)
SUFF_SIMPLE for r=0.2 all L1 = 0.808 +- 0.318 (in-sample avg dev_std = 0.304)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.062375
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.737
SUFF_SIMPLE for r=0.4 class 0.0 = 0.837 +- 0.389 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.841 +- 0.389 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.4 all KL = 0.784 +- 0.389 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.4 all L1 = 0.839 +- 0.302 (in-sample avg dev_std = 0.285)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.771
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0787262
len(reference) = 4988
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.796
SUFF_SIMPLE for r=0.8 class 0.0 = 0.965 +- 0.265 (in-sample avg dev_std = 0.028)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.882 +- 0.265 (in-sample avg dev_std = 0.028)
SUFF_SIMPLE for r=0.8 all KL = 0.91 +- 0.265 (in-sample avg dev_std = 0.028)
SUFF_SIMPLE for r=0.8 all L1 = 0.924 +- 0.223 (in-sample avg dev_std = 0.028)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034412
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.008 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.008 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.008 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.003 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043786
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.994
NEC for r=0.1 class 0.0 = 0.017 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.003 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.013 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.009 +- 0.078 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.055574
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.957
NEC for r=0.2 class 0.0 = 0.1 +- 0.244 (in-sample avg dev_std = 0.165)
NEC for r=0.2 class 1.0 = 0.002 +- 0.244 (in-sample avg dev_std = 0.165)
NEC for r=0.2 all KL = 0.071 +- 0.244 (in-sample avg dev_std = 0.165)
NEC for r=0.2 all L1 = 0.046 +- 0.172 (in-sample avg dev_std = 0.165)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06853200000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.917
NEC for r=0.4 class 0.0 = 0.197 +- 0.336 (in-sample avg dev_std = 0.269)
NEC for r=0.4 class 1.0 = 0.002 +- 0.336 (in-sample avg dev_std = 0.269)
NEC for r=0.4 all KL = 0.142 +- 0.336 (in-sample avg dev_std = 0.269)
NEC for r=0.4 all L1 = 0.089 +- 0.230 (in-sample avg dev_std = 0.269)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07941600000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.902
NEC for r=0.8 class 0.0 = 0.2 +- 0.361 (in-sample avg dev_std = 0.286)
NEC for r=0.8 class 1.0 = 0.031 +- 0.361 (in-sample avg dev_std = 0.286)
NEC for r=0.8 all KL = 0.173 +- 0.361 (in-sample avg dev_std = 0.286)
NEC for r=0.8 all L1 = 0.106 +- 0.247 (in-sample avg dev_std = 0.286)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.564
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0086168
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.733
NEC for r=0.05 class 0.0 = 0.0 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.33 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.208 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.166 +- 0.315 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.564
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009078600000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.86
NEC for r=0.1 class 0.0 = 0.006 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.554 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.351 +- 0.456 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.283 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.564
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094518
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.797
NEC for r=0.2 class 0.0 = 0.214 +- 0.473 (in-sample avg dev_std = 0.175)
NEC for r=0.2 class 1.0 = 0.634 +- 0.473 (in-sample avg dev_std = 0.175)
NEC for r=0.2 all KL = 0.541 +- 0.473 (in-sample avg dev_std = 0.175)
NEC for r=0.2 all L1 = 0.426 +- 0.400 (in-sample avg dev_std = 0.175)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.564
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096226
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.776
NEC for r=0.4 class 0.0 = 0.282 +- 0.457 (in-sample avg dev_std = 0.354)
NEC for r=0.4 class 1.0 = 0.635 +- 0.457 (in-sample avg dev_std = 0.354)
NEC for r=0.4 all KL = 0.61 +- 0.457 (in-sample avg dev_std = 0.354)
NEC for r=0.4 all L1 = 0.46 +- 0.383 (in-sample avg dev_std = 0.354)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.564
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096446
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.774
NEC for r=0.8 class 0.0 = 0.288 +- 0.457 (in-sample avg dev_std = 0.372)
NEC for r=0.8 class 1.0 = 0.635 +- 0.457 (in-sample avg dev_std = 0.372)
NEC for r=0.8 all KL = 0.615 +- 0.457 (in-sample avg dev_std = 0.372)
NEC for r=0.8 all L1 = 0.463 +- 0.381 (in-sample avg dev_std = 0.372)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.771
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0267322
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.776
NEC for r=0.05 class 0.0 = 0.015 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.051 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.032 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.033 +- 0.137 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.771
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.035812000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.789
NEC for r=0.1 class 0.0 = 0.022 +- 0.210 (in-sample avg dev_std = 0.014)
NEC for r=0.1 class 1.0 = 0.084 +- 0.210 (in-sample avg dev_std = 0.014)
NEC for r=0.1 all KL = 0.058 +- 0.210 (in-sample avg dev_std = 0.014)
NEC for r=0.1 all L1 = 0.052 +- 0.182 (in-sample avg dev_std = 0.014)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.771
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.048664400000000003
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.785
NEC for r=0.2 class 0.0 = 0.042 +- 0.270 (in-sample avg dev_std = 0.156)
NEC for r=0.2 class 1.0 = 0.11 +- 0.270 (in-sample avg dev_std = 0.156)
NEC for r=0.2 all KL = 0.095 +- 0.270 (in-sample avg dev_std = 0.156)
NEC for r=0.2 all L1 = 0.076 +- 0.216 (in-sample avg dev_std = 0.156)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.771
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.062375
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.759
NEC for r=0.4 class 0.0 = 0.091 +- 0.326 (in-sample avg dev_std = 0.239)
NEC for r=0.4 class 1.0 = 0.125 +- 0.326 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all KL = 0.145 +- 0.326 (in-sample avg dev_std = 0.239)
NEC for r=0.4 all L1 = 0.108 +- 0.250 (in-sample avg dev_std = 0.239)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.771
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0787262
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.714
NEC for r=0.8 class 0.0 = 0.127 +- 0.388 (in-sample avg dev_std = 0.306)
NEC for r=0.8 class 1.0 = 0.205 +- 0.388 (in-sample avg dev_std = 0.306)
NEC for r=0.8 all KL = 0.238 +- 0.388 (in-sample avg dev_std = 0.306)
NEC for r=0.8 all L1 = 0.166 +- 0.292 (in-sample avg dev_std = 0.306)
model_dirname= repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 22:03:15 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:03:15 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 63 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 63...
[0m[1;37mINFO[0m: [1mCheckpoint 63: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0001
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0001
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0001
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0001
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0001

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.041
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.007
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.008
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.008
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.007
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.020
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.027
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.035
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.048
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.067


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03554
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.789
SUFF_SIMPLE for r=0.05 class 0.0 = 0.591 +- 0.413 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.993 +- 0.413 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.05 all KL = 0.777 +- 0.413 (in-sample avg dev_std = 0.151)
SUFF_SIMPLE for r=0.05 all L1 = 0.813 +- 0.351 (in-sample avg dev_std = 0.151)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04098
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.794
SUFF_SIMPLE for r=0.1 class 0.0 = 0.593 +- 0.410 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.999 +- 0.410 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 all KL = 0.784 +- 0.410 (in-sample avg dev_std = 0.154)
SUFF_SIMPLE for r=0.1 all L1 = 0.818 +- 0.349 (in-sample avg dev_std = 0.154)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047308
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.791
SUFF_SIMPLE for r=0.2 class 0.0 = 0.592 +- 0.413 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.995 +- 0.413 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.2 all KL = 0.781 +- 0.413 (in-sample avg dev_std = 0.149)
SUFF_SIMPLE for r=0.2 all L1 = 0.815 +- 0.351 (in-sample avg dev_std = 0.149)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.065416
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.794
SUFF_SIMPLE for r=0.4 class 0.0 = 0.596 +- 0.412 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.993 +- 0.412 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all KL = 0.777 +- 0.412 (in-sample avg dev_std = 0.166)
SUFF_SIMPLE for r=0.4 all L1 = 0.816 +- 0.348 (in-sample avg dev_std = 0.166)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07919200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.94
SUFF_SIMPLE for r=0.8 class 0.0 = 0.873 +- 0.255 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.255 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.927 +- 0.255 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.943 +- 0.205 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0074828
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.558 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.78 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0081988
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.558 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.78 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0085554
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.558 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.745 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.78 +- 0.376 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0083572
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.745
SUFF_SIMPLE for r=0.4 class 0.0 = 0.558 +- 0.436 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.996 +- 0.436 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.436 (in-sample avg dev_std = 0.024)
SUFF_SIMPLE for r=0.4 all L1 = 0.779 +- 0.377 (in-sample avg dev_std = 0.024)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0065260000000000006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.926
SUFF_SIMPLE for r=0.8 class 0.0 = 0.913 +- 0.270 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.952 +- 0.270 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.918 +- 0.270 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.933 +- 0.227 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.019841
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.877
SUFF_SIMPLE for r=0.05 class 0.0 = 0.837 +- 0.321 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.975 +- 0.321 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.05 all KL = 0.866 +- 0.321 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.05 all L1 = 0.905 +- 0.251 (in-sample avg dev_std = 0.183)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0268306
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.877
SUFF_SIMPLE for r=0.1 class 0.0 = 0.839 +- 0.325 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.97 +- 0.325 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.1 all KL = 0.861 +- 0.325 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.1 all L1 = 0.904 +- 0.250 (in-sample avg dev_std = 0.201)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0347138
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.874
SUFF_SIMPLE for r=0.2 class 0.0 = 0.869 +- 0.348 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.919 +- 0.348 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 all KL = 0.831 +- 0.348 (in-sample avg dev_std = 0.273)
SUFF_SIMPLE for r=0.2 all L1 = 0.894 +- 0.249 (in-sample avg dev_std = 0.273)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0477758
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.771
SUFF_SIMPLE for r=0.4 class 0.0 = 0.908 +- 0.428 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.693 +- 0.428 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.4 all KL = 0.724 +- 0.428 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.4 all L1 = 0.802 +- 0.333 (in-sample avg dev_std = 0.320)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06650260000000001
len(reference) = 4977
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.668
SUFF_SIMPLE for r=0.8 class 0.0 = 0.968 +- 0.461 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.488 +- 0.461 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.688 +- 0.461 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.731 +- 0.398 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03554
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  1.0
NEC for r=0.05 class 0.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.0 +- 0.001 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.0 +- 0.000 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.04098
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.984
NEC for r=0.1 class 0.0 = 0.032 +- 0.132 (in-sample avg dev_std = 0.028)
NEC for r=0.1 class 1.0 = 0.0 +- 0.132 (in-sample avg dev_std = 0.028)
NEC for r=0.1 all KL = 0.019 +- 0.132 (in-sample avg dev_std = 0.028)
NEC for r=0.1 all L1 = 0.014 +- 0.106 (in-sample avg dev_std = 0.028)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.047308
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.94
NEC for r=0.2 class 0.0 = 0.149 +- 0.295 (in-sample avg dev_std = 0.226)
NEC for r=0.2 class 1.0 = 0.0 +- 0.295 (in-sample avg dev_std = 0.226)
NEC for r=0.2 all KL = 0.105 +- 0.295 (in-sample avg dev_std = 0.226)
NEC for r=0.2 all L1 = 0.067 +- 0.203 (in-sample avg dev_std = 0.226)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.065416
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.904
NEC for r=0.4 class 0.0 = 0.23 +- 0.362 (in-sample avg dev_std = 0.295)
NEC for r=0.4 class 1.0 = 0.001 +- 0.362 (in-sample avg dev_std = 0.295)
NEC for r=0.4 all KL = 0.173 +- 0.362 (in-sample avg dev_std = 0.295)
NEC for r=0.4 all L1 = 0.103 +- 0.243 (in-sample avg dev_std = 0.295)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07919200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.89
NEC for r=0.8 class 0.0 = 0.265 +- 0.382 (in-sample avg dev_std = 0.337)
NEC for r=0.8 class 1.0 = 0.005 +- 0.382 (in-sample avg dev_std = 0.337)
NEC for r=0.8 all KL = 0.195 +- 0.382 (in-sample avg dev_std = 0.337)
NEC for r=0.8 all L1 = 0.121 +- 0.261 (in-sample avg dev_std = 0.337)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.999
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0074828
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.987
NEC for r=0.05 class 0.0 = 0.023 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.002 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.015 +- 0.118 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.013 +- 0.100 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.999
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0081988
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.913
NEC for r=0.1 class 0.0 = 0.155 +- 0.288 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.002 +- 0.288 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.094 +- 0.288 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.078 +- 0.244 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.999
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0085554
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.754
NEC for r=0.2 class 0.0 = 0.432 +- 0.433 (in-sample avg dev_std = 0.095)
NEC for r=0.2 class 1.0 = 0.002 +- 0.433 (in-sample avg dev_std = 0.095)
NEC for r=0.2 all KL = 0.251 +- 0.433 (in-sample avg dev_std = 0.095)
NEC for r=0.2 all L1 = 0.215 +- 0.372 (in-sample avg dev_std = 0.095)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.999
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0083572
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.754
NEC for r=0.4 class 0.0 = 0.437 +- 0.435 (in-sample avg dev_std = 0.151)
NEC for r=0.4 class 1.0 = 0.002 +- 0.435 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all KL = 0.255 +- 0.435 (in-sample avg dev_std = 0.151)
NEC for r=0.4 all L1 = 0.218 +- 0.372 (in-sample avg dev_std = 0.151)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.999
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0065260000000000006
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.75
NEC for r=0.8 class 0.0 = 0.44 +- 0.435 (in-sample avg dev_std = 0.116)
NEC for r=0.8 class 1.0 = 0.002 +- 0.435 (in-sample avg dev_std = 0.116)
NEC for r=0.8 all KL = 0.255 +- 0.435 (in-sample avg dev_std = 0.116)
NEC for r=0.8 all L1 = 0.219 +- 0.374 (in-sample avg dev_std = 0.116)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.975
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.019841
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.971
NEC for r=0.05 class 0.0 = 0.011 +- 0.074 (in-sample avg dev_std = 0.027)
NEC for r=0.05 class 1.0 = 0.0 +- 0.074 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all KL = 0.007 +- 0.074 (in-sample avg dev_std = 0.027)
NEC for r=0.05 all L1 = 0.006 +- 0.061 (in-sample avg dev_std = 0.027)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.975
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0268306
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.967
NEC for r=0.1 class 0.0 = 0.02 +- 0.104 (in-sample avg dev_std = 0.049)
NEC for r=0.1 class 1.0 = 0.0 +- 0.104 (in-sample avg dev_std = 0.049)
NEC for r=0.1 all KL = 0.013 +- 0.104 (in-sample avg dev_std = 0.049)
NEC for r=0.1 all L1 = 0.01 +- 0.081 (in-sample avg dev_std = 0.049)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.975
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0347138
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.953
NEC for r=0.2 class 0.0 = 0.043 +- 0.162 (in-sample avg dev_std = 0.074)
NEC for r=0.2 class 1.0 = 0.0 +- 0.162 (in-sample avg dev_std = 0.074)
NEC for r=0.2 all KL = 0.031 +- 0.162 (in-sample avg dev_std = 0.074)
NEC for r=0.2 all L1 = 0.022 +- 0.126 (in-sample avg dev_std = 0.074)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.975
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0477758
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.92
NEC for r=0.4 class 0.0 = 0.102 +- 0.244 (in-sample avg dev_std = 0.119)
NEC for r=0.4 class 1.0 = 0.0 +- 0.244 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all KL = 0.067 +- 0.244 (in-sample avg dev_std = 0.119)
NEC for r=0.4 all L1 = 0.052 +- 0.196 (in-sample avg dev_std = 0.119)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.975
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.06650260000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.911
NEC for r=0.8 class 0.0 = 0.115 +- 0.256 (in-sample avg dev_std = 0.105)
NEC for r=0.8 class 1.0 = 0.002 +- 0.256 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all KL = 0.074 +- 0.256 (in-sample avg dev_std = 0.105)
NEC for r=0.8 all L1 = 0.059 +- 0.211 (in-sample avg dev_std = 0.105)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.667, 0.679, 0.711, 0.748, 0.854], 'all_L1': [0.735, 0.745, 0.771, 0.795, 0.88]}), defaultdict(<class 'list'>, {'all_KL': [0.77, 0.771, 0.777, 0.785, 0.867], 'all_L1': [0.81, 0.809, 0.813, 0.817, 0.889]}), defaultdict(<class 'list'>, {'all_KL': [0.759, 0.779, 0.781, 0.781, 0.885], 'all_L1': [0.806, 0.817, 0.817, 0.816, 0.905]}), defaultdict(<class 'list'>, {'all_KL': [0.715, 0.767, 0.786, 0.794, 0.85], 'all_L1': [0.774, 0.807, 0.817, 0.822, 0.872]}), defaultdict(<class 'list'>, {'all_KL': [0.753, 0.775, 0.784, 0.786, 0.892], 'all_L1': [0.802, 0.812, 0.816, 0.817, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.549, 0.572, 0.611, 0.653, 0.792], 'all_L1': [0.663, 0.677, 0.699, 0.722, 0.83]}), defaultdict(<class 'list'>, {'all_KL': [0.555, 0.589, 0.633, 0.644, 0.756], 'all_L1': [0.652, 0.686, 0.709, 0.708, 0.804]}), defaultdict(<class 'list'>, {'all_KL': [0.726, 0.756, 0.777, 0.786, 0.931], 'all_L1': [0.799, 0.812, 0.82, 0.831, 0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.702, 0.731, 0.772, 0.783, 0.926], 'all_L1': [0.773, 0.787, 0.819, 0.826, 0.941]}), defaultdict(<class 'list'>, {'all_KL': [0.777, 0.784, 0.781, 0.777, 0.927], 'all_L1': [0.813, 0.818, 0.815, 0.816, 0.943]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.014, 0.049, 0.142, 0.203, 0.248], 'all_L1': [0.013, 0.039, 0.104, 0.147, 0.173]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.03, 0.095, 0.18, 0.208], 'all_L1': [0.009, 0.025, 0.065, 0.117, 0.13]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.025, 0.091, 0.181, 0.207], 'all_L1': [0.004, 0.02, 0.059, 0.115, 0.127]}), defaultdict(<class 'list'>, {'all_KL': [0.031, 0.078, 0.16, 0.206, 0.223], 'all_L1': [0.024, 0.066, 0.12, 0.15, 0.158]}), defaultdict(<class 'list'>, {'all_KL': [0.003, 0.034, 0.127, 0.186, 0.203], 'all_L1': [0.002, 0.027, 0.088, 0.126, 0.135]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.077, 0.181, 0.268, 0.299], 'all_L1': [0.027, 0.06, 0.129, 0.185, 0.196]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.099, 0.22, 0.281, 0.33], 'all_L1': [0.026, 0.076, 0.16, 0.198, 0.22]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.006, 0.052, 0.126, 0.178], 'all_L1': [0.0, 0.005, 0.032, 0.073, 0.099]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.013, 0.071, 0.142, 0.173], 'all_L1': [0.0, 0.009, 0.046, 0.089, 0.106]}), defaultdict(<class 'list'>, {'all_KL': [0.0, 0.019, 0.105, 0.173, 0.195], 'all_L1': [0.0, 0.014, 0.067, 0.103, 0.121]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.761, 0.761, 0.761, 0.761, 0.777], 'all_L1': [0.8, 0.8, 0.8, 0.8, 0.811]}), defaultdict(<class 'list'>, {'all_KL': [0.744, 0.744, 0.744, 0.744, 0.747], 'all_L1': [0.779, 0.779, 0.779, 0.779, 0.782]}), defaultdict(<class 'list'>, {'all_KL': [0.741, 0.741, 0.741, 0.741, 0.745], 'all_L1': [0.776, 0.776, 0.776, 0.776, 0.779]}), defaultdict(<class 'list'>, {'all_KL': [0.747, 0.747, 0.747, 0.747, 0.749], 'all_L1': [0.793, 0.793, 0.793, 0.793, 0.794]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.429, 0.429, 0.429, 0.434], 'all_L1': [0.5, 0.5, 0.5, 0.5, 0.504]}), defaultdict(<class 'list'>, {'all_KL': [0.501, 0.501, 0.501, 0.501, 0.594], 'all_L1': [0.55, 0.55, 0.55, 0.55, 0.649]}), defaultdict(<class 'list'>, {'all_KL': [0.263, 0.263, 0.263, 0.263, 0.449], 'all_L1': [0.353, 0.353, 0.353, 0.353, 0.535]}), defaultdict(<class 'list'>, {'all_KL': [0.37, 0.37, 0.37, 0.37, 0.433], 'all_L1': [0.467, 0.467, 0.467, 0.467, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.364, 0.364, 0.364, 0.447], 'all_L1': [0.491, 0.491, 0.491, 0.491, 0.56]}), defaultdict(<class 'list'>, {'all_KL': [0.745, 0.745, 0.745, 0.744, 0.918], 'all_L1': [0.78, 0.78, 0.78, 0.779, 0.933]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.031, 0.127, 0.22, 0.227, 0.227], 'all_L1': [0.035, 0.111, 0.187, 0.191, 0.191]}), defaultdict(<class 'list'>, {'all_KL': [0.022, 0.128, 0.254, 0.256, 0.256], 'all_L1': [0.018, 0.108, 0.218, 0.22, 0.22]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.15, 0.258, 0.259, 0.259], 'all_L1': [0.024, 0.127, 0.223, 0.223, 0.223]}), defaultdict(<class 'list'>, {'all_KL': [0.097, 0.213, 0.253, 0.253, 0.253], 'all_L1': [0.074, 0.171, 0.207, 0.207, 0.207]}), defaultdict(<class 'list'>, {'all_KL': [0.278, 0.384, 0.565, 0.57, 0.571], 'all_L1': [0.242, 0.335, 0.492, 0.496, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.12, 0.265, 0.392, 0.433, 0.437], 'all_L1': [0.118, 0.226, 0.339, 0.358, 0.359]}), defaultdict(<class 'list'>, {'all_KL': [0.123, 0.252, 0.541, 0.622, 0.631], 'all_L1': [0.104, 0.205, 0.443, 0.487, 0.488]}), defaultdict(<class 'list'>, {'all_KL': [0.24, 0.355, 0.561, 0.615, 0.62], 'all_L1': [0.199, 0.3, 0.463, 0.491, 0.494]}), defaultdict(<class 'list'>, {'all_KL': [0.208, 0.351, 0.541, 0.61, 0.615], 'all_L1': [0.166, 0.283, 0.426, 0.46, 0.463]}), defaultdict(<class 'list'>, {'all_KL': [0.015, 0.094, 0.251, 0.255, 0.255], 'all_L1': [0.013, 0.078, 0.215, 0.218, 0.219]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.616, 0.649, 0.683, 0.726, 0.863], 'all_L1': [0.661, 0.688, 0.715, 0.747, 0.847]}), defaultdict(<class 'list'>, {'all_KL': [0.775, 0.782, 0.788, 0.799, 0.91], 'all_L1': [0.838, 0.842, 0.843, 0.846, 0.922]}), defaultdict(<class 'list'>, {'all_KL': [0.801, 0.813, 0.823, 0.843, 0.948], 'all_L1': [0.851, 0.856, 0.86, 0.869, 0.948]}), defaultdict(<class 'list'>, {'all_KL': [0.74, 0.79, 0.824, 0.852, 0.967], 'all_L1': [0.842, 0.864, 0.883, 0.898, 0.973]}), defaultdict(<class 'list'>, {'all_KL': [0.736, 0.754, 0.768, 0.786, 0.904], 'all_L1': [0.819, 0.826, 0.83, 0.837, 0.915]}), defaultdict(<class 'list'>, {'all_KL': [0.572, 0.588, 0.612, 0.661, 0.849], 'all_L1': [0.643, 0.655, 0.673, 0.707, 0.854]}), defaultdict(<class 'list'>, {'all_KL': [0.499, 0.52, 0.553, 0.618, 0.847], 'all_L1': [0.639, 0.654, 0.675, 0.717, 0.873]}), defaultdict(<class 'list'>, {'all_KL': [0.673, 0.709, 0.746, 0.785, 0.912], 'all_L1': [0.789, 0.802, 0.82, 0.838, 0.926]}), defaultdict(<class 'list'>, {'all_KL': [0.647, 0.687, 0.737, 0.784, 0.91], 'all_L1': [0.75, 0.774, 0.808, 0.839, 0.924]}), defaultdict(<class 'list'>, {'all_KL': [0.866, 0.861, 0.831, 0.724, 0.688], 'all_L1': [0.905, 0.904, 0.894, 0.802, 0.731]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.055, 0.094, 0.129, 0.183, 0.266], 'all_L1': [0.084, 0.12, 0.144, 0.184, 0.245]}), defaultdict(<class 'list'>, {'all_KL': [0.034, 0.056, 0.082, 0.13, 0.162], 'all_L1': [0.038, 0.053, 0.069, 0.1, 0.115]}), defaultdict(<class 'list'>, {'all_KL': [0.019, 0.031, 0.055, 0.093, 0.131], 'all_L1': [0.021, 0.033, 0.051, 0.079, 0.101]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.018, 0.038, 0.078, 0.141], 'all_L1': [0.009, 0.015, 0.029, 0.057, 0.092]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.046, 0.08, 0.122, 0.165], 'all_L1': [0.03, 0.047, 0.07, 0.098, 0.118]}), defaultdict(<class 'list'>, {'all_KL': [0.052, 0.093, 0.148, 0.223, 0.304], 'all_L1': [0.071, 0.103, 0.143, 0.198, 0.256]}), defaultdict(<class 'list'>, {'all_KL': [0.049, 0.089, 0.154, 0.247, 0.367], 'all_L1': [0.056, 0.085, 0.126, 0.185, 0.261]}), defaultdict(<class 'list'>, {'all_KL': [0.024, 0.046, 0.074, 0.126, 0.217], 'all_L1': [0.025, 0.04, 0.059, 0.093, 0.138]}), defaultdict(<class 'list'>, {'all_KL': [0.032, 0.058, 0.095, 0.145, 0.238], 'all_L1': [0.033, 0.052, 0.076, 0.108, 0.166]}), defaultdict(<class 'list'>, {'all_KL': [0.007, 0.013, 0.031, 0.067, 0.074], 'all_L1': [0.006, 0.01, 0.022, 0.052, 0.059]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.763 +- 0.057, 0.777 +- 0.052, 0.790 +- 0.045, 0.797 +- 0.042, 0.892 +- 0.045
suff_simple class all_KL  =  0.697 +- 0.079, 0.720 +- 0.076, 0.741 +- 0.063, 0.754 +- 0.054, 0.868 +- 0.055
[[0.7192500233650208, 0.7304999828338623, 0.7630000114440918, 0.7885000109672546, 0.8759999871253967], [0.7910000085830688, 0.7907500267028809, 0.7914999723434448, 0.7929999828338623, 0.8740000128746033], [0.7912499904632568, 0.7994999885559082, 0.7960000038146973, 0.7944999933242798, 0.8939999938011169], [0.7634999752044678, 0.7885000109672546, 0.7919999957084656, 0.7954999804496765, 0.8539999723434448], [0.7827500104904175, 0.7919999957084656, 0.7922499775886536, 0.7925000190734863, 0.8980000019073486], [0.6600000262260437, 0.6725000143051147, 0.6915000081062317, 0.7089999914169312, 0.8240000009536743], [0.6365000009536743, 0.6757500171661377, 0.6974999904632568, 0.6894999742507935, 0.8019999861717224], [0.8004999756813049, 0.8044999837875366, 0.8054999709129333, 0.8205000162124634, 0.9380000233650208], [0.7689999938011169, 0.7720000147819519, 0.8050000071525574, 0.8132500052452087, 0.9359999895095825], [0.7892500162124634, 0.7942500114440918, 0.7910000085830688, 0.7944999933242798, 0.9399999976158142]]
[[0.667, 0.679, 0.711, 0.748, 0.854], [0.77, 0.771, 0.777, 0.785, 0.867], [0.759, 0.779, 0.781, 0.781, 0.885], [0.715, 0.767, 0.786, 0.794, 0.85], [0.753, 0.775, 0.784, 0.786, 0.892], [0.549, 0.572, 0.611, 0.653, 0.792], [0.555, 0.589, 0.633, 0.644, 0.756], [0.726, 0.756, 0.777, 0.786, 0.931], [0.702, 0.731, 0.772, 0.783, 0.926], [0.777, 0.784, 0.781, 0.777, 0.927]]
suff_simple_acc_int  =  0.750 +- 0.056, 0.762 +- 0.048, 0.773 +- 0.041, 0.779 +- 0.041, 0.884 +- 0.045
nec class all_L1  =  0.010 +- 0.011, 0.034 +- 0.024, 0.087 +- 0.039, 0.130 +- 0.038, 0.147 +- 0.037
nec class all_KL  =  0.012 +- 0.012, 0.043 +- 0.030, 0.124 +- 0.049, 0.195 +- 0.046, 0.226 +- 0.049
[[0.9940000176429749, 0.9700000286102295, 0.9042500257492065, 0.862500011920929, 0.8445000052452087], [0.9919999837875366, 0.9725000262260437, 0.9355000257492065, 0.890999972820282, 0.8809999823570251], [0.9959999918937683, 0.9779999852180481, 0.9440000057220459, 0.8942499756813049, 0.8867499828338623], [0.9760000109672546, 0.9242500066757202, 0.8755000233650208, 0.8489999771118164, 0.8479999899864197], [0.9980000257492065, 0.9710000157356262, 0.9139999747276306, 0.8777499794960022, 0.871999979019165], [0.9900000095367432, 0.9539999961853027, 0.8927500247955322, 0.8374999761581421, 0.8374999761581421], [0.9819999933242798, 0.9382500052452087, 0.8542500138282776, 0.8174999952316284, 0.8012499809265137], [1.0, 0.9940000176429749, 0.971750020980835, 0.9355000257492065, 0.9160000085830688], [1.0, 0.9940000176429749, 0.9570000171661377, 0.9172499775886536, 0.9017500281333923], [1.0, 0.984499990940094, 0.9397500157356262, 0.9042500257492065, 0.8895000219345093]]
[[0.014, 0.049, 0.142, 0.203, 0.248], [0.012, 0.03, 0.095, 0.18, 0.208], [0.005, 0.025, 0.091, 0.181, 0.207], [0.031, 0.078, 0.16, 0.206, 0.223], [0.003, 0.034, 0.127, 0.186, 0.203], [0.028, 0.077, 0.181, 0.268, 0.299], [0.028, 0.099, 0.22, 0.281, 0.33], [0.0, 0.006, 0.052, 0.126, 0.178], [0.0, 0.013, 0.071, 0.142, 0.173], [0.0, 0.019, 0.105, 0.173, 0.195]]
nec_acc_int  =  0.993 +- 0.008, 0.968 +- 0.022, 0.919 +- 0.035, 0.879 +- 0.035, 0.868 +- 0.033

Eval split val
suff_simple class all_L1  =  0.629 +- 0.164, 0.629 +- 0.164, 0.629 +- 0.164, 0.629 +- 0.163, 0.687 +- 0.144
suff_simple class all_KL  =  0.567 +- 0.190, 0.567 +- 0.190, 0.567 +- 0.190, 0.566 +- 0.189, 0.629 +- 0.170
[[0.6738749742507935, 0.6738250255584717, 0.6739749908447266, 0.6740249991416931, 0.6787999868392944], [0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7494000196456909], [0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7504000067710876], [0.7268000245094299, 0.7268000245094299, 0.7268000245094299, 0.7268000245094299, 0.7282000184059143], [0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7512000203132629], [0.5041249990463257, 0.5041000247001648, 0.5041499733924866, 0.5040500164031982, 0.6291999816894531], [0.5048750042915344, 0.5047749876976013, 0.5053250193595886, 0.5050749778747559, 0.717199981212616], [0.732200026512146, 0.732200026512146, 0.732200026512146, 0.732200026512146, 0.7943999767303467], [0.7035999894142151, 0.7036250233650208, 0.7035999894142151, 0.7036499977111816, 0.7815999984741211], [0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7451750040054321, 0.9259999990463257]]
[[0.761, 0.761, 0.761, 0.761, 0.777], [0.744, 0.744, 0.744, 0.744, 0.747], [0.741, 0.741, 0.741, 0.741, 0.745], [0.747, 0.747, 0.747, 0.747, 0.749], [0.429, 0.429, 0.429, 0.429, 0.434], [0.501, 0.501, 0.501, 0.501, 0.594], [0.263, 0.263, 0.263, 0.263, 0.449], [0.37, 0.37, 0.37, 0.37, 0.433], [0.364, 0.364, 0.364, 0.364, 0.447], [0.745, 0.745, 0.745, 0.744, 0.918]]
suff_simple_acc_int  =  0.683 +- 0.092, 0.683 +- 0.092, 0.683 +- 0.092, 0.683 +- 0.092, 0.751 +- 0.074
nec class all_L1  =  0.099 +- 0.077, 0.194 +- 0.085, 0.321 +- 0.117, 0.335 +- 0.129, 0.336 +- 0.130
nec class all_KL  =  0.116 +- 0.092, 0.232 +- 0.101, 0.384 +- 0.144, 0.410 +- 0.168, 0.412 +- 0.170
[[0.8309999704360962, 0.7572000026702881, 0.6811249852180481, 0.6781499981880188, 0.6778249740600586], [0.9819999933242798, 0.8790000081062317, 0.7504249811172485, 0.7504749894142151, 0.7500500082969666], [0.9789999723434448, 0.8619999885559082, 0.749750018119812, 0.7491000294685364, 0.7492750287055969], [0.8784000277519226, 0.7699999809265137, 0.7268750071525574, 0.7270500063896179, 0.727150022983551], [0.9502000212669373, 0.9380000233650208, 0.7591000199317932, 0.7565000057220459, 0.7553250193595886], [0.892799973487854, 0.781000018119812, 0.6420000195503235, 0.6312749981880188, 0.6309249997138977], [0.829200029373169, 0.8597999811172485, 0.7374500036239624, 0.7094249725341797, 0.7136250138282776], [0.8220000267028809, 0.9305999875068665, 0.8166249990463257, 0.800724983215332, 0.7998999953269958], [0.7329999804496765, 0.8597999811172485, 0.796500027179718, 0.7761499881744385, 0.7742000222206116], [0.9869999885559082, 0.9133999943733215, 0.7543749809265137, 0.7535499930381775, 0.7501999735832214]]
[[0.031, 0.127, 0.22, 0.227, 0.227], [0.022, 0.128, 0.254, 0.256, 0.256], [0.029, 0.15, 0.258, 0.259, 0.259], [0.097, 0.213, 0.253, 0.253, 0.253], [0.278, 0.384, 0.565, 0.57, 0.571], [0.12, 0.265, 0.392, 0.433, 0.437], [0.123, 0.252, 0.541, 0.622, 0.631], [0.24, 0.355, 0.561, 0.615, 0.62], [0.208, 0.351, 0.541, 0.61, 0.615], [0.015, 0.094, 0.251, 0.255, 0.255]]
nec_acc_int  =  0.888 +- 0.081, 0.855 +- 0.062, 0.741 +- 0.048, 0.733 +- 0.047, 0.733 +- 0.046

Eval split test
suff_simple class all_L1  =  0.774 +- 0.091, 0.786 +- 0.086, 0.800 +- 0.078, 0.810 +- 0.062, 0.891 +- 0.066
suff_simple class all_KL  =  0.693 +- 0.106, 0.715 +- 0.101, 0.737 +- 0.089, 0.758 +- 0.071, 0.880 +- 0.074
[[0.7123523950576782, 0.7395937442779541, 0.7568541169166565, 0.7768661379814148, 0.8435870409011841], [0.8310486078262329, 0.8333500027656555, 0.8336251974105835, 0.8361517190933228, 0.9130849838256836], [0.8500099778175354, 0.8504102230072021, 0.8516860008239746, 0.8579897880554199, 0.9383155703544617], [0.8533369898796082, 0.8587152361869812, 0.863568127155304, 0.8697468638420105, 0.9464572668075562], [0.7809686064720154, 0.7812187075614929, 0.7805933356285095, 0.7827696800231934, 0.8639557957649231], [0.630378246307373, 0.6379827857017517, 0.6479637622833252, 0.6668751239776611, 0.7114206552505493], [0.5901790857315063, 0.6032619476318359, 0.6085651516914368, 0.6282019019126892, 0.6908963322639465], [0.7417950630187988, 0.7515759468078613, 0.7529767751693726, 0.7598559260368347, 0.8330909013748169], [0.6902891993522644, 0.7041724920272827, 0.7192065119743347, 0.737417459487915, 0.7958099246025085], [0.8765759468078613, 0.8771012425422668, 0.873874306678772, 0.7710626125335693, 0.667671263217926]]
[[0.616, 0.649, 0.683, 0.726, 0.863], [0.775, 0.782, 0.788, 0.799, 0.91], [0.801, 0.813, 0.823, 0.843, 0.948], [0.74, 0.79, 0.824, 0.852, 0.967], [0.736, 0.754, 0.768, 0.786, 0.904], [0.572, 0.588, 0.612, 0.661, 0.849], [0.499, 0.52, 0.553, 0.618, 0.847], [0.673, 0.709, 0.746, 0.785, 0.912], [0.647, 0.687, 0.737, 0.784, 0.91], [0.866, 0.861, 0.831, 0.724, 0.688]]
suff_simple_acc_int  =  0.756 +- 0.094, 0.764 +- 0.090, 0.769 +- 0.086, 0.769 +- 0.074, 0.820 +- 0.097
nec class all_L1  =  0.037 +- 0.024, 0.056 +- 0.034, 0.079 +- 0.042, 0.115 +- 0.051, 0.155 +- 0.070
nec class all_KL  =  0.031 +- 0.016, 0.054 +- 0.028, 0.089 +- 0.041, 0.141 +- 0.057, 0.206 +- 0.084
[[0.8371022343635559, 0.8430558443069458, 0.8307734727859497, 0.7978537082672119, 0.7561286687850952], [0.90714430809021, 0.9112717509269714, 0.8967380523681641, 0.863092839717865, 0.8507104516029358], [0.9633780121803284, 0.9540724158287048, 0.9393386244773865, 0.9100460410118103, 0.8951120376586914], [0.9645787477493286, 0.9601510763168335, 0.9450420141220093, 0.914723813533783, 0.8980388045310974], [0.8351010680198669, 0.8439563512802124, 0.8326495885848999, 0.8015308976173401, 0.7885481119155884], [0.6688013076782227, 0.6816840171813965, 0.6924654841423035, 0.6633730530738831, 0.6367320418357849], [0.6657994985580444, 0.6753302216529846, 0.6783069968223572, 0.647888720035553, 0.6099159717559814], [0.80748450756073, 0.8142885565757751, 0.8109865784645081, 0.7793425917625427, 0.7562287449836731], [0.7758654952049255, 0.7890233993530273, 0.7853962182998657, 0.7591054439544678, 0.7141785025596619], [0.9705823659896851, 0.966805100440979, 0.9532219171524048, 0.9199519753456116, 0.9112467765808105]]
[[0.055, 0.094, 0.129, 0.183, 0.266], [0.034, 0.056, 0.082, 0.13, 0.162], [0.019, 0.031, 0.055, 0.093, 0.131], [0.01, 0.018, 0.038, 0.078, 0.141], [0.025, 0.046, 0.08, 0.122, 0.165], [0.052, 0.093, 0.148, 0.223, 0.304], [0.049, 0.089, 0.154, 0.247, 0.367], [0.024, 0.046, 0.074, 0.126, 0.217], [0.032, 0.058, 0.095, 0.145, 0.238], [0.007, 0.013, 0.031, 0.067, 0.074]]
nec_acc_int  =  0.840 +- 0.108, 0.844 +- 0.102, 0.836 +- 0.094, 0.806 +- 0.093, 0.782 +- 0.102


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.387 +- 0.024, 0.406 +- 0.019, 0.438 +- 0.014, 0.464 +- 0.010, 0.519 +- 0.007
Faith. Armon (L1)= 		  =  0.020 +- 0.021, 0.064 +- 0.043, 0.153 +- 0.060, 0.221 +- 0.053, 0.249 +- 0.052
Faith. GMean (L1)= 	  =  0.068 +- 0.054, 0.150 +- 0.055, 0.254 +- 0.053, 0.318 +- 0.039, 0.357 +- 0.036
Faith. Aritm (KL)= 		  =  0.355 +- 0.036, 0.382 +- 0.029, 0.433 +- 0.020, 0.474 +- 0.013, 0.547 +- 0.007
Faith. Armon (KL)= 		  =  0.023 +- 0.023, 0.078 +- 0.051, 0.207 +- 0.068, 0.305 +- 0.051, 0.355 +- 0.053
Faith. GMean (KL)= 	  =  0.070 +- 0.054, 0.162 +- 0.056, 0.295 +- 0.051, 0.379 +- 0.033, 0.439 +- 0.031

Eval split val
Faith. Aritm (L1)= 		  =  0.364 +- 0.057, 0.412 +- 0.054, 0.475 +- 0.032, 0.482 +- 0.025, 0.512 +- 0.022
Faith. Armon (L1)= 		  =  0.152 +- 0.103, 0.273 +- 0.083, 0.389 +- 0.064, 0.396 +- 0.068, 0.417 +- 0.082
Faith. GMean (L1)= 	  =  0.215 +- 0.080, 0.329 +- 0.051, 0.428 +- 0.033, 0.435 +- 0.035, 0.459 +- 0.046
Faith. Aritm (KL)= 		  =  0.341 +- 0.065, 0.399 +- 0.060, 0.475 +- 0.031, 0.488 +- 0.018, 0.521 +- 0.026
Faith. Armon (KL)= 		  =  0.161 +- 0.106, 0.291 +- 0.075, 0.402 +- 0.045, 0.411 +- 0.048, 0.444 +- 0.067
Faith. GMean (KL)= 	  =  0.215 +- 0.078, 0.336 +- 0.048, 0.436 +- 0.028, 0.447 +- 0.027, 0.480 +- 0.041

Eval split test
Faith. Aritm (L1)= 		  =  0.405 +- 0.035, 0.421 +- 0.028, 0.440 +- 0.020, 0.463 +- 0.015, 0.523 +- 0.045
Faith. Armon (L1)= 		  =  0.069 +- 0.043, 0.101 +- 0.057, 0.139 +- 0.066, 0.196 +- 0.074, 0.257 +- 0.098
Faith. GMean (L1)= 	  =  0.157 +- 0.049, 0.195 +- 0.057, 0.238 +- 0.056, 0.296 +- 0.056, 0.362 +- 0.082
Faith. Aritm (KL)= 		  =  0.362 +- 0.047, 0.385 +- 0.038, 0.413 +- 0.026, 0.450 +- 0.021, 0.543 +- 0.058
Faith. Armon (KL)= 		  =  0.058 +- 0.029, 0.098 +- 0.047, 0.153 +- 0.061, 0.231 +- 0.073, 0.326 +- 0.108
Faith. GMean (KL)= 	  =  0.137 +- 0.033, 0.186 +- 0.044, 0.244 +- 0.046, 0.318 +- 0.052, 0.417 +- 0.090
Computed for split load_split = id



Completed in  2:47:30.965211  for repr_GSATGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.01wd/GSAT_1.0_True_10_0.5 TopoFeature/basis



DONE GL-GSAT TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 22:19:13 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:19:13 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0015
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0015
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0015
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0015
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0015

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.052
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.063
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.076
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.037
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.046
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.056
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.068
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052486000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.805
SUFF_SIMPLE for r=0.05 class 0.0 = 0.626 +- 0.420 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.964 +- 0.420 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all KL = 0.763 +- 0.420 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all L1 = 0.813 +- 0.338 (in-sample avg dev_std = 0.306)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06340000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.814
SUFF_SIMPLE for r=0.1 class 0.0 = 0.63 +- 0.407 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.985 +- 0.407 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 all KL = 0.785 +- 0.407 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.1 all L1 = 0.826 +- 0.334 (in-sample avg dev_std = 0.268)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07078
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.809
SUFF_SIMPLE for r=0.2 class 0.0 = 0.619 +- 0.408 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.99 +- 0.408 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.2 all KL = 0.787 +- 0.408 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.2 all L1 = 0.825 +- 0.338 (in-sample avg dev_std = 0.235)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075792
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.825
SUFF_SIMPLE for r=0.4 class 0.0 = 0.64 +- 0.397 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.996 +- 0.397 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.4 all KL = 0.799 +- 0.397 (in-sample avg dev_std = 0.234)
SUFF_SIMPLE for r=0.4 all L1 = 0.837 +- 0.326 (in-sample avg dev_std = 0.234)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077492
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.936
SUFF_SIMPLE for r=0.8 class 0.0 = 0.869 +- 0.250 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 1.0 +- 0.250 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.929 +- 0.250 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.942 +- 0.210 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089806
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.746
SUFF_SIMPLE for r=0.05 class 0.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.784 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009006400000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.746
SUFF_SIMPLE for r=0.1 class 0.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.008993000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.2 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.001)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.371 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0089888
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.746
SUFF_SIMPLE for r=0.4 class 0.0 = 0.564 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.746 +- 0.435 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.784 +- 0.371 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0089886
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.758
SUFF_SIMPLE for r=0.8 class 0.0 = 0.583 +- 0.428 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.999 +- 0.428 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.755 +- 0.428 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.793 +- 0.363 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0372566
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.876
SUFF_SIMPLE for r=0.05 class 0.0 = 0.83 +- 0.336 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.948 +- 0.336 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.05 all KL = 0.844 +- 0.336 (in-sample avg dev_std = 0.243)
SUFF_SIMPLE for r=0.05 all L1 = 0.888 +- 0.264 (in-sample avg dev_std = 0.243)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0461748
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.878
SUFF_SIMPLE for r=0.1 class 0.0 = 0.831 +- 0.328 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.956 +- 0.328 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.1 all KL = 0.854 +- 0.328 (in-sample avg dev_std = 0.210)
SUFF_SIMPLE for r=0.1 all L1 = 0.893 +- 0.262 (in-sample avg dev_std = 0.210)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0563976
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.877
SUFF_SIMPLE for r=0.2 class 0.0 = 0.83 +- 0.326 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.959 +- 0.326 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all KL = 0.855 +- 0.326 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all L1 = 0.894 +- 0.261 (in-sample avg dev_std = 0.200)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0679408
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.87
SUFF_SIMPLE for r=0.4 class 0.0 = 0.844 +- 0.345 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.923 +- 0.345 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.4 all KL = 0.831 +- 0.345 (in-sample avg dev_std = 0.266)
SUFF_SIMPLE for r=0.4 all L1 = 0.883 +- 0.263 (in-sample avg dev_std = 0.266)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08047760000000001
len(reference) = 4977
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.845
SUFF_SIMPLE for r=0.8 class 0.0 = 0.978 +- 0.349 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.769 +- 0.349 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.855 +- 0.349 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.875 +- 0.301 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052486000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.004 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.038 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06340000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.99
NEC for r=0.1 class 0.0 = 0.021 +- 0.102 (in-sample avg dev_std = 0.001)
NEC for r=0.1 class 1.0 = 0.0 +- 0.102 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all KL = 0.012 +- 0.102 (in-sample avg dev_std = 0.001)
NEC for r=0.1 all L1 = 0.009 +- 0.082 (in-sample avg dev_std = 0.001)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07078
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.971
NEC for r=0.2 class 0.0 = 0.07 +- 0.199 (in-sample avg dev_std = 0.132)
NEC for r=0.2 class 1.0 = 0.004 +- 0.199 (in-sample avg dev_std = 0.132)
NEC for r=0.2 all KL = 0.047 +- 0.199 (in-sample avg dev_std = 0.132)
NEC for r=0.2 all L1 = 0.033 +- 0.148 (in-sample avg dev_std = 0.132)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.075792
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.938
NEC for r=0.4 class 0.0 = 0.137 +- 0.284 (in-sample avg dev_std = 0.240)
NEC for r=0.4 class 1.0 = 0.013 +- 0.284 (in-sample avg dev_std = 0.240)
NEC for r=0.4 all KL = 0.107 +- 0.284 (in-sample avg dev_std = 0.240)
NEC for r=0.4 all L1 = 0.068 +- 0.199 (in-sample avg dev_std = 0.240)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.077492
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.915
NEC for r=0.8 class 0.0 = 0.191 +- 0.329 (in-sample avg dev_std = 0.314)
NEC for r=0.8 class 1.0 = 0.019 +- 0.329 (in-sample avg dev_std = 0.314)
NEC for r=0.8 all KL = 0.151 +- 0.329 (in-sample avg dev_std = 0.314)
NEC for r=0.8 all L1 = 0.096 +- 0.229 (in-sample avg dev_std = 0.314)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089806
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.994
NEC for r=0.05 class 0.0 = 0.013 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.008 +- 0.083 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.006 +- 0.066 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009006400000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.93
NEC for r=0.1 class 0.0 = 0.137 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.001 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.087 +- 0.269 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.068 +- 0.216 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.008993000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.765
NEC for r=0.2 class 0.0 = 0.412 +- 0.428 (in-sample avg dev_std = 0.108)
NEC for r=0.2 class 1.0 = 0.0 +- 0.428 (in-sample avg dev_std = 0.108)
NEC for r=0.2 all KL = 0.245 +- 0.428 (in-sample avg dev_std = 0.108)
NEC for r=0.2 all L1 = 0.204 +- 0.359 (in-sample avg dev_std = 0.108)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0089888
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.759
NEC for r=0.4 class 0.0 = 0.426 +- 0.434 (in-sample avg dev_std = 0.169)
NEC for r=0.4 class 1.0 = 0.0 +- 0.434 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all KL = 0.253 +- 0.434 (in-sample avg dev_std = 0.169)
NEC for r=0.4 all L1 = 0.211 +- 0.363 (in-sample avg dev_std = 0.169)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0089886
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.759
NEC for r=0.8 class 0.0 = 0.426 +- 0.434 (in-sample avg dev_std = 0.178)
NEC for r=0.8 class 1.0 = 0.0 +- 0.434 (in-sample avg dev_std = 0.178)
NEC for r=0.8 all KL = 0.253 +- 0.434 (in-sample avg dev_std = 0.178)
NEC for r=0.8 all L1 = 0.212 +- 0.363 (in-sample avg dev_std = 0.178)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0372566
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.98
NEC for r=0.05 class 0.0 = 0.01 +- 0.070 (in-sample avg dev_std = 0.020)
NEC for r=0.05 class 1.0 = 0.001 +- 0.070 (in-sample avg dev_std = 0.020)
NEC for r=0.05 all KL = 0.006 +- 0.070 (in-sample avg dev_std = 0.020)
NEC for r=0.05 all L1 = 0.005 +- 0.061 (in-sample avg dev_std = 0.020)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0461748
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.977
NEC for r=0.1 class 0.0 = 0.015 +- 0.095 (in-sample avg dev_std = 0.011)
NEC for r=0.1 class 1.0 = 0.002 +- 0.095 (in-sample avg dev_std = 0.011)
NEC for r=0.1 all KL = 0.01 +- 0.095 (in-sample avg dev_std = 0.011)
NEC for r=0.1 all L1 = 0.009 +- 0.081 (in-sample avg dev_std = 0.011)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0563976
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.969
NEC for r=0.2 class 0.0 = 0.029 +- 0.133 (in-sample avg dev_std = 0.024)
NEC for r=0.2 class 1.0 = 0.004 +- 0.133 (in-sample avg dev_std = 0.024)
NEC for r=0.2 all KL = 0.02 +- 0.133 (in-sample avg dev_std = 0.024)
NEC for r=0.2 all L1 = 0.017 +- 0.113 (in-sample avg dev_std = 0.024)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0679408
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.935
NEC for r=0.4 class 0.0 = 0.081 +- 0.225 (in-sample avg dev_std = 0.073)
NEC for r=0.4 class 1.0 = 0.011 +- 0.225 (in-sample avg dev_std = 0.073)
NEC for r=0.4 all KL = 0.057 +- 0.225 (in-sample avg dev_std = 0.073)
NEC for r=0.4 all L1 = 0.047 +- 0.188 (in-sample avg dev_std = 0.073)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08047760000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.914
NEC for r=0.8 class 0.0 = 0.118 +- 0.274 (in-sample avg dev_std = 0.161)
NEC for r=0.8 class 1.0 = 0.019 +- 0.274 (in-sample avg dev_std = 0.161)
NEC for r=0.8 all KL = 0.091 +- 0.274 (in-sample avg dev_std = 0.161)
NEC for r=0.8 all L1 = 0.069 +- 0.220 (in-sample avg dev_std = 0.161)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 22:34:08 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:34:08 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 59 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 59...
[0m[1;37mINFO[0m: [1mCheckpoint 59: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0008
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0009
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0008
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0009
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0008

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.057
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.067
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.067
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.854
SUFF_SIMPLE for r=0.05 class 0.0 = 0.752 +- 0.411 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.886 +- 0.411 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.05 all KL = 0.711 +- 0.411 (in-sample avg dev_std = 0.491)
SUFF_SIMPLE for r=0.05 all L1 = 0.826 +- 0.275 (in-sample avg dev_std = 0.491)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06731000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.851
SUFF_SIMPLE for r=0.1 class 0.0 = 0.746 +- 0.403 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.888 +- 0.403 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.1 all KL = 0.703 +- 0.403 (in-sample avg dev_std = 0.480)
SUFF_SIMPLE for r=0.1 all L1 = 0.825 +- 0.274 (in-sample avg dev_std = 0.480)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070602
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.862
SUFF_SIMPLE for r=0.2 class 0.0 = 0.76 +- 0.399 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.905 +- 0.399 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.2 all KL = 0.739 +- 0.399 (in-sample avg dev_std = 0.441)
SUFF_SIMPLE for r=0.2 all L1 = 0.84 +- 0.273 (in-sample avg dev_std = 0.441)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076564
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.865
SUFF_SIMPLE for r=0.4 class 0.0 = 0.789 +- 0.389 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.905 +- 0.389 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 all KL = 0.772 +- 0.389 (in-sample avg dev_std = 0.383)
SUFF_SIMPLE for r=0.4 all L1 = 0.853 +- 0.277 (in-sample avg dev_std = 0.383)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080314
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.974
SUFF_SIMPLE for r=0.8 class 0.0 = 0.965 +- 0.159 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.987 +- 0.159 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.974 +- 0.159 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.977 +- 0.138 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0098826
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.749
SUFF_SIMPLE for r=0.05 class 0.0 = 0.561 +- 0.435 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.997 +- 0.435 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.05 all KL = 0.742 +- 0.435 (in-sample avg dev_std = 0.136)
SUFF_SIMPLE for r=0.05 all L1 = 0.781 +- 0.373 (in-sample avg dev_std = 0.136)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0098832
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.749
SUFF_SIMPLE for r=0.1 class 0.0 = 0.561 +- 0.435 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.1 all KL = 0.743 +- 0.435 (in-sample avg dev_std = 0.131)
SUFF_SIMPLE for r=0.1 all L1 = 0.781 +- 0.373 (in-sample avg dev_std = 0.131)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009895000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.75
SUFF_SIMPLE for r=0.2 class 0.0 = 0.561 +- 0.435 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all KL = 0.744 +- 0.435 (in-sample avg dev_std = 0.129)
SUFF_SIMPLE for r=0.2 all L1 = 0.781 +- 0.373 (in-sample avg dev_std = 0.129)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098774
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.75
SUFF_SIMPLE for r=0.4 class 0.0 = 0.561 +- 0.435 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.998 +- 0.435 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.4 all KL = 0.744 +- 0.435 (in-sample avg dev_std = 0.127)
SUFF_SIMPLE for r=0.4 all L1 = 0.781 +- 0.373 (in-sample avg dev_std = 0.127)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877799999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.874
SUFF_SIMPLE for r=0.8 class 0.0 = 0.829 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.951 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.873 +- 0.332 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.89 +- 0.286 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035289999999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.871
SUFF_SIMPLE for r=0.05 class 0.0 = 0.835 +- 0.362 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.362 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.05 all KL = 0.812 +- 0.362 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.05 all L1 = 0.872 +- 0.272 (in-sample avg dev_std = 0.320)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042921799999999996
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.872
SUFF_SIMPLE for r=0.1 class 0.0 = 0.836 +- 0.353 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.922 +- 0.353 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all KL = 0.828 +- 0.353 (in-sample avg dev_std = 0.279)
SUFF_SIMPLE for r=0.1 all L1 = 0.879 +- 0.272 (in-sample avg dev_std = 0.279)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053993000000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.881
SUFF_SIMPLE for r=0.2 class 0.0 = 0.844 +- 0.339 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.936 +- 0.339 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.2 all KL = 0.848 +- 0.339 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.2 all L1 = 0.889 +- 0.267 (in-sample avg dev_std = 0.236)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0670826
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.899
SUFF_SIMPLE for r=0.4 class 0.0 = 0.892 +- 0.312 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.924 +- 0.312 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 all KL = 0.88 +- 0.312 (in-sample avg dev_std = 0.176)
SUFF_SIMPLE for r=0.4 all L1 = 0.908 +- 0.253 (in-sample avg dev_std = 0.176)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0801148
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.939
SUFF_SIMPLE for r=0.8 class 0.0 = 0.986 +- 0.229 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.916 +- 0.229 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.944 +- 0.229 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.951 +- 0.198 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057346
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.99
NEC for r=0.05 class 0.0 = 0.008 +- 0.100 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.01 +- 0.100 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.011 +- 0.100 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.086 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06731000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.975
NEC for r=0.1 class 0.0 = 0.022 +- 0.159 (in-sample avg dev_std = 0.058)
NEC for r=0.1 class 1.0 = 0.022 +- 0.159 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all KL = 0.026 +- 0.159 (in-sample avg dev_std = 0.058)
NEC for r=0.1 all L1 = 0.022 +- 0.136 (in-sample avg dev_std = 0.058)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070602
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.958
NEC for r=0.2 class 0.0 = 0.032 +- 0.232 (in-sample avg dev_std = 0.183)
NEC for r=0.2 class 1.0 = 0.054 +- 0.232 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all KL = 0.066 +- 0.232 (in-sample avg dev_std = 0.183)
NEC for r=0.2 all L1 = 0.044 +- 0.169 (in-sample avg dev_std = 0.183)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076564
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.935
NEC for r=0.4 class 0.0 = 0.072 +- 0.301 (in-sample avg dev_std = 0.299)
NEC for r=0.4 class 1.0 = 0.076 +- 0.301 (in-sample avg dev_std = 0.299)
NEC for r=0.4 all KL = 0.126 +- 0.301 (in-sample avg dev_std = 0.299)
NEC for r=0.4 all L1 = 0.075 +- 0.200 (in-sample avg dev_std = 0.299)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080314
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.923
NEC for r=0.8 class 0.0 = 0.114 +- 0.347 (in-sample avg dev_std = 0.412)
NEC for r=0.8 class 1.0 = 0.092 +- 0.347 (in-sample avg dev_std = 0.412)
NEC for r=0.8 all KL = 0.194 +- 0.347 (in-sample avg dev_std = 0.412)
NEC for r=0.8 all L1 = 0.102 +- 0.204 (in-sample avg dev_std = 0.412)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0098826
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.992
NEC for r=0.05 class 0.0 = 0.012 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.001 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.008 +- 0.087 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.007 +- 0.074 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0098832
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.97
NEC for r=0.1 class 0.0 = 0.038 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.015 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.031 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.026 +- 0.147 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009895000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.887
NEC for r=0.2 class 0.0 = 0.166 +- 0.346 (in-sample avg dev_std = 0.272)
NEC for r=0.2 class 1.0 = 0.059 +- 0.346 (in-sample avg dev_std = 0.272)
NEC for r=0.2 all KL = 0.154 +- 0.346 (in-sample avg dev_std = 0.272)
NEC for r=0.2 all L1 = 0.112 +- 0.267 (in-sample avg dev_std = 0.272)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0098774
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.88
NEC for r=0.4 class 0.0 = 0.236 +- 0.399 (in-sample avg dev_std = 0.519)
NEC for r=0.4 class 1.0 = 0.078 +- 0.399 (in-sample avg dev_std = 0.519)
NEC for r=0.4 all KL = 0.281 +- 0.399 (in-sample avg dev_std = 0.519)
NEC for r=0.4 all L1 = 0.156 +- 0.245 (in-sample avg dev_std = 0.519)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877799999999999
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.879
NEC for r=0.8 class 0.0 = 0.246 +- 0.402 (in-sample avg dev_std = 0.552)
NEC for r=0.8 class 1.0 = 0.086 +- 0.402 (in-sample avg dev_std = 0.552)
NEC for r=0.8 all KL = 0.308 +- 0.402 (in-sample avg dev_std = 0.552)
NEC for r=0.8 all L1 = 0.165 +- 0.238 (in-sample avg dev_std = 0.552)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035289999999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.983
NEC for r=0.05 class 0.0 = 0.009 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.01 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.011 +- 0.105 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.01 +- 0.090 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042921799999999996
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.981
NEC for r=0.1 class 0.0 = 0.011 +- 0.117 (in-sample avg dev_std = 0.015)
NEC for r=0.1 class 1.0 = 0.013 +- 0.117 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all KL = 0.014 +- 0.117 (in-sample avg dev_std = 0.015)
NEC for r=0.1 all L1 = 0.012 +- 0.100 (in-sample avg dev_std = 0.015)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053993000000000006
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.971
NEC for r=0.2 class 0.0 = 0.019 +- 0.154 (in-sample avg dev_std = 0.040)
NEC for r=0.2 class 1.0 = 0.022 +- 0.154 (in-sample avg dev_std = 0.040)
NEC for r=0.2 all KL = 0.025 +- 0.154 (in-sample avg dev_std = 0.040)
NEC for r=0.2 all L1 = 0.021 +- 0.131 (in-sample avg dev_std = 0.040)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0670826
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.941
NEC for r=0.4 class 0.0 = 0.047 +- 0.229 (in-sample avg dev_std = 0.088)
NEC for r=0.4 class 1.0 = 0.048 +- 0.229 (in-sample avg dev_std = 0.088)
NEC for r=0.4 all KL = 0.058 +- 0.229 (in-sample avg dev_std = 0.088)
NEC for r=0.4 all L1 = 0.047 +- 0.192 (in-sample avg dev_std = 0.088)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0801148
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.914
NEC for r=0.8 class 0.0 = 0.107 +- 0.302 (in-sample avg dev_std = 0.244)
NEC for r=0.8 class 1.0 = 0.056 +- 0.302 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all KL = 0.118 +- 0.302 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all L1 = 0.082 +- 0.228 (in-sample avg dev_std = 0.244)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 22:49:43 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 10:49:43 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 49 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 49...
[0m[1;37mINFO[0m: [1mCheckpoint 49: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0038
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0039
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0038
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0039
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0038

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.056
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.059
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.082
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.085
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.053
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.055805999999999994
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.811
SUFF_SIMPLE for r=0.05 class 0.0 = 0.685 +- 0.416 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.879 +- 0.416 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.05 all KL = 0.699 +- 0.416 (in-sample avg dev_std = 0.489)
SUFF_SIMPLE for r=0.05 all L1 = 0.793 +- 0.311 (in-sample avg dev_std = 0.489)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.058688000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.828
SUFF_SIMPLE for r=0.1 class 0.0 = 0.7 +- 0.407 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.909 +- 0.407 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.1 all KL = 0.738 +- 0.407 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.1 all L1 = 0.816 +- 0.306 (in-sample avg dev_std = 0.437)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07193599999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.836
SUFF_SIMPLE for r=0.2 class 0.0 = 0.715 +- 0.400 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.913 +- 0.400 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.2 all KL = 0.751 +- 0.400 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.2 all L1 = 0.825 +- 0.302 (in-sample avg dev_std = 0.419)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.081944
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.851
SUFF_SIMPLE for r=0.4 class 0.0 = 0.738 +- 0.384 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.933 +- 0.384 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.4 all KL = 0.785 +- 0.384 (in-sample avg dev_std = 0.371)
SUFF_SIMPLE for r=0.4 all L1 = 0.846 +- 0.294 (in-sample avg dev_std = 0.371)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085276
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.946
SUFF_SIMPLE for r=0.8 class 0.0 = 0.913 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.984 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.945 +- 0.227 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.953 +- 0.196 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0100756
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.712
SUFF_SIMPLE for r=0.05 class 0.0 = 0.604 +- 0.415 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.415 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.05 all KL = 0.765 +- 0.415 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.05 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.010)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010077599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.712
SUFF_SIMPLE for r=0.1 class 0.0 = 0.604 +- 0.415 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.415 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.1 all KL = 0.765 +- 0.415 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.1 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.014)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010061
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.712
SUFF_SIMPLE for r=0.2 class 0.0 = 0.604 +- 0.415 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.415 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.2 all KL = 0.765 +- 0.415 (in-sample avg dev_std = 0.017)
SUFF_SIMPLE for r=0.2 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.017)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100376
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.712
SUFF_SIMPLE for r=0.4 class 0.0 = 0.604 +- 0.415 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.415 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.4 all KL = 0.765 +- 0.415 (in-sample avg dev_std = 0.014)
SUFF_SIMPLE for r=0.4 all L1 = 0.804 +- 0.352 (in-sample avg dev_std = 0.014)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010035800000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.759
SUFF_SIMPLE for r=0.8 class 0.0 = 0.689 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.997 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.813 +- 0.381 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.844 +- 0.322 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0321112
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.876
SUFF_SIMPLE for r=0.05 class 0.0 = 0.835 +- 0.346 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.919 +- 0.346 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all KL = 0.828 +- 0.346 (in-sample avg dev_std = 0.306)
SUFF_SIMPLE for r=0.05 all L1 = 0.877 +- 0.269 (in-sample avg dev_std = 0.306)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041798
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.872
SUFF_SIMPLE for r=0.1 class 0.0 = 0.838 +- 0.344 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.918 +- 0.344 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.1 all KL = 0.834 +- 0.344 (in-sample avg dev_std = 0.270)
SUFF_SIMPLE for r=0.1 all L1 = 0.877 +- 0.274 (in-sample avg dev_std = 0.270)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053203
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.875
SUFF_SIMPLE for r=0.2 class 0.0 = 0.842 +- 0.335 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.93 +- 0.335 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.2 all KL = 0.852 +- 0.335 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.2 all L1 = 0.885 +- 0.274 (in-sample avg dev_std = 0.218)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066414
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.887
SUFF_SIMPLE for r=0.4 class 0.0 = 0.883 +- 0.316 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.919 +- 0.316 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all KL = 0.877 +- 0.316 (in-sample avg dev_std = 0.162)
SUFF_SIMPLE for r=0.4 all L1 = 0.901 +- 0.264 (in-sample avg dev_std = 0.162)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080014
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.959
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.184 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.953 +- 0.184 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.8 all KL = 0.964 +- 0.184 (in-sample avg dev_std = 0.016)
SUFF_SIMPLE for r=0.8 all L1 = 0.969 +- 0.160 (in-sample avg dev_std = 0.016)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.055805999999999994
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.99
NEC for r=0.05 class 0.0 = 0.008 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.009 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.086 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.058688000000000004
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.972
NEC for r=0.1 class 0.0 = 0.036 +- 0.165 (in-sample avg dev_std = 0.031)
NEC for r=0.1 class 1.0 = 0.016 +- 0.165 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.028 +- 0.165 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.025 +- 0.142 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07193599999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.951
NEC for r=0.2 class 0.0 = 0.079 +- 0.241 (in-sample avg dev_std = 0.209)
NEC for r=0.2 class 1.0 = 0.027 +- 0.241 (in-sample avg dev_std = 0.209)
NEC for r=0.2 all KL = 0.071 +- 0.241 (in-sample avg dev_std = 0.209)
NEC for r=0.2 all L1 = 0.05 +- 0.182 (in-sample avg dev_std = 0.209)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.081944
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.91
NEC for r=0.4 class 0.0 = 0.125 +- 0.325 (in-sample avg dev_std = 0.342)
NEC for r=0.4 class 1.0 = 0.083 +- 0.325 (in-sample avg dev_std = 0.342)
NEC for r=0.4 all KL = 0.156 +- 0.325 (in-sample avg dev_std = 0.342)
NEC for r=0.4 all L1 = 0.102 +- 0.232 (in-sample avg dev_std = 0.342)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085276
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.914
NEC for r=0.8 class 0.0 = 0.14 +- 0.331 (in-sample avg dev_std = 0.427)
NEC for r=0.8 class 1.0 = 0.088 +- 0.331 (in-sample avg dev_std = 0.427)
NEC for r=0.8 all KL = 0.191 +- 0.331 (in-sample avg dev_std = 0.427)
NEC for r=0.8 all L1 = 0.111 +- 0.214 (in-sample avg dev_std = 0.427)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.929
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0100756
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.908
NEC for r=0.05 class 0.0 = 0.041 +- 0.151 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.001 +- 0.151 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.025 +- 0.151 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.02 +- 0.126 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.929
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010077599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.862
NEC for r=0.1 class 0.0 = 0.121 +- 0.255 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.003 +- 0.255 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.074 +- 0.255 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.061 +- 0.215 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.929
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010061
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.766
NEC for r=0.2 class 0.0 = 0.307 +- 0.381 (in-sample avg dev_std = 0.180)
NEC for r=0.2 class 1.0 = 0.003 +- 0.381 (in-sample avg dev_std = 0.180)
NEC for r=0.2 all KL = 0.191 +- 0.381 (in-sample avg dev_std = 0.180)
NEC for r=0.2 all L1 = 0.154 +- 0.314 (in-sample avg dev_std = 0.180)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.929
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100376
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.755
NEC for r=0.4 class 0.0 = 0.352 +- 0.405 (in-sample avg dev_std = 0.337)
NEC for r=0.4 class 1.0 = 0.005 +- 0.405 (in-sample avg dev_std = 0.337)
NEC for r=0.4 all KL = 0.232 +- 0.405 (in-sample avg dev_std = 0.337)
NEC for r=0.4 all L1 = 0.177 +- 0.319 (in-sample avg dev_std = 0.337)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.929
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010035800000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.754
NEC for r=0.8 class 0.0 = 0.356 +- 0.407 (in-sample avg dev_std = 0.352)
NEC for r=0.8 class 1.0 = 0.004 +- 0.407 (in-sample avg dev_std = 0.352)
NEC for r=0.8 all KL = 0.232 +- 0.407 (in-sample avg dev_std = 0.352)
NEC for r=0.8 all L1 = 0.178 +- 0.320 (in-sample avg dev_std = 0.352)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.987
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0321112
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.979
NEC for r=0.05 class 0.0 = 0.007 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.014 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.012 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.01 +- 0.093 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.987
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041798
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.976
NEC for r=0.1 class 0.0 = 0.01 +- 0.131 (in-sample avg dev_std = 0.016)
NEC for r=0.1 class 1.0 = 0.021 +- 0.131 (in-sample avg dev_std = 0.016)
NEC for r=0.1 all KL = 0.018 +- 0.131 (in-sample avg dev_std = 0.016)
NEC for r=0.1 all L1 = 0.015 +- 0.113 (in-sample avg dev_std = 0.016)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.987
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053203
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.968
NEC for r=0.2 class 0.0 = 0.017 +- 0.162 (in-sample avg dev_std = 0.060)
NEC for r=0.2 class 1.0 = 0.03 +- 0.162 (in-sample avg dev_std = 0.060)
NEC for r=0.2 all KL = 0.028 +- 0.162 (in-sample avg dev_std = 0.060)
NEC for r=0.2 all L1 = 0.024 +- 0.138 (in-sample avg dev_std = 0.060)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.987
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066414
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.939
NEC for r=0.4 class 0.0 = 0.048 +- 0.236 (in-sample avg dev_std = 0.091)
NEC for r=0.4 class 1.0 = 0.055 +- 0.236 (in-sample avg dev_std = 0.091)
NEC for r=0.4 all KL = 0.062 +- 0.236 (in-sample avg dev_std = 0.091)
NEC for r=0.4 all L1 = 0.052 +- 0.199 (in-sample avg dev_std = 0.091)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.987
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080014
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.913
NEC for r=0.8 class 0.0 = 0.103 +- 0.298 (in-sample avg dev_std = 0.252)
NEC for r=0.8 class 1.0 = 0.067 +- 0.298 (in-sample avg dev_std = 0.252)
NEC for r=0.8 all KL = 0.118 +- 0.298 (in-sample avg dev_std = 0.252)
NEC for r=0.8 all L1 = 0.085 +- 0.231 (in-sample avg dev_std = 0.252)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 23:04:57 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:04:57 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0125
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0127
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0125
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0127
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0125

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.057
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.065
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.075
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.063
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056974000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.818
SUFF_SIMPLE for r=0.05 class 0.0 = 0.776 +- 0.387 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.773 +- 0.387 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.05 all KL = 0.654 +- 0.387 (in-sample avg dev_std = 0.566)
SUFF_SIMPLE for r=0.05 all L1 = 0.774 +- 0.276 (in-sample avg dev_std = 0.566)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06515399999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.822
SUFF_SIMPLE for r=0.1 class 0.0 = 0.803 +- 0.381 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.775 +- 0.381 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 all KL = 0.681 +- 0.381 (in-sample avg dev_std = 0.523)
SUFF_SIMPLE for r=0.1 all L1 = 0.787 +- 0.280 (in-sample avg dev_std = 0.523)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071744
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.811
SUFF_SIMPLE for r=0.2 class 0.0 = 0.792 +- 0.389 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.766 +- 0.389 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.2 all KL = 0.67 +- 0.389 (in-sample avg dev_std = 0.526)
SUFF_SIMPLE for r=0.2 all L1 = 0.778 +- 0.288 (in-sample avg dev_std = 0.526)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07501000000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.82
SUFF_SIMPLE for r=0.4 class 0.0 = 0.827 +- 0.384 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.764 +- 0.384 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.4 all KL = 0.696 +- 0.384 (in-sample avg dev_std = 0.479)
SUFF_SIMPLE for r=0.4 all L1 = 0.792 +- 0.288 (in-sample avg dev_std = 0.479)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078934
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.908
SUFF_SIMPLE for r=0.8 class 0.0 = 0.974 +- 0.286 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.869 +- 0.286 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.905 +- 0.286 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.916 +- 0.247 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.699
SUFF_SIMPLE for r=0.05 class 0.0 = 0.653 +- 0.406 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.949 +- 0.406 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.05 all KL = 0.729 +- 0.406 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.05 all L1 = 0.802 +- 0.315 (in-sample avg dev_std = 0.336)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009945599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.696
SUFF_SIMPLE for r=0.1 class 0.0 = 0.652 +- 0.407 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.945 +- 0.407 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all KL = 0.725 +- 0.407 (in-sample avg dev_std = 0.338)
SUFF_SIMPLE for r=0.1 all L1 = 0.8 +- 0.316 (in-sample avg dev_std = 0.338)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009889
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.697
SUFF_SIMPLE for r=0.2 class 0.0 = 0.652 +- 0.407 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.946 +- 0.407 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.2 all KL = 0.725 +- 0.407 (in-sample avg dev_std = 0.339)
SUFF_SIMPLE for r=0.2 all L1 = 0.8 +- 0.315 (in-sample avg dev_std = 0.339)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.696
SUFF_SIMPLE for r=0.4 class 0.0 = 0.653 +- 0.408 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.949 +- 0.408 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.4 all KL = 0.731 +- 0.408 (in-sample avg dev_std = 0.320)
SUFF_SIMPLE for r=0.4 all L1 = 0.802 +- 0.318 (in-sample avg dev_std = 0.320)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.653
SUFF_SIMPLE for r=0.8 class 0.0 = 0.975 +- 0.401 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.584 +- 0.401 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.761 +- 0.401 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.778 +- 0.352 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0331508
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.867
SUFF_SIMPLE for r=0.05 class 0.0 = 0.845 +- 0.348 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.88 +- 0.348 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.05 all KL = 0.817 +- 0.348 (in-sample avg dev_std = 0.310)
SUFF_SIMPLE for r=0.05 all L1 = 0.862 +- 0.278 (in-sample avg dev_std = 0.310)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.866
SUFF_SIMPLE for r=0.1 class 0.0 = 0.852 +- 0.346 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.879 +- 0.346 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.1 all KL = 0.827 +- 0.346 (in-sample avg dev_std = 0.271)
SUFF_SIMPLE for r=0.1 all L1 = 0.866 +- 0.281 (in-sample avg dev_std = 0.271)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0508582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.87
SUFF_SIMPLE for r=0.2 class 0.0 = 0.86 +- 0.334 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.894 +- 0.334 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.2 all KL = 0.844 +- 0.334 (in-sample avg dev_std = 0.235)
SUFF_SIMPLE for r=0.2 all L1 = 0.877 +- 0.275 (in-sample avg dev_std = 0.235)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0630722
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.872
SUFF_SIMPLE for r=0.4 class 0.0 = 0.891 +- 0.332 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.867 +- 0.332 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.4 all KL = 0.85 +- 0.332 (in-sample avg dev_std = 0.203)
SUFF_SIMPLE for r=0.4 all L1 = 0.879 +- 0.276 (in-sample avg dev_std = 0.203)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0781998
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.892
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.297 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.835 +- 0.297 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.898 +- 0.297 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.909 +- 0.259 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056974000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
NEC for r=0.05 class 0.0 = 0.004 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.004 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.004 +- 0.063 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.004 +- 0.055 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06515399999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.972
NEC for r=0.1 class 0.0 = 0.011 +- 0.162 (in-sample avg dev_std = 0.032)
NEC for r=0.1 class 1.0 = 0.038 +- 0.162 (in-sample avg dev_std = 0.032)
NEC for r=0.1 all KL = 0.03 +- 0.162 (in-sample avg dev_std = 0.032)
NEC for r=0.1 all L1 = 0.026 +- 0.138 (in-sample avg dev_std = 0.032)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071744
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.95
NEC for r=0.2 class 0.0 = 0.024 +- 0.232 (in-sample avg dev_std = 0.221)
NEC for r=0.2 class 1.0 = 0.084 +- 0.232 (in-sample avg dev_std = 0.221)
NEC for r=0.2 all KL = 0.08 +- 0.232 (in-sample avg dev_std = 0.221)
NEC for r=0.2 all L1 = 0.057 +- 0.173 (in-sample avg dev_std = 0.221)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07501000000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.911
NEC for r=0.4 class 0.0 = 0.07 +- 0.304 (in-sample avg dev_std = 0.335)
NEC for r=0.4 class 1.0 = 0.135 +- 0.304 (in-sample avg dev_std = 0.335)
NEC for r=0.4 all KL = 0.153 +- 0.304 (in-sample avg dev_std = 0.335)
NEC for r=0.4 all L1 = 0.106 +- 0.224 (in-sample avg dev_std = 0.335)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078934
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.901
NEC for r=0.8 class 0.0 = 0.085 +- 0.323 (in-sample avg dev_std = 0.447)
NEC for r=0.8 class 1.0 = 0.172 +- 0.323 (in-sample avg dev_std = 0.447)
NEC for r=0.8 all KL = 0.209 +- 0.323 (in-sample avg dev_std = 0.447)
NEC for r=0.8 all L1 = 0.133 +- 0.221 (in-sample avg dev_std = 0.447)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.88
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099886
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.813
NEC for r=0.05 class 0.0 = 0.001 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.149 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.076 +- 0.242 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.075 +- 0.214 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.88
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009945599999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.686
NEC for r=0.1 class 0.0 = 0.004 +- 0.374 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.386 +- 0.374 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.206 +- 0.374 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.197 +- 0.330 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.88
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009889
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.652
NEC for r=0.2 class 0.0 = 0.025 +- 0.404 (in-sample avg dev_std = 0.256)
NEC for r=0.2 class 1.0 = 0.444 +- 0.404 (in-sample avg dev_std = 0.256)
NEC for r=0.2 all KL = 0.268 +- 0.404 (in-sample avg dev_std = 0.256)
NEC for r=0.2 all L1 = 0.236 +- 0.343 (in-sample avg dev_std = 0.256)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.88
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.659
NEC for r=0.4 class 0.0 = 0.055 +- 0.403 (in-sample avg dev_std = 0.563)
NEC for r=0.4 class 1.0 = 0.496 +- 0.403 (in-sample avg dev_std = 0.563)
NEC for r=0.4 all KL = 0.366 +- 0.403 (in-sample avg dev_std = 0.563)
NEC for r=0.4 all L1 = 0.278 +- 0.300 (in-sample avg dev_std = 0.563)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.88
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009877200000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.66
NEC for r=0.8 class 0.0 = 0.058 +- 0.400 (in-sample avg dev_std = 0.597)
NEC for r=0.8 class 1.0 = 0.507 +- 0.400 (in-sample avg dev_std = 0.597)
NEC for r=0.8 all KL = 0.382 +- 0.400 (in-sample avg dev_std = 0.597)
NEC for r=0.8 all L1 = 0.284 +- 0.291 (in-sample avg dev_std = 0.597)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.979
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0331508
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.972
NEC for r=0.05 class 0.0 = 0.008 +- 0.121 (in-sample avg dev_std = 0.010)
NEC for r=0.05 class 1.0 = 0.023 +- 0.121 (in-sample avg dev_std = 0.010)
NEC for r=0.05 all KL = 0.017 +- 0.121 (in-sample avg dev_std = 0.010)
NEC for r=0.05 all L1 = 0.016 +- 0.107 (in-sample avg dev_std = 0.010)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.979
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.041714
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.97
NEC for r=0.1 class 0.0 = 0.012 +- 0.144 (in-sample avg dev_std = 0.022)
NEC for r=0.1 class 1.0 = 0.031 +- 0.144 (in-sample avg dev_std = 0.022)
NEC for r=0.1 all KL = 0.024 +- 0.144 (in-sample avg dev_std = 0.022)
NEC for r=0.1 all L1 = 0.022 +- 0.126 (in-sample avg dev_std = 0.022)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.979
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0508582
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.962
NEC for r=0.2 class 0.0 = 0.022 +- 0.183 (in-sample avg dev_std = 0.066)
NEC for r=0.2 class 1.0 = 0.046 +- 0.183 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all KL = 0.039 +- 0.183 (in-sample avg dev_std = 0.066)
NEC for r=0.2 all L1 = 0.034 +- 0.158 (in-sample avg dev_std = 0.066)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.979
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0630722
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.935
NEC for r=0.4 class 0.0 = 0.048 +- 0.248 (in-sample avg dev_std = 0.092)
NEC for r=0.4 class 1.0 = 0.077 +- 0.248 (in-sample avg dev_std = 0.092)
NEC for r=0.4 all KL = 0.072 +- 0.248 (in-sample avg dev_std = 0.092)
NEC for r=0.4 all L1 = 0.062 +- 0.211 (in-sample avg dev_std = 0.092)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.979
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0781998
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.909
NEC for r=0.8 class 0.0 = 0.098 +- 0.302 (in-sample avg dev_std = 0.244)
NEC for r=0.8 class 1.0 = 0.093 +- 0.302 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all KL = 0.125 +- 0.302 (in-sample avg dev_std = 0.244)
NEC for r=0.8 all L1 = 0.096 +- 0.242 (in-sample avg dev_std = 0.244)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 23:20:16 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:20:16 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0020
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0020
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0020
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0020
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0020

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.058
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.068
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.077
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.081
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.036
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.044
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.055
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.067
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057848
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.816
SUFF_SIMPLE for r=0.05 class 0.0 = 0.669 +- 0.420 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.929 +- 0.420 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.05 all KL = 0.746 +- 0.420 (in-sample avg dev_std = 0.380)
SUFF_SIMPLE for r=0.05 all L1 = 0.813 +- 0.324 (in-sample avg dev_std = 0.380)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06810000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.823
SUFF_SIMPLE for r=0.1 class 0.0 = 0.669 +- 0.411 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.947 +- 0.411 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.1 all KL = 0.762 +- 0.411 (in-sample avg dev_std = 0.355)
SUFF_SIMPLE for r=0.1 all L1 = 0.823 +- 0.319 (in-sample avg dev_std = 0.355)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07681600000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.826
SUFF_SIMPLE for r=0.2 class 0.0 = 0.659 +- 0.407 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.962 +- 0.407 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.2 all KL = 0.768 +- 0.407 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.2 all L1 = 0.826 +- 0.319 (in-sample avg dev_std = 0.345)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08120999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.845
SUFF_SIMPLE for r=0.4 class 0.0 = 0.675 +- 0.392 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.983 +- 0.392 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.4 all KL = 0.793 +- 0.392 (in-sample avg dev_std = 0.334)
SUFF_SIMPLE for r=0.4 all L1 = 0.846 +- 0.305 (in-sample avg dev_std = 0.334)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.083534
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.942
SUFF_SIMPLE for r=0.8 class 0.0 = 0.899 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.985 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.937 +- 0.239 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.947 +- 0.204 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092894
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.722
SUFF_SIMPLE for r=0.05 class 0.0 = 0.591 +- 0.431 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.05 class 1.0 = 1.0 +- 0.431 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.05 all KL = 0.749 +- 0.431 (in-sample avg dev_std = 0.038)
SUFF_SIMPLE for r=0.05 all L1 = 0.797 +- 0.354 (in-sample avg dev_std = 0.038)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092764
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.722
SUFF_SIMPLE for r=0.1 class 0.0 = 0.591 +- 0.431 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.1 class 1.0 = 1.0 +- 0.431 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.1 all KL = 0.749 +- 0.431 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.1 all L1 = 0.797 +- 0.354 (in-sample avg dev_std = 0.054)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009251599999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.722
SUFF_SIMPLE for r=0.2 class 0.0 = 0.591 +- 0.431 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.2 class 1.0 = 1.0 +- 0.431 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.2 all KL = 0.749 +- 0.431 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.2 all L1 = 0.797 +- 0.354 (in-sample avg dev_std = 0.047)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0092452
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.722
SUFF_SIMPLE for r=0.4 class 0.0 = 0.591 +- 0.431 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.4 class 1.0 = 1.0 +- 0.431 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.4 all KL = 0.749 +- 0.431 (in-sample avg dev_std = 0.053)
SUFF_SIMPLE for r=0.4 all L1 = 0.797 +- 0.354 (in-sample avg dev_std = 0.053)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0092438
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.827
SUFF_SIMPLE for r=0.8 class 0.0 = 0.784 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.993 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.861 +- 0.340 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.889 +- 0.276 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035731200000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.873
SUFF_SIMPLE for r=0.05 class 0.0 = 0.832 +- 0.352 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.925 +- 0.352 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 all KL = 0.823 +- 0.352 (in-sample avg dev_std = 0.297)
SUFF_SIMPLE for r=0.05 all L1 = 0.878 +- 0.267 (in-sample avg dev_std = 0.297)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0443548
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.874
SUFF_SIMPLE for r=0.1 class 0.0 = 0.83 +- 0.343 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.939 +- 0.343 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.1 all KL = 0.837 +- 0.343 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.1 all L1 = 0.884 +- 0.269 (in-sample avg dev_std = 0.254)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05519400000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.874
SUFF_SIMPLE for r=0.2 class 0.0 = 0.831 +- 0.339 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.943 +- 0.339 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all KL = 0.843 +- 0.339 (in-sample avg dev_std = 0.233)
SUFF_SIMPLE for r=0.2 all L1 = 0.886 +- 0.269 (in-sample avg dev_std = 0.233)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0674132
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.881
SUFF_SIMPLE for r=0.4 class 0.0 = 0.857 +- 0.333 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.929 +- 0.333 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.4 all KL = 0.848 +- 0.333 (in-sample avg dev_std = 0.251)
SUFF_SIMPLE for r=0.4 all L1 = 0.893 +- 0.257 (in-sample avg dev_std = 0.251)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.989
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0811432
len(reference) = 4986
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.872
SUFF_SIMPLE for r=0.8 class 0.0 = 0.982 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.812 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.882 +- 0.322 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.898 +- 0.278 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057848
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.0 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.003 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06810000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.993
NEC for r=0.1 class 0.0 = 0.01 +- 0.089 (in-sample avg dev_std = 0.043)
NEC for r=0.1 class 1.0 = 0.003 +- 0.089 (in-sample avg dev_std = 0.043)
NEC for r=0.1 all KL = 0.008 +- 0.089 (in-sample avg dev_std = 0.043)
NEC for r=0.1 all L1 = 0.006 +- 0.071 (in-sample avg dev_std = 0.043)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07681600000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.974
NEC for r=0.2 class 0.0 = 0.045 +- 0.183 (in-sample avg dev_std = 0.143)
NEC for r=0.2 class 1.0 = 0.012 +- 0.183 (in-sample avg dev_std = 0.143)
NEC for r=0.2 all KL = 0.041 +- 0.183 (in-sample avg dev_std = 0.143)
NEC for r=0.2 all L1 = 0.027 +- 0.134 (in-sample avg dev_std = 0.143)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.08120999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.949
NEC for r=0.4 class 0.0 = 0.111 +- 0.259 (in-sample avg dev_std = 0.249)
NEC for r=0.4 class 1.0 = 0.014 +- 0.259 (in-sample avg dev_std = 0.249)
NEC for r=0.4 all KL = 0.095 +- 0.259 (in-sample avg dev_std = 0.249)
NEC for r=0.4 all L1 = 0.057 +- 0.177 (in-sample avg dev_std = 0.249)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.083534
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.93
NEC for r=0.8 class 0.0 = 0.15 +- 0.314 (in-sample avg dev_std = 0.346)
NEC for r=0.8 class 1.0 = 0.033 +- 0.314 (in-sample avg dev_std = 0.346)
NEC for r=0.8 all KL = 0.149 +- 0.314 (in-sample avg dev_std = 0.346)
NEC for r=0.8 all L1 = 0.085 +- 0.203 (in-sample avg dev_std = 0.346)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.945
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092894
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.937
NEC for r=0.05 class 0.0 = 0.014 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.001 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.008 +- 0.078 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.945
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0092764
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.914
NEC for r=0.1 class 0.0 = 0.059 +- 0.189 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.003 +- 0.189 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.039 +- 0.189 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.031 +- 0.151 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.945
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009251599999999999
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.836
NEC for r=0.2 class 0.0 = 0.208 +- 0.341 (in-sample avg dev_std = 0.198)
NEC for r=0.2 class 1.0 = 0.01 +- 0.341 (in-sample avg dev_std = 0.198)
NEC for r=0.2 all KL = 0.147 +- 0.341 (in-sample avg dev_std = 0.198)
NEC for r=0.2 all L1 = 0.109 +- 0.262 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.945
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0092452
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.82
NEC for r=0.4 class 0.0 = 0.283 +- 0.393 (in-sample avg dev_std = 0.414)
NEC for r=0.4 class 1.0 = 0.012 +- 0.393 (in-sample avg dev_std = 0.414)
NEC for r=0.4 all KL = 0.231 +- 0.393 (in-sample avg dev_std = 0.414)
NEC for r=0.4 all L1 = 0.147 +- 0.266 (in-sample avg dev_std = 0.414)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.945
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0092438
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.819
NEC for r=0.8 class 0.0 = 0.29 +- 0.398 (in-sample avg dev_std = 0.431)
NEC for r=0.8 class 1.0 = 0.011 +- 0.398 (in-sample avg dev_std = 0.431)
NEC for r=0.8 all KL = 0.236 +- 0.398 (in-sample avg dev_std = 0.431)
NEC for r=0.8 all L1 = 0.149 +- 0.267 (in-sample avg dev_std = 0.431)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.988
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.035731200000000005
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.981
NEC for r=0.05 class 0.0 = 0.007 +- 0.088 (in-sample avg dev_std = 0.019)
NEC for r=0.05 class 1.0 = 0.007 +- 0.088 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all KL = 0.008 +- 0.088 (in-sample avg dev_std = 0.019)
NEC for r=0.05 all L1 = 0.007 +- 0.075 (in-sample avg dev_std = 0.019)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.988
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0443548
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.977
NEC for r=0.1 class 0.0 = 0.011 +- 0.113 (in-sample avg dev_std = 0.035)
NEC for r=0.1 class 1.0 = 0.012 +- 0.113 (in-sample avg dev_std = 0.035)
NEC for r=0.1 all KL = 0.013 +- 0.113 (in-sample avg dev_std = 0.035)
NEC for r=0.1 all L1 = 0.011 +- 0.095 (in-sample avg dev_std = 0.035)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.988
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05519400000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.971
NEC for r=0.2 class 0.0 = 0.024 +- 0.144 (in-sample avg dev_std = 0.068)
NEC for r=0.2 class 1.0 = 0.011 +- 0.144 (in-sample avg dev_std = 0.068)
NEC for r=0.2 all KL = 0.023 +- 0.144 (in-sample avg dev_std = 0.068)
NEC for r=0.2 all L1 = 0.018 +- 0.118 (in-sample avg dev_std = 0.068)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.988
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0674132
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.943
NEC for r=0.4 class 0.0 = 0.07 +- 0.221 (in-sample avg dev_std = 0.109)
NEC for r=0.4 class 1.0 = 0.016 +- 0.221 (in-sample avg dev_std = 0.109)
NEC for r=0.4 all KL = 0.055 +- 0.221 (in-sample avg dev_std = 0.109)
NEC for r=0.4 all L1 = 0.043 +- 0.180 (in-sample avg dev_std = 0.109)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.988
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0811432
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.912
NEC for r=0.8 class 0.0 = 0.114 +- 0.293 (in-sample avg dev_std = 0.208)
NEC for r=0.8 class 1.0 = 0.04 +- 0.293 (in-sample avg dev_std = 0.208)
NEC for r=0.8 all KL = 0.107 +- 0.293 (in-sample avg dev_std = 0.208)
NEC for r=0.8 all L1 = 0.078 +- 0.228 (in-sample avg dev_std = 0.208)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 23:35:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:35:17 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0036
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0036
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0037
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0036
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0037

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.054
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.074
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.034
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05356
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.841
SUFF_SIMPLE for r=0.05 class 0.0 = 0.749 +- 0.392 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.858 +- 0.392 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.05 all KL = 0.69 +- 0.392 (in-sample avg dev_std = 0.516)
SUFF_SIMPLE for r=0.05 all L1 = 0.81 +- 0.274 (in-sample avg dev_std = 0.516)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05660000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.828
SUFF_SIMPLE for r=0.1 class 0.0 = 0.774 +- 0.399 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.826 +- 0.399 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.1 all KL = 0.686 +- 0.399 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.1 all L1 = 0.802 +- 0.286 (in-sample avg dev_std = 0.493)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065534
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.836
SUFF_SIMPLE for r=0.2 class 0.0 = 0.787 +- 0.399 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.836 +- 0.399 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.2 all KL = 0.707 +- 0.399 (in-sample avg dev_std = 0.467)
SUFF_SIMPLE for r=0.2 all L1 = 0.814 +- 0.285 (in-sample avg dev_std = 0.467)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.074154
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.854
SUFF_SIMPLE for r=0.4 class 0.0 = 0.82 +- 0.380 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.855 +- 0.380 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.4 all KL = 0.751 +- 0.380 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.4 all L1 = 0.84 +- 0.277 (in-sample avg dev_std = 0.410)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.97
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.978 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.97 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.974 +- 0.147 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009666999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.745
SUFF_SIMPLE for r=0.05 class 0.0 = 0.601 +- 0.432 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.965 +- 0.432 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 all KL = 0.714 +- 0.432 (in-sample avg dev_std = 0.321)
SUFF_SIMPLE for r=0.05 all L1 = 0.785 +- 0.341 (in-sample avg dev_std = 0.321)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0096274
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.745
SUFF_SIMPLE for r=0.1 class 0.0 = 0.602 +- 0.432 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.963 +- 0.432 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.1 all KL = 0.711 +- 0.432 (in-sample avg dev_std = 0.329)
SUFF_SIMPLE for r=0.1 all L1 = 0.784 +- 0.340 (in-sample avg dev_std = 0.329)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096334
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.746
SUFF_SIMPLE for r=0.2 class 0.0 = 0.603 +- 0.432 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.963 +- 0.432 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.2 all KL = 0.713 +- 0.432 (in-sample avg dev_std = 0.326)
SUFF_SIMPLE for r=0.2 all L1 = 0.784 +- 0.340 (in-sample avg dev_std = 0.326)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009627600000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.746
SUFF_SIMPLE for r=0.4 class 0.0 = 0.602 +- 0.433 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.968 +- 0.433 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.4 all KL = 0.718 +- 0.433 (in-sample avg dev_std = 0.313)
SUFF_SIMPLE for r=0.4 all L1 = 0.786 +- 0.342 (in-sample avg dev_std = 0.313)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.821
SUFF_SIMPLE for r=0.8 class 0.0 = 0.932 +- 0.343 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.804 +- 0.343 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.852 +- 0.343 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.867 +- 0.302 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03395360000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.874
SUFF_SIMPLE for r=0.05 class 0.0 = 0.844 +- 0.358 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.896 +- 0.358 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.05 all KL = 0.816 +- 0.358 (in-sample avg dev_std = 0.318)
SUFF_SIMPLE for r=0.05 all L1 = 0.87 +- 0.275 (in-sample avg dev_std = 0.318)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042783
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.876
SUFF_SIMPLE for r=0.1 class 0.0 = 0.851 +- 0.350 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.9 +- 0.350 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.1 all KL = 0.829 +- 0.350 (in-sample avg dev_std = 0.277)
SUFF_SIMPLE for r=0.1 all L1 = 0.875 +- 0.275 (in-sample avg dev_std = 0.277)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052482400000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.874
SUFF_SIMPLE for r=0.2 class 0.0 = 0.855 +- 0.346 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.903 +- 0.346 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.2 all KL = 0.841 +- 0.346 (in-sample avg dev_std = 0.236)
SUFF_SIMPLE for r=0.2 all L1 = 0.879 +- 0.279 (in-sample avg dev_std = 0.236)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06523179999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.89
SUFF_SIMPLE for r=0.4 class 0.0 = 0.905 +- 0.326 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.884 +- 0.326 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all KL = 0.866 +- 0.326 (in-sample avg dev_std = 0.183)
SUFF_SIMPLE for r=0.4 all L1 = 0.894 +- 0.268 (in-sample avg dev_std = 0.183)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07869480000000001
len(reference) = 4979
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.915
SUFF_SIMPLE for r=0.8 class 0.0 = 0.986 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.87 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.917 +- 0.274 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.928 +- 0.237 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.05356
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.998
NEC for r=0.05 class 0.0 = 0.004 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.0 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.002 +- 0.045 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.002 +- 0.039 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05660000000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.99
NEC for r=0.1 class 0.0 = 0.015 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.003 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.01 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.009 +- 0.085 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065534
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.985
NEC for r=0.2 class 0.0 = 0.023 +- 0.139 (in-sample avg dev_std = 0.123)
NEC for r=0.2 class 1.0 = 0.009 +- 0.139 (in-sample avg dev_std = 0.123)
NEC for r=0.2 all KL = 0.023 +- 0.139 (in-sample avg dev_std = 0.123)
NEC for r=0.2 all L1 = 0.016 +- 0.102 (in-sample avg dev_std = 0.123)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.074154
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.947
NEC for r=0.4 class 0.0 = 0.055 +- 0.258 (in-sample avg dev_std = 0.255)
NEC for r=0.4 class 1.0 = 0.062 +- 0.258 (in-sample avg dev_std = 0.255)
NEC for r=0.4 all KL = 0.093 +- 0.258 (in-sample avg dev_std = 0.255)
NEC for r=0.4 all L1 = 0.059 +- 0.182 (in-sample avg dev_std = 0.255)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078708
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.924
NEC for r=0.8 class 0.0 = 0.086 +- 0.317 (in-sample avg dev_std = 0.389)
NEC for r=0.8 class 1.0 = 0.105 +- 0.317 (in-sample avg dev_std = 0.389)
NEC for r=0.8 all KL = 0.169 +- 0.317 (in-sample avg dev_std = 0.389)
NEC for r=0.8 all L1 = 0.097 +- 0.203 (in-sample avg dev_std = 0.389)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009666999999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.964
NEC for r=0.05 class 0.0 = 0.006 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.004 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.005 +- 0.071 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.005 +- 0.061 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0096274
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.946
NEC for r=0.1 class 0.0 = 0.011 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.032 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.024 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.022 +- 0.129 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0096334
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.831
NEC for r=0.2 class 0.0 = 0.06 +- 0.354 (in-sample avg dev_std = 0.280)
NEC for r=0.2 class 1.0 = 0.217 +- 0.354 (in-sample avg dev_std = 0.280)
NEC for r=0.2 all KL = 0.179 +- 0.354 (in-sample avg dev_std = 0.280)
NEC for r=0.2 all L1 = 0.139 +- 0.283 (in-sample avg dev_std = 0.280)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009627600000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.824
NEC for r=0.4 class 0.0 = 0.102 +- 0.375 (in-sample avg dev_std = 0.586)
NEC for r=0.4 class 1.0 = 0.294 +- 0.375 (in-sample avg dev_std = 0.586)
NEC for r=0.4 all KL = 0.336 +- 0.375 (in-sample avg dev_std = 0.586)
NEC for r=0.4 all L1 = 0.199 +- 0.233 (in-sample avg dev_std = 0.586)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009625
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.825
NEC for r=0.8 class 0.0 = 0.111 +- 0.366 (in-sample avg dev_std = 0.612)
NEC for r=0.8 class 1.0 = 0.299 +- 0.366 (in-sample avg dev_std = 0.612)
NEC for r=0.8 all KL = 0.36 +- 0.366 (in-sample avg dev_std = 0.612)
NEC for r=0.8 all L1 = 0.206 +- 0.217 (in-sample avg dev_std = 0.612)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03395360000000001
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.98
NEC for r=0.05 class 0.0 = 0.008 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.01 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.099 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.009 +- 0.087 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042783
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.979
NEC for r=0.1 class 0.0 = 0.011 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.015 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.015 +- 0.119 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.013 +- 0.103 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052482400000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.971
NEC for r=0.2 class 0.0 = 0.017 +- 0.157 (in-sample avg dev_std = 0.025)
NEC for r=0.2 class 1.0 = 0.028 +- 0.157 (in-sample avg dev_std = 0.025)
NEC for r=0.2 all KL = 0.026 +- 0.157 (in-sample avg dev_std = 0.025)
NEC for r=0.2 all L1 = 0.022 +- 0.136 (in-sample avg dev_std = 0.025)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06523179999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.943
NEC for r=0.4 class 0.0 = 0.046 +- 0.232 (in-sample avg dev_std = 0.078)
NEC for r=0.4 class 1.0 = 0.054 +- 0.232 (in-sample avg dev_std = 0.078)
NEC for r=0.4 all KL = 0.059 +- 0.232 (in-sample avg dev_std = 0.078)
NEC for r=0.4 all L1 = 0.05 +- 0.197 (in-sample avg dev_std = 0.078)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07869480000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.912
NEC for r=0.8 class 0.0 = 0.099 +- 0.306 (in-sample avg dev_std = 0.252)
NEC for r=0.8 class 1.0 = 0.078 +- 0.306 (in-sample avg dev_std = 0.252)
NEC for r=0.8 all KL = 0.125 +- 0.306 (in-sample avg dev_std = 0.252)
NEC for r=0.8 all L1 = 0.089 +- 0.235 (in-sample avg dev_std = 0.252)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Wed Jan 15 23:50:31 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/15/2025 11:50:31 PM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 67 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 67...
[0m[1;37mINFO[0m: [1mCheckpoint 67: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0028
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0028
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0029
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0028
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0029

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.057
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.059
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.072
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.011
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.011
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057002000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.702
SUFF_SIMPLE for r=0.05 class 0.0 = 0.875 +- 0.443 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.487 +- 0.443 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.05 all KL = 0.489 +- 0.443 (in-sample avg dev_std = 0.670)
SUFF_SIMPLE for r=0.05 all L1 = 0.66 +- 0.327 (in-sample avg dev_std = 0.670)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05931
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.716
SUFF_SIMPLE for r=0.1 class 0.0 = 0.87 +- 0.440 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.528 +- 0.440 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.1 all KL = 0.52 +- 0.440 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.1 all L1 = 0.68 +- 0.328 (in-sample avg dev_std = 0.632)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.713
SUFF_SIMPLE for r=0.2 class 0.0 = 0.89 +- 0.450 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.516 +- 0.450 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.2 all KL = 0.534 +- 0.450 (in-sample avg dev_std = 0.614)
SUFF_SIMPLE for r=0.2 all L1 = 0.683 +- 0.337 (in-sample avg dev_std = 0.614)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076754
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.709
SUFF_SIMPLE for r=0.4 class 0.0 = 0.944 +- 0.456 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.494 +- 0.456 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.4 all KL = 0.57 +- 0.456 (in-sample avg dev_std = 0.537)
SUFF_SIMPLE for r=0.4 all L1 = 0.695 +- 0.352 (in-sample avg dev_std = 0.537)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079788
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.88
SUFF_SIMPLE for r=0.8 class 0.0 = 0.984 +- 0.326 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.326 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.878 +- 0.326 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.895 +- 0.281 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010604599999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.735
SUFF_SIMPLE for r=0.05 class 0.0 = 0.721 +- 0.406 (in-sample avg dev_std = 0.721)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.628 +- 0.406 (in-sample avg dev_std = 0.721)
SUFF_SIMPLE for r=0.05 all KL = 0.491 +- 0.406 (in-sample avg dev_std = 0.721)
SUFF_SIMPLE for r=0.05 all L1 = 0.674 +- 0.280 (in-sample avg dev_std = 0.721)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010598999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.731
SUFF_SIMPLE for r=0.1 class 0.0 = 0.712 +- 0.408 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.63 +- 0.408 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.1 all KL = 0.488 +- 0.408 (in-sample avg dev_std = 0.722)
SUFF_SIMPLE for r=0.1 all L1 = 0.671 +- 0.282 (in-sample avg dev_std = 0.722)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010568200000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.737
SUFF_SIMPLE for r=0.2 class 0.0 = 0.717 +- 0.409 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.639 +- 0.409 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.2 all KL = 0.499 +- 0.409 (in-sample avg dev_std = 0.713)
SUFF_SIMPLE for r=0.2 all L1 = 0.678 +- 0.283 (in-sample avg dev_std = 0.713)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01055
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.732
SUFF_SIMPLE for r=0.4 class 0.0 = 0.726 +- 0.420 (in-sample avg dev_std = 0.669)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.647 +- 0.420 (in-sample avg dev_std = 0.669)
SUFF_SIMPLE for r=0.4 all KL = 0.526 +- 0.420 (in-sample avg dev_std = 0.669)
SUFF_SIMPLE for r=0.4 all L1 = 0.686 +- 0.300 (in-sample avg dev_std = 0.669)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0105494
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.802
SUFF_SIMPLE for r=0.8 class 0.0 = 0.969 +- 0.385 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.695 +- 0.385 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.808 +- 0.385 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.831 +- 0.338 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0329248
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.821
SUFF_SIMPLE for r=0.05 class 0.0 = 0.878 +- 0.405 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.757 +- 0.405 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.05 all KL = 0.748 +- 0.405 (in-sample avg dev_std = 0.379)
SUFF_SIMPLE for r=0.05 all L1 = 0.818 +- 0.314 (in-sample avg dev_std = 0.379)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0423122
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.829
SUFF_SIMPLE for r=0.1 class 0.0 = 0.875 +- 0.396 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.783 +- 0.396 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all KL = 0.772 +- 0.396 (in-sample avg dev_std = 0.324)
SUFF_SIMPLE for r=0.1 all L1 = 0.83 +- 0.314 (in-sample avg dev_std = 0.324)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053900199999999995
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.833
SUFF_SIMPLE for r=0.2 class 0.0 = 0.879 +- 0.391 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.791 +- 0.391 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all KL = 0.788 +- 0.391 (in-sample avg dev_std = 0.268)
SUFF_SIMPLE for r=0.2 all L1 = 0.835 +- 0.319 (in-sample avg dev_std = 0.268)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0656808
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.831
SUFF_SIMPLE for r=0.4 class 0.0 = 0.954 +- 0.382 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.729 +- 0.382 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all KL = 0.802 +- 0.382 (in-sample avg dev_std = 0.211)
SUFF_SIMPLE for r=0.4 all L1 = 0.843 +- 0.317 (in-sample avg dev_std = 0.211)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.981
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791548
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.901
SUFF_SIMPLE for r=0.8 class 0.0 = 0.993 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.836 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.903 +- 0.295 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.915 +- 0.255 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057002000000000004
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.976
NEC for r=0.05 class 0.0 = 0.0 +- 0.155 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.039 +- 0.155 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.025 +- 0.155 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.022 +- 0.132 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05931
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.951
NEC for r=0.1 class 0.0 = 0.007 +- 0.221 (in-sample avg dev_std = 0.070)
NEC for r=0.1 class 1.0 = 0.075 +- 0.221 (in-sample avg dev_std = 0.070)
NEC for r=0.1 all KL = 0.053 +- 0.221 (in-sample avg dev_std = 0.070)
NEC for r=0.1 all L1 = 0.044 +- 0.186 (in-sample avg dev_std = 0.070)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0717
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.897
NEC for r=0.2 class 0.0 = 0.013 +- 0.326 (in-sample avg dev_std = 0.237)
NEC for r=0.2 class 1.0 = 0.172 +- 0.326 (in-sample avg dev_std = 0.237)
NEC for r=0.2 all KL = 0.137 +- 0.326 (in-sample avg dev_std = 0.237)
NEC for r=0.2 all L1 = 0.101 +- 0.256 (in-sample avg dev_std = 0.237)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076754
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.853
NEC for r=0.4 class 0.0 = 0.017 +- 0.390 (in-sample avg dev_std = 0.422)
NEC for r=0.4 class 1.0 = 0.278 +- 0.390 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all KL = 0.242 +- 0.390 (in-sample avg dev_std = 0.422)
NEC for r=0.4 all L1 = 0.162 +- 0.285 (in-sample avg dev_std = 0.422)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079788
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.822
NEC for r=0.8 class 0.0 = 0.035 +- 0.418 (in-sample avg dev_std = 0.541)
NEC for r=0.8 class 1.0 = 0.351 +- 0.418 (in-sample avg dev_std = 0.541)
NEC for r=0.8 all KL = 0.329 +- 0.418 (in-sample avg dev_std = 0.541)
NEC for r=0.8 all L1 = 0.21 +- 0.294 (in-sample avg dev_std = 0.541)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010604599999999999
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.992
NEC for r=0.05 class 0.0 = 0.002 +- 0.089 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.013 +- 0.089 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.008 +- 0.089 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.007 +- 0.078 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010598999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.949
NEC for r=0.1 class 0.0 = 0.008 +- 0.213 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.078 +- 0.213 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.05 +- 0.213 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.044 +- 0.186 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010568200000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.813
NEC for r=0.2 class 0.0 = 0.028 +- 0.389 (in-sample avg dev_std = 0.293)
NEC for r=0.2 class 1.0 = 0.322 +- 0.389 (in-sample avg dev_std = 0.293)
NEC for r=0.2 all KL = 0.221 +- 0.389 (in-sample avg dev_std = 0.293)
NEC for r=0.2 all L1 = 0.176 +- 0.321 (in-sample avg dev_std = 0.293)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.01055
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.794
NEC for r=0.4 class 0.0 = 0.06 +- 0.403 (in-sample avg dev_std = 0.618)
NEC for r=0.4 class 1.0 = 0.437 +- 0.403 (in-sample avg dev_std = 0.618)
NEC for r=0.4 all KL = 0.386 +- 0.403 (in-sample avg dev_std = 0.618)
NEC for r=0.4 all L1 = 0.25 +- 0.283 (in-sample avg dev_std = 0.618)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0105494
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.798
NEC for r=0.8 class 0.0 = 0.06 +- 0.399 (in-sample avg dev_std = 0.654)
NEC for r=0.8 class 1.0 = 0.45 +- 0.399 (in-sample avg dev_std = 0.654)
NEC for r=0.8 all KL = 0.407 +- 0.399 (in-sample avg dev_std = 0.654)
NEC for r=0.8 all L1 = 0.256 +- 0.271 (in-sample avg dev_std = 0.654)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.98
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0329248
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.966
NEC for r=0.05 class 0.0 = 0.004 +- 0.147 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.037 +- 0.147 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.023 +- 0.147 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.02 +- 0.128 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.98
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0423122
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.959
NEC for r=0.1 class 0.0 = 0.005 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.054 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.034 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.029 +- 0.155 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.98
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.053900199999999995
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.944
NEC for r=0.2 class 0.0 = 0.009 +- 0.225 (in-sample avg dev_std = 0.053)
NEC for r=0.2 class 1.0 = 0.086 +- 0.225 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all KL = 0.055 +- 0.225 (in-sample avg dev_std = 0.053)
NEC for r=0.2 all L1 = 0.047 +- 0.193 (in-sample avg dev_std = 0.053)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.98
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0656808
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.898
NEC for r=0.4 class 0.0 = 0.017 +- 0.306 (in-sample avg dev_std = 0.123)
NEC for r=0.4 class 1.0 = 0.167 +- 0.306 (in-sample avg dev_std = 0.123)
NEC for r=0.4 all KL = 0.11 +- 0.306 (in-sample avg dev_std = 0.123)
NEC for r=0.4 all L1 = 0.091 +- 0.258 (in-sample avg dev_std = 0.123)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.98
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0791548
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.873
NEC for r=0.8 class 0.0 = 0.075 +- 0.364 (in-sample avg dev_std = 0.309)
NEC for r=0.8 class 1.0 = 0.191 +- 0.364 (in-sample avg dev_std = 0.309)
NEC for r=0.8 all KL = 0.182 +- 0.364 (in-sample avg dev_std = 0.309)
NEC for r=0.8 all L1 = 0.133 +- 0.282 (in-sample avg dev_std = 0.309)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 00:05:41 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 12:05:41 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 72 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 72...
[0m[1;37mINFO[0m: [1mCheckpoint 72: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0145
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0144
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0147
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0144
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0147

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.044
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.068
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.076
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.009
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.009
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.029
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.036
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.046
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044073999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.798
SUFF_SIMPLE for r=0.05 class 0.0 = 0.812 +- 0.401 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.707 +- 0.401 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.05 all KL = 0.622 +- 0.401 (in-sample avg dev_std = 0.601)
SUFF_SIMPLE for r=0.05 all L1 = 0.754 +- 0.287 (in-sample avg dev_std = 0.601)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057314
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.796
SUFF_SIMPLE for r=0.1 class 0.0 = 0.823 +- 0.402 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.71 +- 0.402 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.1 all KL = 0.642 +- 0.402 (in-sample avg dev_std = 0.564)
SUFF_SIMPLE for r=0.1 all L1 = 0.76 +- 0.296 (in-sample avg dev_std = 0.564)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.068084
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.807
SUFF_SIMPLE for r=0.2 class 0.0 = 0.818 +- 0.402 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.736 +- 0.402 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.2 all KL = 0.658 +- 0.402 (in-sample avg dev_std = 0.551)
SUFF_SIMPLE for r=0.2 all L1 = 0.772 +- 0.292 (in-sample avg dev_std = 0.551)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07598400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.823
SUFF_SIMPLE for r=0.4 class 0.0 = 0.862 +- 0.390 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.746 +- 0.390 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.4 all KL = 0.701 +- 0.390 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.4 all L1 = 0.798 +- 0.289 (in-sample avg dev_std = 0.488)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.906
SUFF_SIMPLE for r=0.8 class 0.0 = 0.97 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.874 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.904 +- 0.289 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.917 +- 0.250 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.675
SUFF_SIMPLE for r=0.05 class 0.0 = 0.735 +- 0.389 (in-sample avg dev_std = 0.412)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.879 +- 0.389 (in-sample avg dev_std = 0.412)
SUFF_SIMPLE for r=0.05 all KL = 0.74 +- 0.389 (in-sample avg dev_std = 0.412)
SUFF_SIMPLE for r=0.05 all L1 = 0.808 +- 0.305 (in-sample avg dev_std = 0.412)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093206
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.678
SUFF_SIMPLE for r=0.1 class 0.0 = 0.734 +- 0.389 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.886 +- 0.389 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 all KL = 0.744 +- 0.389 (in-sample avg dev_std = 0.403)
SUFF_SIMPLE for r=0.1 all L1 = 0.81 +- 0.306 (in-sample avg dev_std = 0.403)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094224
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.678
SUFF_SIMPLE for r=0.2 class 0.0 = 0.735 +- 0.387 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.886 +- 0.387 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.2 all KL = 0.745 +- 0.387 (in-sample avg dev_std = 0.402)
SUFF_SIMPLE for r=0.2 all L1 = 0.811 +- 0.304 (in-sample avg dev_std = 0.402)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094386
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.674
SUFF_SIMPLE for r=0.4 class 0.0 = 0.736 +- 0.389 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.884 +- 0.389 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 all KL = 0.748 +- 0.389 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.4 all L1 = 0.811 +- 0.309 (in-sample avg dev_std = 0.386)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0094424
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.591
SUFF_SIMPLE for r=0.8 class 0.0 = 0.993 +- 0.410 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.596 +- 0.410 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.768 +- 0.410 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.793 +- 0.358 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029376999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.862
SUFF_SIMPLE for r=0.05 class 0.0 = 0.844 +- 0.358 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.876 +- 0.358 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.05 all KL = 0.811 +- 0.358 (in-sample avg dev_std = 0.330)
SUFF_SIMPLE for r=0.05 all L1 = 0.86 +- 0.282 (in-sample avg dev_std = 0.330)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0362364
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.861
SUFF_SIMPLE for r=0.1 class 0.0 = 0.85 +- 0.355 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.877 +- 0.355 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.1 all KL = 0.821 +- 0.355 (in-sample avg dev_std = 0.291)
SUFF_SIMPLE for r=0.1 all L1 = 0.863 +- 0.285 (in-sample avg dev_std = 0.291)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.046014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.86
SUFF_SIMPLE for r=0.2 class 0.0 = 0.857 +- 0.349 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.883 +- 0.349 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.2 all KL = 0.835 +- 0.349 (in-sample avg dev_std = 0.247)
SUFF_SIMPLE for r=0.2 all L1 = 0.87 +- 0.287 (in-sample avg dev_std = 0.247)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05965340000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.867
SUFF_SIMPLE for r=0.4 class 0.0 = 0.894 +- 0.339 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.866 +- 0.339 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all KL = 0.854 +- 0.339 (in-sample avg dev_std = 0.181)
SUFF_SIMPLE for r=0.4 all L1 = 0.88 +- 0.284 (in-sample avg dev_std = 0.181)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.985
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0769752
len(reference) = 4955
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.955
SUFF_SIMPLE for r=0.8 class 0.0 = 0.985 +- 0.193 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.945 +- 0.193 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 all KL = 0.96 +- 0.193 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.8 all L1 = 0.965 +- 0.167 (in-sample avg dev_std = 0.010)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.044073999999999995
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.996
NEC for r=0.05 class 0.0 = 0.0 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.006 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.004 +- 0.059 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.003 +- 0.052 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057314
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.972
NEC for r=0.1 class 0.0 = 0.006 +- 0.165 (in-sample avg dev_std = 0.031)
NEC for r=0.1 class 1.0 = 0.041 +- 0.165 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all KL = 0.029 +- 0.165 (in-sample avg dev_std = 0.031)
NEC for r=0.1 all L1 = 0.025 +- 0.142 (in-sample avg dev_std = 0.031)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.068084
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.933
NEC for r=0.2 class 0.0 = 0.007 +- 0.276 (in-sample avg dev_std = 0.263)
NEC for r=0.2 class 1.0 = 0.128 +- 0.276 (in-sample avg dev_std = 0.263)
NEC for r=0.2 all KL = 0.102 +- 0.276 (in-sample avg dev_std = 0.263)
NEC for r=0.2 all L1 = 0.074 +- 0.209 (in-sample avg dev_std = 0.263)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07598400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.897
NEC for r=0.4 class 0.0 = 0.056 +- 0.331 (in-sample avg dev_std = 0.386)
NEC for r=0.4 class 1.0 = 0.171 +- 0.331 (in-sample avg dev_std = 0.386)
NEC for r=0.4 all KL = 0.177 +- 0.331 (in-sample avg dev_std = 0.386)
NEC for r=0.4 all L1 = 0.12 +- 0.241 (in-sample avg dev_std = 0.386)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08056
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.881
NEC for r=0.8 class 0.0 = 0.069 +- 0.357 (in-sample avg dev_std = 0.490)
NEC for r=0.8 class 1.0 = 0.219 +- 0.357 (in-sample avg dev_std = 0.490)
NEC for r=0.8 all KL = 0.242 +- 0.357 (in-sample avg dev_std = 0.490)
NEC for r=0.8 all L1 = 0.152 +- 0.243 (in-sample avg dev_std = 0.490)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.818
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092006
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.716
NEC for r=0.05 class 0.0 = 0.0 +- 0.296 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.188 +- 0.296 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.105 +- 0.296 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.095 +- 0.261 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.818
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093206
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.621
NEC for r=0.1 class 0.0 = 0.001 +- 0.387 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.352 +- 0.387 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.198 +- 0.387 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.178 +- 0.339 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.818
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094224
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.584
NEC for r=0.2 class 0.0 = 0.007 +- 0.416 (in-sample avg dev_std = 0.198)
NEC for r=0.2 class 1.0 = 0.428 +- 0.416 (in-sample avg dev_std = 0.198)
NEC for r=0.2 all KL = 0.252 +- 0.416 (in-sample avg dev_std = 0.198)
NEC for r=0.2 all L1 = 0.219 +- 0.358 (in-sample avg dev_std = 0.198)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.818
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0094386
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.594
NEC for r=0.4 class 0.0 = 0.017 +- 0.422 (in-sample avg dev_std = 0.466)
NEC for r=0.4 class 1.0 = 0.463 +- 0.422 (in-sample avg dev_std = 0.466)
NEC for r=0.4 all KL = 0.308 +- 0.422 (in-sample avg dev_std = 0.466)
NEC for r=0.4 all L1 = 0.241 +- 0.336 (in-sample avg dev_std = 0.466)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.818
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0094424
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.596
NEC for r=0.8 class 0.0 = 0.02 +- 0.424 (in-sample avg dev_std = 0.503)
NEC for r=0.8 class 1.0 = 0.47 +- 0.424 (in-sample avg dev_std = 0.503)
NEC for r=0.8 all KL = 0.32 +- 0.424 (in-sample avg dev_std = 0.503)
NEC for r=0.8 all L1 = 0.247 +- 0.333 (in-sample avg dev_std = 0.503)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.984
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029376999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.98
NEC for r=0.05 class 0.0 = 0.007 +- 0.103 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.013 +- 0.103 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.011 +- 0.103 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.01 +- 0.090 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.984
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0362364
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.976
NEC for r=0.1 class 0.0 = 0.011 +- 0.123 (in-sample avg dev_std = 0.017)
NEC for r=0.1 class 1.0 = 0.017 +- 0.123 (in-sample avg dev_std = 0.017)
NEC for r=0.1 all KL = 0.016 +- 0.123 (in-sample avg dev_std = 0.017)
NEC for r=0.1 all L1 = 0.014 +- 0.107 (in-sample avg dev_std = 0.017)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.984
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.046014
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.964
NEC for r=0.2 class 0.0 = 0.019 +- 0.165 (in-sample avg dev_std = 0.036)
NEC for r=0.2 class 1.0 = 0.032 +- 0.165 (in-sample avg dev_std = 0.036)
NEC for r=0.2 all KL = 0.029 +- 0.165 (in-sample avg dev_std = 0.036)
NEC for r=0.2 all L1 = 0.025 +- 0.142 (in-sample avg dev_std = 0.036)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.984
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.05965340000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.926
NEC for r=0.4 class 0.0 = 0.045 +- 0.255 (in-sample avg dev_std = 0.097)
NEC for r=0.4 class 1.0 = 0.08 +- 0.255 (in-sample avg dev_std = 0.097)
NEC for r=0.4 all KL = 0.074 +- 0.255 (in-sample avg dev_std = 0.097)
NEC for r=0.4 all L1 = 0.062 +- 0.217 (in-sample avg dev_std = 0.097)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.984
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0769752
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.905
NEC for r=0.8 class 0.0 = 0.094 +- 0.307 (in-sample avg dev_std = 0.273)
NEC for r=0.8 class 1.0 = 0.095 +- 0.307 (in-sample avg dev_std = 0.273)
NEC for r=0.8 all KL = 0.129 +- 0.307 (in-sample avg dev_std = 0.273)
NEC for r=0.8 all L1 = 0.094 +- 0.239 (in-sample avg dev_std = 0.273)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 00:20:51 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 12:20:52 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0095
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0097
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0096
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0097
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0096

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.048
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.058
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.065
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.075
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.011
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.011
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.011
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.011
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.011
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.025
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.033
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.043
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.058
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04773600000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.774
SUFF_SIMPLE for r=0.05 class 0.0 = 0.732 +- 0.407 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.747 +- 0.407 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.05 all KL = 0.621 +- 0.407 (in-sample avg dev_std = 0.543)
SUFF_SIMPLE for r=0.05 all L1 = 0.741 +- 0.307 (in-sample avg dev_std = 0.543)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057894
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.786
SUFF_SIMPLE for r=0.1 class 0.0 = 0.723 +- 0.405 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.785 +- 0.405 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.1 all KL = 0.652 +- 0.405 (in-sample avg dev_std = 0.502)
SUFF_SIMPLE for r=0.1 all L1 = 0.757 +- 0.309 (in-sample avg dev_std = 0.502)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065108
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.786
SUFF_SIMPLE for r=0.2 class 0.0 = 0.715 +- 0.410 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.803 +- 0.410 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.2 all KL = 0.664 +- 0.410 (in-sample avg dev_std = 0.488)
SUFF_SIMPLE for r=0.2 all L1 = 0.764 +- 0.310 (in-sample avg dev_std = 0.488)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07490999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.823
SUFF_SIMPLE for r=0.4 class 0.0 = 0.766 +- 0.398 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.836 +- 0.398 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.4 all KL = 0.725 +- 0.398 (in-sample avg dev_std = 0.440)
SUFF_SIMPLE for r=0.4 all L1 = 0.805 +- 0.300 (in-sample avg dev_std = 0.440)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08053
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.922
SUFF_SIMPLE for r=0.8 class 0.0 = 0.929 +- 0.268 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.932 +- 0.268 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.92 +- 0.268 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.93 +- 0.230 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010719800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.683
SUFF_SIMPLE for r=0.05 class 0.0 = 0.649 +- 0.402 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.984 +- 0.402 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 all KL = 0.76 +- 0.402 (in-sample avg dev_std = 0.206)
SUFF_SIMPLE for r=0.05 all L1 = 0.818 +- 0.324 (in-sample avg dev_std = 0.206)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0107042
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.683
SUFF_SIMPLE for r=0.1 class 0.0 = 0.649 +- 0.402 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.983 +- 0.402 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.1 all KL = 0.758 +- 0.402 (in-sample avg dev_std = 0.214)
SUFF_SIMPLE for r=0.1 all L1 = 0.817 +- 0.324 (in-sample avg dev_std = 0.214)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010694
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.682
SUFF_SIMPLE for r=0.2 class 0.0 = 0.648 +- 0.402 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.985 +- 0.402 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all KL = 0.76 +- 0.402 (in-sample avg dev_std = 0.200)
SUFF_SIMPLE for r=0.2 all L1 = 0.818 +- 0.325 (in-sample avg dev_std = 0.200)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.683
SUFF_SIMPLE for r=0.4 class 0.0 = 0.649 +- 0.402 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.984 +- 0.402 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 all KL = 0.76 +- 0.402 (in-sample avg dev_std = 0.201)
SUFF_SIMPLE for r=0.4 all L1 = 0.818 +- 0.325 (in-sample avg dev_std = 0.201)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.77
SUFF_SIMPLE for r=0.8 class 0.0 = 0.844 +- 0.306 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.966 +- 0.306 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.882 +- 0.306 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.905 +- 0.251 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024968
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.76
SUFF_SIMPLE for r=0.05 class 0.0 = 0.882 +- 0.416 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.582 +- 0.416 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.05 all KL = 0.634 +- 0.416 (in-sample avg dev_std = 0.507)
SUFF_SIMPLE for r=0.05 all L1 = 0.734 +- 0.323 (in-sample avg dev_std = 0.507)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03285
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.777
SUFF_SIMPLE for r=0.1 class 0.0 = 0.862 +- 0.411 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.648 +- 0.411 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.1 all KL = 0.665 +- 0.411 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.1 all L1 = 0.756 +- 0.320 (in-sample avg dev_std = 0.474)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043273200000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.781
SUFF_SIMPLE for r=0.2 class 0.0 = 0.844 +- 0.412 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.684 +- 0.412 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.2 all KL = 0.679 +- 0.412 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.2 all L1 = 0.765 +- 0.321 (in-sample avg dev_std = 0.460)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0580568
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.77
SUFF_SIMPLE for r=0.4 class 0.0 = 0.87 +- 0.427 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.662 +- 0.427 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.4 all KL = 0.7 +- 0.427 (in-sample avg dev_std = 0.433)
SUFF_SIMPLE for r=0.4 all L1 = 0.768 +- 0.339 (in-sample avg dev_std = 0.433)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.991
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0773802
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.808
SUFF_SIMPLE for r=0.8 class 0.0 = 0.98 +- 0.384 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.693 +- 0.384 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.815 +- 0.384 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.838 +- 0.334 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.04773600000000001
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.988
NEC for r=0.05 class 0.0 = 0.0 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.019 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.012 +- 0.108 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.01 +- 0.094 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.057894
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.97
NEC for r=0.1 class 0.0 = 0.011 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.04 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.031 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.027 +- 0.147 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.065108
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.955
NEC for r=0.2 class 0.0 = 0.036 +- 0.224 (in-sample avg dev_std = 0.169)
NEC for r=0.2 class 1.0 = 0.052 +- 0.224 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all KL = 0.059 +- 0.224 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all L1 = 0.045 +- 0.175 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07490999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.927
NEC for r=0.4 class 0.0 = 0.073 +- 0.291 (in-sample avg dev_std = 0.303)
NEC for r=0.4 class 1.0 = 0.091 +- 0.291 (in-sample avg dev_std = 0.303)
NEC for r=0.4 all KL = 0.124 +- 0.291 (in-sample avg dev_std = 0.303)
NEC for r=0.4 all L1 = 0.083 +- 0.211 (in-sample avg dev_std = 0.303)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08053
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.895
NEC for r=0.8 class 0.0 = 0.118 +- 0.334 (in-sample avg dev_std = 0.455)
NEC for r=0.8 class 1.0 = 0.153 +- 0.334 (in-sample avg dev_std = 0.455)
NEC for r=0.8 all KL = 0.223 +- 0.334 (in-sample avg dev_std = 0.455)
NEC for r=0.8 all L1 = 0.137 +- 0.225 (in-sample avg dev_std = 0.455)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.864
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.010719800000000002
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.855
NEC for r=0.05 class 0.0 = 0.009 +- 0.097 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.007 +- 0.097 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.01 +- 0.097 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.008 +- 0.081 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.864
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0107042
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.839
NEC for r=0.1 class 0.0 = 0.037 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.015 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.031 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.026 +- 0.138 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.864
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010694
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.773
NEC for r=0.2 class 0.0 = 0.159 +- 0.311 (in-sample avg dev_std = 0.191)
NEC for r=0.2 class 1.0 = 0.038 +- 0.311 (in-sample avg dev_std = 0.191)
NEC for r=0.2 all KL = 0.127 +- 0.311 (in-sample avg dev_std = 0.191)
NEC for r=0.2 all L1 = 0.098 +- 0.246 (in-sample avg dev_std = 0.191)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.864
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.76
NEC for r=0.4 class 0.0 = 0.221 +- 0.354 (in-sample avg dev_std = 0.429)
NEC for r=0.4 class 1.0 = 0.058 +- 0.354 (in-sample avg dev_std = 0.429)
NEC for r=0.4 all KL = 0.22 +- 0.354 (in-sample avg dev_std = 0.429)
NEC for r=0.4 all L1 = 0.139 +- 0.237 (in-sample avg dev_std = 0.429)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.864
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.010692400000000001
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.763
NEC for r=0.8 class 0.0 = 0.22 +- 0.350 (in-sample avg dev_std = 0.453)
NEC for r=0.8 class 1.0 = 0.063 +- 0.350 (in-sample avg dev_std = 0.453)
NEC for r=0.8 all KL = 0.232 +- 0.350 (in-sample avg dev_std = 0.453)
NEC for r=0.8 all L1 = 0.141 +- 0.225 (in-sample avg dev_std = 0.453)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.99
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.024968
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.974
NEC for r=0.05 class 0.0 = 0.01 +- 0.132 (in-sample avg dev_std = 0.013)
NEC for r=0.05 class 1.0 = 0.023 +- 0.132 (in-sample avg dev_std = 0.013)
NEC for r=0.05 all KL = 0.019 +- 0.132 (in-sample avg dev_std = 0.013)
NEC for r=0.05 all L1 = 0.017 +- 0.116 (in-sample avg dev_std = 0.013)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.99
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.03285
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.961
NEC for r=0.1 class 0.0 = 0.013 +- 0.175 (in-sample avg dev_std = 0.052)
NEC for r=0.1 class 1.0 = 0.045 +- 0.175 (in-sample avg dev_std = 0.052)
NEC for r=0.1 all KL = 0.033 +- 0.175 (in-sample avg dev_std = 0.052)
NEC for r=0.1 all L1 = 0.029 +- 0.151 (in-sample avg dev_std = 0.052)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.99
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.043273200000000005
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.942
NEC for r=0.2 class 0.0 = 0.021 +- 0.224 (in-sample avg dev_std = 0.136)
NEC for r=0.2 class 1.0 = 0.075 +- 0.224 (in-sample avg dev_std = 0.136)
NEC for r=0.2 all KL = 0.057 +- 0.224 (in-sample avg dev_std = 0.136)
NEC for r=0.2 all L1 = 0.048 +- 0.186 (in-sample avg dev_std = 0.136)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.99
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0580568
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.904
NEC for r=0.4 class 0.0 = 0.059 +- 0.300 (in-sample avg dev_std = 0.241)
NEC for r=0.4 class 1.0 = 0.124 +- 0.300 (in-sample avg dev_std = 0.241)
NEC for r=0.4 all KL = 0.118 +- 0.300 (in-sample avg dev_std = 0.241)
NEC for r=0.4 all L1 = 0.091 +- 0.239 (in-sample avg dev_std = 0.241)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.99
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0773802
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.849
NEC for r=0.8 class 0.0 = 0.108 +- 0.372 (in-sample avg dev_std = 0.383)
NEC for r=0.8 class 1.0 = 0.223 +- 0.372 (in-sample avg dev_std = 0.383)
NEC for r=0.8 all KL = 0.226 +- 0.372 (in-sample avg dev_std = 0.383)
NEC for r=0.8 all L1 = 0.165 +- 0.287 (in-sample avg dev_std = 0.383)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 00:36:06 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 12:36:06 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 1.0000
Train Loss: 0.0011
ID Validation ACCURACY: 1.0000
ID Validation Loss: 0.0010
ID Test ACCURACY: 1.0000
ID Test Loss: 0.0011
OOD Validation ACCURACY: 1.0000
OOD Validation Loss: 0.0010
OOD Test ACCURACY: 1.0000
OOD Test Loss: 0.0011

[0m[1;37mINFO[0m: [1mChartInfo 1.0000 1.0000 1.0000 1.0000 1.0000 1.0000[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.058
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.067
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.053
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057756
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.571
SUFF_SIMPLE for r=0.05 class 0.0 = 0.911 +- 0.460 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.263 +- 0.460 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.05 all KL = 0.386 +- 0.460 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.05 all L1 = 0.552 +- 0.362 (in-sample avg dev_std = 0.655)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06705199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.564
SUFF_SIMPLE for r=0.1 class 0.0 = 0.892 +- 0.453 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.266 +- 0.453 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.1 all KL = 0.371 +- 0.453 (in-sample avg dev_std = 0.655)
SUFF_SIMPLE for r=0.1 all L1 = 0.546 +- 0.356 (in-sample avg dev_std = 0.655)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07347
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.59
SUFF_SIMPLE for r=0.2 class 0.0 = 0.907 +- 0.468 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.303 +- 0.468 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.2 all KL = 0.414 +- 0.468 (in-sample avg dev_std = 0.632)
SUFF_SIMPLE for r=0.2 all L1 = 0.572 +- 0.366 (in-sample avg dev_std = 0.632)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.079888
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.596
SUFF_SIMPLE for r=0.4 class 0.0 = 0.933 +- 0.483 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.333 +- 0.483 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.4 all KL = 0.476 +- 0.483 (in-sample avg dev_std = 0.524)
SUFF_SIMPLE for r=0.4 all L1 = 0.6 +- 0.387 (in-sample avg dev_std = 0.524)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08387799999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.772
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.642 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.763 +- 0.419 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.8 +- 0.357 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0093914
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.53
SUFF_SIMPLE for r=0.05 class 0.0 = 0.949 +- 0.436 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.321 +- 0.436 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.05 all KL = 0.554 +- 0.436 (in-sample avg dev_std = 0.432)
SUFF_SIMPLE for r=0.05 all L1 = 0.633 +- 0.371 (in-sample avg dev_std = 0.432)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.53
SUFF_SIMPLE for r=0.1 class 0.0 = 0.952 +- 0.437 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.321 +- 0.437 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all KL = 0.558 +- 0.437 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all L1 = 0.634 +- 0.372 (in-sample avg dev_std = 0.425)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009567
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.532
SUFF_SIMPLE for r=0.2 class 0.0 = 0.952 +- 0.437 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.321 +- 0.437 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 all KL = 0.558 +- 0.437 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.2 all L1 = 0.634 +- 0.371 (in-sample avg dev_std = 0.429)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602800000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.531
SUFF_SIMPLE for r=0.4 class 0.0 = 0.957 +- 0.439 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.322 +- 0.439 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.4 all KL = 0.567 +- 0.439 (in-sample avg dev_std = 0.401)
SUFF_SIMPLE for r=0.4 all L1 = 0.637 +- 0.374 (in-sample avg dev_std = 0.401)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096094
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.526
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.35 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.646 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.67 +- 0.396 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034668399999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.706
SUFF_SIMPLE for r=0.05 class 0.0 = 0.948 +- 0.457 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.449 +- 0.457 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.05 all KL = 0.562 +- 0.457 (in-sample avg dev_std = 0.545)
SUFF_SIMPLE for r=0.05 all L1 = 0.702 +- 0.341 (in-sample avg dev_std = 0.545)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042652800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.713
SUFF_SIMPLE for r=0.1 class 0.0 = 0.942 +- 0.457 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.477 +- 0.457 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.1 all KL = 0.582 +- 0.457 (in-sample avg dev_std = 0.512)
SUFF_SIMPLE for r=0.1 all L1 = 0.712 +- 0.343 (in-sample avg dev_std = 0.512)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0529322
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.713
SUFF_SIMPLE for r=0.2 class 0.0 = 0.927 +- 0.457 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.507 +- 0.457 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 all KL = 0.601 +- 0.457 (in-sample avg dev_std = 0.470)
SUFF_SIMPLE for r=0.2 all L1 = 0.72 +- 0.348 (in-sample avg dev_std = 0.470)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06487079999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.722
SUFF_SIMPLE for r=0.4 class 0.0 = 0.949 +- 0.460 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.502 +- 0.460 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.4 all KL = 0.634 +- 0.460 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.4 all L1 = 0.729 +- 0.359 (in-sample avg dev_std = 0.419)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0789312
len(reference) = 4975
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.812
SUFF_SIMPLE for r=0.8 class 0.0 = 0.99 +- 0.382 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.693 +- 0.382 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.818 +- 0.382 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.843 +- 0.329 (in-sample avg dev_std = 0.000)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  1.0
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.057756
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.978
NEC for r=0.05 class 0.0 = 0.001 +- 0.147 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.036 +- 0.147 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.023 +- 0.147 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.02 +- 0.126 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  1.0
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06705199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.936
NEC for r=0.1 class 0.0 = 0.001 +- 0.253 (in-sample avg dev_std = 0.041)
NEC for r=0.1 class 1.0 = 0.109 +- 0.253 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all KL = 0.073 +- 0.253 (in-sample avg dev_std = 0.041)
NEC for r=0.1 all L1 = 0.061 +- 0.213 (in-sample avg dev_std = 0.041)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  1.0
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07347
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.845
NEC for r=0.2 class 0.0 = 0.014 +- 0.397 (in-sample avg dev_std = 0.352)
NEC for r=0.2 class 1.0 = 0.286 +- 0.397 (in-sample avg dev_std = 0.352)
NEC for r=0.2 all KL = 0.239 +- 0.397 (in-sample avg dev_std = 0.352)
NEC for r=0.2 all L1 = 0.165 +- 0.297 (in-sample avg dev_std = 0.352)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  1.0
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.079888
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.795
NEC for r=0.4 class 0.0 = 0.042 +- 0.436 (in-sample avg dev_std = 0.547)
NEC for r=0.4 class 1.0 = 0.405 +- 0.436 (in-sample avg dev_std = 0.547)
NEC for r=0.4 all KL = 0.395 +- 0.436 (in-sample avg dev_std = 0.547)
NEC for r=0.4 all L1 = 0.243 +- 0.301 (in-sample avg dev_std = 0.547)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  1.0
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08387799999999998
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.757
NEC for r=0.8 class 0.0 = 0.053 +- 0.445 (in-sample avg dev_std = 0.650)
NEC for r=0.8 class 1.0 = 0.493 +- 0.445 (in-sample avg dev_std = 0.650)
NEC for r=0.8 all KL = 0.486 +- 0.445 (in-sample avg dev_std = 0.650)
NEC for r=0.8 all L1 = 0.297 +- 0.305 (in-sample avg dev_std = 0.650)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.883
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0093914
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.662
NEC for r=0.05 class 0.0 = 0.0 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.455 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.243 +- 0.381 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.229 +- 0.341 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.883
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.571
NEC for r=0.1 class 0.0 = 0.001 +- 0.429 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.585 +- 0.429 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.316 +- 0.429 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.295 +- 0.382 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.883
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009567
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.522
NEC for r=0.2 class 0.0 = 0.005 +- 0.447 (in-sample avg dev_std = 0.138)
NEC for r=0.2 class 1.0 = 0.667 +- 0.447 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all KL = 0.368 +- 0.447 (in-sample avg dev_std = 0.138)
NEC for r=0.2 all L1 = 0.339 +- 0.396 (in-sample avg dev_std = 0.138)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.883
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009602800000000002
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.522
NEC for r=0.4 class 0.0 = 0.008 +- 0.447 (in-sample avg dev_std = 0.296)
NEC for r=0.4 class 1.0 = 0.684 +- 0.447 (in-sample avg dev_std = 0.296)
NEC for r=0.4 all KL = 0.39 +- 0.447 (in-sample avg dev_std = 0.296)
NEC for r=0.4 all L1 = 0.348 +- 0.390 (in-sample avg dev_std = 0.296)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.883
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096094
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.524
NEC for r=0.8 class 0.0 = 0.007 +- 0.446 (in-sample avg dev_std = 0.307)
NEC for r=0.8 class 1.0 = 0.684 +- 0.446 (in-sample avg dev_std = 0.307)
NEC for r=0.8 all KL = 0.39 +- 0.446 (in-sample avg dev_std = 0.307)
NEC for r=0.8 all L1 = 0.348 +- 0.389 (in-sample avg dev_std = 0.307)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.969
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.034668399999999995
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.952
NEC for r=0.05 class 0.0 = 0.005 +- 0.189 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.067 +- 0.189 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.04 +- 0.189 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.035 +- 0.165 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.969
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042652800000000005
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.93
NEC for r=0.1 class 0.0 = 0.009 +- 0.242 (in-sample avg dev_std = 0.044)
NEC for r=0.1 class 1.0 = 0.108 +- 0.242 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all KL = 0.066 +- 0.242 (in-sample avg dev_std = 0.044)
NEC for r=0.1 all L1 = 0.058 +- 0.209 (in-sample avg dev_std = 0.044)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.969
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0529322
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.898
NEC for r=0.2 class 0.0 = 0.014 +- 0.305 (in-sample avg dev_std = 0.169)
NEC for r=0.2 class 1.0 = 0.166 +- 0.305 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all KL = 0.111 +- 0.305 (in-sample avg dev_std = 0.169)
NEC for r=0.2 all L1 = 0.089 +- 0.249 (in-sample avg dev_std = 0.169)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.969
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06487079999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.845
NEC for r=0.4 class 0.0 = 0.027 +- 0.379 (in-sample avg dev_std = 0.292)
NEC for r=0.4 class 1.0 = 0.27 +- 0.379 (in-sample avg dev_std = 0.292)
NEC for r=0.4 all KL = 0.2 +- 0.379 (in-sample avg dev_std = 0.292)
NEC for r=0.4 all L1 = 0.147 +- 0.294 (in-sample avg dev_std = 0.292)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.969
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0789312
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.799
NEC for r=0.8 class 0.0 = 0.052 +- 0.425 (in-sample avg dev_std = 0.453)
NEC for r=0.8 class 1.0 = 0.367 +- 0.425 (in-sample avg dev_std = 0.453)
NEC for r=0.8 all KL = 0.314 +- 0.425 (in-sample avg dev_std = 0.453)
NEC for r=0.8 all L1 = 0.207 +- 0.310 (in-sample avg dev_std = 0.453)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.763, 0.785, 0.787, 0.799, 0.929], 'all_L1': [0.813, 0.826, 0.825, 0.837, 0.942]}), defaultdict(<class 'list'>, {'all_KL': [0.711, 0.703, 0.739, 0.772, 0.974], 'all_L1': [0.826, 0.825, 0.84, 0.853, 0.977]}), defaultdict(<class 'list'>, {'all_KL': [0.699, 0.738, 0.751, 0.785, 0.945], 'all_L1': [0.793, 0.816, 0.825, 0.846, 0.953]}), defaultdict(<class 'list'>, {'all_KL': [0.654, 0.681, 0.67, 0.696, 0.905], 'all_L1': [0.774, 0.787, 0.778, 0.792, 0.916]}), defaultdict(<class 'list'>, {'all_KL': [0.746, 0.762, 0.768, 0.793, 0.937], 'all_L1': [0.813, 0.823, 0.826, 0.846, 0.947]}), defaultdict(<class 'list'>, {'all_KL': [0.69, 0.686, 0.707, 0.751, 0.97], 'all_L1': [0.81, 0.802, 0.814, 0.84, 0.974]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.52, 0.534, 0.57, 0.878], 'all_L1': [0.66, 0.68, 0.683, 0.695, 0.895]}), defaultdict(<class 'list'>, {'all_KL': [0.622, 0.642, 0.658, 0.701, 0.904], 'all_L1': [0.754, 0.76, 0.772, 0.798, 0.917]}), defaultdict(<class 'list'>, {'all_KL': [0.621, 0.652, 0.664, 0.725, 0.92], 'all_L1': [0.741, 0.757, 0.764, 0.805, 0.93]}), defaultdict(<class 'list'>, {'all_KL': [0.386, 0.371, 0.414, 0.476, 0.763], 'all_L1': [0.552, 0.546, 0.572, 0.6, 0.8]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.002, 0.012, 0.047, 0.107, 0.151], 'all_L1': [0.002, 0.009, 0.033, 0.068, 0.096]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.026, 0.066, 0.126, 0.194], 'all_L1': [0.009, 0.022, 0.044, 0.075, 0.102]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.028, 0.071, 0.156, 0.191], 'all_L1': [0.009, 0.025, 0.05, 0.102, 0.111]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.03, 0.08, 0.153, 0.209], 'all_L1': [0.004, 0.026, 0.057, 0.106, 0.133]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.008, 0.041, 0.095, 0.149], 'all_L1': [0.002, 0.006, 0.027, 0.057, 0.085]}), defaultdict(<class 'list'>, {'all_KL': [0.002, 0.01, 0.023, 0.093, 0.169], 'all_L1': [0.002, 0.009, 0.016, 0.059, 0.097]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.053, 0.137, 0.242, 0.329], 'all_L1': [0.022, 0.044, 0.101, 0.162, 0.21]}), defaultdict(<class 'list'>, {'all_KL': [0.004, 0.029, 0.102, 0.177, 0.242], 'all_L1': [0.003, 0.025, 0.074, 0.12, 0.152]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.031, 0.059, 0.124, 0.223], 'all_L1': [0.01, 0.027, 0.045, 0.083, 0.137]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.073, 0.239, 0.395, 0.486], 'all_L1': [0.02, 0.061, 0.165, 0.243, 0.297]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.746, 0.746, 0.746, 0.746, 0.755], 'all_L1': [0.784, 0.784, 0.784, 0.784, 0.793]}), defaultdict(<class 'list'>, {'all_KL': [0.742, 0.743, 0.744, 0.744, 0.873], 'all_L1': [0.781, 0.781, 0.781, 0.781, 0.89]}), defaultdict(<class 'list'>, {'all_KL': [0.765, 0.765, 0.765, 0.765, 0.813], 'all_L1': [0.804, 0.804, 0.804, 0.804, 0.844]}), defaultdict(<class 'list'>, {'all_KL': [0.729, 0.725, 0.725, 0.731, 0.761], 'all_L1': [0.802, 0.8, 0.8, 0.802, 0.778]}), defaultdict(<class 'list'>, {'all_KL': [0.749, 0.749, 0.749, 0.749, 0.861], 'all_L1': [0.797, 0.797, 0.797, 0.797, 0.889]}), defaultdict(<class 'list'>, {'all_KL': [0.714, 0.711, 0.713, 0.718, 0.852], 'all_L1': [0.785, 0.784, 0.784, 0.786, 0.867]}), defaultdict(<class 'list'>, {'all_KL': [0.491, 0.488, 0.499, 0.526, 0.808], 'all_L1': [0.674, 0.671, 0.678, 0.686, 0.831]}), defaultdict(<class 'list'>, {'all_KL': [0.74, 0.744, 0.745, 0.748, 0.768], 'all_L1': [0.808, 0.81, 0.811, 0.811, 0.793]}), defaultdict(<class 'list'>, {'all_KL': [0.76, 0.758, 0.76, 0.76, 0.882], 'all_L1': [0.818, 0.817, 0.818, 0.818, 0.905]}), defaultdict(<class 'list'>, {'all_KL': [0.554, 0.558, 0.558, 0.567, 0.646], 'all_L1': [0.633, 0.634, 0.634, 0.637, 0.67]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.008, 0.087, 0.245, 0.253, 0.253], 'all_L1': [0.006, 0.068, 0.204, 0.211, 0.212]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.031, 0.154, 0.281, 0.308], 'all_L1': [0.007, 0.026, 0.112, 0.156, 0.165]}), defaultdict(<class 'list'>, {'all_KL': [0.025, 0.074, 0.191, 0.232, 0.232], 'all_L1': [0.02, 0.061, 0.154, 0.177, 0.178]}), defaultdict(<class 'list'>, {'all_KL': [0.076, 0.206, 0.268, 0.366, 0.382], 'all_L1': [0.075, 0.197, 0.236, 0.278, 0.284]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.039, 0.147, 0.231, 0.236], 'all_L1': [0.008, 0.031, 0.109, 0.147, 0.149]}), defaultdict(<class 'list'>, {'all_KL': [0.005, 0.024, 0.179, 0.336, 0.36], 'all_L1': [0.005, 0.022, 0.139, 0.199, 0.206]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.05, 0.221, 0.386, 0.407], 'all_L1': [0.007, 0.044, 0.176, 0.25, 0.256]}), defaultdict(<class 'list'>, {'all_KL': [0.105, 0.198, 0.252, 0.308, 0.32], 'all_L1': [0.095, 0.178, 0.219, 0.241, 0.247]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.031, 0.127, 0.22, 0.232], 'all_L1': [0.008, 0.026, 0.098, 0.139, 0.141]}), defaultdict(<class 'list'>, {'all_KL': [0.243, 0.316, 0.368, 0.39, 0.39], 'all_L1': [0.229, 0.295, 0.339, 0.348, 0.348]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.844, 0.854, 0.855, 0.831, 0.855], 'all_L1': [0.888, 0.893, 0.894, 0.883, 0.875]}), defaultdict(<class 'list'>, {'all_KL': [0.812, 0.828, 0.848, 0.88, 0.944], 'all_L1': [0.872, 0.879, 0.889, 0.908, 0.951]}), defaultdict(<class 'list'>, {'all_KL': [0.828, 0.834, 0.852, 0.877, 0.964], 'all_L1': [0.877, 0.877, 0.885, 0.901, 0.969]}), defaultdict(<class 'list'>, {'all_KL': [0.817, 0.827, 0.844, 0.85, 0.898], 'all_L1': [0.862, 0.866, 0.877, 0.879, 0.909]}), defaultdict(<class 'list'>, {'all_KL': [0.823, 0.837, 0.843, 0.848, 0.882], 'all_L1': [0.878, 0.884, 0.886, 0.893, 0.898]}), defaultdict(<class 'list'>, {'all_KL': [0.816, 0.829, 0.841, 0.866, 0.917], 'all_L1': [0.87, 0.875, 0.879, 0.894, 0.928]}), defaultdict(<class 'list'>, {'all_KL': [0.748, 0.772, 0.788, 0.802, 0.903], 'all_L1': [0.818, 0.83, 0.835, 0.843, 0.915]}), defaultdict(<class 'list'>, {'all_KL': [0.811, 0.821, 0.835, 0.854, 0.96], 'all_L1': [0.86, 0.863, 0.87, 0.88, 0.965]}), defaultdict(<class 'list'>, {'all_KL': [0.634, 0.665, 0.679, 0.7, 0.815], 'all_L1': [0.734, 0.756, 0.765, 0.768, 0.838]}), defaultdict(<class 'list'>, {'all_KL': [0.562, 0.582, 0.601, 0.634, 0.818], 'all_L1': [0.702, 0.712, 0.72, 0.729, 0.843]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.006, 0.01, 0.02, 0.057, 0.091], 'all_L1': [0.005, 0.009, 0.017, 0.047, 0.069]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.014, 0.025, 0.058, 0.118], 'all_L1': [0.01, 0.012, 0.021, 0.047, 0.082]}), defaultdict(<class 'list'>, {'all_KL': [0.012, 0.018, 0.028, 0.062, 0.118], 'all_L1': [0.01, 0.015, 0.024, 0.052, 0.085]}), defaultdict(<class 'list'>, {'all_KL': [0.017, 0.024, 0.039, 0.072, 0.125], 'all_L1': [0.016, 0.022, 0.034, 0.062, 0.096]}), defaultdict(<class 'list'>, {'all_KL': [0.008, 0.013, 0.023, 0.055, 0.107], 'all_L1': [0.007, 0.011, 0.018, 0.043, 0.078]}), defaultdict(<class 'list'>, {'all_KL': [0.01, 0.015, 0.026, 0.059, 0.125], 'all_L1': [0.009, 0.013, 0.022, 0.05, 0.089]}), defaultdict(<class 'list'>, {'all_KL': [0.023, 0.034, 0.055, 0.11, 0.182], 'all_L1': [0.02, 0.029, 0.047, 0.091, 0.133]}), defaultdict(<class 'list'>, {'all_KL': [0.011, 0.016, 0.029, 0.074, 0.129], 'all_L1': [0.01, 0.014, 0.025, 0.062, 0.094]}), defaultdict(<class 'list'>, {'all_KL': [0.019, 0.033, 0.057, 0.118, 0.226], 'all_L1': [0.017, 0.029, 0.048, 0.091, 0.165]}), defaultdict(<class 'list'>, {'all_KL': [0.04, 0.066, 0.111, 0.2, 0.314], 'all_L1': [0.035, 0.058, 0.089, 0.147, 0.207]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.754 +- 0.082, 0.762 +- 0.084, 0.770 +- 0.079, 0.791 +- 0.078, 0.925 +- 0.048
suff_simple class all_KL  =  0.638 +- 0.112, 0.654 +- 0.118, 0.669 +- 0.110, 0.707 +- 0.100, 0.912 +- 0.057
[[0.8047500252723694, 0.8137500286102295, 0.809499979019165, 0.8252500295639038, 0.9359999895095825], [0.8537499904632568, 0.8507500290870667, 0.8622499704360962, 0.8650000095367432, 0.9739999771118164], [0.8109999895095825, 0.828249990940094, 0.8355000019073486, 0.8512499928474426, 0.9459999799728394], [0.8177499771118164, 0.8217499852180481, 0.8109999895095825, 0.8199999928474426, 0.9079999923706055], [0.815750002861023, 0.8227499723434448, 0.8259999752044678, 0.8450000286102295, 0.9419999718666077], [0.8414999842643738, 0.828249990940094, 0.8357499837875366, 0.8542500138282776, 0.9700000286102295], [0.7022500038146973, 0.7164999842643738, 0.7132499814033508, 0.7092499732971191, 0.8799999952316284], [0.7982500195503235, 0.7960000038146973, 0.8065000176429749, 0.8232499957084656, 0.906000018119812], [0.7739999890327454, 0.7864999771118164, 0.7857499718666077, 0.8230000138282776, 0.921999990940094], [0.5712500214576721, 0.5637500286102295, 0.5902500152587891, 0.5962499976158142, 0.7720000147819519]]
[[0.763, 0.785, 0.787, 0.799, 0.929], [0.711, 0.703, 0.739, 0.772, 0.974], [0.699, 0.738, 0.751, 0.785, 0.945], [0.654, 0.681, 0.67, 0.696, 0.905], [0.746, 0.762, 0.768, 0.793, 0.937], [0.69, 0.686, 0.707, 0.751, 0.97], [0.489, 0.52, 0.534, 0.57, 0.878], [0.622, 0.642, 0.658, 0.701, 0.904], [0.621, 0.652, 0.664, 0.725, 0.92], [0.386, 0.371, 0.414, 0.476, 0.763]]
suff_simple_acc_int  =  0.779 +- 0.080, 0.783 +- 0.081, 0.788 +- 0.076, 0.801 +- 0.080, 0.916 +- 0.055
nec class all_L1  =  0.008 +- 0.007, 0.025 +- 0.016, 0.061 +- 0.042, 0.107 +- 0.054, 0.142 +- 0.062
nec class all_KL  =  0.009 +- 0.008, 0.030 +- 0.019, 0.087 +- 0.059, 0.167 +- 0.087, 0.234 +- 0.098
[[0.9980000257492065, 0.9900000095367432, 0.9710000157356262, 0.9380000233650208, 0.9154999852180481], [0.9900000095367432, 0.9750000238418579, 0.9580000042915344, 0.9350000023841858, 0.9227499961853027], [0.9900000095367432, 0.9722499847412109, 0.9514999985694885, 0.9100000262260437, 0.9137499928474426], [0.9959999918937683, 0.9722499847412109, 0.9502500295639038, 0.9114999771118164, 0.9010000228881836], [0.9980000257492065, 0.9927499890327454, 0.9735000133514404, 0.9490000009536743, 0.9304999709129333], [0.9980000257492065, 0.9900000095367432, 0.9854999780654907, 0.9472500085830688, 0.9240000247955322], [0.9760000109672546, 0.9512500166893005, 0.8970000147819519, 0.8532500267028809, 0.8215000033378601], [0.9959999918937683, 0.971750020980835, 0.9334999918937683, 0.8970000147819519, 0.8809999823570251], [0.9879999756813049, 0.9700000286102295, 0.9547500014305115, 0.9269999861717224, 0.8949999809265137], [0.9779999852180481, 0.9355000257492065, 0.8454999923706055, 0.7952499985694885, 0.7570000290870667]]
[[0.002, 0.012, 0.047, 0.107, 0.151], [0.011, 0.026, 0.066, 0.126, 0.194], [0.01, 0.028, 0.071, 0.156, 0.191], [0.004, 0.03, 0.08, 0.153, 0.209], [0.002, 0.008, 0.041, 0.095, 0.149], [0.002, 0.01, 0.023, 0.093, 0.169], [0.025, 0.053, 0.137, 0.242, 0.329], [0.004, 0.029, 0.102, 0.177, 0.242], [0.012, 0.031, 0.059, 0.124, 0.223], [0.023, 0.073, 0.239, 0.395, 0.486]]
nec_acc_int  =  0.991 +- 0.008, 0.972 +- 0.017, 0.942 +- 0.040, 0.906 +- 0.046, 0.886 +- 0.052

Eval split val
suff_simple class all_L1  =  0.769 +- 0.059, 0.768 +- 0.059, 0.769 +- 0.059, 0.771 +- 0.057, 0.826 +- 0.067
suff_simple class all_KL  =  0.699 +- 0.090, 0.699 +- 0.090, 0.700 +- 0.088, 0.705 +- 0.081, 0.802 +- 0.069
[[0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.7462000250816345, 0.758400022983551], [0.7491999864578247, 0.7494500279426575, 0.7495750188827515, 0.7495499849319458, 0.8736000061035156], [0.7116249799728394, 0.711650013923645, 0.7116749882698059, 0.7116000056266785, 0.7585999965667725], [0.6986749768257141, 0.6959750056266785, 0.6969249844551086, 0.6962249875068665, 0.6525999903678894], [0.721750020980835, 0.7220500111579895, 0.7218999862670898, 0.722100019454956, 0.8271999955177307], [0.7447749972343445, 0.7450249791145325, 0.7455750107765198, 0.7458999752998352, 0.8212000131607056], [0.7349249720573425, 0.7306249737739563, 0.7365000247955322, 0.7315750122070312, 0.801800012588501], [0.6754000186920166, 0.6775000095367432, 0.6778749823570251, 0.6741750240325928, 0.5911999940872192], [0.6832749843597412, 0.682699978351593, 0.6822999715805054, 0.6830999851226807, 0.7703999876976013], [0.5299999713897705, 0.5301499962806702, 0.5319749712944031, 0.531374990940094, 0.526199996471405]]
[[0.746, 0.746, 0.746, 0.746, 0.755], [0.742, 0.743, 0.744, 0.744, 0.873], [0.765, 0.765, 0.765, 0.765, 0.813], [0.729, 0.725, 0.725, 0.731, 0.761], [0.749, 0.749, 0.749, 0.749, 0.861], [0.714, 0.711, 0.713, 0.718, 0.852], [0.491, 0.488, 0.499, 0.526, 0.808], [0.74, 0.744, 0.745, 0.748, 0.768], [0.76, 0.758, 0.76, 0.76, 0.882], [0.554, 0.558, 0.558, 0.567, 0.646]]
suff_simple_acc_int  =  0.700 +- 0.062, 0.699 +- 0.062, 0.700 +- 0.061, 0.699 +- 0.061, 0.738 +- 0.106
nec class all_L1  =  0.046 +- 0.068, 0.095 +- 0.090, 0.179 +- 0.070, 0.215 +- 0.063, 0.219 +- 0.062
nec class all_KL  =  0.050 +- 0.072, 0.106 +- 0.095, 0.215 +- 0.068, 0.300 +- 0.063, 0.312 +- 0.067
[[0.9941999912261963, 0.930400013923645, 0.7648000121116638, 0.7591999769210815, 0.758774995803833], [0.9923999905586243, 0.9702000021934509, 0.8865749835968018, 0.8804749846458435, 0.8789499998092651], [0.907800018787384, 0.8623999953269958, 0.7660250067710876, 0.7546749711036682, 0.7542250156402588], [0.8131999969482422, 0.6863999962806702, 0.6524249911308289, 0.6587499976158142, 0.6604750156402588], [0.9368000030517578, 0.9138000011444092, 0.8357250094413757, 0.819724977016449, 0.8189749717712402], [0.9642000198364258, 0.9455999732017517, 0.8306000232696533, 0.8243250250816345, 0.8246750235557556], [0.991599977016449, 0.949400007724762, 0.8131499886512756, 0.7943750023841858, 0.7975249886512756], [0.7161999940872192, 0.6205999851226807, 0.5838750004768372, 0.5942500233650208, 0.5961499810218811], [0.855400025844574, 0.8392000198364258, 0.7729750275611877, 0.7597749829292297, 0.7634249925613403], [0.6615999937057495, 0.5705999732017517, 0.5221250057220459, 0.5218250155448914, 0.5235249996185303]]
[[0.008, 0.087, 0.245, 0.253, 0.253], [0.008, 0.031, 0.154, 0.281, 0.308], [0.025, 0.074, 0.191, 0.232, 0.232], [0.076, 0.206, 0.268, 0.366, 0.382], [0.01, 0.039, 0.147, 0.231, 0.236], [0.005, 0.024, 0.179, 0.336, 0.36], [0.008, 0.05, 0.221, 0.386, 0.407], [0.105, 0.198, 0.252, 0.308, 0.32], [0.01, 0.031, 0.127, 0.22, 0.232], [0.243, 0.316, 0.368, 0.39, 0.39]]
nec_acc_int  =  0.883 +- 0.113, 0.829 +- 0.140, 0.743 +- 0.112, 0.737 +- 0.106, 0.738 +- 0.105

Eval split test
suff_simple class all_L1  =  0.836 +- 0.062, 0.844 +- 0.058, 0.850 +- 0.057, 0.858 +- 0.058, 0.909 +- 0.044
suff_simple class all_KL  =  0.770 +- 0.090, 0.785 +- 0.085, 0.799 +- 0.083, 0.814 +- 0.078, 0.896 +- 0.051
[[0.8759756088256836, 0.8779017329216003, 0.8774264454841614, 0.8704472780227661, 0.8454892635345459], [0.8707224130630493, 0.8719981908798218, 0.8812537789344788, 0.8986892104148865, 0.9389803409576416], [0.8755252957344055, 0.8719481825828552, 0.8749499917030334, 0.8868821263313293, 0.9587429761886597], [0.86734539270401, 0.8655943274497986, 0.8699469566345215, 0.871873140335083, 0.891653299331665], [0.8732990026473999, 0.8737492561340332, 0.8737742900848389, 0.8811537027359009, 0.8724428415298462], [0.8743996620178223, 0.8759756088256836, 0.8742245435714722, 0.889833927154541, 0.9146414995193481], [0.8210425972938538, 0.829047441482544, 0.8333500027656555, 0.8306984305381775, 0.9006423354148865], [0.8622673749923706, 0.8612167239189148, 0.8598659038543701, 0.8673704266548157, 0.9550201892852783], [0.7603812217712402, 0.7772913575172424, 0.781393826007843, 0.7696368098258972, 0.80756014585495], [0.7063738107681274, 0.712552547454834, 0.7132529616355896, 0.7219831943511963, 0.8120602965354919]]
[[0.844, 0.854, 0.855, 0.831, 0.855], [0.812, 0.828, 0.848, 0.88, 0.944], [0.828, 0.834, 0.852, 0.877, 0.964], [0.817, 0.827, 0.844, 0.85, 0.898], [0.823, 0.837, 0.843, 0.848, 0.882], [0.816, 0.829, 0.841, 0.866, 0.917], [0.748, 0.772, 0.788, 0.802, 0.903], [0.811, 0.821, 0.835, 0.854, 0.96], [0.634, 0.665, 0.679, 0.7, 0.815], [0.562, 0.582, 0.601, 0.634, 0.818]]
suff_simple_acc_int  =  0.839 +- 0.056, 0.842 +- 0.052, 0.844 +- 0.052, 0.849 +- 0.055, 0.890 +- 0.052
nec class all_L1  =  0.014 +- 0.008, 0.021 +- 0.014, 0.034 +- 0.021, 0.069 +- 0.031, 0.110 +- 0.042
nec class all_KL  =  0.016 +- 0.009, 0.024 +- 0.016, 0.041 +- 0.026, 0.086 +- 0.043, 0.153 +- 0.065
[[0.9804883003234863, 0.9773364067077637, 0.9690564274787903, 0.9354612827301025, 0.9139984250068665], [0.9831899404525757, 0.9808885455131531, 0.9708825349807739, 0.9412647485733032, 0.9137982726097107], [0.9789873957633972, 0.9755603075027466, 0.9675555229187012, 0.9390383958816528, 0.9134730696678162], [0.9721583127975464, 0.9701570868492126, 0.9623023867607117, 0.9345107078552246, 0.909120500087738], [0.9812887907028198, 0.9769861698150635, 0.970782458782196, 0.9429658055305481, 0.911972165107727], [0.9797878861427307, 0.9787872433662415, 0.9711326956748962, 0.9432409405708313, 0.9123474359512329], [0.9657794833183289, 0.9589753746986389, 0.9440664649009705, 0.897688627243042, 0.8731738924980164], [0.9803882241249084, 0.9764859080314636, 0.9642035365104675, 0.9257554411888123, 0.9048429131507874], [0.9738342761993408, 0.9608014822006226, 0.9420152306556702, 0.9037172198295593, 0.8485091328620911], [0.951771080493927, 0.9299329519271851, 0.8975885510444641, 0.8448318839073181, 0.7991794943809509]]
[[0.006, 0.01, 0.02, 0.057, 0.091], [0.011, 0.014, 0.025, 0.058, 0.118], [0.012, 0.018, 0.028, 0.062, 0.118], [0.017, 0.024, 0.039, 0.072, 0.125], [0.008, 0.013, 0.023, 0.055, 0.107], [0.01, 0.015, 0.026, 0.059, 0.125], [0.023, 0.034, 0.055, 0.11, 0.182], [0.011, 0.016, 0.029, 0.074, 0.129], [0.019, 0.033, 0.057, 0.118, 0.226], [0.04, 0.066, 0.111, 0.2, 0.314]]
nec_acc_int  =  0.975 +- 0.009, 0.969 +- 0.015, 0.956 +- 0.022, 0.921 +- 0.030, 0.890 +- 0.037


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.381 +- 0.038, 0.394 +- 0.035, 0.416 +- 0.021, 0.449 +- 0.015, 0.534 +- 0.011
Faith. Armon (L1)= 		  =  0.016 +- 0.014, 0.048 +- 0.029, 0.108 +- 0.063, 0.182 +- 0.071, 0.240 +- 0.082
Faith. GMean (L1)= 	  =  0.071 +- 0.028, 0.130 +- 0.036, 0.203 +- 0.053, 0.280 +- 0.049, 0.353 +- 0.061
Faith. Aritm (KL)= 		  =  0.324 +- 0.053, 0.342 +- 0.050, 0.378 +- 0.030, 0.437 +- 0.018, 0.573 +- 0.024
Faith. Armon (KL)= 		  =  0.018 +- 0.015, 0.055 +- 0.032, 0.141 +- 0.071, 0.252 +- 0.079, 0.360 +- 0.099
Faith. GMean (KL)= 	  =  0.068 +- 0.026, 0.129 +- 0.030, 0.222 +- 0.050, 0.328 +- 0.048, 0.451 +- 0.069

Eval split val
Faith. Aritm (L1)= 		  =  0.407 +- 0.029, 0.432 +- 0.041, 0.474 +- 0.028, 0.493 +- 0.023, 0.522 +- 0.012
Faith. Armon (L1)= 		  =  0.076 +- 0.103, 0.153 +- 0.125, 0.281 +- 0.082, 0.329 +- 0.068, 0.338 +- 0.068
Faith. GMean (L1)= 	  =  0.146 +- 0.107, 0.241 +- 0.111, 0.362 +- 0.061, 0.401 +- 0.048, 0.418 +- 0.043
Faith. Aritm (KL)= 		  =  0.374 +- 0.045, 0.402 +- 0.055, 0.458 +- 0.039, 0.503 +- 0.026, 0.557 +- 0.035
Faith. Armon (KL)= 		  =  0.080 +- 0.103, 0.166 +- 0.124, 0.320 +- 0.069, 0.413 +- 0.050, 0.443 +- 0.065
Faith. GMean (KL)= 	  =  0.147 +- 0.103, 0.245 +- 0.107, 0.381 +- 0.051, 0.455 +- 0.034, 0.496 +- 0.048

Eval split test
Faith. Aritm (L1)= 		  =  0.425 +- 0.027, 0.432 +- 0.023, 0.442 +- 0.019, 0.464 +- 0.015, 0.509 +- 0.018
Faith. Armon (L1)= 		  =  0.027 +- 0.016, 0.041 +- 0.026, 0.065 +- 0.037, 0.126 +- 0.048, 0.193 +- 0.063
Faith. GMean (L1)= 	  =  0.103 +- 0.025, 0.127 +- 0.033, 0.163 +- 0.039, 0.237 +- 0.039, 0.310 +- 0.050
Faith. Aritm (KL)= 		  =  0.393 +- 0.041, 0.405 +- 0.035, 0.420 +- 0.030, 0.450 +- 0.020, 0.525 +- 0.026
Faith. Armon (KL)= 		  =  0.030 +- 0.018, 0.046 +- 0.028, 0.076 +- 0.043, 0.151 +- 0.061, 0.255 +- 0.084
Faith. GMean (KL)= 	  =  0.104 +- 0.022, 0.130 +- 0.030, 0.172 +- 0.038, 0.256 +- 0.043, 0.362 +- 0.063
Computed for split load_split = id



Completed in  2:32:35.393210  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatgchannelsimple_concept2temperaturenormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN simple_concept2temperature TopoFeature/basis/no_shift NEC_ALPHA 0.1

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 00:51:53 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 12:51:53 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 94 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round1/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 94...
[0m[1;37mINFO[0m: [1mCheckpoint 94: 
-----------------------------------
Train ACCURACY: 0.9677
Train Loss: 0.1038
ID Validation ACCURACY: 0.9740
ID Validation Loss: 0.1058
ID Test ACCURACY: 0.9560
ID Test Loss: 0.1293
OOD Validation ACCURACY: 0.9740
OOD Validation Loss: 0.1058
OOD Test ACCURACY: 0.9560
OOD Test Loss: 0.1293

[0m[1;37mINFO[0m: [1mChartInfo 0.9560 0.9560 0.9560 0.9560 0.9740 0.9740[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.047
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.058
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.067
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.040
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.064
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 1 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046784000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.49
SUFF_SIMPLE for r=0.05 class 0.0 = 0.684 +- 0.398 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.312 +- 0.398 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.05 all KL = 0.404 +- 0.398 (in-sample avg dev_std = 0.462)
SUFF_SIMPLE for r=0.05 all L1 = 0.478 +- 0.327 (in-sample avg dev_std = 0.462)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05810800000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.482
SUFF_SIMPLE for r=0.1 class 0.0 = 0.671 +- 0.412 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.324 +- 0.412 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.1 all KL = 0.412 +- 0.412 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.1 all L1 = 0.479 +- 0.339 (in-sample avg dev_std = 0.421)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.067458
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.677 +- 0.419 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.336 +- 0.419 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.2 all KL = 0.428 +- 0.419 (in-sample avg dev_std = 0.389)
SUFF_SIMPLE for r=0.2 all L1 = 0.488 +- 0.348 (in-sample avg dev_std = 0.389)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076612
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.498
SUFF_SIMPLE for r=0.4 class 0.0 = 0.746 +- 0.435 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.31 +- 0.435 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all KL = 0.459 +- 0.435 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.4 all L1 = 0.504 +- 0.363 (in-sample avg dev_std = 0.282)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08117
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.622
SUFF_SIMPLE for r=0.8 class 0.0 = 0.856 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.425 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.602 +- 0.427 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.617 +- 0.365 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.180 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.84 +- 0.180 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.180 (in-sample avg dev_std = 0.046)
SUFF_SIMPLE for r=0.05 all L1 = 0.918 +- 0.197 (in-sample avg dev_std = 0.046)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009281000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.179 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.84 +- 0.179 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.1 all KL = 0.934 +- 0.179 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.1 all L1 = 0.918 +- 0.197 (in-sample avg dev_std = 0.045)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009344400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.179 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.84 +- 0.179 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.179 (in-sample avg dev_std = 0.049)
SUFF_SIMPLE for r=0.2 all L1 = 0.918 +- 0.197 (in-sample avg dev_std = 0.049)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095086
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.179 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.84 +- 0.179 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.4 all KL = 0.934 +- 0.179 (in-sample avg dev_std = 0.047)
SUFF_SIMPLE for r=0.4 all L1 = 0.918 +- 0.197 (in-sample avg dev_std = 0.047)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0095604
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.497
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.175 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.842 +- 0.175 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.936 +- 0.175 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.919 +- 0.196 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032958
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.629
SUFF_SIMPLE for r=0.05 class 0.0 = 0.648 +- 0.373 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.583 +- 0.373 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.05 all KL = 0.554 +- 0.373 (in-sample avg dev_std = 0.459)
SUFF_SIMPLE for r=0.05 all L1 = 0.616 +- 0.297 (in-sample avg dev_std = 0.459)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0404916
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.621
SUFF_SIMPLE for r=0.1 class 0.0 = 0.635 +- 0.381 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.607 +- 0.381 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all KL = 0.568 +- 0.381 (in-sample avg dev_std = 0.425)
SUFF_SIMPLE for r=0.1 all L1 = 0.621 +- 0.311 (in-sample avg dev_std = 0.425)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050537
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.616
SUFF_SIMPLE for r=0.2 class 0.0 = 0.648 +- 0.390 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.592 +- 0.390 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.2 all KL = 0.579 +- 0.390 (in-sample avg dev_std = 0.374)
SUFF_SIMPLE for r=0.2 all L1 = 0.62 +- 0.324 (in-sample avg dev_std = 0.374)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06428500000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.626
SUFF_SIMPLE for r=0.4 class 0.0 = 0.666 +- 0.406 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.553 +- 0.406 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.4 all KL = 0.577 +- 0.406 (in-sample avg dev_std = 0.331)
SUFF_SIMPLE for r=0.4 all L1 = 0.61 +- 0.339 (in-sample avg dev_std = 0.331)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.764
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0798366
len(reference) = 4977
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.707
SUFF_SIMPLE for r=0.8 class 0.0 = 0.825 +- 0.335 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.75 +- 0.335 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 all KL = 0.797 +- 0.335 (in-sample avg dev_std = 0.074)
SUFF_SIMPLE for r=0.8 all L1 = 0.788 +- 0.296 (in-sample avg dev_std = 0.074)


Evaluating NEC for seed 1 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.974
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.046784000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.89
NEC for r=0.05 class 0.0 = 0.098 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.196 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.122 +- 0.245 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.152 +- 0.233 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.974
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05810800000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.771
NEC for r=0.1 class 0.0 = 0.122 +- 0.358 (in-sample avg dev_std = 0.026)
NEC for r=0.1 class 1.0 = 0.378 +- 0.358 (in-sample avg dev_std = 0.026)
NEC for r=0.1 all KL = 0.254 +- 0.358 (in-sample avg dev_std = 0.026)
NEC for r=0.1 all L1 = 0.264 +- 0.316 (in-sample avg dev_std = 0.026)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.974
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.067458
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.663
NEC for r=0.2 class 0.0 = 0.155 +- 0.406 (in-sample avg dev_std = 0.282)
NEC for r=0.2 class 1.0 = 0.541 +- 0.406 (in-sample avg dev_std = 0.282)
NEC for r=0.2 all KL = 0.394 +- 0.406 (in-sample avg dev_std = 0.282)
NEC for r=0.2 all L1 = 0.369 +- 0.342 (in-sample avg dev_std = 0.282)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.974
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076612
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.6
NEC for r=0.4 class 0.0 = 0.211 +- 0.407 (in-sample avg dev_std = 0.404)
NEC for r=0.4 class 1.0 = 0.617 +- 0.407 (in-sample avg dev_std = 0.404)
NEC for r=0.4 all KL = 0.486 +- 0.407 (in-sample avg dev_std = 0.404)
NEC for r=0.4 all L1 = 0.436 +- 0.336 (in-sample avg dev_std = 0.404)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.974
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08117
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.595
NEC for r=0.8 class 0.0 = 0.24 +- 0.388 (in-sample avg dev_std = 0.516)
NEC for r=0.8 class 1.0 = 0.634 +- 0.388 (in-sample avg dev_std = 0.516)
NEC for r=0.8 all KL = 0.529 +- 0.388 (in-sample avg dev_std = 0.516)
NEC for r=0.8 all L1 = 0.458 +- 0.312 (in-sample avg dev_std = 0.516)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.547
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0089616
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.513
NEC for r=0.05 class 0.0 = 0.002 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.037 +- 0.113 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.063 +- 0.155 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.547
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009281000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.501
NEC for r=0.1 class 0.0 = 0.002 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.15 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.057 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.076 +- 0.187 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.547
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009344400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.497
NEC for r=0.2 class 0.0 = 0.002 +- 0.176 (in-sample avg dev_std = 0.009)
NEC for r=0.2 class 1.0 = 0.159 +- 0.176 (in-sample avg dev_std = 0.009)
NEC for r=0.2 all KL = 0.064 +- 0.176 (in-sample avg dev_std = 0.009)
NEC for r=0.2 all L1 = 0.081 +- 0.196 (in-sample avg dev_std = 0.009)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.547
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095086
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
NEC for r=0.4 class 0.0 = 0.002 +- 0.177 (in-sample avg dev_std = 0.029)
NEC for r=0.4 class 1.0 = 0.159 +- 0.177 (in-sample avg dev_std = 0.029)
NEC for r=0.4 all KL = 0.064 +- 0.177 (in-sample avg dev_std = 0.029)
NEC for r=0.4 all L1 = 0.081 +- 0.197 (in-sample avg dev_std = 0.029)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.547
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0095604
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.177 (in-sample avg dev_std = 0.030)
NEC for r=0.8 class 1.0 = 0.159 +- 0.177 (in-sample avg dev_std = 0.030)
NEC for r=0.8 all KL = 0.064 +- 0.177 (in-sample avg dev_std = 0.030)
NEC for r=0.8 all L1 = 0.081 +- 0.197 (in-sample avg dev_std = 0.030)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.763
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.032958
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.742
NEC for r=0.05 class 0.0 = 0.083 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.099 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.077 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.091 +- 0.199 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.763
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0404916
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.731
NEC for r=0.1 class 0.0 = 0.122 +- 0.265 (in-sample avg dev_std = 0.057)
NEC for r=0.1 class 1.0 = 0.15 +- 0.265 (in-sample avg dev_std = 0.057)
NEC for r=0.1 all KL = 0.122 +- 0.265 (in-sample avg dev_std = 0.057)
NEC for r=0.1 all L1 = 0.136 +- 0.242 (in-sample avg dev_std = 0.057)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.763
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.050537
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.717
NEC for r=0.2 class 0.0 = 0.17 +- 0.321 (in-sample avg dev_std = 0.157)
NEC for r=0.2 class 1.0 = 0.214 +- 0.321 (in-sample avg dev_std = 0.157)
NEC for r=0.2 all KL = 0.189 +- 0.321 (in-sample avg dev_std = 0.157)
NEC for r=0.2 all L1 = 0.192 +- 0.279 (in-sample avg dev_std = 0.157)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.763
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06428500000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.678
NEC for r=0.4 class 0.0 = 0.241 +- 0.375 (in-sample avg dev_std = 0.275)
NEC for r=0.4 class 1.0 = 0.317 +- 0.375 (in-sample avg dev_std = 0.275)
NEC for r=0.4 all KL = 0.296 +- 0.375 (in-sample avg dev_std = 0.275)
NEC for r=0.4 all L1 = 0.279 +- 0.318 (in-sample avg dev_std = 0.275)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0798366
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.664
NEC for r=0.8 class 0.0 = 0.304 +- 0.376 (in-sample avg dev_std = 0.393)
NEC for r=0.8 class 1.0 = 0.338 +- 0.376 (in-sample avg dev_std = 0.393)
NEC for r=0.8 all KL = 0.367 +- 0.376 (in-sample avg dev_std = 0.393)
NEC for r=0.8 all L1 = 0.321 +- 0.306 (in-sample avg dev_std = 0.393)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 01:06:39 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 01:06:39 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round2/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9700
Train Loss: 0.0818
ID Validation ACCURACY: 0.9700
ID Validation Loss: 0.0822
ID Test ACCURACY: 0.9600
ID Test Loss: 0.1012
OOD Validation ACCURACY: 0.9700
OOD Validation Loss: 0.0822
OOD Test ACCURACY: 0.9600
OOD Test Loss: 0.1012

[0m[1;37mINFO[0m: [1mChartInfo 0.9600 0.9600 0.9600 0.9600 0.9700 0.9700[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.055
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.064
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.079
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.083
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.067
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 2 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.054596
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.487
SUFF_SIMPLE for r=0.05 class 0.0 = 0.789 +- 0.425 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.216 +- 0.425 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.05 all KL = 0.379 +- 0.425 (in-sample avg dev_std = 0.437)
SUFF_SIMPLE for r=0.05 all L1 = 0.471 +- 0.341 (in-sample avg dev_std = 0.437)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06373
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.495
SUFF_SIMPLE for r=0.1 class 0.0 = 0.802 +- 0.432 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.221 +- 0.432 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all KL = 0.394 +- 0.432 (in-sample avg dev_std = 0.427)
SUFF_SIMPLE for r=0.1 all L1 = 0.48 +- 0.349 (in-sample avg dev_std = 0.427)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071076
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.483
SUFF_SIMPLE for r=0.2 class 0.0 = 0.805 +- 0.434 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.206 +- 0.434 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.2 all KL = 0.389 +- 0.434 (in-sample avg dev_std = 0.419)
SUFF_SIMPLE for r=0.2 all L1 = 0.473 +- 0.353 (in-sample avg dev_std = 0.419)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07916399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.479
SUFF_SIMPLE for r=0.4 class 0.0 = 0.793 +- 0.436 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.211 +- 0.436 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 all KL = 0.392 +- 0.436 (in-sample avg dev_std = 0.391)
SUFF_SIMPLE for r=0.4 all L1 = 0.471 +- 0.357 (in-sample avg dev_std = 0.391)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08348399999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.576
SUFF_SIMPLE for r=0.8 class 0.0 = 0.827 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.39 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.536 +- 0.452 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.585 +- 0.386 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009916000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
SUFF_SIMPLE for r=0.05 class 0.0 = 0.993 +- 0.243 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.808 +- 0.243 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.05 all KL = 0.904 +- 0.243 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.05 all L1 = 0.9 +- 0.231 (in-sample avg dev_std = 0.119)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0099
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
SUFF_SIMPLE for r=0.1 class 0.0 = 0.993 +- 0.243 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.808 +- 0.243 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 all KL = 0.904 +- 0.243 (in-sample avg dev_std = 0.119)
SUFF_SIMPLE for r=0.1 all L1 = 0.9 +- 0.231 (in-sample avg dev_std = 0.119)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010028
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.994 +- 0.241 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.808 +- 0.241 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.2 all KL = 0.905 +- 0.241 (in-sample avg dev_std = 0.112)
SUFF_SIMPLE for r=0.2 all L1 = 0.9 +- 0.231 (in-sample avg dev_std = 0.112)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009947800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.497
SUFF_SIMPLE for r=0.4 class 0.0 = 0.994 +- 0.243 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.808 +- 0.243 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.4 all KL = 0.905 +- 0.243 (in-sample avg dev_std = 0.106)
SUFF_SIMPLE for r=0.4 all L1 = 0.9 +- 0.232 (in-sample avg dev_std = 0.106)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099608
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.501
SUFF_SIMPLE for r=0.8 class 0.0 = 0.996 +- 0.233 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.814 +- 0.233 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.914 +- 0.233 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.904 +- 0.229 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0332188
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.585
SUFF_SIMPLE for r=0.05 class 0.0 = 0.649 +- 0.432 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.344 +- 0.432 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.05 all KL = 0.345 +- 0.432 (in-sample avg dev_std = 0.493)
SUFF_SIMPLE for r=0.05 all L1 = 0.498 +- 0.341 (in-sample avg dev_std = 0.493)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042681000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.585
SUFF_SIMPLE for r=0.1 class 0.0 = 0.654 +- 0.439 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.341 +- 0.439 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.1 all KL = 0.356 +- 0.439 (in-sample avg dev_std = 0.482)
SUFF_SIMPLE for r=0.1 all L1 = 0.499 +- 0.347 (in-sample avg dev_std = 0.482)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05388720000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.584
SUFF_SIMPLE for r=0.2 class 0.0 = 0.66 +- 0.445 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.344 +- 0.445 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.2 all KL = 0.371 +- 0.445 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.2 all L1 = 0.504 +- 0.355 (in-sample avg dev_std = 0.457)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06665940000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.573
SUFF_SIMPLE for r=0.4 class 0.0 = 0.657 +- 0.452 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.359 +- 0.452 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all KL = 0.389 +- 0.452 (in-sample avg dev_std = 0.428)
SUFF_SIMPLE for r=0.4 all L1 = 0.51 +- 0.364 (in-sample avg dev_std = 0.428)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08023759999999999
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.644
SUFF_SIMPLE for r=0.8 class 0.0 = 0.742 +- 0.466 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.549 +- 0.466 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.8 all KL = 0.574 +- 0.466 (in-sample avg dev_std = 0.120)
SUFF_SIMPLE for r=0.8 all L1 = 0.646 +- 0.387 (in-sample avg dev_std = 0.120)


Evaluating NEC for seed 2 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.97
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.054596
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.794
NEC for r=0.05 class 0.0 = 0.127 +- 0.380 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.32 +- 0.380 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.253 +- 0.380 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.234 +- 0.327 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.97
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06373
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.689
NEC for r=0.1 class 0.0 = 0.159 +- 0.433 (in-sample avg dev_std = 0.064)
NEC for r=0.1 class 1.0 = 0.469 +- 0.433 (in-sample avg dev_std = 0.064)
NEC for r=0.1 all KL = 0.375 +- 0.433 (in-sample avg dev_std = 0.064)
NEC for r=0.1 all L1 = 0.331 +- 0.365 (in-sample avg dev_std = 0.064)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.97
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.071076
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.583
NEC for r=0.2 class 0.0 = 0.197 +- 0.443 (in-sample avg dev_std = 0.339)
NEC for r=0.2 class 1.0 = 0.631 +- 0.443 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all KL = 0.516 +- 0.443 (in-sample avg dev_std = 0.339)
NEC for r=0.2 all L1 = 0.438 +- 0.362 (in-sample avg dev_std = 0.339)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.97
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07916399999999998
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.569
NEC for r=0.4 class 0.0 = 0.221 +- 0.422 (in-sample avg dev_std = 0.470)
NEC for r=0.4 class 1.0 = 0.672 +- 0.422 (in-sample avg dev_std = 0.470)
NEC for r=0.4 all KL = 0.576 +- 0.422 (in-sample avg dev_std = 0.470)
NEC for r=0.4 all L1 = 0.471 +- 0.338 (in-sample avg dev_std = 0.470)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.97
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08348399999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.549
NEC for r=0.8 class 0.0 = 0.225 +- 0.416 (in-sample avg dev_std = 0.551)
NEC for r=0.8 class 1.0 = 0.715 +- 0.416 (in-sample avg dev_std = 0.551)
NEC for r=0.8 all KL = 0.615 +- 0.416 (in-sample avg dev_std = 0.551)
NEC for r=0.8 all L1 = 0.497 +- 0.324 (in-sample avg dev_std = 0.551)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.575
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009916000000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.514
NEC for r=0.05 class 0.0 = 0.003 +- 0.209 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.168 +- 0.209 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.074 +- 0.209 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.086 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.575
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0099
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.504
NEC for r=0.1 class 0.0 = 0.003 +- 0.228 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.183 +- 0.228 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.084 +- 0.228 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.094 +- 0.226 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.575
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010028
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.499
NEC for r=0.2 class 0.0 = 0.005 +- 0.235 (in-sample avg dev_std = 0.046)
NEC for r=0.2 class 1.0 = 0.187 +- 0.235 (in-sample avg dev_std = 0.046)
NEC for r=0.2 all KL = 0.087 +- 0.235 (in-sample avg dev_std = 0.046)
NEC for r=0.2 all L1 = 0.096 +- 0.230 (in-sample avg dev_std = 0.046)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.575
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009947800000000001
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.499
NEC for r=0.4 class 0.0 = 0.008 +- 0.243 (in-sample avg dev_std = 0.125)
NEC for r=0.4 class 1.0 = 0.191 +- 0.243 (in-sample avg dev_std = 0.125)
NEC for r=0.4 all KL = 0.095 +- 0.243 (in-sample avg dev_std = 0.125)
NEC for r=0.4 all L1 = 0.1 +- 0.230 (in-sample avg dev_std = 0.125)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.575
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099608
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.5
NEC for r=0.8 class 0.0 = 0.007 +- 0.242 (in-sample avg dev_std = 0.133)
NEC for r=0.8 class 1.0 = 0.19 +- 0.242 (in-sample avg dev_std = 0.133)
NEC for r=0.8 all KL = 0.095 +- 0.242 (in-sample avg dev_std = 0.133)
NEC for r=0.8 all L1 = 0.099 +- 0.229 (in-sample avg dev_std = 0.133)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.762
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0332188
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.735
NEC for r=0.05 class 0.0 = 0.112 +- 0.336 (in-sample avg dev_std = 0.006)
NEC for r=0.05 class 1.0 = 0.147 +- 0.336 (in-sample avg dev_std = 0.006)
NEC for r=0.05 all KL = 0.151 +- 0.336 (in-sample avg dev_std = 0.006)
NEC for r=0.05 all L1 = 0.129 +- 0.275 (in-sample avg dev_std = 0.006)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.762
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.042681000000000004
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.71
NEC for r=0.1 class 0.0 = 0.169 +- 0.408 (in-sample avg dev_std = 0.110)
NEC for r=0.1 class 1.0 = 0.249 +- 0.408 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all KL = 0.252 +- 0.408 (in-sample avg dev_std = 0.110)
NEC for r=0.1 all L1 = 0.209 +- 0.333 (in-sample avg dev_std = 0.110)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.762
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05388720000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.667
NEC for r=0.2 class 0.0 = 0.241 +- 0.454 (in-sample avg dev_std = 0.295)
NEC for r=0.2 class 1.0 = 0.38 +- 0.454 (in-sample avg dev_std = 0.295)
NEC for r=0.2 all KL = 0.392 +- 0.454 (in-sample avg dev_std = 0.295)
NEC for r=0.2 all L1 = 0.309 +- 0.363 (in-sample avg dev_std = 0.295)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.762
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06665940000000001
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.632
NEC for r=0.4 class 0.0 = 0.292 +- 0.451 (in-sample avg dev_std = 0.440)
NEC for r=0.4 class 1.0 = 0.489 +- 0.451 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all KL = 0.521 +- 0.451 (in-sample avg dev_std = 0.440)
NEC for r=0.4 all L1 = 0.389 +- 0.355 (in-sample avg dev_std = 0.440)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.762
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08023759999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.631
NEC for r=0.8 class 0.0 = 0.297 +- 0.434 (in-sample avg dev_std = 0.525)
NEC for r=0.8 class 1.0 = 0.529 +- 0.434 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all KL = 0.58 +- 0.434 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all L1 = 0.412 +- 0.336 (in-sample avg dev_std = 0.525)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 01:22:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 01:22:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 86 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round3/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 86...
[0m[1;37mINFO[0m: [1mCheckpoint 86: 
-----------------------------------
Train ACCURACY: 0.9728
Train Loss: 0.0873
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0885
ID Test ACCURACY: 0.9620
ID Test Loss: 0.0993
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0885
OOD Test ACCURACY: 0.9620
OOD Test Loss: 0.0993

[0m[1;37mINFO[0m: [1mChartInfo 0.9620 0.9620 0.9620 0.9620 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.052
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.060
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.071
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.085
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.035
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.054
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 3 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052216000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.499
SUFF_SIMPLE for r=0.05 class 0.0 = 0.828 +- 0.433 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.233 +- 0.433 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.05 all KL = 0.429 +- 0.433 (in-sample avg dev_std = 0.399)
SUFF_SIMPLE for r=0.05 all L1 = 0.498 +- 0.349 (in-sample avg dev_std = 0.399)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.060155999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.494
SUFF_SIMPLE for r=0.1 class 0.0 = 0.821 +- 0.436 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.238 +- 0.436 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.1 all KL = 0.434 +- 0.436 (in-sample avg dev_std = 0.386)
SUFF_SIMPLE for r=0.1 all L1 = 0.498 +- 0.358 (in-sample avg dev_std = 0.386)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07136200000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.488
SUFF_SIMPLE for r=0.2 class 0.0 = 0.84 +- 0.436 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.217 +- 0.436 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.2 all KL = 0.434 +- 0.436 (in-sample avg dev_std = 0.372)
SUFF_SIMPLE for r=0.2 all L1 = 0.495 +- 0.360 (in-sample avg dev_std = 0.372)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07992999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.48
SUFF_SIMPLE for r=0.4 class 0.0 = 0.842 +- 0.441 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.207 +- 0.441 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.4 all KL = 0.43 +- 0.441 (in-sample avg dev_std = 0.336)
SUFF_SIMPLE for r=0.4 all L1 = 0.49 +- 0.364 (in-sample avg dev_std = 0.336)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085024
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.566
SUFF_SIMPLE for r=0.8 class 0.0 = 0.837 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.382 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.545 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.585 +- 0.380 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009889
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.996 +- 0.218 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.846 +- 0.218 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.05 all KL = 0.927 +- 0.218 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.05 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.051)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010015000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.217 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.846 +- 0.217 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.1 all KL = 0.927 +- 0.217 (in-sample avg dev_std = 0.052)
SUFF_SIMPLE for r=0.1 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.052)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010157000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.996 +- 0.217 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.847 +- 0.217 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.2 all KL = 0.927 +- 0.217 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.2 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.054)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.218 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.846 +- 0.218 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.4 all KL = 0.927 +- 0.218 (in-sample avg dev_std = 0.041)
SUFF_SIMPLE for r=0.4 all L1 = 0.921 +- 0.214 (in-sample avg dev_std = 0.041)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099502
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.85 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.93 +- 0.212 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.923 +- 0.210 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0345068
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.594
SUFF_SIMPLE for r=0.05 class 0.0 = 0.657 +- 0.413 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.345 +- 0.413 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 all KL = 0.386 +- 0.413 (in-sample avg dev_std = 0.474)
SUFF_SIMPLE for r=0.05 all L1 = 0.503 +- 0.326 (in-sample avg dev_std = 0.474)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043183799999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.593
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.419 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.34 +- 0.419 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.1 all KL = 0.399 +- 0.419 (in-sample avg dev_std = 0.455)
SUFF_SIMPLE for r=0.1 all L1 = 0.506 +- 0.335 (in-sample avg dev_std = 0.455)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0541518
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.589
SUFF_SIMPLE for r=0.2 class 0.0 = 0.672 +- 0.426 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.338 +- 0.426 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.2 all KL = 0.406 +- 0.426 (in-sample avg dev_std = 0.444)
SUFF_SIMPLE for r=0.2 all L1 = 0.507 +- 0.341 (in-sample avg dev_std = 0.444)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661512
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.576
SUFF_SIMPLE for r=0.4 class 0.0 = 0.669 +- 0.433 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.34 +- 0.433 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.4 all KL = 0.418 +- 0.433 (in-sample avg dev_std = 0.415)
SUFF_SIMPLE for r=0.4 all L1 = 0.507 +- 0.351 (in-sample avg dev_std = 0.415)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0795928
len(reference) = 4987
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.644
SUFF_SIMPLE for r=0.8 class 0.0 = 0.751 +- 0.440 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.535 +- 0.440 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 all KL = 0.601 +- 0.440 (in-sample avg dev_std = 0.079)
SUFF_SIMPLE for r=0.8 all L1 = 0.644 +- 0.372 (in-sample avg dev_std = 0.079)


Evaluating NEC for seed 3 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.052216000000000005
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.83
NEC for r=0.05 class 0.0 = 0.101 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.272 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.195 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.196 +- 0.290 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.060155999999999994
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.696
NEC for r=0.1 class 0.0 = 0.139 +- 0.408 (in-sample avg dev_std = 0.011)
NEC for r=0.1 class 1.0 = 0.438 +- 0.408 (in-sample avg dev_std = 0.011)
NEC for r=0.1 all KL = 0.324 +- 0.408 (in-sample avg dev_std = 0.011)
NEC for r=0.1 all L1 = 0.304 +- 0.350 (in-sample avg dev_std = 0.011)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07136200000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.614
NEC for r=0.2 class 0.0 = 0.167 +- 0.428 (in-sample avg dev_std = 0.300)
NEC for r=0.2 class 1.0 = 0.587 +- 0.428 (in-sample avg dev_std = 0.300)
NEC for r=0.2 all KL = 0.453 +- 0.428 (in-sample avg dev_std = 0.300)
NEC for r=0.2 all L1 = 0.4 +- 0.356 (in-sample avg dev_std = 0.300)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07992999999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.553
NEC for r=0.4 class 0.0 = 0.2 +- 0.422 (in-sample avg dev_std = 0.452)
NEC for r=0.4 class 1.0 = 0.676 +- 0.422 (in-sample avg dev_std = 0.452)
NEC for r=0.4 all KL = 0.544 +- 0.422 (in-sample avg dev_std = 0.452)
NEC for r=0.4 all L1 = 0.464 +- 0.342 (in-sample avg dev_std = 0.452)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.085024
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.551
NEC for r=0.8 class 0.0 = 0.194 +- 0.414 (in-sample avg dev_std = 0.528)
NEC for r=0.8 class 1.0 = 0.715 +- 0.414 (in-sample avg dev_std = 0.528)
NEC for r=0.8 all KL = 0.577 +- 0.414 (in-sample avg dev_std = 0.528)
NEC for r=0.8 all L1 = 0.482 +- 0.323 (in-sample avg dev_std = 0.528)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009889
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.517
NEC for r=0.05 class 0.0 = 0.005 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.122 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.052 +- 0.172 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.064 +- 0.180 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010015000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.506
NEC for r=0.1 class 0.0 = 0.006 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.141 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.065 +- 0.202 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.074 +- 0.202 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.010157000000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
NEC for r=0.2 class 0.0 = 0.005 +- 0.215 (in-sample avg dev_std = 0.032)
NEC for r=0.2 class 1.0 = 0.15 +- 0.215 (in-sample avg dev_std = 0.032)
NEC for r=0.2 all KL = 0.071 +- 0.215 (in-sample avg dev_std = 0.032)
NEC for r=0.2 all L1 = 0.078 +- 0.212 (in-sample avg dev_std = 0.032)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100124
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.005 +- 0.217 (in-sample avg dev_std = 0.090)
NEC for r=0.4 class 1.0 = 0.152 +- 0.217 (in-sample avg dev_std = 0.090)
NEC for r=0.4 all KL = 0.073 +- 0.217 (in-sample avg dev_std = 0.090)
NEC for r=0.4 all L1 = 0.079 +- 0.212 (in-sample avg dev_std = 0.090)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099502
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.005 +- 0.217 (in-sample avg dev_std = 0.096)
NEC for r=0.8 class 1.0 = 0.152 +- 0.217 (in-sample avg dev_std = 0.096)
NEC for r=0.8 all KL = 0.073 +- 0.217 (in-sample avg dev_std = 0.096)
NEC for r=0.8 all L1 = 0.079 +- 0.211 (in-sample avg dev_std = 0.096)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0345068
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.767
NEC for r=0.05 class 0.0 = 0.115 +- 0.298 (in-sample avg dev_std = 0.009)
NEC for r=0.05 class 1.0 = 0.134 +- 0.298 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all KL = 0.133 +- 0.298 (in-sample avg dev_std = 0.009)
NEC for r=0.05 all L1 = 0.124 +- 0.250 (in-sample avg dev_std = 0.009)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.043183799999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.748
NEC for r=0.1 class 0.0 = 0.178 +- 0.371 (in-sample avg dev_std = 0.094)
NEC for r=0.1 class 1.0 = 0.233 +- 0.371 (in-sample avg dev_std = 0.094)
NEC for r=0.1 all KL = 0.23 +- 0.371 (in-sample avg dev_std = 0.094)
NEC for r=0.1 all L1 = 0.205 +- 0.311 (in-sample avg dev_std = 0.094)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0541518
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.7
NEC for r=0.2 class 0.0 = 0.245 +- 0.416 (in-sample avg dev_std = 0.248)
NEC for r=0.2 class 1.0 = 0.362 +- 0.416 (in-sample avg dev_std = 0.248)
NEC for r=0.2 all KL = 0.353 +- 0.416 (in-sample avg dev_std = 0.248)
NEC for r=0.2 all L1 = 0.303 +- 0.347 (in-sample avg dev_std = 0.248)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0661512
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.656
NEC for r=0.4 class 0.0 = 0.28 +- 0.423 (in-sample avg dev_std = 0.388)
NEC for r=0.4 class 1.0 = 0.462 +- 0.423 (in-sample avg dev_std = 0.388)
NEC for r=0.4 all KL = 0.453 +- 0.423 (in-sample avg dev_std = 0.388)
NEC for r=0.4 all L1 = 0.37 +- 0.345 (in-sample avg dev_std = 0.388)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0795928
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.649
NEC for r=0.8 class 0.0 = 0.286 +- 0.415 (in-sample avg dev_std = 0.463)
NEC for r=0.8 class 1.0 = 0.493 +- 0.415 (in-sample avg dev_std = 0.463)
NEC for r=0.8 all KL = 0.489 +- 0.415 (in-sample avg dev_std = 0.463)
NEC for r=0.8 all L1 = 0.388 +- 0.332 (in-sample avg dev_std = 0.463)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 01:37:00 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 01:37:00 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round4/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9633
Train Loss: 0.0971
ID Validation ACCURACY: 0.9680
ID Validation Loss: 0.1074
ID Test ACCURACY: 0.9440
ID Test Loss: 0.1247
OOD Validation ACCURACY: 0.9680
OOD Validation Loss: 0.1074
OOD Test ACCURACY: 0.9440
OOD Test Loss: 0.1247

[0m[1;37mINFO[0m: [1mChartInfo 0.9440 0.9440 0.9440 0.9440 0.9680 0.9680[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.050
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.057
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.072
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.032
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.041
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 4 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.049656000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.487
SUFF_SIMPLE for r=0.05 class 0.0 = 0.825 +- 0.437 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.216 +- 0.437 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.05 all KL = 0.43 +- 0.437 (in-sample avg dev_std = 0.258)
SUFF_SIMPLE for r=0.05 all L1 = 0.488 +- 0.363 (in-sample avg dev_std = 0.258)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.056898
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.474
SUFF_SIMPLE for r=0.1 class 0.0 = 0.817 +- 0.439 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.21 +- 0.439 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.1 all KL = 0.427 +- 0.439 (in-sample avg dev_std = 0.239)
SUFF_SIMPLE for r=0.1 all L1 = 0.481 +- 0.365 (in-sample avg dev_std = 0.239)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06566799999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.459
SUFF_SIMPLE for r=0.2 class 0.0 = 0.836 +- 0.446 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.188 +- 0.446 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all KL = 0.43 +- 0.446 (in-sample avg dev_std = 0.189)
SUFF_SIMPLE for r=0.2 all L1 = 0.477 +- 0.373 (in-sample avg dev_std = 0.189)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07182599999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.463
SUFF_SIMPLE for r=0.4 class 0.0 = 0.851 +- 0.452 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.187 +- 0.452 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.4 all KL = 0.44 +- 0.452 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.4 all L1 = 0.483 +- 0.378 (in-sample avg dev_std = 0.134)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.526
SUFF_SIMPLE for r=0.8 class 0.0 = 0.851 +- 0.450 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.279 +- 0.450 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.494 +- 0.450 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.534 +- 0.380 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0097578
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009645
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009702800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009762
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097938
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.889 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.953 +- 0.166 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.944 +- 0.174 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0322302
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.542
SUFF_SIMPLE for r=0.05 class 0.0 = 0.615 +- 0.420 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.286 +- 0.420 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.05 all KL = 0.341 +- 0.420 (in-sample avg dev_std = 0.466)
SUFF_SIMPLE for r=0.05 all L1 = 0.453 +- 0.345 (in-sample avg dev_std = 0.466)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0411626
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.539
SUFF_SIMPLE for r=0.1 class 0.0 = 0.633 +- 0.430 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.281 +- 0.430 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.1 all KL = 0.358 +- 0.430 (in-sample avg dev_std = 0.439)
SUFF_SIMPLE for r=0.1 all L1 = 0.459 +- 0.355 (in-sample avg dev_std = 0.439)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05165940000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.534
SUFF_SIMPLE for r=0.2 class 0.0 = 0.647 +- 0.442 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.28 +- 0.442 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.2 all KL = 0.377 +- 0.442 (in-sample avg dev_std = 0.410)
SUFF_SIMPLE for r=0.2 all L1 = 0.466 +- 0.365 (in-sample avg dev_std = 0.410)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0649006
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.513
SUFF_SIMPLE for r=0.4 class 0.0 = 0.654 +- 0.447 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.27 +- 0.447 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.4 all KL = 0.383 +- 0.447 (in-sample avg dev_std = 0.353)
SUFF_SIMPLE for r=0.4 all L1 = 0.464 +- 0.373 (in-sample avg dev_std = 0.353)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0788566
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.562
SUFF_SIMPLE for r=0.8 class 0.0 = 0.717 +- 0.471 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.411 +- 0.471 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all KL = 0.508 +- 0.471 (in-sample avg dev_std = 0.062)
SUFF_SIMPLE for r=0.8 all L1 = 0.566 +- 0.403 (in-sample avg dev_std = 0.062)


Evaluating NEC for seed 4 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.968
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.049656000000000006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.806
NEC for r=0.05 class 0.0 = 0.092 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.305 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.205 +- 0.357 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.21 +- 0.316 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.968
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.056898
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.678
NEC for r=0.1 class 0.0 = 0.129 +- 0.423 (in-sample avg dev_std = 0.010)
NEC for r=0.1 class 1.0 = 0.503 +- 0.423 (in-sample avg dev_std = 0.010)
NEC for r=0.1 all KL = 0.358 +- 0.423 (in-sample avg dev_std = 0.010)
NEC for r=0.1 all L1 = 0.336 +- 0.363 (in-sample avg dev_std = 0.010)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.968
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06566799999999999
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.574
NEC for r=0.2 class 0.0 = 0.143 +- 0.442 (in-sample avg dev_std = 0.270)
NEC for r=0.2 class 1.0 = 0.685 +- 0.442 (in-sample avg dev_std = 0.270)
NEC for r=0.2 all KL = 0.488 +- 0.442 (in-sample avg dev_std = 0.270)
NEC for r=0.2 all L1 = 0.443 +- 0.366 (in-sample avg dev_std = 0.270)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.968
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07182599999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.547
NEC for r=0.4 class 0.0 = 0.158 +- 0.430 (in-sample avg dev_std = 0.399)
NEC for r=0.4 class 1.0 = 0.732 +- 0.430 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all KL = 0.54 +- 0.430 (in-sample avg dev_std = 0.399)
NEC for r=0.4 all L1 = 0.476 +- 0.350 (in-sample avg dev_std = 0.399)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.968
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07769200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.54
NEC for r=0.8 class 0.0 = 0.175 +- 0.428 (in-sample avg dev_std = 0.480)
NEC for r=0.8 class 1.0 = 0.75 +- 0.428 (in-sample avg dev_std = 0.480)
NEC for r=0.8 all KL = 0.57 +- 0.428 (in-sample avg dev_std = 0.480)
NEC for r=0.8 all L1 = 0.494 +- 0.340 (in-sample avg dev_std = 0.480)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.537
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0097578
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.506
NEC for r=0.05 class 0.0 = 0.001 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.093 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.033 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.047 +- 0.148 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.537
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009645
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.001 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.108 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.045 +- 0.160 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.055 +- 0.171 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.537
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009702800000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.11 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.047 +- 0.165 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.056 +- 0.174 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.537
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.009762
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.166 (in-sample avg dev_std = 0.010)
NEC for r=0.4 class 1.0 = 0.111 +- 0.166 (in-sample avg dev_std = 0.010)
NEC for r=0.4 all KL = 0.047 +- 0.166 (in-sample avg dev_std = 0.010)
NEC for r=0.4 all L1 = 0.056 +- 0.174 (in-sample avg dev_std = 0.010)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.537
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097938
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.166 (in-sample avg dev_std = 0.002)
NEC for r=0.8 class 1.0 = 0.111 +- 0.166 (in-sample avg dev_std = 0.002)
NEC for r=0.8 all KL = 0.047 +- 0.166 (in-sample avg dev_std = 0.002)
NEC for r=0.8 all L1 = 0.056 +- 0.174 (in-sample avg dev_std = 0.002)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.754
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0322302
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.701
NEC for r=0.05 class 0.0 = 0.119 +- 0.360 (in-sample avg dev_std = 0.024)
NEC for r=0.05 class 1.0 = 0.202 +- 0.360 (in-sample avg dev_std = 0.024)
NEC for r=0.05 all KL = 0.177 +- 0.360 (in-sample avg dev_std = 0.024)
NEC for r=0.05 all L1 = 0.16 +- 0.310 (in-sample avg dev_std = 0.024)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.754
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0411626
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.662
NEC for r=0.1 class 0.0 = 0.191 +- 0.431 (in-sample avg dev_std = 0.137)
NEC for r=0.1 class 1.0 = 0.337 +- 0.431 (in-sample avg dev_std = 0.137)
NEC for r=0.1 all KL = 0.299 +- 0.431 (in-sample avg dev_std = 0.137)
NEC for r=0.1 all L1 = 0.263 +- 0.368 (in-sample avg dev_std = 0.137)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.754
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05165940000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.615
NEC for r=0.2 class 0.0 = 0.257 +- 0.454 (in-sample avg dev_std = 0.331)
NEC for r=0.2 class 1.0 = 0.474 +- 0.454 (in-sample avg dev_std = 0.331)
NEC for r=0.2 all KL = 0.426 +- 0.454 (in-sample avg dev_std = 0.331)
NEC for r=0.2 all L1 = 0.364 +- 0.381 (in-sample avg dev_std = 0.331)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.754
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0649006
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.592
NEC for r=0.4 class 0.0 = 0.299 +- 0.443 (in-sample avg dev_std = 0.453)
NEC for r=0.4 class 1.0 = 0.552 +- 0.443 (in-sample avg dev_std = 0.453)
NEC for r=0.4 all KL = 0.508 +- 0.443 (in-sample avg dev_std = 0.453)
NEC for r=0.4 all L1 = 0.424 +- 0.367 (in-sample avg dev_std = 0.453)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.754
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0788566
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.609
NEC for r=0.8 class 0.0 = 0.31 +- 0.428 (in-sample avg dev_std = 0.525)
NEC for r=0.8 class 1.0 = 0.568 +- 0.428 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all KL = 0.543 +- 0.428 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all L1 = 0.437 +- 0.349 (in-sample avg dev_std = 0.525)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 01:52:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 01:52:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 95 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round5/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 95...
[0m[1;37mINFO[0m: [1mCheckpoint 95: 
-----------------------------------
Train ACCURACY: 0.9698
Train Loss: 0.0868
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0825
ID Test ACCURACY: 0.9500
ID Test Loss: 0.1083
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0825
OOD Test ACCURACY: 0.9500
OOD Test Loss: 0.1083

[0m[1;37mINFO[0m: [1mChartInfo 0.9500 0.9500 0.9500 0.9500 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.056
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.063
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.074
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.080
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.084
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.043
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.053
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.066
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 5 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056016
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.489
SUFF_SIMPLE for r=0.05 class 0.0 = 0.826 +- 0.431 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.21 +- 0.431 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 all KL = 0.43 +- 0.431 (in-sample avg dev_std = 0.290)
SUFF_SIMPLE for r=0.05 all L1 = 0.485 +- 0.355 (in-sample avg dev_std = 0.290)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06277200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.471
SUFF_SIMPLE for r=0.1 class 0.0 = 0.832 +- 0.437 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.197 +- 0.437 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 all KL = 0.432 +- 0.437 (in-sample avg dev_std = 0.221)
SUFF_SIMPLE for r=0.1 all L1 = 0.48 +- 0.362 (in-sample avg dev_std = 0.221)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07413400000000002
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.472
SUFF_SIMPLE for r=0.2 class 0.0 = 0.845 +- 0.442 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.194 +- 0.442 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 all KL = 0.439 +- 0.442 (in-sample avg dev_std = 0.223)
SUFF_SIMPLE for r=0.2 all L1 = 0.484 +- 0.368 (in-sample avg dev_std = 0.223)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07953199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.471
SUFF_SIMPLE for r=0.4 class 0.0 = 0.851 +- 0.444 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.19 +- 0.444 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all KL = 0.445 +- 0.444 (in-sample avg dev_std = 0.182)
SUFF_SIMPLE for r=0.4 all L1 = 0.485 +- 0.371 (in-sample avg dev_std = 0.182)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08368199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.54
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.302 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.516 +- 0.449 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.547 +- 0.381 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009431400000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009599600000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096322
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.997 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.823 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.926 +- 0.198 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.91 +- 0.211 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03302859999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.55
SUFF_SIMPLE for r=0.05 class 0.0 = 0.635 +- 0.414 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.277 +- 0.414 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.05 all KL = 0.364 +- 0.414 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.05 all L1 = 0.458 +- 0.345 (in-sample avg dev_std = 0.446)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0427978
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.55
SUFF_SIMPLE for r=0.1 class 0.0 = 0.651 +- 0.425 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.274 +- 0.425 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all KL = 0.386 +- 0.425 (in-sample avg dev_std = 0.416)
SUFF_SIMPLE for r=0.1 all L1 = 0.465 +- 0.357 (in-sample avg dev_std = 0.416)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052964599999999994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.539
SUFF_SIMPLE for r=0.2 class 0.0 = 0.659 +- 0.432 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.277 +- 0.432 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.2 all KL = 0.403 +- 0.432 (in-sample avg dev_std = 0.390)
SUFF_SIMPLE for r=0.2 all L1 = 0.47 +- 0.366 (in-sample avg dev_std = 0.390)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066387
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.522
SUFF_SIMPLE for r=0.4 class 0.0 = 0.661 +- 0.440 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.286 +- 0.440 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.4 all KL = 0.417 +- 0.440 (in-sample avg dev_std = 0.345)
SUFF_SIMPLE for r=0.4 all L1 = 0.476 +- 0.375 (in-sample avg dev_std = 0.345)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.759
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08038319999999999
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.566
SUFF_SIMPLE for r=0.8 class 0.0 = 0.715 +- 0.460 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.407 +- 0.460 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.8 all KL = 0.521 +- 0.460 (in-sample avg dev_std = 0.045)
SUFF_SIMPLE for r=0.8 all L1 = 0.563 +- 0.402 (in-sample avg dev_std = 0.045)


Evaluating NEC for seed 5 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.056016
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.782
NEC for r=0.05 class 0.0 = 0.085 +- 0.374 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.355 +- 0.374 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.237 +- 0.374 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.235 +- 0.325 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06277200000000001
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.648
NEC for r=0.1 class 0.0 = 0.122 +- 0.431 (in-sample avg dev_std = 0.020)
NEC for r=0.1 class 1.0 = 0.546 +- 0.431 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all KL = 0.375 +- 0.431 (in-sample avg dev_std = 0.020)
NEC for r=0.1 all L1 = 0.357 +- 0.369 (in-sample avg dev_std = 0.020)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07413400000000002
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.548
NEC for r=0.2 class 0.0 = 0.149 +- 0.439 (in-sample avg dev_std = 0.278)
NEC for r=0.2 class 1.0 = 0.705 +- 0.439 (in-sample avg dev_std = 0.278)
NEC for r=0.2 all KL = 0.5 +- 0.439 (in-sample avg dev_std = 0.278)
NEC for r=0.2 all L1 = 0.457 +- 0.366 (in-sample avg dev_std = 0.278)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07953199999999999
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.511
NEC for r=0.4 class 0.0 = 0.172 +- 0.428 (in-sample avg dev_std = 0.394)
NEC for r=0.4 class 1.0 = 0.756 +- 0.428 (in-sample avg dev_std = 0.394)
NEC for r=0.4 all KL = 0.554 +- 0.428 (in-sample avg dev_std = 0.394)
NEC for r=0.4 all L1 = 0.495 +- 0.350 (in-sample avg dev_std = 0.394)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08368199999999999
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.514
NEC for r=0.8 class 0.0 = 0.167 +- 0.427 (in-sample avg dev_std = 0.452)
NEC for r=0.8 class 1.0 = 0.778 +- 0.427 (in-sample avg dev_std = 0.452)
NEC for r=0.8 all KL = 0.569 +- 0.427 (in-sample avg dev_std = 0.452)
NEC for r=0.8 all L1 = 0.506 +- 0.343 (in-sample avg dev_std = 0.452)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.559
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009431400000000001
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.507
NEC for r=0.05 class 0.0 = 0.003 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.152 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.055 +- 0.157 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.078 +- 0.184 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.559
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009507000000000002
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
NEC for r=0.1 class 0.0 = 0.003 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.173 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.071 +- 0.191 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.089 +- 0.206 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.559
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009599600000000002
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.003 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.176 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.074 +- 0.197 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.09 +- 0.210 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.559
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096322
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.003 +- 0.198 (in-sample avg dev_std = 0.019)
NEC for r=0.4 class 1.0 = 0.177 +- 0.198 (in-sample avg dev_std = 0.019)
NEC for r=0.4 all KL = 0.074 +- 0.198 (in-sample avg dev_std = 0.019)
NEC for r=0.4 all L1 = 0.09 +- 0.210 (in-sample avg dev_std = 0.019)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.559
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009658
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.003 +- 0.198 (in-sample avg dev_std = 0.006)
NEC for r=0.8 class 1.0 = 0.177 +- 0.198 (in-sample avg dev_std = 0.006)
NEC for r=0.8 all KL = 0.074 +- 0.198 (in-sample avg dev_std = 0.006)
NEC for r=0.8 all L1 = 0.09 +- 0.211 (in-sample avg dev_std = 0.006)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.758
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.03302859999999999
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.689
NEC for r=0.05 class 0.0 = 0.124 +- 0.366 (in-sample avg dev_std = 0.012)
NEC for r=0.05 class 1.0 = 0.24 +- 0.366 (in-sample avg dev_std = 0.012)
NEC for r=0.05 all KL = 0.189 +- 0.366 (in-sample avg dev_std = 0.012)
NEC for r=0.05 all L1 = 0.181 +- 0.321 (in-sample avg dev_std = 0.012)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.758
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0427978
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.641
NEC for r=0.1 class 0.0 = 0.19 +- 0.429 (in-sample avg dev_std = 0.135)
NEC for r=0.1 class 1.0 = 0.386 +- 0.429 (in-sample avg dev_std = 0.135)
NEC for r=0.1 all KL = 0.309 +- 0.429 (in-sample avg dev_std = 0.135)
NEC for r=0.1 all L1 = 0.287 +- 0.373 (in-sample avg dev_std = 0.135)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.758
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.052964599999999994
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.598
NEC for r=0.2 class 0.0 = 0.255 +- 0.447 (in-sample avg dev_std = 0.333)
NEC for r=0.2 class 1.0 = 0.517 +- 0.447 (in-sample avg dev_std = 0.333)
NEC for r=0.2 all KL = 0.429 +- 0.447 (in-sample avg dev_std = 0.333)
NEC for r=0.2 all L1 = 0.385 +- 0.381 (in-sample avg dev_std = 0.333)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.758
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.066387
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.584
NEC for r=0.4 class 0.0 = 0.291 +- 0.434 (in-sample avg dev_std = 0.460)
NEC for r=0.4 class 1.0 = 0.586 +- 0.434 (in-sample avg dev_std = 0.460)
NEC for r=0.4 all KL = 0.501 +- 0.434 (in-sample avg dev_std = 0.460)
NEC for r=0.4 all L1 = 0.436 +- 0.363 (in-sample avg dev_std = 0.460)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.758
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08038319999999999
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.593
NEC for r=0.8 class 0.0 = 0.3 +- 0.425 (in-sample avg dev_std = 0.524)
NEC for r=0.8 class 1.0 = 0.608 +- 0.425 (in-sample avg dev_std = 0.524)
NEC for r=0.8 all KL = 0.538 +- 0.425 (in-sample avg dev_std = 0.524)
NEC for r=0.8 all L1 = 0.452 +- 0.346 (in-sample avg dev_std = 0.524)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 02:07:19 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 02:07:20 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round6/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9595
Train Loss: 0.1244
ID Validation ACCURACY: 0.9560
ID Validation Loss: 0.1369
ID Test ACCURACY: 0.9460
ID Test Loss: 0.1366
OOD Validation ACCURACY: 0.9560
OOD Validation Loss: 0.1369
OOD Test ACCURACY: 0.9460
OOD Test Loss: 0.1366

[0m[1;37mINFO[0m: [1mChartInfo 0.9460 0.9460 0.9460 0.9460 0.9560 0.9560[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.042
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.051
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.062
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.078
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.031
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.039
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.051
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 6 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.042006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.462
SUFF_SIMPLE for r=0.05 class 0.0 = 0.834 +- 0.423 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.194 +- 0.423 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all KL = 0.442 +- 0.423 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.05 all L1 = 0.479 +- 0.361 (in-sample avg dev_std = 0.134)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051398000000000006
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.462
SUFF_SIMPLE for r=0.1 class 0.0 = 0.831 +- 0.429 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.201 +- 0.429 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.1 all KL = 0.449 +- 0.429 (in-sample avg dev_std = 0.109)
SUFF_SIMPLE for r=0.1 all L1 = 0.482 +- 0.367 (in-sample avg dev_std = 0.109)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.062258
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.456
SUFF_SIMPLE for r=0.2 class 0.0 = 0.842 +- 0.431 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.184 +- 0.431 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.2 all KL = 0.446 +- 0.431 (in-sample avg dev_std = 0.089)
SUFF_SIMPLE for r=0.2 all L1 = 0.478 +- 0.368 (in-sample avg dev_std = 0.089)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071108
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.447
SUFF_SIMPLE for r=0.4 class 0.0 = 0.842 +- 0.434 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.178 +- 0.434 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.4 all KL = 0.445 +- 0.434 (in-sample avg dev_std = 0.069)
SUFF_SIMPLE for r=0.4 all L1 = 0.474 +- 0.372 (in-sample avg dev_std = 0.069)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078322
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.494
SUFF_SIMPLE for r=0.8 class 0.0 = 0.852 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.236 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.487 +- 0.436 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.511 +- 0.376 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090484
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009418
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009648400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00977
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097698
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.968 +- 0.106 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.133 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0306144
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.551
SUFF_SIMPLE for r=0.05 class 0.0 = 0.656 +- 0.408 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.311 +- 0.408 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.05 all KL = 0.394 +- 0.408 (in-sample avg dev_std = 0.461)
SUFF_SIMPLE for r=0.05 all L1 = 0.486 +- 0.344 (in-sample avg dev_std = 0.461)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0393344
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.548
SUFF_SIMPLE for r=0.1 class 0.0 = 0.667 +- 0.415 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.311 +- 0.415 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.1 all KL = 0.411 +- 0.415 (in-sample avg dev_std = 0.450)
SUFF_SIMPLE for r=0.1 all L1 = 0.491 +- 0.350 (in-sample avg dev_std = 0.450)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0511508
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.547
SUFF_SIMPLE for r=0.2 class 0.0 = 0.673 +- 0.423 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.315 +- 0.423 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.2 all KL = 0.43 +- 0.423 (in-sample avg dev_std = 0.434)
SUFF_SIMPLE for r=0.2 all L1 = 0.496 +- 0.359 (in-sample avg dev_std = 0.434)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0650544
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.541
SUFF_SIMPLE for r=0.4 class 0.0 = 0.676 +- 0.427 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.32 +- 0.427 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.4 all KL = 0.444 +- 0.427 (in-sample avg dev_std = 0.420)
SUFF_SIMPLE for r=0.4 all L1 = 0.5 +- 0.364 (in-sample avg dev_std = 0.420)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790352
len(reference) = 4982
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.594
SUFF_SIMPLE for r=0.8 class 0.0 = 0.739 +- 0.449 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.482 +- 0.449 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 all KL = 0.587 +- 0.449 (in-sample avg dev_std = 0.092)
SUFF_SIMPLE for r=0.8 all L1 = 0.612 +- 0.394 (in-sample avg dev_std = 0.092)


Evaluating NEC for seed 6 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.956
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.042006
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.732
NEC for r=0.05 class 0.0 = 0.118 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.428 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.273 +- 0.366 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.29 +- 0.331 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.956
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051398000000000006
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.584
NEC for r=0.1 class 0.0 = 0.146 +- 0.419 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.64 +- 0.419 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.432 +- 0.419 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.42 +- 0.365 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.956
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.062258
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.511
NEC for r=0.2 class 0.0 = 0.154 +- 0.430 (in-sample avg dev_std = 0.144)
NEC for r=0.2 class 1.0 = 0.744 +- 0.430 (in-sample avg dev_std = 0.144)
NEC for r=0.2 all KL = 0.506 +- 0.430 (in-sample avg dev_std = 0.144)
NEC for r=0.2 all L1 = 0.481 +- 0.370 (in-sample avg dev_std = 0.144)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.956
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.071108
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.468
NEC for r=0.4 class 0.0 = 0.158 +- 0.433 (in-sample avg dev_std = 0.196)
NEC for r=0.4 class 1.0 = 0.802 +- 0.433 (in-sample avg dev_std = 0.196)
NEC for r=0.4 all KL = 0.545 +- 0.433 (in-sample avg dev_std = 0.196)
NEC for r=0.4 all L1 = 0.515 +- 0.368 (in-sample avg dev_std = 0.196)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.956
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.078322
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.47
NEC for r=0.8 class 0.0 = 0.165 +- 0.425 (in-sample avg dev_std = 0.242)
NEC for r=0.8 class 1.0 = 0.809 +- 0.425 (in-sample avg dev_std = 0.242)
NEC for r=0.8 all KL = 0.559 +- 0.425 (in-sample avg dev_std = 0.242)
NEC for r=0.8 all L1 = 0.522 +- 0.361 (in-sample avg dev_std = 0.242)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.513
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0090484
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.497
NEC for r=0.05 class 0.0 = 0.001 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.086 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.028 +- 0.096 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.044 +- 0.127 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.513
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009418
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.513
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.009648400000000001
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.513
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.00977
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.513
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0097698
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.09 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.032 +- 0.106 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.046 +- 0.133 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.747
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0306144
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.7
NEC for r=0.05 class 0.0 = 0.114 +- 0.331 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.198 +- 0.331 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.156 +- 0.331 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.156 +- 0.298 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.747
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0393344
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.659
NEC for r=0.1 class 0.0 = 0.18 +- 0.404 (in-sample avg dev_std = 0.138)
NEC for r=0.1 class 1.0 = 0.334 +- 0.404 (in-sample avg dev_std = 0.138)
NEC for r=0.1 all KL = 0.266 +- 0.404 (in-sample avg dev_std = 0.138)
NEC for r=0.1 all L1 = 0.256 +- 0.357 (in-sample avg dev_std = 0.138)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.747
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0511508
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.61
NEC for r=0.2 class 0.0 = 0.232 +- 0.431 (in-sample avg dev_std = 0.345)
NEC for r=0.2 class 1.0 = 0.479 +- 0.431 (in-sample avg dev_std = 0.345)
NEC for r=0.2 all KL = 0.387 +- 0.431 (in-sample avg dev_std = 0.345)
NEC for r=0.2 all L1 = 0.354 +- 0.370 (in-sample avg dev_std = 0.345)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.747
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0650544
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.582
NEC for r=0.4 class 0.0 = 0.274 +- 0.417 (in-sample avg dev_std = 0.487)
NEC for r=0.4 class 1.0 = 0.572 +- 0.417 (in-sample avg dev_std = 0.487)
NEC for r=0.4 all KL = 0.479 +- 0.417 (in-sample avg dev_std = 0.487)
NEC for r=0.4 all L1 = 0.421 +- 0.353 (in-sample avg dev_std = 0.487)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.747
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0790352
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.593
NEC for r=0.8 class 0.0 = 0.287 +- 0.404 (in-sample avg dev_std = 0.537)
NEC for r=0.8 class 1.0 = 0.582 +- 0.404 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all KL = 0.514 +- 0.404 (in-sample avg dev_std = 0.537)
NEC for r=0.8 all L1 = 0.433 +- 0.336 (in-sample avg dev_std = 0.537)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 02:22:17 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 02:22:17 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 93 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round7/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 93...
[0m[1;37mINFO[0m: [1mCheckpoint 93: 
-----------------------------------
Train ACCURACY: 0.9688
Train Loss: 0.1026
ID Validation ACCURACY: 0.9720
ID Validation Loss: 0.0979
ID Test ACCURACY: 0.9660
ID Test Loss: 0.1081
OOD Validation ACCURACY: 0.9720
OOD Validation Loss: 0.0979
OOD Test ACCURACY: 0.9660
OOD Test Loss: 0.1081

[0m[1;37mINFO[0m: [1mChartInfo 0.9660 0.9660 0.9660 0.9660 0.9720 0.9720[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.054
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.065
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.073
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.081
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.033
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.042
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080


Evaluating SUFF_SIMPLE for seed 7 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.053778
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.455
SUFF_SIMPLE for r=0.05 class 0.0 = 0.878 +- 0.448 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.168 +- 0.448 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.05 all KL = 0.438 +- 0.448 (in-sample avg dev_std = 0.216)
SUFF_SIMPLE for r=0.05 all L1 = 0.485 +- 0.378 (in-sample avg dev_std = 0.216)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06461199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.461
SUFF_SIMPLE for r=0.1 class 0.0 = 0.874 +- 0.447 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.176 +- 0.447 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 all KL = 0.441 +- 0.447 (in-sample avg dev_std = 0.213)
SUFF_SIMPLE for r=0.1 all L1 = 0.487 +- 0.377 (in-sample avg dev_std = 0.213)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07291999999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.461
SUFF_SIMPLE for r=0.2 class 0.0 = 0.876 +- 0.449 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.181 +- 0.449 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.2 all KL = 0.445 +- 0.449 (in-sample avg dev_std = 0.229)
SUFF_SIMPLE for r=0.2 all L1 = 0.491 +- 0.378 (in-sample avg dev_std = 0.229)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076572
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.455
SUFF_SIMPLE for r=0.4 class 0.0 = 0.868 +- 0.447 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.18 +- 0.447 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all KL = 0.441 +- 0.447 (in-sample avg dev_std = 0.191)
SUFF_SIMPLE for r=0.4 all L1 = 0.487 +- 0.377 (in-sample avg dev_std = 0.191)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080766
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.546
SUFF_SIMPLE for r=0.8 class 0.0 = 0.888 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.298 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.525 +- 0.446 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.561 +- 0.379 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0102602
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010405000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.1 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.005)
SUFF_SIMPLE for r=0.1 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.005)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0101366
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100754
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099994
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.91 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.964 +- 0.137 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.954 +- 0.153 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0326934
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.546
SUFF_SIMPLE for r=0.05 class 0.0 = 0.67 +- 0.438 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.28 +- 0.438 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.05 all KL = 0.384 +- 0.438 (in-sample avg dev_std = 0.460)
SUFF_SIMPLE for r=0.05 all L1 = 0.477 +- 0.356 (in-sample avg dev_std = 0.460)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0418
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.545
SUFF_SIMPLE for r=0.1 class 0.0 = 0.673 +- 0.439 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.282 +- 0.439 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.1 all KL = 0.388 +- 0.439 (in-sample avg dev_std = 0.454)
SUFF_SIMPLE for r=0.1 all L1 = 0.48 +- 0.357 (in-sample avg dev_std = 0.454)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05241099999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.543
SUFF_SIMPLE for r=0.2 class 0.0 = 0.673 +- 0.438 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.284 +- 0.438 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.2 all KL = 0.389 +- 0.438 (in-sample avg dev_std = 0.448)
SUFF_SIMPLE for r=0.2 all L1 = 0.481 +- 0.357 (in-sample avg dev_std = 0.448)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06525059999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.544
SUFF_SIMPLE for r=0.4 class 0.0 = 0.669 +- 0.439 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.293 +- 0.439 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.4 all KL = 0.394 +- 0.439 (in-sample avg dev_std = 0.421)
SUFF_SIMPLE for r=0.4 all L1 = 0.483 +- 0.360 (in-sample avg dev_std = 0.421)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079707
len(reference) = 4984
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.601
SUFF_SIMPLE for r=0.8 class 0.0 = 0.749 +- 0.461 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.478 +- 0.461 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 all KL = 0.566 +- 0.461 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.8 all L1 = 0.615 +- 0.390 (in-sample avg dev_std = 0.107)


Evaluating NEC for seed 7 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.972
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.053778
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.792
NEC for r=0.05 class 0.0 = 0.082 +- 0.351 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.329 +- 0.351 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.213 +- 0.351 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.219 +- 0.309 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.972
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.06461199999999999
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.669
NEC for r=0.1 class 0.0 = 0.093 +- 0.418 (in-sample avg dev_std = 0.016)
NEC for r=0.1 class 1.0 = 0.521 +- 0.418 (in-sample avg dev_std = 0.016)
NEC for r=0.1 all KL = 0.346 +- 0.418 (in-sample avg dev_std = 0.016)
NEC for r=0.1 all L1 = 0.33 +- 0.359 (in-sample avg dev_std = 0.016)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.972
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.07291999999999998
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.556
NEC for r=0.2 class 0.0 = 0.124 +- 0.437 (in-sample avg dev_std = 0.266)
NEC for r=0.2 class 1.0 = 0.688 +- 0.437 (in-sample avg dev_std = 0.266)
NEC for r=0.2 all KL = 0.48 +- 0.437 (in-sample avg dev_std = 0.266)
NEC for r=0.2 all L1 = 0.436 +- 0.367 (in-sample avg dev_std = 0.266)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.972
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.076572
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.546
NEC for r=0.4 class 0.0 = 0.126 +- 0.432 (in-sample avg dev_std = 0.393)
NEC for r=0.4 class 1.0 = 0.745 +- 0.432 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all KL = 0.529 +- 0.432 (in-sample avg dev_std = 0.393)
NEC for r=0.4 all L1 = 0.469 +- 0.354 (in-sample avg dev_std = 0.393)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.972
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.080766
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.531
NEC for r=0.8 class 0.0 = 0.135 +- 0.431 (in-sample avg dev_std = 0.450)
NEC for r=0.8 class 1.0 = 0.763 +- 0.431 (in-sample avg dev_std = 0.450)
NEC for r=0.8 all KL = 0.549 +- 0.431 (in-sample avg dev_std = 0.450)
NEC for r=0.8 all L1 = 0.483 +- 0.349 (in-sample avg dev_std = 0.450)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.526
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0102602
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.0 +- 0.114 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.082 +- 0.114 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.029 +- 0.114 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.041 +- 0.138 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.526
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.010405000000000001
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.497
NEC for r=0.1 class 0.0 = 0.001 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.089 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.035 +- 0.134 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.045 +- 0.151 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.526
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0101366
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.001 +- 0.137 (in-sample avg dev_std = 0.001)
NEC for r=0.2 class 1.0 = 0.09 +- 0.137 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all KL = 0.036 +- 0.137 (in-sample avg dev_std = 0.001)
NEC for r=0.2 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.001)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.526
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0100754
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.001 +- 0.137 (in-sample avg dev_std = 0.007)
NEC for r=0.4 class 1.0 = 0.09 +- 0.137 (in-sample avg dev_std = 0.007)
NEC for r=0.4 all KL = 0.036 +- 0.137 (in-sample avg dev_std = 0.007)
NEC for r=0.4 all L1 = 0.046 +- 0.153 (in-sample avg dev_std = 0.007)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.526
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099994
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.001 +- 0.137 (in-sample avg dev_std = 0.008)
NEC for r=0.8 class 1.0 = 0.09 +- 0.137 (in-sample avg dev_std = 0.008)
NEC for r=0.8 all KL = 0.036 +- 0.137 (in-sample avg dev_std = 0.008)
NEC for r=0.8 all L1 = 0.046 +- 0.152 (in-sample avg dev_std = 0.008)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.774
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0326934
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.72
NEC for r=0.05 class 0.0 = 0.114 +- 0.342 (in-sample avg dev_std = 0.001)
NEC for r=0.05 class 1.0 = 0.194 +- 0.342 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all KL = 0.165 +- 0.342 (in-sample avg dev_std = 0.001)
NEC for r=0.05 all L1 = 0.153 +- 0.294 (in-sample avg dev_std = 0.001)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.774
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0418
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.682
NEC for r=0.1 class 0.0 = 0.178 +- 0.413 (in-sample avg dev_std = 0.118)
NEC for r=0.1 class 1.0 = 0.319 +- 0.413 (in-sample avg dev_std = 0.118)
NEC for r=0.1 all KL = 0.275 +- 0.413 (in-sample avg dev_std = 0.118)
NEC for r=0.1 all L1 = 0.248 +- 0.351 (in-sample avg dev_std = 0.118)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.774
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.05241099999999999
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.627
NEC for r=0.2 class 0.0 = 0.24 +- 0.448 (in-sample avg dev_std = 0.327)
NEC for r=0.2 class 1.0 = 0.483 +- 0.448 (in-sample avg dev_std = 0.327)
NEC for r=0.2 all KL = 0.421 +- 0.448 (in-sample avg dev_std = 0.327)
NEC for r=0.2 all L1 = 0.36 +- 0.370 (in-sample avg dev_std = 0.327)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.774
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06525059999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.591
NEC for r=0.4 class 0.0 = 0.275 +- 0.434 (in-sample avg dev_std = 0.467)
NEC for r=0.4 class 1.0 = 0.582 +- 0.434 (in-sample avg dev_std = 0.467)
NEC for r=0.4 all KL = 0.521 +- 0.434 (in-sample avg dev_std = 0.467)
NEC for r=0.4 all L1 = 0.427 +- 0.353 (in-sample avg dev_std = 0.467)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079707
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.592
NEC for r=0.8 class 0.0 = 0.279 +- 0.423 (in-sample avg dev_std = 0.525)
NEC for r=0.8 class 1.0 = 0.6 +- 0.423 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all KL = 0.545 +- 0.423 (in-sample avg dev_std = 0.525)
NEC for r=0.8 all L1 = 0.437 +- 0.341 (in-sample avg dev_std = 0.525)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 02:37:24 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 02:37:24 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 98 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round8/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 98...
[0m[1;37mINFO[0m: [1mCheckpoint 98: 
-----------------------------------
Train ACCURACY: 0.9313
Train Loss: 0.1850
ID Validation ACCURACY: 0.9260
ID Validation Loss: 0.2031
ID Test ACCURACY: 0.9320
ID Test Loss: 0.1942
OOD Validation ACCURACY: 0.9260
OOD Validation Loss: 0.2031
OOD Test ACCURACY: 0.9320
OOD Test Loss: 0.1942

[0m[1;37mINFO[0m: [1mChartInfo 0.9320 0.9320 0.9320 0.9320 0.9260 0.9260[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.037
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.052
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.071
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.029
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.062
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 8 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037028
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.447
SUFF_SIMPLE for r=0.05 class 0.0 = 0.79 +- 0.404 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.194 +- 0.404 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 all KL = 0.452 +- 0.404 (in-sample avg dev_std = 0.066)
SUFF_SIMPLE for r=0.05 all L1 = 0.46 +- 0.345 (in-sample avg dev_std = 0.066)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051755999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.447
SUFF_SIMPLE for r=0.1 class 0.0 = 0.789 +- 0.404 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.193 +- 0.404 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.1 all KL = 0.451 +- 0.404 (in-sample avg dev_std = 0.051)
SUFF_SIMPLE for r=0.1 all L1 = 0.459 +- 0.346 (in-sample avg dev_std = 0.051)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06625400000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.447
SUFF_SIMPLE for r=0.2 class 0.0 = 0.785 +- 0.402 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.197 +- 0.402 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.2 all KL = 0.452 +- 0.402 (in-sample avg dev_std = 0.065)
SUFF_SIMPLE for r=0.2 all L1 = 0.459 +- 0.345 (in-sample avg dev_std = 0.065)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07111400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.456
SUFF_SIMPLE for r=0.4 class 0.0 = 0.782 +- 0.402 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.205 +- 0.402 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 all KL = 0.456 +- 0.402 (in-sample avg dev_std = 0.004)
SUFF_SIMPLE for r=0.4 all L1 = 0.462 +- 0.345 (in-sample avg dev_std = 0.004)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08048400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.474
SUFF_SIMPLE for r=0.8 class 0.0 = 0.788 +- 0.401 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.228 +- 0.401 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.476 +- 0.401 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.478 +- 0.346 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009109
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093032
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095222
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096158
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096514
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.995 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.833 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.939 +- 0.146 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0288246
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.526
SUFF_SIMPLE for r=0.05 class 0.0 = 0.66 +- 0.380 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.34 +- 0.380 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 all KL = 0.507 +- 0.380 (in-sample avg dev_std = 0.263)
SUFF_SIMPLE for r=0.05 all L1 = 0.502 +- 0.331 (in-sample avg dev_std = 0.263)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.036700399999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.526
SUFF_SIMPLE for r=0.1 class 0.0 = 0.657 +- 0.381 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.339 +- 0.381 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.1 all KL = 0.505 +- 0.381 (in-sample avg dev_std = 0.260)
SUFF_SIMPLE for r=0.1 all L1 = 0.5 +- 0.332 (in-sample avg dev_std = 0.260)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.04739840000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.526
SUFF_SIMPLE for r=0.2 class 0.0 = 0.657 +- 0.385 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.34 +- 0.385 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.2 all KL = 0.509 +- 0.385 (in-sample avg dev_std = 0.254)
SUFF_SIMPLE for r=0.2 all L1 = 0.501 +- 0.333 (in-sample avg dev_std = 0.254)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0617976
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.525
SUFF_SIMPLE for r=0.4 class 0.0 = 0.658 +- 0.388 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.344 +- 0.388 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 all KL = 0.514 +- 0.388 (in-sample avg dev_std = 0.245)
SUFF_SIMPLE for r=0.4 all L1 = 0.503 +- 0.335 (in-sample avg dev_std = 0.245)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07703
len(reference) = 4983
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.578
SUFF_SIMPLE for r=0.8 class 0.0 = 0.725 +- 0.391 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.472 +- 0.391 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.8 all KL = 0.628 +- 0.391 (in-sample avg dev_std = 0.054)
SUFF_SIMPLE for r=0.8 all L1 = 0.6 +- 0.349 (in-sample avg dev_std = 0.054)


Evaluating NEC for seed 8 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.926
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.037028
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.73
NEC for r=0.05 class 0.0 = 0.16 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.432 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.249 +- 0.330 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.31 +- 0.304 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.926
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.051755999999999996
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.563
NEC for r=0.1 class 0.0 = 0.198 +- 0.384 (in-sample avg dev_std = 0.008)
NEC for r=0.1 class 1.0 = 0.652 +- 0.384 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all KL = 0.429 +- 0.384 (in-sample avg dev_std = 0.008)
NEC for r=0.1 all L1 = 0.45 +- 0.337 (in-sample avg dev_std = 0.008)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.926
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06625400000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.491
NEC for r=0.2 class 0.0 = 0.209 +- 0.399 (in-sample avg dev_std = 0.145)
NEC for r=0.2 class 1.0 = 0.758 +- 0.399 (in-sample avg dev_std = 0.145)
NEC for r=0.2 all KL = 0.516 +- 0.399 (in-sample avg dev_std = 0.145)
NEC for r=0.2 all L1 = 0.513 +- 0.343 (in-sample avg dev_std = 0.145)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.926
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07111400000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.473
NEC for r=0.4 class 0.0 = 0.212 +- 0.399 (in-sample avg dev_std = 0.168)
NEC for r=0.4 class 1.0 = 0.779 +- 0.399 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all KL = 0.532 +- 0.399 (in-sample avg dev_std = 0.168)
NEC for r=0.4 all L1 = 0.526 +- 0.342 (in-sample avg dev_std = 0.168)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.926
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08048400000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.468
NEC for r=0.8 class 0.0 = 0.217 +- 0.395 (in-sample avg dev_std = 0.226)
NEC for r=0.8 class 1.0 = 0.788 +- 0.395 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all KL = 0.543 +- 0.395 (in-sample avg dev_std = 0.226)
NEC for r=0.8 all L1 = 0.533 +- 0.336 (in-sample avg dev_std = 0.226)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.532
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.009109
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.004 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.152 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.048 +- 0.115 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.079 +- 0.161 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.532
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0093032
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.005 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.166 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.06 +- 0.142 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.086 +- 0.177 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.532
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0095222
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.005 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.167 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.061 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.086 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.532
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0096158
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.005 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.4 class 1.0 = 0.167 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all KL = 0.061 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.4 all L1 = 0.086 +- 0.179 (in-sample avg dev_std = 0.000)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.532
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0096514
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.005 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.8 class 1.0 = 0.167 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all KL = 0.061 +- 0.146 (in-sample avg dev_std = 0.000)
NEC for r=0.8 all L1 = 0.086 +- 0.179 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.672
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0288246
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.635
NEC for r=0.05 class 0.0 = 0.13 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.249 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.158 +- 0.307 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.189 +- 0.288 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.672
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.036700399999999994
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.617
NEC for r=0.1 class 0.0 = 0.192 +- 0.357 (in-sample avg dev_std = 0.072)
NEC for r=0.1 class 1.0 = 0.366 +- 0.357 (in-sample avg dev_std = 0.072)
NEC for r=0.1 all KL = 0.244 +- 0.357 (in-sample avg dev_std = 0.072)
NEC for r=0.1 all L1 = 0.278 +- 0.326 (in-sample avg dev_std = 0.072)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.672
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.04739840000000001
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.566
NEC for r=0.2 class 0.0 = 0.253 +- 0.390 (in-sample avg dev_std = 0.206)
NEC for r=0.2 class 1.0 = 0.504 +- 0.390 (in-sample avg dev_std = 0.206)
NEC for r=0.2 all KL = 0.353 +- 0.390 (in-sample avg dev_std = 0.206)
NEC for r=0.2 all L1 = 0.377 +- 0.343 (in-sample avg dev_std = 0.206)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.672
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0617976
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.538
NEC for r=0.4 class 0.0 = 0.296 +- 0.387 (in-sample avg dev_std = 0.342)
NEC for r=0.4 class 1.0 = 0.582 +- 0.387 (in-sample avg dev_std = 0.342)
NEC for r=0.4 all KL = 0.425 +- 0.387 (in-sample avg dev_std = 0.342)
NEC for r=0.4 all L1 = 0.437 +- 0.333 (in-sample avg dev_std = 0.342)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.672
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07703
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.539
NEC for r=0.8 class 0.0 = 0.3 +- 0.375 (in-sample avg dev_std = 0.400)
NEC for r=0.8 class 1.0 = 0.594 +- 0.375 (in-sample avg dev_std = 0.400)
NEC for r=0.8 all KL = 0.442 +- 0.375 (in-sample avg dev_std = 0.400)
NEC for r=0.8 all L1 = 0.445 +- 0.322 (in-sample avg dev_std = 0.400)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 02:52:28 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 02:52:28 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 97 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round9/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 97...
[0m[1;37mINFO[0m: [1mCheckpoint 97: 
-----------------------------------
Train ACCURACY: 0.9650
Train Loss: 0.1021
ID Validation ACCURACY: 0.9760
ID Validation Loss: 0.0879
ID Test ACCURACY: 0.9540
ID Test Loss: 0.1232
OOD Validation ACCURACY: 0.9760
OOD Validation Loss: 0.0879
OOD Test ACCURACY: 0.9540
OOD Test Loss: 0.1232

[0m[1;37mINFO[0m: [1mChartInfo 0.9540 0.9540 0.9540 0.9540 0.9760 0.9760[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.049
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.054
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.066
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.073
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.080
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.010
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.010
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.010
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.031
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.040
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.052
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.065
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.079


Evaluating SUFF_SIMPLE for seed 9 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.048664
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.46
SUFF_SIMPLE for r=0.05 class 0.0 = 0.815 +- 0.425 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.183 +- 0.425 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.05 all KL = 0.408 +- 0.425 (in-sample avg dev_std = 0.309)
SUFF_SIMPLE for r=0.05 all L1 = 0.465 +- 0.349 (in-sample avg dev_std = 0.309)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05382
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.466
SUFF_SIMPLE for r=0.1 class 0.0 = 0.81 +- 0.426 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.199 +- 0.426 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.1 all KL = 0.417 +- 0.426 (in-sample avg dev_std = 0.285)
SUFF_SIMPLE for r=0.1 all L1 = 0.472 +- 0.352 (in-sample avg dev_std = 0.285)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06581000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.468
SUFF_SIMPLE for r=0.2 class 0.0 = 0.808 +- 0.426 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.199 +- 0.426 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.2 all KL = 0.417 +- 0.426 (in-sample avg dev_std = 0.282)
SUFF_SIMPLE for r=0.2 all L1 = 0.471 +- 0.354 (in-sample avg dev_std = 0.282)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07333600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.458
SUFF_SIMPLE for r=0.4 class 0.0 = 0.818 +- 0.437 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.193 +- 0.437 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.4 all KL = 0.426 +- 0.437 (in-sample avg dev_std = 0.218)
SUFF_SIMPLE for r=0.4 all L1 = 0.472 +- 0.366 (in-sample avg dev_std = 0.218)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08033200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.492
SUFF_SIMPLE for r=0.8 class 0.0 = 0.846 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.247 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.478 +- 0.445 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.514 +- 0.376 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099182
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.496
SUFF_SIMPLE for r=0.05 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.05 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.021)
SUFF_SIMPLE for r=0.05 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.021)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0100374
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
SUFF_SIMPLE for r=0.1 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.006)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.006)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0100692
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
SUFF_SIMPLE for r=0.2 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.2 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.010)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.010)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0099902
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
SUFF_SIMPLE for r=0.4 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.4 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.013)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.013)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
SUFF_SIMPLE for r=0.8 class 0.0 = 0.998 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.831 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.934 +- 0.170 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.914 +- 0.194 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.030590999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.569
SUFF_SIMPLE for r=0.05 class 0.0 = 0.646 +- 0.406 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.329 +- 0.406 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.05 all KL = 0.36 +- 0.406 (in-sample avg dev_std = 0.495)
SUFF_SIMPLE for r=0.05 all L1 = 0.49 +- 0.324 (in-sample avg dev_std = 0.495)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0400254
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.568
SUFF_SIMPLE for r=0.1 class 0.0 = 0.651 +- 0.415 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.329 +- 0.415 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.1 all KL = 0.368 +- 0.415 (in-sample avg dev_std = 0.478)
SUFF_SIMPLE for r=0.1 all L1 = 0.492 +- 0.333 (in-sample avg dev_std = 0.478)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0519514
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.572
SUFF_SIMPLE for r=0.2 class 0.0 = 0.659 +- 0.426 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.333 +- 0.426 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.2 all KL = 0.385 +- 0.426 (in-sample avg dev_std = 0.457)
SUFF_SIMPLE for r=0.2 all L1 = 0.498 +- 0.344 (in-sample avg dev_std = 0.457)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06496379999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.568
SUFF_SIMPLE for r=0.4 class 0.0 = 0.666 +- 0.437 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.334 +- 0.437 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.4 all KL = 0.399 +- 0.437 (in-sample avg dev_std = 0.429)
SUFF_SIMPLE for r=0.4 all L1 = 0.502 +- 0.354 (in-sample avg dev_std = 0.429)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.774
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079061
len(reference) = 4985
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.661
SUFF_SIMPLE for r=0.8 class 0.0 = 0.748 +- 0.442 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.548 +- 0.442 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 all KL = 0.6 +- 0.442 (in-sample avg dev_std = 0.134)
SUFF_SIMPLE for r=0.8 all L1 = 0.649 +- 0.372 (in-sample avg dev_std = 0.134)


Evaluating NEC for seed 9 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.976
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.048664
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.768
NEC for r=0.05 class 0.0 = 0.119 +- 0.372 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.384 +- 0.372 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.264 +- 0.372 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.266 +- 0.327 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.976
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.05382
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.628
NEC for r=0.1 class 0.0 = 0.141 +- 0.423 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.579 +- 0.423 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.403 +- 0.423 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.384 +- 0.363 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.976
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.06581000000000001
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.533
NEC for r=0.2 class 0.0 = 0.161 +- 0.436 (in-sample avg dev_std = 0.222)
NEC for r=0.2 class 1.0 = 0.721 +- 0.436 (in-sample avg dev_std = 0.222)
NEC for r=0.2 all KL = 0.512 +- 0.436 (in-sample avg dev_std = 0.222)
NEC for r=0.2 all L1 = 0.471 +- 0.365 (in-sample avg dev_std = 0.222)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.976
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.07333600000000001
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.51
NEC for r=0.4 class 0.0 = 0.168 +- 0.429 (in-sample avg dev_std = 0.349)
NEC for r=0.4 class 1.0 = 0.776 +- 0.429 (in-sample avg dev_std = 0.349)
NEC for r=0.4 all KL = 0.556 +- 0.429 (in-sample avg dev_std = 0.349)
NEC for r=0.4 all L1 = 0.505 +- 0.353 (in-sample avg dev_std = 0.349)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.976
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.08033200000000001
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.183 +- 0.421 (in-sample avg dev_std = 0.398)
NEC for r=0.8 class 1.0 = 0.794 +- 0.421 (in-sample avg dev_std = 0.398)
NEC for r=0.8 all KL = 0.584 +- 0.421 (in-sample avg dev_std = 0.398)
NEC for r=0.8 all L1 = 0.522 +- 0.342 (in-sample avg dev_std = 0.398)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.543
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0099182
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.499
NEC for r=0.05 class 0.0 = 0.002 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.165 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.062 +- 0.161 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.084 +- 0.189 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.543
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0100374
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.496
NEC for r=0.1 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.543
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0100692
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.496
NEC for r=0.2 class 0.0 = 0.002 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.2 class 1.0 = 0.169 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all KL = 0.066 +- 0.171 (in-sample avg dev_std = 0.000)
NEC for r=0.2 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.000)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.543
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0099902
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.496
NEC for r=0.4 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.001)
NEC for r=0.4 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.001)
NEC for r=0.4 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.001)
NEC for r=0.4 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.001)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.543
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.0099274
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.496
NEC for r=0.8 class 0.0 = 0.002 +- 0.170 (in-sample avg dev_std = 0.001)
NEC for r=0.8 class 1.0 = 0.169 +- 0.170 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all KL = 0.066 +- 0.170 (in-sample avg dev_std = 0.001)
NEC for r=0.8 all L1 = 0.086 +- 0.194 (in-sample avg dev_std = 0.001)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.773
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.030590999999999997
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.729
NEC for r=0.05 class 0.0 = 0.104 +- 0.319 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.18 +- 0.319 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.152 +- 0.319 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.141 +- 0.275 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.773
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0400254
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.704
NEC for r=0.1 class 0.0 = 0.165 +- 0.391 (in-sample avg dev_std = 0.108)
NEC for r=0.1 class 1.0 = 0.293 +- 0.391 (in-sample avg dev_std = 0.108)
NEC for r=0.1 all KL = 0.255 +- 0.391 (in-sample avg dev_std = 0.108)
NEC for r=0.1 all L1 = 0.228 +- 0.331 (in-sample avg dev_std = 0.108)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.773
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0519514
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.658
NEC for r=0.2 class 0.0 = 0.23 +- 0.436 (in-sample avg dev_std = 0.298)
NEC for r=0.2 class 1.0 = 0.437 +- 0.436 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all KL = 0.394 +- 0.436 (in-sample avg dev_std = 0.298)
NEC for r=0.2 all L1 = 0.332 +- 0.357 (in-sample avg dev_std = 0.298)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.773
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.06496379999999999
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.616
NEC for r=0.4 class 0.0 = 0.269 +- 0.430 (in-sample avg dev_std = 0.443)
NEC for r=0.4 class 1.0 = 0.533 +- 0.430 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all KL = 0.501 +- 0.430 (in-sample avg dev_std = 0.443)
NEC for r=0.4 all L1 = 0.399 +- 0.346 (in-sample avg dev_std = 0.443)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.773
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.079061
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.611
NEC for r=0.8 class 0.0 = 0.289 +- 0.404 (in-sample avg dev_std = 0.528)
NEC for r=0.8 class 1.0 = 0.572 +- 0.404 (in-sample avg dev_std = 0.528)
NEC for r=0.8 all KL = 0.563 +- 0.404 (in-sample avg dev_std = 0.528)
NEC for r=0.8 all L1 = 0.429 +- 0.320 (in-sample avg dev_std = 0.528)
model_dirname= repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean

[1;37mINFO[0m: [1m-----------------------------------
    Task: test
Thu Jan 16 03:07:21 2025
[0m[1;37mINFO[0m: [1mLoad Dataset TopoFeature
[0mTopoFeature
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min8_max80_redmax4_requiredred2_shiftno_shift.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_BA_numgraphs5000_min150_max250_redmax4_requiredred2_shiftsize.pt
loading:  /home/azzolin/sedignn/global_local_sedignn/storage/datasets/TopoFeature/basis/processed/data_ER_numgraphs5000_min8_max80_redmax4_requiredred2_shiftER.pt
[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1mDataset: {'train': TopoFeature(4000), 'id_val': TopoFeature(500), 'id_test': TopoFeature(500), 'metric': 'Accuracy', 'task': 'Binary classification', 'val': TopoFeature(5000), 'test': TopoFeature(5000)}
[0m[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1m Data(x=[78, 3], edge_index=[2, 296], y=[1, 1], pattern=[1], node_gt=[78], edge_gt=[296])
[0mData(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
[1;37mINFO[0m: [1mLoading model...
[0m[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1mInit GINFeatExtractor
[0mUsing no_bn in BasicEncoder
[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1mUsing no mitigation (None)
[0m[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1mUsing the fixed _explain_ functionality
[0m[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1mUsing no mitigation (None)
[0mUsing mitigation_expl_scores: default
[1;34mDEBUG[0m: 01/16/2025 03:07:21 AM : [1mConfig model and output the best checkpoint info...
[0m[1;37mINFO[0m: [1mLoading best In-Domain Checkpoint 99 in /home/azzolin/sedignn/global_local_sedignn/storage/checkpoints/round10/TopoFeature_basis_no_shift/repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01/id_best.ckpt
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mLoading best Out-of-Domain Checkpoint 99...
[0m[1;37mINFO[0m: [1mCheckpoint 99: 
-----------------------------------
Train ACCURACY: 0.9772
Train Loss: 0.0746
ID Validation ACCURACY: 0.9780
ID Validation Loss: 0.0776
ID Test ACCURACY: 0.9680
ID Test Loss: 0.0900
OOD Validation ACCURACY: 0.9780
OOD Validation Loss: 0.0776
OOD Test ACCURACY: 0.9680
OOD Test Loss: 0.0900

[0m[1;37mINFO[0m: [1mChartInfo 0.9680 0.9680 0.9680 0.9680 0.9780 0.9780[0mTopoFeature(500)
Data example from id_val: Data(x=[57, 3], edge_index=[2, 212], y=[1, 1], pattern=[1], node_gt=[57], edge_gt=[212])
Label distribution from id_val: (tensor([0., 1.]), tensor([223, 277]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.051
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.062
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.070
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.077
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.082
TopoFeature(5000)
Data example from val: Data(x=[202, 3], edge_index=[2, 792], y=[1, 1], pattern=[1], node_gt=[202], edge_gt=[792])
Label distribution from val: (tensor([0., 1.]), tensor([2480, 2520]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.009
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.009
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.009
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.010
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.010
TopoFeature(5000)
Data example from test: Data(x=[62, 3], edge_index=[2, 674], y=[1, 1], pattern=[1], node_gt=[62], edge_gt=[674])
Label distribution from test: (tensor([0., 1.]), tensor([2532, 2468]))
F1 for r=0.05 = 0.000
WIoU for r=0.05 = 0.030
F1 for r=0.1 = 0.000
WIoU for r=0.1 = 0.037
F1 for r=0.2 = 0.000
WIoU for r=0.2 = 0.047
F1 for r=0.4 = 0.000
WIoU for r=0.4 = 0.060
F1 for r=0.8 = 0.000
WIoU for r=0.8 = 0.077


Evaluating SUFF_SIMPLE for seed 10 with load_split id




--------------------------------------------------


#D#Computing SUFF_SIMPLE over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.050936
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.531
SUFF_SIMPLE for r=0.05 class 0.0 = 0.619 +- 0.399 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.389 +- 0.399 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.05 all KL = 0.372 +- 0.399 (in-sample avg dev_std = 0.602)
SUFF_SIMPLE for r=0.05 all L1 = 0.492 +- 0.319 (in-sample avg dev_std = 0.602)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.062052
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.53
SUFF_SIMPLE for r=0.1 class 0.0 = 0.616 +- 0.407 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.401 +- 0.407 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.1 all KL = 0.387 +- 0.407 (in-sample avg dev_std = 0.579)
SUFF_SIMPLE for r=0.1 all L1 = 0.497 +- 0.329 (in-sample avg dev_std = 0.579)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070206
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.53
SUFF_SIMPLE for r=0.2 class 0.0 = 0.606 +- 0.415 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.424 +- 0.415 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.2 all KL = 0.403 +- 0.415 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.2 all L1 = 0.505 +- 0.336 (in-sample avg dev_std = 0.549)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.077318
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.515
SUFF_SIMPLE for r=0.4 class 0.0 = 0.653 +- 0.434 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.388 +- 0.434 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.4 all KL = 0.425 +- 0.434 (in-sample avg dev_std = 0.446)
SUFF_SIMPLE for r=0.4 all L1 = 0.506 +- 0.354 (in-sample avg dev_std = 0.446)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.082224
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.706
SUFF_SIMPLE for r=0.8 class 0.0 = 0.867 +- 0.421 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.572 +- 0.421 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.685 +- 0.421 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.703 +- 0.364 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.498
SUFF_SIMPLE for r=0.05 class 0.0 = 0.994 +- 0.217 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.834 +- 0.217 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.05 all KL = 0.918 +- 0.217 (in-sample avg dev_std = 0.113)
SUFF_SIMPLE for r=0.05 all L1 = 0.913 +- 0.212 (in-sample avg dev_std = 0.113)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009300999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.498
SUFF_SIMPLE for r=0.1 class 0.0 = 0.995 +- 0.214 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.834 +- 0.214 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.1 all KL = 0.919 +- 0.214 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.1 all L1 = 0.914 +- 0.212 (in-sample avg dev_std = 0.107)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094492
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.498
SUFF_SIMPLE for r=0.2 class 0.0 = 0.995 +- 0.215 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.834 +- 0.215 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all KL = 0.919 +- 0.215 (in-sample avg dev_std = 0.107)
SUFF_SIMPLE for r=0.2 all L1 = 0.914 +- 0.211 (in-sample avg dev_std = 0.107)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095836
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
SUFF_SIMPLE for r=0.4 class 0.0 = 0.995 +- 0.215 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.834 +- 0.215 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 all KL = 0.92 +- 0.215 (in-sample avg dev_std = 0.103)
SUFF_SIMPLE for r=0.4 all L1 = 0.914 +- 0.212 (in-sample avg dev_std = 0.103)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009633
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.499
SUFF_SIMPLE for r=0.8 class 0.0 = 0.999 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.838 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all KL = 0.929 +- 0.203 (in-sample avg dev_std = 0.000)
SUFF_SIMPLE for r=0.8 all L1 = 0.918 +- 0.210 (in-sample avg dev_std = 0.000)



--------------------------------------------------


#D#Computing SUFF_SIMPLE over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029973400000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.629
SUFF_SIMPLE for r=0.05 class 0.0 = 0.644 +- 0.402 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.05 class 1.0 = 0.611 +- 0.402 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.05 all KL = 0.489 +- 0.402 (in-sample avg dev_std = 0.590)
SUFF_SIMPLE for r=0.05 all L1 = 0.628 +- 0.317 (in-sample avg dev_std = 0.590)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0369356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.618
SUFF_SIMPLE for r=0.1 class 0.0 = 0.637 +- 0.408 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.1 class 1.0 = 0.635 +- 0.408 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.1 all KL = 0.512 +- 0.408 (in-sample avg dev_std = 0.549)
SUFF_SIMPLE for r=0.1 all L1 = 0.636 +- 0.326 (in-sample avg dev_std = 0.549)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0467624
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.61
SUFF_SIMPLE for r=0.2 class 0.0 = 0.627 +- 0.421 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.2 class 1.0 = 0.625 +- 0.421 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.2 all KL = 0.512 +- 0.421 (in-sample avg dev_std = 0.513)
SUFF_SIMPLE for r=0.2 all L1 = 0.626 +- 0.340 (in-sample avg dev_std = 0.513)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060411599999999996
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.603
SUFF_SIMPLE for r=0.4 class 0.0 = 0.643 +- 0.439 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.4 class 1.0 = 0.546 +- 0.439 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.4 all KL = 0.495 +- 0.439 (in-sample avg dev_std = 0.465)
SUFF_SIMPLE for r=0.4 all L1 = 0.595 +- 0.357 (in-sample avg dev_std = 0.465)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.763
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07727360000000001
len(reference) = 4947
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.648
SUFF_SIMPLE for r=0.8 class 0.0 = 0.832 +- 0.413 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.8 class 1.0 = 0.697 +- 0.413 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.8 all KL = 0.74 +- 0.413 (in-sample avg dev_std = 0.078)
SUFF_SIMPLE for r=0.8 all L1 = 0.766 +- 0.354 (in-sample avg dev_std = 0.078)


Evaluating NEC for seed 10 with load_split id




--------------------------------------------------


#D#Computing NEC over id_val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.978
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.050936
len(reference) = 500
Effective ratio: 0.054 +- 0.005
Model Accuracy over intervened graphs for r=0.05 =  0.93
NEC for r=0.05 class 0.0 = 0.077 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.107 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.077 +- 0.211 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.093 +- 0.204 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.978
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.062052
len(reference) = 500
Effective ratio: 0.104 +- 0.005
Model Accuracy over intervened graphs for r=0.1 =  0.854
NEC for r=0.1 class 0.0 = 0.118 +- 0.326 (in-sample avg dev_std = 0.032)
NEC for r=0.1 class 1.0 = 0.229 +- 0.326 (in-sample avg dev_std = 0.032)
NEC for r=0.1 all KL = 0.176 +- 0.326 (in-sample avg dev_std = 0.032)
NEC for r=0.1 all L1 = 0.179 +- 0.291 (in-sample avg dev_std = 0.032)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.978
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.070206
len(reference) = 500
Effective ratio: 0.204 +- 0.005
Model Accuracy over intervened graphs for r=0.2 =  0.749
NEC for r=0.2 class 0.0 = 0.167 +- 0.403 (in-sample avg dev_std = 0.333)
NEC for r=0.2 class 1.0 = 0.391 +- 0.403 (in-sample avg dev_std = 0.333)
NEC for r=0.2 all KL = 0.333 +- 0.403 (in-sample avg dev_std = 0.333)
NEC for r=0.2 all L1 = 0.291 +- 0.332 (in-sample avg dev_std = 0.333)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.978
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.077318
len(reference) = 500
Effective ratio: 0.404 +- 0.006
Model Accuracy over intervened graphs for r=0.4 =  0.671
NEC for r=0.4 class 0.0 = 0.233 +- 0.405 (in-sample avg dev_std = 0.499)
NEC for r=0.4 class 1.0 = 0.492 +- 0.405 (in-sample avg dev_std = 0.499)
NEC for r=0.4 all KL = 0.466 +- 0.405 (in-sample avg dev_std = 0.499)
NEC for r=0.4 all L1 = 0.376 +- 0.321 (in-sample avg dev_std = 0.499)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.978
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.082224
len(reference) = 500
Effective ratio: 0.804 +- 0.005
Model Accuracy over intervened graphs for r=0.8 =  0.672
NEC for r=0.8 class 0.0 = 0.238 +- 0.393 (in-sample avg dev_std = 0.583)
NEC for r=0.8 class 1.0 = 0.514 +- 0.393 (in-sample avg dev_std = 0.583)
NEC for r=0.8 all KL = 0.504 +- 0.393 (in-sample avg dev_std = 0.583)
NEC for r=0.8 all L1 = 0.391 +- 0.304 (in-sample avg dev_std = 0.583)



--------------------------------------------------


#D#Computing NEC over val across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.563
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.0092432
len(reference) = 5000
Effective ratio: 0.051 +- 0.000
Model Accuracy over intervened graphs for r=0.05 =  0.529
NEC for r=0.05 class 0.0 = 0.001 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.116 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.038 +- 0.126 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.059 +- 0.158 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.563
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.009300999999999999
len(reference) = 5000
Effective ratio: 0.101 +- 0.000
Model Accuracy over intervened graphs for r=0.1 =  0.509
NEC for r=0.1 class 0.0 = 0.001 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 class 1.0 = 0.146 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all KL = 0.059 +- 0.178 (in-sample avg dev_std = 0.000)
NEC for r=0.1 all L1 = 0.074 +- 0.193 (in-sample avg dev_std = 0.000)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.563
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0094492
len(reference) = 5000
Effective ratio: 0.201 +- 0.000
Model Accuracy over intervened graphs for r=0.2 =  0.499
NEC for r=0.2 class 0.0 = 0.002 +- 0.204 (in-sample avg dev_std = 0.031)
NEC for r=0.2 class 1.0 = 0.163 +- 0.204 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all KL = 0.072 +- 0.204 (in-sample avg dev_std = 0.031)
NEC for r=0.2 all L1 = 0.083 +- 0.211 (in-sample avg dev_std = 0.031)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.563
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.0095836
len(reference) = 5000
Effective ratio: 0.401 +- 0.000
Model Accuracy over intervened graphs for r=0.4 =  0.498
NEC for r=0.4 class 0.0 = 0.001 +- 0.205 (in-sample avg dev_std = 0.072)
NEC for r=0.4 class 1.0 = 0.164 +- 0.205 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all KL = 0.073 +- 0.205 (in-sample avg dev_std = 0.072)
NEC for r=0.4 all L1 = 0.083 +- 0.211 (in-sample avg dev_std = 0.072)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.563
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.009633
len(reference) = 5000
Effective ratio: 0.801 +- 0.000
Model Accuracy over intervened graphs for r=0.8 =  0.498
NEC for r=0.8 class 0.0 = 0.002 +- 0.205 (in-sample avg dev_std = 0.078)
NEC for r=0.8 class 1.0 = 0.164 +- 0.205 (in-sample avg dev_std = 0.078)
NEC for r=0.8 all KL = 0.073 +- 0.205 (in-sample avg dev_std = 0.078)
NEC for r=0.8 all L1 = 0.083 +- 0.211 (in-sample avg dev_std = 0.078)



--------------------------------------------------


#D#Computing NEC over test across ratios (random_expl=True)


ratio=0.05



Model Accuracy of binarized graphs for r=0.05 =  0.761
Model XAI F1 of binarized graphs for r=0.05 =  0.0
Model XAI WIoU of binarized graphs for r=0.05 =  0.029973400000000004
len(reference) = 4997
Effective ratio: 0.055 +- 0.009
Model Accuracy over intervened graphs for r=0.05 =  0.749
NEC for r=0.05 class 0.0 = 0.081 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.05 class 1.0 = 0.078 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all KL = 0.078 +- 0.244 (in-sample avg dev_std = 0.000)
NEC for r=0.05 all L1 = 0.079 +- 0.220 (in-sample avg dev_std = 0.000)


ratio=0.1



Model Accuracy of binarized graphs for r=0.1 =  0.761
Model XAI F1 of binarized graphs for r=0.1 =  0.0
Model XAI WIoU of binarized graphs for r=0.1 =  0.0369356
len(reference) = 4997
Effective ratio: 0.105 +- 0.011
Model Accuracy over intervened graphs for r=0.1 =  0.739
NEC for r=0.1 class 0.0 = 0.116 +- 0.302 (in-sample avg dev_std = 0.069)
NEC for r=0.1 class 1.0 = 0.121 +- 0.302 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all KL = 0.125 +- 0.302 (in-sample avg dev_std = 0.069)
NEC for r=0.1 all L1 = 0.118 +- 0.265 (in-sample avg dev_std = 0.069)


ratio=0.2



Model Accuracy of binarized graphs for r=0.2 =  0.761
Model XAI F1 of binarized graphs for r=0.2 =  0.0
Model XAI WIoU of binarized graphs for r=0.2 =  0.0467624
len(reference) = 4997
Effective ratio: 0.205 +- 0.010
Model Accuracy over intervened graphs for r=0.2 =  0.732
NEC for r=0.2 class 0.0 = 0.18 +- 0.370 (in-sample avg dev_std = 0.216)
NEC for r=0.2 class 1.0 = 0.18 +- 0.370 (in-sample avg dev_std = 0.216)
NEC for r=0.2 all KL = 0.205 +- 0.370 (in-sample avg dev_std = 0.216)
NEC for r=0.2 all L1 = 0.18 +- 0.311 (in-sample avg dev_std = 0.216)


ratio=0.4



Model Accuracy of binarized graphs for r=0.4 =  0.761
Model XAI F1 of binarized graphs for r=0.4 =  0.0
Model XAI WIoU of binarized graphs for r=0.4 =  0.060411599999999996
len(reference) = 4997
Effective ratio: 0.404 +- 0.009
Model Accuracy over intervened graphs for r=0.4 =  0.687
NEC for r=0.4 class 0.0 = 0.262 +- 0.421 (in-sample avg dev_std = 0.362)
NEC for r=0.4 class 1.0 = 0.281 +- 0.421 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all KL = 0.336 +- 0.421 (in-sample avg dev_std = 0.362)
NEC for r=0.4 all L1 = 0.271 +- 0.342 (in-sample avg dev_std = 0.362)


ratio=0.8



Model Accuracy of binarized graphs for r=0.8 =  0.761
Model XAI F1 of binarized graphs for r=0.8 =  0.0
Model XAI WIoU of binarized graphs for r=0.8 =  0.07727360000000001
len(reference) = 4997
Effective ratio: 0.804 +- 0.009
Model Accuracy over intervened graphs for r=0.8 =  0.668
NEC for r=0.8 class 0.0 = 0.31 +- 0.406 (in-sample avg dev_std = 0.502)
NEC for r=0.8 class 1.0 = 0.287 +- 0.406 (in-sample avg dev_std = 0.502)
NEC for r=0.8 all KL = 0.404 +- 0.406 (in-sample avg dev_std = 0.502)
NEC for r=0.8 all L1 = 0.299 +- 0.321 (in-sample avg dev_std = 0.502)


 -------------------------------------------------- 
Printing evaluation results for load_split id



Eval split id_val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.404, 0.412, 0.428, 0.459, 0.602], 'all_L1': [0.478, 0.479, 0.488, 0.504, 0.617]}), defaultdict(<class 'list'>, {'all_KL': [0.379, 0.394, 0.389, 0.392, 0.536], 'all_L1': [0.471, 0.48, 0.473, 0.471, 0.585]}), defaultdict(<class 'list'>, {'all_KL': [0.429, 0.434, 0.434, 0.43, 0.545], 'all_L1': [0.498, 0.498, 0.495, 0.49, 0.585]}), defaultdict(<class 'list'>, {'all_KL': [0.43, 0.427, 0.43, 0.44, 0.494], 'all_L1': [0.488, 0.481, 0.477, 0.483, 0.534]}), defaultdict(<class 'list'>, {'all_KL': [0.43, 0.432, 0.439, 0.445, 0.516], 'all_L1': [0.485, 0.48, 0.484, 0.485, 0.547]}), defaultdict(<class 'list'>, {'all_KL': [0.442, 0.449, 0.446, 0.445, 0.487], 'all_L1': [0.479, 0.482, 0.478, 0.474, 0.511]}), defaultdict(<class 'list'>, {'all_KL': [0.438, 0.441, 0.445, 0.441, 0.525], 'all_L1': [0.485, 0.487, 0.491, 0.487, 0.561]}), defaultdict(<class 'list'>, {'all_KL': [0.452, 0.451, 0.452, 0.456, 0.476], 'all_L1': [0.46, 0.459, 0.459, 0.462, 0.478]}), defaultdict(<class 'list'>, {'all_KL': [0.408, 0.417, 0.417, 0.426, 0.478], 'all_L1': [0.465, 0.472, 0.471, 0.472, 0.514]}), defaultdict(<class 'list'>, {'all_KL': [0.372, 0.387, 0.403, 0.425, 0.685], 'all_L1': [0.492, 0.497, 0.505, 0.506, 0.703]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.122, 0.254, 0.394, 0.486, 0.529], 'all_L1': [0.152, 0.264, 0.369, 0.436, 0.458]}), defaultdict(<class 'list'>, {'all_KL': [0.253, 0.375, 0.516, 0.576, 0.615], 'all_L1': [0.234, 0.331, 0.438, 0.471, 0.497]}), defaultdict(<class 'list'>, {'all_KL': [0.195, 0.324, 0.453, 0.544, 0.577], 'all_L1': [0.196, 0.304, 0.4, 0.464, 0.482]}), defaultdict(<class 'list'>, {'all_KL': [0.205, 0.358, 0.488, 0.54, 0.57], 'all_L1': [0.21, 0.336, 0.443, 0.476, 0.494]}), defaultdict(<class 'list'>, {'all_KL': [0.237, 0.375, 0.5, 0.554, 0.569], 'all_L1': [0.235, 0.357, 0.457, 0.495, 0.506]}), defaultdict(<class 'list'>, {'all_KL': [0.273, 0.432, 0.506, 0.545, 0.559], 'all_L1': [0.29, 0.42, 0.481, 0.515, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.213, 0.346, 0.48, 0.529, 0.549], 'all_L1': [0.219, 0.33, 0.436, 0.469, 0.483]}), defaultdict(<class 'list'>, {'all_KL': [0.249, 0.429, 0.516, 0.532, 0.543], 'all_L1': [0.31, 0.45, 0.513, 0.526, 0.533]}), defaultdict(<class 'list'>, {'all_KL': [0.264, 0.403, 0.512, 0.556, 0.584], 'all_L1': [0.266, 0.384, 0.471, 0.505, 0.522]}), defaultdict(<class 'list'>, {'all_KL': [0.077, 0.176, 0.333, 0.466, 0.504], 'all_L1': [0.093, 0.179, 0.291, 0.376, 0.391]})]

Eval split val
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.934, 0.934, 0.934, 0.934, 0.936], 'all_L1': [0.918, 0.918, 0.918, 0.918, 0.919]}), defaultdict(<class 'list'>, {'all_KL': [0.904, 0.904, 0.905, 0.905, 0.914], 'all_L1': [0.9, 0.9, 0.9, 0.9, 0.904]}), defaultdict(<class 'list'>, {'all_KL': [0.927, 0.927, 0.927, 0.927, 0.93], 'all_L1': [0.921, 0.921, 0.921, 0.921, 0.923]}), defaultdict(<class 'list'>, {'all_KL': [0.953, 0.953, 0.953, 0.953, 0.953], 'all_L1': [0.944, 0.944, 0.944, 0.944, 0.944]}), defaultdict(<class 'list'>, {'all_KL': [0.926, 0.926, 0.926, 0.926, 0.926], 'all_L1': [0.91, 0.91, 0.91, 0.91, 0.91]}), defaultdict(<class 'list'>, {'all_KL': [0.968, 0.968, 0.968, 0.968, 0.968], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.964, 0.964, 0.964, 0.964, 0.964], 'all_L1': [0.954, 0.954, 0.954, 0.954, 0.954]}), defaultdict(<class 'list'>, {'all_KL': [0.939, 0.939, 0.939, 0.939, 0.939], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.934, 0.934, 0.934, 0.934, 0.934], 'all_L1': [0.914, 0.914, 0.914, 0.914, 0.914]}), defaultdict(<class 'list'>, {'all_KL': [0.918, 0.919, 0.919, 0.92, 0.929], 'all_L1': [0.913, 0.914, 0.914, 0.914, 0.918]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.037, 0.057, 0.064, 0.064, 0.064], 'all_L1': [0.063, 0.076, 0.081, 0.081, 0.081]}), defaultdict(<class 'list'>, {'all_KL': [0.074, 0.084, 0.087, 0.095, 0.095], 'all_L1': [0.086, 0.094, 0.096, 0.1, 0.099]}), defaultdict(<class 'list'>, {'all_KL': [0.052, 0.065, 0.071, 0.073, 0.073], 'all_L1': [0.064, 0.074, 0.078, 0.079, 0.079]}), defaultdict(<class 'list'>, {'all_KL': [0.033, 0.045, 0.047, 0.047, 0.047], 'all_L1': [0.047, 0.055, 0.056, 0.056, 0.056]}), defaultdict(<class 'list'>, {'all_KL': [0.055, 0.071, 0.074, 0.074, 0.074], 'all_L1': [0.078, 0.089, 0.09, 0.09, 0.09]}), defaultdict(<class 'list'>, {'all_KL': [0.028, 0.032, 0.032, 0.032, 0.032], 'all_L1': [0.044, 0.046, 0.046, 0.046, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.029, 0.035, 0.036, 0.036, 0.036], 'all_L1': [0.041, 0.045, 0.046, 0.046, 0.046]}), defaultdict(<class 'list'>, {'all_KL': [0.048, 0.06, 0.061, 0.061, 0.061], 'all_L1': [0.079, 0.086, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.062, 0.066, 0.066, 0.066, 0.066], 'all_L1': [0.084, 0.086, 0.086, 0.086, 0.086]}), defaultdict(<class 'list'>, {'all_KL': [0.038, 0.059, 0.072, 0.073, 0.073], 'all_L1': [0.059, 0.074, 0.083, 0.083, 0.083]})]

Eval split test
suff_simple = [defaultdict(<class 'list'>, {'all_KL': [0.554, 0.568, 0.579, 0.577, 0.797], 'all_L1': [0.616, 0.621, 0.62, 0.61, 0.788]}), defaultdict(<class 'list'>, {'all_KL': [0.345, 0.356, 0.371, 0.389, 0.574], 'all_L1': [0.498, 0.499, 0.504, 0.51, 0.646]}), defaultdict(<class 'list'>, {'all_KL': [0.386, 0.399, 0.406, 0.418, 0.601], 'all_L1': [0.503, 0.506, 0.507, 0.507, 0.644]}), defaultdict(<class 'list'>, {'all_KL': [0.341, 0.358, 0.377, 0.383, 0.508], 'all_L1': [0.453, 0.459, 0.466, 0.464, 0.566]}), defaultdict(<class 'list'>, {'all_KL': [0.364, 0.386, 0.403, 0.417, 0.521], 'all_L1': [0.458, 0.465, 0.47, 0.476, 0.563]}), defaultdict(<class 'list'>, {'all_KL': [0.394, 0.411, 0.43, 0.444, 0.587], 'all_L1': [0.486, 0.491, 0.496, 0.5, 0.612]}), defaultdict(<class 'list'>, {'all_KL': [0.384, 0.388, 0.389, 0.394, 0.566], 'all_L1': [0.477, 0.48, 0.481, 0.483, 0.615]}), defaultdict(<class 'list'>, {'all_KL': [0.507, 0.505, 0.509, 0.514, 0.628], 'all_L1': [0.502, 0.5, 0.501, 0.503, 0.6]}), defaultdict(<class 'list'>, {'all_KL': [0.36, 0.368, 0.385, 0.399, 0.6], 'all_L1': [0.49, 0.492, 0.498, 0.502, 0.649]}), defaultdict(<class 'list'>, {'all_KL': [0.489, 0.512, 0.512, 0.495, 0.74], 'all_L1': [0.628, 0.636, 0.626, 0.595, 0.766]})]
nec = [defaultdict(<class 'list'>, {'all_KL': [0.077, 0.122, 0.189, 0.296, 0.367], 'all_L1': [0.091, 0.136, 0.192, 0.279, 0.321]}), defaultdict(<class 'list'>, {'all_KL': [0.151, 0.252, 0.392, 0.521, 0.58], 'all_L1': [0.129, 0.209, 0.309, 0.389, 0.412]}), defaultdict(<class 'list'>, {'all_KL': [0.133, 0.23, 0.353, 0.453, 0.489], 'all_L1': [0.124, 0.205, 0.303, 0.37, 0.388]}), defaultdict(<class 'list'>, {'all_KL': [0.177, 0.299, 0.426, 0.508, 0.543], 'all_L1': [0.16, 0.263, 0.364, 0.424, 0.437]}), defaultdict(<class 'list'>, {'all_KL': [0.189, 0.309, 0.429, 0.501, 0.538], 'all_L1': [0.181, 0.287, 0.385, 0.436, 0.452]}), defaultdict(<class 'list'>, {'all_KL': [0.156, 0.266, 0.387, 0.479, 0.514], 'all_L1': [0.156, 0.256, 0.354, 0.421, 0.433]}), defaultdict(<class 'list'>, {'all_KL': [0.165, 0.275, 0.421, 0.521, 0.545], 'all_L1': [0.153, 0.248, 0.36, 0.427, 0.437]}), defaultdict(<class 'list'>, {'all_KL': [0.158, 0.244, 0.353, 0.425, 0.442], 'all_L1': [0.189, 0.278, 0.377, 0.437, 0.445]}), defaultdict(<class 'list'>, {'all_KL': [0.152, 0.255, 0.394, 0.501, 0.563], 'all_L1': [0.141, 0.228, 0.332, 0.399, 0.429]}), defaultdict(<class 'list'>, {'all_KL': [0.078, 0.125, 0.205, 0.336, 0.404], 'all_L1': [0.079, 0.118, 0.18, 0.271, 0.299]})]


 -------------------------------------------------- 
Printing evaluation averaged per seed

Eval split id_val
suff_simple class all_L1  =  0.480 +- 0.011, 0.481 +- 0.011, 0.482 +- 0.013, 0.483 +- 0.014, 0.564 +- 0.061
suff_simple class all_KL  =  0.418 +- 0.025, 0.424 +- 0.021, 0.428 +- 0.019, 0.436 +- 0.018, 0.534 +- 0.062
[[0.49000000953674316, 0.48249998688697815, 0.48750001192092896, 0.49799999594688416, 0.621999979019165], [0.4867500066757202, 0.49549999833106995, 0.4830000102519989, 0.47850000858306885, 0.5759999752044678], [0.49924999475479126, 0.49399998784065247, 0.4884999990463257, 0.47999998927116394, 0.5659999847412109], [0.4872500002384186, 0.4740000069141388, 0.45875000953674316, 0.4634999930858612, 0.5260000228881836], [0.4894999861717224, 0.47075000405311584, 0.4715000092983246, 0.4712499976158142, 0.5400000214576721], [0.4620000123977661, 0.46175000071525574, 0.45625001192092896, 0.44749999046325684, 0.49399998784065247], [0.45524999499320984, 0.46050000190734863, 0.460999995470047, 0.4547500014305115, 0.5460000038146973], [0.44699999690055847, 0.4467499852180481, 0.44749999046325684, 0.4560000002384186, 0.4740000069141388], [0.46000000834465027, 0.4659999907016754, 0.4675000011920929, 0.4582499861717224, 0.492000013589859], [0.5307499766349792, 0.5302500128746033, 0.5304999947547913, 0.5147500038146973, 0.7059999704360962]]
[[0.404, 0.412, 0.428, 0.459, 0.602], [0.379, 0.394, 0.389, 0.392, 0.536], [0.429, 0.434, 0.434, 0.43, 0.545], [0.43, 0.427, 0.43, 0.44, 0.494], [0.43, 0.432, 0.439, 0.445, 0.516], [0.442, 0.449, 0.446, 0.445, 0.487], [0.438, 0.441, 0.445, 0.441, 0.525], [0.452, 0.451, 0.452, 0.456, 0.476], [0.408, 0.417, 0.417, 0.426, 0.478], [0.372, 0.387, 0.403, 0.425, 0.685]]
suff_simple_acc_int  =  0.481 +- 0.024, 0.478 +- 0.023, 0.475 +- 0.023, 0.472 +- 0.020, 0.554 +- 0.066
nec class all_L1  =  0.221 +- 0.061, 0.336 +- 0.073, 0.430 +- 0.060, 0.473 +- 0.041, 0.489 +- 0.039
nec class all_KL  =  0.209 +- 0.061, 0.347 +- 0.076, 0.470 +- 0.058, 0.533 +- 0.031, 0.560 +- 0.029
[[0.8899999856948853, 0.7707499861717224, 0.6629999876022339, 0.5995000004768372, 0.5945000052452087], [0.7940000295639038, 0.6890000104904175, 0.5830000042915344, 0.5687500238418579, 0.5494999885559082], [0.8299999833106995, 0.6959999799728394, 0.6140000224113464, 0.5532500147819519, 0.5512499809265137], [0.8059999942779541, 0.6779999732971191, 0.5737500190734863, 0.546999990940094, 0.5400000214576721], [0.7820000052452087, 0.6482499837875366, 0.5475000143051147, 0.5107499957084656, 0.5139999985694885], [0.7319999933242798, 0.5839999914169312, 0.5107499957084656, 0.4675000011920929, 0.46974998712539673], [0.7919999957084656, 0.6690000295639038, 0.5562499761581421, 0.5457500219345093, 0.5307499766349792], [0.7300000190734863, 0.5632500052452087, 0.49125000834465027, 0.4729999899864197, 0.4675000011920929], [0.7680000066757202, 0.628000020980835, 0.5327500104904175, 0.5095000267028809, 0.4962500035762787], [0.9300000071525574, 0.8535000085830688, 0.7492499947547913, 0.6707500219345093, 0.671500027179718]]
[[0.122, 0.254, 0.394, 0.486, 0.529], [0.253, 0.375, 0.516, 0.576, 0.615], [0.195, 0.324, 0.453, 0.544, 0.577], [0.205, 0.358, 0.488, 0.54, 0.57], [0.237, 0.375, 0.5, 0.554, 0.569], [0.273, 0.432, 0.506, 0.545, 0.559], [0.213, 0.346, 0.48, 0.529, 0.549], [0.249, 0.429, 0.516, 0.532, 0.543], [0.264, 0.403, 0.512, 0.556, 0.584], [0.077, 0.176, 0.333, 0.466, 0.504]]
nec_acc_int  =  0.805 +- 0.061, 0.678 +- 0.081, 0.582 +- 0.073, 0.545 +- 0.057, 0.538 +- 0.058

Eval split val
suff_simple class all_L1  =  0.924 +- 0.018, 0.924 +- 0.018, 0.924 +- 0.018, 0.924 +- 0.018, 0.925 +- 0.017
suff_simple class all_KL  =  0.937 +- 0.019, 0.937 +- 0.019, 0.937 +- 0.019, 0.937 +- 0.019, 0.939 +- 0.016
[[0.4966000020503998, 0.49652498960494995, 0.49674999713897705, 0.49662500619888306, 0.49720001220703125], [0.4982999861240387, 0.4981749951839447, 0.49845001101493835, 0.4974749982357025, 0.5005999803543091], [0.4962500035762787, 0.49632498621940613, 0.49642500281333923, 0.49597498774528503, 0.49880000948905945], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4960249960422516, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4961499869823456, 0.4961000084877014, 0.4961000084877014, 0.49607500433921814, 0.4959999918937683], [0.4981499910354614, 0.4983749985694885, 0.49834999442100525, 0.4984250068664551, 0.49880000948905945]]
[[0.934, 0.934, 0.934, 0.934, 0.936], [0.904, 0.904, 0.905, 0.905, 0.914], [0.927, 0.927, 0.927, 0.927, 0.93], [0.953, 0.953, 0.953, 0.953, 0.953], [0.926, 0.926, 0.926, 0.926, 0.926], [0.968, 0.968, 0.968, 0.968, 0.968], [0.964, 0.964, 0.964, 0.964, 0.964], [0.939, 0.939, 0.939, 0.939, 0.939], [0.934, 0.934, 0.934, 0.934, 0.934], [0.918, 0.919, 0.919, 0.92, 0.929]]
suff_simple_acc_int  =  0.497 +- 0.001, 0.497 +- 0.001, 0.497 +- 0.001, 0.496 +- 0.001, 0.497 +- 0.002
nec class all_L1  =  0.065 +- 0.016, 0.072 +- 0.017, 0.075 +- 0.017, 0.075 +- 0.018, 0.075 +- 0.018
nec class all_KL  =  0.046 +- 0.014, 0.057 +- 0.015, 0.061 +- 0.017, 0.062 +- 0.018, 0.062 +- 0.018
[[0.5127999782562256, 0.5008000135421753, 0.4968999922275543, 0.4965499937534332, 0.4964999854564667], [0.5138000249862671, 0.503600001335144, 0.49947500228881836, 0.49902498722076416, 0.5001749992370605], [0.5171999931335449, 0.5063999891281128, 0.49755001068115234, 0.4977000057697296, 0.49847498536109924], [0.5058000087738037, 0.4970000088214874, 0.49639999866485596, 0.49605000019073486, 0.4960249960422516], [0.5073999762535095, 0.498199999332428, 0.49619999527931213, 0.49607500433921814, 0.4960249960422516], [0.4968000054359436, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4991999864578247, 0.4966000020503998, 0.4959999918937683, 0.4960249960422516, 0.49605000019073486], [0.4991999864578247, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.4986000061035156, 0.49619999527931213, 0.4959999918937683, 0.4959999918937683, 0.4959999918937683], [0.5285999774932861, 0.5094000101089478, 0.49877500534057617, 0.49845001101493835, 0.4984000027179718]]
[[0.037, 0.057, 0.064, 0.064, 0.064], [0.074, 0.084, 0.087, 0.095, 0.095], [0.052, 0.065, 0.071, 0.073, 0.073], [0.033, 0.045, 0.047, 0.047, 0.047], [0.055, 0.071, 0.074, 0.074, 0.074], [0.028, 0.032, 0.032, 0.032, 0.032], [0.029, 0.035, 0.036, 0.036, 0.036], [0.048, 0.06, 0.061, 0.061, 0.061], [0.062, 0.066, 0.066, 0.066, 0.066], [0.038, 0.059, 0.072, 0.073, 0.073]]
nec_acc_int  =  0.508 +- 0.010, 0.500 +- 0.005, 0.497 +- 0.001, 0.497 +- 0.001, 0.497 +- 0.001

Eval split test
suff_simple class all_L1  =  0.511 +- 0.058, 0.515 +- 0.059, 0.517 +- 0.055, 0.515 +- 0.046, 0.645 +- 0.072
suff_simple class all_KL  =  0.412 +- 0.072, 0.425 +- 0.071, 0.436 +- 0.068, 0.443 +- 0.062, 0.612 +- 0.086
[[0.6290774345397949, 0.6205223202705383, 0.6159695982933044, 0.6255503296852112, 0.7069268822669983], [0.584825873374939, 0.5851510763168335, 0.5839003324508667, 0.5733439922332764, 0.6437851190567017], [0.5940064191818237, 0.5933810472488403, 0.5886532068252563, 0.576495885848999, 0.6444505453109741], [0.5419001579284668, 0.5393235683441162, 0.5336452126502991, 0.5125074982643127, 0.5618980526924133], [0.5500550270080566, 0.5495797395706177, 0.5389483571052551, 0.5224384665489197, 0.5655359029769897], [0.550955593585968, 0.5480538606643677, 0.5474784970283508, 0.5406743884086609, 0.5942392349243164], [0.5456774234771729, 0.5447268486022949, 0.543300986289978, 0.5441264510154724, 0.6006721258163452], [0.5255153179168701, 0.5260406136512756, 0.5256654024124146, 0.5248899459838867, 0.5777643918991089], [0.5691915154457092, 0.5681909322738647, 0.5721933245658875, 0.5678406953811646, 0.6608325242996216], [0.629252552986145, 0.6181458830833435, 0.6101160645484924, 0.6034870743751526, 0.6478673815727234]]
[[0.554, 0.568, 0.579, 0.577, 0.797], [0.345, 0.356, 0.371, 0.389, 0.574], [0.386, 0.399, 0.406, 0.418, 0.601], [0.341, 0.358, 0.377, 0.383, 0.508], [0.364, 0.386, 0.403, 0.417, 0.521], [0.394, 0.411, 0.43, 0.444, 0.587], [0.384, 0.388, 0.389, 0.394, 0.566], [0.507, 0.505, 0.509, 0.514, 0.628], [0.36, 0.368, 0.385, 0.399, 0.6], [0.489, 0.512, 0.512, 0.495, 0.74]]
suff_simple_acc_int  =  0.572 +- 0.034, 0.569 +- 0.032, 0.566 +- 0.031, 0.559 +- 0.035, 0.620 +- 0.045
nec class all_L1  =  0.140 +- 0.034, 0.223 +- 0.054, 0.316 +- 0.070, 0.385 +- 0.059, 0.405 +- 0.051
nec class all_KL  =  0.144 +- 0.036, 0.238 +- 0.061, 0.355 +- 0.083, 0.454 +- 0.075, 0.499 +- 0.068
[[0.7416449785232544, 0.7314388751983643, 0.7171052694320679, 0.6780568361282349, 0.6637232303619385], [0.7346157431602478, 0.7099259495735168, 0.6673504114151001, 0.6315789222717285, 0.6311286687850952], [0.7668100595474243, 0.7483490109443665, 0.7000200152397156, 0.6560186147689819, 0.6486141681671143], [0.700645387172699, 0.6615469455718994, 0.6147188544273376, 0.5921803116798401, 0.6092655658721924], [0.6886631846427917, 0.6406343579292297, 0.5976585745811462, 0.5841254591941833, 0.5931058526039124], [0.7002201080322266, 0.6588202714920044, 0.6102411150932312, 0.5823744535446167, 0.5928307175636292], [0.7200320363044739, 0.6822343468666077, 0.6272763609886169, 0.5914548635482788, 0.5915799736976624], [0.6349809765815735, 0.6168200969696045, 0.5662147402763367, 0.5383229851722717, 0.5392235517501831], [0.7288373112678528, 0.7040724158287048, 0.6575695276260376, 0.6156193614006042, 0.6105663180351257], [0.7492495775222778, 0.7392685413360596, 0.7324144244194031, 0.6865369081497192, 0.6675004959106445]]
[[0.077, 0.122, 0.189, 0.296, 0.367], [0.151, 0.252, 0.392, 0.521, 0.58], [0.133, 0.23, 0.353, 0.453, 0.489], [0.177, 0.299, 0.426, 0.508, 0.543], [0.189, 0.309, 0.429, 0.501, 0.538], [0.156, 0.266, 0.387, 0.479, 0.514], [0.165, 0.275, 0.421, 0.521, 0.545], [0.158, 0.244, 0.353, 0.425, 0.442], [0.152, 0.255, 0.394, 0.501, 0.563], [0.078, 0.125, 0.205, 0.336, 0.404]]
nec_acc_int  =  0.717 +- 0.036, 0.689 +- 0.042, 0.649 +- 0.052, 0.616 +- 0.045, 0.615 +- 0.037


 -------------------------------------------------- 
Computing faithfulness

Eval split id_val
Faith. Aritm (L1)= 		  =  0.350 +- 0.027, 0.408 +- 0.033, 0.456 +- 0.025, 0.478 +- 0.015, 0.526 +- 0.013
Faith. Armon (L1)= 		  =  0.296 +- 0.060, 0.390 +- 0.053, 0.451 +- 0.033, 0.477 +- 0.017, 0.519 +- 0.010
Faith. GMean (L1)= 	  =  0.321 +- 0.046, 0.399 +- 0.043, 0.454 +- 0.029, 0.478 +- 0.016, 0.523 +- 0.010
Faith. Aritm (KL)= 		  =  0.314 +- 0.039, 0.386 +- 0.045, 0.449 +- 0.033, 0.484 +- 0.015, 0.547 +- 0.025
Faith. Armon (KL)= 		  =  0.274 +- 0.063, 0.378 +- 0.057, 0.446 +- 0.033, 0.479 +- 0.014, 0.544 +- 0.023
Faith. GMean (KL)= 	  =  0.292 +- 0.052, 0.382 +- 0.051, 0.448 +- 0.033, 0.481 +- 0.014, 0.545 +- 0.024

Eval split val
Faith. Aritm (L1)= 		  =  0.494 +- 0.004, 0.498 +- 0.002, 0.500 +- 0.001, 0.500 +- 0.000, 0.500 +- 0.001
Faith. Armon (L1)= 		  =  0.120 +- 0.028, 0.134 +- 0.029, 0.138 +- 0.030, 0.139 +- 0.031, 0.138 +- 0.031
Faith. GMean (L1)= 	  =  0.242 +- 0.029, 0.257 +- 0.029, 0.261 +- 0.030, 0.261 +- 0.031, 0.261 +- 0.031
Faith. Aritm (KL)= 		  =  0.491 +- 0.006, 0.497 +- 0.003, 0.499 +- 0.002, 0.500 +- 0.001, 0.501 +- 0.001
Faith. Armon (KL)= 		  =  0.087 +- 0.026, 0.108 +- 0.027, 0.114 +- 0.029, 0.116 +- 0.032, 0.116 +- 0.032
Faith. GMean (KL)= 	  =  0.204 +- 0.031, 0.229 +- 0.030, 0.236 +- 0.032, 0.238 +- 0.035, 0.238 +- 0.035

Eval split test
Faith. Aritm (L1)= 		  =  0.326 +- 0.017, 0.369 +- 0.011, 0.416 +- 0.011, 0.450 +- 0.010, 0.525 +- 0.014
Faith. Armon (L1)= 		  =  0.216 +- 0.040, 0.303 +- 0.051, 0.382 +- 0.050, 0.435 +- 0.030, 0.491 +- 0.026
Faith. GMean (L1)= 	  =  0.264 +- 0.023, 0.333 +- 0.030, 0.398 +- 0.031, 0.442 +- 0.020, 0.508 +- 0.013
Faith. Aritm (KL)= 		  =  0.278 +- 0.026, 0.331 +- 0.020, 0.396 +- 0.020, 0.449 +- 0.015, 0.555 +- 0.021
Faith. Armon (KL)= 		  =  0.207 +- 0.039, 0.293 +- 0.049, 0.377 +- 0.046, 0.438 +- 0.023, 0.540 +- 0.024
Faith. GMean (KL)= 	  =  0.238 +- 0.025, 0.311 +- 0.031, 0.386 +- 0.032, 0.443 +- 0.019, 0.547 +- 0.018
Computed for split load_split = id



Completed in  2:30:15.150976  for repr_SMGNNGIN_3l_sumpool_0.0dp_mitig_backboneNone_mitig_samplingfeatnormnoneavgedgeattnmean/0.001lr_0.0wd/SMGNN_0.001_True_10_0.01 TopoFeature/basis



DONE SMGNN plain TopoFeature/basis/no_shift NEC_ALPHA 0.1
